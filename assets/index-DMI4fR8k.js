(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=r(i);fetch(i.href,s)}})();var ir=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qw(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var P1={exports:{}},bh={};var R_;function yM(){if(R_)return bh;R_=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,i,s){var o=null;if(s!==void 0&&(o=""+s),i.key!==void 0&&(o=""+i.key),"key"in i){s={};for(var a in i)a!=="key"&&(s[a]=i[a])}else s=i;return i=s.ref,{$$typeof:e,type:n,key:o,ref:i!==void 0?i:null,props:s}}return bh.Fragment=t,bh.jsx=r,bh.jsxs=r,bh}var A_;function CM(){return A_||(A_=1,P1.exports=yM()),P1.exports}var J=CM(),I1={exports:{}},Xt={};var F_;function xM(){if(F_)return Xt;F_=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),o=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),h=Symbol.for("react.activity"),d=Symbol.iterator;function f(O){return O===null||typeof O!="object"?null:(O=d&&O[d]||O["@@iterator"],typeof O=="function"?O:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,g={};function w(O,P,q){this.props=O,this.context=P,this.refs=g,this.updater=q||m}w.prototype.isReactComponent={},w.prototype.setState=function(O,P){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,P,"setState")},w.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function y(){}y.prototype=w.prototype;function C(O,P,q){this.props=O,this.context=P,this.refs=g,this.updater=q||m}var k=C.prototype=new y;k.constructor=C,v(k,w.prototype),k.isPureReactComponent=!0;var F=Array.isArray;function I(){}var N={H:null,A:null,T:null,S:null},j=Object.prototype.hasOwnProperty;function L(O,P,q){var X=q.ref;return{$$typeof:e,type:O,key:P,ref:X!==void 0?X:null,props:q}}function W(O,P){return L(O.type,P,O.props)}function K(O){return typeof O=="object"&&O!==null&&O.$$typeof===e}function z(O){var P={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(q){return P[q]})}var M=/\/+/g;function B(O,P){return typeof O=="object"&&O!==null&&O.key!=null?z(""+O.key):P.toString(36)}function R(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(I,I):(O.status="pending",O.then(function(P){O.status==="pending"&&(O.status="fulfilled",O.value=P)},function(P){O.status==="pending"&&(O.status="rejected",O.reason=P)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function S(O,P,q,X,Q){var G=typeof O;(G==="undefined"||G==="boolean")&&(O=null);var ee=!1;if(O===null)ee=!0;else switch(G){case"bigint":case"string":case"number":ee=!0;break;case"object":switch(O.$$typeof){case e:case t:ee=!0;break;case u:return ee=O._init,S(ee(O._payload),P,q,X,Q)}}if(ee)return Q=Q(O),ee=X===""?"."+B(O,0):X,F(Q)?(q="",ee!=null&&(q=ee.replace(M,"$&/")+"/"),S(Q,P,q,"",function(Z){return Z})):Q!=null&&(K(Q)&&(Q=W(Q,q+(Q.key==null||O&&O.key===Q.key?"":(""+Q.key).replace(M,"$&/")+"/")+ee)),P.push(Q)),1;ee=0;var V=X===""?".":X+":";if(F(O))for(var H=0;H<O.length;H++)X=O[H],G=V+B(X,H),ee+=S(X,P,q,G,Q);else if(H=f(O),typeof H=="function")for(O=H.call(O),H=0;!(X=O.next()).done;)X=X.value,G=V+B(X,H++),ee+=S(X,P,q,G,Q);else if(G==="object"){if(typeof O.then=="function")return S(R(O),P,q,X,Q);throw P=String(O),Error("Objects are not valid as a React child (found: "+(P==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":P)+"). If you meant to render a collection of children, use an array instead.")}return ee}function _(O,P,q){if(O==null)return O;var X=[],Q=0;return S(O,X,"","",function(G){return P.call(q,G,Q++)}),X}function T(O){if(O._status===-1){var P=O._result;P=P(),P.then(function(q){(O._status===0||O._status===-1)&&(O._status=1,O._result=q)},function(q){(O._status===0||O._status===-1)&&(O._status=2,O._result=q)}),O._status===-1&&(O._status=0,O._result=P)}if(O._status===1)return O._result.default;throw O._result}var E=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var P=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(P))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},D={map:_,forEach:function(O,P,q){_(O,function(){P.apply(this,arguments)},q)},count:function(O){var P=0;return _(O,function(){P++}),P},toArray:function(O){return _(O,function(P){return P})||[]},only:function(O){if(!K(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return Xt.Activity=h,Xt.Children=D,Xt.Component=w,Xt.Fragment=r,Xt.Profiler=i,Xt.PureComponent=C,Xt.StrictMode=n,Xt.Suspense=l,Xt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=N,Xt.__COMPILER_RUNTIME={__proto__:null,c:function(O){return N.H.useMemoCache(O)}},Xt.cache=function(O){return function(){return O.apply(null,arguments)}},Xt.cacheSignal=function(){return null},Xt.cloneElement=function(O,P,q){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var X=v({},O.props),Q=O.key;if(P!=null)for(G in P.key!==void 0&&(Q=""+P.key),P)!j.call(P,G)||G==="key"||G==="__self"||G==="__source"||G==="ref"&&P.ref===void 0||(X[G]=P[G]);var G=arguments.length-2;if(G===1)X.children=q;else if(1<G){for(var ee=Array(G),V=0;V<G;V++)ee[V]=arguments[V+2];X.children=ee}return L(O.type,Q,X)},Xt.createContext=function(O){return O={$$typeof:o,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:s,_context:O},O},Xt.createElement=function(O,P,q){var X,Q={},G=null;if(P!=null)for(X in P.key!==void 0&&(G=""+P.key),P)j.call(P,X)&&X!=="key"&&X!=="__self"&&X!=="__source"&&(Q[X]=P[X]);var ee=arguments.length-2;if(ee===1)Q.children=q;else if(1<ee){for(var V=Array(ee),H=0;H<ee;H++)V[H]=arguments[H+2];Q.children=V}if(O&&O.defaultProps)for(X in ee=O.defaultProps,ee)Q[X]===void 0&&(Q[X]=ee[X]);return L(O,G,Q)},Xt.createRef=function(){return{current:null}},Xt.forwardRef=function(O){return{$$typeof:a,render:O}},Xt.isValidElement=K,Xt.lazy=function(O){return{$$typeof:u,_payload:{_status:-1,_result:O},_init:T}},Xt.memo=function(O,P){return{$$typeof:c,type:O,compare:P===void 0?null:P}},Xt.startTransition=function(O){var P=N.T,q={};N.T=q;try{var X=O(),Q=N.S;Q!==null&&Q(q,X),typeof X=="object"&&X!==null&&typeof X.then=="function"&&X.then(I,E)}catch(G){E(G)}finally{P!==null&&q.types!==null&&(P.types=q.types),N.T=P}},Xt.unstable_useCacheRefresh=function(){return N.H.useCacheRefresh()},Xt.use=function(O){return N.H.use(O)},Xt.useActionState=function(O,P,q){return N.H.useActionState(O,P,q)},Xt.useCallback=function(O,P){return N.H.useCallback(O,P)},Xt.useContext=function(O){return N.H.useContext(O)},Xt.useDebugValue=function(){},Xt.useDeferredValue=function(O,P){return N.H.useDeferredValue(O,P)},Xt.useEffect=function(O,P){return N.H.useEffect(O,P)},Xt.useEffectEvent=function(O){return N.H.useEffectEvent(O)},Xt.useId=function(){return N.H.useId()},Xt.useImperativeHandle=function(O,P,q){return N.H.useImperativeHandle(O,P,q)},Xt.useInsertionEffect=function(O,P){return N.H.useInsertionEffect(O,P)},Xt.useLayoutEffect=function(O,P){return N.H.useLayoutEffect(O,P)},Xt.useMemo=function(O,P){return N.H.useMemo(O,P)},Xt.useOptimistic=function(O,P){return N.H.useOptimistic(O,P)},Xt.useReducer=function(O,P,q){return N.H.useReducer(O,P,q)},Xt.useRef=function(O){return N.H.useRef(O)},Xt.useState=function(O){return N.H.useState(O)},Xt.useSyncExternalStore=function(O,P,q){return N.H.useSyncExternalStore(O,P,q)},Xt.useTransition=function(){return N.H.useTransition()},Xt.version="19.2.4",Xt}var M_;function ey(){return M_||(M_=1,I1.exports=xM()),I1.exports}var ae=ey();const st=Qw(ae);var O1={exports:{}},wh={},N1={exports:{}},L1={};var D_;function SM(){return D_||(D_=1,(function(e){function t(S,_){var T=S.length;S.push(_);e:for(;0<T;){var E=T-1>>>1,D=S[E];if(0<i(D,_))S[E]=_,S[T]=D,T=E;else break e}}function r(S){return S.length===0?null:S[0]}function n(S){if(S.length===0)return null;var _=S[0],T=S.pop();if(T!==_){S[0]=T;e:for(var E=0,D=S.length,O=D>>>1;E<O;){var P=2*(E+1)-1,q=S[P],X=P+1,Q=S[X];if(0>i(q,T))X<D&&0>i(Q,q)?(S[E]=Q,S[X]=T,E=X):(S[E]=q,S[P]=T,E=P);else if(X<D&&0>i(Q,T))S[E]=Q,S[X]=T,E=X;else break e}}return _}function i(S,_){var T=S.sortIndex-_.sortIndex;return T!==0?T:S.id-_.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,a=o.now();e.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,d=3,f=!1,m=!1,v=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function k(S){for(var _=r(c);_!==null;){if(_.callback===null)n(c);else if(_.startTime<=S)n(c),_.sortIndex=_.expirationTime,t(l,_);else break;_=r(c)}}function F(S){if(v=!1,k(S),!m)if(r(l)!==null)m=!0,I||(I=!0,z());else{var _=r(c);_!==null&&R(F,_.startTime-S)}}var I=!1,N=-1,j=5,L=-1;function W(){return g?!0:!(e.unstable_now()-L<j)}function K(){if(g=!1,I){var S=e.unstable_now();L=S;var _=!0;try{e:{m=!1,v&&(v=!1,y(N),N=-1),f=!0;var T=d;try{t:{for(k(S),h=r(l);h!==null&&!(h.expirationTime>S&&W());){var E=h.callback;if(typeof E=="function"){h.callback=null,d=h.priorityLevel;var D=E(h.expirationTime<=S);if(S=e.unstable_now(),typeof D=="function"){h.callback=D,k(S),_=!0;break t}h===r(l)&&n(l),k(S)}else n(l);h=r(l)}if(h!==null)_=!0;else{var O=r(c);O!==null&&R(F,O.startTime-S),_=!1}}break e}finally{h=null,d=T,f=!1}_=void 0}}finally{_?z():I=!1}}}var z;if(typeof C=="function")z=function(){C(K)};else if(typeof MessageChannel<"u"){var M=new MessageChannel,B=M.port2;M.port1.onmessage=K,z=function(){B.postMessage(null)}}else z=function(){w(K,0)};function R(S,_){N=w(function(){S(e.unstable_now())},_)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(S){S.callback=null},e.unstable_forceFrameRate=function(S){0>S||125<S?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):j=0<S?Math.floor(1e3/S):5},e.unstable_getCurrentPriorityLevel=function(){return d},e.unstable_next=function(S){switch(d){case 1:case 2:case 3:var _=3;break;default:_=d}var T=d;d=_;try{return S()}finally{d=T}},e.unstable_requestPaint=function(){g=!0},e.unstable_runWithPriority=function(S,_){switch(S){case 1:case 2:case 3:case 4:case 5:break;default:S=3}var T=d;d=S;try{return _()}finally{d=T}},e.unstable_scheduleCallback=function(S,_,T){var E=e.unstable_now();switch(typeof T=="object"&&T!==null?(T=T.delay,T=typeof T=="number"&&0<T?E+T:E):T=E,S){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=T+D,S={id:u++,callback:_,priorityLevel:S,startTime:T,expirationTime:D,sortIndex:-1},T>E?(S.sortIndex=T,t(c,S),r(l)===null&&S===r(c)&&(v?(y(N),N=-1):v=!0,R(F,T-E))):(S.sortIndex=D,t(l,S),m||f||(m=!0,I||(I=!0,z()))),S},e.unstable_shouldYield=W,e.unstable_wrapCallback=function(S){var _=d;return function(){var T=d;d=_;try{return S.apply(this,arguments)}finally{d=T}}}})(L1)),L1}var P_;function _M(){return P_||(P_=1,N1.exports=SM()),N1.exports}var B1={exports:{}},oi={};var I_;function EM(){if(I_)return oi;I_=1;var e=ey();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},i=Symbol.for("react.portal");function s(l,c,u){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:h==null?null:""+h,children:l,containerInfo:c,implementation:u}}var o=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function a(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return oi.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,oi.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return s(l,c,null,u)},oi.flushSync=function(l){var c=o.T,u=n.p;try{if(o.T=null,n.p=2,l)return l()}finally{o.T=c,n.p=u,n.d.f()}},oi.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,n.d.C(l,c))},oi.prefetchDNS=function(l){typeof l=="string"&&n.d.D(l)},oi.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,h=a(u,c.crossOrigin),d=typeof c.integrity=="string"?c.integrity:void 0,f=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?n.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:h,integrity:d,fetchPriority:f}):u==="script"&&n.d.X(l,{crossOrigin:h,integrity:d,fetchPriority:f,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},oi.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=a(c.as,c.crossOrigin);n.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&n.d.M(l)},oi.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,h=a(u,c.crossOrigin);n.d.L(l,u,{crossOrigin:h,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},oi.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=a(c.as,c.crossOrigin);n.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else n.d.m(l)},oi.requestFormReset=function(l){n.d.r(l)},oi.unstable_batchedUpdates=function(l,c){return l(c)},oi.useFormState=function(l,c,u){return o.H.useFormState(l,c,u)},oi.useFormStatus=function(){return o.H.useHostTransitionStatus()},oi.version="19.2.4",oi}var O_;function vT(){if(O_)return B1.exports;O_=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),B1.exports=EM(),B1.exports}var N_;function TM(){if(N_)return wh;N_=1;var e=_M(),t=ey(),r=vT();function n(p){var b="https://react.dev/errors/"+p;if(1<arguments.length){b+="?args[]="+encodeURIComponent(arguments[1]);for(var x=2;x<arguments.length;x++)b+="&args[]="+encodeURIComponent(arguments[x])}return"Minified React error #"+p+"; visit "+b+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function s(p){var b=p,x=p;if(p.alternate)for(;b.return;)b=b.return;else{p=b;do b=p,(b.flags&4098)!==0&&(x=b.return),p=b.return;while(p)}return b.tag===3?x:null}function o(p){if(p.tag===13){var b=p.memoizedState;if(b===null&&(p=p.alternate,p!==null&&(b=p.memoizedState)),b!==null)return b.dehydrated}return null}function a(p){if(p.tag===31){var b=p.memoizedState;if(b===null&&(p=p.alternate,p!==null&&(b=p.memoizedState)),b!==null)return b.dehydrated}return null}function l(p){if(s(p)!==p)throw Error(n(188))}function c(p){var b=p.alternate;if(!b){if(b=s(p),b===null)throw Error(n(188));return b!==p?null:p}for(var x=p,A=b;;){var U=x.return;if(U===null)break;var Y=U.alternate;if(Y===null){if(A=U.return,A!==null){x=A;continue}break}if(U.child===Y.child){for(Y=U.child;Y;){if(Y===x)return l(U),p;if(Y===A)return l(U),b;Y=Y.sibling}throw Error(n(188))}if(x.return!==A.return)x=U,A=Y;else{for(var re=!1,he=U.child;he;){if(he===x){re=!0,x=U,A=Y;break}if(he===A){re=!0,A=U,x=Y;break}he=he.sibling}if(!re){for(he=Y.child;he;){if(he===x){re=!0,x=Y,A=U;break}if(he===A){re=!0,A=Y,x=U;break}he=he.sibling}if(!re)throw Error(n(189))}}if(x.alternate!==A)throw Error(n(190))}if(x.tag!==3)throw Error(n(188));return x.stateNode.current===x?p:b}function u(p){var b=p.tag;if(b===5||b===26||b===27||b===6)return p;for(p=p.child;p!==null;){if(b=u(p),b!==null)return b;p=p.sibling}return null}var h=Object.assign,d=Symbol.for("react.element"),f=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),g=Symbol.for("react.strict_mode"),w=Symbol.for("react.profiler"),y=Symbol.for("react.consumer"),C=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),I=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),j=Symbol.for("react.lazy"),L=Symbol.for("react.activity"),W=Symbol.for("react.memo_cache_sentinel"),K=Symbol.iterator;function z(p){return p===null||typeof p!="object"?null:(p=K&&p[K]||p["@@iterator"],typeof p=="function"?p:null)}var M=Symbol.for("react.client.reference");function B(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===M?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case v:return"Fragment";case w:return"Profiler";case g:return"StrictMode";case F:return"Suspense";case I:return"SuspenseList";case L:return"Activity"}if(typeof p=="object")switch(p.$$typeof){case m:return"Portal";case C:return p.displayName||"Context";case y:return(p._context.displayName||"Context")+".Consumer";case k:var b=p.render;return p=p.displayName,p||(p=b.displayName||b.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case N:return b=p.displayName||null,b!==null?b:B(p.type)||"Memo";case j:b=p._payload,p=p._init;try{return B(p(b))}catch{}}return null}var R=Array.isArray,S=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,T={pending:!1,data:null,method:null,action:null},E=[],D=-1;function O(p){return{current:p}}function P(p){0>D||(p.current=E[D],E[D]=null,D--)}function q(p,b){D++,E[D]=p.current,p.current=b}var X=O(null),Q=O(null),G=O(null),ee=O(null);function V(p,b){switch(q(G,b),q(Q,p),q(X,null),b.nodeType){case 9:case 11:p=(p=b.documentElement)&&(p=p.namespaceURI)?ZS(p):0;break;default:if(p=b.tagName,b=b.namespaceURI)b=ZS(b),p=JS(b,p);else switch(p){case"svg":p=1;break;case"math":p=2;break;default:p=0}}P(X),q(X,p)}function H(){P(X),P(Q),P(G)}function Z(p){p.memoizedState!==null&&q(ee,p);var b=X.current,x=JS(b,p.type);b!==x&&(q(Q,p),q(X,x))}function ie(p){Q.current===p&&(P(X),P(Q)),ee.current===p&&(P(ee),ph._currentValue=T)}var te,oe;function ue(p){if(te===void 0)try{throw Error()}catch(x){var b=x.stack.trim().match(/\n( *(at )?)/);te=b&&b[1]||"",oe=-1<x.stack.indexOf(`
    at`)?" (<anonymous>)":-1<x.stack.indexOf("@")?"@unknown:0:0":""}return`
`+te+p+oe}var Ce=!1;function ye(p,b){if(!p||Ce)return"";Ce=!0;var x=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var A={DetermineComponentFrameRoot:function(){try{if(b){var it=function(){throw Error()};if(Object.defineProperty(it.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(it,[])}catch(Ke){var qe=Ke}Reflect.construct(p,[],it)}else{try{it.call()}catch(Ke){qe=Ke}p.call(it.prototype)}}else{try{throw Error()}catch(Ke){qe=Ke}(it=p())&&typeof it.catch=="function"&&it.catch(function(){})}}catch(Ke){if(Ke&&qe&&typeof Ke.stack=="string")return[Ke.stack,qe.stack]}return[null,null]}};A.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var U=Object.getOwnPropertyDescriptor(A.DetermineComponentFrameRoot,"name");U&&U.configurable&&Object.defineProperty(A.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var Y=A.DetermineComponentFrameRoot(),re=Y[0],he=Y[1];if(re&&he){var _e=re.split(`
`),We=he.split(`
`);for(U=A=0;A<_e.length&&!_e[A].includes("DetermineComponentFrameRoot");)A++;for(;U<We.length&&!We[U].includes("DetermineComponentFrameRoot");)U++;if(A===_e.length||U===We.length)for(A=_e.length-1,U=We.length-1;1<=A&&0<=U&&_e[A]!==We[U];)U--;for(;1<=A&&0<=U;A--,U--)if(_e[A]!==We[U]){if(A!==1||U!==1)do if(A--,U--,0>U||_e[A]!==We[U]){var tt=`
`+_e[A].replace(" at new "," at ");return p.displayName&&tt.includes("<anonymous>")&&(tt=tt.replace("<anonymous>",p.displayName)),tt}while(1<=A&&0<=U);break}}}finally{Ce=!1,Error.prepareStackTrace=x}return(x=p?p.displayName||p.name:"")?ue(x):""}function ne(p,b){switch(p.tag){case 26:case 27:case 5:return ue(p.type);case 16:return ue("Lazy");case 13:return p.child!==b&&b!==null?ue("Suspense Fallback"):ue("Suspense");case 19:return ue("SuspenseList");case 0:case 15:return ye(p.type,!1);case 11:return ye(p.type.render,!1);case 1:return ye(p.type,!0);case 31:return ue("Activity");default:return""}}function me(p){try{var b="",x=null;do b+=ne(p,x),x=p,p=p.return;while(p);return b}catch(A){return`
Error generating stack: `+A.message+`
`+A.stack}}var ve=Object.prototype.hasOwnProperty,Te=e.unstable_scheduleCallback,xe=e.unstable_cancelCallback,Fe=e.unstable_shouldYield,Ge=e.unstable_requestPaint,Ve=e.unstable_now,Ye=e.unstable_getCurrentPriorityLevel,ut=e.unstable_ImmediatePriority,ht=e.unstable_UserBlockingPriority,be=e.unstable_NormalPriority,ze=e.unstable_LowPriority,we=e.unstable_IdlePriority,Ee=e.log,Ie=e.unstable_setDisableYieldValue,Pe=null,De=null;function Ze(p){if(typeof Ee=="function"&&Ie(p),De&&typeof De.setStrictMode=="function")try{De.setStrictMode(Pe,p)}catch{}}var pt=Math.clz32?Math.clz32:$t,yt=Math.log,Pt=Math.LN2;function $t(p){return p>>>=0,p===0?32:31-(yt(p)/Pt|0)|0}var Ct=256,It=262144,Ut=4194304;function _t(p){var b=p&42;if(b!==0)return b;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return p&261888;case 262144:case 524288:case 1048576:case 2097152:return p&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function sr(p,b,x){var A=p.pendingLanes;if(A===0)return 0;var U=0,Y=p.suspendedLanes,re=p.pingedLanes;p=p.warmLanes;var he=A&134217727;return he!==0?(A=he&~Y,A!==0?U=_t(A):(re&=he,re!==0?U=_t(re):x||(x=he&~p,x!==0&&(U=_t(x))))):(he=A&~Y,he!==0?U=_t(he):re!==0?U=_t(re):x||(x=A&~p,x!==0&&(U=_t(x)))),U===0?0:b!==0&&b!==U&&(b&Y)===0&&(Y=U&-U,x=b&-b,Y>=x||Y===32&&(x&4194048)!==0)?b:U}function Jt(p,b){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&b)===0}function Tt(p,b){switch(p){case 1:case 2:case 4:case 8:case 64:return b+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return b+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nr(){var p=Ut;return Ut<<=1,(Ut&62914560)===0&&(Ut=4194304),p}function vr(p){for(var b=[],x=0;31>x;x++)b.push(p);return b}function At(p,b){p.pendingLanes|=b,b!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function fr(p,b,x,A,U,Y){var re=p.pendingLanes;p.pendingLanes=x,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=x,p.entangledLanes&=x,p.errorRecoveryDisabledLanes&=x,p.shellSuspendCounter=0;var he=p.entanglements,_e=p.expirationTimes,We=p.hiddenUpdates;for(x=re&~x;0<x;){var tt=31-pt(x),it=1<<tt;he[tt]=0,_e[tt]=-1;var qe=We[tt];if(qe!==null)for(We[tt]=null,tt=0;tt<qe.length;tt++){var Ke=qe[tt];Ke!==null&&(Ke.lane&=-536870913)}x&=~it}A!==0&&yr(p,A,0),Y!==0&&U===0&&p.tag!==0&&(p.suspendedLanes|=Y&~(re&~b))}function yr(p,b,x){p.pendingLanes|=b,p.suspendedLanes&=~b;var A=31-pt(b);p.entangledLanes|=b,p.entanglements[A]=p.entanglements[A]|1073741824|x&261930}function Ot(p,b){var x=p.entangledLanes|=b;for(p=p.entanglements;x;){var A=31-pt(x),U=1<<A;U&b|p[A]&b&&(p[A]|=b),x&=~U}}function ke(p,b){var x=b&-b;return x=(x&42)!==0?1:He(x),(x&(p.suspendedLanes|b))!==0?0:x}function He(p){switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=128;break;case 268435456:p=134217728;break;default:p=0}return p}function Xe(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function se(){var p=_.p;return p!==0?p:(p=window.event,p===void 0?32:C_(p.type))}function pe(p,b){var x=_.p;try{return _.p=p,b()}finally{_.p=x}}var le=Math.random().toString(36).slice(2),de="__reactFiber$"+le,fe="__reactProps$"+le,ge="__reactContainer$"+le,Re="__reactEvents$"+le,je="__reactListeners$"+le,Me="__reactHandles$"+le,Be="__reactResources$"+le,Oe="__reactMarker$"+le;function nt(p){delete p[de],delete p[fe],delete p[Re],delete p[je],delete p[Me]}function ct(p){var b=p[de];if(b)return b;for(var x=p.parentNode;x;){if(b=x[ge]||x[de]){if(x=b.alternate,b.child!==null||x!==null&&x.child!==null)for(p=s_(p);p!==null;){if(x=p[de])return x;p=s_(p)}return b}p=x,x=p.parentNode}return null}function ft(p){if(p=p[de]||p[ge]){var b=p.tag;if(b===5||b===6||b===13||b===31||b===26||b===27||b===3)return p}return null}function ce(p){var b=p.tag;if(b===5||b===26||b===27||b===6)return p.stateNode;throw Error(n(33))}function Se(p){var b=p[Be];return b||(b=p[Be]={hoistableStyles:new Map,hoistableScripts:new Map}),b}function Le(p){p[Oe]=!0}var Qe=new Set,gt={};function ot(p,b){dt(p,b),dt(p+"Capture",b)}function dt(p,b){for(gt[p]=b,p=0;p<b.length;p++)Qe.add(b[p])}var Kt=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Nt={},Lt={};function kt(p){return ve.call(Lt,p)?!0:ve.call(Nt,p)?!1:Kt.test(p)?Lt[p]=!0:(Nt[p]=!0,!1)}function qt(p,b,x){if(kt(b))if(x===null)p.removeAttribute(b);else{switch(typeof x){case"undefined":case"function":case"symbol":p.removeAttribute(b);return;case"boolean":var A=b.toLowerCase().slice(0,5);if(A!=="data-"&&A!=="aria-"){p.removeAttribute(b);return}}p.setAttribute(b,""+x)}}function br(p,b,x){if(x===null)p.removeAttribute(b);else{switch(typeof x){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(b);return}p.setAttribute(b,""+x)}}function or(p,b,x,A){if(A===null)p.removeAttribute(x);else{switch(typeof A){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(x);return}p.setAttributeNS(b,x,""+A)}}function pr(p){switch(typeof p){case"bigint":case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function gn(p){var b=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(b==="checkbox"||b==="radio")}function $n(p,b,x){var A=Object.getOwnPropertyDescriptor(p.constructor.prototype,b);if(!p.hasOwnProperty(b)&&typeof A<"u"&&typeof A.get=="function"&&typeof A.set=="function"){var U=A.get,Y=A.set;return Object.defineProperty(p,b,{configurable:!0,get:function(){return U.call(this)},set:function(re){x=""+re,Y.call(this,re)}}),Object.defineProperty(p,b,{enumerable:A.enumerable}),{getValue:function(){return x},setValue:function(re){x=""+re},stopTracking:function(){p._valueTracker=null,delete p[b]}}}}function bi(p){if(!p._valueTracker){var b=gn(p)?"checked":"value";p._valueTracker=$n(p,b,""+p[b])}}function Js(p){if(!p)return!1;var b=p._valueTracker;if(!b)return!0;var x=b.getValue(),A="";return p&&(A=gn(p)?p.checked?"true":"false":p.value),p=A,p!==x?(b.setValue(p),!0):!1}function Ds(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}var ba=/[\n"\\]/g;function Pn(p){return p.replace(ba,function(b){return"\\"+b.charCodeAt(0).toString(16)+" "})}function Cr(p,b,x,A,U,Y,re,he){p.name="",re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"?p.type=re:p.removeAttribute("type"),b!=null?re==="number"?(b===0&&p.value===""||p.value!=b)&&(p.value=""+pr(b)):p.value!==""+pr(b)&&(p.value=""+pr(b)):re!=="submit"&&re!=="reset"||p.removeAttribute("value"),b!=null?ss(p,re,pr(b)):x!=null?ss(p,re,pr(x)):A!=null&&p.removeAttribute("value"),U==null&&Y!=null&&(p.defaultChecked=!!Y),U!=null&&(p.checked=U&&typeof U!="function"&&typeof U!="symbol"),he!=null&&typeof he!="function"&&typeof he!="symbol"&&typeof he!="boolean"?p.name=""+pr(he):p.removeAttribute("name")}function cr(p,b,x,A,U,Y,re,he){if(Y!=null&&typeof Y!="function"&&typeof Y!="symbol"&&typeof Y!="boolean"&&(p.type=Y),b!=null||x!=null){if(!(Y!=="submit"&&Y!=="reset"||b!=null)){bi(p);return}x=x!=null?""+pr(x):"",b=b!=null?""+pr(b):x,he||b===p.value||(p.value=b),p.defaultValue=b}A=A??U,A=typeof A!="function"&&typeof A!="symbol"&&!!A,p.checked=he?p.checked:!!A,p.defaultChecked=!!A,re!=null&&typeof re!="function"&&typeof re!="symbol"&&typeof re!="boolean"&&(p.name=re),bi(p)}function ss(p,b,x){b==="number"&&Ds(p.ownerDocument)===p||p.defaultValue===""+x||(p.defaultValue=""+x)}function Ei(p,b,x,A){if(p=p.options,b){b={};for(var U=0;U<x.length;U++)b["$"+x[U]]=!0;for(x=0;x<p.length;x++)U=b.hasOwnProperty("$"+p[x].value),p[x].selected!==U&&(p[x].selected=U),U&&A&&(p[x].defaultSelected=!0)}else{for(x=""+pr(x),b=null,U=0;U<p.length;U++){if(p[U].value===x){p[U].selected=!0,A&&(p[U].defaultSelected=!0);return}b!==null||p[U].disabled||(b=p[U])}b!==null&&(b.selected=!0)}}function _l(p,b,x){if(b!=null&&(b=""+pr(b),b!==p.value&&(p.value=b),x==null)){p.defaultValue!==b&&(p.defaultValue=b);return}p.defaultValue=x!=null?""+pr(x):""}function ii(p,b,x,A){if(b==null){if(A!=null){if(x!=null)throw Error(n(92));if(R(A)){if(1<A.length)throw Error(n(93));A=A[0]}x=A}x==null&&(x=""),b=x}x=pr(b),p.defaultValue=x,A=p.textContent,A===x&&A!==""&&A!==null&&(p.value=A),bi(p)}function si(p,b){if(b){var x=p.firstChild;if(x&&x===p.lastChild&&x.nodeType===3){x.nodeValue=b;return}}p.textContent=b}var Qs=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function wa(p,b,x){var A=b.indexOf("--")===0;x==null||typeof x=="boolean"||x===""?A?p.setProperty(b,""):b==="float"?p.cssFloat="":p[b]="":A?p.setProperty(b,x):typeof x!="number"||x===0||Qs.has(b)?b==="float"?p.cssFloat=x:p[b]=(""+x).trim():p[b]=x+"px"}function El(p,b,x){if(b!=null&&typeof b!="object")throw Error(n(62));if(p=p.style,x!=null){for(var A in x)!x.hasOwnProperty(A)||b!=null&&b.hasOwnProperty(A)||(A.indexOf("--")===0?p.setProperty(A,""):A==="float"?p.cssFloat="":p[A]="");for(var U in b)A=b[U],b.hasOwnProperty(U)&&x[U]!==A&&wa(p,U,A)}else for(var Y in b)b.hasOwnProperty(Y)&&wa(p,Y,b[Y])}function eo(p){if(p.indexOf("-")===-1)return!1;switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var to=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ip=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Fo(p){return ip.test(""+p)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":p}function Gi(){}var ya=null;function Ca(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var Mo=null,Ps=null;function Tl(p){var b=ft(p);if(b&&(p=b.stateNode)){var x=p[fe]||null;e:switch(p=b.stateNode,b.type){case"input":if(Cr(p,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name),b=x.name,x.type==="radio"&&b!=null){for(x=p;x.parentNode;)x=x.parentNode;for(x=x.querySelectorAll('input[name="'+Pn(""+b)+'"][type="radio"]'),b=0;b<x.length;b++){var A=x[b];if(A!==p&&A.form===p.form){var U=A[fe]||null;if(!U)throw Error(n(90));Cr(A,U.value,U.defaultValue,U.defaultValue,U.checked,U.defaultChecked,U.type,U.name)}}for(b=0;b<x.length;b++)A=x[b],A.form===p.form&&Js(A)}break e;case"textarea":_l(p,x.value,x.defaultValue);break e;case"select":b=x.value,b!=null&&Ei(p,!!x.multiple,b,!1)}}}var Dm=!1;function ZC(p,b,x){if(Dm)return p(b,x);Dm=!0;try{var A=p(b);return A}finally{if(Dm=!1,(Mo!==null||Ps!==null)&&(Wp(),Mo&&(b=Mo,p=Ps,Ps=Mo=null,Tl(b),p)))for(b=0;b<p.length;b++)Tl(p[b])}}function Md(p,b){var x=p.stateNode;if(x===null)return null;var A=x[fe]||null;if(A===null)return null;x=A[b];e:switch(b){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(p=p.type,A=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!A;break e;default:p=!1}if(p)return null;if(x&&typeof x!="function")throw Error(n(231,b,typeof x));return x}var Do=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Pm=!1;if(Do)try{var Dd={};Object.defineProperty(Dd,"passive",{get:function(){Pm=!0}}),window.addEventListener("test",Dd,Dd),window.removeEventListener("test",Dd,Dd)}catch{Pm=!1}var xa=null,Im=null,sp=null;function JC(){if(sp)return sp;var p,b=Im,x=b.length,A,U="value"in xa?xa.value:xa.textContent,Y=U.length;for(p=0;p<x&&b[p]===U[p];p++);var re=x-p;for(A=1;A<=re&&b[x-A]===U[Y-A];A++);return sp=U.slice(p,1<A?1-A:void 0)}function op(p){var b=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&b===13&&(p=13)):p=b,p===10&&(p=13),32<=p||p===13?p:0}function ap(){return!0}function QC(){return!1}function Ti(p){function b(x,A,U,Y,re){this._reactName=x,this._targetInst=U,this.type=A,this.nativeEvent=Y,this.target=re,this.currentTarget=null;for(var he in p)p.hasOwnProperty(he)&&(x=p[he],this[he]=x?x(Y):Y[he]);return this.isDefaultPrevented=(Y.defaultPrevented!=null?Y.defaultPrevented:Y.returnValue===!1)?ap:QC,this.isPropagationStopped=QC,this}return h(b.prototype,{preventDefault:function(){this.defaultPrevented=!0;var x=this.nativeEvent;x&&(x.preventDefault?x.preventDefault():typeof x.returnValue!="unknown"&&(x.returnValue=!1),this.isDefaultPrevented=ap)},stopPropagation:function(){var x=this.nativeEvent;x&&(x.stopPropagation?x.stopPropagation():typeof x.cancelBubble!="unknown"&&(x.cancelBubble=!0),this.isPropagationStopped=ap)},persist:function(){},isPersistent:ap}),b}var kl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lp=Ti(kl),Pd=h({},kl,{view:0,detail:0}),bA=Ti(Pd),Om,Nm,Id,cp=h({},Pd,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Bm,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==Id&&(Id&&p.type==="mousemove"?(Om=p.screenX-Id.screenX,Nm=p.screenY-Id.screenY):Nm=Om=0,Id=p),Om)},movementY:function(p){return"movementY"in p?p.movementY:Nm}}),ex=Ti(cp),wA=h({},cp,{dataTransfer:0}),yA=Ti(wA),CA=h({},Pd,{relatedTarget:0}),Lm=Ti(CA),xA=h({},kl,{animationName:0,elapsedTime:0,pseudoElement:0}),SA=Ti(xA),_A=h({},kl,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),EA=Ti(_A),TA=h({},kl,{data:0}),tx=Ti(TA),kA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},RA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},AA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FA(p){var b=this.nativeEvent;return b.getModifierState?b.getModifierState(p):(p=AA[p])?!!b[p]:!1}function Bm(){return FA}var MA=h({},Pd,{key:function(p){if(p.key){var b=kA[p.key]||p.key;if(b!=="Unidentified")return b}return p.type==="keypress"?(p=op(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?RA[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Bm,charCode:function(p){return p.type==="keypress"?op(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?op(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),DA=Ti(MA),PA=h({},cp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rx=Ti(PA),IA=h({},Pd,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Bm}),OA=Ti(IA),NA=h({},kl,{propertyName:0,elapsedTime:0,pseudoElement:0}),LA=Ti(NA),BA=h({},cp,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),HA=Ti(BA),jA=h({},kl,{newState:0,oldState:0}),VA=Ti(jA),GA=[9,13,27,32],Hm=Do&&"CompositionEvent"in window,Od=null;Do&&"documentMode"in document&&(Od=document.documentMode);var zA=Do&&"TextEvent"in window&&!Od,nx=Do&&(!Hm||Od&&8<Od&&11>=Od),ix=" ",sx=!1;function ox(p,b){switch(p){case"keyup":return GA.indexOf(b.keyCode)!==-1;case"keydown":return b.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ax(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var Hc=!1;function UA(p,b){switch(p){case"compositionend":return ax(b);case"keypress":return b.which!==32?null:(sx=!0,ix);case"textInput":return p=b.data,p===ix&&sx?null:p;default:return null}}function WA(p,b){if(Hc)return p==="compositionend"||!Hm&&ox(p,b)?(p=JC(),sp=Im=xa=null,Hc=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(b.ctrlKey||b.altKey||b.metaKey)||b.ctrlKey&&b.altKey){if(b.char&&1<b.char.length)return b.char;if(b.which)return String.fromCharCode(b.which)}return null;case"compositionend":return nx&&b.locale!=="ko"?null:b.data;default:return null}}var $A={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function lx(p){var b=p&&p.nodeName&&p.nodeName.toLowerCase();return b==="input"?!!$A[p.type]:b==="textarea"}function cx(p,b,x,A){Mo?Ps?Ps.push(A):Ps=[A]:Mo=A,b=Jp(b,"onChange"),0<b.length&&(x=new lp("onChange","change",null,x,A),p.push({event:x,listeners:b}))}var Nd=null,Ld=null;function qA(p){WS(p,0)}function up(p){var b=ce(p);if(Js(b))return p}function ux(p,b){if(p==="change")return b}var dx=!1;if(Do){var jm;if(Do){var Vm="oninput"in document;if(!Vm){var hx=document.createElement("div");hx.setAttribute("oninput","return;"),Vm=typeof hx.oninput=="function"}jm=Vm}else jm=!1;dx=jm&&(!document.documentMode||9<document.documentMode)}function fx(){Nd&&(Nd.detachEvent("onpropertychange",px),Ld=Nd=null)}function px(p){if(p.propertyName==="value"&&up(Ld)){var b=[];cx(b,Ld,p,Ca(p)),ZC(qA,b)}}function KA(p,b,x){p==="focusin"?(fx(),Nd=b,Ld=x,Nd.attachEvent("onpropertychange",px)):p==="focusout"&&fx()}function XA(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return up(Ld)}function YA(p,b){if(p==="click")return up(b)}function ZA(p,b){if(p==="input"||p==="change")return up(b)}function JA(p,b){return p===b&&(p!==0||1/p===1/b)||p!==p&&b!==b}var zi=typeof Object.is=="function"?Object.is:JA;function Bd(p,b){if(zi(p,b))return!0;if(typeof p!="object"||p===null||typeof b!="object"||b===null)return!1;var x=Object.keys(p),A=Object.keys(b);if(x.length!==A.length)return!1;for(A=0;A<x.length;A++){var U=x[A];if(!ve.call(b,U)||!zi(p[U],b[U]))return!1}return!0}function gx(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function mx(p,b){var x=gx(p);p=0;for(var A;x;){if(x.nodeType===3){if(A=p+x.textContent.length,p<=b&&A>=b)return{node:x,offset:b-p};p=A}e:{for(;x;){if(x.nextSibling){x=x.nextSibling;break e}x=x.parentNode}x=void 0}x=gx(x)}}function vx(p,b){return p&&b?p===b?!0:p&&p.nodeType===3?!1:b&&b.nodeType===3?vx(p,b.parentNode):"contains"in p?p.contains(b):p.compareDocumentPosition?!!(p.compareDocumentPosition(b)&16):!1:!1}function bx(p){p=p!=null&&p.ownerDocument!=null&&p.ownerDocument.defaultView!=null?p.ownerDocument.defaultView:window;for(var b=Ds(p.document);b instanceof p.HTMLIFrameElement;){try{var x=typeof b.contentWindow.location.href=="string"}catch{x=!1}if(x)p=b.contentWindow;else break;b=Ds(p.document)}return b}function Gm(p){var b=p&&p.nodeName&&p.nodeName.toLowerCase();return b&&(b==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||b==="textarea"||p.contentEditable==="true")}var QA=Do&&"documentMode"in document&&11>=document.documentMode,jc=null,zm=null,Hd=null,Um=!1;function wx(p,b,x){var A=x.window===x?x.document:x.nodeType===9?x:x.ownerDocument;Um||jc==null||jc!==Ds(A)||(A=jc,"selectionStart"in A&&Gm(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),Hd&&Bd(Hd,A)||(Hd=A,A=Jp(zm,"onSelect"),0<A.length&&(b=new lp("onSelect","select",null,b,x),p.push({event:b,listeners:A}),b.target=jc)))}function Rl(p,b){var x={};return x[p.toLowerCase()]=b.toLowerCase(),x["Webkit"+p]="webkit"+b,x["Moz"+p]="moz"+b,x}var Vc={animationend:Rl("Animation","AnimationEnd"),animationiteration:Rl("Animation","AnimationIteration"),animationstart:Rl("Animation","AnimationStart"),transitionrun:Rl("Transition","TransitionRun"),transitionstart:Rl("Transition","TransitionStart"),transitioncancel:Rl("Transition","TransitionCancel"),transitionend:Rl("Transition","TransitionEnd")},Wm={},yx={};Do&&(yx=document.createElement("div").style,"AnimationEvent"in window||(delete Vc.animationend.animation,delete Vc.animationiteration.animation,delete Vc.animationstart.animation),"TransitionEvent"in window||delete Vc.transitionend.transition);function Al(p){if(Wm[p])return Wm[p];if(!Vc[p])return p;var b=Vc[p],x;for(x in b)if(b.hasOwnProperty(x)&&x in yx)return Wm[p]=b[x];return p}var Cx=Al("animationend"),xx=Al("animationiteration"),Sx=Al("animationstart"),eF=Al("transitionrun"),tF=Al("transitionstart"),rF=Al("transitioncancel"),_x=Al("transitionend"),Ex=new Map,$m="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");$m.push("scrollEnd");function Is(p,b){Ex.set(p,b),ot(b,[p])}var dp=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var b=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(b))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",p);return}console.error(p)},os=[],Gc=0,qm=0;function hp(){for(var p=Gc,b=qm=Gc=0;b<p;){var x=os[b];os[b++]=null;var A=os[b];os[b++]=null;var U=os[b];os[b++]=null;var Y=os[b];if(os[b++]=null,A!==null&&U!==null){var re=A.pending;re===null?U.next=U:(U.next=re.next,re.next=U),A.pending=U}Y!==0&&Tx(x,U,Y)}}function fp(p,b,x,A){os[Gc++]=p,os[Gc++]=b,os[Gc++]=x,os[Gc++]=A,qm|=A,p.lanes|=A,p=p.alternate,p!==null&&(p.lanes|=A)}function Km(p,b,x,A){return fp(p,b,x,A),pp(p)}function Fl(p,b){return fp(p,null,null,b),pp(p)}function Tx(p,b,x){p.lanes|=x;var A=p.alternate;A!==null&&(A.lanes|=x);for(var U=!1,Y=p.return;Y!==null;)Y.childLanes|=x,A=Y.alternate,A!==null&&(A.childLanes|=x),Y.tag===22&&(p=Y.stateNode,p===null||p._visibility&1||(U=!0)),p=Y,Y=Y.return;return p.tag===3?(Y=p.stateNode,U&&b!==null&&(U=31-pt(x),p=Y.hiddenUpdates,A=p[U],A===null?p[U]=[b]:A.push(b),b.lane=x|536870912),Y):null}function pp(p){if(50<ah)throw ah=0,n1=null,Error(n(185));for(var b=p.return;b!==null;)p=b,b=p.return;return p.tag===3?p.stateNode:null}var zc={};function nF(p,b,x,A){this.tag=p,this.key=x,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=b,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ui(p,b,x,A){return new nF(p,b,x,A)}function Xm(p){return p=p.prototype,!(!p||!p.isReactComponent)}function Po(p,b){var x=p.alternate;return x===null?(x=Ui(p.tag,b,p.key,p.mode),x.elementType=p.elementType,x.type=p.type,x.stateNode=p.stateNode,x.alternate=p,p.alternate=x):(x.pendingProps=b,x.type=p.type,x.flags=0,x.subtreeFlags=0,x.deletions=null),x.flags=p.flags&65011712,x.childLanes=p.childLanes,x.lanes=p.lanes,x.child=p.child,x.memoizedProps=p.memoizedProps,x.memoizedState=p.memoizedState,x.updateQueue=p.updateQueue,b=p.dependencies,x.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext},x.sibling=p.sibling,x.index=p.index,x.ref=p.ref,x.refCleanup=p.refCleanup,x}function kx(p,b){p.flags&=65011714;var x=p.alternate;return x===null?(p.childLanes=0,p.lanes=b,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=x.childLanes,p.lanes=x.lanes,p.child=x.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=x.memoizedProps,p.memoizedState=x.memoizedState,p.updateQueue=x.updateQueue,p.type=x.type,b=x.dependencies,p.dependencies=b===null?null:{lanes:b.lanes,firstContext:b.firstContext}),p}function gp(p,b,x,A,U,Y){var re=0;if(A=p,typeof p=="function")Xm(p)&&(re=1);else if(typeof p=="string")re=lM(p,x,X.current)?26:p==="html"||p==="head"||p==="body"?27:5;else e:switch(p){case L:return p=Ui(31,x,b,U),p.elementType=L,p.lanes=Y,p;case v:return Ml(x.children,U,Y,b);case g:re=8,U|=24;break;case w:return p=Ui(12,x,b,U|2),p.elementType=w,p.lanes=Y,p;case F:return p=Ui(13,x,b,U),p.elementType=F,p.lanes=Y,p;case I:return p=Ui(19,x,b,U),p.elementType=I,p.lanes=Y,p;default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case C:re=10;break e;case y:re=9;break e;case k:re=11;break e;case N:re=14;break e;case j:re=16,A=null;break e}re=29,x=Error(n(130,p===null?"null":typeof p,"")),A=null}return b=Ui(re,x,b,U),b.elementType=p,b.type=A,b.lanes=Y,b}function Ml(p,b,x,A){return p=Ui(7,p,A,b),p.lanes=x,p}function Ym(p,b,x){return p=Ui(6,p,null,b),p.lanes=x,p}function Rx(p){var b=Ui(18,null,null,0);return b.stateNode=p,b}function Zm(p,b,x){return b=Ui(4,p.children!==null?p.children:[],p.key,b),b.lanes=x,b.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},b}var Ax=new WeakMap;function as(p,b){if(typeof p=="object"&&p!==null){var x=Ax.get(p);return x!==void 0?x:(b={value:p,source:b,stack:me(b)},Ax.set(p,b),b)}return{value:p,source:b,stack:me(b)}}var Uc=[],Wc=0,mp=null,jd=0,ls=[],cs=0,Sa=null,ro=1,no="";function Io(p,b){Uc[Wc++]=jd,Uc[Wc++]=mp,mp=p,jd=b}function Fx(p,b,x){ls[cs++]=ro,ls[cs++]=no,ls[cs++]=Sa,Sa=p;var A=ro;p=no;var U=32-pt(A)-1;A&=~(1<<U),x+=1;var Y=32-pt(b)+U;if(30<Y){var re=U-U%5;Y=(A&(1<<re)-1).toString(32),A>>=re,U-=re,ro=1<<32-pt(b)+U|x<<U|A,no=Y+p}else ro=1<<Y|x<<U|A,no=p}function Jm(p){p.return!==null&&(Io(p,1),Fx(p,1,0))}function Qm(p){for(;p===mp;)mp=Uc[--Wc],Uc[Wc]=null,jd=Uc[--Wc],Uc[Wc]=null;for(;p===Sa;)Sa=ls[--cs],ls[cs]=null,no=ls[--cs],ls[cs]=null,ro=ls[--cs],ls[cs]=null}function Mx(p,b){ls[cs++]=ro,ls[cs++]=no,ls[cs++]=Sa,ro=b.id,no=b.overflow,Sa=p}var qn=null,qr=null,wr=!1,_a=null,us=!1,ev=Error(n(519));function Ea(p){var b=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Vd(as(b,p)),ev}function Dx(p){var b=p.stateNode,x=p.type,A=p.memoizedProps;switch(b[de]=p,b[fe]=A,x){case"dialog":dr("cancel",b),dr("close",b);break;case"iframe":case"object":case"embed":dr("load",b);break;case"video":case"audio":for(x=0;x<ch.length;x++)dr(ch[x],b);break;case"source":dr("error",b);break;case"img":case"image":case"link":dr("error",b),dr("load",b);break;case"details":dr("toggle",b);break;case"input":dr("invalid",b),cr(b,A.value,A.defaultValue,A.checked,A.defaultChecked,A.type,A.name,!0);break;case"select":dr("invalid",b);break;case"textarea":dr("invalid",b),ii(b,A.value,A.defaultValue,A.children)}x=A.children,typeof x!="string"&&typeof x!="number"&&typeof x!="bigint"||b.textContent===""+x||A.suppressHydrationWarning===!0||XS(b.textContent,x)?(A.popover!=null&&(dr("beforetoggle",b),dr("toggle",b)),A.onScroll!=null&&dr("scroll",b),A.onScrollEnd!=null&&dr("scrollend",b),A.onClick!=null&&(b.onclick=Gi),b=!0):b=!1,b||Ea(p,!0)}function Px(p){for(qn=p.return;qn;)switch(qn.tag){case 5:case 31:case 13:us=!1;return;case 27:case 3:us=!0;return;default:qn=qn.return}}function $c(p){if(p!==qn)return!1;if(!wr)return Px(p),wr=!0,!1;var b=p.tag,x;if((x=b!==3&&b!==27)&&((x=b===5)&&(x=p.type,x=!(x!=="form"&&x!=="button")||b1(p.type,p.memoizedProps)),x=!x),x&&qr&&Ea(p),Px(p),b===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));qr=i_(p)}else if(b===31){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(317));qr=i_(p)}else b===27?(b=qr,Ha(p.type)?(p=S1,S1=null,qr=p):qr=b):qr=qn?hs(p.stateNode.nextSibling):null;return!0}function Dl(){qr=qn=null,wr=!1}function tv(){var p=_a;return p!==null&&(Fi===null?Fi=p:Fi.push.apply(Fi,p),_a=null),p}function Vd(p){_a===null?_a=[p]:_a.push(p)}var rv=O(null),Pl=null,Oo=null;function Ta(p,b,x){q(rv,b._currentValue),b._currentValue=x}function No(p){p._currentValue=rv.current,P(rv)}function nv(p,b,x){for(;p!==null;){var A=p.alternate;if((p.childLanes&b)!==b?(p.childLanes|=b,A!==null&&(A.childLanes|=b)):A!==null&&(A.childLanes&b)!==b&&(A.childLanes|=b),p===x)break;p=p.return}}function iv(p,b,x,A){var U=p.child;for(U!==null&&(U.return=p);U!==null;){var Y=U.dependencies;if(Y!==null){var re=U.child;Y=Y.firstContext;e:for(;Y!==null;){var he=Y;Y=U;for(var _e=0;_e<b.length;_e++)if(he.context===b[_e]){Y.lanes|=x,he=Y.alternate,he!==null&&(he.lanes|=x),nv(Y.return,x,p),A||(re=null);break e}Y=he.next}}else if(U.tag===18){if(re=U.return,re===null)throw Error(n(341));re.lanes|=x,Y=re.alternate,Y!==null&&(Y.lanes|=x),nv(re,x,p),re=null}else re=U.child;if(re!==null)re.return=U;else for(re=U;re!==null;){if(re===p){re=null;break}if(U=re.sibling,U!==null){U.return=re.return,re=U;break}re=re.return}U=re}}function qc(p,b,x,A){p=null;for(var U=b,Y=!1;U!==null;){if(!Y){if((U.flags&524288)!==0)Y=!0;else if((U.flags&262144)!==0)break}if(U.tag===10){var re=U.alternate;if(re===null)throw Error(n(387));if(re=re.memoizedProps,re!==null){var he=U.type;zi(U.pendingProps.value,re.value)||(p!==null?p.push(he):p=[he])}}else if(U===ee.current){if(re=U.alternate,re===null)throw Error(n(387));re.memoizedState.memoizedState!==U.memoizedState.memoizedState&&(p!==null?p.push(ph):p=[ph])}U=U.return}p!==null&&iv(b,p,x,A),b.flags|=262144}function vp(p){for(p=p.firstContext;p!==null;){if(!zi(p.context._currentValue,p.memoizedValue))return!0;p=p.next}return!1}function Il(p){Pl=p,Oo=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function Kn(p){return Ix(Pl,p)}function bp(p,b){return Pl===null&&Il(p),Ix(p,b)}function Ix(p,b){var x=b._currentValue;if(b={context:b,memoizedValue:x,next:null},Oo===null){if(p===null)throw Error(n(308));Oo=b,p.dependencies={lanes:0,firstContext:b},p.flags|=524288}else Oo=Oo.next=b;return x}var iF=typeof AbortController<"u"?AbortController:function(){var p=[],b=this.signal={aborted:!1,addEventListener:function(x,A){p.push(A)}};this.abort=function(){b.aborted=!0,p.forEach(function(x){return x()})}},sF=e.unstable_scheduleCallback,oF=e.unstable_NormalPriority,En={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sv(){return{controller:new iF,data:new Map,refCount:0}}function Gd(p){p.refCount--,p.refCount===0&&sF(oF,function(){p.controller.abort()})}var zd=null,ov=0,Kc=0,Xc=null;function aF(p,b){if(zd===null){var x=zd=[];ov=0,Kc=c1(),Xc={status:"pending",value:void 0,then:function(A){x.push(A)}}}return ov++,b.then(Ox,Ox),b}function Ox(){if(--ov===0&&zd!==null){Xc!==null&&(Xc.status="fulfilled");var p=zd;zd=null,Kc=0,Xc=null;for(var b=0;b<p.length;b++)(0,p[b])()}}function lF(p,b){var x=[],A={status:"pending",value:null,reason:null,then:function(U){x.push(U)}};return p.then(function(){A.status="fulfilled",A.value=b;for(var U=0;U<x.length;U++)(0,x[U])(b)},function(U){for(A.status="rejected",A.reason=U,U=0;U<x.length;U++)(0,x[U])(void 0)}),A}var Nx=S.S;S.S=function(p,b){wS=Ve(),typeof b=="object"&&b!==null&&typeof b.then=="function"&&aF(p,b),Nx!==null&&Nx(p,b)};var Ol=O(null);function av(){var p=Ol.current;return p!==null?p:Wr.pooledCache}function wp(p,b){b===null?q(Ol,Ol.current):q(Ol,b.pool)}function Lx(){var p=av();return p===null?null:{parent:En._currentValue,pool:p}}var Yc=Error(n(460)),lv=Error(n(474)),yp=Error(n(542)),Cp={then:function(){}};function Bx(p){return p=p.status,p==="fulfilled"||p==="rejected"}function Hx(p,b,x){switch(x=p[x],x===void 0?p.push(b):x!==b&&(b.then(Gi,Gi),b=x),b.status){case"fulfilled":return b.value;case"rejected":throw p=b.reason,Vx(p),p;default:if(typeof b.status=="string")b.then(Gi,Gi);else{if(p=Wr,p!==null&&100<p.shellSuspendCounter)throw Error(n(482));p=b,p.status="pending",p.then(function(A){if(b.status==="pending"){var U=b;U.status="fulfilled",U.value=A}},function(A){if(b.status==="pending"){var U=b;U.status="rejected",U.reason=A}})}switch(b.status){case"fulfilled":return b.value;case"rejected":throw p=b.reason,Vx(p),p}throw Ll=b,Yc}}function Nl(p){try{var b=p._init;return b(p._payload)}catch(x){throw x!==null&&typeof x=="object"&&typeof x.then=="function"?(Ll=x,Yc):x}}var Ll=null;function jx(){if(Ll===null)throw Error(n(459));var p=Ll;return Ll=null,p}function Vx(p){if(p===Yc||p===yp)throw Error(n(483))}var Zc=null,Ud=0;function xp(p){var b=Ud;return Ud+=1,Zc===null&&(Zc=[]),Hx(Zc,p,b)}function Wd(p,b){b=b.props.ref,p.ref=b!==void 0?b:null}function Sp(p,b){throw b.$$typeof===d?Error(n(525)):(p=Object.prototype.toString.call(b),Error(n(31,p==="[object Object]"?"object with keys {"+Object.keys(b).join(", ")+"}":p)))}function Gx(p){function b(Ne,Ae){if(p){var Ue=Ne.deletions;Ue===null?(Ne.deletions=[Ae],Ne.flags|=16):Ue.push(Ae)}}function x(Ne,Ae){if(!p)return null;for(;Ae!==null;)b(Ne,Ae),Ae=Ae.sibling;return null}function A(Ne){for(var Ae=new Map;Ne!==null;)Ne.key!==null?Ae.set(Ne.key,Ne):Ae.set(Ne.index,Ne),Ne=Ne.sibling;return Ae}function U(Ne,Ae){return Ne=Po(Ne,Ae),Ne.index=0,Ne.sibling=null,Ne}function Y(Ne,Ae,Ue){return Ne.index=Ue,p?(Ue=Ne.alternate,Ue!==null?(Ue=Ue.index,Ue<Ae?(Ne.flags|=67108866,Ae):Ue):(Ne.flags|=67108866,Ae)):(Ne.flags|=1048576,Ae)}function re(Ne){return p&&Ne.alternate===null&&(Ne.flags|=67108866),Ne}function he(Ne,Ae,Ue,rt){return Ae===null||Ae.tag!==6?(Ae=Ym(Ue,Ne.mode,rt),Ae.return=Ne,Ae):(Ae=U(Ae,Ue),Ae.return=Ne,Ae)}function _e(Ne,Ae,Ue,rt){var Ft=Ue.type;return Ft===v?tt(Ne,Ae,Ue.props.children,rt,Ue.key):Ae!==null&&(Ae.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===j&&Nl(Ft)===Ae.type)?(Ae=U(Ae,Ue.props),Wd(Ae,Ue),Ae.return=Ne,Ae):(Ae=gp(Ue.type,Ue.key,Ue.props,null,Ne.mode,rt),Wd(Ae,Ue),Ae.return=Ne,Ae)}function We(Ne,Ae,Ue,rt){return Ae===null||Ae.tag!==4||Ae.stateNode.containerInfo!==Ue.containerInfo||Ae.stateNode.implementation!==Ue.implementation?(Ae=Zm(Ue,Ne.mode,rt),Ae.return=Ne,Ae):(Ae=U(Ae,Ue.children||[]),Ae.return=Ne,Ae)}function tt(Ne,Ae,Ue,rt,Ft){return Ae===null||Ae.tag!==7?(Ae=Ml(Ue,Ne.mode,rt,Ft),Ae.return=Ne,Ae):(Ae=U(Ae,Ue),Ae.return=Ne,Ae)}function it(Ne,Ae,Ue){if(typeof Ae=="string"&&Ae!==""||typeof Ae=="number"||typeof Ae=="bigint")return Ae=Ym(""+Ae,Ne.mode,Ue),Ae.return=Ne,Ae;if(typeof Ae=="object"&&Ae!==null){switch(Ae.$$typeof){case f:return Ue=gp(Ae.type,Ae.key,Ae.props,null,Ne.mode,Ue),Wd(Ue,Ae),Ue.return=Ne,Ue;case m:return Ae=Zm(Ae,Ne.mode,Ue),Ae.return=Ne,Ae;case j:return Ae=Nl(Ae),it(Ne,Ae,Ue)}if(R(Ae)||z(Ae))return Ae=Ml(Ae,Ne.mode,Ue,null),Ae.return=Ne,Ae;if(typeof Ae.then=="function")return it(Ne,xp(Ae),Ue);if(Ae.$$typeof===C)return it(Ne,bp(Ne,Ae),Ue);Sp(Ne,Ae)}return null}function qe(Ne,Ae,Ue,rt){var Ft=Ae!==null?Ae.key:null;if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint")return Ft!==null?null:he(Ne,Ae,""+Ue,rt);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case f:return Ue.key===Ft?_e(Ne,Ae,Ue,rt):null;case m:return Ue.key===Ft?We(Ne,Ae,Ue,rt):null;case j:return Ue=Nl(Ue),qe(Ne,Ae,Ue,rt)}if(R(Ue)||z(Ue))return Ft!==null?null:tt(Ne,Ae,Ue,rt,null);if(typeof Ue.then=="function")return qe(Ne,Ae,xp(Ue),rt);if(Ue.$$typeof===C)return qe(Ne,Ae,bp(Ne,Ue),rt);Sp(Ne,Ue)}return null}function Ke(Ne,Ae,Ue,rt,Ft){if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return Ne=Ne.get(Ue)||null,he(Ae,Ne,""+rt,Ft);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case f:return Ne=Ne.get(rt.key===null?Ue:rt.key)||null,_e(Ae,Ne,rt,Ft);case m:return Ne=Ne.get(rt.key===null?Ue:rt.key)||null,We(Ae,Ne,rt,Ft);case j:return rt=Nl(rt),Ke(Ne,Ae,Ue,rt,Ft)}if(R(rt)||z(rt))return Ne=Ne.get(Ue)||null,tt(Ae,Ne,rt,Ft,null);if(typeof rt.then=="function")return Ke(Ne,Ae,Ue,xp(rt),Ft);if(rt.$$typeof===C)return Ke(Ne,Ae,Ue,bp(Ae,rt),Ft);Sp(Ae,rt)}return null}function St(Ne,Ae,Ue,rt){for(var Ft=null,_r=null,Et=Ae,tr=Ae=0,mr=null;Et!==null&&tr<Ue.length;tr++){Et.index>tr?(mr=Et,Et=null):mr=Et.sibling;var Er=qe(Ne,Et,Ue[tr],rt);if(Er===null){Et===null&&(Et=mr);break}p&&Et&&Er.alternate===null&&b(Ne,Et),Ae=Y(Er,Ae,tr),_r===null?Ft=Er:_r.sibling=Er,_r=Er,Et=mr}if(tr===Ue.length)return x(Ne,Et),wr&&Io(Ne,tr),Ft;if(Et===null){for(;tr<Ue.length;tr++)Et=it(Ne,Ue[tr],rt),Et!==null&&(Ae=Y(Et,Ae,tr),_r===null?Ft=Et:_r.sibling=Et,_r=Et);return wr&&Io(Ne,tr),Ft}for(Et=A(Et);tr<Ue.length;tr++)mr=Ke(Et,Ne,tr,Ue[tr],rt),mr!==null&&(p&&mr.alternate!==null&&Et.delete(mr.key===null?tr:mr.key),Ae=Y(mr,Ae,tr),_r===null?Ft=mr:_r.sibling=mr,_r=mr);return p&&Et.forEach(function(Ua){return b(Ne,Ua)}),wr&&Io(Ne,tr),Ft}function Bt(Ne,Ae,Ue,rt){if(Ue==null)throw Error(n(151));for(var Ft=null,_r=null,Et=Ae,tr=Ae=0,mr=null,Er=Ue.next();Et!==null&&!Er.done;tr++,Er=Ue.next()){Et.index>tr?(mr=Et,Et=null):mr=Et.sibling;var Ua=qe(Ne,Et,Er.value,rt);if(Ua===null){Et===null&&(Et=mr);break}p&&Et&&Ua.alternate===null&&b(Ne,Et),Ae=Y(Ua,Ae,tr),_r===null?Ft=Ua:_r.sibling=Ua,_r=Ua,Et=mr}if(Er.done)return x(Ne,Et),wr&&Io(Ne,tr),Ft;if(Et===null){for(;!Er.done;tr++,Er=Ue.next())Er=it(Ne,Er.value,rt),Er!==null&&(Ae=Y(Er,Ae,tr),_r===null?Ft=Er:_r.sibling=Er,_r=Er);return wr&&Io(Ne,tr),Ft}for(Et=A(Et);!Er.done;tr++,Er=Ue.next())Er=Ke(Et,Ne,tr,Er.value,rt),Er!==null&&(p&&Er.alternate!==null&&Et.delete(Er.key===null?tr:Er.key),Ae=Y(Er,Ae,tr),_r===null?Ft=Er:_r.sibling=Er,_r=Er);return p&&Et.forEach(function(wM){return b(Ne,wM)}),wr&&Io(Ne,tr),Ft}function Vr(Ne,Ae,Ue,rt){if(typeof Ue=="object"&&Ue!==null&&Ue.type===v&&Ue.key===null&&(Ue=Ue.props.children),typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case f:e:{for(var Ft=Ue.key;Ae!==null;){if(Ae.key===Ft){if(Ft=Ue.type,Ft===v){if(Ae.tag===7){x(Ne,Ae.sibling),rt=U(Ae,Ue.props.children),rt.return=Ne,Ne=rt;break e}}else if(Ae.elementType===Ft||typeof Ft=="object"&&Ft!==null&&Ft.$$typeof===j&&Nl(Ft)===Ae.type){x(Ne,Ae.sibling),rt=U(Ae,Ue.props),Wd(rt,Ue),rt.return=Ne,Ne=rt;break e}x(Ne,Ae);break}else b(Ne,Ae);Ae=Ae.sibling}Ue.type===v?(rt=Ml(Ue.props.children,Ne.mode,rt,Ue.key),rt.return=Ne,Ne=rt):(rt=gp(Ue.type,Ue.key,Ue.props,null,Ne.mode,rt),Wd(rt,Ue),rt.return=Ne,Ne=rt)}return re(Ne);case m:e:{for(Ft=Ue.key;Ae!==null;){if(Ae.key===Ft)if(Ae.tag===4&&Ae.stateNode.containerInfo===Ue.containerInfo&&Ae.stateNode.implementation===Ue.implementation){x(Ne,Ae.sibling),rt=U(Ae,Ue.children||[]),rt.return=Ne,Ne=rt;break e}else{x(Ne,Ae);break}else b(Ne,Ae);Ae=Ae.sibling}rt=Zm(Ue,Ne.mode,rt),rt.return=Ne,Ne=rt}return re(Ne);case j:return Ue=Nl(Ue),Vr(Ne,Ae,Ue,rt)}if(R(Ue))return St(Ne,Ae,Ue,rt);if(z(Ue)){if(Ft=z(Ue),typeof Ft!="function")throw Error(n(150));return Ue=Ft.call(Ue),Bt(Ne,Ae,Ue,rt)}if(typeof Ue.then=="function")return Vr(Ne,Ae,xp(Ue),rt);if(Ue.$$typeof===C)return Vr(Ne,Ae,bp(Ne,Ue),rt);Sp(Ne,Ue)}return typeof Ue=="string"&&Ue!==""||typeof Ue=="number"||typeof Ue=="bigint"?(Ue=""+Ue,Ae!==null&&Ae.tag===6?(x(Ne,Ae.sibling),rt=U(Ae,Ue),rt.return=Ne,Ne=rt):(x(Ne,Ae),rt=Ym(Ue,Ne.mode,rt),rt.return=Ne,Ne=rt),re(Ne)):x(Ne,Ae)}return function(Ne,Ae,Ue,rt){try{Ud=0;var Ft=Vr(Ne,Ae,Ue,rt);return Zc=null,Ft}catch(Et){if(Et===Yc||Et===yp)throw Et;var _r=Ui(29,Et,null,Ne.mode);return _r.lanes=rt,_r.return=Ne,_r}}}var Bl=Gx(!0),zx=Gx(!1),ka=!1;function cv(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function uv(p,b){p=p.updateQueue,b.updateQueue===p&&(b.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function Ra(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function Aa(p,b,x){var A=p.updateQueue;if(A===null)return null;if(A=A.shared,(kr&2)!==0){var U=A.pending;return U===null?b.next=b:(b.next=U.next,U.next=b),A.pending=b,b=pp(p),Tx(p,null,x),b}return fp(p,A,b,x),pp(p)}function $d(p,b,x){if(b=b.updateQueue,b!==null&&(b=b.shared,(x&4194048)!==0)){var A=b.lanes;A&=p.pendingLanes,x|=A,b.lanes=x,Ot(p,x)}}function dv(p,b){var x=p.updateQueue,A=p.alternate;if(A!==null&&(A=A.updateQueue,x===A)){var U=null,Y=null;if(x=x.firstBaseUpdate,x!==null){do{var re={lane:x.lane,tag:x.tag,payload:x.payload,callback:null,next:null};Y===null?U=Y=re:Y=Y.next=re,x=x.next}while(x!==null);Y===null?U=Y=b:Y=Y.next=b}else U=Y=b;x={baseState:A.baseState,firstBaseUpdate:U,lastBaseUpdate:Y,shared:A.shared,callbacks:A.callbacks},p.updateQueue=x;return}p=x.lastBaseUpdate,p===null?x.firstBaseUpdate=b:p.next=b,x.lastBaseUpdate=b}var hv=!1;function qd(){if(hv){var p=Xc;if(p!==null)throw p}}function Kd(p,b,x,A){hv=!1;var U=p.updateQueue;ka=!1;var Y=U.firstBaseUpdate,re=U.lastBaseUpdate,he=U.shared.pending;if(he!==null){U.shared.pending=null;var _e=he,We=_e.next;_e.next=null,re===null?Y=We:re.next=We,re=_e;var tt=p.alternate;tt!==null&&(tt=tt.updateQueue,he=tt.lastBaseUpdate,he!==re&&(he===null?tt.firstBaseUpdate=We:he.next=We,tt.lastBaseUpdate=_e))}if(Y!==null){var it=U.baseState;re=0,tt=We=_e=null,he=Y;do{var qe=he.lane&-536870913,Ke=qe!==he.lane;if(Ke?(gr&qe)===qe:(A&qe)===qe){qe!==0&&qe===Kc&&(hv=!0),tt!==null&&(tt=tt.next={lane:0,tag:he.tag,payload:he.payload,callback:null,next:null});e:{var St=p,Bt=he;qe=b;var Vr=x;switch(Bt.tag){case 1:if(St=Bt.payload,typeof St=="function"){it=St.call(Vr,it,qe);break e}it=St;break e;case 3:St.flags=St.flags&-65537|128;case 0:if(St=Bt.payload,qe=typeof St=="function"?St.call(Vr,it,qe):St,qe==null)break e;it=h({},it,qe);break e;case 2:ka=!0}}qe=he.callback,qe!==null&&(p.flags|=64,Ke&&(p.flags|=8192),Ke=U.callbacks,Ke===null?U.callbacks=[qe]:Ke.push(qe))}else Ke={lane:qe,tag:he.tag,payload:he.payload,callback:he.callback,next:null},tt===null?(We=tt=Ke,_e=it):tt=tt.next=Ke,re|=qe;if(he=he.next,he===null){if(he=U.shared.pending,he===null)break;Ke=he,he=Ke.next,Ke.next=null,U.lastBaseUpdate=Ke,U.shared.pending=null}}while(!0);tt===null&&(_e=it),U.baseState=_e,U.firstBaseUpdate=We,U.lastBaseUpdate=tt,Y===null&&(U.shared.lanes=0),Ia|=re,p.lanes=re,p.memoizedState=it}}function Ux(p,b){if(typeof p!="function")throw Error(n(191,p));p.call(b)}function Wx(p,b){var x=p.callbacks;if(x!==null)for(p.callbacks=null,p=0;p<x.length;p++)Ux(x[p],b)}var Jc=O(null),_p=O(0);function $x(p,b){p=Wo,q(_p,p),q(Jc,b),Wo=p|b.baseLanes}function fv(){q(_p,Wo),q(Jc,Jc.current)}function pv(){Wo=_p.current,P(Jc),P(_p)}var Wi=O(null),ds=null;function Fa(p){var b=p.alternate;q(mn,mn.current&1),q(Wi,p),ds===null&&(b===null||Jc.current!==null||b.memoizedState!==null)&&(ds=p)}function gv(p){q(mn,mn.current),q(Wi,p),ds===null&&(ds=p)}function qx(p){p.tag===22?(q(mn,mn.current),q(Wi,p),ds===null&&(ds=p)):Ma()}function Ma(){q(mn,mn.current),q(Wi,Wi.current)}function $i(p){P(Wi),ds===p&&(ds=null),P(mn)}var mn=O(0);function Ep(p){for(var b=p;b!==null;){if(b.tag===13){var x=b.memoizedState;if(x!==null&&(x=x.dehydrated,x===null||C1(x)||x1(x)))return b}else if(b.tag===19&&(b.memoizedProps.revealOrder==="forwards"||b.memoizedProps.revealOrder==="backwards"||b.memoizedProps.revealOrder==="unstable_legacy-backwards"||b.memoizedProps.revealOrder==="together")){if((b.flags&128)!==0)return b}else if(b.child!==null){b.child.return=b,b=b.child;continue}if(b===p)break;for(;b.sibling===null;){if(b.return===null||b.return===p)return null;b=b.return}b.sibling.return=b.return,b=b.sibling}return null}var Lo=0,Qt=null,Hr=null,Tn=null,Tp=!1,Qc=!1,Hl=!1,kp=0,Xd=0,eu=null,cF=0;function an(){throw Error(n(321))}function mv(p,b){if(b===null)return!1;for(var x=0;x<b.length&&x<p.length;x++)if(!zi(p[x],b[x]))return!1;return!0}function vv(p,b,x,A,U,Y){return Lo=Y,Qt=b,b.memoizedState=null,b.updateQueue=null,b.lanes=0,S.H=p===null||p.memoizedState===null?F2:Dv,Hl=!1,Y=x(A,U),Hl=!1,Qc&&(Y=Xx(b,x,A,U)),Kx(p),Y}function Kx(p){S.H=Jd;var b=Hr!==null&&Hr.next!==null;if(Lo=0,Tn=Hr=Qt=null,Tp=!1,Xd=0,eu=null,b)throw Error(n(300));p===null||kn||(p=p.dependencies,p!==null&&vp(p)&&(kn=!0))}function Xx(p,b,x,A){Qt=p;var U=0;do{if(Qc&&(eu=null),Xd=0,Qc=!1,25<=U)throw Error(n(301));if(U+=1,Tn=Hr=null,p.updateQueue!=null){var Y=p.updateQueue;Y.lastEffect=null,Y.events=null,Y.stores=null,Y.memoCache!=null&&(Y.memoCache.index=0)}S.H=M2,Y=b(x,A)}while(Qc);return Y}function uF(){var p=S.H,b=p.useState()[0];return b=typeof b.then=="function"?Yd(b):b,p=p.useState()[0],(Hr!==null?Hr.memoizedState:null)!==p&&(Qt.flags|=1024),b}function bv(){var p=kp!==0;return kp=0,p}function wv(p,b,x){b.updateQueue=p.updateQueue,b.flags&=-2053,p.lanes&=~x}function yv(p){if(Tp){for(p=p.memoizedState;p!==null;){var b=p.queue;b!==null&&(b.pending=null),p=p.next}Tp=!1}Lo=0,Tn=Hr=Qt=null,Qc=!1,Xd=kp=0,eu=null}function wi(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Tn===null?Qt.memoizedState=Tn=p:Tn=Tn.next=p,Tn}function vn(){if(Hr===null){var p=Qt.alternate;p=p!==null?p.memoizedState:null}else p=Hr.next;var b=Tn===null?Qt.memoizedState:Tn.next;if(b!==null)Tn=b,Hr=p;else{if(p===null)throw Qt.alternate===null?Error(n(467)):Error(n(310));Hr=p,p={memoizedState:Hr.memoizedState,baseState:Hr.baseState,baseQueue:Hr.baseQueue,queue:Hr.queue,next:null},Tn===null?Qt.memoizedState=Tn=p:Tn=Tn.next=p}return Tn}function Rp(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Yd(p){var b=Xd;return Xd+=1,eu===null&&(eu=[]),p=Hx(eu,p,b),b=Qt,(Tn===null?b.memoizedState:Tn.next)===null&&(b=b.alternate,S.H=b===null||b.memoizedState===null?F2:Dv),p}function Ap(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return Yd(p);if(p.$$typeof===C)return Kn(p)}throw Error(n(438,String(p)))}function Cv(p){var b=null,x=Qt.updateQueue;if(x!==null&&(b=x.memoCache),b==null){var A=Qt.alternate;A!==null&&(A=A.updateQueue,A!==null&&(A=A.memoCache,A!=null&&(b={data:A.data.map(function(U){return U.slice()}),index:0})))}if(b==null&&(b={data:[],index:0}),x===null&&(x=Rp(),Qt.updateQueue=x),x.memoCache=b,x=b.data[b.index],x===void 0)for(x=b.data[b.index]=Array(p),A=0;A<p;A++)x[A]=W;return b.index++,x}function Bo(p,b){return typeof b=="function"?b(p):b}function Fp(p){var b=vn();return xv(b,Hr,p)}function xv(p,b,x){var A=p.queue;if(A===null)throw Error(n(311));A.lastRenderedReducer=x;var U=p.baseQueue,Y=A.pending;if(Y!==null){if(U!==null){var re=U.next;U.next=Y.next,Y.next=re}b.baseQueue=U=Y,A.pending=null}if(Y=p.baseState,U===null)p.memoizedState=Y;else{b=U.next;var he=re=null,_e=null,We=b,tt=!1;do{var it=We.lane&-536870913;if(it!==We.lane?(gr&it)===it:(Lo&it)===it){var qe=We.revertLane;if(qe===0)_e!==null&&(_e=_e.next={lane:0,revertLane:0,gesture:null,action:We.action,hasEagerState:We.hasEagerState,eagerState:We.eagerState,next:null}),it===Kc&&(tt=!0);else if((Lo&qe)===qe){We=We.next,qe===Kc&&(tt=!0);continue}else it={lane:0,revertLane:We.revertLane,gesture:null,action:We.action,hasEagerState:We.hasEagerState,eagerState:We.eagerState,next:null},_e===null?(he=_e=it,re=Y):_e=_e.next=it,Qt.lanes|=qe,Ia|=qe;it=We.action,Hl&&x(Y,it),Y=We.hasEagerState?We.eagerState:x(Y,it)}else qe={lane:it,revertLane:We.revertLane,gesture:We.gesture,action:We.action,hasEagerState:We.hasEagerState,eagerState:We.eagerState,next:null},_e===null?(he=_e=qe,re=Y):_e=_e.next=qe,Qt.lanes|=it,Ia|=it;We=We.next}while(We!==null&&We!==b);if(_e===null?re=Y:_e.next=he,!zi(Y,p.memoizedState)&&(kn=!0,tt&&(x=Xc,x!==null)))throw x;p.memoizedState=Y,p.baseState=re,p.baseQueue=_e,A.lastRenderedState=Y}return U===null&&(A.lanes=0),[p.memoizedState,A.dispatch]}function Sv(p){var b=vn(),x=b.queue;if(x===null)throw Error(n(311));x.lastRenderedReducer=p;var A=x.dispatch,U=x.pending,Y=b.memoizedState;if(U!==null){x.pending=null;var re=U=U.next;do Y=p(Y,re.action),re=re.next;while(re!==U);zi(Y,b.memoizedState)||(kn=!0),b.memoizedState=Y,b.baseQueue===null&&(b.baseState=Y),x.lastRenderedState=Y}return[Y,A]}function Yx(p,b,x){var A=Qt,U=vn(),Y=wr;if(Y){if(x===void 0)throw Error(n(407));x=x()}else x=b();var re=!zi((Hr||U).memoizedState,x);if(re&&(U.memoizedState=x,kn=!0),U=U.queue,Tv(Qx.bind(null,A,U,p),[p]),U.getSnapshot!==b||re||Tn!==null&&Tn.memoizedState.tag&1){if(A.flags|=2048,tu(9,{destroy:void 0},Jx.bind(null,A,U,x,b),null),Wr===null)throw Error(n(349));Y||(Lo&127)!==0||Zx(A,b,x)}return x}function Zx(p,b,x){p.flags|=16384,p={getSnapshot:b,value:x},b=Qt.updateQueue,b===null?(b=Rp(),Qt.updateQueue=b,b.stores=[p]):(x=b.stores,x===null?b.stores=[p]:x.push(p))}function Jx(p,b,x,A){b.value=x,b.getSnapshot=A,e2(b)&&t2(p)}function Qx(p,b,x){return x(function(){e2(b)&&t2(p)})}function e2(p){var b=p.getSnapshot;p=p.value;try{var x=b();return!zi(p,x)}catch{return!0}}function t2(p){var b=Fl(p,2);b!==null&&Mi(b,p,2)}function _v(p){var b=wi();if(typeof p=="function"){var x=p;if(p=x(),Hl){Ze(!0);try{x()}finally{Ze(!1)}}}return b.memoizedState=b.baseState=p,b.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bo,lastRenderedState:p},b}function r2(p,b,x,A){return p.baseState=x,xv(p,Hr,typeof A=="function"?A:Bo)}function dF(p,b,x,A,U){if(Pp(p))throw Error(n(485));if(p=b.action,p!==null){var Y={payload:U,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(re){Y.listeners.push(re)}};S.T!==null?x(!0):Y.isTransition=!1,A(Y),x=b.pending,x===null?(Y.next=b.pending=Y,n2(b,Y)):(Y.next=x.next,b.pending=x.next=Y)}}function n2(p,b){var x=b.action,A=b.payload,U=p.state;if(b.isTransition){var Y=S.T,re={};S.T=re;try{var he=x(U,A),_e=S.S;_e!==null&&_e(re,he),i2(p,b,he)}catch(We){Ev(p,b,We)}finally{Y!==null&&re.types!==null&&(Y.types=re.types),S.T=Y}}else try{Y=x(U,A),i2(p,b,Y)}catch(We){Ev(p,b,We)}}function i2(p,b,x){x!==null&&typeof x=="object"&&typeof x.then=="function"?x.then(function(A){s2(p,b,A)},function(A){return Ev(p,b,A)}):s2(p,b,x)}function s2(p,b,x){b.status="fulfilled",b.value=x,o2(b),p.state=x,b=p.pending,b!==null&&(x=b.next,x===b?p.pending=null:(x=x.next,b.next=x,n2(p,x)))}function Ev(p,b,x){var A=p.pending;if(p.pending=null,A!==null){A=A.next;do b.status="rejected",b.reason=x,o2(b),b=b.next;while(b!==A)}p.action=null}function o2(p){p=p.listeners;for(var b=0;b<p.length;b++)(0,p[b])()}function a2(p,b){return b}function l2(p,b){if(wr){var x=Wr.formState;if(x!==null){e:{var A=Qt;if(wr){if(qr){t:{for(var U=qr,Y=us;U.nodeType!==8;){if(!Y){U=null;break t}if(U=hs(U.nextSibling),U===null){U=null;break t}}Y=U.data,U=Y==="F!"||Y==="F"?U:null}if(U){qr=hs(U.nextSibling),A=U.data==="F!";break e}}Ea(A)}A=!1}A&&(b=x[0])}}return x=wi(),x.memoizedState=x.baseState=b,A={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a2,lastRenderedState:b},x.queue=A,x=k2.bind(null,Qt,A),A.dispatch=x,A=_v(!1),Y=Mv.bind(null,Qt,!1,A.queue),A=wi(),U={state:b,dispatch:null,action:p,pending:null},A.queue=U,x=dF.bind(null,Qt,U,Y,x),U.dispatch=x,A.memoizedState=p,[b,x,!1]}function c2(p){var b=vn();return u2(b,Hr,p)}function u2(p,b,x){if(b=xv(p,b,a2)[0],p=Fp(Bo)[0],typeof b=="object"&&b!==null&&typeof b.then=="function")try{var A=Yd(b)}catch(re){throw re===Yc?yp:re}else A=b;b=vn();var U=b.queue,Y=U.dispatch;return x!==b.memoizedState&&(Qt.flags|=2048,tu(9,{destroy:void 0},hF.bind(null,U,x),null)),[A,Y,p]}function hF(p,b){p.action=b}function d2(p){var b=vn(),x=Hr;if(x!==null)return u2(b,x,p);vn(),b=b.memoizedState,x=vn();var A=x.queue.dispatch;return x.memoizedState=p,[b,A,!1]}function tu(p,b,x,A){return p={tag:p,create:x,deps:A,inst:b,next:null},b=Qt.updateQueue,b===null&&(b=Rp(),Qt.updateQueue=b),x=b.lastEffect,x===null?b.lastEffect=p.next=p:(A=x.next,x.next=p,p.next=A,b.lastEffect=p),p}function h2(){return vn().memoizedState}function Mp(p,b,x,A){var U=wi();Qt.flags|=p,U.memoizedState=tu(1|b,{destroy:void 0},x,A===void 0?null:A)}function Dp(p,b,x,A){var U=vn();A=A===void 0?null:A;var Y=U.memoizedState.inst;Hr!==null&&A!==null&&mv(A,Hr.memoizedState.deps)?U.memoizedState=tu(b,Y,x,A):(Qt.flags|=p,U.memoizedState=tu(1|b,Y,x,A))}function f2(p,b){Mp(8390656,8,p,b)}function Tv(p,b){Dp(2048,8,p,b)}function fF(p){Qt.flags|=4;var b=Qt.updateQueue;if(b===null)b=Rp(),Qt.updateQueue=b,b.events=[p];else{var x=b.events;x===null?b.events=[p]:x.push(p)}}function p2(p){var b=vn().memoizedState;return fF({ref:b,nextImpl:p}),function(){if((kr&2)!==0)throw Error(n(440));return b.impl.apply(void 0,arguments)}}function g2(p,b){return Dp(4,2,p,b)}function m2(p,b){return Dp(4,4,p,b)}function v2(p,b){if(typeof b=="function"){p=p();var x=b(p);return function(){typeof x=="function"?x():b(null)}}if(b!=null)return p=p(),b.current=p,function(){b.current=null}}function b2(p,b,x){x=x!=null?x.concat([p]):null,Dp(4,4,v2.bind(null,b,p),x)}function kv(){}function w2(p,b){var x=vn();b=b===void 0?null:b;var A=x.memoizedState;return b!==null&&mv(b,A[1])?A[0]:(x.memoizedState=[p,b],p)}function y2(p,b){var x=vn();b=b===void 0?null:b;var A=x.memoizedState;if(b!==null&&mv(b,A[1]))return A[0];if(A=p(),Hl){Ze(!0);try{p()}finally{Ze(!1)}}return x.memoizedState=[A,b],A}function Rv(p,b,x){return x===void 0||(Lo&1073741824)!==0&&(gr&261930)===0?p.memoizedState=b:(p.memoizedState=x,p=CS(),Qt.lanes|=p,Ia|=p,x)}function C2(p,b,x,A){return zi(x,b)?x:Jc.current!==null?(p=Rv(p,x,A),zi(p,b)||(kn=!0),p):(Lo&42)===0||(Lo&1073741824)!==0&&(gr&261930)===0?(kn=!0,p.memoizedState=x):(p=CS(),Qt.lanes|=p,Ia|=p,b)}function x2(p,b,x,A,U){var Y=_.p;_.p=Y!==0&&8>Y?Y:8;var re=S.T,he={};S.T=he,Mv(p,!1,b,x);try{var _e=U(),We=S.S;if(We!==null&&We(he,_e),_e!==null&&typeof _e=="object"&&typeof _e.then=="function"){var tt=lF(_e,A);Zd(p,b,tt,Xi(p))}else Zd(p,b,A,Xi(p))}catch(it){Zd(p,b,{then:function(){},status:"rejected",reason:it},Xi())}finally{_.p=Y,re!==null&&he.types!==null&&(re.types=he.types),S.T=re}}function pF(){}function Av(p,b,x,A){if(p.tag!==5)throw Error(n(476));var U=S2(p).queue;x2(p,U,b,T,x===null?pF:function(){return _2(p),x(A)})}function S2(p){var b=p.memoizedState;if(b!==null)return b;b={memoizedState:T,baseState:T,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bo,lastRenderedState:T},next:null};var x={};return b.next={memoizedState:x,baseState:x,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Bo,lastRenderedState:x},next:null},p.memoizedState=b,p=p.alternate,p!==null&&(p.memoizedState=b),b}function _2(p){var b=S2(p);b.next===null&&(b=p.alternate.memoizedState),Zd(p,b.next.queue,{},Xi())}function Fv(){return Kn(ph)}function E2(){return vn().memoizedState}function T2(){return vn().memoizedState}function gF(p){for(var b=p.return;b!==null;){switch(b.tag){case 24:case 3:var x=Xi();p=Ra(x);var A=Aa(b,p,x);A!==null&&(Mi(A,b,x),$d(A,b,x)),b={cache:sv()},p.payload=b;return}b=b.return}}function mF(p,b,x){var A=Xi();x={lane:A,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null},Pp(p)?R2(b,x):(x=Km(p,b,x,A),x!==null&&(Mi(x,p,A),A2(x,b,A)))}function k2(p,b,x){var A=Xi();Zd(p,b,x,A)}function Zd(p,b,x,A){var U={lane:A,revertLane:0,gesture:null,action:x,hasEagerState:!1,eagerState:null,next:null};if(Pp(p))R2(b,U);else{var Y=p.alternate;if(p.lanes===0&&(Y===null||Y.lanes===0)&&(Y=b.lastRenderedReducer,Y!==null))try{var re=b.lastRenderedState,he=Y(re,x);if(U.hasEagerState=!0,U.eagerState=he,zi(he,re))return fp(p,b,U,0),Wr===null&&hp(),!1}catch{}if(x=Km(p,b,U,A),x!==null)return Mi(x,p,A),A2(x,b,A),!0}return!1}function Mv(p,b,x,A){if(A={lane:2,revertLane:c1(),gesture:null,action:A,hasEagerState:!1,eagerState:null,next:null},Pp(p)){if(b)throw Error(n(479))}else b=Km(p,x,A,2),b!==null&&Mi(b,p,2)}function Pp(p){var b=p.alternate;return p===Qt||b!==null&&b===Qt}function R2(p,b){Qc=Tp=!0;var x=p.pending;x===null?b.next=b:(b.next=x.next,x.next=b),p.pending=b}function A2(p,b,x){if((x&4194048)!==0){var A=b.lanes;A&=p.pendingLanes,x|=A,b.lanes=x,Ot(p,x)}}var Jd={readContext:Kn,use:Ap,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useLayoutEffect:an,useInsertionEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useSyncExternalStore:an,useId:an,useHostTransitionStatus:an,useFormState:an,useActionState:an,useOptimistic:an,useMemoCache:an,useCacheRefresh:an};Jd.useEffectEvent=an;var F2={readContext:Kn,use:Ap,useCallback:function(p,b){return wi().memoizedState=[p,b===void 0?null:b],p},useContext:Kn,useEffect:f2,useImperativeHandle:function(p,b,x){x=x!=null?x.concat([p]):null,Mp(4194308,4,v2.bind(null,b,p),x)},useLayoutEffect:function(p,b){return Mp(4194308,4,p,b)},useInsertionEffect:function(p,b){Mp(4,2,p,b)},useMemo:function(p,b){var x=wi();b=b===void 0?null:b;var A=p();if(Hl){Ze(!0);try{p()}finally{Ze(!1)}}return x.memoizedState=[A,b],A},useReducer:function(p,b,x){var A=wi();if(x!==void 0){var U=x(b);if(Hl){Ze(!0);try{x(b)}finally{Ze(!1)}}}else U=b;return A.memoizedState=A.baseState=U,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:U},A.queue=p,p=p.dispatch=mF.bind(null,Qt,p),[A.memoizedState,p]},useRef:function(p){var b=wi();return p={current:p},b.memoizedState=p},useState:function(p){p=_v(p);var b=p.queue,x=k2.bind(null,Qt,b);return b.dispatch=x,[p.memoizedState,x]},useDebugValue:kv,useDeferredValue:function(p,b){var x=wi();return Rv(x,p,b)},useTransition:function(){var p=_v(!1);return p=x2.bind(null,Qt,p.queue,!0,!1),wi().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,b,x){var A=Qt,U=wi();if(wr){if(x===void 0)throw Error(n(407));x=x()}else{if(x=b(),Wr===null)throw Error(n(349));(gr&127)!==0||Zx(A,b,x)}U.memoizedState=x;var Y={value:x,getSnapshot:b};return U.queue=Y,f2(Qx.bind(null,A,Y,p),[p]),A.flags|=2048,tu(9,{destroy:void 0},Jx.bind(null,A,Y,x,b),null),x},useId:function(){var p=wi(),b=Wr.identifierPrefix;if(wr){var x=no,A=ro;x=(A&~(1<<32-pt(A)-1)).toString(32)+x,b="_"+b+"R_"+x,x=kp++,0<x&&(b+="H"+x.toString(32)),b+="_"}else x=cF++,b="_"+b+"r_"+x.toString(32)+"_";return p.memoizedState=b},useHostTransitionStatus:Fv,useFormState:l2,useActionState:l2,useOptimistic:function(p){var b=wi();b.memoizedState=b.baseState=p;var x={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return b.queue=x,b=Mv.bind(null,Qt,!0,x),x.dispatch=b,[p,b]},useMemoCache:Cv,useCacheRefresh:function(){return wi().memoizedState=gF.bind(null,Qt)},useEffectEvent:function(p){var b=wi(),x={impl:p};return b.memoizedState=x,function(){if((kr&2)!==0)throw Error(n(440));return x.impl.apply(void 0,arguments)}}},Dv={readContext:Kn,use:Ap,useCallback:w2,useContext:Kn,useEffect:Tv,useImperativeHandle:b2,useInsertionEffect:g2,useLayoutEffect:m2,useMemo:y2,useReducer:Fp,useRef:h2,useState:function(){return Fp(Bo)},useDebugValue:kv,useDeferredValue:function(p,b){var x=vn();return C2(x,Hr.memoizedState,p,b)},useTransition:function(){var p=Fp(Bo)[0],b=vn().memoizedState;return[typeof p=="boolean"?p:Yd(p),b]},useSyncExternalStore:Yx,useId:E2,useHostTransitionStatus:Fv,useFormState:c2,useActionState:c2,useOptimistic:function(p,b){var x=vn();return r2(x,Hr,p,b)},useMemoCache:Cv,useCacheRefresh:T2};Dv.useEffectEvent=p2;var M2={readContext:Kn,use:Ap,useCallback:w2,useContext:Kn,useEffect:Tv,useImperativeHandle:b2,useInsertionEffect:g2,useLayoutEffect:m2,useMemo:y2,useReducer:Sv,useRef:h2,useState:function(){return Sv(Bo)},useDebugValue:kv,useDeferredValue:function(p,b){var x=vn();return Hr===null?Rv(x,p,b):C2(x,Hr.memoizedState,p,b)},useTransition:function(){var p=Sv(Bo)[0],b=vn().memoizedState;return[typeof p=="boolean"?p:Yd(p),b]},useSyncExternalStore:Yx,useId:E2,useHostTransitionStatus:Fv,useFormState:d2,useActionState:d2,useOptimistic:function(p,b){var x=vn();return Hr!==null?r2(x,Hr,p,b):(x.baseState=p,[p,x.queue.dispatch])},useMemoCache:Cv,useCacheRefresh:T2};M2.useEffectEvent=p2;function Pv(p,b,x,A){b=p.memoizedState,x=x(A,b),x=x==null?b:h({},b,x),p.memoizedState=x,p.lanes===0&&(p.updateQueue.baseState=x)}var Iv={enqueueSetState:function(p,b,x){p=p._reactInternals;var A=Xi(),U=Ra(A);U.payload=b,x!=null&&(U.callback=x),b=Aa(p,U,A),b!==null&&(Mi(b,p,A),$d(b,p,A))},enqueueReplaceState:function(p,b,x){p=p._reactInternals;var A=Xi(),U=Ra(A);U.tag=1,U.payload=b,x!=null&&(U.callback=x),b=Aa(p,U,A),b!==null&&(Mi(b,p,A),$d(b,p,A))},enqueueForceUpdate:function(p,b){p=p._reactInternals;var x=Xi(),A=Ra(x);A.tag=2,b!=null&&(A.callback=b),b=Aa(p,A,x),b!==null&&(Mi(b,p,x),$d(b,p,x))}};function D2(p,b,x,A,U,Y,re){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(A,Y,re):b.prototype&&b.prototype.isPureReactComponent?!Bd(x,A)||!Bd(U,Y):!0}function P2(p,b,x,A){p=b.state,typeof b.componentWillReceiveProps=="function"&&b.componentWillReceiveProps(x,A),typeof b.UNSAFE_componentWillReceiveProps=="function"&&b.UNSAFE_componentWillReceiveProps(x,A),b.state!==p&&Iv.enqueueReplaceState(b,b.state,null)}function jl(p,b){var x=b;if("ref"in b){x={};for(var A in b)A!=="ref"&&(x[A]=b[A])}if(p=p.defaultProps){x===b&&(x=h({},x));for(var U in p)x[U]===void 0&&(x[U]=p[U])}return x}function I2(p){dp(p)}function O2(p){console.error(p)}function N2(p){dp(p)}function Ip(p,b){try{var x=p.onUncaughtError;x(b.value,{componentStack:b.stack})}catch(A){setTimeout(function(){throw A})}}function L2(p,b,x){try{var A=p.onCaughtError;A(x.value,{componentStack:x.stack,errorBoundary:b.tag===1?b.stateNode:null})}catch(U){setTimeout(function(){throw U})}}function Ov(p,b,x){return x=Ra(x),x.tag=3,x.payload={element:null},x.callback=function(){Ip(p,b)},x}function B2(p){return p=Ra(p),p.tag=3,p}function H2(p,b,x,A){var U=x.type.getDerivedStateFromError;if(typeof U=="function"){var Y=A.value;p.payload=function(){return U(Y)},p.callback=function(){L2(b,x,A)}}var re=x.stateNode;re!==null&&typeof re.componentDidCatch=="function"&&(p.callback=function(){L2(b,x,A),typeof U!="function"&&(Oa===null?Oa=new Set([this]):Oa.add(this));var he=A.stack;this.componentDidCatch(A.value,{componentStack:he!==null?he:""})})}function vF(p,b,x,A,U){if(x.flags|=32768,A!==null&&typeof A=="object"&&typeof A.then=="function"){if(b=x.alternate,b!==null&&qc(b,x,U,!0),x=Wi.current,x!==null){switch(x.tag){case 31:case 13:return ds===null?$p():x.alternate===null&&ln===0&&(ln=3),x.flags&=-257,x.flags|=65536,x.lanes=U,A===Cp?x.flags|=16384:(b=x.updateQueue,b===null?x.updateQueue=new Set([A]):b.add(A),o1(p,A,U)),!1;case 22:return x.flags|=65536,A===Cp?x.flags|=16384:(b=x.updateQueue,b===null?(b={transitions:null,markerInstances:null,retryQueue:new Set([A])},x.updateQueue=b):(x=b.retryQueue,x===null?b.retryQueue=new Set([A]):x.add(A)),o1(p,A,U)),!1}throw Error(n(435,x.tag))}return o1(p,A,U),$p(),!1}if(wr)return b=Wi.current,b!==null?((b.flags&65536)===0&&(b.flags|=256),b.flags|=65536,b.lanes=U,A!==ev&&(p=Error(n(422),{cause:A}),Vd(as(p,x)))):(A!==ev&&(b=Error(n(423),{cause:A}),Vd(as(b,x))),p=p.current.alternate,p.flags|=65536,U&=-U,p.lanes|=U,A=as(A,x),U=Ov(p.stateNode,A,U),dv(p,U),ln!==4&&(ln=2)),!1;var Y=Error(n(520),{cause:A});if(Y=as(Y,x),oh===null?oh=[Y]:oh.push(Y),ln!==4&&(ln=2),b===null)return!0;A=as(A,x),x=b;do{switch(x.tag){case 3:return x.flags|=65536,p=U&-U,x.lanes|=p,p=Ov(x.stateNode,A,p),dv(x,p),!1;case 1:if(b=x.type,Y=x.stateNode,(x.flags&128)===0&&(typeof b.getDerivedStateFromError=="function"||Y!==null&&typeof Y.componentDidCatch=="function"&&(Oa===null||!Oa.has(Y))))return x.flags|=65536,U&=-U,x.lanes|=U,U=B2(U),H2(U,p,x,A),dv(x,U),!1}x=x.return}while(x!==null);return!1}var Nv=Error(n(461)),kn=!1;function Xn(p,b,x,A){b.child=p===null?zx(b,null,x,A):Bl(b,p.child,x,A)}function j2(p,b,x,A,U){x=x.render;var Y=b.ref;if("ref"in A){var re={};for(var he in A)he!=="ref"&&(re[he]=A[he])}else re=A;return Il(b),A=vv(p,b,x,re,Y,U),he=bv(),p!==null&&!kn?(wv(p,b,U),Ho(p,b,U)):(wr&&he&&Jm(b),b.flags|=1,Xn(p,b,A,U),b.child)}function V2(p,b,x,A,U){if(p===null){var Y=x.type;return typeof Y=="function"&&!Xm(Y)&&Y.defaultProps===void 0&&x.compare===null?(b.tag=15,b.type=Y,G2(p,b,Y,A,U)):(p=gp(x.type,null,A,b,b.mode,U),p.ref=b.ref,p.return=b,b.child=p)}if(Y=p.child,!Uv(p,U)){var re=Y.memoizedProps;if(x=x.compare,x=x!==null?x:Bd,x(re,A)&&p.ref===b.ref)return Ho(p,b,U)}return b.flags|=1,p=Po(Y,A),p.ref=b.ref,p.return=b,b.child=p}function G2(p,b,x,A,U){if(p!==null){var Y=p.memoizedProps;if(Bd(Y,A)&&p.ref===b.ref)if(kn=!1,b.pendingProps=A=Y,Uv(p,U))(p.flags&131072)!==0&&(kn=!0);else return b.lanes=p.lanes,Ho(p,b,U)}return Lv(p,b,x,A,U)}function z2(p,b,x,A){var U=A.children,Y=p!==null?p.memoizedState:null;if(p===null&&b.stateNode===null&&(b.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),A.mode==="hidden"){if((b.flags&128)!==0){if(Y=Y!==null?Y.baseLanes|x:x,p!==null){for(A=b.child=p.child,U=0;A!==null;)U=U|A.lanes|A.childLanes,A=A.sibling;A=U&~Y}else A=0,b.child=null;return U2(p,b,Y,x,A)}if((x&536870912)!==0)b.memoizedState={baseLanes:0,cachePool:null},p!==null&&wp(b,Y!==null?Y.cachePool:null),Y!==null?$x(b,Y):fv(),qx(b);else return A=b.lanes=536870912,U2(p,b,Y!==null?Y.baseLanes|x:x,x,A)}else Y!==null?(wp(b,Y.cachePool),$x(b,Y),Ma(),b.memoizedState=null):(p!==null&&wp(b,null),fv(),Ma());return Xn(p,b,U,x),b.child}function Qd(p,b){return p!==null&&p.tag===22||b.stateNode!==null||(b.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),b.sibling}function U2(p,b,x,A,U){var Y=av();return Y=Y===null?null:{parent:En._currentValue,pool:Y},b.memoizedState={baseLanes:x,cachePool:Y},p!==null&&wp(b,null),fv(),qx(b),p!==null&&qc(p,b,A,!0),b.childLanes=U,null}function Op(p,b){return b=Lp({mode:b.mode,children:b.children},p.mode),b.ref=p.ref,p.child=b,b.return=p,b}function W2(p,b,x){return Bl(b,p.child,null,x),p=Op(b,b.pendingProps),p.flags|=2,$i(b),b.memoizedState=null,p}function bF(p,b,x){var A=b.pendingProps,U=(b.flags&128)!==0;if(b.flags&=-129,p===null){if(wr){if(A.mode==="hidden")return p=Op(b,A),b.lanes=536870912,Qd(null,p);if(gv(b),(p=qr)?(p=n_(p,us),p=p!==null&&p.data==="&"?p:null,p!==null&&(b.memoizedState={dehydrated:p,treeContext:Sa!==null?{id:ro,overflow:no}:null,retryLane:536870912,hydrationErrors:null},x=Rx(p),x.return=b,b.child=x,qn=b,qr=null)):p=null,p===null)throw Ea(b);return b.lanes=536870912,null}return Op(b,A)}var Y=p.memoizedState;if(Y!==null){var re=Y.dehydrated;if(gv(b),U)if(b.flags&256)b.flags&=-257,b=W2(p,b,x);else if(b.memoizedState!==null)b.child=p.child,b.flags|=128,b=null;else throw Error(n(558));else if(kn||qc(p,b,x,!1),U=(x&p.childLanes)!==0,kn||U){if(A=Wr,A!==null&&(re=ke(A,x),re!==0&&re!==Y.retryLane))throw Y.retryLane=re,Fl(p,re),Mi(A,p,re),Nv;$p(),b=W2(p,b,x)}else p=Y.treeContext,qr=hs(re.nextSibling),qn=b,wr=!0,_a=null,us=!1,p!==null&&Mx(b,p),b=Op(b,A),b.flags|=4096;return b}return p=Po(p.child,{mode:A.mode,children:A.children}),p.ref=b.ref,b.child=p,p.return=b,p}function Np(p,b){var x=b.ref;if(x===null)p!==null&&p.ref!==null&&(b.flags|=4194816);else{if(typeof x!="function"&&typeof x!="object")throw Error(n(284));(p===null||p.ref!==x)&&(b.flags|=4194816)}}function Lv(p,b,x,A,U){return Il(b),x=vv(p,b,x,A,void 0,U),A=bv(),p!==null&&!kn?(wv(p,b,U),Ho(p,b,U)):(wr&&A&&Jm(b),b.flags|=1,Xn(p,b,x,U),b.child)}function $2(p,b,x,A,U,Y){return Il(b),b.updateQueue=null,x=Xx(b,A,x,U),Kx(p),A=bv(),p!==null&&!kn?(wv(p,b,Y),Ho(p,b,Y)):(wr&&A&&Jm(b),b.flags|=1,Xn(p,b,x,Y),b.child)}function q2(p,b,x,A,U){if(Il(b),b.stateNode===null){var Y=zc,re=x.contextType;typeof re=="object"&&re!==null&&(Y=Kn(re)),Y=new x(A,Y),b.memoizedState=Y.state!==null&&Y.state!==void 0?Y.state:null,Y.updater=Iv,b.stateNode=Y,Y._reactInternals=b,Y=b.stateNode,Y.props=A,Y.state=b.memoizedState,Y.refs={},cv(b),re=x.contextType,Y.context=typeof re=="object"&&re!==null?Kn(re):zc,Y.state=b.memoizedState,re=x.getDerivedStateFromProps,typeof re=="function"&&(Pv(b,x,re,A),Y.state=b.memoizedState),typeof x.getDerivedStateFromProps=="function"||typeof Y.getSnapshotBeforeUpdate=="function"||typeof Y.UNSAFE_componentWillMount!="function"&&typeof Y.componentWillMount!="function"||(re=Y.state,typeof Y.componentWillMount=="function"&&Y.componentWillMount(),typeof Y.UNSAFE_componentWillMount=="function"&&Y.UNSAFE_componentWillMount(),re!==Y.state&&Iv.enqueueReplaceState(Y,Y.state,null),Kd(b,A,Y,U),qd(),Y.state=b.memoizedState),typeof Y.componentDidMount=="function"&&(b.flags|=4194308),A=!0}else if(p===null){Y=b.stateNode;var he=b.memoizedProps,_e=jl(x,he);Y.props=_e;var We=Y.context,tt=x.contextType;re=zc,typeof tt=="object"&&tt!==null&&(re=Kn(tt));var it=x.getDerivedStateFromProps;tt=typeof it=="function"||typeof Y.getSnapshotBeforeUpdate=="function",he=b.pendingProps!==he,tt||typeof Y.UNSAFE_componentWillReceiveProps!="function"&&typeof Y.componentWillReceiveProps!="function"||(he||We!==re)&&P2(b,Y,A,re),ka=!1;var qe=b.memoizedState;Y.state=qe,Kd(b,A,Y,U),qd(),We=b.memoizedState,he||qe!==We||ka?(typeof it=="function"&&(Pv(b,x,it,A),We=b.memoizedState),(_e=ka||D2(b,x,_e,A,qe,We,re))?(tt||typeof Y.UNSAFE_componentWillMount!="function"&&typeof Y.componentWillMount!="function"||(typeof Y.componentWillMount=="function"&&Y.componentWillMount(),typeof Y.UNSAFE_componentWillMount=="function"&&Y.UNSAFE_componentWillMount()),typeof Y.componentDidMount=="function"&&(b.flags|=4194308)):(typeof Y.componentDidMount=="function"&&(b.flags|=4194308),b.memoizedProps=A,b.memoizedState=We),Y.props=A,Y.state=We,Y.context=re,A=_e):(typeof Y.componentDidMount=="function"&&(b.flags|=4194308),A=!1)}else{Y=b.stateNode,uv(p,b),re=b.memoizedProps,tt=jl(x,re),Y.props=tt,it=b.pendingProps,qe=Y.context,We=x.contextType,_e=zc,typeof We=="object"&&We!==null&&(_e=Kn(We)),he=x.getDerivedStateFromProps,(We=typeof he=="function"||typeof Y.getSnapshotBeforeUpdate=="function")||typeof Y.UNSAFE_componentWillReceiveProps!="function"&&typeof Y.componentWillReceiveProps!="function"||(re!==it||qe!==_e)&&P2(b,Y,A,_e),ka=!1,qe=b.memoizedState,Y.state=qe,Kd(b,A,Y,U),qd();var Ke=b.memoizedState;re!==it||qe!==Ke||ka||p!==null&&p.dependencies!==null&&vp(p.dependencies)?(typeof he=="function"&&(Pv(b,x,he,A),Ke=b.memoizedState),(tt=ka||D2(b,x,tt,A,qe,Ke,_e)||p!==null&&p.dependencies!==null&&vp(p.dependencies))?(We||typeof Y.UNSAFE_componentWillUpdate!="function"&&typeof Y.componentWillUpdate!="function"||(typeof Y.componentWillUpdate=="function"&&Y.componentWillUpdate(A,Ke,_e),typeof Y.UNSAFE_componentWillUpdate=="function"&&Y.UNSAFE_componentWillUpdate(A,Ke,_e)),typeof Y.componentDidUpdate=="function"&&(b.flags|=4),typeof Y.getSnapshotBeforeUpdate=="function"&&(b.flags|=1024)):(typeof Y.componentDidUpdate!="function"||re===p.memoizedProps&&qe===p.memoizedState||(b.flags|=4),typeof Y.getSnapshotBeforeUpdate!="function"||re===p.memoizedProps&&qe===p.memoizedState||(b.flags|=1024),b.memoizedProps=A,b.memoizedState=Ke),Y.props=A,Y.state=Ke,Y.context=_e,A=tt):(typeof Y.componentDidUpdate!="function"||re===p.memoizedProps&&qe===p.memoizedState||(b.flags|=4),typeof Y.getSnapshotBeforeUpdate!="function"||re===p.memoizedProps&&qe===p.memoizedState||(b.flags|=1024),A=!1)}return Y=A,Np(p,b),A=(b.flags&128)!==0,Y||A?(Y=b.stateNode,x=A&&typeof x.getDerivedStateFromError!="function"?null:Y.render(),b.flags|=1,p!==null&&A?(b.child=Bl(b,p.child,null,U),b.child=Bl(b,null,x,U)):Xn(p,b,x,U),b.memoizedState=Y.state,p=b.child):p=Ho(p,b,U),p}function K2(p,b,x,A){return Dl(),b.flags|=256,Xn(p,b,x,A),b.child}var Bv={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Hv(p){return{baseLanes:p,cachePool:Lx()}}function jv(p,b,x){return p=p!==null?p.childLanes&~x:0,b&&(p|=Ki),p}function X2(p,b,x){var A=b.pendingProps,U=!1,Y=(b.flags&128)!==0,re;if((re=Y)||(re=p!==null&&p.memoizedState===null?!1:(mn.current&2)!==0),re&&(U=!0,b.flags&=-129),re=(b.flags&32)!==0,b.flags&=-33,p===null){if(wr){if(U?Fa(b):Ma(),(p=qr)?(p=n_(p,us),p=p!==null&&p.data!=="&"?p:null,p!==null&&(b.memoizedState={dehydrated:p,treeContext:Sa!==null?{id:ro,overflow:no}:null,retryLane:536870912,hydrationErrors:null},x=Rx(p),x.return=b,b.child=x,qn=b,qr=null)):p=null,p===null)throw Ea(b);return x1(p)?b.lanes=32:b.lanes=536870912,null}var he=A.children;return A=A.fallback,U?(Ma(),U=b.mode,he=Lp({mode:"hidden",children:he},U),A=Ml(A,U,x,null),he.return=b,A.return=b,he.sibling=A,b.child=he,A=b.child,A.memoizedState=Hv(x),A.childLanes=jv(p,re,x),b.memoizedState=Bv,Qd(null,A)):(Fa(b),Vv(b,he))}var _e=p.memoizedState;if(_e!==null&&(he=_e.dehydrated,he!==null)){if(Y)b.flags&256?(Fa(b),b.flags&=-257,b=Gv(p,b,x)):b.memoizedState!==null?(Ma(),b.child=p.child,b.flags|=128,b=null):(Ma(),he=A.fallback,U=b.mode,A=Lp({mode:"visible",children:A.children},U),he=Ml(he,U,x,null),he.flags|=2,A.return=b,he.return=b,A.sibling=he,b.child=A,Bl(b,p.child,null,x),A=b.child,A.memoizedState=Hv(x),A.childLanes=jv(p,re,x),b.memoizedState=Bv,b=Qd(null,A));else if(Fa(b),x1(he)){if(re=he.nextSibling&&he.nextSibling.dataset,re)var We=re.dgst;re=We,A=Error(n(419)),A.stack="",A.digest=re,Vd({value:A,source:null,stack:null}),b=Gv(p,b,x)}else if(kn||qc(p,b,x,!1),re=(x&p.childLanes)!==0,kn||re){if(re=Wr,re!==null&&(A=ke(re,x),A!==0&&A!==_e.retryLane))throw _e.retryLane=A,Fl(p,A),Mi(re,p,A),Nv;C1(he)||$p(),b=Gv(p,b,x)}else C1(he)?(b.flags|=192,b.child=p.child,b=null):(p=_e.treeContext,qr=hs(he.nextSibling),qn=b,wr=!0,_a=null,us=!1,p!==null&&Mx(b,p),b=Vv(b,A.children),b.flags|=4096);return b}return U?(Ma(),he=A.fallback,U=b.mode,_e=p.child,We=_e.sibling,A=Po(_e,{mode:"hidden",children:A.children}),A.subtreeFlags=_e.subtreeFlags&65011712,We!==null?he=Po(We,he):(he=Ml(he,U,x,null),he.flags|=2),he.return=b,A.return=b,A.sibling=he,b.child=A,Qd(null,A),A=b.child,he=p.child.memoizedState,he===null?he=Hv(x):(U=he.cachePool,U!==null?(_e=En._currentValue,U=U.parent!==_e?{parent:_e,pool:_e}:U):U=Lx(),he={baseLanes:he.baseLanes|x,cachePool:U}),A.memoizedState=he,A.childLanes=jv(p,re,x),b.memoizedState=Bv,Qd(p.child,A)):(Fa(b),x=p.child,p=x.sibling,x=Po(x,{mode:"visible",children:A.children}),x.return=b,x.sibling=null,p!==null&&(re=b.deletions,re===null?(b.deletions=[p],b.flags|=16):re.push(p)),b.child=x,b.memoizedState=null,x)}function Vv(p,b){return b=Lp({mode:"visible",children:b},p.mode),b.return=p,p.child=b}function Lp(p,b){return p=Ui(22,p,null,b),p.lanes=0,p}function Gv(p,b,x){return Bl(b,p.child,null,x),p=Vv(b,b.pendingProps.children),p.flags|=2,b.memoizedState=null,p}function Y2(p,b,x){p.lanes|=b;var A=p.alternate;A!==null&&(A.lanes|=b),nv(p.return,b,x)}function zv(p,b,x,A,U,Y){var re=p.memoizedState;re===null?p.memoizedState={isBackwards:b,rendering:null,renderingStartTime:0,last:A,tail:x,tailMode:U,treeForkCount:Y}:(re.isBackwards=b,re.rendering=null,re.renderingStartTime=0,re.last=A,re.tail=x,re.tailMode=U,re.treeForkCount=Y)}function Z2(p,b,x){var A=b.pendingProps,U=A.revealOrder,Y=A.tail;A=A.children;var re=mn.current,he=(re&2)!==0;if(he?(re=re&1|2,b.flags|=128):re&=1,q(mn,re),Xn(p,b,A,x),A=wr?jd:0,!he&&p!==null&&(p.flags&128)!==0)e:for(p=b.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&Y2(p,x,b);else if(p.tag===19)Y2(p,x,b);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===b)break e;for(;p.sibling===null;){if(p.return===null||p.return===b)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}switch(U){case"forwards":for(x=b.child,U=null;x!==null;)p=x.alternate,p!==null&&Ep(p)===null&&(U=x),x=x.sibling;x=U,x===null?(U=b.child,b.child=null):(U=x.sibling,x.sibling=null),zv(b,!1,U,x,Y,A);break;case"backwards":case"unstable_legacy-backwards":for(x=null,U=b.child,b.child=null;U!==null;){if(p=U.alternate,p!==null&&Ep(p)===null){b.child=U;break}p=U.sibling,U.sibling=x,x=U,U=p}zv(b,!0,x,null,Y,A);break;case"together":zv(b,!1,null,null,void 0,A);break;default:b.memoizedState=null}return b.child}function Ho(p,b,x){if(p!==null&&(b.dependencies=p.dependencies),Ia|=b.lanes,(x&b.childLanes)===0)if(p!==null){if(qc(p,b,x,!1),(x&b.childLanes)===0)return null}else return null;if(p!==null&&b.child!==p.child)throw Error(n(153));if(b.child!==null){for(p=b.child,x=Po(p,p.pendingProps),b.child=x,x.return=b;p.sibling!==null;)p=p.sibling,x=x.sibling=Po(p,p.pendingProps),x.return=b;x.sibling=null}return b.child}function Uv(p,b){return(p.lanes&b)!==0?!0:(p=p.dependencies,!!(p!==null&&vp(p)))}function wF(p,b,x){switch(b.tag){case 3:V(b,b.stateNode.containerInfo),Ta(b,En,p.memoizedState.cache),Dl();break;case 27:case 5:Z(b);break;case 4:V(b,b.stateNode.containerInfo);break;case 10:Ta(b,b.type,b.memoizedProps.value);break;case 31:if(b.memoizedState!==null)return b.flags|=128,gv(b),null;break;case 13:var A=b.memoizedState;if(A!==null)return A.dehydrated!==null?(Fa(b),b.flags|=128,null):(x&b.child.childLanes)!==0?X2(p,b,x):(Fa(b),p=Ho(p,b,x),p!==null?p.sibling:null);Fa(b);break;case 19:var U=(p.flags&128)!==0;if(A=(x&b.childLanes)!==0,A||(qc(p,b,x,!1),A=(x&b.childLanes)!==0),U){if(A)return Z2(p,b,x);b.flags|=128}if(U=b.memoizedState,U!==null&&(U.rendering=null,U.tail=null,U.lastEffect=null),q(mn,mn.current),A)break;return null;case 22:return b.lanes=0,z2(p,b,x,b.pendingProps);case 24:Ta(b,En,p.memoizedState.cache)}return Ho(p,b,x)}function J2(p,b,x){if(p!==null)if(p.memoizedProps!==b.pendingProps)kn=!0;else{if(!Uv(p,x)&&(b.flags&128)===0)return kn=!1,wF(p,b,x);kn=(p.flags&131072)!==0}else kn=!1,wr&&(b.flags&1048576)!==0&&Fx(b,jd,b.index);switch(b.lanes=0,b.tag){case 16:e:{var A=b.pendingProps;if(p=Nl(b.elementType),b.type=p,typeof p=="function")Xm(p)?(A=jl(p,A),b.tag=1,b=q2(null,b,p,A,x)):(b.tag=0,b=Lv(null,b,p,A,x));else{if(p!=null){var U=p.$$typeof;if(U===k){b.tag=11,b=j2(null,b,p,A,x);break e}else if(U===N){b.tag=14,b=V2(null,b,p,A,x);break e}}throw b=B(p)||p,Error(n(306,b,""))}}return b;case 0:return Lv(p,b,b.type,b.pendingProps,x);case 1:return A=b.type,U=jl(A,b.pendingProps),q2(p,b,A,U,x);case 3:e:{if(V(b,b.stateNode.containerInfo),p===null)throw Error(n(387));A=b.pendingProps;var Y=b.memoizedState;U=Y.element,uv(p,b),Kd(b,A,null,x);var re=b.memoizedState;if(A=re.cache,Ta(b,En,A),A!==Y.cache&&iv(b,[En],x,!0),qd(),A=re.element,Y.isDehydrated)if(Y={element:A,isDehydrated:!1,cache:re.cache},b.updateQueue.baseState=Y,b.memoizedState=Y,b.flags&256){b=K2(p,b,A,x);break e}else if(A!==U){U=as(Error(n(424)),b),Vd(U),b=K2(p,b,A,x);break e}else for(p=b.stateNode.containerInfo,p.nodeType===9?p=p.body:p=p.nodeName==="HTML"?p.ownerDocument.body:p,qr=hs(p.firstChild),qn=b,wr=!0,_a=null,us=!0,x=zx(b,null,A,x),b.child=x;x;)x.flags=x.flags&-3|4096,x=x.sibling;else{if(Dl(),A===U){b=Ho(p,b,x);break e}Xn(p,b,A,x)}b=b.child}return b;case 26:return Np(p,b),p===null?(x=c_(b.type,null,b.pendingProps,null))?b.memoizedState=x:wr||(x=b.type,p=b.pendingProps,A=Qp(G.current).createElement(x),A[de]=b,A[fe]=p,Yn(A,x,p),Le(A),b.stateNode=A):b.memoizedState=c_(b.type,p.memoizedProps,b.pendingProps,p.memoizedState),null;case 27:return Z(b),p===null&&wr&&(A=b.stateNode=o_(b.type,b.pendingProps,G.current),qn=b,us=!0,U=qr,Ha(b.type)?(S1=U,qr=hs(A.firstChild)):qr=U),Xn(p,b,b.pendingProps.children,x),Np(p,b),p===null&&(b.flags|=4194304),b.child;case 5:return p===null&&wr&&((U=A=qr)&&(A=XF(A,b.type,b.pendingProps,us),A!==null?(b.stateNode=A,qn=b,qr=hs(A.firstChild),us=!1,U=!0):U=!1),U||Ea(b)),Z(b),U=b.type,Y=b.pendingProps,re=p!==null?p.memoizedProps:null,A=Y.children,b1(U,Y)?A=null:re!==null&&b1(U,re)&&(b.flags|=32),b.memoizedState!==null&&(U=vv(p,b,uF,null,null,x),ph._currentValue=U),Np(p,b),Xn(p,b,A,x),b.child;case 6:return p===null&&wr&&((p=x=qr)&&(x=YF(x,b.pendingProps,us),x!==null?(b.stateNode=x,qn=b,qr=null,p=!0):p=!1),p||Ea(b)),null;case 13:return X2(p,b,x);case 4:return V(b,b.stateNode.containerInfo),A=b.pendingProps,p===null?b.child=Bl(b,null,A,x):Xn(p,b,A,x),b.child;case 11:return j2(p,b,b.type,b.pendingProps,x);case 7:return Xn(p,b,b.pendingProps,x),b.child;case 8:return Xn(p,b,b.pendingProps.children,x),b.child;case 12:return Xn(p,b,b.pendingProps.children,x),b.child;case 10:return A=b.pendingProps,Ta(b,b.type,A.value),Xn(p,b,A.children,x),b.child;case 9:return U=b.type._context,A=b.pendingProps.children,Il(b),U=Kn(U),A=A(U),b.flags|=1,Xn(p,b,A,x),b.child;case 14:return V2(p,b,b.type,b.pendingProps,x);case 15:return G2(p,b,b.type,b.pendingProps,x);case 19:return Z2(p,b,x);case 31:return bF(p,b,x);case 22:return z2(p,b,x,b.pendingProps);case 24:return Il(b),A=Kn(En),p===null?(U=av(),U===null&&(U=Wr,Y=sv(),U.pooledCache=Y,Y.refCount++,Y!==null&&(U.pooledCacheLanes|=x),U=Y),b.memoizedState={parent:A,cache:U},cv(b),Ta(b,En,U)):((p.lanes&x)!==0&&(uv(p,b),Kd(b,null,null,x),qd()),U=p.memoizedState,Y=b.memoizedState,U.parent!==A?(U={parent:A,cache:A},b.memoizedState=U,b.lanes===0&&(b.memoizedState=b.updateQueue.baseState=U),Ta(b,En,A)):(A=Y.cache,Ta(b,En,A),A!==U.cache&&iv(b,[En],x,!0))),Xn(p,b,b.pendingProps.children,x),b.child;case 29:throw b.pendingProps}throw Error(n(156,b.tag))}function jo(p){p.flags|=4}function Wv(p,b,x,A,U){if((b=(p.mode&32)!==0)&&(b=!1),b){if(p.flags|=16777216,(U&335544128)===U)if(p.stateNode.complete)p.flags|=8192;else if(ES())p.flags|=8192;else throw Ll=Cp,lv}else p.flags&=-16777217}function Q2(p,b){if(b.type!=="stylesheet"||(b.state.loading&4)!==0)p.flags&=-16777217;else if(p.flags|=16777216,!p_(b))if(ES())p.flags|=8192;else throw Ll=Cp,lv}function Bp(p,b){b!==null&&(p.flags|=4),p.flags&16384&&(b=p.tag!==22?nr():536870912,p.lanes|=b,su|=b)}function eh(p,b){if(!wr)switch(p.tailMode){case"hidden":b=p.tail;for(var x=null;b!==null;)b.alternate!==null&&(x=b),b=b.sibling;x===null?p.tail=null:x.sibling=null;break;case"collapsed":x=p.tail;for(var A=null;x!==null;)x.alternate!==null&&(A=x),x=x.sibling;A===null?b||p.tail===null?p.tail=null:p.tail.sibling=null:A.sibling=null}}function Kr(p){var b=p.alternate!==null&&p.alternate.child===p.child,x=0,A=0;if(b)for(var U=p.child;U!==null;)x|=U.lanes|U.childLanes,A|=U.subtreeFlags&65011712,A|=U.flags&65011712,U.return=p,U=U.sibling;else for(U=p.child;U!==null;)x|=U.lanes|U.childLanes,A|=U.subtreeFlags,A|=U.flags,U.return=p,U=U.sibling;return p.subtreeFlags|=A,p.childLanes=x,b}function yF(p,b,x){var A=b.pendingProps;switch(Qm(b),b.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kr(b),null;case 1:return Kr(b),null;case 3:return x=b.stateNode,A=null,p!==null&&(A=p.memoizedState.cache),b.memoizedState.cache!==A&&(b.flags|=2048),No(En),H(),x.pendingContext&&(x.context=x.pendingContext,x.pendingContext=null),(p===null||p.child===null)&&($c(b)?jo(b):p===null||p.memoizedState.isDehydrated&&(b.flags&256)===0||(b.flags|=1024,tv())),Kr(b),null;case 26:var U=b.type,Y=b.memoizedState;return p===null?(jo(b),Y!==null?(Kr(b),Q2(b,Y)):(Kr(b),Wv(b,U,null,A,x))):Y?Y!==p.memoizedState?(jo(b),Kr(b),Q2(b,Y)):(Kr(b),b.flags&=-16777217):(p=p.memoizedProps,p!==A&&jo(b),Kr(b),Wv(b,U,p,A,x)),null;case 27:if(ie(b),x=G.current,U=b.type,p!==null&&b.stateNode!=null)p.memoizedProps!==A&&jo(b);else{if(!A){if(b.stateNode===null)throw Error(n(166));return Kr(b),null}p=X.current,$c(b)?Dx(b):(p=o_(U,A,x),b.stateNode=p,jo(b))}return Kr(b),null;case 5:if(ie(b),U=b.type,p!==null&&b.stateNode!=null)p.memoizedProps!==A&&jo(b);else{if(!A){if(b.stateNode===null)throw Error(n(166));return Kr(b),null}if(Y=X.current,$c(b))Dx(b);else{var re=Qp(G.current);switch(Y){case 1:Y=re.createElementNS("http://www.w3.org/2000/svg",U);break;case 2:Y=re.createElementNS("http://www.w3.org/1998/Math/MathML",U);break;default:switch(U){case"svg":Y=re.createElementNS("http://www.w3.org/2000/svg",U);break;case"math":Y=re.createElementNS("http://www.w3.org/1998/Math/MathML",U);break;case"script":Y=re.createElement("div"),Y.innerHTML="<script><\/script>",Y=Y.removeChild(Y.firstChild);break;case"select":Y=typeof A.is=="string"?re.createElement("select",{is:A.is}):re.createElement("select"),A.multiple?Y.multiple=!0:A.size&&(Y.size=A.size);break;default:Y=typeof A.is=="string"?re.createElement(U,{is:A.is}):re.createElement(U)}}Y[de]=b,Y[fe]=A;e:for(re=b.child;re!==null;){if(re.tag===5||re.tag===6)Y.appendChild(re.stateNode);else if(re.tag!==4&&re.tag!==27&&re.child!==null){re.child.return=re,re=re.child;continue}if(re===b)break e;for(;re.sibling===null;){if(re.return===null||re.return===b)break e;re=re.return}re.sibling.return=re.return,re=re.sibling}b.stateNode=Y;e:switch(Yn(Y,U,A),U){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}A&&jo(b)}}return Kr(b),Wv(b,b.type,p===null?null:p.memoizedProps,b.pendingProps,x),null;case 6:if(p&&b.stateNode!=null)p.memoizedProps!==A&&jo(b);else{if(typeof A!="string"&&b.stateNode===null)throw Error(n(166));if(p=G.current,$c(b)){if(p=b.stateNode,x=b.memoizedProps,A=null,U=qn,U!==null)switch(U.tag){case 27:case 5:A=U.memoizedProps}p[de]=b,p=!!(p.nodeValue===x||A!==null&&A.suppressHydrationWarning===!0||XS(p.nodeValue,x)),p||Ea(b,!0)}else p=Qp(p).createTextNode(A),p[de]=b,b.stateNode=p}return Kr(b),null;case 31:if(x=b.memoizedState,p===null||p.memoizedState!==null){if(A=$c(b),x!==null){if(p===null){if(!A)throw Error(n(318));if(p=b.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(n(557));p[de]=b}else Dl(),(b.flags&128)===0&&(b.memoizedState=null),b.flags|=4;Kr(b),p=!1}else x=tv(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=x),p=!0;if(!p)return b.flags&256?($i(b),b):($i(b),null);if((b.flags&128)!==0)throw Error(n(558))}return Kr(b),null;case 13:if(A=b.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(U=$c(b),A!==null&&A.dehydrated!==null){if(p===null){if(!U)throw Error(n(318));if(U=b.memoizedState,U=U!==null?U.dehydrated:null,!U)throw Error(n(317));U[de]=b}else Dl(),(b.flags&128)===0&&(b.memoizedState=null),b.flags|=4;Kr(b),U=!1}else U=tv(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=U),U=!0;if(!U)return b.flags&256?($i(b),b):($i(b),null)}return $i(b),(b.flags&128)!==0?(b.lanes=x,b):(x=A!==null,p=p!==null&&p.memoizedState!==null,x&&(A=b.child,U=null,A.alternate!==null&&A.alternate.memoizedState!==null&&A.alternate.memoizedState.cachePool!==null&&(U=A.alternate.memoizedState.cachePool.pool),Y=null,A.memoizedState!==null&&A.memoizedState.cachePool!==null&&(Y=A.memoizedState.cachePool.pool),Y!==U&&(A.flags|=2048)),x!==p&&x&&(b.child.flags|=8192),Bp(b,b.updateQueue),Kr(b),null);case 4:return H(),p===null&&f1(b.stateNode.containerInfo),Kr(b),null;case 10:return No(b.type),Kr(b),null;case 19:if(P(mn),A=b.memoizedState,A===null)return Kr(b),null;if(U=(b.flags&128)!==0,Y=A.rendering,Y===null)if(U)eh(A,!1);else{if(ln!==0||p!==null&&(p.flags&128)!==0)for(p=b.child;p!==null;){if(Y=Ep(p),Y!==null){for(b.flags|=128,eh(A,!1),p=Y.updateQueue,b.updateQueue=p,Bp(b,p),b.subtreeFlags=0,p=x,x=b.child;x!==null;)kx(x,p),x=x.sibling;return q(mn,mn.current&1|2),wr&&Io(b,A.treeForkCount),b.child}p=p.sibling}A.tail!==null&&Ve()>zp&&(b.flags|=128,U=!0,eh(A,!1),b.lanes=4194304)}else{if(!U)if(p=Ep(Y),p!==null){if(b.flags|=128,U=!0,p=p.updateQueue,b.updateQueue=p,Bp(b,p),eh(A,!0),A.tail===null&&A.tailMode==="hidden"&&!Y.alternate&&!wr)return Kr(b),null}else 2*Ve()-A.renderingStartTime>zp&&x!==536870912&&(b.flags|=128,U=!0,eh(A,!1),b.lanes=4194304);A.isBackwards?(Y.sibling=b.child,b.child=Y):(p=A.last,p!==null?p.sibling=Y:b.child=Y,A.last=Y)}return A.tail!==null?(p=A.tail,A.rendering=p,A.tail=p.sibling,A.renderingStartTime=Ve(),p.sibling=null,x=mn.current,q(mn,U?x&1|2:x&1),wr&&Io(b,A.treeForkCount),p):(Kr(b),null);case 22:case 23:return $i(b),pv(),A=b.memoizedState!==null,p!==null?p.memoizedState!==null!==A&&(b.flags|=8192):A&&(b.flags|=8192),A?(x&536870912)!==0&&(b.flags&128)===0&&(Kr(b),b.subtreeFlags&6&&(b.flags|=8192)):Kr(b),x=b.updateQueue,x!==null&&Bp(b,x.retryQueue),x=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(x=p.memoizedState.cachePool.pool),A=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(A=b.memoizedState.cachePool.pool),A!==x&&(b.flags|=2048),p!==null&&P(Ol),null;case 24:return x=null,p!==null&&(x=p.memoizedState.cache),b.memoizedState.cache!==x&&(b.flags|=2048),No(En),Kr(b),null;case 25:return null;case 30:return null}throw Error(n(156,b.tag))}function CF(p,b){switch(Qm(b),b.tag){case 1:return p=b.flags,p&65536?(b.flags=p&-65537|128,b):null;case 3:return No(En),H(),p=b.flags,(p&65536)!==0&&(p&128)===0?(b.flags=p&-65537|128,b):null;case 26:case 27:case 5:return ie(b),null;case 31:if(b.memoizedState!==null){if($i(b),b.alternate===null)throw Error(n(340));Dl()}return p=b.flags,p&65536?(b.flags=p&-65537|128,b):null;case 13:if($i(b),p=b.memoizedState,p!==null&&p.dehydrated!==null){if(b.alternate===null)throw Error(n(340));Dl()}return p=b.flags,p&65536?(b.flags=p&-65537|128,b):null;case 19:return P(mn),null;case 4:return H(),null;case 10:return No(b.type),null;case 22:case 23:return $i(b),pv(),p!==null&&P(Ol),p=b.flags,p&65536?(b.flags=p&-65537|128,b):null;case 24:return No(En),null;case 25:return null;default:return null}}function eS(p,b){switch(Qm(b),b.tag){case 3:No(En),H();break;case 26:case 27:case 5:ie(b);break;case 4:H();break;case 31:b.memoizedState!==null&&$i(b);break;case 13:$i(b);break;case 19:P(mn);break;case 10:No(b.type);break;case 22:case 23:$i(b),pv(),p!==null&&P(Ol);break;case 24:No(En)}}function th(p,b){try{var x=b.updateQueue,A=x!==null?x.lastEffect:null;if(A!==null){var U=A.next;x=U;do{if((x.tag&p)===p){A=void 0;var Y=x.create,re=x.inst;A=Y(),re.destroy=A}x=x.next}while(x!==U)}}catch(he){Dr(b,b.return,he)}}function Da(p,b,x){try{var A=b.updateQueue,U=A!==null?A.lastEffect:null;if(U!==null){var Y=U.next;A=Y;do{if((A.tag&p)===p){var re=A.inst,he=re.destroy;if(he!==void 0){re.destroy=void 0,U=b;var _e=x,We=he;try{We()}catch(tt){Dr(U,_e,tt)}}}A=A.next}while(A!==Y)}}catch(tt){Dr(b,b.return,tt)}}function tS(p){var b=p.updateQueue;if(b!==null){var x=p.stateNode;try{Wx(b,x)}catch(A){Dr(p,p.return,A)}}}function rS(p,b,x){x.props=jl(p.type,p.memoizedProps),x.state=p.memoizedState;try{x.componentWillUnmount()}catch(A){Dr(p,b,A)}}function rh(p,b){try{var x=p.ref;if(x!==null){switch(p.tag){case 26:case 27:case 5:var A=p.stateNode;break;case 30:A=p.stateNode;break;default:A=p.stateNode}typeof x=="function"?p.refCleanup=x(A):x.current=A}}catch(U){Dr(p,b,U)}}function io(p,b){var x=p.ref,A=p.refCleanup;if(x!==null)if(typeof A=="function")try{A()}catch(U){Dr(p,b,U)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof x=="function")try{x(null)}catch(U){Dr(p,b,U)}else x.current=null}function nS(p){var b=p.type,x=p.memoizedProps,A=p.stateNode;try{e:switch(b){case"button":case"input":case"select":case"textarea":x.autoFocus&&A.focus();break e;case"img":x.src?A.src=x.src:x.srcSet&&(A.srcset=x.srcSet)}}catch(U){Dr(p,p.return,U)}}function $v(p,b,x){try{var A=p.stateNode;zF(A,p.type,x,b),A[fe]=b}catch(U){Dr(p,p.return,U)}}function iS(p){return p.tag===5||p.tag===3||p.tag===26||p.tag===27&&Ha(p.type)||p.tag===4}function qv(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||iS(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.tag===27&&Ha(p.type)||p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function Kv(p,b,x){var A=p.tag;if(A===5||A===6)p=p.stateNode,b?(x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x).insertBefore(p,b):(b=x.nodeType===9?x.body:x.nodeName==="HTML"?x.ownerDocument.body:x,b.appendChild(p),x=x._reactRootContainer,x!=null||b.onclick!==null||(b.onclick=Gi));else if(A!==4&&(A===27&&Ha(p.type)&&(x=p.stateNode,b=null),p=p.child,p!==null))for(Kv(p,b,x),p=p.sibling;p!==null;)Kv(p,b,x),p=p.sibling}function Hp(p,b,x){var A=p.tag;if(A===5||A===6)p=p.stateNode,b?x.insertBefore(p,b):x.appendChild(p);else if(A!==4&&(A===27&&Ha(p.type)&&(x=p.stateNode),p=p.child,p!==null))for(Hp(p,b,x),p=p.sibling;p!==null;)Hp(p,b,x),p=p.sibling}function sS(p){var b=p.stateNode,x=p.memoizedProps;try{for(var A=p.type,U=b.attributes;U.length;)b.removeAttributeNode(U[0]);Yn(b,A,x),b[de]=p,b[fe]=x}catch(Y){Dr(p,p.return,Y)}}var Vo=!1,Rn=!1,Xv=!1,oS=typeof WeakSet=="function"?WeakSet:Set,Bn=null;function xF(p,b){if(p=p.containerInfo,m1=og,p=bx(p),Gm(p)){if("selectionStart"in p)var x={start:p.selectionStart,end:p.selectionEnd};else e:{x=(x=p.ownerDocument)&&x.defaultView||window;var A=x.getSelection&&x.getSelection();if(A&&A.rangeCount!==0){x=A.anchorNode;var U=A.anchorOffset,Y=A.focusNode;A=A.focusOffset;try{x.nodeType,Y.nodeType}catch{x=null;break e}var re=0,he=-1,_e=-1,We=0,tt=0,it=p,qe=null;t:for(;;){for(var Ke;it!==x||U!==0&&it.nodeType!==3||(he=re+U),it!==Y||A!==0&&it.nodeType!==3||(_e=re+A),it.nodeType===3&&(re+=it.nodeValue.length),(Ke=it.firstChild)!==null;)qe=it,it=Ke;for(;;){if(it===p)break t;if(qe===x&&++We===U&&(he=re),qe===Y&&++tt===A&&(_e=re),(Ke=it.nextSibling)!==null)break;it=qe,qe=it.parentNode}it=Ke}x=he===-1||_e===-1?null:{start:he,end:_e}}else x=null}x=x||{start:0,end:0}}else x=null;for(v1={focusedElem:p,selectionRange:x},og=!1,Bn=b;Bn!==null;)if(b=Bn,p=b.child,(b.subtreeFlags&1028)!==0&&p!==null)p.return=b,Bn=p;else for(;Bn!==null;){switch(b=Bn,Y=b.alternate,p=b.flags,b.tag){case 0:if((p&4)!==0&&(p=b.updateQueue,p=p!==null?p.events:null,p!==null))for(x=0;x<p.length;x++)U=p[x],U.ref.impl=U.nextImpl;break;case 11:case 15:break;case 1:if((p&1024)!==0&&Y!==null){p=void 0,x=b,U=Y.memoizedProps,Y=Y.memoizedState,A=x.stateNode;try{var St=jl(x.type,U);p=A.getSnapshotBeforeUpdate(St,Y),A.__reactInternalSnapshotBeforeUpdate=p}catch(Bt){Dr(x,x.return,Bt)}}break;case 3:if((p&1024)!==0){if(p=b.stateNode.containerInfo,x=p.nodeType,x===9)y1(p);else if(x===1)switch(p.nodeName){case"HEAD":case"HTML":case"BODY":y1(p);break;default:p.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((p&1024)!==0)throw Error(n(163))}if(p=b.sibling,p!==null){p.return=b.return,Bn=p;break}Bn=b.return}}function aS(p,b,x){var A=x.flags;switch(x.tag){case 0:case 11:case 15:zo(p,x),A&4&&th(5,x);break;case 1:if(zo(p,x),A&4)if(p=x.stateNode,b===null)try{p.componentDidMount()}catch(re){Dr(x,x.return,re)}else{var U=jl(x.type,b.memoizedProps);b=b.memoizedState;try{p.componentDidUpdate(U,b,p.__reactInternalSnapshotBeforeUpdate)}catch(re){Dr(x,x.return,re)}}A&64&&tS(x),A&512&&rh(x,x.return);break;case 3:if(zo(p,x),A&64&&(p=x.updateQueue,p!==null)){if(b=null,x.child!==null)switch(x.child.tag){case 27:case 5:b=x.child.stateNode;break;case 1:b=x.child.stateNode}try{Wx(p,b)}catch(re){Dr(x,x.return,re)}}break;case 27:b===null&&A&4&&sS(x);case 26:case 5:zo(p,x),b===null&&A&4&&nS(x),A&512&&rh(x,x.return);break;case 12:zo(p,x);break;case 31:zo(p,x),A&4&&uS(p,x);break;case 13:zo(p,x),A&4&&dS(p,x),A&64&&(p=x.memoizedState,p!==null&&(p=p.dehydrated,p!==null&&(x=MF.bind(null,x),ZF(p,x))));break;case 22:if(A=x.memoizedState!==null||Vo,!A){b=b!==null&&b.memoizedState!==null||Rn,U=Vo;var Y=Rn;Vo=A,(Rn=b)&&!Y?Uo(p,x,(x.subtreeFlags&8772)!==0):zo(p,x),Vo=U,Rn=Y}break;case 30:break;default:zo(p,x)}}function lS(p){var b=p.alternate;b!==null&&(p.alternate=null,lS(b)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(b=p.stateNode,b!==null&&nt(b)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}var Qr=null,ki=!1;function Go(p,b,x){for(x=x.child;x!==null;)cS(p,b,x),x=x.sibling}function cS(p,b,x){if(De&&typeof De.onCommitFiberUnmount=="function")try{De.onCommitFiberUnmount(Pe,x)}catch{}switch(x.tag){case 26:Rn||io(x,b),Go(p,b,x),x.memoizedState?x.memoizedState.count--:x.stateNode&&(x=x.stateNode,x.parentNode.removeChild(x));break;case 27:Rn||io(x,b);var A=Qr,U=ki;Ha(x.type)&&(Qr=x.stateNode,ki=!1),Go(p,b,x),dh(x.stateNode),Qr=A,ki=U;break;case 5:Rn||io(x,b);case 6:if(A=Qr,U=ki,Qr=null,Go(p,b,x),Qr=A,ki=U,Qr!==null)if(ki)try{(Qr.nodeType===9?Qr.body:Qr.nodeName==="HTML"?Qr.ownerDocument.body:Qr).removeChild(x.stateNode)}catch(Y){Dr(x,b,Y)}else try{Qr.removeChild(x.stateNode)}catch(Y){Dr(x,b,Y)}break;case 18:Qr!==null&&(ki?(p=Qr,t_(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,x.stateNode),fu(p)):t_(Qr,x.stateNode));break;case 4:A=Qr,U=ki,Qr=x.stateNode.containerInfo,ki=!0,Go(p,b,x),Qr=A,ki=U;break;case 0:case 11:case 14:case 15:Da(2,x,b),Rn||Da(4,x,b),Go(p,b,x);break;case 1:Rn||(io(x,b),A=x.stateNode,typeof A.componentWillUnmount=="function"&&rS(x,b,A)),Go(p,b,x);break;case 21:Go(p,b,x);break;case 22:Rn=(A=Rn)||x.memoizedState!==null,Go(p,b,x),Rn=A;break;default:Go(p,b,x)}}function uS(p,b){if(b.memoizedState===null&&(p=b.alternate,p!==null&&(p=p.memoizedState,p!==null))){p=p.dehydrated;try{fu(p)}catch(x){Dr(b,b.return,x)}}}function dS(p,b){if(b.memoizedState===null&&(p=b.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{fu(p)}catch(x){Dr(b,b.return,x)}}function SF(p){switch(p.tag){case 31:case 13:case 19:var b=p.stateNode;return b===null&&(b=p.stateNode=new oS),b;case 22:return p=p.stateNode,b=p._retryCache,b===null&&(b=p._retryCache=new oS),b;default:throw Error(n(435,p.tag))}}function jp(p,b){var x=SF(p);b.forEach(function(A){if(!x.has(A)){x.add(A);var U=DF.bind(null,p,A);A.then(U,U)}})}function Ri(p,b){var x=b.deletions;if(x!==null)for(var A=0;A<x.length;A++){var U=x[A],Y=p,re=b,he=re;e:for(;he!==null;){switch(he.tag){case 27:if(Ha(he.type)){Qr=he.stateNode,ki=!1;break e}break;case 5:Qr=he.stateNode,ki=!1;break e;case 3:case 4:Qr=he.stateNode.containerInfo,ki=!0;break e}he=he.return}if(Qr===null)throw Error(n(160));cS(Y,re,U),Qr=null,ki=!1,Y=U.alternate,Y!==null&&(Y.return=null),U.return=null}if(b.subtreeFlags&13886)for(b=b.child;b!==null;)hS(b,p),b=b.sibling}var Os=null;function hS(p,b){var x=p.alternate,A=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:Ri(b,p),Ai(p),A&4&&(Da(3,p,p.return),th(3,p),Da(5,p,p.return));break;case 1:Ri(b,p),Ai(p),A&512&&(Rn||x===null||io(x,x.return)),A&64&&Vo&&(p=p.updateQueue,p!==null&&(A=p.callbacks,A!==null&&(x=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=x===null?A:x.concat(A))));break;case 26:var U=Os;if(Ri(b,p),Ai(p),A&512&&(Rn||x===null||io(x,x.return)),A&4){var Y=x!==null?x.memoizedState:null;if(A=p.memoizedState,x===null)if(A===null)if(p.stateNode===null){e:{A=p.type,x=p.memoizedProps,U=U.ownerDocument||U;t:switch(A){case"title":Y=U.getElementsByTagName("title")[0],(!Y||Y[Oe]||Y[de]||Y.namespaceURI==="http://www.w3.org/2000/svg"||Y.hasAttribute("itemprop"))&&(Y=U.createElement(A),U.head.insertBefore(Y,U.querySelector("head > title"))),Yn(Y,A,x),Y[de]=p,Le(Y),A=Y;break e;case"link":var re=h_("link","href",U).get(A+(x.href||""));if(re){for(var he=0;he<re.length;he++)if(Y=re[he],Y.getAttribute("href")===(x.href==null||x.href===""?null:x.href)&&Y.getAttribute("rel")===(x.rel==null?null:x.rel)&&Y.getAttribute("title")===(x.title==null?null:x.title)&&Y.getAttribute("crossorigin")===(x.crossOrigin==null?null:x.crossOrigin)){re.splice(he,1);break t}}Y=U.createElement(A),Yn(Y,A,x),U.head.appendChild(Y);break;case"meta":if(re=h_("meta","content",U).get(A+(x.content||""))){for(he=0;he<re.length;he++)if(Y=re[he],Y.getAttribute("content")===(x.content==null?null:""+x.content)&&Y.getAttribute("name")===(x.name==null?null:x.name)&&Y.getAttribute("property")===(x.property==null?null:x.property)&&Y.getAttribute("http-equiv")===(x.httpEquiv==null?null:x.httpEquiv)&&Y.getAttribute("charset")===(x.charSet==null?null:x.charSet)){re.splice(he,1);break t}}Y=U.createElement(A),Yn(Y,A,x),U.head.appendChild(Y);break;default:throw Error(n(468,A))}Y[de]=p,Le(Y),A=Y}p.stateNode=A}else f_(U,p.type,p.stateNode);else p.stateNode=d_(U,A,p.memoizedProps);else Y!==A?(Y===null?x.stateNode!==null&&(x=x.stateNode,x.parentNode.removeChild(x)):Y.count--,A===null?f_(U,p.type,p.stateNode):d_(U,A,p.memoizedProps)):A===null&&p.stateNode!==null&&$v(p,p.memoizedProps,x.memoizedProps)}break;case 27:Ri(b,p),Ai(p),A&512&&(Rn||x===null||io(x,x.return)),x!==null&&A&4&&$v(p,p.memoizedProps,x.memoizedProps);break;case 5:if(Ri(b,p),Ai(p),A&512&&(Rn||x===null||io(x,x.return)),p.flags&32){U=p.stateNode;try{si(U,"")}catch(St){Dr(p,p.return,St)}}A&4&&p.stateNode!=null&&(U=p.memoizedProps,$v(p,U,x!==null?x.memoizedProps:U)),A&1024&&(Xv=!0);break;case 6:if(Ri(b,p),Ai(p),A&4){if(p.stateNode===null)throw Error(n(162));A=p.memoizedProps,x=p.stateNode;try{x.nodeValue=A}catch(St){Dr(p,p.return,St)}}break;case 3:if(rg=null,U=Os,Os=eg(b.containerInfo),Ri(b,p),Os=U,Ai(p),A&4&&x!==null&&x.memoizedState.isDehydrated)try{fu(b.containerInfo)}catch(St){Dr(p,p.return,St)}Xv&&(Xv=!1,fS(p));break;case 4:A=Os,Os=eg(p.stateNode.containerInfo),Ri(b,p),Ai(p),Os=A;break;case 12:Ri(b,p),Ai(p);break;case 31:Ri(b,p),Ai(p),A&4&&(A=p.updateQueue,A!==null&&(p.updateQueue=null,jp(p,A)));break;case 13:Ri(b,p),Ai(p),p.child.flags&8192&&p.memoizedState!==null!=(x!==null&&x.memoizedState!==null)&&(Gp=Ve()),A&4&&(A=p.updateQueue,A!==null&&(p.updateQueue=null,jp(p,A)));break;case 22:U=p.memoizedState!==null;var _e=x!==null&&x.memoizedState!==null,We=Vo,tt=Rn;if(Vo=We||U,Rn=tt||_e,Ri(b,p),Rn=tt,Vo=We,Ai(p),A&8192)e:for(b=p.stateNode,b._visibility=U?b._visibility&-2:b._visibility|1,U&&(x===null||_e||Vo||Rn||Vl(p)),x=null,b=p;;){if(b.tag===5||b.tag===26){if(x===null){_e=x=b;try{if(Y=_e.stateNode,U)re=Y.style,typeof re.setProperty=="function"?re.setProperty("display","none","important"):re.display="none";else{he=_e.stateNode;var it=_e.memoizedProps.style,qe=it!=null&&it.hasOwnProperty("display")?it.display:null;he.style.display=qe==null||typeof qe=="boolean"?"":(""+qe).trim()}}catch(St){Dr(_e,_e.return,St)}}}else if(b.tag===6){if(x===null){_e=b;try{_e.stateNode.nodeValue=U?"":_e.memoizedProps}catch(St){Dr(_e,_e.return,St)}}}else if(b.tag===18){if(x===null){_e=b;try{var Ke=_e.stateNode;U?r_(Ke,!0):r_(_e.stateNode,!1)}catch(St){Dr(_e,_e.return,St)}}}else if((b.tag!==22&&b.tag!==23||b.memoizedState===null||b===p)&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===p)break e;for(;b.sibling===null;){if(b.return===null||b.return===p)break e;x===b&&(x=null),b=b.return}x===b&&(x=null),b.sibling.return=b.return,b=b.sibling}A&4&&(A=p.updateQueue,A!==null&&(x=A.retryQueue,x!==null&&(A.retryQueue=null,jp(p,x))));break;case 19:Ri(b,p),Ai(p),A&4&&(A=p.updateQueue,A!==null&&(p.updateQueue=null,jp(p,A)));break;case 30:break;case 21:break;default:Ri(b,p),Ai(p)}}function Ai(p){var b=p.flags;if(b&2){try{for(var x,A=p.return;A!==null;){if(iS(A)){x=A;break}A=A.return}if(x==null)throw Error(n(160));switch(x.tag){case 27:var U=x.stateNode,Y=qv(p);Hp(p,Y,U);break;case 5:var re=x.stateNode;x.flags&32&&(si(re,""),x.flags&=-33);var he=qv(p);Hp(p,he,re);break;case 3:case 4:var _e=x.stateNode.containerInfo,We=qv(p);Kv(p,We,_e);break;default:throw Error(n(161))}}catch(tt){Dr(p,p.return,tt)}p.flags&=-3}b&4096&&(p.flags&=-4097)}function fS(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var b=p;fS(b),b.tag===5&&b.flags&1024&&b.stateNode.reset(),p=p.sibling}}function zo(p,b){if(b.subtreeFlags&8772)for(b=b.child;b!==null;)aS(p,b.alternate,b),b=b.sibling}function Vl(p){for(p=p.child;p!==null;){var b=p;switch(b.tag){case 0:case 11:case 14:case 15:Da(4,b,b.return),Vl(b);break;case 1:io(b,b.return);var x=b.stateNode;typeof x.componentWillUnmount=="function"&&rS(b,b.return,x),Vl(b);break;case 27:dh(b.stateNode);case 26:case 5:io(b,b.return),Vl(b);break;case 22:b.memoizedState===null&&Vl(b);break;case 30:Vl(b);break;default:Vl(b)}p=p.sibling}}function Uo(p,b,x){for(x=x&&(b.subtreeFlags&8772)!==0,b=b.child;b!==null;){var A=b.alternate,U=p,Y=b,re=Y.flags;switch(Y.tag){case 0:case 11:case 15:Uo(U,Y,x),th(4,Y);break;case 1:if(Uo(U,Y,x),A=Y,U=A.stateNode,typeof U.componentDidMount=="function")try{U.componentDidMount()}catch(We){Dr(A,A.return,We)}if(A=Y,U=A.updateQueue,U!==null){var he=A.stateNode;try{var _e=U.shared.hiddenCallbacks;if(_e!==null)for(U.shared.hiddenCallbacks=null,U=0;U<_e.length;U++)Ux(_e[U],he)}catch(We){Dr(A,A.return,We)}}x&&re&64&&tS(Y),rh(Y,Y.return);break;case 27:sS(Y);case 26:case 5:Uo(U,Y,x),x&&A===null&&re&4&&nS(Y),rh(Y,Y.return);break;case 12:Uo(U,Y,x);break;case 31:Uo(U,Y,x),x&&re&4&&uS(U,Y);break;case 13:Uo(U,Y,x),x&&re&4&&dS(U,Y);break;case 22:Y.memoizedState===null&&Uo(U,Y,x),rh(Y,Y.return);break;case 30:break;default:Uo(U,Y,x)}b=b.sibling}}function Yv(p,b){var x=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(x=p.memoizedState.cachePool.pool),p=null,b.memoizedState!==null&&b.memoizedState.cachePool!==null&&(p=b.memoizedState.cachePool.pool),p!==x&&(p!=null&&p.refCount++,x!=null&&Gd(x))}function Zv(p,b){p=null,b.alternate!==null&&(p=b.alternate.memoizedState.cache),b=b.memoizedState.cache,b!==p&&(b.refCount++,p!=null&&Gd(p))}function Ns(p,b,x,A){if(b.subtreeFlags&10256)for(b=b.child;b!==null;)pS(p,b,x,A),b=b.sibling}function pS(p,b,x,A){var U=b.flags;switch(b.tag){case 0:case 11:case 15:Ns(p,b,x,A),U&2048&&th(9,b);break;case 1:Ns(p,b,x,A);break;case 3:Ns(p,b,x,A),U&2048&&(p=null,b.alternate!==null&&(p=b.alternate.memoizedState.cache),b=b.memoizedState.cache,b!==p&&(b.refCount++,p!=null&&Gd(p)));break;case 12:if(U&2048){Ns(p,b,x,A),p=b.stateNode;try{var Y=b.memoizedProps,re=Y.id,he=Y.onPostCommit;typeof he=="function"&&he(re,b.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(_e){Dr(b,b.return,_e)}}else Ns(p,b,x,A);break;case 31:Ns(p,b,x,A);break;case 13:Ns(p,b,x,A);break;case 23:break;case 22:Y=b.stateNode,re=b.alternate,b.memoizedState!==null?Y._visibility&2?Ns(p,b,x,A):nh(p,b):Y._visibility&2?Ns(p,b,x,A):(Y._visibility|=2,ru(p,b,x,A,(b.subtreeFlags&10256)!==0||!1)),U&2048&&Yv(re,b);break;case 24:Ns(p,b,x,A),U&2048&&Zv(b.alternate,b);break;default:Ns(p,b,x,A)}}function ru(p,b,x,A,U){for(U=U&&((b.subtreeFlags&10256)!==0||!1),b=b.child;b!==null;){var Y=p,re=b,he=x,_e=A,We=re.flags;switch(re.tag){case 0:case 11:case 15:ru(Y,re,he,_e,U),th(8,re);break;case 23:break;case 22:var tt=re.stateNode;re.memoizedState!==null?tt._visibility&2?ru(Y,re,he,_e,U):nh(Y,re):(tt._visibility|=2,ru(Y,re,he,_e,U)),U&&We&2048&&Yv(re.alternate,re);break;case 24:ru(Y,re,he,_e,U),U&&We&2048&&Zv(re.alternate,re);break;default:ru(Y,re,he,_e,U)}b=b.sibling}}function nh(p,b){if(b.subtreeFlags&10256)for(b=b.child;b!==null;){var x=p,A=b,U=A.flags;switch(A.tag){case 22:nh(x,A),U&2048&&Yv(A.alternate,A);break;case 24:nh(x,A),U&2048&&Zv(A.alternate,A);break;default:nh(x,A)}b=b.sibling}}var ih=8192;function nu(p,b,x){if(p.subtreeFlags&ih)for(p=p.child;p!==null;)gS(p,b,x),p=p.sibling}function gS(p,b,x){switch(p.tag){case 26:nu(p,b,x),p.flags&ih&&p.memoizedState!==null&&cM(x,Os,p.memoizedState,p.memoizedProps);break;case 5:nu(p,b,x);break;case 3:case 4:var A=Os;Os=eg(p.stateNode.containerInfo),nu(p,b,x),Os=A;break;case 22:p.memoizedState===null&&(A=p.alternate,A!==null&&A.memoizedState!==null?(A=ih,ih=16777216,nu(p,b,x),ih=A):nu(p,b,x));break;default:nu(p,b,x)}}function mS(p){var b=p.alternate;if(b!==null&&(p=b.child,p!==null)){b.child=null;do b=p.sibling,p.sibling=null,p=b;while(p!==null)}}function sh(p){var b=p.deletions;if((p.flags&16)!==0){if(b!==null)for(var x=0;x<b.length;x++){var A=b[x];Bn=A,bS(A,p)}mS(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)vS(p),p=p.sibling}function vS(p){switch(p.tag){case 0:case 11:case 15:sh(p),p.flags&2048&&Da(9,p,p.return);break;case 3:sh(p);break;case 12:sh(p);break;case 22:var b=p.stateNode;p.memoizedState!==null&&b._visibility&2&&(p.return===null||p.return.tag!==13)?(b._visibility&=-3,Vp(p)):sh(p);break;default:sh(p)}}function Vp(p){var b=p.deletions;if((p.flags&16)!==0){if(b!==null)for(var x=0;x<b.length;x++){var A=b[x];Bn=A,bS(A,p)}mS(p)}for(p=p.child;p!==null;){switch(b=p,b.tag){case 0:case 11:case 15:Da(8,b,b.return),Vp(b);break;case 22:x=b.stateNode,x._visibility&2&&(x._visibility&=-3,Vp(b));break;default:Vp(b)}p=p.sibling}}function bS(p,b){for(;Bn!==null;){var x=Bn;switch(x.tag){case 0:case 11:case 15:Da(8,x,b);break;case 23:case 22:if(x.memoizedState!==null&&x.memoizedState.cachePool!==null){var A=x.memoizedState.cachePool.pool;A!=null&&A.refCount++}break;case 24:Gd(x.memoizedState.cache)}if(A=x.child,A!==null)A.return=x,Bn=A;else e:for(x=p;Bn!==null;){A=Bn;var U=A.sibling,Y=A.return;if(lS(A),A===x){Bn=null;break e}if(U!==null){U.return=Y,Bn=U;break e}Bn=Y}}}var _F={getCacheForType:function(p){var b=Kn(En),x=b.data.get(p);return x===void 0&&(x=p(),b.data.set(p,x)),x},cacheSignal:function(){return Kn(En).controller.signal}},EF=typeof WeakMap=="function"?WeakMap:Map,kr=0,Wr=null,ur=null,gr=0,Mr=0,qi=null,Pa=!1,iu=!1,Jv=!1,Wo=0,ln=0,Ia=0,Gl=0,Qv=0,Ki=0,su=0,oh=null,Fi=null,e1=!1,Gp=0,wS=0,zp=1/0,Up=null,Oa=null,In=0,Na=null,ou=null,$o=0,t1=0,r1=null,yS=null,ah=0,n1=null;function Xi(){return(kr&2)!==0&&gr!==0?gr&-gr:S.T!==null?c1():se()}function CS(){if(Ki===0)if((gr&536870912)===0||wr){var p=It;It<<=1,(It&3932160)===0&&(It=262144),Ki=p}else Ki=536870912;return p=Wi.current,p!==null&&(p.flags|=32),Ki}function Mi(p,b,x){(p===Wr&&(Mr===2||Mr===9)||p.cancelPendingCommit!==null)&&(au(p,0),La(p,gr,Ki,!1)),At(p,x),((kr&2)===0||p!==Wr)&&(p===Wr&&((kr&2)===0&&(Gl|=x),ln===4&&La(p,gr,Ki,!1)),so(p))}function xS(p,b,x){if((kr&6)!==0)throw Error(n(327));var A=!x&&(b&127)===0&&(b&p.expiredLanes)===0||Jt(p,b),U=A?RF(p,b):s1(p,b,!0),Y=A;do{if(U===0){iu&&!A&&La(p,b,0,!1);break}else{if(x=p.current.alternate,Y&&!TF(x)){U=s1(p,b,!1),Y=!1;continue}if(U===2){if(Y=b,p.errorRecoveryDisabledLanes&Y)var re=0;else re=p.pendingLanes&-536870913,re=re!==0?re:re&536870912?536870912:0;if(re!==0){b=re;e:{var he=p;U=oh;var _e=he.current.memoizedState.isDehydrated;if(_e&&(au(he,re).flags|=256),re=s1(he,re,!1),re!==2){if(Jv&&!_e){he.errorRecoveryDisabledLanes|=Y,Gl|=Y,U=4;break e}Y=Fi,Fi=U,Y!==null&&(Fi===null?Fi=Y:Fi.push.apply(Fi,Y))}U=re}if(Y=!1,U!==2)continue}}if(U===1){au(p,0),La(p,b,0,!0);break}e:{switch(A=p,Y=U,Y){case 0:case 1:throw Error(n(345));case 4:if((b&4194048)!==b)break;case 6:La(A,b,Ki,!Pa);break e;case 2:Fi=null;break;case 3:case 5:break;default:throw Error(n(329))}if((b&62914560)===b&&(U=Gp+300-Ve(),10<U)){if(La(A,b,Ki,!Pa),sr(A,0,!0)!==0)break e;$o=b,A.timeoutHandle=QS(SS.bind(null,A,x,Fi,Up,e1,b,Ki,Gl,su,Pa,Y,"Throttled",-0,0),U);break e}SS(A,x,Fi,Up,e1,b,Ki,Gl,su,Pa,Y,null,-0,0)}}break}while(!0);so(p)}function SS(p,b,x,A,U,Y,re,he,_e,We,tt,it,qe,Ke){if(p.timeoutHandle=-1,it=b.subtreeFlags,it&8192||(it&16785408)===16785408){it={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Gi},gS(b,Y,it);var St=(Y&62914560)===Y?Gp-Ve():(Y&4194048)===Y?wS-Ve():0;if(St=uM(it,St),St!==null){$o=Y,p.cancelPendingCommit=St(MS.bind(null,p,b,Y,x,A,U,re,he,_e,tt,it,null,qe,Ke)),La(p,Y,re,!We);return}}MS(p,b,Y,x,A,U,re,he,_e)}function TF(p){for(var b=p;;){var x=b.tag;if((x===0||x===11||x===15)&&b.flags&16384&&(x=b.updateQueue,x!==null&&(x=x.stores,x!==null)))for(var A=0;A<x.length;A++){var U=x[A],Y=U.getSnapshot;U=U.value;try{if(!zi(Y(),U))return!1}catch{return!1}}if(x=b.child,b.subtreeFlags&16384&&x!==null)x.return=b,b=x;else{if(b===p)break;for(;b.sibling===null;){if(b.return===null||b.return===p)return!0;b=b.return}b.sibling.return=b.return,b=b.sibling}}return!0}function La(p,b,x,A){b&=~Qv,b&=~Gl,p.suspendedLanes|=b,p.pingedLanes&=~b,A&&(p.warmLanes|=b),A=p.expirationTimes;for(var U=b;0<U;){var Y=31-pt(U),re=1<<Y;A[Y]=-1,U&=~re}x!==0&&yr(p,x,b)}function Wp(){return(kr&6)===0?(lh(0),!1):!0}function i1(){if(ur!==null){if(Mr===0)var p=ur.return;else p=ur,Oo=Pl=null,yv(p),Zc=null,Ud=0,p=ur;for(;p!==null;)eS(p.alternate,p),p=p.return;ur=null}}function au(p,b){var x=p.timeoutHandle;x!==-1&&(p.timeoutHandle=-1,$F(x)),x=p.cancelPendingCommit,x!==null&&(p.cancelPendingCommit=null,x()),$o=0,i1(),Wr=p,ur=x=Po(p.current,null),gr=b,Mr=0,qi=null,Pa=!1,iu=Jt(p,b),Jv=!1,su=Ki=Qv=Gl=Ia=ln=0,Fi=oh=null,e1=!1,(b&8)!==0&&(b|=b&32);var A=p.entangledLanes;if(A!==0)for(p=p.entanglements,A&=b;0<A;){var U=31-pt(A),Y=1<<U;b|=p[U],A&=~Y}return Wo=b,hp(),x}function _S(p,b){Qt=null,S.H=Jd,b===Yc||b===yp?(b=jx(),Mr=3):b===lv?(b=jx(),Mr=4):Mr=b===Nv?8:b!==null&&typeof b=="object"&&typeof b.then=="function"?6:1,qi=b,ur===null&&(ln=1,Ip(p,as(b,p.current)))}function ES(){var p=Wi.current;return p===null?!0:(gr&4194048)===gr?ds===null:(gr&62914560)===gr||(gr&536870912)!==0?p===ds:!1}function TS(){var p=S.H;return S.H=Jd,p===null?Jd:p}function kS(){var p=S.A;return S.A=_F,p}function $p(){ln=4,Pa||(gr&4194048)!==gr&&Wi.current!==null||(iu=!0),(Ia&134217727)===0&&(Gl&134217727)===0||Wr===null||La(Wr,gr,Ki,!1)}function s1(p,b,x){var A=kr;kr|=2;var U=TS(),Y=kS();(Wr!==p||gr!==b)&&(Up=null,au(p,b)),b=!1;var re=ln;e:do try{if(Mr!==0&&ur!==null){var he=ur,_e=qi;switch(Mr){case 8:i1(),re=6;break e;case 3:case 2:case 9:case 6:Wi.current===null&&(b=!0);var We=Mr;if(Mr=0,qi=null,lu(p,he,_e,We),x&&iu){re=0;break e}break;default:We=Mr,Mr=0,qi=null,lu(p,he,_e,We)}}kF(),re=ln;break}catch(tt){_S(p,tt)}while(!0);return b&&p.shellSuspendCounter++,Oo=Pl=null,kr=A,S.H=U,S.A=Y,ur===null&&(Wr=null,gr=0,hp()),re}function kF(){for(;ur!==null;)RS(ur)}function RF(p,b){var x=kr;kr|=2;var A=TS(),U=kS();Wr!==p||gr!==b?(Up=null,zp=Ve()+500,au(p,b)):iu=Jt(p,b);e:do try{if(Mr!==0&&ur!==null){b=ur;var Y=qi;t:switch(Mr){case 1:Mr=0,qi=null,lu(p,b,Y,1);break;case 2:case 9:if(Bx(Y)){Mr=0,qi=null,AS(b);break}b=function(){Mr!==2&&Mr!==9||Wr!==p||(Mr=7),so(p)},Y.then(b,b);break e;case 3:Mr=7;break e;case 4:Mr=5;break e;case 7:Bx(Y)?(Mr=0,qi=null,AS(b)):(Mr=0,qi=null,lu(p,b,Y,7));break;case 5:var re=null;switch(ur.tag){case 26:re=ur.memoizedState;case 5:case 27:var he=ur;if(re?p_(re):he.stateNode.complete){Mr=0,qi=null;var _e=he.sibling;if(_e!==null)ur=_e;else{var We=he.return;We!==null?(ur=We,qp(We)):ur=null}break t}}Mr=0,qi=null,lu(p,b,Y,5);break;case 6:Mr=0,qi=null,lu(p,b,Y,6);break;case 8:i1(),ln=6;break e;default:throw Error(n(462))}}AF();break}catch(tt){_S(p,tt)}while(!0);return Oo=Pl=null,S.H=A,S.A=U,kr=x,ur!==null?0:(Wr=null,gr=0,hp(),ln)}function AF(){for(;ur!==null&&!Fe();)RS(ur)}function RS(p){var b=J2(p.alternate,p,Wo);p.memoizedProps=p.pendingProps,b===null?qp(p):ur=b}function AS(p){var b=p,x=b.alternate;switch(b.tag){case 15:case 0:b=$2(x,b,b.pendingProps,b.type,void 0,gr);break;case 11:b=$2(x,b,b.pendingProps,b.type.render,b.ref,gr);break;case 5:yv(b);default:eS(x,b),b=ur=kx(b,Wo),b=J2(x,b,Wo)}p.memoizedProps=p.pendingProps,b===null?qp(p):ur=b}function lu(p,b,x,A){Oo=Pl=null,yv(b),Zc=null,Ud=0;var U=b.return;try{if(vF(p,U,b,x,gr)){ln=1,Ip(p,as(x,p.current)),ur=null;return}}catch(Y){if(U!==null)throw ur=U,Y;ln=1,Ip(p,as(x,p.current)),ur=null;return}b.flags&32768?(wr||A===1?p=!0:iu||(gr&536870912)!==0?p=!1:(Pa=p=!0,(A===2||A===9||A===3||A===6)&&(A=Wi.current,A!==null&&A.tag===13&&(A.flags|=16384))),FS(b,p)):qp(b)}function qp(p){var b=p;do{if((b.flags&32768)!==0){FS(b,Pa);return}p=b.return;var x=yF(b.alternate,b,Wo);if(x!==null){ur=x;return}if(b=b.sibling,b!==null){ur=b;return}ur=b=p}while(b!==null);ln===0&&(ln=5)}function FS(p,b){do{var x=CF(p.alternate,p);if(x!==null){x.flags&=32767,ur=x;return}if(x=p.return,x!==null&&(x.flags|=32768,x.subtreeFlags=0,x.deletions=null),!b&&(p=p.sibling,p!==null)){ur=p;return}ur=p=x}while(p!==null);ln=6,ur=null}function MS(p,b,x,A,U,Y,re,he,_e){p.cancelPendingCommit=null;do Kp();while(In!==0);if((kr&6)!==0)throw Error(n(327));if(b!==null){if(b===p.current)throw Error(n(177));if(Y=b.lanes|b.childLanes,Y|=qm,fr(p,x,Y,re,he,_e),p===Wr&&(ur=Wr=null,gr=0),ou=b,Na=p,$o=x,t1=Y,r1=U,yS=A,(b.subtreeFlags&10256)!==0||(b.flags&10256)!==0?(p.callbackNode=null,p.callbackPriority=0,PF(be,function(){return NS(),null})):(p.callbackNode=null,p.callbackPriority=0),A=(b.flags&13878)!==0,(b.subtreeFlags&13878)!==0||A){A=S.T,S.T=null,U=_.p,_.p=2,re=kr,kr|=4;try{xF(p,b,x)}finally{kr=re,_.p=U,S.T=A}}In=1,DS(),PS(),IS()}}function DS(){if(In===1){In=0;var p=Na,b=ou,x=(b.flags&13878)!==0;if((b.subtreeFlags&13878)!==0||x){x=S.T,S.T=null;var A=_.p;_.p=2;var U=kr;kr|=4;try{hS(b,p);var Y=v1,re=bx(p.containerInfo),he=Y.focusedElem,_e=Y.selectionRange;if(re!==he&&he&&he.ownerDocument&&vx(he.ownerDocument.documentElement,he)){if(_e!==null&&Gm(he)){var We=_e.start,tt=_e.end;if(tt===void 0&&(tt=We),"selectionStart"in he)he.selectionStart=We,he.selectionEnd=Math.min(tt,he.value.length);else{var it=he.ownerDocument||document,qe=it&&it.defaultView||window;if(qe.getSelection){var Ke=qe.getSelection(),St=he.textContent.length,Bt=Math.min(_e.start,St),Vr=_e.end===void 0?Bt:Math.min(_e.end,St);!Ke.extend&&Bt>Vr&&(re=Vr,Vr=Bt,Bt=re);var Ne=mx(he,Bt),Ae=mx(he,Vr);if(Ne&&Ae&&(Ke.rangeCount!==1||Ke.anchorNode!==Ne.node||Ke.anchorOffset!==Ne.offset||Ke.focusNode!==Ae.node||Ke.focusOffset!==Ae.offset)){var Ue=it.createRange();Ue.setStart(Ne.node,Ne.offset),Ke.removeAllRanges(),Bt>Vr?(Ke.addRange(Ue),Ke.extend(Ae.node,Ae.offset)):(Ue.setEnd(Ae.node,Ae.offset),Ke.addRange(Ue))}}}}for(it=[],Ke=he;Ke=Ke.parentNode;)Ke.nodeType===1&&it.push({element:Ke,left:Ke.scrollLeft,top:Ke.scrollTop});for(typeof he.focus=="function"&&he.focus(),he=0;he<it.length;he++){var rt=it[he];rt.element.scrollLeft=rt.left,rt.element.scrollTop=rt.top}}og=!!m1,v1=m1=null}finally{kr=U,_.p=A,S.T=x}}p.current=b,In=2}}function PS(){if(In===2){In=0;var p=Na,b=ou,x=(b.flags&8772)!==0;if((b.subtreeFlags&8772)!==0||x){x=S.T,S.T=null;var A=_.p;_.p=2;var U=kr;kr|=4;try{aS(p,b.alternate,b)}finally{kr=U,_.p=A,S.T=x}}In=3}}function IS(){if(In===4||In===3){In=0,Ge();var p=Na,b=ou,x=$o,A=yS;(b.subtreeFlags&10256)!==0||(b.flags&10256)!==0?In=5:(In=0,ou=Na=null,OS(p,p.pendingLanes));var U=p.pendingLanes;if(U===0&&(Oa=null),Xe(x),b=b.stateNode,De&&typeof De.onCommitFiberRoot=="function")try{De.onCommitFiberRoot(Pe,b,void 0,(b.current.flags&128)===128)}catch{}if(A!==null){b=S.T,U=_.p,_.p=2,S.T=null;try{for(var Y=p.onRecoverableError,re=0;re<A.length;re++){var he=A[re];Y(he.value,{componentStack:he.stack})}}finally{S.T=b,_.p=U}}($o&3)!==0&&Kp(),so(p),U=p.pendingLanes,(x&261930)!==0&&(U&42)!==0?p===n1?ah++:(ah=0,n1=p):ah=0,lh(0)}}function OS(p,b){(p.pooledCacheLanes&=b)===0&&(b=p.pooledCache,b!=null&&(p.pooledCache=null,Gd(b)))}function Kp(){return DS(),PS(),IS(),NS()}function NS(){if(In!==5)return!1;var p=Na,b=t1;t1=0;var x=Xe($o),A=S.T,U=_.p;try{_.p=32>x?32:x,S.T=null,x=r1,r1=null;var Y=Na,re=$o;if(In=0,ou=Na=null,$o=0,(kr&6)!==0)throw Error(n(331));var he=kr;if(kr|=4,vS(Y.current),pS(Y,Y.current,re,x),kr=he,lh(0,!1),De&&typeof De.onPostCommitFiberRoot=="function")try{De.onPostCommitFiberRoot(Pe,Y)}catch{}return!0}finally{_.p=U,S.T=A,OS(p,b)}}function LS(p,b,x){b=as(x,b),b=Ov(p.stateNode,b,2),p=Aa(p,b,2),p!==null&&(At(p,2),so(p))}function Dr(p,b,x){if(p.tag===3)LS(p,p,x);else for(;b!==null;){if(b.tag===3){LS(b,p,x);break}else if(b.tag===1){var A=b.stateNode;if(typeof b.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(Oa===null||!Oa.has(A))){p=as(x,p),x=B2(2),A=Aa(b,x,2),A!==null&&(H2(x,A,b,p),At(A,2),so(A));break}}b=b.return}}function o1(p,b,x){var A=p.pingCache;if(A===null){A=p.pingCache=new EF;var U=new Set;A.set(b,U)}else U=A.get(b),U===void 0&&(U=new Set,A.set(b,U));U.has(x)||(Jv=!0,U.add(x),p=FF.bind(null,p,b,x),b.then(p,p))}function FF(p,b,x){var A=p.pingCache;A!==null&&A.delete(b),p.pingedLanes|=p.suspendedLanes&x,p.warmLanes&=~x,Wr===p&&(gr&x)===x&&(ln===4||ln===3&&(gr&62914560)===gr&&300>Ve()-Gp?(kr&2)===0&&au(p,0):Qv|=x,su===gr&&(su=0)),so(p)}function BS(p,b){b===0&&(b=nr()),p=Fl(p,b),p!==null&&(At(p,b),so(p))}function MF(p){var b=p.memoizedState,x=0;b!==null&&(x=b.retryLane),BS(p,x)}function DF(p,b){var x=0;switch(p.tag){case 31:case 13:var A=p.stateNode,U=p.memoizedState;U!==null&&(x=U.retryLane);break;case 19:A=p.stateNode;break;case 22:A=p.stateNode._retryCache;break;default:throw Error(n(314))}A!==null&&A.delete(b),BS(p,x)}function PF(p,b){return Te(p,b)}var Xp=null,cu=null,a1=!1,Yp=!1,l1=!1,Ba=0;function so(p){p!==cu&&p.next===null&&(cu===null?Xp=cu=p:cu=cu.next=p),Yp=!0,a1||(a1=!0,OF())}function lh(p,b){if(!l1&&Yp){l1=!0;do for(var x=!1,A=Xp;A!==null;){if(p!==0){var U=A.pendingLanes;if(U===0)var Y=0;else{var re=A.suspendedLanes,he=A.pingedLanes;Y=(1<<31-pt(42|p)+1)-1,Y&=U&~(re&~he),Y=Y&201326741?Y&201326741|1:Y?Y|2:0}Y!==0&&(x=!0,GS(A,Y))}else Y=gr,Y=sr(A,A===Wr?Y:0,A.cancelPendingCommit!==null||A.timeoutHandle!==-1),(Y&3)===0||Jt(A,Y)||(x=!0,GS(A,Y));A=A.next}while(x);l1=!1}}function IF(){HS()}function HS(){Yp=a1=!1;var p=0;Ba!==0&&WF()&&(p=Ba);for(var b=Ve(),x=null,A=Xp;A!==null;){var U=A.next,Y=jS(A,b);Y===0?(A.next=null,x===null?Xp=U:x.next=U,U===null&&(cu=x)):(x=A,(p!==0||(Y&3)!==0)&&(Yp=!0)),A=U}In!==0&&In!==5||lh(p),Ba!==0&&(Ba=0)}function jS(p,b){for(var x=p.suspendedLanes,A=p.pingedLanes,U=p.expirationTimes,Y=p.pendingLanes&-62914561;0<Y;){var re=31-pt(Y),he=1<<re,_e=U[re];_e===-1?((he&x)===0||(he&A)!==0)&&(U[re]=Tt(he,b)):_e<=b&&(p.expiredLanes|=he),Y&=~he}if(b=Wr,x=gr,x=sr(p,p===b?x:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),A=p.callbackNode,x===0||p===b&&(Mr===2||Mr===9)||p.cancelPendingCommit!==null)return A!==null&&A!==null&&xe(A),p.callbackNode=null,p.callbackPriority=0;if((x&3)===0||Jt(p,x)){if(b=x&-x,b===p.callbackPriority)return b;switch(A!==null&&xe(A),Xe(x)){case 2:case 8:x=ht;break;case 32:x=be;break;case 268435456:x=we;break;default:x=be}return A=VS.bind(null,p),x=Te(x,A),p.callbackPriority=b,p.callbackNode=x,b}return A!==null&&A!==null&&xe(A),p.callbackPriority=2,p.callbackNode=null,2}function VS(p,b){if(In!==0&&In!==5)return p.callbackNode=null,p.callbackPriority=0,null;var x=p.callbackNode;if(Kp()&&p.callbackNode!==x)return null;var A=gr;return A=sr(p,p===Wr?A:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),A===0?null:(xS(p,A,b),jS(p,Ve()),p.callbackNode!=null&&p.callbackNode===x?VS.bind(null,p):null)}function GS(p,b){if(Kp())return null;xS(p,b,!0)}function OF(){qF(function(){(kr&6)!==0?Te(ut,IF):HS()})}function c1(){if(Ba===0){var p=Kc;p===0&&(p=Ct,Ct<<=1,(Ct&261888)===0&&(Ct=256)),Ba=p}return Ba}function zS(p){return p==null||typeof p=="symbol"||typeof p=="boolean"?null:typeof p=="function"?p:Fo(""+p)}function US(p,b){var x=b.ownerDocument.createElement("input");return x.name=b.name,x.value=b.value,p.id&&x.setAttribute("form",p.id),b.parentNode.insertBefore(x,b),p=new FormData(p),x.parentNode.removeChild(x),p}function NF(p,b,x,A,U){if(b==="submit"&&x&&x.stateNode===U){var Y=zS((U[fe]||null).action),re=A.submitter;re&&(b=(b=re[fe]||null)?zS(b.formAction):re.getAttribute("formAction"),b!==null&&(Y=b,re=null));var he=new lp("action","action",null,A,U);p.push({event:he,listeners:[{instance:null,listener:function(){if(A.defaultPrevented){if(Ba!==0){var _e=re?US(U,re):new FormData(U);Av(x,{pending:!0,data:_e,method:U.method,action:Y},null,_e)}}else typeof Y=="function"&&(he.preventDefault(),_e=re?US(U,re):new FormData(U),Av(x,{pending:!0,data:_e,method:U.method,action:Y},Y,_e))},currentTarget:U}]})}}for(var u1=0;u1<$m.length;u1++){var d1=$m[u1],LF=d1.toLowerCase(),BF=d1[0].toUpperCase()+d1.slice(1);Is(LF,"on"+BF)}Is(Cx,"onAnimationEnd"),Is(xx,"onAnimationIteration"),Is(Sx,"onAnimationStart"),Is("dblclick","onDoubleClick"),Is("focusin","onFocus"),Is("focusout","onBlur"),Is(eF,"onTransitionRun"),Is(tF,"onTransitionStart"),Is(rF,"onTransitionCancel"),Is(_x,"onTransitionEnd"),dt("onMouseEnter",["mouseout","mouseover"]),dt("onMouseLeave",["mouseout","mouseover"]),dt("onPointerEnter",["pointerout","pointerover"]),dt("onPointerLeave",["pointerout","pointerover"]),ot("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ot("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ot("onBeforeInput",["compositionend","keypress","textInput","paste"]),ot("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ot("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ot("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ch="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),HF=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ch));function WS(p,b){b=(b&4)!==0;for(var x=0;x<p.length;x++){var A=p[x],U=A.event;A=A.listeners;e:{var Y=void 0;if(b)for(var re=A.length-1;0<=re;re--){var he=A[re],_e=he.instance,We=he.currentTarget;if(he=he.listener,_e!==Y&&U.isPropagationStopped())break e;Y=he,U.currentTarget=We;try{Y(U)}catch(tt){dp(tt)}U.currentTarget=null,Y=_e}else for(re=0;re<A.length;re++){if(he=A[re],_e=he.instance,We=he.currentTarget,he=he.listener,_e!==Y&&U.isPropagationStopped())break e;Y=he,U.currentTarget=We;try{Y(U)}catch(tt){dp(tt)}U.currentTarget=null,Y=_e}}}}function dr(p,b){var x=b[Re];x===void 0&&(x=b[Re]=new Set);var A=p+"__bubble";x.has(A)||($S(b,p,2,!1),x.add(A))}function h1(p,b,x){var A=0;b&&(A|=4),$S(x,p,A,b)}var Zp="_reactListening"+Math.random().toString(36).slice(2);function f1(p){if(!p[Zp]){p[Zp]=!0,Qe.forEach(function(x){x!=="selectionchange"&&(HF.has(x)||h1(x,!1,p),h1(x,!0,p))});var b=p.nodeType===9?p:p.ownerDocument;b===null||b[Zp]||(b[Zp]=!0,h1("selectionchange",!1,b))}}function $S(p,b,x,A){switch(C_(b)){case 2:var U=fM;break;case 8:U=pM;break;default:U=R1}x=U.bind(null,b,x,p),U=void 0,!Pm||b!=="touchstart"&&b!=="touchmove"&&b!=="wheel"||(U=!0),A?U!==void 0?p.addEventListener(b,x,{capture:!0,passive:U}):p.addEventListener(b,x,!0):U!==void 0?p.addEventListener(b,x,{passive:U}):p.addEventListener(b,x,!1)}function p1(p,b,x,A,U){var Y=A;if((b&1)===0&&(b&2)===0&&A!==null)e:for(;;){if(A===null)return;var re=A.tag;if(re===3||re===4){var he=A.stateNode.containerInfo;if(he===U)break;if(re===4)for(re=A.return;re!==null;){var _e=re.tag;if((_e===3||_e===4)&&re.stateNode.containerInfo===U)return;re=re.return}for(;he!==null;){if(re=ct(he),re===null)return;if(_e=re.tag,_e===5||_e===6||_e===26||_e===27){A=Y=re;continue e}he=he.parentNode}}A=A.return}ZC(function(){var We=Y,tt=Ca(x),it=[];e:{var qe=Ex.get(p);if(qe!==void 0){var Ke=lp,St=p;switch(p){case"keypress":if(op(x)===0)break e;case"keydown":case"keyup":Ke=DA;break;case"focusin":St="focus",Ke=Lm;break;case"focusout":St="blur",Ke=Lm;break;case"beforeblur":case"afterblur":Ke=Lm;break;case"click":if(x.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ke=ex;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ke=yA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ke=OA;break;case Cx:case xx:case Sx:Ke=SA;break;case _x:Ke=LA;break;case"scroll":case"scrollend":Ke=bA;break;case"wheel":Ke=HA;break;case"copy":case"cut":case"paste":Ke=EA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ke=rx;break;case"toggle":case"beforetoggle":Ke=VA}var Bt=(b&4)!==0,Vr=!Bt&&(p==="scroll"||p==="scrollend"),Ne=Bt?qe!==null?qe+"Capture":null:qe;Bt=[];for(var Ae=We,Ue;Ae!==null;){var rt=Ae;if(Ue=rt.stateNode,rt=rt.tag,rt!==5&&rt!==26&&rt!==27||Ue===null||Ne===null||(rt=Md(Ae,Ne),rt!=null&&Bt.push(uh(Ae,rt,Ue))),Vr)break;Ae=Ae.return}0<Bt.length&&(qe=new Ke(qe,St,null,x,tt),it.push({event:qe,listeners:Bt}))}}if((b&7)===0){e:{if(qe=p==="mouseover"||p==="pointerover",Ke=p==="mouseout"||p==="pointerout",qe&&x!==ya&&(St=x.relatedTarget||x.fromElement)&&(ct(St)||St[ge]))break e;if((Ke||qe)&&(qe=tt.window===tt?tt:(qe=tt.ownerDocument)?qe.defaultView||qe.parentWindow:window,Ke?(St=x.relatedTarget||x.toElement,Ke=We,St=St?ct(St):null,St!==null&&(Vr=s(St),Bt=St.tag,St!==Vr||Bt!==5&&Bt!==27&&Bt!==6)&&(St=null)):(Ke=null,St=We),Ke!==St)){if(Bt=ex,rt="onMouseLeave",Ne="onMouseEnter",Ae="mouse",(p==="pointerout"||p==="pointerover")&&(Bt=rx,rt="onPointerLeave",Ne="onPointerEnter",Ae="pointer"),Vr=Ke==null?qe:ce(Ke),Ue=St==null?qe:ce(St),qe=new Bt(rt,Ae+"leave",Ke,x,tt),qe.target=Vr,qe.relatedTarget=Ue,rt=null,ct(tt)===We&&(Bt=new Bt(Ne,Ae+"enter",St,x,tt),Bt.target=Ue,Bt.relatedTarget=Vr,rt=Bt),Vr=rt,Ke&&St)t:{for(Bt=jF,Ne=Ke,Ae=St,Ue=0,rt=Ne;rt;rt=Bt(rt))Ue++;rt=0;for(var Ft=Ae;Ft;Ft=Bt(Ft))rt++;for(;0<Ue-rt;)Ne=Bt(Ne),Ue--;for(;0<rt-Ue;)Ae=Bt(Ae),rt--;for(;Ue--;){if(Ne===Ae||Ae!==null&&Ne===Ae.alternate){Bt=Ne;break t}Ne=Bt(Ne),Ae=Bt(Ae)}Bt=null}else Bt=null;Ke!==null&&qS(it,qe,Ke,Bt,!1),St!==null&&Vr!==null&&qS(it,Vr,St,Bt,!0)}}e:{if(qe=We?ce(We):window,Ke=qe.nodeName&&qe.nodeName.toLowerCase(),Ke==="select"||Ke==="input"&&qe.type==="file")var _r=ux;else if(lx(qe))if(dx)_r=ZA;else{_r=XA;var Et=KA}else Ke=qe.nodeName,!Ke||Ke.toLowerCase()!=="input"||qe.type!=="checkbox"&&qe.type!=="radio"?We&&eo(We.elementType)&&(_r=ux):_r=YA;if(_r&&(_r=_r(p,We))){cx(it,_r,x,tt);break e}Et&&Et(p,qe,We),p==="focusout"&&We&&qe.type==="number"&&We.memoizedProps.value!=null&&ss(qe,"number",qe.value)}switch(Et=We?ce(We):window,p){case"focusin":(lx(Et)||Et.contentEditable==="true")&&(jc=Et,zm=We,Hd=null);break;case"focusout":Hd=zm=jc=null;break;case"mousedown":Um=!0;break;case"contextmenu":case"mouseup":case"dragend":Um=!1,wx(it,x,tt);break;case"selectionchange":if(QA)break;case"keydown":case"keyup":wx(it,x,tt)}var tr;if(Hm)e:{switch(p){case"compositionstart":var mr="onCompositionStart";break e;case"compositionend":mr="onCompositionEnd";break e;case"compositionupdate":mr="onCompositionUpdate";break e}mr=void 0}else Hc?ox(p,x)&&(mr="onCompositionEnd"):p==="keydown"&&x.keyCode===229&&(mr="onCompositionStart");mr&&(nx&&x.locale!=="ko"&&(Hc||mr!=="onCompositionStart"?mr==="onCompositionEnd"&&Hc&&(tr=JC()):(xa=tt,Im="value"in xa?xa.value:xa.textContent,Hc=!0)),Et=Jp(We,mr),0<Et.length&&(mr=new tx(mr,p,null,x,tt),it.push({event:mr,listeners:Et}),tr?mr.data=tr:(tr=ax(x),tr!==null&&(mr.data=tr)))),(tr=zA?UA(p,x):WA(p,x))&&(mr=Jp(We,"onBeforeInput"),0<mr.length&&(Et=new tx("onBeforeInput","beforeinput",null,x,tt),it.push({event:Et,listeners:mr}),Et.data=tr)),NF(it,p,We,x,tt)}WS(it,b)})}function uh(p,b,x){return{instance:p,listener:b,currentTarget:x}}function Jp(p,b){for(var x=b+"Capture",A=[];p!==null;){var U=p,Y=U.stateNode;if(U=U.tag,U!==5&&U!==26&&U!==27||Y===null||(U=Md(p,x),U!=null&&A.unshift(uh(p,U,Y)),U=Md(p,b),U!=null&&A.push(uh(p,U,Y))),p.tag===3)return A;p=p.return}return[]}function jF(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5&&p.tag!==27);return p||null}function qS(p,b,x,A,U){for(var Y=b._reactName,re=[];x!==null&&x!==A;){var he=x,_e=he.alternate,We=he.stateNode;if(he=he.tag,_e!==null&&_e===A)break;he!==5&&he!==26&&he!==27||We===null||(_e=We,U?(We=Md(x,Y),We!=null&&re.unshift(uh(x,We,_e))):U||(We=Md(x,Y),We!=null&&re.push(uh(x,We,_e)))),x=x.return}re.length!==0&&p.push({event:b,listeners:re})}var VF=/\r\n?/g,GF=/\u0000|\uFFFD/g;function KS(p){return(typeof p=="string"?p:""+p).replace(VF,`
`).replace(GF,"")}function XS(p,b){return b=KS(b),KS(p)===b}function jr(p,b,x,A,U,Y){switch(x){case"children":typeof A=="string"?b==="body"||b==="textarea"&&A===""||si(p,A):(typeof A=="number"||typeof A=="bigint")&&b!=="body"&&si(p,""+A);break;case"className":br(p,"class",A);break;case"tabIndex":br(p,"tabindex",A);break;case"dir":case"role":case"viewBox":case"width":case"height":br(p,x,A);break;case"style":El(p,A,Y);break;case"data":if(b!=="object"){br(p,"data",A);break}case"src":case"href":if(A===""&&(b!=="a"||x!=="href")){p.removeAttribute(x);break}if(A==null||typeof A=="function"||typeof A=="symbol"||typeof A=="boolean"){p.removeAttribute(x);break}A=Fo(""+A),p.setAttribute(x,A);break;case"action":case"formAction":if(typeof A=="function"){p.setAttribute(x,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof Y=="function"&&(x==="formAction"?(b!=="input"&&jr(p,b,"name",U.name,U,null),jr(p,b,"formEncType",U.formEncType,U,null),jr(p,b,"formMethod",U.formMethod,U,null),jr(p,b,"formTarget",U.formTarget,U,null)):(jr(p,b,"encType",U.encType,U,null),jr(p,b,"method",U.method,U,null),jr(p,b,"target",U.target,U,null)));if(A==null||typeof A=="symbol"||typeof A=="boolean"){p.removeAttribute(x);break}A=Fo(""+A),p.setAttribute(x,A);break;case"onClick":A!=null&&(p.onclick=Gi);break;case"onScroll":A!=null&&dr("scroll",p);break;case"onScrollEnd":A!=null&&dr("scrollend",p);break;case"dangerouslySetInnerHTML":if(A!=null){if(typeof A!="object"||!("__html"in A))throw Error(n(61));if(x=A.__html,x!=null){if(U.children!=null)throw Error(n(60));p.innerHTML=x}}break;case"multiple":p.multiple=A&&typeof A!="function"&&typeof A!="symbol";break;case"muted":p.muted=A&&typeof A!="function"&&typeof A!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(A==null||typeof A=="function"||typeof A=="boolean"||typeof A=="symbol"){p.removeAttribute("xlink:href");break}x=Fo(""+A),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",x);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":A!=null&&typeof A!="function"&&typeof A!="symbol"?p.setAttribute(x,""+A):p.removeAttribute(x);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":A&&typeof A!="function"&&typeof A!="symbol"?p.setAttribute(x,""):p.removeAttribute(x);break;case"capture":case"download":A===!0?p.setAttribute(x,""):A!==!1&&A!=null&&typeof A!="function"&&typeof A!="symbol"?p.setAttribute(x,A):p.removeAttribute(x);break;case"cols":case"rows":case"size":case"span":A!=null&&typeof A!="function"&&typeof A!="symbol"&&!isNaN(A)&&1<=A?p.setAttribute(x,A):p.removeAttribute(x);break;case"rowSpan":case"start":A==null||typeof A=="function"||typeof A=="symbol"||isNaN(A)?p.removeAttribute(x):p.setAttribute(x,A);break;case"popover":dr("beforetoggle",p),dr("toggle",p),qt(p,"popover",A);break;case"xlinkActuate":or(p,"http://www.w3.org/1999/xlink","xlink:actuate",A);break;case"xlinkArcrole":or(p,"http://www.w3.org/1999/xlink","xlink:arcrole",A);break;case"xlinkRole":or(p,"http://www.w3.org/1999/xlink","xlink:role",A);break;case"xlinkShow":or(p,"http://www.w3.org/1999/xlink","xlink:show",A);break;case"xlinkTitle":or(p,"http://www.w3.org/1999/xlink","xlink:title",A);break;case"xlinkType":or(p,"http://www.w3.org/1999/xlink","xlink:type",A);break;case"xmlBase":or(p,"http://www.w3.org/XML/1998/namespace","xml:base",A);break;case"xmlLang":or(p,"http://www.w3.org/XML/1998/namespace","xml:lang",A);break;case"xmlSpace":or(p,"http://www.w3.org/XML/1998/namespace","xml:space",A);break;case"is":qt(p,"is",A);break;case"innerText":case"textContent":break;default:(!(2<x.length)||x[0]!=="o"&&x[0]!=="O"||x[1]!=="n"&&x[1]!=="N")&&(x=to.get(x)||x,qt(p,x,A))}}function g1(p,b,x,A,U,Y){switch(x){case"style":El(p,A,Y);break;case"dangerouslySetInnerHTML":if(A!=null){if(typeof A!="object"||!("__html"in A))throw Error(n(61));if(x=A.__html,x!=null){if(U.children!=null)throw Error(n(60));p.innerHTML=x}}break;case"children":typeof A=="string"?si(p,A):(typeof A=="number"||typeof A=="bigint")&&si(p,""+A);break;case"onScroll":A!=null&&dr("scroll",p);break;case"onScrollEnd":A!=null&&dr("scrollend",p);break;case"onClick":A!=null&&(p.onclick=Gi);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!gt.hasOwnProperty(x))e:{if(x[0]==="o"&&x[1]==="n"&&(U=x.endsWith("Capture"),b=x.slice(2,U?x.length-7:void 0),Y=p[fe]||null,Y=Y!=null?Y[x]:null,typeof Y=="function"&&p.removeEventListener(b,Y,U),typeof A=="function")){typeof Y!="function"&&Y!==null&&(x in p?p[x]=null:p.hasAttribute(x)&&p.removeAttribute(x)),p.addEventListener(b,A,U);break e}x in p?p[x]=A:A===!0?p.setAttribute(x,""):qt(p,x,A)}}}function Yn(p,b,x){switch(b){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":dr("error",p),dr("load",p);var A=!1,U=!1,Y;for(Y in x)if(x.hasOwnProperty(Y)){var re=x[Y];if(re!=null)switch(Y){case"src":A=!0;break;case"srcSet":U=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,b));default:jr(p,b,Y,re,x,null)}}U&&jr(p,b,"srcSet",x.srcSet,x,null),A&&jr(p,b,"src",x.src,x,null);return;case"input":dr("invalid",p);var he=Y=re=U=null,_e=null,We=null;for(A in x)if(x.hasOwnProperty(A)){var tt=x[A];if(tt!=null)switch(A){case"name":U=tt;break;case"type":re=tt;break;case"checked":_e=tt;break;case"defaultChecked":We=tt;break;case"value":Y=tt;break;case"defaultValue":he=tt;break;case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(n(137,b));break;default:jr(p,b,A,tt,x,null)}}cr(p,Y,he,_e,We,re,U,!1);return;case"select":dr("invalid",p),A=re=Y=null;for(U in x)if(x.hasOwnProperty(U)&&(he=x[U],he!=null))switch(U){case"value":Y=he;break;case"defaultValue":re=he;break;case"multiple":A=he;default:jr(p,b,U,he,x,null)}b=Y,x=re,p.multiple=!!A,b!=null?Ei(p,!!A,b,!1):x!=null&&Ei(p,!!A,x,!0);return;case"textarea":dr("invalid",p),Y=U=A=null;for(re in x)if(x.hasOwnProperty(re)&&(he=x[re],he!=null))switch(re){case"value":A=he;break;case"defaultValue":U=he;break;case"children":Y=he;break;case"dangerouslySetInnerHTML":if(he!=null)throw Error(n(91));break;default:jr(p,b,re,he,x,null)}ii(p,A,U,Y);return;case"option":for(_e in x)x.hasOwnProperty(_e)&&(A=x[_e],A!=null)&&(_e==="selected"?p.selected=A&&typeof A!="function"&&typeof A!="symbol":jr(p,b,_e,A,x,null));return;case"dialog":dr("beforetoggle",p),dr("toggle",p),dr("cancel",p),dr("close",p);break;case"iframe":case"object":dr("load",p);break;case"video":case"audio":for(A=0;A<ch.length;A++)dr(ch[A],p);break;case"image":dr("error",p),dr("load",p);break;case"details":dr("toggle",p);break;case"embed":case"source":case"link":dr("error",p),dr("load",p);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(We in x)if(x.hasOwnProperty(We)&&(A=x[We],A!=null))switch(We){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,b));default:jr(p,b,We,A,x,null)}return;default:if(eo(b)){for(tt in x)x.hasOwnProperty(tt)&&(A=x[tt],A!==void 0&&g1(p,b,tt,A,x,void 0));return}}for(he in x)x.hasOwnProperty(he)&&(A=x[he],A!=null&&jr(p,b,he,A,x,null))}function zF(p,b,x,A){switch(b){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var U=null,Y=null,re=null,he=null,_e=null,We=null,tt=null;for(Ke in x){var it=x[Ke];if(x.hasOwnProperty(Ke)&&it!=null)switch(Ke){case"checked":break;case"value":break;case"defaultValue":_e=it;default:A.hasOwnProperty(Ke)||jr(p,b,Ke,null,A,it)}}for(var qe in A){var Ke=A[qe];if(it=x[qe],A.hasOwnProperty(qe)&&(Ke!=null||it!=null))switch(qe){case"type":Y=Ke;break;case"name":U=Ke;break;case"checked":We=Ke;break;case"defaultChecked":tt=Ke;break;case"value":re=Ke;break;case"defaultValue":he=Ke;break;case"children":case"dangerouslySetInnerHTML":if(Ke!=null)throw Error(n(137,b));break;default:Ke!==it&&jr(p,b,qe,Ke,A,it)}}Cr(p,re,he,_e,We,tt,Y,U);return;case"select":Ke=re=he=qe=null;for(Y in x)if(_e=x[Y],x.hasOwnProperty(Y)&&_e!=null)switch(Y){case"value":break;case"multiple":Ke=_e;default:A.hasOwnProperty(Y)||jr(p,b,Y,null,A,_e)}for(U in A)if(Y=A[U],_e=x[U],A.hasOwnProperty(U)&&(Y!=null||_e!=null))switch(U){case"value":qe=Y;break;case"defaultValue":he=Y;break;case"multiple":re=Y;default:Y!==_e&&jr(p,b,U,Y,A,_e)}b=he,x=re,A=Ke,qe!=null?Ei(p,!!x,qe,!1):!!A!=!!x&&(b!=null?Ei(p,!!x,b,!0):Ei(p,!!x,x?[]:"",!1));return;case"textarea":Ke=qe=null;for(he in x)if(U=x[he],x.hasOwnProperty(he)&&U!=null&&!A.hasOwnProperty(he))switch(he){case"value":break;case"children":break;default:jr(p,b,he,null,A,U)}for(re in A)if(U=A[re],Y=x[re],A.hasOwnProperty(re)&&(U!=null||Y!=null))switch(re){case"value":qe=U;break;case"defaultValue":Ke=U;break;case"children":break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(n(91));break;default:U!==Y&&jr(p,b,re,U,A,Y)}_l(p,qe,Ke);return;case"option":for(var St in x)qe=x[St],x.hasOwnProperty(St)&&qe!=null&&!A.hasOwnProperty(St)&&(St==="selected"?p.selected=!1:jr(p,b,St,null,A,qe));for(_e in A)qe=A[_e],Ke=x[_e],A.hasOwnProperty(_e)&&qe!==Ke&&(qe!=null||Ke!=null)&&(_e==="selected"?p.selected=qe&&typeof qe!="function"&&typeof qe!="symbol":jr(p,b,_e,qe,A,Ke));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Bt in x)qe=x[Bt],x.hasOwnProperty(Bt)&&qe!=null&&!A.hasOwnProperty(Bt)&&jr(p,b,Bt,null,A,qe);for(We in A)if(qe=A[We],Ke=x[We],A.hasOwnProperty(We)&&qe!==Ke&&(qe!=null||Ke!=null))switch(We){case"children":case"dangerouslySetInnerHTML":if(qe!=null)throw Error(n(137,b));break;default:jr(p,b,We,qe,A,Ke)}return;default:if(eo(b)){for(var Vr in x)qe=x[Vr],x.hasOwnProperty(Vr)&&qe!==void 0&&!A.hasOwnProperty(Vr)&&g1(p,b,Vr,void 0,A,qe);for(tt in A)qe=A[tt],Ke=x[tt],!A.hasOwnProperty(tt)||qe===Ke||qe===void 0&&Ke===void 0||g1(p,b,tt,qe,A,Ke);return}}for(var Ne in x)qe=x[Ne],x.hasOwnProperty(Ne)&&qe!=null&&!A.hasOwnProperty(Ne)&&jr(p,b,Ne,null,A,qe);for(it in A)qe=A[it],Ke=x[it],!A.hasOwnProperty(it)||qe===Ke||qe==null&&Ke==null||jr(p,b,it,qe,A,Ke)}function YS(p){switch(p){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function UF(){if(typeof performance.getEntriesByType=="function"){for(var p=0,b=0,x=performance.getEntriesByType("resource"),A=0;A<x.length;A++){var U=x[A],Y=U.transferSize,re=U.initiatorType,he=U.duration;if(Y&&he&&YS(re)){for(re=0,he=U.responseEnd,A+=1;A<x.length;A++){var _e=x[A],We=_e.startTime;if(We>he)break;var tt=_e.transferSize,it=_e.initiatorType;tt&&YS(it)&&(_e=_e.responseEnd,re+=tt*(_e<he?1:(he-We)/(_e-We)))}if(--A,b+=8*(Y+re)/(U.duration/1e3),p++,10<p)break}}if(0<p)return b/p/1e6}return navigator.connection&&(p=navigator.connection.downlink,typeof p=="number")?p:5}var m1=null,v1=null;function Qp(p){return p.nodeType===9?p:p.ownerDocument}function ZS(p){switch(p){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function JS(p,b){if(p===0)switch(b){case"svg":return 1;case"math":return 2;default:return 0}return p===1&&b==="foreignObject"?0:p}function b1(p,b){return p==="textarea"||p==="noscript"||typeof b.children=="string"||typeof b.children=="number"||typeof b.children=="bigint"||typeof b.dangerouslySetInnerHTML=="object"&&b.dangerouslySetInnerHTML!==null&&b.dangerouslySetInnerHTML.__html!=null}var w1=null;function WF(){var p=window.event;return p&&p.type==="popstate"?p===w1?!1:(w1=p,!0):(w1=null,!1)}var QS=typeof setTimeout=="function"?setTimeout:void 0,$F=typeof clearTimeout=="function"?clearTimeout:void 0,e_=typeof Promise=="function"?Promise:void 0,qF=typeof queueMicrotask=="function"?queueMicrotask:typeof e_<"u"?function(p){return e_.resolve(null).then(p).catch(KF)}:QS;function KF(p){setTimeout(function(){throw p})}function Ha(p){return p==="head"}function t_(p,b){var x=b,A=0;do{var U=x.nextSibling;if(p.removeChild(x),U&&U.nodeType===8)if(x=U.data,x==="/$"||x==="/&"){if(A===0){p.removeChild(U),fu(b);return}A--}else if(x==="$"||x==="$?"||x==="$~"||x==="$!"||x==="&")A++;else if(x==="html")dh(p.ownerDocument.documentElement);else if(x==="head"){x=p.ownerDocument.head,dh(x);for(var Y=x.firstChild;Y;){var re=Y.nextSibling,he=Y.nodeName;Y[Oe]||he==="SCRIPT"||he==="STYLE"||he==="LINK"&&Y.rel.toLowerCase()==="stylesheet"||x.removeChild(Y),Y=re}}else x==="body"&&dh(p.ownerDocument.body);x=U}while(x);fu(b)}function r_(p,b){var x=p;p=0;do{var A=x.nextSibling;if(x.nodeType===1?b?(x._stashedDisplay=x.style.display,x.style.display="none"):(x.style.display=x._stashedDisplay||"",x.getAttribute("style")===""&&x.removeAttribute("style")):x.nodeType===3&&(b?(x._stashedText=x.nodeValue,x.nodeValue=""):x.nodeValue=x._stashedText||""),A&&A.nodeType===8)if(x=A.data,x==="/$"){if(p===0)break;p--}else x!=="$"&&x!=="$?"&&x!=="$~"&&x!=="$!"||p++;x=A}while(x)}function y1(p){var b=p.firstChild;for(b&&b.nodeType===10&&(b=b.nextSibling);b;){var x=b;switch(b=b.nextSibling,x.nodeName){case"HTML":case"HEAD":case"BODY":y1(x),nt(x);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(x.rel.toLowerCase()==="stylesheet")continue}p.removeChild(x)}}function XF(p,b,x,A){for(;p.nodeType===1;){var U=x;if(p.nodeName.toLowerCase()!==b.toLowerCase()){if(!A&&(p.nodeName!=="INPUT"||p.type!=="hidden"))break}else if(A){if(!p[Oe])switch(b){case"meta":if(!p.hasAttribute("itemprop"))break;return p;case"link":if(Y=p.getAttribute("rel"),Y==="stylesheet"&&p.hasAttribute("data-precedence"))break;if(Y!==U.rel||p.getAttribute("href")!==(U.href==null||U.href===""?null:U.href)||p.getAttribute("crossorigin")!==(U.crossOrigin==null?null:U.crossOrigin)||p.getAttribute("title")!==(U.title==null?null:U.title))break;return p;case"style":if(p.hasAttribute("data-precedence"))break;return p;case"script":if(Y=p.getAttribute("src"),(Y!==(U.src==null?null:U.src)||p.getAttribute("type")!==(U.type==null?null:U.type)||p.getAttribute("crossorigin")!==(U.crossOrigin==null?null:U.crossOrigin))&&Y&&p.hasAttribute("async")&&!p.hasAttribute("itemprop"))break;return p;default:return p}}else if(b==="input"&&p.type==="hidden"){var Y=U.name==null?null:""+U.name;if(U.type==="hidden"&&p.getAttribute("name")===Y)return p}else return p;if(p=hs(p.nextSibling),p===null)break}return null}function YF(p,b,x){if(b==="")return null;for(;p.nodeType!==3;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!x||(p=hs(p.nextSibling),p===null))return null;return p}function n_(p,b){for(;p.nodeType!==8;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!b||(p=hs(p.nextSibling),p===null))return null;return p}function C1(p){return p.data==="$?"||p.data==="$~"}function x1(p){return p.data==="$!"||p.data==="$?"&&p.ownerDocument.readyState!=="loading"}function ZF(p,b){var x=p.ownerDocument;if(p.data==="$~")p._reactRetry=b;else if(p.data!=="$?"||x.readyState!=="loading")b();else{var A=function(){b(),x.removeEventListener("DOMContentLoaded",A)};x.addEventListener("DOMContentLoaded",A),p._reactRetry=A}}function hs(p){for(;p!=null;p=p.nextSibling){var b=p.nodeType;if(b===1||b===3)break;if(b===8){if(b=p.data,b==="$"||b==="$!"||b==="$?"||b==="$~"||b==="&"||b==="F!"||b==="F")break;if(b==="/$"||b==="/&")return null}}return p}var S1=null;function i_(p){p=p.nextSibling;for(var b=0;p;){if(p.nodeType===8){var x=p.data;if(x==="/$"||x==="/&"){if(b===0)return hs(p.nextSibling);b--}else x!=="$"&&x!=="$!"&&x!=="$?"&&x!=="$~"&&x!=="&"||b++}p=p.nextSibling}return null}function s_(p){p=p.previousSibling;for(var b=0;p;){if(p.nodeType===8){var x=p.data;if(x==="$"||x==="$!"||x==="$?"||x==="$~"||x==="&"){if(b===0)return p;b--}else x!=="/$"&&x!=="/&"||b++}p=p.previousSibling}return null}function o_(p,b,x){switch(b=Qp(x),p){case"html":if(p=b.documentElement,!p)throw Error(n(452));return p;case"head":if(p=b.head,!p)throw Error(n(453));return p;case"body":if(p=b.body,!p)throw Error(n(454));return p;default:throw Error(n(451))}}function dh(p){for(var b=p.attributes;b.length;)p.removeAttributeNode(b[0]);nt(p)}var fs=new Map,a_=new Set;function eg(p){return typeof p.getRootNode=="function"?p.getRootNode():p.nodeType===9?p:p.ownerDocument}var qo=_.d;_.d={f:JF,r:QF,D:eM,C:tM,L:rM,m:nM,X:sM,S:iM,M:oM};function JF(){var p=qo.f(),b=Wp();return p||b}function QF(p){var b=ft(p);b!==null&&b.tag===5&&b.type==="form"?_2(b):qo.r(p)}var uu=typeof document>"u"?null:document;function l_(p,b,x){var A=uu;if(A&&typeof b=="string"&&b){var U=Pn(b);U='link[rel="'+p+'"][href="'+U+'"]',typeof x=="string"&&(U+='[crossorigin="'+x+'"]'),a_.has(U)||(a_.add(U),p={rel:p,crossOrigin:x,href:b},A.querySelector(U)===null&&(b=A.createElement("link"),Yn(b,"link",p),Le(b),A.head.appendChild(b)))}}function eM(p){qo.D(p),l_("dns-prefetch",p,null)}function tM(p,b){qo.C(p,b),l_("preconnect",p,b)}function rM(p,b,x){qo.L(p,b,x);var A=uu;if(A&&p&&b){var U='link[rel="preload"][as="'+Pn(b)+'"]';b==="image"&&x&&x.imageSrcSet?(U+='[imagesrcset="'+Pn(x.imageSrcSet)+'"]',typeof x.imageSizes=="string"&&(U+='[imagesizes="'+Pn(x.imageSizes)+'"]')):U+='[href="'+Pn(p)+'"]';var Y=U;switch(b){case"style":Y=du(p);break;case"script":Y=hu(p)}fs.has(Y)||(p=h({rel:"preload",href:b==="image"&&x&&x.imageSrcSet?void 0:p,as:b},x),fs.set(Y,p),A.querySelector(U)!==null||b==="style"&&A.querySelector(hh(Y))||b==="script"&&A.querySelector(fh(Y))||(b=A.createElement("link"),Yn(b,"link",p),Le(b),A.head.appendChild(b)))}}function nM(p,b){qo.m(p,b);var x=uu;if(x&&p){var A=b&&typeof b.as=="string"?b.as:"script",U='link[rel="modulepreload"][as="'+Pn(A)+'"][href="'+Pn(p)+'"]',Y=U;switch(A){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":Y=hu(p)}if(!fs.has(Y)&&(p=h({rel:"modulepreload",href:p},b),fs.set(Y,p),x.querySelector(U)===null)){switch(A){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(x.querySelector(fh(Y)))return}A=x.createElement("link"),Yn(A,"link",p),Le(A),x.head.appendChild(A)}}}function iM(p,b,x){qo.S(p,b,x);var A=uu;if(A&&p){var U=Se(A).hoistableStyles,Y=du(p);b=b||"default";var re=U.get(Y);if(!re){var he={loading:0,preload:null};if(re=A.querySelector(hh(Y)))he.loading=5;else{p=h({rel:"stylesheet",href:p,"data-precedence":b},x),(x=fs.get(Y))&&_1(p,x);var _e=re=A.createElement("link");Le(_e),Yn(_e,"link",p),_e._p=new Promise(function(We,tt){_e.onload=We,_e.onerror=tt}),_e.addEventListener("load",function(){he.loading|=1}),_e.addEventListener("error",function(){he.loading|=2}),he.loading|=4,tg(re,b,A)}re={type:"stylesheet",instance:re,count:1,state:he},U.set(Y,re)}}}function sM(p,b){qo.X(p,b);var x=uu;if(x&&p){var A=Se(x).hoistableScripts,U=hu(p),Y=A.get(U);Y||(Y=x.querySelector(fh(U)),Y||(p=h({src:p,async:!0},b),(b=fs.get(U))&&E1(p,b),Y=x.createElement("script"),Le(Y),Yn(Y,"link",p),x.head.appendChild(Y)),Y={type:"script",instance:Y,count:1,state:null},A.set(U,Y))}}function oM(p,b){qo.M(p,b);var x=uu;if(x&&p){var A=Se(x).hoistableScripts,U=hu(p),Y=A.get(U);Y||(Y=x.querySelector(fh(U)),Y||(p=h({src:p,async:!0,type:"module"},b),(b=fs.get(U))&&E1(p,b),Y=x.createElement("script"),Le(Y),Yn(Y,"link",p),x.head.appendChild(Y)),Y={type:"script",instance:Y,count:1,state:null},A.set(U,Y))}}function c_(p,b,x,A){var U=(U=G.current)?eg(U):null;if(!U)throw Error(n(446));switch(p){case"meta":case"title":return null;case"style":return typeof x.precedence=="string"&&typeof x.href=="string"?(b=du(x.href),x=Se(U).hoistableStyles,A=x.get(b),A||(A={type:"style",instance:null,count:0,state:null},x.set(b,A)),A):{type:"void",instance:null,count:0,state:null};case"link":if(x.rel==="stylesheet"&&typeof x.href=="string"&&typeof x.precedence=="string"){p=du(x.href);var Y=Se(U).hoistableStyles,re=Y.get(p);if(re||(U=U.ownerDocument||U,re={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},Y.set(p,re),(Y=U.querySelector(hh(p)))&&!Y._p&&(re.instance=Y,re.state.loading=5),fs.has(p)||(x={rel:"preload",as:"style",href:x.href,crossOrigin:x.crossOrigin,integrity:x.integrity,media:x.media,hrefLang:x.hrefLang,referrerPolicy:x.referrerPolicy},fs.set(p,x),Y||aM(U,p,x,re.state))),b&&A===null)throw Error(n(528,""));return re}if(b&&A!==null)throw Error(n(529,""));return null;case"script":return b=x.async,x=x.src,typeof x=="string"&&b&&typeof b!="function"&&typeof b!="symbol"?(b=hu(x),x=Se(U).hoistableScripts,A=x.get(b),A||(A={type:"script",instance:null,count:0,state:null},x.set(b,A)),A):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,p))}}function du(p){return'href="'+Pn(p)+'"'}function hh(p){return'link[rel="stylesheet"]['+p+"]"}function u_(p){return h({},p,{"data-precedence":p.precedence,precedence:null})}function aM(p,b,x,A){p.querySelector('link[rel="preload"][as="style"]['+b+"]")?A.loading=1:(b=p.createElement("link"),A.preload=b,b.addEventListener("load",function(){return A.loading|=1}),b.addEventListener("error",function(){return A.loading|=2}),Yn(b,"link",x),Le(b),p.head.appendChild(b))}function hu(p){return'[src="'+Pn(p)+'"]'}function fh(p){return"script[async]"+p}function d_(p,b,x){if(b.count++,b.instance===null)switch(b.type){case"style":var A=p.querySelector('style[data-href~="'+Pn(x.href)+'"]');if(A)return b.instance=A,Le(A),A;var U=h({},x,{"data-href":x.href,"data-precedence":x.precedence,href:null,precedence:null});return A=(p.ownerDocument||p).createElement("style"),Le(A),Yn(A,"style",U),tg(A,x.precedence,p),b.instance=A;case"stylesheet":U=du(x.href);var Y=p.querySelector(hh(U));if(Y)return b.state.loading|=4,b.instance=Y,Le(Y),Y;A=u_(x),(U=fs.get(U))&&_1(A,U),Y=(p.ownerDocument||p).createElement("link"),Le(Y);var re=Y;return re._p=new Promise(function(he,_e){re.onload=he,re.onerror=_e}),Yn(Y,"link",A),b.state.loading|=4,tg(Y,x.precedence,p),b.instance=Y;case"script":return Y=hu(x.src),(U=p.querySelector(fh(Y)))?(b.instance=U,Le(U),U):(A=x,(U=fs.get(Y))&&(A=h({},x),E1(A,U)),p=p.ownerDocument||p,U=p.createElement("script"),Le(U),Yn(U,"link",A),p.head.appendChild(U),b.instance=U);case"void":return null;default:throw Error(n(443,b.type))}else b.type==="stylesheet"&&(b.state.loading&4)===0&&(A=b.instance,b.state.loading|=4,tg(A,x.precedence,p));return b.instance}function tg(p,b,x){for(var A=x.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),U=A.length?A[A.length-1]:null,Y=U,re=0;re<A.length;re++){var he=A[re];if(he.dataset.precedence===b)Y=he;else if(Y!==U)break}Y?Y.parentNode.insertBefore(p,Y.nextSibling):(b=x.nodeType===9?x.head:x,b.insertBefore(p,b.firstChild))}function _1(p,b){p.crossOrigin==null&&(p.crossOrigin=b.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=b.referrerPolicy),p.title==null&&(p.title=b.title)}function E1(p,b){p.crossOrigin==null&&(p.crossOrigin=b.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=b.referrerPolicy),p.integrity==null&&(p.integrity=b.integrity)}var rg=null;function h_(p,b,x){if(rg===null){var A=new Map,U=rg=new Map;U.set(x,A)}else U=rg,A=U.get(x),A||(A=new Map,U.set(x,A));if(A.has(p))return A;for(A.set(p,null),x=x.getElementsByTagName(p),U=0;U<x.length;U++){var Y=x[U];if(!(Y[Oe]||Y[de]||p==="link"&&Y.getAttribute("rel")==="stylesheet")&&Y.namespaceURI!=="http://www.w3.org/2000/svg"){var re=Y.getAttribute(b)||"";re=p+re;var he=A.get(re);he?he.push(Y):A.set(re,[Y])}}return A}function f_(p,b,x){p=p.ownerDocument||p,p.head.insertBefore(x,b==="title"?p.querySelector("head > title"):null)}function lM(p,b,x){if(x===1||b.itemProp!=null)return!1;switch(p){case"meta":case"title":return!0;case"style":if(typeof b.precedence!="string"||typeof b.href!="string"||b.href==="")break;return!0;case"link":if(typeof b.rel!="string"||typeof b.href!="string"||b.href===""||b.onLoad||b.onError)break;return b.rel==="stylesheet"?(p=b.disabled,typeof b.precedence=="string"&&p==null):!0;case"script":if(b.async&&typeof b.async!="function"&&typeof b.async!="symbol"&&!b.onLoad&&!b.onError&&b.src&&typeof b.src=="string")return!0}return!1}function p_(p){return!(p.type==="stylesheet"&&(p.state.loading&3)===0)}function cM(p,b,x,A){if(x.type==="stylesheet"&&(typeof A.media!="string"||matchMedia(A.media).matches!==!1)&&(x.state.loading&4)===0){if(x.instance===null){var U=du(A.href),Y=b.querySelector(hh(U));if(Y){b=Y._p,b!==null&&typeof b=="object"&&typeof b.then=="function"&&(p.count++,p=ng.bind(p),b.then(p,p)),x.state.loading|=4,x.instance=Y,Le(Y);return}Y=b.ownerDocument||b,A=u_(A),(U=fs.get(U))&&_1(A,U),Y=Y.createElement("link"),Le(Y);var re=Y;re._p=new Promise(function(he,_e){re.onload=he,re.onerror=_e}),Yn(Y,"link",A),x.instance=Y}p.stylesheets===null&&(p.stylesheets=new Map),p.stylesheets.set(x,b),(b=x.state.preload)&&(x.state.loading&3)===0&&(p.count++,x=ng.bind(p),b.addEventListener("load",x),b.addEventListener("error",x))}}var T1=0;function uM(p,b){return p.stylesheets&&p.count===0&&sg(p,p.stylesheets),0<p.count||0<p.imgCount?function(x){var A=setTimeout(function(){if(p.stylesheets&&sg(p,p.stylesheets),p.unsuspend){var Y=p.unsuspend;p.unsuspend=null,Y()}},6e4+b);0<p.imgBytes&&T1===0&&(T1=62500*UF());var U=setTimeout(function(){if(p.waitingForImages=!1,p.count===0&&(p.stylesheets&&sg(p,p.stylesheets),p.unsuspend)){var Y=p.unsuspend;p.unsuspend=null,Y()}},(p.imgBytes>T1?50:800)+b);return p.unsuspend=x,function(){p.unsuspend=null,clearTimeout(A),clearTimeout(U)}}:null}function ng(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)sg(this,this.stylesheets);else if(this.unsuspend){var p=this.unsuspend;this.unsuspend=null,p()}}}var ig=null;function sg(p,b){p.stylesheets=null,p.unsuspend!==null&&(p.count++,ig=new Map,b.forEach(dM,p),ig=null,ng.call(p))}function dM(p,b){if(!(b.state.loading&4)){var x=ig.get(p);if(x)var A=x.get(null);else{x=new Map,ig.set(p,x);for(var U=p.querySelectorAll("link[data-precedence],style[data-precedence]"),Y=0;Y<U.length;Y++){var re=U[Y];(re.nodeName==="LINK"||re.getAttribute("media")!=="not all")&&(x.set(re.dataset.precedence,re),A=re)}A&&x.set(null,A)}U=b.instance,re=U.getAttribute("data-precedence"),Y=x.get(re)||A,Y===A&&x.set(null,U),x.set(re,U),this.count++,A=ng.bind(this),U.addEventListener("load",A),U.addEventListener("error",A),Y?Y.parentNode.insertBefore(U,Y.nextSibling):(p=p.nodeType===9?p.head:p,p.insertBefore(U,p.firstChild)),b.state.loading|=4}}var ph={$$typeof:C,Provider:null,Consumer:null,_currentValue:T,_currentValue2:T,_threadCount:0};function hM(p,b,x,A,U,Y,re,he,_e){this.tag=1,this.containerInfo=p,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=vr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vr(0),this.hiddenUpdates=vr(null),this.identifierPrefix=A,this.onUncaughtError=U,this.onCaughtError=Y,this.onRecoverableError=re,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=_e,this.incompleteTransitions=new Map}function g_(p,b,x,A,U,Y,re,he,_e,We,tt,it){return p=new hM(p,b,x,re,_e,We,tt,it,he),b=1,Y===!0&&(b|=24),Y=Ui(3,null,null,b),p.current=Y,Y.stateNode=p,b=sv(),b.refCount++,p.pooledCache=b,b.refCount++,Y.memoizedState={element:A,isDehydrated:x,cache:b},cv(Y),p}function m_(p){return p?(p=zc,p):zc}function v_(p,b,x,A,U,Y){U=m_(U),A.context===null?A.context=U:A.pendingContext=U,A=Ra(b),A.payload={element:x},Y=Y===void 0?null:Y,Y!==null&&(A.callback=Y),x=Aa(p,A,b),x!==null&&(Mi(x,p,b),$d(x,p,b))}function b_(p,b){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var x=p.retryLane;p.retryLane=x!==0&&x<b?x:b}}function k1(p,b){b_(p,b),(p=p.alternate)&&b_(p,b)}function w_(p){if(p.tag===13||p.tag===31){var b=Fl(p,67108864);b!==null&&Mi(b,p,67108864),k1(p,67108864)}}function y_(p){if(p.tag===13||p.tag===31){var b=Xi();b=He(b);var x=Fl(p,b);x!==null&&Mi(x,p,b),k1(p,b)}}var og=!0;function fM(p,b,x,A){var U=S.T;S.T=null;var Y=_.p;try{_.p=2,R1(p,b,x,A)}finally{_.p=Y,S.T=U}}function pM(p,b,x,A){var U=S.T;S.T=null;var Y=_.p;try{_.p=8,R1(p,b,x,A)}finally{_.p=Y,S.T=U}}function R1(p,b,x,A){if(og){var U=A1(A);if(U===null)p1(p,b,A,ag,x),x_(p,A);else if(mM(U,p,b,x,A))A.stopPropagation();else if(x_(p,A),b&4&&-1<gM.indexOf(p)){for(;U!==null;){var Y=ft(U);if(Y!==null)switch(Y.tag){case 3:if(Y=Y.stateNode,Y.current.memoizedState.isDehydrated){var re=_t(Y.pendingLanes);if(re!==0){var he=Y;for(he.pendingLanes|=2,he.entangledLanes|=2;re;){var _e=1<<31-pt(re);he.entanglements[1]|=_e,re&=~_e}so(Y),(kr&6)===0&&(zp=Ve()+500,lh(0))}}break;case 31:case 13:he=Fl(Y,2),he!==null&&Mi(he,Y,2),Wp(),k1(Y,2)}if(Y=A1(A),Y===null&&p1(p,b,A,ag,x),Y===U)break;U=Y}U!==null&&A.stopPropagation()}else p1(p,b,A,null,x)}}function A1(p){return p=Ca(p),F1(p)}var ag=null;function F1(p){if(ag=null,p=ct(p),p!==null){var b=s(p);if(b===null)p=null;else{var x=b.tag;if(x===13){if(p=o(b),p!==null)return p;p=null}else if(x===31){if(p=a(b),p!==null)return p;p=null}else if(x===3){if(b.stateNode.current.memoizedState.isDehydrated)return b.tag===3?b.stateNode.containerInfo:null;p=null}else b!==p&&(p=null)}}return ag=p,null}function C_(p){switch(p){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Ye()){case ut:return 2;case ht:return 8;case be:case ze:return 32;case we:return 268435456;default:return 32}default:return 32}}var M1=!1,ja=null,Va=null,Ga=null,gh=new Map,mh=new Map,za=[],gM="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function x_(p,b){switch(p){case"focusin":case"focusout":ja=null;break;case"dragenter":case"dragleave":Va=null;break;case"mouseover":case"mouseout":Ga=null;break;case"pointerover":case"pointerout":gh.delete(b.pointerId);break;case"gotpointercapture":case"lostpointercapture":mh.delete(b.pointerId)}}function vh(p,b,x,A,U,Y){return p===null||p.nativeEvent!==Y?(p={blockedOn:b,domEventName:x,eventSystemFlags:A,nativeEvent:Y,targetContainers:[U]},b!==null&&(b=ft(b),b!==null&&w_(b)),p):(p.eventSystemFlags|=A,b=p.targetContainers,U!==null&&b.indexOf(U)===-1&&b.push(U),p)}function mM(p,b,x,A,U){switch(b){case"focusin":return ja=vh(ja,p,b,x,A,U),!0;case"dragenter":return Va=vh(Va,p,b,x,A,U),!0;case"mouseover":return Ga=vh(Ga,p,b,x,A,U),!0;case"pointerover":var Y=U.pointerId;return gh.set(Y,vh(gh.get(Y)||null,p,b,x,A,U)),!0;case"gotpointercapture":return Y=U.pointerId,mh.set(Y,vh(mh.get(Y)||null,p,b,x,A,U)),!0}return!1}function S_(p){var b=ct(p.target);if(b!==null){var x=s(b);if(x!==null){if(b=x.tag,b===13){if(b=o(x),b!==null){p.blockedOn=b,pe(p.priority,function(){y_(x)});return}}else if(b===31){if(b=a(x),b!==null){p.blockedOn=b,pe(p.priority,function(){y_(x)});return}}else if(b===3&&x.stateNode.current.memoizedState.isDehydrated){p.blockedOn=x.tag===3?x.stateNode.containerInfo:null;return}}}p.blockedOn=null}function lg(p){if(p.blockedOn!==null)return!1;for(var b=p.targetContainers;0<b.length;){var x=A1(p.nativeEvent);if(x===null){x=p.nativeEvent;var A=new x.constructor(x.type,x);ya=A,x.target.dispatchEvent(A),ya=null}else return b=ft(x),b!==null&&w_(b),p.blockedOn=x,!1;b.shift()}return!0}function __(p,b,x){lg(p)&&x.delete(b)}function vM(){M1=!1,ja!==null&&lg(ja)&&(ja=null),Va!==null&&lg(Va)&&(Va=null),Ga!==null&&lg(Ga)&&(Ga=null),gh.forEach(__),mh.forEach(__)}function cg(p,b){p.blockedOn===b&&(p.blockedOn=null,M1||(M1=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,vM)))}var ug=null;function E_(p){ug!==p&&(ug=p,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){ug===p&&(ug=null);for(var b=0;b<p.length;b+=3){var x=p[b],A=p[b+1],U=p[b+2];if(typeof A!="function"){if(F1(A||x)===null)continue;break}var Y=ft(x);Y!==null&&(p.splice(b,3),b-=3,Av(Y,{pending:!0,data:U,method:x.method,action:A},A,U))}}))}function fu(p){function b(_e){return cg(_e,p)}ja!==null&&cg(ja,p),Va!==null&&cg(Va,p),Ga!==null&&cg(Ga,p),gh.forEach(b),mh.forEach(b);for(var x=0;x<za.length;x++){var A=za[x];A.blockedOn===p&&(A.blockedOn=null)}for(;0<za.length&&(x=za[0],x.blockedOn===null);)S_(x),x.blockedOn===null&&za.shift();if(x=(p.ownerDocument||p).$$reactFormReplay,x!=null)for(A=0;A<x.length;A+=3){var U=x[A],Y=x[A+1],re=U[fe]||null;if(typeof Y=="function")re||E_(x);else if(re){var he=null;if(Y&&Y.hasAttribute("formAction")){if(U=Y,re=Y[fe]||null)he=re.formAction;else if(F1(U)!==null)continue}else he=re.action;typeof he=="function"?x[A+1]=he:(x.splice(A,3),A-=3),E_(x)}}}function T_(){function p(Y){Y.canIntercept&&Y.info==="react-transition"&&Y.intercept({handler:function(){return new Promise(function(re){return U=re})},focusReset:"manual",scroll:"manual"})}function b(){U!==null&&(U(),U=null),A||setTimeout(x,20)}function x(){if(!A&&!navigation.transition){var Y=navigation.currentEntry;Y&&Y.url!=null&&navigation.navigate(Y.url,{state:Y.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var A=!1,U=null;return navigation.addEventListener("navigate",p),navigation.addEventListener("navigatesuccess",b),navigation.addEventListener("navigateerror",b),setTimeout(x,100),function(){A=!0,navigation.removeEventListener("navigate",p),navigation.removeEventListener("navigatesuccess",b),navigation.removeEventListener("navigateerror",b),U!==null&&(U(),U=null)}}}function D1(p){this._internalRoot=p}dg.prototype.render=D1.prototype.render=function(p){var b=this._internalRoot;if(b===null)throw Error(n(409));var x=b.current,A=Xi();v_(x,A,p,b,null,null)},dg.prototype.unmount=D1.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var b=p.containerInfo;v_(p.current,2,null,p,null,null),Wp(),b[ge]=null}};function dg(p){this._internalRoot=p}dg.prototype.unstable_scheduleHydration=function(p){if(p){var b=se();p={blockedOn:null,target:p,priority:b};for(var x=0;x<za.length&&b!==0&&b<za[x].priority;x++);za.splice(x,0,p),x===0&&S_(p)}};var k_=t.version;if(k_!=="19.2.4")throw Error(n(527,k_,"19.2.4"));_.findDOMNode=function(p){var b=p._reactInternals;if(b===void 0)throw typeof p.render=="function"?Error(n(188)):(p=Object.keys(p).join(","),Error(n(268,p)));return p=c(b),p=p!==null?u(p):null,p=p===null?null:p.stateNode,p};var bM={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:S,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hg.isDisabled&&hg.supportsFiber)try{Pe=hg.inject(bM),De=hg}catch{}}return wh.createRoot=function(p,b){if(!i(p))throw Error(n(299));var x=!1,A="",U=I2,Y=O2,re=N2;return b!=null&&(b.unstable_strictMode===!0&&(x=!0),b.identifierPrefix!==void 0&&(A=b.identifierPrefix),b.onUncaughtError!==void 0&&(U=b.onUncaughtError),b.onCaughtError!==void 0&&(Y=b.onCaughtError),b.onRecoverableError!==void 0&&(re=b.onRecoverableError)),b=g_(p,1,!1,null,null,x,A,null,U,Y,re,T_),p[ge]=b.current,f1(p),new D1(b)},wh.hydrateRoot=function(p,b,x){if(!i(p))throw Error(n(299));var A=!1,U="",Y=I2,re=O2,he=N2,_e=null;return x!=null&&(x.unstable_strictMode===!0&&(A=!0),x.identifierPrefix!==void 0&&(U=x.identifierPrefix),x.onUncaughtError!==void 0&&(Y=x.onUncaughtError),x.onCaughtError!==void 0&&(re=x.onCaughtError),x.onRecoverableError!==void 0&&(he=x.onRecoverableError),x.formState!==void 0&&(_e=x.formState)),b=g_(p,1,!0,b,x??null,A,U,_e,Y,re,he,T_),b.context=m_(null),x=b.current,A=Xi(),A=He(A),U=Ra(A),U.callback=null,Aa(x,U,A),x=A,b.current.lanes=x,At(b,x),so(b),p[ge]=b.current,f1(p),new dg(b)},wh.version="19.2.4",wh}var L_;function kM(){if(L_)return O1.exports;L_=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),O1.exports=TM(),O1.exports}var RM=kM(),pc=class{constructor(){this.allSyncListeners=new Map,this.allAsyncListeners=new Map,this.globalSyncListeners=new Set,this.globalAsyncListeners=new Set,this.asyncFunctionsQueue=[],this.scheduled=!1,this.firedEvents={}}setFrameworkOverrides(e){this.frameworkOverrides=e}getListeners(e,t,r){const n=t?this.allAsyncListeners:this.allSyncListeners;let i=n.get(e);return!i&&r&&(i=new Set,n.set(e,i)),i}noRegisteredListenersExist(){return this.allSyncListeners.size===0&&this.allAsyncListeners.size===0&&this.globalSyncListeners.size===0&&this.globalAsyncListeners.size===0}addEventListener(e,t,r=!1){this.getListeners(e,r,!0).add(t)}removeEventListener(e,t,r=!1){const n=this.getListeners(e,r,!1);n&&(n.delete(t),n.size===0&&(r?this.allAsyncListeners:this.allSyncListeners).delete(e))}addGlobalListener(e,t=!1){this.getGlobalListeners(t).add(e)}removeGlobalListener(e,t=!1){this.getGlobalListeners(t).delete(e)}dispatchEvent(e){this.dispatchToListeners(e,!0),this.dispatchToListeners(e,!1),this.firedEvents[e.type]=!0}dispatchEventOnce(e){this.firedEvents[e.type]||this.dispatchEvent(e)}dispatchToListeners(e,t){const r=e.type;if(t&&"event"in e){const a=e.event;a instanceof Event&&(e.eventPath=a.composedPath())}const{frameworkOverrides:n}=this,i=a=>{const l=n?()=>n.wrapIncoming(a):a;t?this.dispatchAsync(l):l()},s=this.getListeners(r,t,!1);if((s?.size??0)>0){const a=new Set(s);for(const l of a)s?.has(l)&&i(()=>l(e))}const o=this.getGlobalListeners(t);if(o.size>0){const a=new Set(o);for(const l of a)i(()=>l(r,e))}}getGlobalListeners(e){return e?this.globalAsyncListeners:this.globalSyncListeners}dispatchAsync(e){if(this.asyncFunctionsQueue.push(e),!this.scheduled){const t=()=>{window.setTimeout(this.flushAsyncQueue.bind(this),0)};this.frameworkOverrides?this.frameworkOverrides.wrapIncoming(t):t(),this.scheduled=!0}}flushAsyncQueue(){this.scheduled=!1;const e=this.asyncFunctionsQueue.slice();this.asyncFunctionsQueue=[];for(const t of e)t()}},ea=e=>e==null||e===""?null:e;function bt(e){return e!=null&&e!==""}function Yr(e){return!bt(e)}var Xb=e=>e!=null&&typeof e.toString=="function"?e.toString():null,of=(e,t)=>{const r=e?JSON.stringify(e):null,n=t?JSON.stringify(t):null;return r===n},AM=(e,t,r=!1)=>e==null?t==null?0:-1:t==null?1:(typeof e=="object"&&e.toNumber&&(e=e.toNumber()),typeof t=="object"&&t.toNumber&&(t=t.toNumber()),!r||typeof e!="string"?e>t?1:e<t?-1:0:e.localeCompare(t)),FM=/[&<>"']/g,MM={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function yd(e){return e?.toString().toString()??null}function Hh(e){return yd(e)?.replace(FM,t=>MM[t])??null}function B_(e){return typeof e=="string"&&e.startsWith("=")&&e.length>1}function ho(e){return e.eRootDiv.getRootNode()}function tn(e){return ho(e).activeElement}function Gn(e){const{gos:t,eRootDiv:r}=e;let n=null;const i=t.get("getDocument");return i&&bt(i)?n=i():r&&(n=r.ownerDocument),n&&bt(n)?n:document}function ty(e){const t=tn(e);return t===null||t===Gn(e).body}function bT(e){return Gn(e).defaultView||window}function ry(e){let t=null,r=null;try{t=Gn(e).fullscreenElement}catch{}finally{t||(t=ho(e));const n=t.querySelector("body");n?r=n:t instanceof ShadowRoot?r=t:t instanceof Document?r=t?.documentElement:r=t}return r}function DM(e){return ry(e)?.clientWidth??(window.innerWidth||-1)}function PM(e){return ry(e)?.clientHeight??(window.innerHeight||-1)}function Ys(e,t,r){r==null||typeof r=="string"&&r==""?wT(e,t):Zs(e,t,r)}function Zs(e,t,r){e.setAttribute(yT(t),r.toString())}function wT(e,t){e.removeAttribute(yT(t))}function yT(e){return`aria-${e}`}function gc(e,t){t?e.setAttribute("role",t):e.removeAttribute("role")}function IM(e){const t=e?.direction;return t==="asc"?"ascending":t==="desc"?"descending":t==="mixed"?"other":"none"}function OM(e){return e.getAttribute("aria-label")}function ad(e,t){Ys(e,"label",t)}function af(e,t){Ys(e,"labelledby",t)}function CT(e,t){Ys(e,"live",t)}function NM(e,t){Ys(e,"atomic",t)}function LM(e,t){Ys(e,"relevant",t)}function ny(e,t){Ys(e,"invalid",t)}function BM(e,t){Ys(e,"disabled",t)}function xT(e,t){Ys(e,"hidden",t)}function Yb(e,t){Zs(e,"expanded",t)}function HM(e,t){Zs(e,"setsize",t)}function jM(e,t){Zs(e,"posinset",t)}function VM(e,t){Zs(e,"rowcount",t)}function ST(e,t){Zs(e,"rowindex",t)}function GM(e,t){Zs(e,"rowspan",t)}function zM(e,t){Zs(e,"colcount",t)}function _T(e,t){Zs(e,"colindex",t)}function UM(e,t){Zs(e,"colspan",t)}function WM(e,t){Zs(e,"sort",t)}function $M(e){wT(e,"sort")}function ET(e,t){Ys(e,"selected",t)}function qM(e,t){Ys(e,"controls",t)}function KM(e,t){qM(e,t.id),af(t,e.id)}function H_(e,t){Ys(e,"owns",t)}function tm(e,t){return t===void 0?e("ariaIndeterminate","indeterminate"):t===!0?e("ariaChecked","checked"):e("ariaUnchecked","unchecked")}var XM="[tabindex], input, select, button, textarea, [href]",TT="[disabled], .ag-disabled:not(.ag-button), .ag-disabled *";function jh(e){return!e||!e.matches("input, select, button, textarea")||!e.matches(TT)?!1:da(e)}function Gr(e,t,r={}){const{skipAriaHidden:n}=r;e.classList.toggle("ag-hidden",!t),n||xT(e,!t)}function YM(e,t,r={}){const{skipAriaHidden:n}=r;e.classList.toggle("ag-invisible",!t),n||xT(e,!t)}function lf(e,t){const r="disabled",n=t?s=>s.setAttribute(r,""):s=>s.removeAttribute(r);n(e);const i=e.querySelectorAll("input")??[];for(const s of i)n(s)}function nc(e,t,r){let n=0;for(;e;){if(e.classList.contains(t))return!0;if(e=e.parentElement,typeof r=="number"){if(++n>r)break}else if(e===r)break}return!1}function Ac(e){const{height:t,width:r,borderTopWidth:n,borderRightWidth:i,borderBottomWidth:s,borderLeftWidth:o,paddingTop:a,paddingRight:l,paddingBottom:c,paddingLeft:u,marginTop:h,marginRight:d,marginBottom:f,marginLeft:m,boxSizing:v}=window.getComputedStyle(e),g=Number.parseFloat;return{height:g(t||"0"),width:g(r||"0"),borderTopWidth:g(n||"0"),borderRightWidth:g(i||"0"),borderBottomWidth:g(s||"0"),borderLeftWidth:g(o||"0"),paddingTop:g(a||"0"),paddingRight:g(l||"0"),paddingBottom:g(c||"0"),paddingLeft:g(u||"0"),marginTop:g(h||"0"),marginRight:g(d||"0"),marginBottom:g(f||"0"),marginLeft:g(m||"0"),boxSizing:v}}function iy(e){const t=Ac(e);return t.boxSizing==="border-box"?t.height-t.paddingTop-t.paddingBottom-t.borderTopWidth-t.borderBottomWidth:t.height}function cf(e){const t=Ac(e);return t.boxSizing==="border-box"?t.width-t.paddingLeft-t.paddingRight-t.borderLeftWidth-t.borderRightWidth:t.width}function kT(e){const{height:t,marginBottom:r,marginTop:n}=Ac(e);return Math.floor(t+r+n)}function u0(e){const{width:t,marginLeft:r,marginRight:n}=Ac(e);return Math.floor(t+r+n)}function RT(e){const t=e.getBoundingClientRect(),{borderTopWidth:r,borderLeftWidth:n,borderRightWidth:i,borderBottomWidth:s}=Ac(e);return{top:t.top+(r||0),left:t.left+(n||0),right:t.right+(i||0),bottom:t.bottom+(s||0)}}function d0(e,t){let r=e.scrollLeft;return t&&(r=Math.abs(r)),r}function h0(e,t,r){r&&(t*=-1),e.scrollLeft=t}function Hi(e){for(;e?.firstChild;)e.firstChild.remove()}function ol(e){e?.parentNode&&e.remove()}function sy(e){return!!e.offsetParent}function da(e){return e.checkVisibility?e.checkVisibility({checkVisibilityCSS:!0}):!(!sy(e)||window.getComputedStyle(e).visibility!=="visible")}function oy(e){const t=document.createElement("div");return t.innerHTML=(e||"").trim(),t.firstChild}function Wg(e){return()=>{const t=e();return t?ay(t)||AT(t):!0}}function ay(e){return e.clientWidth<e.scrollWidth}function AT(e){return e.clientHeight<e.scrollHeight}function f0(e,t){t==="flex"?(e.style.removeProperty("width"),e.style.removeProperty("minWidth"),e.style.removeProperty("maxWidth"),e.style.flex="1 1 auto"):So(e,t)}function So(e,t){t=ly(t),e.style.width=t,e.style.maxWidth=t,e.style.minWidth=t}function Vh(e,t){t=ly(t),e.style.height=t,e.style.maxHeight=t,e.style.minHeight=t}function ly(e){return typeof e=="number"?`${e}px`:e}function cy(e){return e instanceof Node||e instanceof HTMLElement}function Oi(e,t,r){r==null||r===""?e.removeAttribute(t):e.setAttribute(t,r.toString())}function ha(e,t,r){const i=bT(e).ResizeObserver,s=i?new i(r):null;return s?.observe(t),()=>s?.disconnect()}function fa(e,t){const r=bT(e);r.requestAnimationFrame?r.requestAnimationFrame(t):r.webkitRequestAnimationFrame?r.webkitRequestAnimationFrame(t):r.setTimeout(t,0)}var FT="data-ref",H1;function j_(){return H1??(H1=document.createTextNode(" ")),H1.cloneNode()}function nl(e){const{attrs:t,children:r,cls:n,ref:i,role:s,tag:o}=e,a=document.createElement(o);if(n&&(a.className=n),i&&a.setAttribute(FT,i),s&&a.setAttribute("role",s),t)for(const l of Object.keys(t))a.setAttribute(l,t[l]);if(r)if(typeof r=="string")a.textContent=r;else{let l=!0;for(const c of r)c&&(typeof c=="string"?(a.appendChild(document.createTextNode(c)),l=!1):typeof c=="function"?a.appendChild(c()):(l&&(a.appendChild(j_()),l=!1),a.append(nl(c)),a.appendChild(j_())))}return a}var ZM=["touchstart","touchend","touchmove","touchcancel","scroll"],JM=["wheel"],j1={},MT=(()=>{const e={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return r=>{if(typeof j1[r]=="boolean")return j1[r];const n=document.createElement(e[r]||"div");return r="on"+r,j1[r]=r in n}})();function QM(e,t){return!t||!e?!1:tD(t).indexOf(e)>=0}function eD(e){const t=[];let r=e.target;for(;r;)t.push(r),r=r.parentElement;return t}function tD(e){const t=e;return t.path?t.path:t.composedPath?t.composedPath():eD(t)}function rD(e,t,r){const n=nD(t);let i;n!=null&&(i={passive:n}),e.addEventListener(t,r,i)}var nD=e=>{const t=ZM.includes(e),r=JM.includes(e);if(t)return!0;if(r)return!1};function DT(e,t,r){if(r===0)return!1;const n=Math.abs(e.clientX-t.clientX),i=Math.abs(e.clientY-t.clientY);return Math.max(n,i)<=r}var Vu=(e,t)=>{const r=e.identifier;for(let n=0,i=t.length;n<i;++n){const s=t[n];if(s.identifier===r)return s}return null};function uf(e,t){return e.gos.isElementInThisInstance(t.target)}function iD(e,t,r){const i=e.getBoundingClientRect().height,s=DM(r)-2,o=PM(r)-2;if(!e.offsetParent)return;const l=RT(e.offsetParent),{clientY:c,clientX:u}=t;let h=c-l.top-i/2,d=u-l.left-10;const f=Gn(r),m=f.defaultView||window,v=m.pageYOffset||f.documentElement.scrollTop,g=m.pageXOffset||f.documentElement.scrollLeft;s>0&&d+e.clientWidth>s+g&&(d=s+g-e.clientWidth),d<0&&(d=0),o>0&&h+e.clientHeight>o+v&&(h=o+v-e.clientHeight),h<0&&(h=0),e.style.left=`${d}px`,e.style.top=`${h}px`}var $g=(e,...t)=>{for(const r of t){const[n,i,s,o]=r;n.addEventListener(i,s,o),e.push(r)}},uy=e=>{if(e){for(const[t,r,n,i]of e)t.removeEventListener(r,n,i);e.length=0}},Pu=e=>{e.cancelable&&e.preventDefault()};function sD(e,t){return t}function PT(e){return e?.getLocaleTextFunc()??sD}function oD(e,t,r,n){const i=t[r];return e.getLocaleTextFunc()(r,typeof i=="function"?i(n):i,n)}function aD(e){return(t,r,n)=>e({key:t,defaultValue:r,variableValues:n})}function lD(e){return(t,r,n)=>{let i=e?.[t];if(i&&n?.length){let s=0;for(;!(s>=n.length||i.indexOf("${variable}")===-1);)i=i.replace("${variable}",n[s++])}return i??r}}var _i=class{constructor(){this.destroyFunctions=[],this.destroyed=!1,this.__v_skip=!0,this.propertyListenerId=0,this.lastChangeSetIdLookup={},this.isAlive=()=>!this.destroyed}preWireBeans(e){this.beans=e,this.stubContext=e.context,this.eventSvc=e.eventSvc,this.gos=e.gos}destroy(){const{destroyFunctions:e}=this;for(let t=0;t<e.length;t++)e[t]();e.length=0,this.destroyed=!0,this.dispatchLocalEvent({type:"destroyed"})}addEventListener(e,t,r){this.localEventService||(this.localEventService=new pc),this.localEventService.addEventListener(e,t,r)}removeEventListener(e,t,r){this.localEventService?.removeEventListener(e,t,r)}dispatchLocalEvent(e){this.localEventService?.dispatchEvent(e)}addManagedElementListeners(e,t){return this._setupListeners(e,t)}addManagedEventListeners(e){return this._setupListeners(this.eventSvc,e)}addManagedListeners(e,t){return this._setupListeners(e,t)}_setupListeners(e,t){const r=[];for(const n of Object.keys(t)){const i=t[n];i&&r.push(this._setupListener(e,n,i))}return r}_setupListener(e,t,r){if(this.destroyed)return()=>null;let n;if(cD(e))e.__addEventListener(t,r),n=()=>(e.__removeEventListener(t,r),null);else{const i=uD(e);e instanceof HTMLElement?rD(e,t,r):i?e.addListener(t,r):e.addEventListener(t,r),n=i?()=>(e.removeListener(t,r),null):()=>(e.removeEventListener(t,r),null)}return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(i=>i!==n),null)}setupPropertyListener(e,t){const{gos:r}=this;r.addPropertyEventListener(e,t);const n=()=>(r.removePropertyEventListener(e,t),null);return this.destroyFunctions.push(n),()=>(n(),this.destroyFunctions=this.destroyFunctions.filter(i=>i!==n),null)}addManagedPropertyListener(e,t){return this.destroyed?()=>null:this.setupPropertyListener(e,t)}addManagedPropertyListeners(e,t){if(this.destroyed)return;const r=e.join("-")+this.propertyListenerId++,n=i=>{if(i.changeSet){if(i.changeSet&&i.changeSet.id===this.lastChangeSetIdLookup[r])return;this.lastChangeSetIdLookup[r]=i.changeSet.id}const s={type:"propertyChanged",changeSet:i.changeSet,source:i.source};t(s)};for(const i of e)this.setupPropertyListener(i,n)}getLocaleTextFunc(){return PT(this.beans.localeSvc)}addDestroyFunc(e){this.isAlive()?this.destroyFunctions.push(e):e()}createOptionalManagedBean(e,t){return e?this.createManagedBean(e,t):void 0}createManagedBean(e,t){const r=this.createBean(e,t);return this.addDestroyFunc(this.destroyBean.bind(this,e,t)),r}createBean(e,t,r){return(t||this.stubContext).createBean(e,r)}destroyBean(e,t){return(t||this.stubContext).destroyBean(e)}destroyBeans(e,t){return(t||this.stubContext).destroyBeans(e)}};function cD(e){return e.__addEventListener!==void 0}function uD(e){return e.eventServiceType==="global"}var et=class extends _i{},Zb=new Set,rm=(e,t)=>{Zb.has(t)||(Zb.add(t),e())};rm._set=Zb;var dD={pending:!1,funcs:[]},hD={pending:!1,funcs:[]};function Jb(e,t="setTimeout",r){const n=t==="raf"?hD:dD;if(n.funcs.push(e),n.pending)return;n.pending=!0;const i=()=>{const s=n.funcs.slice();n.funcs.length=0,n.pending=!1;for(const o of s)o()};t==="raf"?fa(r,i):window.setTimeout(i,0)}function zn(e,t,r){let n;return function(...i){const s=this;return window.clearTimeout(n),n=window.setTimeout(function(){e.isAlive()&&t.apply(s,i)},r),n}}function V_(e,t){let r=0;return function(...n){const i=this,s=Date.now();s-r<t||(r=s,e.apply(i,n))}}function fD(e,t,r,n=100){const i=Date.now();let s=null,o=!1;const a=()=>{s!=null&&(window.clearInterval(s),s=null)};e.addDestroyFunc(a);const l=()=>{const c=Date.now()-i>n;(t()||c)&&(r(),o=!0,a())};l(),o||(s=window.setInterval(l,10))}var IT=new Set(["__proto__","constructor","prototype"]);function pD(e,t){if(e!=null){if(Array.isArray(e)){for(let r=0;r<e.length;r++)t(r.toString(),e[r]);return}for(const r of Object.keys(e).filter(n=>!IT.has(n)))t(r,e[r])}}function xi(e,t,r=!0,n=!1){bt(t)&&pD(t,(i,s)=>{let o=e[i];o!==s&&(n&&o==null&&s!=null&&typeof s=="object"&&s.constructor===Object&&(o={},e[i]=o),G_(s)&&G_(o)&&!Array.isArray(o)?xi(o,s,r,n):(r||s!==void 0)&&(e[i]=s))})}function G_(e){return typeof e=="object"&&e!==null}var dy=class Ko{static applyGlobalGridOptions(t){if(!Ko.gridOptions)return{...t};let r={};return xi(r,Ko.gridOptions,!0,!0),Ko.mergeStrategy==="deep"?xi(r,t,!0,!0):r={...r,...t},Ko.gridOptions.context&&(r.context=Ko.gridOptions.context),t.context&&(Ko.mergeStrategy==="deep"&&r.context&&xi(t.context,r.context,!0,!0),r.context=t.context),r}static applyGlobalGridOption(t,r){if(Ko.mergeStrategy==="deep"){const n=OT(t);if(n&&typeof n=="object"&&typeof r=="object")return Ko.applyGlobalGridOptions({[t]:r})[t]}return r}};dy.gridOptions=void 0;dy.mergeStrategy="shallow";var hy=dy;function OT(e){return hy.gridOptions?.[e]}var NT={suppressContextMenu:!1,preventDefaultOnContextMenu:!1,allowContextMenuWithControlKey:!1,suppressMenuHide:!0,enableBrowserTooltips:!1,tooltipTrigger:"hover",tooltipShowDelay:2e3,tooltipHideDelay:1e4,tooltipMouseTrack:!1,tooltipShowMode:"standard",tooltipInteraction:!1,copyHeadersToClipboard:!1,copyGroupHeadersToClipboard:!1,clipboardDelimiter:"	",suppressCopyRowsToClipboard:!1,suppressCopySingleCellRanges:!1,suppressLastEmptyLineOnPaste:!1,suppressClipboardPaste:!1,suppressClipboardApi:!1,suppressCutToClipboard:!1,maintainColumnOrder:!1,enableStrictPivotColumnOrder:!1,suppressFieldDotNotation:!1,allowDragFromColumnsToolPanel:!1,suppressMovableColumns:!1,suppressColumnMoveAnimation:!1,suppressMoveWhenColumnDragging:!1,suppressDragLeaveHidesColumns:!1,suppressRowGroupHidesColumns:!1,suppressAutoSize:!1,autoSizePadding:20,skipHeaderOnAutoSize:!1,singleClickEdit:!1,suppressClickEdit:!1,readOnlyEdit:!1,stopEditingWhenCellsLoseFocus:!1,enterNavigatesVertically:!1,enterNavigatesVerticallyAfterEdit:!1,enableCellEditingOnBackspace:!1,undoRedoCellEditing:!1,undoRedoCellEditingLimit:10,suppressCsvExport:!1,suppressExcelExport:!1,cacheQuickFilter:!1,includeHiddenColumnsInQuickFilter:!1,excludeChildrenWhenTreeDataFiltering:!1,enableAdvancedFilter:!1,includeHiddenColumnsInAdvancedFilter:!1,enableCharts:!1,masterDetail:!1,keepDetailRows:!1,keepDetailRowsCount:10,detailRowAutoHeight:!1,tabIndex:0,rowBuffer:10,valueCache:!1,valueCacheNeverExpires:!1,enableCellExpressions:!1,suppressTouch:!1,suppressFocusAfterRefresh:!1,suppressBrowserResizeObserver:!1,suppressPropertyNamesCheck:!1,suppressChangeDetection:!1,debug:!1,suppressLoadingOverlay:!1,suppressNoRowsOverlay:!1,pagination:!1,paginationPageSize:100,paginationPageSizeSelector:!0,paginationAutoPageSize:!1,paginateChildRows:!1,suppressPaginationPanel:!1,pivotMode:!1,pivotPanelShow:"never",pivotDefaultExpanded:0,pivotSuppressAutoColumn:!1,suppressExpandablePivotGroups:!1,functionsReadOnly:!1,suppressAggFuncInHeader:!1,alwaysAggregateAtRootLevel:!1,aggregateOnlyChangedColumns:!1,suppressAggFilteredOnly:!1,removePivotHeaderRowWhenSingleValueColumn:!1,animateRows:!0,cellFlashDuration:500,cellFadeDuration:1e3,allowShowChangeAfterFilter:!1,domLayout:"normal",ensureDomOrder:!1,enableRtl:!1,suppressColumnVirtualisation:!1,suppressMaxRenderedRowRestriction:!1,suppressRowVirtualisation:!1,rowDragManaged:!1,refreshAfterGroupEdit:!1,rowDragInsertDelay:500,suppressRowDrag:!1,suppressMoveWhenRowDragging:!1,rowDragEntireRow:!1,rowDragMultiRow:!1,embedFullWidthRows:!1,groupDisplayType:"singleColumn",groupDefaultExpanded:0,groupMaintainOrder:!1,groupSelectsChildren:!1,groupSuppressBlankHeader:!1,groupSelectsFiltered:!1,showOpenedGroup:!1,groupRemoveSingleChildren:!1,groupRemoveLowestSingleChildren:!1,groupHideOpenParents:!1,groupAllowUnbalanced:!1,rowGroupPanelShow:"never",suppressMakeColumnVisibleAfterUnGroup:!1,treeData:!1,rowGroupPanelSuppressSort:!1,suppressGroupRowsSticky:!1,rowModelType:"clientSide",asyncTransactionWaitMillis:50,suppressModelUpdateAfterUpdateTransaction:!1,cacheOverflowSize:1,infiniteInitialRowCount:1,serverSideInitialRowCount:1,cacheBlockSize:100,maxBlocksInCache:-1,maxConcurrentDatasourceRequests:2,blockLoadDebounceMillis:0,purgeClosedRowNodes:!1,serverSideSortAllLevels:!1,serverSideOnlyRefreshFilteredGroups:!1,serverSidePivotResultFieldSeparator:"_",viewportRowModelPageSize:5,viewportRowModelBufferSize:5,alwaysShowHorizontalScroll:!1,alwaysShowVerticalScroll:!1,debounceVerticalScrollbar:!1,suppressHorizontalScroll:!1,suppressScrollOnNewData:!1,suppressScrollWhenPopupsAreOpen:!1,suppressAnimationFrame:!1,suppressMiddleClickScrolls:!1,suppressPreventDefaultOnMouseWheel:!1,rowMultiSelectWithClick:!1,suppressRowDeselection:!1,suppressRowClickSelection:!1,suppressCellFocus:!1,suppressHeaderFocus:!1,suppressMultiRangeSelection:!1,enableCellTextSelection:!1,enableRangeSelection:!1,enableRangeHandle:!1,enableFillHandle:!1,fillHandleDirection:"xy",suppressClearOnFillReduction:!1,accentedSort:!1,unSortIcon:!1,suppressMultiSort:!1,alwaysMultiSort:!1,suppressMaintainUnsortedOrder:!1,suppressRowHoverHighlight:!1,suppressRowTransform:!1,columnHoverHighlight:!1,deltaSort:!1,enableGroupEdit:!1,groupLockGroupColumns:0,serverSideEnableClientSideSort:!1,suppressServerSideFullWidthLoadingRow:!1,pivotMaxGeneratedColumns:-1,columnMenu:"new",reactiveCustomComponents:!0,suppressSetFilterByDefault:!1,enableFilterHandlers:!1},LT="https://www.ag-grid.com";function mc(e,t,...r){e.get("debug")&&console.log("AG Grid: "+t,...r)}function Gh(e,...t){rm(()=>console.warn("AG Grid: "+e,...t),e+t?.join(""))}function Gu(e,...t){rm(()=>console.error("AG Grid: "+e,...t),e+t?.join(""))}var BT=new Set,p0={},ic={},qg,HT=!1,jT=!1,gD=!1;function mD(e){const[t,r]=e.version.split(".")||[],[n,i]=qg.split(".")||[];return t===n&&r===i}function vD(e){qg||(qg=e.version);const t=n=>`You are using incompatible versions of AG Grid modules. Major and minor versions should always match across modules. ${n} Please update all modules to the same version.`;e.version?mD(e)||Gu(t(`'${e.moduleName}' is version ${e.version} but the other modules are version ${qg}.`)):Gu(t(`'${e.moduleName}' is incompatible.`));const r=e.validate?.();r&&!r.isValid&&Gu(`${r.message}`)}function df(e,t,r=!1){r||(HT=!0),vD(e);const n=e.rowModels??["all"];BT.add(e);let i;t!==void 0?(jT=!0,ic[t]===void 0&&(ic[t]={}),i=ic[t]):i=p0;for(const s of n)i[s]===void 0&&(i[s]={}),i[s][e.moduleName]=e;if(e.dependsOn)for(const s of e.dependsOn)df(s,t,r)}function bD(e){delete ic[e]}function Qb(e,t,r){const n=i=>!!p0[i]?.[e]||!!ic[t]?.[i]?.[e];return n(r)||n("all")}function fy(){return jT}function wD(e,t){const r=ic[e]??{};return[...Object.values(p0.all??{}),...Object.values(r.all??{}),...Object.values(p0[t]??{}),...Object.values(r[t]??{})]}function yD(){return new Set(BT)}function CD(e,t){const r=ic[e]??{};return[...Object.values(r.all??{}),...Object.values(r[t]??{})]}function xD(){return HT}function VT(){return gD}var SD=class{static register(e){df(e,void 0)}static registerModules(e){for(const t of e)df(t,void 0)}},wt="35.0.1",z_=2e3,U_=100,GT="_version_",zT=null,zu=`${LT}/javascript-data-grid`;function _D(e){zT=e}function ED(e){zu=e}function UT(e,t,r){return zT?.(e,t)??[AD(e,t,r)]}function py(e,t,r,n,i){e(`${n?"warning":"error"} #${t}`,...UT(t,r,i))}function TD(e){if(!e)return String(e);const t={};for(const r of Object.keys(e))typeof e[r]!="object"&&typeof e[r]!="function"&&(t[r]=e[r]);return JSON.stringify(t)}function kD(e){let t=e;return e instanceof Error?t=e.toString():typeof e=="object"&&(t=TD(e)),t}function Kg(e){return e===void 0?"undefined":e===null?"null":e}function ew(e,t){return`${e}?${t.toString()}`}function RD(e,t,r){const n=Array.from(t.entries()).sort((s,o)=>o[1].length-s[1].length);let i=ew(e,t);for(const[s,o]of n){if(s===GT)continue;const a=i.length-r;if(a<=0)break;const l="...",c=a+l.length,u=o.length-c>U_?o.slice(0,o.length-c)+l:o.slice(0,U_)+l;t.set(s,u),i=ew(e,t)}return i}function WT(e,t){const r=new URLSearchParams;if(r.append(GT,wt),t)for(const s of Object.keys(t))r.append(s,kD(t[s]));const n=`${zu}/errors/${e}`,i=ew(n,r);return i.length<=z_?i:RD(n,r,z_)}var AD=(e,t,r)=>{const n=WT(e,t);return`${`${r?r+` 
`:""}Visit ${n}`}${r?"":` 
  Alternatively register the ValidationModule to see the full message in the console.`}`};function at(...e){py(Gh,e[0],e[1],!0)}function Ar(...e){py(Gu,e[0],e[1],!1)}function Fh(e,t,r){py(Gu,e,t,!1,r)}function FD(e,t){const r=t[0];return`error #${r} `+UT(r,t[1],e).join(" ")}function _o(...e){return FD(void 0,e)}function $T(e,t){return e.get("rowModelType")===t}function rn(e,t){return $T(e,"clientSide")}function Cd(e,t){return $T(e,"serverSide")}function ni(e,t){return e.get("domLayout")===t}function sc(e){return m0(e)!==void 0}function qT(e){return typeof e.get("getRowHeight")=="function"}function MD(e,t){return t?!e.get("enableStrictPivotColumnOrder"):e.get("maintainColumnOrder")}function DD({gos:e,formula:t}){const r=e.get("rowNumbers");return r||!!t?.active&&r!==!1}function al(e,t,r=!1,n){const{gos:i,environment:s}=e;if(n==null&&(n=s.getDefaultRowHeight()),qT(i)){if(r)return{height:n,estimated:!0};const l={node:t,data:t.data},c=i.getCallback("getRowHeight")(l);if(tw(c))return c===0&&at(23),{height:Math.max(1,c),estimated:!1}}if(t.detail&&i.get("masterDetail"))return PD(i);const o=i.get("rowHeight");return{height:o&&tw(o)?o:n,estimated:!1}}function PD(e){if(e.get("detailRowAutoHeight"))return{height:1,estimated:!1};const t=e.get("detailRowHeight");return tw(t)?{height:t,estimated:!1}:{height:300,estimated:!1}}function oc(e){const{environment:t,gos:r}=e,n=r.get("rowHeight");if(!n||Yr(n))return t.getDefaultRowHeight();const i=t.refreshRowHeightVariable();return i!==-1?i:(at(24),t.getDefaultRowHeight())}function tw(e){return!isNaN(e)&&typeof e=="number"&&isFinite(e)}function KT(e,t,r){const n=t[e.getDomDataKey()];return n?n[r]:void 0}function vc(e,t,r,n){const i=e.getDomDataKey();let s=t[i];Yr(s)&&(s={},t[i]=s),s[r]=n}function Uu(e){return e.get("ensureDomOrder")?!1:e.get("animateRows")}function XT(e){return!(e.get("paginateChildRows")||e.get("groupHideOpenParents")||ni(e,"print"))}function Zo(e){return!e.get("autoGroupColumnDef")?.comparator&&!e.get("treeData")}function rw(e){const t=e.get("groupAggFiltering");if(typeof t=="function")return e.getCallback("groupAggFiltering");if(t===!0)return()=>!0}function YT(e){return e.get("grandTotalRow")}function ZT(e,t){return t?!1:e.get("groupDisplayType")==="groupRows"}function JT(e,t,r){return!!t.group&&!t.footer&&ZT(e,r)}function ld(e){const t=e.getCallback("getRowId");return t===void 0?t:r=>{let n=t(r);return typeof n!="string"&&(rm(()=>at(25,{id:n}),"getRowIdString"),n=String(n)),n}}function ID(e,t){const r=e.get("groupHideParentOfSingleChild");return!!(r===!0||r==="leafGroupsOnly"&&t.leafGroup||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")&&t.leafGroup)}function OD(e){const t=e.get("maxConcurrentDatasourceRequests");return t>0?t:void 0}function Wu(e){return e?.checkboxes??!0}function Xg(e){return e?.mode==="multiRow"&&(e.headerCheckbox??!0)}function g0(e){if(typeof e=="object")return e.checkboxLocation??"selectionColumn"}function V1(e){return e?.hideDisabledCheckboxes??!1}function ND(e){return typeof e.get("rowSelection")!="string"}function ll(e){const t=e.get("cellSelection");return t!==void 0?!!t:e.get("enableRangeSelection")}function $u(e){const t=e.get("cellSelection")??!1;return(typeof t=="object"&&t.enableColumnSelection)??!1}function QT(e){const t=e.get("rowSelection")??"single";if(typeof t=="string"){const r=e.get("suppressRowClickSelection"),n=e.get("suppressRowDeselection");return r&&n?!1:r?"enableDeselection":n?"enableSelection":!0}return t.mode==="singleRow"||t.mode==="multiRow"?t.enableClickSelection??!1:!1}function LD(e){const t=QT(e);return t===!0||t==="enableSelection"}function BD(e){const t=QT(e);return t===!0||t==="enableDeselection"}function nw(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("isRowSelectable"):t?.isRowSelectable}function m0(e){const t="beanName"in e&&e.beanName==="gos"?e.get("rowSelection"):e.rowSelection;if(typeof t=="string")switch(t){case"multiple":return"multiRow";case"single":return"singleRow";default:return}switch(t?.mode){case"multiRow":case"singleRow":return t.mode;default:return}}function v0(e){return m0(e)==="multiRow"}function HD(e){const t=e.get("rowSelection");return typeof t=="string"?e.get("rowMultiSelectWithClick"):t?.enableSelectionWithoutKeys??!1}function b0(e){const t=e.get("rowSelection");if(typeof t=="string"){const r=e.get("groupSelectsChildren"),n=e.get("groupSelectsFiltered");return r&&n?"filteredDescendants":r?"descendants":"self"}return t?.mode==="multiRow"?t.groupSelects:void 0}function ek(e,t=!0){const r=e.get("rowSelection");return typeof r!="object"?t?"all":void 0:r.mode==="multiRow"?r.selectAll:"all"}function jD(e){const t=e.get("rowSelection");return typeof t=="string"?!1:t?.mode==="multiRow"?t.ctrlASelectsRows??!1:!1}function hf(e){const t=b0(e);return t==="descendants"||t==="filteredDescendants"}function W_(e){const t=e.get("rowSelection");return typeof t=="object"&&t.masterSelects||"self"}function VD(e){return e.isModuleRegistered("SetFilter")&&!e.get("suppressSetFilterByDefault")}function rs(e){return e.get("columnMenu")==="legacy"}function GD(e){return!rs(e)}function zD(e){return!e||e.length<2?e:"on"+e[0].toUpperCase()+e.substring(1)}function UD(e,t,r){typeof e!="object"&&(e={});const n={...e};for(const i of r){const s=t[i];typeof s<"u"&&(n[i]=s)}return n}function WD(e,t){if(!e)return;const r={};let n=!1;for(const o of Object.keys(e))r[o]=e[o],n=!0;if(!n)return;const i={type:"gridOptionsChanged",options:r};t.dispatchEvent(i);const s={type:"componentStateChanged",...r};t.dispatchEvent(s)}function Dt(e,t){return e.addCommon(t)}function Yg(e,t){return e[t]??e.gridOptions?.[t]??OT(t)??NT[t]}function $D({gos:e},t){return t.button===2||t.ctrlKey&&e.get("allowContextMenuWithControlKey")}var qD={resizable:!0,sortable:!0},KD=0;function tk(){return KD++}function cl(e){return e instanceof Fc}var XD=["asc","desc",null],YD=[{type:"absolute",direction:"asc"},{type:"absolute",direction:"desc"},null],Fc=class extends et{constructor(e,t,r,n){super(),this.colDef=e,this.userProvidedColDef=t,this.colId=r,this.primary=n,this.isColumn=!0,this.instanceId=tk(),this.autoHeaderHeight=null,this.sortDef=Gs(),this._wasSortExplicitlyRemoved=!1,this.moving=!1,this.resizing=!1,this.menuVisible=!1,this.formulaRef=null,this.lastLeftPinned=!1,this.firstRightPinned=!1,this.filterActive=!1,this.colEventSvc=new pc,this.tooltipEnabled=!1,this.rowGroupActive=!1,this.pivotActive=!1,this.aggregationActive=!1,this.flex=null,this.colIdSanitised=Hh(r)}destroy(){super.destroy(),this.beans.rowSpanSvc?.deregister(this)}getInstanceId(){return this.instanceId}initState(){const{colDef:e,beans:{sortSvc:t,pinnedCols:r,colFlex:n}}=this;t?.initCol(this);const i=e.hide;i!==void 0?this.visible=!i:this.visible=!e.initialHide,r?.initCol(this),n?.initCol(this)}setColDef(e,t,r){const n=e.spanRows!==this.colDef.spanRows;this.colDef=e,this.userProvidedColDef=t,this.initMinAndMaxWidths(),this.initDotNotation(),this.initTooltip(),n&&(this.beans.rowSpanSvc?.deregister(this),this.initRowSpan()),this.dispatchColEvent("colDefChanged",r)}getUserProvidedColDef(){return this.userProvidedColDef}getParent(){return this.parent}getOriginalParent(){return this.originalParent}postConstruct(){this.initState(),this.initMinAndMaxWidths(),this.resetActualWidth("gridInitializing"),this.initDotNotation(),this.initTooltip(),this.initRowSpan(),this.addPivotListener()}initDotNotation(){const{gos:e,colDef:{field:t,tooltipField:r}}=this,n=e.get("suppressFieldDotNotation");this.fieldContainsDots=bt(t)&&t.includes(".")&&!n,this.tooltipFieldContainsDots=bt(r)&&r.includes(".")&&!n}initMinAndMaxWidths(){const e=this.colDef;this.minWidth=e.minWidth??this.beans.environment.getDefaultColumnMinWidth(),this.maxWidth=e.maxWidth??Number.MAX_SAFE_INTEGER}initTooltip(){this.beans.tooltipSvc?.initCol(this)}initRowSpan(){this.colDef.spanRows&&this.beans.rowSpanSvc?.register(this)}addPivotListener(){const e=this.beans.pivotColDefSvc,t=this.colDef.pivotValueColumn;!e||!t||this.addManagedListeners(t,{colDefChanged:r=>{const n=e.recreateColDef(this.colDef);this.setColDef(n,n,r.source)}})}resetActualWidth(e){const t=this.calculateColInitialWidth(this.colDef);this.setActualWidth(t,e,!0)}calculateColInitialWidth(e){let t;const r=e.width,n=e.initialWidth;return r!=null?t=r:n!=null?t=n:t=200,Math.max(Math.min(t,this.maxWidth),this.minWidth)}isEmptyGroup(){return!1}isRowGroupDisplayed(e){return this.beans.showRowGroupCols?.isRowGroupDisplayed(this,e)??!1}isPrimary(){return this.primary}isFilterAllowed(){return!!this.colDef.filter}isFieldContainsDots(){return this.fieldContainsDots}isTooltipEnabled(){return this.tooltipEnabled}isTooltipFieldContainsDots(){return this.tooltipFieldContainsDots}getHighlighted(){return this.highlighted}__addEventListener(e,t){this.colEventSvc.addEventListener(e,t)}__removeEventListener(e,t){this.colEventSvc.removeEventListener(e,t)}addEventListener(e,t){this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,this.colEventSvc);const r=this.frameworkEventListenerService?.wrap(e,t)??t;this.colEventSvc.addEventListener(e,r)}removeEventListener(e,t){const r=this.frameworkEventListenerService?.unwrap(e,t)??t;this.colEventSvc.removeEventListener(e,r)}createColumnFunctionCallbackParams(e){return Dt(this.gos,{node:e,data:e.data,column:this,colDef:this.colDef})}isSuppressNavigable(e){return this.beans.cellNavigation?.isSuppressNavigable(this,e)??!1}isCellEditable(e){return this.beans.editSvc?.isCellEditable({rowNode:e,column:this})??!1}isSuppressFillHandle(){return!!this.colDef.suppressFillHandle}isAutoHeight(){return!!this.colDef.autoHeight}isAutoHeaderHeight(){return!!this.colDef.autoHeaderHeight}isRowDrag(e){return this.isColumnFunc(e,this.colDef.rowDrag)}isDndSource(e){return this.isColumnFunc(e,this.colDef.dndSource)}isCellCheckboxSelection(e){return this.beans.selectionSvc?.isCellCheckboxSelection(this,e)??!1}isSuppressPaste(e){return this.isColumnFunc(e,this.colDef?.suppressPaste??null)}isResizable(){return!!this.getColDefValue("resizable")}getColDefValue(e){return this.colDef[e]??qD[e]}isColumnFunc(e,t){if(typeof t=="boolean")return t;if(typeof t=="function"){const r=this.createColumnFunctionCallbackParams(e);return t(r)}return!1}createColumnEvent(e,t){return Dt(this.gos,{type:e,column:this,columns:[this],source:t})}isMoving(){return this.moving}getSort(){return this.sortDef.direction}getSortDef(){return this.sortDef.direction?this.sortDef:null}getColDefAllowedSortTypes(){const e=[],{sort:t,initialSort:r}=this.colDef,n=t===null?t:la(t?.type),i=r===null?r:la(r?.type);return n&&e.push(n),i&&e.push(i),e}getSortingOrder(){const e=this.getColDefAllowedSortTypes().includes("absolute")?YD:XD;return(this.colDef.sortingOrder??this.gos.get("sortingOrder")??e).map(t=>Gs(t))}getAvailableSortTypes(){const e=this.getSortingOrder().reduce((t,r)=>(r.direction&&t.push(r.type),t),this.getColDefAllowedSortTypes());return new Set(e)}get wasSortExplicitlyRemoved(){return this._wasSortExplicitlyRemoved}setSortDef(e,t=!1){t||(this._wasSortExplicitlyRemoved=!e.direction),this.sortDef=e}isSortable(){return!!this.getColDefValue("sortable")}isSortAscending(){return this.getSort()==="asc"}isSortDescending(){return this.getSort()==="desc"}isSortNone(){return Yr(this.getSort())}isSorting(){return bt(this.getSort())}getSortIndex(){return this.sortIndex}isMenuVisible(){return this.menuVisible}getAggFunc(){return this.aggFunc}getLeft(){return this.left}getOldLeft(){return this.oldLeft}getRight(){return this.left+this.actualWidth}setLeft(e,t){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchColEvent("leftChanged",t))}isFilterActive(){return this.filterActive}isHovered(){return at(261),!!this.beans.colHover?.isHovered(this)}setFirstRightPinned(e,t){this.firstRightPinned!==e&&(this.firstRightPinned=e,this.dispatchColEvent("firstRightPinnedChanged",t))}setLastLeftPinned(e,t){this.lastLeftPinned!==e&&(this.lastLeftPinned=e,this.dispatchColEvent("lastLeftPinnedChanged",t))}isFirstRightPinned(){return this.firstRightPinned}isLastLeftPinned(){return this.lastLeftPinned}isPinned(){return this.pinned==="left"||this.pinned==="right"}isPinnedLeft(){return this.pinned==="left"}isPinnedRight(){return this.pinned==="right"}getPinned(){return this.pinned}setVisible(e,t){const r=e===!0;this.visible!==r&&(this.visible=r,this.dispatchColEvent("visibleChanged",t)),this.dispatchStateUpdatedEvent("hide")}isVisible(){return this.visible}isSpanHeaderHeight(){return!this.getColDef().suppressSpanHeaderHeight}getFirstRealParent(){let e=this.getOriginalParent();for(;e?.isPadding();)e=e.getOriginalParent();return e}getColumnGroupPaddingInfo(){let e=this.getParent();if(!e?.isPadding())return{numberOfParents:0,isSpanningTotal:!1};const t=e.getPaddingLevel()+1;let r=!0;for(;e;){if(!e.isPadding()){r=!1;break}e=e.getParent()}return{numberOfParents:t,isSpanningTotal:r}}getColDef(){return this.colDef}getDefinition(){return this.colDef}getColumnGroupShow(){return this.colDef.columnGroupShow}getColId(){return this.colId}getId(){return this.colId}getUniqueId(){return this.colId}getActualWidth(){return this.actualWidth}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}createBaseColDefParams(e){return Dt(this.gos,{node:e,data:e.data,colDef:this.colDef,column:this})}getColSpan(e){if(Yr(this.colDef.colSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.colSpan(t);return Math.max(r,1)}getRowSpan(e){if(Yr(this.colDef.rowSpan))return 1;const t=this.createBaseColDefParams(e),r=this.colDef.rowSpan(t);return Math.max(r,1)}setActualWidth(e,t,r=!1){e=Math.max(e,this.minWidth),e=Math.min(e,this.maxWidth),this.actualWidth!==e&&(this.actualWidth=e,this.flex!=null&&t!=="flex"&&t!=="gridInitializing"&&(this.flex=null),r||this.fireColumnWidthChangedEvent(t)),this.dispatchStateUpdatedEvent("width")}fireColumnWidthChangedEvent(e){this.dispatchColEvent("widthChanged",e)}isGreaterThanMax(e){return e>this.maxWidth}getMinWidth(){return this.minWidth}getMaxWidth(){return this.maxWidth}getFlex(){return this.flex}isRowGroupActive(){return this.rowGroupActive}isPivotActive(){return this.pivotActive}isAnyFunctionActive(){return this.isPivotActive()||this.isRowGroupActive()||this.isValueActive()}isAnyFunctionAllowed(){return this.isAllowPivot()||this.isAllowRowGroup()||this.isAllowValue()}isValueActive(){return this.aggregationActive}isAllowPivot(){return this.colDef.enablePivot===!0}isAllowValue(){return this.colDef.enableValue===!0}isAllowRowGroup(){return this.colDef.enableRowGroup===!0}isAllowFormula(){return this.colDef.allowFormula===!0}dispatchColEvent(e,t,r){const n=this.createColumnEvent(e,t);r&&xi(n,r),this.colEventSvc.dispatchEvent(n)}dispatchStateUpdatedEvent(e){this.colEventSvc.dispatchEvent({type:"columnStateUpdated",key:e})}};function Gs(e){return qu(e)?{direction:e.direction,type:e.type}:{direction:nm(e),type:la(e)}}function il(e){return e==="asc"||e==="desc"||e===null}function gy(e){return e==="default"||e==="absolute"}function qu(e){if(!e||typeof e!="object")return!1;const t=e;return gy(t.type)&&il(t.direction)}function Zg(e,t){return e?t?e.type===t.type&&e.direction===t.direction:e?e.direction===null:!0:t?t.direction===null:!0}function nm(e){return il(e)?e:null}function la(e){return gy(e)?e:"default"}function ci(e){return e instanceof Jg}var Jg=class extends et{constructor(e,t,r,n){super(),this.colGroupDef=e,this.groupId=t,this.padding=r,this.level=n,this.isColumn=!1,this.expandable=!1,this.instanceId=tk(),this.expandableListenerRemoveCallback=null,this.expanded=!!e?.openByDefault}destroy(){this.expandableListenerRemoveCallback&&this.reset(null,void 0),super.destroy()}reset(e,t){this.colGroupDef=e,this.level=t,this.originalParent=null,this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback(),this.children=void 0,this.expandable=void 0}getInstanceId(){return this.instanceId}getOriginalParent(){return this.originalParent}getLevel(){return this.level}isVisible(){return this.children?this.children.some(e=>e.isVisible()):!1}isPadding(){return this.padding}setExpanded(e){this.expanded=e===void 0?!1:e,this.dispatchLocalEvent({type:"expandedChanged"})}isExpandable(){return this.expandable}isExpanded(){return this.expanded}getGroupId(){return this.groupId}getId(){return this.getGroupId()}setChildren(e){this.children=e}getChildren(){return this.children}getColGroupDef(){return this.colGroupDef}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}forEachLeafColumn(e){if(this.children)for(const t of this.children)cl(t)?e(t):ci(t)&&t.forEachLeafColumn(e)}addLeafColumns(e){if(this.children)for(const t of this.children)cl(t)?e.push(t):ci(t)&&t.addLeafColumns(e)}getColumnGroupShow(){const e=this.colGroupDef;if(e)return e.columnGroupShow}setupExpandable(){this.setExpandable(),this.expandableListenerRemoveCallback&&this.expandableListenerRemoveCallback();const e=this.onColumnVisibilityChanged.bind(this);for(const t of this.getLeafColumns())t.__addEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=()=>{for(const t of this.getLeafColumns())t.__removeEventListener("visibleChanged",e);this.expandableListenerRemoveCallback=null}}setExpandable(){if(this.isPadding())return;let e=!1,t=!1,r=!1;const n=this.findChildrenRemovingPadding();for(let s=0,o=n.length;s<o;s++){const a=n[s];if(!a.isVisible())continue;const l=a.getColumnGroupShow();l==="open"?(e=!0,r=!0):l==="closed"?(t=!0,r=!0):(e=!0,t=!0)}const i=e&&t&&r;this.expandable!==i&&(this.expandable=i,this.dispatchLocalEvent({type:"expandableChanged"}))}findChildrenRemovingPadding(){const e=[],t=r=>{for(const n of r)ci(n)&&n.isPadding()?t(n.children):e.push(n)};return t(this.children),e}onColumnVisibilityChanged(){this.setExpandable()}},ZD={numericColumn:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"},rightAligned:{headerClass:"ag-right-aligned-header",cellClass:"ag-right-aligned-cell"}};function $_(e,t,r){const n={},i=e.gos;return Object.assign(n,i.get("defaultColGroupDef")),Object.assign(n,t),i.validateColDef(n,r),n}var JD=class{constructor(){this.existingKeys={}}addExistingKeys(e){for(let t=0;t<e.length;t++)this.existingKeys[e[t]]=!0}getUniqueKey(e,t){e=Xb(e);let r=0;for(;;){let n=e??t;if(n?r!==0&&(n+="_"+r):n=r,!this.existingKeys[n]){const i=String(n);return e&&r>0&&at(273,{providedId:e,usedId:i}),this.existingKeys[i]=!0,i}r++}}};function zr(e){if(e?.length)return e[e.length-1]}function ml(e,t,r){if(e===t)return!0;if(!e||!t)return e==null&&t==null;const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(e[i]!==t[i]&&!r?.(e[i],t[i]))return!1;return!0}function yh(e,t){if(e){for(const r of e)if(t(r))return!0}}function Eo(e,t){const r=e.indexOf(t);r>=0&&e.splice(r,1)}function q_(e,t,r){for(let n=0;n<t.length;n++)Eo(e,t[n]);for(let n=t.length-1;n>=0;n--)e.splice(r,0,t[n])}var im="ag-Grid-AutoColumn",rk="ag-Grid-SelectionColumn",nk="ag-Grid-RowNumbersColumn";function ik(e){const t=[],r=n=>{for(let i=0;i<n.length;i++){const s=n[i];cl(s)?t.push(s):ci(s)&&r(s.getChildren())}};return r(e),t}function Yo(e){return e.reduce((t,r)=>t+r.getActualWidth(),0)}function w0(e,t,r){const n={};if(!t)return;ra(null,t,s=>{n[s.getInstanceId()]=s}),r&&ra(null,r,s=>{n[s.getInstanceId()]=null});const i=Object.values(n).filter(s=>s!=null);e.context.destroyBeans(i)}function my(e){return e.getId().startsWith(im)}function vl(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(rk)??!1}function ta(e){return(typeof e=="string"?e:"getColId"in e?e.getColId():e.colId)?.startsWith(nk)??!1}function QD(e){return vl(e)||ta(e)}function y0(e){let t=[];return e instanceof Array?t=e:typeof e=="string"&&(t=e.split(",")),t}function eP(e,t){return ml(e,t,(r,n)=>r.getColId()===n.getColId())}function tP(e){e.map={};for(const t of e.list)e.map[t.getId()]=t}function Ku(e){return e==="optionsUpdated"?"gridOptionsChanged":e}function zh(e,t){const r=e===t,n=e.getColDef()===t,i=e.getColId()==t;return r||n||i}var rP=(e,t)=>(r,n)=>{const i={value1:void 0,value2:void 0};let s=!1;return e&&(e[r]!==void 0&&(i.value1=e[r],s=!0),bt(n)&&e[n]!==void 0&&(i.value2=e[n],s=!0)),!s&&t&&(t[r]!==void 0&&(i.value1=t[r]),bt(n)&&t[n]!==void 0&&(i.value2=t[n])),i};function nP(e,t){const r={...e,sort:void 0,colId:t},n=sk(e);return n&&(r.sort=n.direction,r.sortType=n.type),r}function sk(e){const{sort:t,initialSort:r}=e,n=qu(t)||il(t),i=qu(r)||il(r);return n?Gs(t):i?Gs(r):null}var iP=(e,t)=>{ci(e)&&e.setupExpandable(),e.originalParent=t};function sP(e,t=null,r,n,i){const s=new JD,{existingCols:o,existingGroups:a,existingColKeys:l}=oP(n);s.addExistingKeys(l);const c=ok(e,t,0,r,o,s,a,i),{colGroupSvc:u}=e,h=u?.findMaxDepth(c,0)??0,d=u?u.balanceColumnTree(c,0,h,s):c;return ra(null,d,iP),{columnTree:d,treeDepth:h}}function oP(e){const t=[],r=[],n=[];return e&&ra(null,e,i=>{if(ci(i)){const s=i;r.push(s)}else{const s=i;n.push(s.getId()),t.push(s)}}),{existingCols:t,existingGroups:r,existingColKeys:n}}function ok(e,t,r,n,i,s,o,a){if(!t)return[];const{colGroupSvc:l}=e,c=new Array(t.length);for(let u=0;u<c.length;u++){const h=t[u];l&&hP(h)?c[u]=l.createProvidedColumnGroup(n,h,r,i,s,o,a):c[u]=aP(e,n,h,i,s,a)}return c}function aP(e,t,r,n,i,s){const o=cP(r,n);o&&n?.splice(o.idx,1);let a=o?.column;if(a){const l=iw(e,r,a.getColId());a.setColDef(l,r,s),lP(e,a,l,s)}else{const l=i.getUniqueKey(r.colId,r.field),c=iw(e,r,l);a=new Fc(c,r,l,t),e.context.createBean(a)}return e.dataTypeSvc?.addColumnListeners(a),a}function ak(e,t,r,n,i,s,o,a){const{sortSvc:l,pinnedCols:c,colFlex:u}=e;r!==void 0&&t.setVisible(!r,a),l&&(l.updateColSort(t,n,a),i!==void 0&&l.setColSortIndex(t,i)),s!==void 0&&c?.setColPinned(t,s),o!==void 0&&u?.setColFlex(t,o)}function lP(e,t,r,n){ak(e,t,r.hide,r.sort,r.sortIndex,r.pinned,r.flex,n);const i=t.getFlex();if(!(i!=null&&i>0))if(r.width!=null)t.setActualWidth(r.width,n);else{const s=t.getActualWidth();t.setActualWidth(s,n)}}function cP(e,t){if(t)for(let r=0;r<t.length;r++){const n=t[r].getUserProvidedColDef();if(!n)continue;if(e.colId!=null){if(t[r].getId()===e.colId)return{idx:r,column:t[r]};continue}if(e.field!=null){if(n.field===e.field)return{idx:r,column:t[r]};continue}if(n===e)return{idx:r,column:t[r]}}}function iw(e,t,r,n){const{gos:i,dataTypeSvc:s}=e,o={},a=i.get("defaultColDef");xi(o,a,!1,!0);const l=uP(e,o,t,r);l&&dP(e,l,o);const c=o.cellDataType;xi(o,t,!1,!0),c!==void 0&&(o.cellDataType=c);const u=i.get("autoGroupColumnDef"),h=Zo(i);return t.rowGroup&&u&&h&&xi(o,{sort:u.sort,initialSort:u.initialSort},!1,!0),s?.postProcess(o),s?.validateColDef(o),i.validateColDef(o,r,n),o}function uP(e,t,r,n){const i=e.dataTypeSvc?.updateColDefAndGetColumnType(t,r,n),s=r.type??i??t.type;return t.type=s,s?y0(s):void 0}function dP(e,t,r){if(!t.length)return;const n=Object.assign({},ZD),i=e.gos.get("columnTypes")||{};for(const s of Object.keys(i)){const o=i[s];s in n?at(34,{key:s}):(o.type&&at(35),n[s]=o)}for(const s of t){const o=n[s.trim()];o?xi(r,o,!1,!0):at(36,{t:s})}}function hP(e){return e.children!==void 0}function ra(e,t,r){if(t)for(let n=0;n<t.length;n++){const i=t[n];ci(i)&&ra(i,i.getChildren(),r),r(i,e)}}function lk(e,t){const r=[],n=[],i=[];return e.forEach(o=>{const a=o.getColDef().lockPosition;a==="right"?i.push(o):a==="left"||a===!0?r.push(o):n.push(o)}),t.get("enableRtl")?[...i,...n,...r]:[...r,...n,...i]}function ck(e,t){let r=!0;return ra(null,t,n=>{if(!ci(n))return;const i=n;if(!i.getColGroupDef()?.marryChildren)return;const a=[];for(const d of i.getLeafColumns()){const f=e.indexOf(d);a.push(f)}const l=Math.max.apply(Math,a),c=Math.min.apply(Math,a),u=l-c,h=i.getLeafColumns().length-1;u>h&&(r=!1)}),r}function uk(e,t){if(!e||e.length==0)return;const r=t(e[0]);for(let n=1;n<e.length;n++)if(r!==t(e[n]))return;return r}function dk(e,t,r){if(!t.length)return;const n=t.length===1?t[0]:null,i=uk(t,s=>s.getPinned());e.dispatchEvent({type:"columnPinned",pinned:i??null,columns:t,column:n,source:r})}function fP(e,t,r){if(!t.length)return;const n=t.length===1?t[0]:null,i=uk(t,s=>s.isVisible());e.dispatchEvent({type:"columnVisible",visible:i,columns:t,column:n,source:r})}function pP(e,t,r,n){e.dispatchEvent({type:t,columns:r,column:r&&r.length==1?r[0]:null,source:n})}function cd(e,t,r,n,i=null){t?.length&&e.dispatchEvent({type:"columnResized",columns:t,column:t.length===1?t[0]:null,flexColumns:i,finished:r,source:n})}function Ws(e,t,r){const{colModel:n,rowGroupColsSvc:i,pivotColsSvc:s,autoColSvc:o,selectionColSvc:a,colAnimation:l,visibleCols:c,pivotResultCols:u,environment:h,valueColsSvc:d,eventSvc:f,gos:m}=e,v=n.getColDefCols()??[],g=a?.getColumns();if(!v.length&&!g?.length)return!1;if(t?.state&&!t.state.forEach)return at(32),!1;const w=(F,I,N,j,L)=>{if(!F)return;const W=rP(I,t.defaultState),K=W("flex").value1,z=W("sort").value1,M=W("sortType").value1,B=il(z)||gy(M),R=la(M),S=nm(z),_=B?{type:R,direction:S}:void 0;if(ak(e,F,W("hide").value1,_,W("sortIndex").value1,W("pinned").value1,K,r),K==null){const T=W("width").value1;if(T!=null){const E=F.getColDef().minWidth??h.getDefaultColumnMinWidth();E!=null&&T>=E&&F.setActualWidth(T,r)}}L||!F.isPrimary()||(d?.syncColumnWithState(F,r,W),i?.syncColumnWithState(F,r,W,N),s?.syncColumnWithState(F,r,W,j))},y=(F,I,N)=>{const j=hk(e,r),L=I.slice(),W={},K={},z=[],M=[],B=[];let R=0;const S=i?.columns.slice()??[],_=s?.columns.slice()??[];for(const D of F){const O=D.colId;if(O.startsWith(im)){z.push(D),B.push(D);continue}if(vl(O)){M.push(D),B.push(D);continue}const q=N(O);q?(w(q,D,W,K,!1),Eo(L,q)):(B.push(D),R+=1)}const T=D=>w(D,null,W,K,!1);L.forEach(T),i?.sortColumns(K_.bind(i,W,S)),s?.sortColumns(K_.bind(s,K,_)),n.refreshCols(!1,r);const E=(D,O,P=[])=>{for(const q of O){const X=D(q.colId);Eo(P,X),w(X,q,null,null,!0)}P.forEach(T)};return E(D=>o?.getColumn(D)??null,z,o?.getColumns()?.slice()),E(D=>a?.getColumn(D)??null,M,a?.getColumns()?.slice()),mP(t,n,m),c.refresh(r),f.dispatchEvent({type:"columnEverythingChanged",source:r}),j(),{unmatchedAndAutoStates:B,unmatchedCount:R}};l?.start();let{unmatchedAndAutoStates:C,unmatchedCount:k}=y(t.state||[],v,F=>n.getColDefCol(F));if(C.length>0||bt(t.defaultState)){const F=u?.getPivotResultCols()?.list??[];k=y(C,F,I=>u?.getPivotResultCol(I)??null).unmatchedCount}return l?.finish(),k===0}function gP(e,t){const{colModel:r,autoColSvc:n,selectionColSvc:i,eventSvc:s,gos:o}=e,a=r.getColDefCols();if(!a?.length)return;const l=r.getColDefColTree(),c=ik(l),u=[];let h=1e3,d=1e3;const f=y=>{const C=fk(y);Yr(C.rowGroupIndex)&&C.rowGroup&&(C.rowGroupIndex=h++),Yr(C.pivotIndex)&&C.pivot&&(C.pivotIndex=d++),u.push(C)};n?.getColumns()?.forEach(f),i?.getColumns()?.forEach(f),c?.forEach(f),Ws(e,{state:u},t);const m=n?.getColumns()??[],w=[...i?.getColumns()??[],...m,...a].map(y=>({colId:y.colId}));Ws(e,{state:w,applyOrder:!0},t),s.dispatchEvent(Dt(o,{type:"columnsReset",source:t}))}function hk(e,t){const{rowGroupColsSvc:r,pivotColsSvc:n,valueColsSvc:i,colModel:s,sortSvc:o,eventSvc:a}=e,l={rowGroupColumns:r?.columns.slice()??[],pivotColumns:n?.columns.slice()??[],valueColumns:i?.columns.slice()??[]},c=C0(e),u={};for(const h of c)u[h.colId]=h;return()=>{const h=(I,N,j,L)=>{const W=N.map(L),K=j.map(L);if(ml(W,K))return;const M=new Set(N);for(const R of j)M.delete(R)||M.add(R);const B=[...M];a.dispatchEvent({type:I,columns:B,column:B.length===1?B[0]:null,source:t})},d=I=>{const N=[];return s.forAllCols(j=>{const L=u[j.getColId()];L&&I(L,j)&&N.push(j)}),N},f=I=>I.getColId();h("columnRowGroupChanged",l.rowGroupColumns,r?.columns??[],f),h("columnPivotChanged",l.pivotColumns,n?.columns??[],f);const v=d((I,N)=>{const j=I.aggFunc!=null,L=j!=N.isValueActive(),W=j&&I.aggFunc!=N.getAggFunc();return L||W});v.length>0&&pP(a,"columnValueChanged",v,t),cd(a,d((I,N)=>I.width!=N.getActualWidth()),!0,t),dk(a,d((I,N)=>I.pinned!=N.getPinned()),t),fP(a,d((I,N)=>I.hide==N.isVisible()),t);const k=d((I,N)=>!Zg(N.getSortDef(),{type:la(I.sortType),direction:nm(I.sort)})||I.sortIndex!=N.getSortIndex());k.length>0&&o?.dispatchSortChangedEvents(t,k);const F=C0(e);bP(c,F,t,s,a)}}function C0(e){const{colModel:t,rowGroupColsSvc:r,pivotColsSvc:n}=e,i=t.getColDefCols();if(Yr(i)||!t.isAlive())return[];const s=r?.columns,o=n?.columns,a=[],l=u=>{const h=u.isRowGroupActive()&&s?s.indexOf(u):null,d=u.isPivotActive()&&o?o.indexOf(u):null,f=u.isValueActive()?u.getAggFunc():null,m=u.getSortIndex()!=null?u.getSortIndex():null;a.push({colId:u.getColId(),width:u.getActualWidth(),hide:!u.isVisible(),pinned:u.getPinned(),sort:u.getSort(),sortType:u.getSortDef()?.type,sortIndex:m,aggFunc:f,rowGroup:u.isRowGroupActive(),rowGroupIndex:h,pivot:u.isPivotActive(),pivotIndex:d,flex:u.getFlex()??null})};t.forAllCols(u=>l(u));const c=new Map(t.getCols().map((u,h)=>[u.getColId(),h]));return a.sort((u,h)=>{const d=c.has(u.colId)?c.get(u.colId):-1,f=c.has(h.colId)?c.get(h.colId):-1;return d-f}),a}function fk(e){const t=(g,w)=>g??w??null,r=e.getColDef(),n=Gs(t(r.sort,r.initialSort)),i=n.direction,s=n.type,o=t(r.sortIndex,r.initialSortIndex),a=t(r.hide,r.initialHide),l=t(r.pinned,r.initialPinned),c=t(r.width,r.initialWidth),u=t(r.flex,r.initialFlex);let h=t(r.rowGroupIndex,r.initialRowGroupIndex),d=t(r.rowGroup,r.initialRowGroup);h==null&&!d&&(h=null,d=null);let f=t(r.pivotIndex,r.initialPivotIndex),m=t(r.pivot,r.initialPivot);f==null&&!m&&(f=null,m=null);const v=t(r.aggFunc,r.initialAggFunc);return{colId:e.getColId(),sort:i,sortType:s,sortIndex:o,hide:a,pinned:l,width:c,flex:u,rowGroup:d,rowGroupIndex:h,pivot:m,pivotIndex:f,aggFunc:v}}function mP(e,t,r){if(!e.applyOrder||!e.state)return;const n=[];for(const i of e.state)i.colId!=null&&n.push(i.colId);vP(t.cols,n,t,r)}function vP(e,t,r,n){if(e==null)return;let i=[];const s={};for(const a of t){if(s[a])continue;const l=e.map[a];l&&(i.push(l),s[a]=!0)}let o=0;for(const a of e.list){const l=a.getColId();if(s[l]!=null)continue;l.startsWith(im)?i.splice(o++,0,a):i.push(a)}if(i=lk(i,n),!ck(i,r.getColTree())){at(39);return}e.list=i}function bP(e,t,r,n,i){const s={};for(const u of t)s[u.colId]=u;const o={};for(const u of e)s[u.colId]&&(o[u.colId]=!0);const a=e.filter(u=>o[u.colId]),l=t.filter(u=>o[u.colId]),c=[];l.forEach((u,h)=>{const d=a?.[h];if(d&&d.colId!==u.colId){const f=n.getCol(d.colId);f&&c.push(f)}}),c.length&&i.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,finished:!0,source:r})}var K_=(e,t,r,n)=>{const i=e[r.getId()],s=e[n.getId()],o=i!=null,a=s!=null;if(o&&a)return i-s;if(o)return-1;if(a)return 1;const l=t.indexOf(r),c=t.indexOf(n),u=l>=0,h=c>=0;return u&&h?l-c:u?-1:1},wP=class extends et{constructor(){super(...arguments),this.beanName="colModel",this.pivotMode=!1,this.ready=!1,this.changeEventsDispatching=!1}postConstruct(){this.pivotMode=this.gos.get("pivotMode"),this.addManagedPropertyListeners(["groupDisplayType","treeData","treeDataDisplayType","groupHideOpenParents","rowNumbers","hidePaddedHeaderRows"],e=>this.refreshAll(Ku(e.source))),this.addManagedPropertyListeners(["defaultColDef","defaultColGroupDef","columnTypes","suppressFieldDotNotation"],this.recreateColumnDefs.bind(this)),this.addManagedPropertyListener("pivotMode",e=>this.setPivotMode(this.gos.get("pivotMode"),Ku(e.source)))}createColsFromColDefs(e){const{beans:t}=this,{valueCache:r,colAutosize:n,rowGroupColsSvc:i,pivotColsSvc:s,valueColsSvc:o,visibleCols:a,eventSvc:l,groupHierarchyColSvc:c}=t,u=this.colDefs?hk(t,e):void 0;r?.expire();const h=this.colDefCols?.list,d=this.colDefCols?.tree,f=sP(t,this.colDefs,!0,d,e);w0(t,this.colDefCols?.tree,f.columnTree);const m=f.columnTree,v=f.treeDepth,g=ik(m),w={};for(const y of g)w[y.getId()]=y;this.colDefCols={tree:m,treeDepth:v,list:g,map:w},this.createColumnsForService([c],this.colDefCols,e),i?.extractCols(e,h),s?.extractCols(e,h),o?.extractCols(e,h),this.ready=!0,this.changeEventsDispatching=!0,this.refreshCols(!0,e),this.changeEventsDispatching=!1,a.refresh(e),l.dispatchEvent({type:"columnEverythingChanged",source:e}),u&&(this.changeEventsDispatching=!0,u(),this.changeEventsDispatching=!1),l.dispatchEvent({type:"newColumnsLoaded",source:e}),e==="gridInitializing"&&n?.applyAutosizeStrategy()}refreshCols(e,t){if(!this.colDefCols)return;const r=this.cols?.tree;this.saveColOrder();const{autoColSvc:n,selectionColSvc:i,rowNumbersSvc:s,quickFilter:o,pivotResultCols:a,showRowGroupCols:l,rowAutoHeight:c,visibleCols:u,colViewport:h,eventSvc:d,formula:f}=this.beans,m=this.selectCols(a,this.colDefCols);f?.setFormulasActive(m),this.createColumnsForService([n,i,s],m,t);const v=MD(this.gos,this.showingPivotResult);(!e||v)&&this.restoreColOrder(m),this.positionLockedCols(m),l?.refresh(),o?.refreshCols(),this.setColSpanActive(),c?.setAutoHeightActive(m),u.clear(),h.clear(),ml(r,this.cols.tree)||d.dispatchEvent({type:"gridColumnsChanged"})}createColumnsForService(e,t,r){for(const n of e)n&&(n.createColumns(t,i=>{this.lastOrder=i(this.lastOrder),this.lastPivotOrder=i(this.lastPivotOrder)},r),n.addColumns(t))}selectCols(e,t){const r=e?.getPivotResultCols()??null;this.showingPivotResult=r!=null;const{map:n,list:i,tree:s,treeDepth:o}=r??t;return this.cols={list:i.slice(),map:{...n},tree:s.slice(),treeDepth:o},r&&(r.list.some(l=>this.cols?.map[l.getColId()]!==void 0)||(this.lastPivotOrder=null)),this.cols}getColsToShow(){if(!this.cols)return[];const{beans:e,showingPivotResult:t,cols:r}=this,{valueColsSvc:n,selectionColSvc:i}=e,s=this.isPivotMode()&&!t,o=i?.isSelectionColumnEnabled(),a=DD(e),l=n?.columns;return r.list.filter(u=>{const h=my(u);if(s){const d=l?.includes(u);return h||d||o&&vl(u)||a&&ta(u)}else return h||u.isVisible()})}refreshAll(e){this.ready&&(this.refreshCols(!1,e),this.beans.visibleCols.refresh(e))}setColsVisible(e,t=!1,r){Ws(this.beans,{state:e.map(n=>({colId:typeof n=="string"?n:n.getColId(),hide:!t}))},r)}restoreColOrder(e){const t=this.showingPivotResult?this.lastPivotOrder:this.lastOrder;if(!t)return;const r=t.filter(h=>e.map[h.getId()]!=null);if(r.length===0)return;if(r.length===e.list.length){e.list=r;return}const n=h=>{const d=h.getOriginalParent();return d?d.getChildren().length>1?!0:n(d):!1};if(!r.some(h=>n(h))){const h=new Set(r);for(const d of e.list)h.has(d)||r.push(d);e.list=r;return}const i=new Map;for(let h=0;h<r.length;h++){const d=r[h];i.set(d,h)}const s=e.list.filter(h=>!i.has(h));if(s.length===0){e.list=r;return}const o=(h,d)=>{const f=d?d.getOriginalParent():h.getOriginalParent();if(!f)return null;let m=null,v=null;for(const g of f.getChildren())if(!(g===d||g===h)){if(g instanceof Fc){const w=i.get(g);if(w==null)continue;(m==null||m<w)&&(m=w,v=g);continue}g.forEachLeafColumn(w=>{const y=i.get(w);y!=null&&(m==null||m<y)&&(m=y,v=w)})}return v??o(h,f)},a=[],l=new Map;for(const h of s){const d=o(h,null);if(d==null){a.push(h);continue}const f=l.get(d);f===void 0?l.set(d,h):Array.isArray(f)?f.push(h):l.set(d,[f,h])}const c=new Array(e.list.length);let u=c.length-1;for(let h=a.length-1;h>=0;h--)c[u--]=a[h];for(let h=r.length-1;h>=0;h--){const d=r[h],f=l.get(d);if(f)if(Array.isArray(f))for(let m=f.length-1;m>=0;m--){const v=f[m];c[u--]=v}else c[u--]=f;c[u--]=d}e.list=c}positionLockedCols(e){e.list=lk(e.list,this.gos)}saveColOrder(){this.showingPivotResult?this.lastPivotOrder=this.cols?.list??null:this.lastOrder=this.cols?.list??null}getColumnDefs(e){return this.colDefCols&&this.beans.colDefFactory?.getColumnDefs(this.colDefCols.list,this.showingPivotResult,this.lastOrder,this.cols?.list??[],e)}setColSpanActive(){this.colSpanActive=!!this.cols?.list.some(e=>e.getColDef().colSpan!=null)}isPivotMode(){return this.pivotMode}setPivotMode(e,t){if(e===this.pivotMode||(this.pivotMode=e,!this.ready))return;this.refreshCols(!1,t);const{visibleCols:r,eventSvc:n}=this.beans;r.refresh(t),n.dispatchEvent({type:"columnPivotModeChanged"})}isPivotActive(){const e=this.beans.pivotColsSvc?.columns;return this.pivotMode&&!!e?.length}recreateColumnDefs(e){if(!this.cols)return;this.beans.autoColSvc?.updateColumns(e);const t=Ku(e.source);this.createColsFromColDefs(t)}setColumnDefs(e,t){this.colDefs=e,this.createColsFromColDefs(t)}destroy(){w0(this.beans,this.colDefCols?.tree),super.destroy()}getColTree(){return this.cols?.tree??[]}getColDefColTree(){return this.colDefCols?.tree??[]}getColDefCols(){return this.colDefCols?.list??null}getCols(){return this.cols?.list??[]}forAllCols(e){const{pivotResultCols:t,autoColSvc:r,selectionColSvc:n,groupHierarchyColSvc:i}=this.beans;yh(this.colDefCols?.list,e)||yh(r?.columns?.list,e)||yh(n?.columns?.list,e)||yh(i?.columns?.list,e)||yh(t?.getPivotResultCols()?.list,e)}getColsForKeys(e){return e?e.map(t=>this.getCol(t)).filter(t=>t!=null):[]}getColDefCol(e){return this.colDefCols?.list?this.getColFromCollection(e,this.colDefCols):null}getCol(e){return e==null?null:this.getColFromCollection(e,this.cols)}getColById(e){return this.cols?.map[e]??null}getColFromCollection(e,t){if(t==null)return null;const{map:r,list:n}=t;if(typeof e=="string"&&r[e])return r[e];for(let a=0;a<n.length;a++)if(zh(n[a],e))return n[a];const{autoColSvc:i,selectionColSvc:s,groupHierarchyColSvc:o}=this.beans;return i?.getColumn(e)??s?.getColumn(e)??o?.getColumn(e)??null}},pk=class{constructor(){this.existingIds={}}getInstanceIdForKey(e){const t=this.existingIds[e];let r;return typeof t!="number"?r=0:r=t+1,this.existingIds[e]=r,r}},xd=class extends et{};function Vf(e,t,r){return r&&e.addDestroyFunc(()=>t.destroyBean(r)),r??e}var xt=null;function X_(e){return typeof e?.getGui=="function"}var Gf=class{constructor(e){this.cssClassStates={},this.getGui=e}toggleCss(e,t){if(!e)return;if(e.includes(" ")){const n=(e||"").split(" ");if(n.length>1){for(const i of n)this.toggleCss(i,t);return}}this.cssClassStates[e]!==t&&e.length&&(this.getGui()?.classList.toggle(e,t),this.cssClassStates[e]=t)}},yP=0,Sd=class extends _i{constructor(e,t){super(),this.suppressDataRefValidation=!1,this.displayed=!0,this.visible=!0,this.compId=yP++,this.cssManager=new Gf(()=>this.eGui),this.componentSelectors=new Map((t??[]).map(r=>[r.selector,r])),e&&this.setTemplate(e)}preConstruct(){this.wireTemplate(this.getGui());const e="component-"+Object.getPrototypeOf(this)?.constructor?.name;for(const t of this.css??[])this.beans.environment.addGlobalCSS(t,e)}wireTemplate(e,t){e&&this.gos&&(this.applyElementsToComponent(e),this.createChildComponentsFromTags(e,t))}getCompId(){return this.compId}getDataRefAttribute(e){return e.getAttribute?e.getAttribute(FT):null}applyElementsToComponent(e,t,r,n=null){if(t===void 0&&(t=this.getDataRefAttribute(e)),t){const i=this[t];if(i===xt)this[t]=n??e;else{const s=r?.[t];if(!this.suppressDataRefValidation&&!s)throw new Error(`data-ref: ${t} on ${this.constructor.name} with ${i}`)}}}createChildComponentsFromTags(e,t){const r=[];for(const n of e.childNodes??[])r.push(n);for(const n of r){if(!(n instanceof HTMLElement))continue;const i=this.createComponentFromElement(n,s=>{const o=s.getGui();if(o)for(const a of n.attributes??[])o.setAttribute(a.name,a.value)},t);if(i){if(i.addItems&&n.children.length){this.createChildComponentsFromTags(n,t);const s=Array.prototype.slice.call(n.children);i.addItems(s)}this.swapComponentForNode(i,e,n)}else n.childNodes&&this.createChildComponentsFromTags(n,t)}}createComponentFromElement(e,t,r){const n=e.nodeName,i=this.getDataRefAttribute(e),s=n.indexOf("AG-")===0,o=s?this.componentSelectors.get(n):null;let a=null;if(o){const l=r&&i?r[i]:void 0;a=new o.component(l),a.setParentComponent(this),this.createBean(a,null,t)}else if(s)throw new Error(`selector: ${n}`);return this.applyElementsToComponent(e,i,r,a),a}swapComponentForNode(e,t,r){const n=e.getGui();t.replaceChild(n,r),t.insertBefore(document.createComment(r.nodeName),n),this.addDestroyFunc(this.destroyBean.bind(this,e))}activateTabIndex(e,t){const r=t??this.gos.get("tabIndex");e||(e=[]),e.length||e.push(this.getGui());for(const n of e)n.setAttribute("tabindex",r.toString())}setTemplate(e,t,r){let n;typeof e=="string"||e==null?n=oy(e):n=nl(e),this.setTemplateFromElement(n,t,r)}setTemplateFromElement(e,t,r,n=!1){if(this.eGui=e,this.suppressDataRefValidation=n,t)for(let i=0;i<t.length;i++){const s=t[i];this.componentSelectors.set(s.selector,s)}this.wireTemplate(e,r)}getGui(){return this.eGui}getFocusableElement(){return this.eGui}getAriaElement(){return this.getFocusableElement()}setParentComponent(e){this.parentComponent=e}getParentComponent(){return this.parentComponent}setGui(e){this.eGui=e}queryForHtmlElement(e){return this.eGui.querySelector(e)}getContainerAndElement(e,t){let r=t;return e==null?null:(r||(r=this.eGui),cy(e)?{element:e,parent:r}:{element:e.getGui(),parent:r})}prependChild(e,t){const{element:r,parent:n}=this.getContainerAndElement(e,t)||{};!r||!n||n.insertAdjacentElement("afterbegin",r)}appendChild(e,t){const{element:r,parent:n}=this.getContainerAndElement(e,t)||{};!r||!n||n.appendChild(r)}isDisplayed(){return this.displayed}setVisible(e,t={}){if(e!==this.visible){this.visible=e;const{skipAriaHidden:r}=t;YM(this.eGui,e,{skipAriaHidden:r})}}setDisplayed(e,t={}){if(e!==this.displayed){this.displayed=e;const{skipAriaHidden:r}=t;Gr(this.eGui,e,{skipAriaHidden:r});const n={type:"displayChanged",visible:this.displayed};this.dispatchLocalEvent(n)}}destroy(){this.parentComponent&&(this.parentComponent=void 0),super.destroy()}addGuiEventListener(e,t,r){this.eGui.addEventListener(e,t,r),this.addDestroyFunc(()=>this.eGui.removeEventListener(e,t))}addCss(e){this.cssManager.toggleCss(e,!0)}removeCss(e){this.cssManager.toggleCss(e,!1)}toggleCss(e,t){this.cssManager.toggleCss(e,t)}registerCSS(e){this.css||(this.css=[]),this.css.push(e)}},pn=class extends Sd{};function gk(e){return typeof e=="object"&&!!e.component}function CP(e,t){return new hr(r=>{r(window.setInterval(e,t))})}var hr=class Mh{constructor(t){this.status=0,this.resolution=null,this.waiters=[],t(r=>this.onDone(r),r=>this.onReject(r))}static all(t){return t.length?new Mh(r=>{let n=t.length;const i=new Array(n);t.forEach((s,o)=>{s.then(a=>{i[o]=a,n--,n===0&&r(i)})})}):Mh.resolve()}static resolve(t=null){return new Mh(r=>r(t))}then(t){return new Mh(r=>{this.status===1?r(t(this.resolution)):this.waiters.push(n=>r(t(n)))})}onDone(t){this.status=1,this.resolution=t;for(const r of this.waiters)r(t)}onReject(t){}};function xP(e){return e?e.prototype&&"getGui"in e.prototype:!1}function mk(e,t,r,n){const{name:i}=r;let s,o,a,l,c,u;if(t){const h=t,d=h[i+"Selector"],f=d?d(n):null,m=v=>{typeof v=="string"?s=v:v!=null&&v!==!0&&(e.isFrameworkComponent(v)?a=v:o=v)};f?(m(f.component),l=f.params,c=f.popup,u=f.popupPosition):m(h[i])}return{compName:s,jsComp:o,fwComp:a,paramsFromSelector:l,popupFromSelector:c,popupPositionFromSelector:u}}var SP=class extends et{constructor(){super(...arguments),this.beanName="userCompFactory"}wireBeans(e){this.agCompUtils=e.agCompUtils,this.registry=e.registry,this.frameworkCompWrapper=e.frameworkCompWrapper,this.gridOptions=e.gridOptions}getCompDetailsFromGridOptions(e,t,r,n=!1){return this.getCompDetails(this.gridOptions,e,t,r,n)}getCompDetails(e,t,r,n,i=!1){const{name:s,cellRenderer:o}=t;let{compName:a,jsComp:l,fwComp:c,paramsFromSelector:u,popupFromSelector:h,popupPositionFromSelector:d}=mk(this.beans.frameworkOverrides,e,t,n),f,m;const v=C=>{const k=this.registry.getUserComponent(s,C);k&&(l=k.componentFromFramework?void 0:k.component,c=k.componentFromFramework?k.component:void 0,f=k.params,m=k.processParams)};if(a!=null&&v(a),l==null&&c==null&&r!=null&&v(r),l&&o&&!xP(l)&&(l=this.agCompUtils?.adaptFunction(t,l)),!l&&!c){const{validation:C}=this.beans;i&&(a!==r||!r)?a?C?.isProvidedUserComp(a)||Ar(50,{compName:a}):r?C||Ar(260,{...this.gos.getModuleErrorParams(),propName:s,compName:r}):Ar(216,{name:s}):r&&!C&&Ar(146,{comp:r});return}const g=this.mergeParams(e,t,n,u,f,m),w=l==null,y=l??c;return{componentFromFramework:w,componentClass:y,params:g,type:t,popupFromSelector:h,popupPositionFromSelector:d,newAgStackInstance:()=>this.newAgStackInstance(y,w,g,t)}}newAgStackInstance(e,t,r,n){const i=!t;let s;i?s=new e:s=this.frameworkCompWrapper.wrap(e,n.mandatoryMethods,n.optionalMethods,n),this.createBean(s);const o=s.init?.(r);return o==null?hr.resolve(s):o.then(()=>s)}mergeParams(e,t,r,n=null,i,s){const o={...r,...i},l=e?.[t.name+"Params"];if(typeof l=="function"){const c=l(r);xi(o,c)}else typeof l=="object"&&xi(o,l);return xi(o,n),s?s(o):o}},_P={name:"dateComponent",mandatoryMethods:["getDate","setDate"],optionalMethods:["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled","refresh"]},EP={name:"dragAndDropImageComponent",mandatoryMethods:["setIcon","setLabel"]},TP={name:"headerComponent",optionalMethods:["refresh"]},kP={name:"innerHeaderComponent"},RP={name:"innerHeaderGroupComponent"},AP={name:"headerGroupComponent"},FP={name:"cellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},MP={name:"loadingCellRenderer",cellRenderer:!0},DP={name:"cellEditor",mandatoryMethods:["getValue"],optionalMethods:["isPopup","isCancelBeforeStart","isCancelAfterEnd","getPopupPosition","focusIn","focusOut","afterGuiAttached","refresh"]},PP={name:"tooltipComponent"},vy={name:"filter",mandatoryMethods:["isFilterActive","doesFilterPass","getModel","setModel"],optionalMethods:["afterGuiAttached","afterGuiDetached","onNewRowsLoaded","getModelAsString","onFloatingFilterChanged","onAnyFilterChanged","refresh"]},IP={name:"floatingFilterComponent",mandatoryMethods:["onParentModelChanged"],optionalMethods:["afterGuiAttached","refresh"]},OP={name:"fullWidthCellRenderer",optionalMethods:["refresh","afterGuiAttached"],cellRenderer:!0},NP={name:"loadingCellRenderer",cellRenderer:!0},LP={name:"groupRowRenderer",optionalMethods:["afterGuiAttached"],cellRenderer:!0},BP={name:"detailCellRenderer",optionalMethods:["refresh"],cellRenderer:!0};function HP(e,t){return e.getCompDetailsFromGridOptions(EP,"agDragAndDropImage",t,!0)}function jP(e,t,r){return e.getCompDetails(t,TP,"agColumnHeader",r)}function VP(e,t,r){return e.getCompDetails(t,kP,void 0,r)}function GP(e,t){const r=t.columnGroup.getColGroupDef();return e.getCompDetails(r,AP,"agColumnGroupHeader",t)}function zP(e,t,r){return e.getCompDetails(t,RP,void 0,r)}function UP(e,t){return e.getCompDetailsFromGridOptions(OP,void 0,t,!0)}function WP(e,t){return e.getCompDetailsFromGridOptions(NP,"agLoadingCellRenderer",t,!0)}function $P(e,t){return e.getCompDetailsFromGridOptions(LP,"agGroupRowRenderer",t,!0)}function qP(e,t){return e.getCompDetailsFromGridOptions(BP,"agDetailCellRenderer",t,!0)}function Y_(e,t,r){return e.getCompDetails(t,FP,void 0,r)}function Z_(e,t,r){return e.getCompDetails(t,MP,"agSkeletonCellRenderer",r,!0)}function vk(e,t,r){return e.getCompDetails(t,DP,"agCellEditor",r,!0)}function KP(e,t,r,n){const i=t.filter;return gk(i)&&(t={filter:i.component,filterParams:t.filterParams}),e.getCompDetails(t,vy,n,r,!0)}function XP(e,t,r){return e.getCompDetails(t,_P,"agDateInput",r,!0)}function YP(e,t){return e.getCompDetails(t.colDef,PP,"agTooltipComponent",t,!0)}function ZP(e,t,r,n){return e.getCompDetails(t,IP,n,r)}function bk(e,t){return mk(e,t,vy)}function G1(e,t,r){return e.mergeParams(t,vy,r)}function ff(e){const t=e;return t?.getFrameworkComponentInstance!=null?t.getFrameworkComponentInstance():e}function JP(e){return typeof e=="object"&&!!e.getComp}var $e={BACKSPACE:"Backspace",TAB:"Tab",ENTER:"Enter",ESCAPE:"Escape",SPACE:" ",LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown",DELETE:"Delete",F2:"F2",PAGE_UP:"PageUp",PAGE_DOWN:"PageDown",PAGE_HOME:"Home",PAGE_END:"End",A:"KeyA",C:"KeyC",D:"KeyD",V:"KeyV",X:"KeyX",Y:"KeyY",Z:"KeyZ"},QP=65,e7=67,t7=86,r7=68,n7=90,i7=89;function wk(e){const{keyCode:t}=e;let r;switch(t){case QP:r=$e.A;break;case e7:r=$e.C;break;case t7:r=$e.V;break;case r7:r=$e.D;break;case n7:r=$e.Z;break;case i7:r=$e.Y;break;default:r=e.code}return r}var by=class extends Sd{isPopup(){return!0}setParentComponent(e){e.addCss("ag-has-popup"),super.setParentComponent(e)}destroy(){const e=this.parentComponent;e?.isAlive()&&e.getGui().classList.remove("ag-has-popup"),super.destroy()}},z1,U1,W1,$1,sw,ow,q1;function bl(){return z1===void 0&&(z1=/^((?!chrome|android).)*safari/i.test(navigator.userAgent)),z1}function pf(){return U1===void 0&&(U1=/(firefox)/i.test(navigator.userAgent)),U1}function yk(){return W1===void 0&&(W1=/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)),W1}function ac(){return $1===void 0&&($1=/iPad|iPhone|iPod/.test(navigator.platform)||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1),$1}function aw(e){if(!e)return null;const t=e.tabIndex,r=e.getAttribute("tabIndex");return t===-1&&(r===null||r===""&&!pf())?null:t.toString()}function s7(){if(q1!==void 0)return q1;if(!document.body)return-1;let e=1e6;const t=pf()?6e6:1e9,r=document.createElement("div");for(document.body.appendChild(r);;){const n=e*2;if(r.style.height=n+"px",n>t||r.clientHeight!==n)break;e=n}return r.remove(),q1=e,e}function o7(){return ow==null&&Ck(),ow}function Ck(){const e=document.body,t=document.createElement("div");t.style.width=t.style.height="100px",t.style.opacity="0",t.style.overflow="scroll",t.style.msOverflowStyle="scrollbar",t.style.position="absolute",e.appendChild(t);let r=t.offsetWidth-t.clientWidth;r===0&&t.clientWidth===0&&(r=null),t.parentNode&&t.remove(),r!=null&&(ow=r,sw=r===0)}function xk(){return sw==null&&Ck(),sw}var lw=!1,x0=0;function a7(e){x0>0||(e.addEventListener("keydown",S0),e.addEventListener("mousedown",S0))}function l7(e){x0>0||(e.removeEventListener("keydown",S0),e.removeEventListener("mousedown",S0))}function S0(e){const t=lw,r=e.type==="keydown";r&&(e.ctrlKey||e.metaKey||e.altKey)||t!==r&&(lw=r)}function c7(e){const t=Gn(e);return a7(t),x0++,()=>{x0--,l7(t)}}function Sk(){return lw}function Xu(e,t,r=!1){const n=XM;let i=TT;t&&(i+=", "+t),r&&(i+=', [tabindex="-1"]');const s=Array.prototype.slice.apply(e.querySelectorAll(n)).filter(l=>da(l)),o=Array.prototype.slice.apply(e.querySelectorAll(i));return o.length?((l,c)=>l.filter(u=>c.indexOf(u)===-1))(s,o):s}function bc(e,t=!1,r=!1,n=!1){const i=Xu(e,n?".ag-tab-guard":null,r),s=t?zr(i):i[0];return s?(s.focus({preventScroll:!0}),!0):!1}function Mc(e,t,r,n){const i=Xu(t,r?':not([tabindex="-1"])':null),s=tn(e);let o;r?o=i.findIndex(l=>l.contains(s)):o=i.indexOf(s);const a=o+(n?-1:1);return a<0||a>=i.length?null:i[a]}function _k(e,t=5){let r=0;for(;e&&aw(e)===null&&++r<=t;)e=e.parentElement;return aw(e)===null?null:e}var u7="ag-focus-managed",Ek=class extends _i{constructor(e,t={isStopPropagation:()=>!1,stopPropagation:()=>{}},r={}){super(),this.eFocusable=e,this.stopPropagationCallbacks=t,this.callbacks=r,this.callbacks={shouldStopEventPropagation:()=>!1,onTabKeyDown:n=>{if(n.defaultPrevented)return;const i=Mc(this.beans,this.eFocusable,!1,n.shiftKey);i&&(i.focus(),n.preventDefault())},...r}}postConstruct(){const{eFocusable:e,callbacks:{onFocusIn:t,onFocusOut:r}}=this;e.classList.add(u7),this.addKeyDownListeners(e),t&&this.addManagedElementListeners(e,{focusin:t}),r&&this.addManagedElementListeners(e,{focusout:r})}addKeyDownListeners(e){this.addManagedElementListeners(e,{keydown:t=>{if(t.defaultPrevented||this.stopPropagationCallbacks.isStopPropagation(t))return;const{callbacks:r}=this;if(r.shouldStopEventPropagation(t)){this.stopPropagationCallbacks.stopPropagation(t);return}t.key===$e.TAB?r.onTabKeyDown(t):r.handleKeyDown&&r.handleKeyDown(t)}})}},Yu={TAB_GUARD:"ag-tab-guard",TAB_GUARD_TOP:"ag-tab-guard-top",TAB_GUARD_BOTTOM:"ag-tab-guard-bottom"},Tk=class extends _i{constructor(e,t){super(),this.stopPropagationCallbacks=t,this.skipTabGuardFocus=!1,this.forcingFocusOut=!1,this.allowFocus=!1;const{comp:r,eTopGuard:n,eBottomGuard:i,focusTrapActive:s,forceFocusOutWhenTabGuardsAreEmpty:o,isFocusableContainer:a,focusInnerElement:l,onFocusIn:c,onFocusOut:u,shouldStopEventPropagation:h,onTabKeyDown:d,handleKeyDown:f,isEmpty:m,eFocusableElement:v}=e;this.comp=r,this.eTopGuard=n,this.eBottomGuard=i,this.providedFocusInnerElement=l,this.eFocusableElement=v,this.focusTrapActive=!!s,this.forceFocusOutWhenTabGuardsAreEmpty=!!o,this.isFocusableContainer=!!a,this.providedFocusIn=c,this.providedFocusOut=u,this.providedShouldStopEventPropagation=h,this.providedOnTabKeyDown=d,this.providedHandleKeyDown=f,this.providedIsEmpty=m}postConstruct(){this.createManagedBean(new Ek(this.eFocusableElement,this.stopPropagationCallbacks,{shouldStopEventPropagation:()=>this.shouldStopEventPropagation(),onTabKeyDown:e=>this.onTabKeyDown(e),handleKeyDown:e=>this.handleKeyDown(e),onFocusIn:e=>this.onFocusIn(e),onFocusOut:e=>this.onFocusOut(e)})),this.activateTabGuards();for(const e of[this.eTopGuard,this.eBottomGuard])this.addManagedElementListeners(e,{focus:this.onFocus.bind(this)})}handleKeyDown(e){this.providedHandleKeyDown&&this.providedHandleKeyDown(e)}tabGuardsAreActive(){return!!this.eTopGuard&&this.eTopGuard.hasAttribute("tabIndex")}shouldStopEventPropagation(){return this.providedShouldStopEventPropagation?this.providedShouldStopEventPropagation():!1}activateTabGuards(){if(this.forcingFocusOut)return;const e=this.gos.get("tabIndex");this.comp.setTabIndex(e.toString())}deactivateTabGuards(){this.comp.setTabIndex()}onFocus(e){if(this.isFocusableContainer&&!this.eFocusableElement.contains(e.relatedTarget)&&!this.allowFocus){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.skipTabGuardFocus){this.skipTabGuardFocus=!1;return}if(this.forceFocusOutWhenTabGuardsAreEmpty&&(this.providedIsEmpty?this.providedIsEmpty():Xu(this.eFocusableElement,".ag-tab-guard").length===0)){this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard);return}if(this.isFocusableContainer&&this.eFocusableElement.contains(e.relatedTarget))return;const t=e.target===this.eBottomGuard;!(this.providedFocusInnerElement?this.providedFocusInnerElement(t):this.focusInnerElement(t))&&this.forceFocusOutWhenTabGuardsAreEmpty&&this.findNextElementOutsideAndFocus(e.target===this.eBottomGuard)}findNextElementOutsideAndFocus(e){const t=Gn(this.beans),r=Xu(t.body,null,!0),n=r.indexOf(e?this.eTopGuard:this.eBottomGuard);if(n===-1)return;let i,s;e?(i=0,s=n):(i=n+1,s=r.length);const o=r.slice(i,s),a=this.gos.get("tabIndex");o.sort((l,c)=>{const u=Number.parseInt(l.getAttribute("tabindex")||"0"),h=Number.parseInt(c.getAttribute("tabindex")||"0");return h===a?1:u===a?-1:u===0?1:h===0?-1:u-h}),o[e?o.length-1:0]?.focus()}onFocusIn(e){this.focusTrapActive||this.forcingFocusOut||(this.providedFocusIn&&this.providedFocusIn(e),this.isFocusableContainer||this.deactivateTabGuards())}onFocusOut(e){this.focusTrapActive||(this.providedFocusOut&&this.providedFocusOut(e),this.eFocusableElement.contains(e.relatedTarget)||this.activateTabGuards())}onTabKeyDown(e){if(this.providedOnTabKeyDown){this.providedOnTabKeyDown(e);return}if(this.focusTrapActive||e.defaultPrevented)return;const t=this.tabGuardsAreActive();t&&this.deactivateTabGuards();const r=this.getNextFocusableElement(e.shiftKey);t&&setTimeout(()=>this.activateTabGuards(),0),r&&(r.focus(),e.preventDefault())}focusInnerElement(e=!1){const t=Xu(this.eFocusableElement);return this.tabGuardsAreActive()&&(t.splice(0,1),t.splice(-1,1)),t.length?(t[e?t.length-1:0].focus({preventScroll:!0}),!0):!1}getNextFocusableElement(e){return Mc(this.beans,this.eFocusableElement,!1,e)}forceFocusOutOfContainer(e=!1){if(this.forcingFocusOut)return;const t=e?this.eTopGuard:this.eBottomGuard;this.activateTabGuards(),this.skipTabGuardFocus=!0,this.forcingFocusOut=!0,t.focus(),window.setTimeout(()=>{this.forcingFocusOut=!1,this.activateTabGuards()})}isTabGuard(e,t){return e===this.eTopGuard&&!t||e===this.eBottomGuard&&(t??!0)}setAllowFocus(e){this.allowFocus=e}},d7=class{constructor(e){this.tickingInterval=null,this.onScrollCallback=null,this.scrollContainer=e.scrollContainer,this.scrollHorizontally=e.scrollAxis.includes("x"),this.scrollVertically=e.scrollAxis.includes("y"),this.scrollByTick=e.scrollByTick??20,e.onScrollCallback&&(this.onScrollCallback=e.onScrollCallback),this.scrollVertically&&(this.getVerticalPosition=e.getVerticalPosition,this.setVerticalPosition=e.setVerticalPosition),this.scrollHorizontally&&(this.getHorizontalPosition=e.getHorizontalPosition,this.setHorizontalPosition=e.setHorizontalPosition),this.shouldSkipVerticalScroll=e.shouldSkipVerticalScroll||(()=>!1),this.shouldSkipHorizontalScroll=e.shouldSkipHorizontalScroll||(()=>!1)}get scrolling(){return this.tickingInterval!==null}check(e,t=!1){const r=t||this.shouldSkipVerticalScroll();if(r&&this.shouldSkipHorizontalScroll())return;const n=this.scrollContainer.getBoundingClientRect(),i=this.scrollByTick;this.tickLeft=e.clientX<n.left+i,this.tickRight=e.clientX>n.right-i,this.tickUp=e.clientY<n.top+i&&!r,this.tickDown=e.clientY>n.bottom-i&&!r,this.tickLeft||this.tickRight||this.tickUp||this.tickDown?this.ensureTickingStarted():this.ensureCleared()}ensureTickingStarted(){this.tickingInterval===null&&(this.tickingInterval=window.setInterval(this.doTick.bind(this),100),this.tickCount=0)}doTick(){this.tickCount++;const e=this.tickCount>20?200:this.tickCount>10?80:40;if(this.scrollVertically){const t=this.getVerticalPosition();this.tickUp&&this.setVerticalPosition(t-e),this.tickDown&&this.setVerticalPosition(t+e)}if(this.scrollHorizontally){const t=this.getHorizontalPosition();this.tickLeft&&this.setHorizontalPosition(t-e),this.tickRight&&this.setHorizontalPosition(t+e)}this.onScrollCallback&&this.onScrollCallback()}ensureCleared(){this.tickingInterval&&(window.clearInterval(this.tickingInterval),this.tickingInterval=null)}},kk="ag-resizer-wrapper",Wa=(e,t)=>({tag:"div",ref:`${e}Resizer`,cls:`ag-resizer ag-resizer-${t}`}),h7={tag:"div",cls:kk,children:[Wa("eTopLeft","topLeft"),Wa("eTop","top"),Wa("eTopRight","topRight"),Wa("eRight","right"),Wa("eBottomRight","bottomRight"),Wa("eBottom","bottom"),Wa("eBottomLeft","bottomLeft"),Wa("eLeft","left")]},f7=class extends _i{constructor(e,t){super(),this.element=e,this.dragStartPosition={x:0,y:0},this.position={x:0,y:0},this.lastSize={width:-1,height:-1},this.positioned=!1,this.resizersAdded=!1,this.resizeListeners=[],this.boundaryEl=null,this.isResizing=!1,this.isMoving=!1,this.resizable={},this.movable=!1,this.currentResizer=null,this.config={popup:!1,...t}}wireBeans(e){this.popupSvc=e.popupSvc,this.dragSvc=e.dragSvc}center(e){const{clientHeight:t,clientWidth:r}=this.offsetParent,n=r/2-this.getWidth()/2,i=t/2-this.getHeight()/2;this.offsetElement(n,i,e)}initialisePosition(e){if(this.positioned)return;const{centered:t,forcePopupParentAsOffsetParent:r,minWidth:n,width:i,minHeight:s,height:o,x:a,y:l}=this.config;this.offsetParent||this.setOffsetParent();let c=0,u=0;const h=da(this.element);if(h){const d=this.findBoundaryElement(),f=window.getComputedStyle(d);if(f.minWidth!=null){const m=d.offsetWidth-this.element.offsetWidth;u=Number.parseInt(f.minWidth,10)-m}if(f.minHeight!=null){const m=d.offsetHeight-this.element.offsetHeight;c=Number.parseInt(f.minHeight,10)-m}}if(this.minHeight=s||c,this.minWidth=n||u,i&&this.setWidth(i),o&&this.setHeight(o),(!i||!o)&&this.refreshSize(),t)this.center(e);else if(a||l)this.offsetElement(a,l,e);else if(h&&r){let d=this.boundaryEl,f=!0;if(d||(d=this.findBoundaryElement(),f=!1),d){const m=Number.parseFloat(d.style.top),v=Number.parseFloat(d.style.left);f?this.offsetElement(Number.isNaN(v)?0:v,Number.isNaN(m)?0:m,e):this.setPosition(v,m)}}this.positioned=!!this.offsetParent}isPositioned(){return this.positioned}getPosition(){return this.position}setMovable(e,t){if(!this.config.popup||e===this.movable)return;this.movable=e;const r=this.moveElementDragListener||{eElement:t,onDragStart:this.onMoveStart.bind(this),onDragging:this.onMove.bind(this),onDragStop:this.onMoveEnd.bind(this)};e?(this.dragSvc?.addDragSource(r),this.moveElementDragListener=r):(this.dragSvc?.removeDragSource(r),this.moveElementDragListener=void 0)}setResizable(e){if(this.clearResizeListeners(),e?this.addResizers():this.removeResizers(),typeof e=="boolean"){if(e===!1)return;e={topLeft:e,top:e,topRight:e,right:e,bottomRight:e,bottom:e,bottomLeft:e,left:e}}for(const t of Object.keys(e)){const r=!!e[t],n=this.getResizerElement(t),i={dragStartPixels:0,eElement:n,onDragStart:s=>this.onResizeStart(s,t),onDragging:this.onResize.bind(this),onDragStop:s=>this.onResizeEnd(s,t)};(r||!this.isAlive()&&!r)&&(r?(this.dragSvc?.addDragSource(i),this.resizeListeners.push(i),n.style.pointerEvents="all"):n.style.pointerEvents="none",this.resizable[t]=r)}}removeSizeFromEl(){this.element.style.removeProperty("height"),this.element.style.removeProperty("width"),this.element.style.removeProperty("flex")}restoreLastSize(){this.element.style.flex="0 0 auto";const{height:e,width:t}=this.lastSize;t!==-1&&(this.element.style.width=`${t}px`),e!==-1&&(this.element.style.height=`${e}px`)}getHeight(){return this.element.offsetHeight}setHeight(e){const{popup:t}=this.config,r=this.element;let n=!1;if(typeof e=="string"&&e.includes("%"))Vh(r,e),e=kT(r),n=!0;else if(e=Math.max(this.minHeight,e),this.positioned){const i=this.getAvailableHeight();i&&e>i&&(e=i)}this.getHeight()!==e&&(n?(r.style.maxHeight="unset",r.style.minHeight="unset"):t?Vh(r,e):(r.style.height=`${e}px`,r.style.flex="0 0 auto",this.lastSize.height=typeof e=="number"?e:Number.parseFloat(e)))}getAvailableHeight(){const{popup:e,forcePopupParentAsOffsetParent:t}=this.config;this.positioned||this.initialisePosition();const{clientHeight:r}=this.offsetParent;if(!r)return null;const n=this.element.getBoundingClientRect(),i=this.offsetParent.getBoundingClientRect(),s=e?this.position.y:n.top,o=e?0:i.top;let a=0;if(t){const c=this.element.parentElement;if(c){const{bottom:u}=c.getBoundingClientRect();a=u-n.bottom}}return r+o-s-a}getWidth(){return this.element.offsetWidth}setWidth(e){const t=this.element,{popup:r}=this.config;let n=!1;if(typeof e=="string"&&e.includes("%"))So(t,e),e=u0(t),n=!0;else if(this.positioned){e=Math.max(this.minWidth,e);const{clientWidth:i}=this.offsetParent,s=r?this.position.x:this.element.getBoundingClientRect().left;i&&e+s>i&&(e=i-s)}this.getWidth()!==e&&(n?(t.style.maxWidth="unset",t.style.minWidth="unset"):this.config.popup?So(t,e):(t.style.width=`${e}px`,t.style.flex=" unset",this.lastSize.width=typeof e=="number"?e:Number.parseFloat(e)))}offsetElement(e=0,t=0,r){const{forcePopupParentAsOffsetParent:n}=this.config,i=n?this.boundaryEl:this.element;i&&(this.popupSvc?.positionPopup({ePopup:i,keepWithinBounds:!0,skipObserver:this.movable||this.isResizable(),updatePosition:()=>({x:e,y:t}),postProcessCallback:r}),this.setPosition(Number.parseFloat(i.style.left),Number.parseFloat(i.style.top)))}constrainSizeToAvailableHeight(e){if(!this.config.forcePopupParentAsOffsetParent)return;const t=()=>{const r=this.getAvailableHeight();this.element.style.setProperty("max-height",`${r}px`)};e&&this.popupSvc?(this.resizeObserverSubscriber?.(),this.resizeObserverSubscriber=ha(this.beans,this.popupSvc?.getPopupParent(),t)):(this.element.style.removeProperty("max-height"),this.resizeObserverSubscriber&&(this.resizeObserverSubscriber(),this.resizeObserverSubscriber=void 0))}setPosition(e,t){this.position.x=e,this.position.y=t}updateDragStartPosition(e,t){this.dragStartPosition={x:e,y:t}}calculateMouseMovement(e){const{e:t,isLeft:r,isTop:n,anywhereWithin:i,topBuffer:s}=e,o=t.clientX-this.dragStartPosition.x,a=t.clientY-this.dragStartPosition.y,l=this.shouldSkipX(t,!!r,!!i,o)?0:o,c=this.shouldSkipY(t,!!n,s,a)?0:a;return{movementX:l,movementY:c}}shouldSkipX(e,t,r,n){const i=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.x:i.left;let l=a<=0&&s.left>=e.clientX||s.right<=e.clientX&&s.right<=o.right;return l?!0:(t?l=n<0&&e.clientX>a+s.left||n>0&&e.clientX<a+s.left:r?l=n<0&&e.clientX>o.right||n>0&&e.clientX<a+s.left:l=n<0&&e.clientX>o.right||n>0&&e.clientX<o.right,l)}shouldSkipY(e,t,r=0,n){const i=this.element.getBoundingClientRect(),s=this.offsetParent.getBoundingClientRect(),o=this.boundaryEl.getBoundingClientRect(),a=this.config.popup?this.position.y:i.top;let l=a<=0&&s.top>=e.clientY||s.bottom<=e.clientY&&s.bottom<=o.bottom;return l?!0:(t?l=n<0&&e.clientY>a+s.top+r||n>0&&e.clientY<a+s.top:l=n<0&&e.clientY>o.bottom||n>0&&e.clientY<o.bottom,l)}createResizeMap(){const e=t=>({element:this.element.querySelector(`[data-ref=${t}Resizer]`)});this.resizerMap={topLeft:e("eTopLeft"),top:e("eTop"),topRight:e("eTopRight"),right:e("eRight"),bottomRight:e("eBottomRight"),bottom:e("eBottom"),bottomLeft:e("eBottomLeft"),left:e("eLeft")}}addResizers(){if(this.resizersAdded)return;const e=this.element;e&&(e.appendChild(nl(h7)),this.createResizeMap(),this.resizersAdded=!0)}removeResizers(){this.resizerMap=void 0,this.element.querySelector(`.${kk}`)?.remove(),this.resizersAdded=!1}getResizerElement(e){return this.resizerMap[e].element}onResizeStart(e,t){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.currentResizer={isTop:!!t.match(/top/i),isRight:!!t.match(/right/i),isBottom:!!t.match(/bottom/i),isLeft:!!t.match(/left/i)},this.element.classList.add("ag-resizing"),this.resizerMap[t].element.classList.add("ag-active");const{popup:r,forcePopupParentAsOffsetParent:n}=this.config;!r&&!n&&this.applySizeToSiblings(this.currentResizer.isBottom||this.currentResizer.isTop),this.isResizing=!0,this.updateDragStartPosition(e.clientX,e.clientY)}getSiblings(){const t=this.element.parentElement;return t?Array.prototype.slice.call(t.children).filter(r=>!r.classList.contains("ag-hidden")):null}getMinSizeOfSiblings(){const e=this.getSiblings()||[];let t=0,r=0;for(const n of e){const i=!!n.style.flex&&n.style.flex!=="0 0 auto";if(n===this.element)continue;let s=this.minHeight||0,o=this.minWidth||0;if(i){const a=window.getComputedStyle(n);a.minHeight&&(s=Number.parseInt(a.minHeight,10)),a.minWidth&&(o=Number.parseInt(a.minWidth,10))}else s=n.offsetHeight,o=n.offsetWidth;t+=s,r+=o}return{height:t,width:r}}applySizeToSiblings(e){let t=null;const r=this.getSiblings();if(r){for(let n=0;n<r.length;n++){const i=r[n];i!==t&&(e?i.style.height=`${i.offsetHeight}px`:i.style.width=`${i.offsetWidth}px`,i.style.flex="0 0 auto",i===this.element&&(t=r[n+1]))}t&&(t.style.removeProperty("height"),t.style.removeProperty("min-height"),t.style.removeProperty("max-height"),t.style.flex="1 1 auto")}}isResizable(){return Object.values(this.resizable).some(e=>e)}onResize(e){if(!this.isResizing||!this.currentResizer)return;const{popup:t,forcePopupParentAsOffsetParent:r}=this.config,{isTop:n,isRight:i,isBottom:s,isLeft:o}=this.currentResizer,a=i||o,l=s||n,{movementX:c,movementY:u}=this.calculateMouseMovement({e,isLeft:o,isTop:n}),h=this.position.x,d=this.position.y;let f=0,m=0;if(a&&c){const v=o?-1:1,g=this.getWidth(),w=g+c*v;let y=!1;o&&(f=g-w,(h+f<=0||w<=this.minWidth)&&(y=!0,f=0)),y||this.setWidth(w)}if(l&&u){const v=n?-1:1,g=this.getHeight(),w=g+u*v;let y=!1;n?(m=g-w,(d+m<=0||w<=this.minHeight)&&(y=!0,m=0)):!this.config.popup&&!this.config.forcePopupParentAsOffsetParent&&g<w&&this.getMinSizeOfSiblings().height+w>this.element.parentElement.offsetHeight&&(y=!0),y||this.setHeight(w)}this.updateDragStartPosition(e.clientX,e.clientY),((t||r)&&f||m)&&this.offsetElement(h+f,d+m)}onResizeEnd(e,t){this.isResizing=!1,this.currentResizer=null,this.boundaryEl=null,this.element.classList.remove("ag-resizing"),this.resizerMap[t].element.classList.remove("ag-active"),this.dispatchLocalEvent({type:"resize"})}refreshSize(){const e=this.element;this.config.popup&&(this.config.width||this.setWidth(e.offsetWidth),this.config.height||this.setHeight(e.offsetHeight))}onMoveStart(e){this.boundaryEl=this.findBoundaryElement(),this.positioned||this.initialisePosition(),this.isMoving=!0,this.element.classList.add("ag-moving"),this.updateDragStartPosition(e.clientX,e.clientY)}onMove(e){if(!this.isMoving)return;const{x:t,y:r}=this.position;let n;this.config.calculateTopBuffer&&(n=this.config.calculateTopBuffer());const{movementX:i,movementY:s}=this.calculateMouseMovement({e,isTop:!0,anywhereWithin:!0,topBuffer:n});this.offsetElement(t+i,r+s),this.updateDragStartPosition(e.clientX,e.clientY)}onMoveEnd(){this.isMoving=!1,this.boundaryEl=null,this.element.classList.remove("ag-moving")}setOffsetParent(){this.config.forcePopupParentAsOffsetParent&&this.popupSvc?this.offsetParent=this.popupSvc.getPopupParent():this.offsetParent=this.element.offsetParent}findBoundaryElement(){let e=this.element;for(;e;){if(window.getComputedStyle(e).position!=="static")return e;e=e.parentElement}return this.element}clearResizeListeners(){for(;this.resizeListeners.length;){const e=this.resizeListeners.pop();this.dragSvc?.removeDragSource(e)}}destroy(){super.destroy(),this.moveElementDragListener&&this.dragSvc?.removeDragSource(this.moveElementDragListener),this.constrainSizeToAvailableHeight(!1),this.clearResizeListeners(),this.removeResizers()}},wy="T",p7=new RegExp(`[${wy} ]`),g7=new RegExp(`^\\d{4}-\\d{2}-\\d{2}(${wy}\\d{2}:\\d{2}:\\d{2}\\D?)?`);function po(e,t){return e.toString().padStart(t,"0")}function ns(e,t=!0,r=wy){if(!e)return null;let n=[e.getFullYear(),e.getMonth()+1,e.getDate()].map(i=>po(i,2)).join("-");return t&&(n+=r+[e.getHours(),e.getMinutes(),e.getSeconds()].map(i=>po(i,2)).join(":")),n}function fg(e,t=!0){return e?t?[String(e.getFullYear()),String(e.getMonth()+1),po(e.getDate(),2),po(e.getHours(),2),`:${po(e.getMinutes(),2)}`,`:${po(e.getSeconds(),2)}`]:[e.getFullYear(),e.getMonth()+1,po(e.getDate(),2)].map(String):null}var K1=e=>{if(e>3&&e<21)return"th";switch(e%10){case 1:return"st";case 2:return"nd";case 3:return"rd"}return"th"},J_=["January","February","March","April","May","June","July","August","September","October","November","December"],X1=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function cw(e,t){if(t==null)return ns(e,!1);const r=po(e.getFullYear(),4),n={YYYY:()=>r.slice(r.length-4,r.length),YY:()=>r.slice(r.length-2,r.length),Y:()=>`${e.getFullYear()}`,MMMM:()=>J_[e.getMonth()],MMM:()=>J_[e.getMonth()].slice(0,3),MM:()=>po(e.getMonth()+1,2),Mo:()=>`${e.getMonth()+1}${K1(e.getMonth()+1)}`,M:()=>`${e.getMonth()+1}`,Do:()=>`${e.getDate()}${K1(e.getDate())}`,DD:()=>po(e.getDate(),2),D:()=>`${e.getDate()}`,dddd:()=>X1[e.getDay()],ddd:()=>X1[e.getDay()].slice(0,3),dd:()=>X1[e.getDay()].slice(0,2),do:()=>`${e.getDay()}${K1(e.getDay())}`,d:()=>`${e.getDay()}`},i=new RegExp(Object.keys(n).join("|"),"g");return t.replace(i,s=>s in n?n[s]():s)}function Qg(e,t=!1){return!!ji(e,t)}function m7(e){return Qg(e,!0)}function ji(e,t=!1,r){if(!e||!r&&!g7.test(e))return null;const[n,i]=e.split(p7);if(!n)return null;const s=n.split("-").map(f=>Number.parseInt(f,10));if(s.filter(f=>!isNaN(f)).length!==3)return null;const[o,a,l]=s,c=new Date(o,a-1,l);if(c.getFullYear()!==o||c.getMonth()!==a-1||c.getDate()!==l||!i&&t)return null;if(!i||i==="00:00:00")return c;const[u,h,d]=i.split(":").map(f=>Number.parseInt(f,10));if(u>=0&&u<24)c.setHours(u);else if(t)return null;if(h>=0&&h<60)c.setMinutes(h);else if(t)return null;if(d>=0&&d<60)c.setSeconds(d);else if(t)return null;return c}function uw(e){const{inputValue:t,allSuggestions:r,hideIrrelevant:n,filterByPercentageOfBestMatch:i}=e;let s=(r??[]).map((l,c)=>({value:l,relevance:v7(t,l),idx:c}));if(s.sort((l,c)=>l.relevance-c.relevance),n&&(s=s.filter(l=>l.relevance<Math.max(l.value.length,t.length))),s.length>0&&i&&i>0){const c=s[0].relevance*i;s=s.filter(u=>c-u.relevance<0)}const o=[],a=[];for(const l of s)o.push(l.value),a.push(l.idx);return{values:o,indices:a}}function v7(e,t){const r=e.length,n=t.length;if(n===0)return r||0;let i=e.toLocaleLowerCase(),s=t.toLocaleLowerCase(),o;e.length<t.length&&(o=s,s=i,i=o,o=t,t=e,e=o);let a=new Uint16Array(n+1),l=new Uint16Array(n+1);for(let h=0;h<=n;h++)a[h]=h;let c=0;const u=r/2-10;for(let h=1;h<=r;h++){const d=e[h-1],f=i[h-1];l[0]=h;for(let m=1;m<=n;m++){const v=t[m-1],g=s[m-1];if(f!==g){const w=l[m-1],y=a[m],C=a[m-1];let k=w<y?w:y;C<k&&(k=C),l[m]=k+1|0;continue}if(c++,d===v&&c++,h>1&&m>1){const w=e[h-2],y=i[h-2],C=t[m-2],k=s[m-2];y===k&&(c++,w===C&&c++)}h<u&&c++,l[m]=a[m-1]}o=a,a=l,l=o}return a[n]/(c+1)}function Rk(e){return e.altKey||e.ctrlKey||e.metaKey?!1:e.key?.length===1}var b7=".ag-label{white-space:nowrap}:where(.ag-ltr) .ag-label{margin-right:var(--ag-spacing)}:where(.ag-rtl) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-label-align-right) .ag-label{order:1}:where(.ag-ltr) :where(.ag-label-align-right) .ag-label{margin-left:var(--ag-spacing)}:where(.ag-rtl) :where(.ag-label-align-right) .ag-label{margin-right:var(--ag-spacing)}.ag-label-align-right>*{flex:none}.ag-label-align-top{align-items:flex-start;flex-direction:column;>*{align-self:stretch}}.ag-label-ellipsis{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:where(.ag-label-align-top) .ag-label{margin-bottom:calc(var(--ag-spacing)*.5)}",w7=class extends Sd{constructor(e,t,r){super(t,r),this.labelSeparator="",this.labelAlignment="left",this.disabled=!1,this.label="",this.config=e||{},this.registerCSS(b7)}postConstruct(){this.addCss("ag-labeled"),this.eLabel.classList.add("ag-label");const{labelSeparator:e,label:t,labelWidth:r,labelAlignment:n,disabled:i,labelEllipsis:s}=this.config;i!=null&&this.setDisabled(i),e!=null&&this.setLabelSeparator(e),t!=null&&this.setLabel(t),r!=null&&this.setLabelWidth(r),s!=null&&this.setLabelEllipsis(s),this.setLabelAlignment(n||this.labelAlignment),this.refreshLabel()}refreshLabel(){const{label:e,eLabel:t}=this;Hi(t),typeof e=="string"?t.innerText=e+this.labelSeparator:e&&t.appendChild(e),e===""?(Gr(t,!1),gc(t,"presentation")):(Gr(t,!0),gc(t,null))}setLabelSeparator(e){return this.labelSeparator===e?this:(this.labelSeparator=e,this.label!=null&&this.refreshLabel(),this)}getLabelId(){const e=this.eLabel;return e.id=e.id||`ag-${this.getCompId()}-label`,e.id}getLabel(){return this.label}setLabel(e){return this.label===e?this:(this.label=e,this.refreshLabel(),this)}setLabelAlignment(e){const r=this.getGui().classList;return r.toggle("ag-label-align-left",e==="left"),r.toggle("ag-label-align-right",e==="right"),r.toggle("ag-label-align-top",e==="top"),this}setLabelEllipsis(e){return this.eLabel.classList.toggle("ag-label-ellipsis",e),this}setLabelWidth(e){return this.label==null?this:(f0(this.eLabel,e),this)}setDisabled(e){e=!!e;const t=this.getGui();return lf(t,e),t.classList.toggle("ag-disabled",e),this.disabled=e,this}isDisabled(){return!!this.disabled}},Ak=class extends w7{constructor(e,t,r,n){super(e,t,r),this.className=n}postConstruct(){super.postConstruct();const{width:e,value:t,onValueChange:r,ariaLabel:n}=this.config;e!=null&&this.setWidth(e),t!=null&&this.setValue(t),r!=null&&this.onValueChange(r),n!=null&&this.setAriaLabel(n),this.className&&this.addCss(this.className),this.refreshAriaLabelledBy()}setLabel(e){return super.setLabel(e),this.refreshAriaLabelledBy(),this}refreshAriaLabelledBy(){const e=this.getAriaElement(),t=this.getLabelId(),r=this.getLabel();r==null||r==""||OM(e)!==null?af(e,""):af(e,t??"")}setAriaLabel(e){return ad(this.getAriaElement(),e),this.refreshAriaLabelledBy(),this}onValueChange(e){return this.addManagedListeners(this,{fieldValueChanged:()=>e(this.getValue())}),this}getWidth(){return this.getGui().clientWidth}setWidth(e){return So(this.getGui(),e),this}getPreviousValue(){return this.previousValue}getValue(){return this.value}setValue(e,t){return this.value===e?this:(this.previousValue=this.value,this.value=e,t||this.dispatchLocalEvent({type:"fieldValueChanged"}),this)}};function y7(e){return{tag:"div",role:"presentation",children:[{tag:"div",ref:"eLabel",cls:"ag-input-field-label"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-input-wrapper",role:"presentation",children:[{tag:e,ref:"eInput",cls:"ag-input-field-input"}]}]}}var ec=class extends Ak{constructor(e,t,r="text",n="input"){super(e,e?.template??y7(n),[],t),this.inputType=r,this.displayFieldTag=n,this.eLabel=xt,this.eWrapper=xt,this.eInput=xt}postConstruct(){super.postConstruct(),this.setInputType(this.inputType);const{eLabel:e,eWrapper:t,eInput:r,className:n}=this;e.classList.add(`${n}-label`),t.classList.add(`${n}-input-wrapper`),r.classList.add(`${n}-input`),this.addCss("ag-input-field"),r.id=r.id||`ag-${this.getCompId()}-input`;const{inputName:i,inputWidth:s,inputPlaceholder:o,autoComplete:a,tabIndex:l}=this.config;i!=null&&this.setInputName(i),s!=null&&this.setInputWidth(s),o!=null&&this.setInputPlaceholder(o),a!=null&&this.setAutoComplete(a),this.addInputListeners(),this.activateTabIndex([r],l)}addInputListeners(){this.addManagedElementListeners(this.eInput,{input:e=>this.setValue(e.target.value)})}setInputType(e){this.displayFieldTag==="input"&&(this.inputType=e,Oi(this.eInput,"type",e))}getInputElement(){return this.eInput}getWrapperElement(){return this.eWrapper}setInputWidth(e){return f0(this.eWrapper,e),this}setInputName(e){return this.getInputElement().setAttribute("name",e),this}getFocusableElement(){return this.eInput}setMaxLength(e){const t=this.eInput;return t.maxLength=e,this}setInputPlaceholder(e){return Oi(this.eInput,"placeholder",e),this}setInputAriaLabel(e){return ad(this.eInput,e),this.refreshAriaLabelledBy(),this}setDisabled(e){return lf(this.eInput,e),super.setDisabled(e)}setAutoComplete(e){if(e===!0)Oi(this.eInput,"autocomplete",null);else{const t=typeof e=="string"?e:"off";Oi(this.eInput,"autocomplete",t)}return this}},yy=class extends ec{constructor(e,t="ag-checkbox",r="checkbox"){super(e,t,r),this.labelAlignment="right",this.selected=!1,this.readOnly=!1,this.passive=!1}postConstruct(){super.postConstruct();const{readOnly:e,passive:t,name:r}=this.config;typeof e=="boolean"&&this.setReadOnly(e),typeof t=="boolean"&&this.setPassive(t),r!=null&&this.setName(r)}addInputListeners(){this.addManagedElementListeners(this.eInput,{click:this.onCheckboxClick.bind(this)}),this.addManagedElementListeners(this.eLabel,{click:this.toggle.bind(this)})}getNextValue(){return this.selected===void 0?!0:!this.selected}setPassive(e){this.passive=e}isReadOnly(){return this.readOnly}setReadOnly(e){this.eWrapper.classList.toggle("ag-disabled",e),this.eInput.disabled=e,this.readOnly=e}setDisabled(e){return this.eWrapper.classList.toggle("ag-disabled",e),super.setDisabled(e)}toggle(){if(this.eInput.disabled)return;const e=this.isSelected(),t=this.getNextValue();this.passive?this.dispatchChange(t,e):this.setValue(t)}getValue(){return this.isSelected()}setValue(e,t){return this.refreshSelectedClass(e),this.setSelected(e,t),this}setName(e){const t=this.getInputElement();return t.name=e,this}isSelected(){return this.selected}setSelected(e,t){if(this.isSelected()===e)return;this.previousValue=this.isSelected(),e=this.selected=typeof e=="boolean"?e:void 0;const r=this.eInput;r.checked=e,r.indeterminate=e===void 0,t||this.dispatchChange(this.selected,this.previousValue)}dispatchChange(e,t,r){this.dispatchLocalEvent({type:"fieldValueChanged",selected:e,previousValue:t,event:r});const n=this.getInputElement();this.eventSvc.dispatchEvent({type:"checkboxChanged",id:n.id,name:n.name,selected:e,previousValue:t})}onCheckboxClick(e){if(this.passive||this.eInput.disabled)return;const t=this.isSelected(),r=this.selected=e.target.checked;this.refreshSelectedClass(r),this.dispatchChange(r,t,e)}refreshSelectedClass(e){const t=this.eWrapper.classList;t.toggle("ag-checked",e===!0),t.toggle("ag-indeterminate",e==null)}},Cy={selector:"AG-CHECKBOX",component:yy},C7=class extends yy{constructor(e){super(e,"ag-radio-button","radio")}isSelected(){return this.eInput.checked}toggle(){this.eInput.disabled||this.isSelected()||this.setValue(!0)}addInputListeners(){super.addInputListeners(),this.addManagedEventListeners({checkboxChanged:this.onChange.bind(this)})}onChange(e){const t=this.eInput;e.selected&&e.name&&t.name&&t.name===e.name&&e.id&&t.id!==e.id&&this.setValue(!1,!0)}},Dc=class extends ec{constructor(e,t="ag-text-field",r="text"){super(e,t,r)}postConstruct(){super.postConstruct(),this.config.allowedCharPattern&&this.preventDisallowedCharacters()}setValue(e,t){const r=this.eInput;return r.value!==e&&(r.value=bt(e)?e:""),super.setValue(e,t)}setStartValue(e){this.setValue(e,!0)}setCustomValidity(e){const t=this.eInput,r=e.length>0;t.setCustomValidity(e),r&&t.reportValidity(),ny(t,r)}preventDisallowedCharacters(){const e=new RegExp(`[${this.config.allowedCharPattern}]`),t=r=>{Rk(r)&&r.key&&!e.test(r.key)&&r.preventDefault()};this.addManagedListeners(this.eInput,{keydown:t,paste:r=>{r.clipboardData?.getData("text")?.split("").some(i=>!e.test(i))&&r.preventDefault()}})}},sm={selector:"AG-INPUT-TEXT-FIELD",component:Dc},x7=class extends ec{constructor(e){super(e,"ag-text-area",null,"textarea")}setValue(e,t){const r=super.setValue(e,t);return this.eInput.value=e,r}setCols(e){return this.eInput.cols=e,this}setRows(e){return this.eInput.rows=e,this}},S7={selector:"AG-INPUT-TEXT-AREA",component:x7},xy=class extends Dc{constructor(e){super(e,"ag-number-field","number")}postConstruct(){super.postConstruct();const e=this.eInput;this.addManagedListeners(e,{blur:()=>{const s=Number.parseFloat(e.value),o=isNaN(s)?"":this.normalizeValue(s.toString());this.value!==o&&this.setValue(o)},wheel:this.onWheel.bind(this)}),e.step="any";const{precision:t,min:r,max:n,step:i}=this.config;typeof t=="number"&&this.setPrecision(t),typeof r=="number"&&this.setMin(r),typeof n=="number"&&this.setMax(n),typeof i=="number"&&this.setStep(i)}onWheel(e){tn(this.beans)===this.eInput&&e.preventDefault()}normalizeValue(e){return e===""?"":(this.precision!=null&&(e=this.adjustPrecision(e)),e)}adjustPrecision(e,t){const r=this.precision;if(r==null)return e;if(t){const i=Number.parseFloat(e).toFixed(r);return Number.parseFloat(i).toString()}const n=String(e).split(".");if(n.length>1){if(n[1].length<=r)return e;if(r>0)return`${n[0]}.${n[1].slice(0,r)}`}return n[0]}setMin(e){return this.min===e?this:(this.min=e,Oi(this.eInput,"min",e),this)}setMax(e){return this.max===e?this:(this.max=e,Oi(this.eInput,"max",e),this)}setPrecision(e){return this.precision=e,this}setStep(e){return this.step===e?this:(this.step=e,Oi(this.eInput,"step",e),this)}setValue(e,t){return this.setValueOrInputValue(r=>super.setValue(r,t),()=>this,e)}setStartValue(e){return this.setValueOrInputValue(t=>super.setValue(t,!0),t=>{this.eInput.value=t},e)}setValueOrInputValue(e,t,r){if(bt(r)){let n=this.isScientificNotation(r);if(n&&this.eInput.validity.valid)return e(r);if(!n){r=this.adjustPrecision(r);const i=this.normalizeValue(r);n=r!=i}if(n)return t(r)}return e(r)}getValue(e=!1){const t=this.eInput;if(!t.validity.valid&&!e)return;const r=t.value;return this.isScientificNotation(r)?this.adjustPrecision(r,!0):super.getValue()}isScientificNotation(e){return typeof e=="string"&&e.includes("e")}},_7={selector:"AG-INPUT-NUMBER-FIELD",component:xy},E7=class extends Dc{constructor(e){super(e,"ag-date-field","date")}postConstruct(){super.postConstruct();const e=bl();this.addManagedListeners(this.eInput,{wheel:this.onWheel.bind(this),mousedown:()=>{this.isDisabled()||e||this.eInput.focus()}}),this.eInput.step="any"}onWheel(e){tn(this.beans)===this.eInput&&e.preventDefault()}setMin(e){const t=e instanceof Date?ns(e??null,!!this.includeTime)??void 0:e;return this.min===t?this:(this.min=t,Oi(this.eInput,"min",t),this)}setMax(e){const t=e instanceof Date?ns(e??null,!!this.includeTime)??void 0:e;return this.max===t?this:(this.max=t,Oi(this.eInput,"max",t),this)}setStep(e){return this.step===e?this:(this.step=e,Oi(this.eInput,"step",e),this)}setIncludeTime(e){return this.includeTime===e?this:(this.includeTime=e,super.setInputType(e?"datetime-local":"date"),e&&this.setStep(1),this)}getDate(){if(this.eInput.validity.valid)return ji(this.getValue())??void 0}setDate(e,t){this.setValue(ns(e??null,this.includeTime),t)}},Fk={selector:"AG-INPUT-DATE-FIELD",component:E7},T7=".ag-list-item{align-items:center;display:flex;height:var(--ag-list-item-height);overflow:hidden;text-overflow:ellipsis;white-space:nowrap;&.ag-active-item{background-color:var(--ag-row-hover-color)}}",k7="ag-active-item",R7=(e,t)=>({tag:"div",cls:`ag-list-item ag-${e}-list-item`,attrs:{role:"option"},children:[{tag:"span",ref:"eText",children:t}]}),A7=class extends Sd{constructor(e,t,r){super(R7(e,t)),this.label=t,this.value=r,this.eText=xt}postConstruct(){this.createTooltip(),this.addEventListeners()}setHighlighted(e){const t=this.getGui();t.classList.toggle(k7,e),ET(t,e),this.dispatchLocalEvent({type:"itemHighlighted",highlighted:e})}getHeight(){return this.getGui().clientHeight}setIndex(e,t){const r=this.getGui();jM(r,e),HM(r,t)}createTooltip(){const e={getTooltipValue:()=>this.label,getGui:()=>this.getGui(),getLocation:()=>"UNKNOWN",shouldDisplayTooltip:()=>ay(this.eText)},t=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("highlightTooltipFeature",!1,e,this));t&&(this.tooltipFeature=t)}addEventListeners(){const e=this.getParentComponent();e&&(this.addGuiEventListener("mouseover",()=>{e.highlightItem(this)}),this.addGuiEventListener("mousedown",t=>{t.preventDefault(),t.stopPropagation(),e.setValue(this.value)}))}},F7=class extends Sd{constructor(e="default"){super({tag:"div",cls:`ag-list ag-${e}-list`}),this.cssIdentifier=e,this.options=[],this.listItems=[],this.highlightedItem=null,this.registerCSS(T7)}postConstruct(){const e=this.getGui();this.addManagedElementListeners(e,{mouseleave:()=>this.clearHighlighted()})}handleKeyDown(e){const t=e.key;switch(t){case $e.ENTER:if(!this.highlightedItem)this.setValue(this.getValue());else{const r=this.listItems.indexOf(this.highlightedItem);this.setValueByIndex(r)}break;case $e.DOWN:case $e.UP:e.preventDefault(),this.navigate(t);break;case $e.PAGE_DOWN:case $e.PAGE_UP:case $e.PAGE_HOME:case $e.PAGE_END:e.preventDefault(),this.navigateToPage(t);break}}addOptions(e){for(const t of e)this.addOption(t);return this}addOption(e){const{value:t,text:r}=e,n=r??t;return this.options.push({value:t,text:n}),this.renderOption(t,n),this.updateIndices(),this}clearOptions(){this.options=[],this.reset(!0);for(const e of this.listItems)e.destroy();Hi(this.getGui()),this.listItems=[],this.refreshAriaRole()}updateOptions(e){const t=this.options!==e;return t&&(this.clearOptions(),this.addOptions(e)),t}setValue(e,t){if(this.value===e)return this.fireItemSelected(),this;if(e==null)return this.reset(t),this;const r=this.options.findIndex(n=>n.value===e);if(r!==-1){const n=this.options[r];this.value=n.value,this.displayValue=n.text,this.highlightItem(this.listItems[r]),t||this.fireChangeEvent()}return this}setValueByIndex(e){return this.setValue(this.options[e].value)}getValue(){return this.value}getDisplayValue(){return this.displayValue}refreshHighlighted(){this.clearHighlighted();const e=this.options.findIndex(t=>t.value===this.value);e!==-1&&this.highlightItem(this.listItems[e])}highlightItem(e){const t=e.getGui();if(!da(t))return;this.clearHighlighted(),e.setHighlighted(!0),this.highlightedItem=e;const r=this.getGui(),{scrollTop:n,clientHeight:i}=r,{offsetTop:s,offsetHeight:o}=t;(s+o>n+i||s<n)&&t.scrollIntoView({block:"nearest"})}hideItemTooltip(){this.highlightedItem?.tooltipFeature?.attemptToHideTooltip()}destroy(){this.hideItemTooltip(),super.destroy()}reset(e){this.value=null,this.displayValue=null,this.clearHighlighted(),e||this.fireChangeEvent()}clearHighlighted(){this.highlightedItem?.setHighlighted(!1),this.highlightedItem=null}renderOption(e,t){const r=new A7(this.cssIdentifier,t,e);r.setParentComponent(this);const n=this.createManagedBean(r);this.listItems.push(n),this.getGui().appendChild(n.getGui())}navigate(e){const t=e===$e.DOWN;let r;const{listItems:n,highlightedItem:i}=this;if(!i)r=t?n[0]:zr(n);else{let o=n.indexOf(i)+(t?1:-1);o=Math.min(Math.max(o,0),n.length-1),r=n[o]}this.highlightItem(r)}navigateToPage(e){const{listItems:t,highlightedItem:r}=this;if(!r||t.length===0)return;const n=t.indexOf(r),i=this.options.length-1,s=t[0].getHeight(),o=Math.floor(this.getGui().clientHeight/s);let a=-1;e===$e.PAGE_HOME?a=0:e===$e.PAGE_END?a=i:e===$e.PAGE_DOWN?a=Math.min(n+o,i):e===$e.PAGE_UP&&(a=Math.max(n-o,0)),a!==-1&&this.highlightItem(t[a])}refreshAriaRole(){gc(this.getGui(),this.options.length===0?"presentation":"listbox")}updateIndices(){this.refreshAriaRole();const e=this.listItems,t=e.length;e.forEach((r,n)=>{r.setIndex(n+1,t)})}fireChangeEvent(){this.dispatchLocalEvent({type:"fieldValueChanged"}),this.fireItemSelected()}fireItemSelected(){this.dispatchLocalEvent({type:"selectedItem"})}},M7=".ag-picker-field-display{flex:1 1 auto}.ag-picker-field{align-items:center;display:flex}.ag-picker-field-icon{border:0;cursor:pointer;display:flex;margin:0;padding:0}.ag-picker-field-wrapper{background-color:var(--ag-picker-button-background-color);border:var(--ag-picker-button-border);border-radius:5px;min-height:max(var(--ag-list-item-height),calc(var(--ag-spacing)*4));overflow:hidden;&:where(.ag-picker-has-focus),&:where(:focus-within){background-color:var(--ag-picker-button-focus-background-color);border:var(--ag-picker-button-focus-border);box-shadow:var(--ag-focus-shadow);&:where(.invalid){box-shadow:var(--ag-focus-error-shadow)}}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:disabled{opacity:.5}}",D7={tag:"div",cls:"ag-picker-field",role:"presentation",children:[{tag:"div",ref:"eLabel"},{tag:"div",ref:"eWrapper",cls:"ag-wrapper ag-picker-field-wrapper ag-picker-collapsed",children:[{tag:"div",ref:"eDisplayField",cls:"ag-picker-field-display"},{tag:"div",ref:"eIcon",cls:"ag-picker-field-icon",attrs:{"aria-hidden":"true"}}]}]},P7=class extends Ak{constructor(e){if(super(e,e?.template||D7,e?.agComponents||[],e?.className),this.isPickerDisplayed=!1,this.skipClick=!1,this.pickerGap=4,this.hideCurrentPicker=null,this.eLabel=xt,this.eWrapper=xt,this.eDisplayField=xt,this.eIcon=xt,this.registerCSS(M7),this.ariaRole=e?.ariaRole,this.onPickerFocusIn=this.onPickerFocusIn.bind(this),this.onPickerFocusOut=this.onPickerFocusOut.bind(this),!e)return;const{pickerGap:t,maxPickerHeight:r,variableWidth:n,minPickerWidth:i,maxPickerWidth:s}=e;t!=null&&(this.pickerGap=t),this.variableWidth=!!n,r!=null&&this.setPickerMaxHeight(r),i!=null&&this.setPickerMinWidth(i),s!=null&&this.setPickerMaxWidth(s)}postConstruct(){super.postConstruct(),this.setupAria();const e=`ag-${this.getCompId()}-display`;this.eDisplayField.setAttribute("id",e);const t=this.getAriaElement();this.addManagedElementListeners(t,{keydown:this.onKeyDown.bind(this)}),this.addManagedElementListeners(this.eLabel,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)}),this.addManagedElementListeners(this.eWrapper,{mousedown:this.onLabelOrWrapperMouseDown.bind(this)});const{pickerIcon:r,inputWidth:n}=this.config;if(r){const i=this.beans.iconSvc.createIconNoSpan(r);i&&this.eIcon.appendChild(i)}n!=null&&this.setInputWidth(n)}setupAria(){const e=this.getAriaElement();e.setAttribute("tabindex",this.gos.get("tabIndex").toString()),Yb(e,!1),this.ariaRole&&gc(e,this.ariaRole)}onLabelOrWrapperMouseDown(e){if(e){const t=this.getFocusableElement();if(t!==this.eWrapper&&e?.target===t)return;e.preventDefault(),this.getFocusableElement().focus()}if(this.skipClick){this.skipClick=!1;return}this.isDisabled()||(this.isPickerDisplayed?this.hidePicker():this.showPicker())}onKeyDown(e){switch(e.key){case $e.UP:case $e.DOWN:case $e.ENTER:case $e.SPACE:e.preventDefault(),this.onLabelOrWrapperMouseDown();break;case $e.ESCAPE:this.isPickerDisplayed&&(e.preventDefault(),e.stopPropagation(),this.hideCurrentPicker&&this.hideCurrentPicker());break}}showPicker(){this.isPickerDisplayed=!0,this.pickerComponent||(this.pickerComponent=this.createPickerComponent());const e=this.pickerComponent.getGui();e.addEventListener("focusin",this.onPickerFocusIn),e.addEventListener("focusout",this.onPickerFocusOut),this.hideCurrentPicker=this.renderAndPositionPicker(),this.toggleExpandedStyles(!0)}renderAndPositionPicker(){const e=this.pickerComponent.getGui();this.gos.get("suppressScrollWhenPopupsAreOpen")||([this.destroyMouseWheelFunc]=this.addManagedEventListeners({bodyScroll:()=>{this.hidePicker()}}));const t=this.getLocaleTextFunc(),{config:{pickerAriaLabelKey:r,pickerAriaLabelValue:n,modalPicker:i=!0},maxPickerHeight:s,minPickerWidth:o,maxPickerWidth:a,variableWidth:l,beans:c,eWrapper:u}=this,h={modal:i,eChild:e,closeOnEsc:!0,closedCallback:()=>{const v=ty(c);this.beforeHidePicker(),v&&this.isAlive()&&this.getFocusableElement().focus()},ariaLabel:t(r,n),anchorToElement:u};e.style.position="absolute";const d=c.popupSvc,f=d.addPopup(h);l?(o&&(e.style.minWidth=o),e.style.width=ly(u0(u)),a&&(e.style.maxWidth=a)):f0(e,a??u0(u));const m=s??`${iy(d.getPopupParent())}px`;return e.style.setProperty("max-height",m),this.alignPickerToComponent(),f.hideFunc}alignPickerToComponent(){if(!this.pickerComponent)return;const{pickerGap:e,config:{pickerType:t},beans:{popupSvc:r,gos:n},eWrapper:i,pickerComponent:s}=this,o=n.get("enableRtl")?"right":"left";r.positionPopupByComponent({type:t,eventSource:i,ePopup:s.getGui(),position:"under",alignSide:o,keepWithinBounds:!0,nudgeY:e})}beforeHidePicker(){this.destroyMouseWheelFunc&&(this.destroyMouseWheelFunc(),this.destroyMouseWheelFunc=void 0),this.toggleExpandedStyles(!1);const e=this.pickerComponent.getGui();e.removeEventListener("focusin",this.onPickerFocusIn),e.removeEventListener("focusout",this.onPickerFocusOut),this.isPickerDisplayed=!1,this.pickerComponent=void 0,this.hideCurrentPicker=null}toggleExpandedStyles(e){if(!this.isAlive())return;const t=this.getAriaElement();Yb(t,e);const r=this.eWrapper.classList;r.toggle("ag-picker-expanded",e),r.toggle("ag-picker-collapsed",!e)}onPickerFocusIn(){this.togglePickerHasFocus(!0)}onPickerFocusOut(e){this.pickerComponent?.getGui().contains(e.relatedTarget)||this.togglePickerHasFocus(!1)}togglePickerHasFocus(e){this.pickerComponent&&this.eWrapper.classList.toggle("ag-picker-has-focus",e)}hidePicker(){this.hideCurrentPicker&&(this.hideCurrentPicker(),this.dispatchLocalEvent({type:"pickerHidden"}))}setInputWidth(e){return f0(this.eWrapper,e),this}getFocusableElement(){return this.eWrapper}setPickerGap(e){return this.pickerGap=e,this}setPickerMinWidth(e){return typeof e=="number"&&(e=`${e}px`),this.minPickerWidth=e??void 0,this}setPickerMaxWidth(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerWidth=e??void 0,this}setPickerMaxHeight(e){return typeof e=="number"&&(e=`${e}px`),this.maxPickerHeight=e??void 0,this}destroy(){this.hidePicker(),super.destroy()}},I7=".ag-select{align-items:center;display:flex;&.ag-disabled{opacity:.5}}:where(.ag-select){.ag-picker-field-wrapper{cursor:default}&.ag-disabled .ag-picker-field-wrapper:focus{box-shadow:none}&:not(.ag-cell-editor,.ag-label-align-top){min-height:var(--ag-list-item-height)}.ag-picker-field-display{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ag-picker-field-icon{align-items:center;display:flex}}:where(.ag-ltr) :where(.ag-select){.ag-picker-field-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding)/2);padding-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-select){.ag-picker-field-wrapper{padding-left:var(--ag-spacing);padding-right:calc(var(--ag-cell-horizontal-padding)/2)}}.ag-select-list{background-color:var(--ag-picker-list-background-color);border:var(--ag-picker-list-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);overflow:hidden auto}.ag-select-list-item{cursor:default;-webkit-user-select:none;-moz-user-select:none;user-select:none;:where(span){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}}:where(.ag-ltr) .ag-select-list-item{padding-left:calc(var(--ag-cell-horizontal-padding)/2)}:where(.ag-rtl) .ag-select-list-item{padding-right:calc(var(--ag-cell-horizontal-padding)/2)}",Sy=class extends P7{constructor(e){super({pickerAriaLabelKey:"ariaLabelSelectField",pickerAriaLabelValue:"Select Field",pickerType:"ag-list",className:"ag-select",pickerIcon:"selectOpen",ariaRole:"combobox",...e}),this.registerCSS(I7)}postConstruct(){this.tooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{shouldDisplayTooltip:Wg(()=>this.eDisplayField),getGui:()=>this.getGui()})),super.postConstruct(),this.createListComponent(),this.eWrapper.tabIndex=this.gos.get("tabIndex");const{options:e,value:t,placeholder:r}=this.config;e!=null&&this.addOptions(e),t!=null&&this.setValue(t,!0),r&&t==null&&(this.eDisplayField.textContent=r),this.addManagedElementListeners(this.eWrapper,{focusout:this.onWrapperFocusOut.bind(this)})}onWrapperFocusOut(e){this.eWrapper.contains(e.relatedTarget)||this.hidePicker()}createListComponent(){const e=this.createBean(new F7("select"));this.listComponent=e,e.setParentComponent(this);const t=e.getAriaElement(),r=`ag-select-list-${e.getCompId()}`;t.setAttribute("id",r),KM(this.getAriaElement(),t),e.addManagedElementListeners(e.getGui(),{mousedown:n=>{n?.preventDefault()}}),e.addManagedListeners(e,{selectedItem:()=>{this.hidePicker(),this.dispatchLocalEvent({type:"selectedItem"})},fieldValueChanged:()=>{this.listComponent&&(this.setValue(this.listComponent.getValue(),!1,!0),this.hidePicker())}})}createPickerComponent(){return this.listComponent}beforeHidePicker(){this.listComponent?.hideItemTooltip(),super.beforeHidePicker()}onKeyDown(e){const{key:t}=e;switch(t===$e.TAB&&this.hidePicker(),t){case $e.ENTER:case $e.UP:case $e.DOWN:case $e.PAGE_UP:case $e.PAGE_DOWN:case $e.PAGE_HOME:case $e.PAGE_END:e.preventDefault(),this.isPickerDisplayed?this.listComponent?.handleKeyDown(e):super.onKeyDown(e);break;case $e.ESCAPE:super.onKeyDown(e);break;case $e.SPACE:this.isPickerDisplayed?e.preventDefault():super.onKeyDown(e);break}}showPicker(){const e=this.listComponent;e&&(super.showPicker(),e.refreshHighlighted())}addOptions(e){for(const t of e)this.addOption(t);return this}addOption(e){return this.listComponent.addOption(e),this}clearOptions(){return this.listComponent?.clearOptions(),this.setValue(void 0,!0),this}updateOptions(e){return this.listComponent?.updateOptions(e)&&this.setValue(void 0,!0),this}setValue(e,t,r){const{listComponent:n,config:{placeholder:i},eDisplayField:s,tooltipFeature:o}=this;if(this.value===e||!n)return this;if(r||n.setValue(e,!0),n.getValue()===this.getValue())return this;let l=n.getDisplayValue();return l==null&&i&&(l=i),s.textContent=l,o?.setTooltipAndRefresh(l??null),super.setValue(e,t)}destroy(){this.listComponent=this.destroyBean(this.listComponent),super.destroy()}},O7={selector:"AG-SELECT",component:Sy},N7=':where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart),:where(.ag-root-wrapper,.ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]){box-sizing:border-box;&:after,&:before{box-sizing:border-box}&:where(div,span,label):focus-visible{box-shadow:inset var(--ag-focus-shadow);outline:none;&:where(.invalid){box-shadow:inset var(--ag-focus-error-shadow)}}&:where(button){color:inherit}}:where(.ag-root-wrapper,ag-external,.ag-popup,.ag-dnd-ghost,.ag-chart) :where([class^=ag-]) ::-ms-clear{display:none}.ag-hidden{display:none!important}.ag-invisible{visibility:hidden!important}.ag-tab-guard{display:block;height:0;position:absolute;width:0}.ag-tab-guard-top{top:1px}.ag-tab-guard-bottom{bottom:1px}.ag-measurement-container{height:0;overflow:hidden;visibility:hidden;width:0}.ag-measurement-element-border{display:inline-block;&:before{border-left:var(--ag-internal-measurement-border);content:"";display:block}}.ag-popup-child{top:0;z-index:5;&:where(:not(.ag-tooltip-custom)){box-shadow:var(--ag-popup-shadow)}}.ag-input-wrapper,.ag-picker-field-wrapper{align-items:center;display:flex;flex:1 1 auto;line-height:normal;position:relative}.ag-input-field{align-items:center;display:flex;flex-direction:row}.ag-input-field-input:where(:not([type=checkbox],[type=radio])){flex:1 1 auto;min-width:0;width:100%}.ag-chart,.ag-dnd-ghost,.ag-external,.ag-popup,.ag-root-wrapper{cursor:default;line-height:normal;white-space:normal;-webkit-font-smoothing:antialiased;background-color:var(--ag-background-color);color:var(--ag-text-color);color-scheme:var(--ag-browser-color-scheme);font-family:var(--ag-font-family);font-size:var(--ag-font-size);--ag-indentation-level:0}:where(.ag-icon):before{align-items:center;background-color:currentcolor;color:inherit;content:"";display:flex;font-family:inherit;font-size:var(--ag-icon-size);font-style:normal;font-variant:normal;height:var(--ag-icon-size);justify-content:center;line-height:var(--ag-icon-size);-webkit-mask-size:contain;mask-size:contain;text-transform:none;width:var(--ag-icon-size)}.ag-icon{background-position:50%;background-repeat:no-repeat;background-size:contain;color:var(--ag-icon-color);display:block;height:var(--ag-icon-size);position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:var(--ag-icon-size)}.ag-disabled,[disabled]{.ag-icon{opacity:.5}&.ag-icon-grip{opacity:.35}}.ag-resizer{pointer-events:none;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none;z-index:1}:where(.ag-resizer){&.ag-resizer-topLeft{cursor:nwse-resize;height:5px;left:0;top:0;width:5px}&.ag-resizer-top{cursor:ns-resize;height:5px;left:5px;right:5px;top:0}&.ag-resizer-topRight{cursor:nesw-resize;height:5px;right:0;top:0;width:5px}&.ag-resizer-right{bottom:5px;cursor:ew-resize;right:0;top:5px;width:5px}&.ag-resizer-bottomRight{bottom:0;cursor:nwse-resize;height:5px;right:0;width:5px}&.ag-resizer-bottom{bottom:0;cursor:ns-resize;height:5px;left:5px;right:5px}&.ag-resizer-bottomLeft{bottom:0;cursor:nesw-resize;height:5px;left:0;width:5px}&.ag-resizer-left{bottom:5px;cursor:ew-resize;left:0;top:5px;width:5px}}',_y=typeof window!="object"||!window?.document?.fonts?.forEach,ud=(e,t,r,n,i,s)=>{if(_y)return;n&&(e=`@layer ${CSS.escape(n).replaceAll("\\.",".")} { ${e} }`);let o=Zu.map.get(t);if(o||(o=[],Zu.map.set(t,o)),o.some(u=>u.css===e))return;const a=document.createElement("style");s&&a.setAttribute("nonce",s),a.dataset.agGlobalCss=r,a.textContent=e;const l={css:e,el:a,priority:i};let c;for(const u of o){if(u.priority>i)break;c=u}if(c){c.el.insertAdjacentElement("afterend",a);const u=o.indexOf(c);o.splice(u+1,0,l)}else t.insertBefore(a,t.querySelector(":not(title, meta)")),o.push(l)},Mk=(e,t,r,n)=>{ud(N7,e,"shared",t,0,r),n?.forEach((i,s)=>i.forEach(o=>ud(o,e,s,t,0,r)))},L7=e=>{Zu.grids.add(e)},B7=e=>{if(Zu.grids.delete(e),Zu.grids.size===0){Zu.map=new WeakMap;for(const t of document.head.querySelectorAll("style[data-ag-global-css]"))t.remove()}},Q_,Zu=(Q_=typeof window=="object"?window:{}).agStyleInjectionState??(Q_.agStyleInjectionState={map:new WeakMap,grids:new Set}),To=e=>new Dk(e),Za="$default",H7=0,Dk=class{constructor({feature:e,params:t,modeParams:r={},css:n,cssImports:i}){this.feature=e,this.css=n,this.cssImports=i,this.modeParams={[Za]:{...r[Za]??{},...t??{}},...r}}use(e,t,r){let n=this._inject;if(n==null){let{css:i}=this;if(i){const s=`ag-theme-${this.feature??"part"}-${++H7}`;typeof i=="function"&&(i=i()),i=`:where(.${s}) {
${i}
}
`;for(const o of this.cssImports??[])i=`@import url(${JSON.stringify(o)});
${i}`;n={css:i,class:s}}else n=!1;this._inject=n}return n&&e&&ud(n.css,e,n.class,t,1,r),n?n.class:!1}},j7=e=>e.replace(/[A-Z]/g,t=>`-${t}`).toLowerCase(),Pk=e=>`--ag-${j7(e)}`,ko=e=>`var(${Pk(e)})`,V7=(e,t,r)=>Math.max(t,Math.min(r,e)),G7=e=>{const t=new Map;return r=>{const n=r;return t.has(n)||t.set(n,e(r)),t.get(n)}},fo=e=>({ref:"accentColor",mix:e}),bs=e=>({ref:"foregroundColor",mix:e}),Ss=e=>({ref:"foregroundColor",mix:e,onto:"backgroundColor"}),z7=e=>({ref:"foregroundColor",mix:e,onto:"headerBackgroundColor"}),Ni={ref:"backgroundColor"},Iu={ref:"foregroundColor"},Jo={ref:"accentColor"},_0={backgroundColor:"#fff",foregroundColor:"#181d1f",borderColor:bs(.15),chromeBackgroundColor:Ss(.02),browserColorScheme:"light"},U7={..._0,textColor:Iu,accentColor:"#2196f3",invalidColor:"#e02525",fontFamily:["-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu","Cantarell","Helvetica Neue","sans-serif"],subtleTextColor:{ref:"textColor",mix:.5},borderWidth:1,borderRadius:4,spacing:8,fontSize:14,focusShadow:{spread:3,color:fo(.5)},focusErrorShadow:{spread:3,color:{ref:"invalidColor",onto:"backgroundColor",mix:.5}},popupShadow:"0 0 16px #00000026",cardShadow:"0 1px 4px 1px #00000018",dropdownShadow:{ref:"cardShadow"},listItemHeight:{calc:"max(iconSize, dataFontSize) + widgetVerticalSpacing"},dragAndDropImageBackgroundColor:Ni,dragAndDropImageBorder:!0,dragAndDropImageNotAllowedBorder:{color:{ref:"invalidColor",onto:"dragAndDropImageBackgroundColor",mix:.5}},dragAndDropImageShadow:{ref:"popupShadow"},iconSize:16,iconColor:"inherit",toggleButtonWidth:28,toggleButtonHeight:18,toggleButtonOnBackgroundColor:Jo,toggleButtonOffBackgroundColor:Ss(.3),toggleButtonSwitchBackgroundColor:Ni,toggleButtonSwitchInset:2,tooltipBackgroundColor:{ref:"chromeBackgroundColor"},tooltipErrorBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.1},tooltipTextColor:{ref:"textColor"},tooltipErrorTextColor:{ref:"invalidColor"},tooltipBorder:!0,tooltipErrorBorder:{color:{ref:"invalidColor",onto:"backgroundColor",mix:.25}}},W7=["colorScheme","color","length","scale","borderStyle","border","shadow","image","fontFamily","fontWeight","duration"],$7=G7(e=>(e=e.toLowerCase(),W7.find(t=>e.endsWith(t.toLowerCase()))??"length")),om=e=>typeof e=="object"&&e?.ref?ko(e.ref):typeof e=="string"?e:typeof e=="number"?String(e):!1,Ey=e=>{if(typeof e=="string")return e;if(e&&"ref"in e){const t=ko(e.ref);return e.mix==null?t:`color-mix(in srgb, ${e.onto?ko(e.onto):"transparent"}, ${t} ${V7(e.mix*100,0,100)}%)`}return!1},q7=om,Ou=e=>typeof e=="string"?e:typeof e=="number"?`${e}px`:e&&"calc"in e?`calc(${e.calc.replace(/ ?[*/+] ?/g," $& ").replace(/-?\b[a-z][a-z0-9]*\b(?![-(])/gi,r=>r[0]==="-"?r:" "+ko(r)+" ")})`:e&&"ref"in e?ko(e.ref):!1,K7=om,dw=(e,t)=>typeof e=="string"?e:e===!0?dw({},t):e===!1?t==="columnBorder"?dw({color:"transparent"},t):"none":e&&"ref"in e?ko(e.ref):Ik(e.style??"solid")+" "+Ou(e.width??{ref:"borderWidth"})+" "+Ey(e.color??{ref:"borderColor"}),X7=e=>typeof e=="string"?e:e===!1?"none":e&&"ref"in e?ko(e.ref):[Ou(e.offsetX??0),Ou(e.offsetY??0),Ou(e.radius??0),Ou(e.spread??0),Ey(e.color??{ref:"foregroundColor"})].join(" "),Ik=om,Ok=e=>typeof e=="string"?e.includes(",")?e:e4(e):e&&"googleFont"in e?Ok(e.googleFont):e&&"ref"in e?ko(e.ref):Array.isArray(e)?e.map(t=>(typeof t=="object"&&"googleFont"in t&&(t=t.googleFont),e4(t))).join(", "):!1,e4=e=>/^[\w-]+$|\w\(/.test(e)?e:JSON.stringify(e),Y7=om,Nk=e=>typeof e=="string"?e:e&&"url"in e?`url(${JSON.stringify(e.url)})`:e&&"svg"in e?Nk({url:`data:image/svg+xml,${encodeURIComponent(e.svg)}`}):e&&"ref"in e?ko(e.ref):!1,Z7=(e,t,r)=>typeof e=="string"?e:typeof e=="number"?(e>=10&&r.warn(104,{value:e,param:t}),`${e}s`):e&&"ref"in e?ko(e.ref):!1,J7={color:Ey,colorScheme:q7,length:Ou,scale:K7,border:dw,borderStyle:Ik,shadow:X7,image:Nk,fontFamily:Ok,fontWeight:Y7,duration:Z7},Q7=(e,t,r)=>{const n=$7(e);return J7[n](t,e,r)},e9=e=>new Lk(e),Lk=class Bk{constructor(t,r=[]){this.themeLogger=t,this.parts=r}withPart(t){return typeof t=="function"&&(t=t()),t instanceof Dk?new Bk(this.themeLogger,[...this.parts,t]):(this.themeLogger.preInitErr(259,"Invalid part",{part:t}),this)}withoutPart(t){return this.withPart(To({feature:t}))}withParams(t,r=Za){return this.withPart(To({modeParams:{[r]:t}}))}_startUse({styleContainer:t,cssLayer:r,nonce:n,loadThemeGoogleFonts:i,moduleCss:s}){if(_y)return;r9(),Mk(t,r,n,s);const o=t9(this);if(o.length>0)for(const a of o)i&&n9(a,n);for(const a of this.parts)a.use(t,r,n)}_getCssClass(){return this._cssClassCache??(this._cssClassCache=t4(this.parts).map(t=>t.use(void 0,void 0,void 0)).filter(Boolean).join(" "))}_getModeParams(){let t=this._paramsCache;if(!t){const r={[Za]:{...U7}};for(const n of t4(this.parts))for(const i of Object.keys(n.modeParams)){const s=n.modeParams[i];if(s){const o=r[i]??(r[i]={}),a=new Set;for(const l of Object.keys(s)){const c=s[l];c!==void 0&&(o[l]=c,a.add(l))}if(i===Za)for(const l of Object.keys(r)){const c=r[l];if(l!==Za)for(const u of a)delete c[u]}}}this._paramsCache=t=r}return t}_getPerInstanceCss(t){const r="##SELECTOR##";let n=this._paramsCssCache;if(!n){let i="",s="";const o=this._getModeParams();for(const l of Object.keys(o)){const c=o[l];if(l!==Za){const h=`:where([data-ag-theme-mode="${typeof CSS=="object"?CSS.escape(l):l}"]) & {
`;i+=h,s+=h}for(const u of Object.keys(c).sort()){const h=c[u],d=Q7(u,h,this.themeLogger);if(d===!1)this.themeLogger.error(107,{key:u,value:h});else{const f=Pk(u),m=f.replace("--ag-","--ag-inherited-");i+=`	${f}: var(${m}, ${d});
`,s+=`	${m}: var(${f});
`}}l!==Za&&(i+=`}
`,s+=`}
`)}let a=`${r} {
${i}}
`;a+=`:has(> ${r}):not(${r}) {
${s}}
`,this._paramsCssCache=n=a}return n.replaceAll(r,`:where(.${t})`)}},t4=e=>{const t=new Map;for(const n of e)t.set(n.feature,n);const r=[];for(const n of e)(!n.feature||t.get(n.feature)===n)&&r.push(n);return r},t9=e=>{const t=new Set,r=s=>{if(Array.isArray(s))s.forEach(r);else{const o=s?.googleFont;typeof o=="string"&&t.add(o)}};return Object.values(e._getModeParams()).flatMap(s=>Object.values(s)).forEach(r),Array.from(t).sort()},r4=!1,r9=()=>{if(!r4){r4=!0;for(const e of Array.from(document.head.querySelectorAll('style[data-ag-scope="legacy"]')))e.remove()}},n9=async(e,t)=>{const r=`@import url('https://${i9}/css2?family=${encodeURIComponent(e)}:wght@100;200;300;400;500;600;700;800;900&display=swap');
`;ud(r,document.head,`googleFont:${e}`,void 0,0,t)},i9="fonts.googleapis.com",s9=1,o9=class{constructor(e){this.beans={},this.createdBeans=[],this.destroyed=!1,this.instanceId=s9++,e?.beanClasses&&(this.beanDestroyComparator=e.beanDestroyComparator,this.init(e))}init(e){this.id=e.id,this.beans.context=this,this.destroyCallback=e.destroyCallback;for(const t of Object.keys(e.providedBeanInstances))this.beans[t]=e.providedBeanInstances[t];for(const t of e.beanClasses){const r=new t;r.beanName?this.beans[r.beanName]=r:console.error(`Bean ${t.name} is missing beanName`),this.createdBeans.push(r)}for(const t of e.derivedBeans??[]){const{beanName:r,bean:n}=t(this);this.beans[r]=n,this.createdBeans.push(n)}e.beanInitComparator&&this.createdBeans.sort(e.beanInitComparator),this.initBeans(this.createdBeans)}getBeanInstances(){return Object.values(this.beans)}createBean(e,t){return this.initBeans([e],t),e}initBeans(e,t){const r=this.beans;for(const n of e)n.preWireBeans?.(r),n.wireBeans?.(r);for(const n of e)n.preConstruct?.();t&&e.forEach(t);for(const n of e)n.postConstruct?.()}getBeans(){return this.beans}getBean(e){return this.beans[e]}getId(){return this.id}destroy(){if(this.destroyed)return;this.destroyed=!0;const e=this.getBeanInstances();this.beanDestroyComparator&&e.sort(this.beanDestroyComparator),this.destroyBeans(e),this.beans={},this.createdBeans=[],this.destroyCallback?.()}destroyBean(e){e?.destroy?.()}destroyBeans(e){if(e)for(let t=0;t<e.length;t++)this.destroyBean(e[t]);return[]}isDestroyed(){return this.destroyed}},a9=0,n4={cssName:"--ag-list-item-height",changeKey:"listItemHeightChanged",defaultValue:24},l9=class extends _i{constructor(){super(...arguments),this.beanName="environment",this.sizeEls=new Map,this.lastKnownValues=new Map,this.sizesMeasured=!1,this.paramsClass=`ag-theme-params-${++a9}`,this.globalCSS=[]}wireBeans(e){this.eRootDiv=e.eRootDiv}postConstruct(){const{gos:e,eRootDiv:t}=this;e.setInstanceDomData(t);const r=e.get("themeStyleContainer"),n=typeof ShadowRoot<"u",i=n&&t.getRootNode()instanceof ShadowRoot;this.eStyleContainer=(typeof r=="function"?r():r)??(i?t:document.head),!r&&!i&&n&&c9(t,this.shadowRootError.bind(this),this.addDestroyFunc.bind(this)),this.cssLayer=e.get("themeCssLayer"),this.styleNonce=e.get("styleNonce"),this.addManagedPropertyListener("theme",()=>this.handleThemeChange()),this.handleThemeChange(),this.getSizeEl(n4),this.initVariables(),this.addDestroyFunc(()=>B7(this)),this.mutationObserver=new MutationObserver(()=>{this.fireStylesChangedEvent("themeChanged")}),this.addDestroyFunc(()=>this.mutationObserver.disconnect())}applyThemeClasses(e,t=[]){const{theme:r}=this;let n;r?n=`${this.paramsClass} ${r._getCssClass()}`:n=this.applyLegacyThemeClasses();for(const i of Array.from(e.classList))i.startsWith("ag-theme-")&&e.classList.remove(i);if(n){const i=e.className;e.className=`${i}${i?" ":""}${n}${t?.length?" "+t.join(" "):""}`}}applyLegacyThemeClasses(){let e="";this.mutationObserver.disconnect();let t=this.eRootDiv;for(;t;){let r=!1;for(const n of Array.from(t.classList))n.startsWith("ag-theme-")&&(r=!0,e=e?`${e} ${n}`:n);r&&this.mutationObserver.observe(t,{attributes:!0,attributeFilter:["class"]}),t=t.parentElement}return e}addGlobalCSS(e,t){this.theme?ud(e,this.eStyleContainer,t,this.cssLayer,0,this.styleNonce):this.globalCSS.push([e,t])}getDefaultListItemHeight(){return this.getCSSVariablePixelValue(n4)}getCSSVariablePixelValue(e){const t=this.lastKnownValues.get(e);if(t!=null)return t;const r=this.measureSizeEl(e);return r==="detached"||r==="no-styles"?(e.cacheDefault&&this.lastKnownValues.set(e,e.defaultValue),e.defaultValue):(this.lastKnownValues.set(e,r),r)}measureSizeEl(e){const t=this.getSizeEl(e);if(t.offsetParent==null)return"detached";const r=t.offsetWidth;return r===Y1?"no-styles":(this.sizesMeasured=!0,r)}getMeasurementContainer(){let e=this.eMeasurementContainer;return e||(e=this.eMeasurementContainer=nl({tag:"div",cls:"ag-measurement-container"}),this.eRootDiv.appendChild(e)),e}getSizeEl(e){let t=this.sizeEls.get(e);if(t)return t;const r=this.getMeasurementContainer();t=nl({tag:"div"});const{border:n,noWarn:i}=e;n?(t.className="ag-measurement-element-border",t.style.setProperty("--ag-internal-measurement-border",`var(${e.cssName}, solid ${Y1}px)`)):t.style.width=`var(${e.cssName}, ${Y1}px)`,r.appendChild(t),this.sizeEls.set(e,t);let s=this.measureSizeEl(e);s==="no-styles"&&!i&&this.varError(e);const o=ha(this.beans,t,()=>{const a=this.measureSizeEl(e);a==="detached"||a==="no-styles"||(this.lastKnownValues.set(e,a),a!==s&&(s=a,this.fireStylesChangedEvent(e.changeKey)))});return this.addDestroyFunc(()=>o()),t}handleThemeChange(){const{gos:e,theme:t}=this,r=e.get("theme");let n;if(r==="legacy")n=void 0;else{const i=r??this.getDefaultTheme();i instanceof Lk?n=i:this.themeError(i)}n!==t&&this.handleNewTheme(n),this.postProcessThemeChange(n,r)}handleNewTheme(e){const{gos:t,eRootDiv:r,globalCSS:n}=this,i=this.getAdditionalCss();if(e){L7(this),Mk(this.eStyleContainer,this.cssLayer,this.styleNonce,i);for(const[o,a]of n)ud(o,this.eStyleContainer,a,this.cssLayer,0,this.styleNonce);n.length=0}this.theme=e,e?._startUse({loadThemeGoogleFonts:t.get("loadThemeGoogleFonts"),styleContainer:this.eStyleContainer,cssLayer:this.cssLayer,nonce:this.styleNonce,moduleCss:i});let s=this.eParamsStyle;if(!s){s=this.eParamsStyle=nl({tag:"style"});const o=t.get("styleNonce");o&&s.setAttribute("nonce",o),r.appendChild(s)}_y||(s.textContent=e?._getPerInstanceCss(this.paramsClass)||""),this.applyThemeClasses(r),this.fireStylesChangedEvent("themeChanged")}fireStylesChangedEvent(e){this.eventSvc.dispatchEvent({type:"stylesChanged",[e]:!0})}},Y1=15538,c9=(e,t,r)=>{let n=60;const i=setInterval(()=>{typeof ShadowRoot<"u"&&e.getRootNode()instanceof ShadowRoot&&(t(),clearInterval(i)),(sy(e)||--n<0)&&clearInterval(i)},1e3);r(()=>clearInterval(i))},u9=class extends _i{constructor(){super(...arguments),this.beanName="registry"}registerDynamicBeans(e){if(e){this.dynamicBeans??(this.dynamicBeans={});for(const t of Object.keys(e))this.dynamicBeans[t]=e[t]}}createDynamicBean(e,t,...r){if(!this.dynamicBeans)throw new Error(this.getDynamicError(e,!0));const n=this.dynamicBeans[e];if(n==null){if(t)throw new Error(this.getDynamicError(e,!1));return}return new n(...r)}},d9=class extends _i{constructor(){super(...arguments),this.beanName="eventSvc",this.eventServiceType="global",this.globalSvc=new pc}addListener(e,t,r){this.globalSvc.addEventListener(e,t,r)}removeListener(e,t,r){this.globalSvc.removeEventListener(e,t,r)}addGlobalListener(e,t=!1){this.globalSvc.addGlobalListener(e,t)}removeGlobalListener(e,t=!1){this.globalSvc.removeGlobalListener(e,t)}dispatchEvent(e){this.globalSvc.dispatchEvent(this.gos.addCommon(e))}dispatchEventOnce(e){this.globalSvc.dispatchEventOnce(this.gos.addCommon(e))}},Hk=class extends _i{constructor(e,t){super(),this.ctrl=e,t&&(this.beans=t)}postConstruct(){this.refreshTooltip()}setBrowserTooltip(e,t){const r="title",n=this.ctrl.getGui();n&&(e!=null&&(e!=""||t)?n.setAttribute(r,e):n.removeAttribute(r))}updateTooltipText(){const{getTooltipValue:e}=this.ctrl;e&&(this.tooltip=e())}createTooltipFeatureIfNeeded(){if(this.tooltipManager==null){const e=this.beans.registry.createDynamicBean("tooltipStateManager",!0,this.ctrl,()=>this.tooltip);e&&(this.tooltipManager=this.createBean(e,this.beans.context))}}attemptToShowTooltip(){this.tooltipManager?.prepareToShowTooltip()}attemptToHideTooltip(){this.tooltipManager?.hideTooltip()}setTooltipAndRefresh(e){this.tooltip=e,this.refreshTooltip()}refreshTooltip(e){this.browserTooltips=this.beans.gos.get("enableBrowserTooltips"),this.updateTooltipText(),this.browserTooltips?(this.setBrowserTooltip(this.tooltip),this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context)):(this.setBrowserTooltip(e?"":null,e),this.createTooltipFeatureIfNeeded())}destroy(){this.tooltipManager=this.destroyBean(this.tooltipManager,this.beans.context),super.destroy()}},h9=1e3,f9=1e3,i4=100,s4,pg=!1,p9=class extends _i{constructor(e,t){super(),this.tooltipCtrl=e,this.getTooltipValue=t,this.interactionEnabled=!1,this.isInteractingWithTooltip=!1,this.state=0,this.tooltipInstanceCount=0,this.tooltipMouseTrack=!1}wireBeans(e){this.popupSvc=e.popupSvc}postConstruct(){this.gos.get("tooltipInteraction")&&(this.interactionEnabled=!0),this.tooltipTrigger=this.getTooltipTrigger(),this.tooltipMouseTrack=this.gos.get("tooltipMouseTrack");const e=this.tooltipCtrl.getGui();this.tooltipTrigger===0&&this.addManagedListeners(e,{mouseenter:this.onMouseEnter.bind(this),mouseleave:this.onMouseLeave.bind(this)}),this.tooltipTrigger===1&&this.addManagedListeners(e,{focusin:this.onFocusIn.bind(this),focusout:this.onFocusOut.bind(this)}),this.addManagedListeners(e,{mousemove:this.onMouseMove.bind(this)}),this.interactionEnabled||this.addManagedListeners(e,{mousedown:this.onMouseDown.bind(this),keydown:this.onKeyDown.bind(this)})}getGridOptionsTooltipDelay(e){const t=this.gos.get(e);return Math.max(200,t)}getTooltipDelay(e){return e==="show"?this.tooltipCtrl.getTooltipShowDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipShowDelay"):this.tooltipCtrl.getTooltipHideDelayOverride?.()??this.getGridOptionsTooltipDelay("tooltipHideDelay")}destroy(){this.setToDoNothing(),super.destroy()}getTooltipTrigger(){const e=this.gos.get("tooltipTrigger");return!e||e==="hover"?0:1}onMouseEnter(e){this.interactionEnabled&&this.interactiveTooltipTimeoutId&&(this.unlockService(),this.startHideTimeout()),!ac()&&(pg?this.showTooltipTimeoutId=window.setTimeout(()=>{this.prepareToShowTooltip(e)},i4):this.prepareToShowTooltip(e))}onMouseMove(e){this.lastMouseEvent&&(this.lastMouseEvent=e),this.tooltipMouseTrack&&this.state===2&&this.tooltipComp&&this.positionTooltip()}onMouseDown(){this.setToDoNothing()}onMouseLeave(){this.interactionEnabled?this.lockService():this.setToDoNothing()}onFocusIn(){this.prepareToShowTooltip()}onFocusOut(e){const t=e.relatedTarget,r=this.tooltipCtrl.getGui(),n=this.tooltipComp?.getGui();this.isInteractingWithTooltip||r.contains(t)||this.interactionEnabled&&n?.contains(t)||this.setToDoNothing()}onKeyDown(){this.isInteractingWithTooltip&&(this.isInteractingWithTooltip=!1),this.setToDoNothing()}prepareToShowTooltip(e){if(this.state!=0||pg)return;let t=0;e&&(t=this.isLastTooltipHiddenRecently()?200:this.getTooltipDelay("show")),this.lastMouseEvent=e||null,this.showTooltipTimeoutId=window.setTimeout(this.showTooltip.bind(this),t),this.state=1}isLastTooltipHiddenRecently(){return Date.now()-s4<h9}setToDoNothing(e){!e&&this.state===2&&this.hideTooltip(),this.onBodyScrollEventCallback&&(this.onBodyScrollEventCallback(),this.onBodyScrollEventCallback=void 0),this.clearEventHandlers(),this.onDocumentKeyDownCallback&&(this.onDocumentKeyDownCallback(),this.onDocumentKeyDownCallback=void 0),this.clearTimeouts(),this.state=0,this.lastMouseEvent=null}showTooltip(){const e=this.getTooltipValue(),t=this.tooltipCtrl;if(!bt(e)||t.shouldDisplayTooltip&&!t.shouldDisplayTooltip()){this.setToDoNothing();return}const r=this.gos.addCommon({location:t.getLocation?.()??"UNKNOWN",value:e,hideTooltipCallback:()=>this.hideTooltip(!0),...t.getAdditionalParams?.()});this.state=2,this.tooltipInstanceCount++;const n=this.newTooltipComponentCallback.bind(this,this.tooltipInstanceCount);this.createTooltipComp(r,n)}hideTooltip(e){!e&&this.isInteractingWithTooltip||(this.tooltipComp&&(this.destroyTooltipComp(),s4=Date.now()),this.eventSvc.dispatchEvent({type:"tooltipHide",parentGui:this.tooltipCtrl.getGui()}),e&&(this.isInteractingWithTooltip=!1),this.setToDoNothing(!0))}newTooltipComponentCallback(e,t){if(this.state!==2||this.tooltipInstanceCount!==e){this.destroyBean(t);return}const n=t.getGui();this.tooltipComp=t,n.classList.contains("ag-tooltip")||n.classList.add("ag-tooltip-custom"),this.tooltipTrigger===0&&n.classList.add("ag-tooltip-animate"),this.interactionEnabled&&n.classList.add("ag-tooltip-interactive");const i=this.getLocaleTextFunc(),s=this.popupSvc?.addPopup({eChild:n,ariaLabel:i("ariaLabelTooltip","Tooltip")});if(s&&(this.tooltipPopupDestroyFunc=s.hideFunc),this.positionTooltip(),this.tooltipTrigger===1){const o=()=>this.setToDoNothing();[this.onBodyScrollEventCallback]=this.addManagedEventListeners({bodyScroll:o}),this.setEventHandlers(o)}this.interactionEnabled&&([this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener]=this.addManagedElementListeners(n,{mouseenter:this.onTooltipMouseEnter.bind(this),mouseleave:this.onTooltipMouseLeave.bind(this)}),[this.onDocumentKeyDownCallback]=this.addManagedElementListeners(Gn(this.beans),{keydown:o=>{n.contains(o?.target)||this.onKeyDown()}}),this.tooltipTrigger===1&&([this.tooltipFocusInListener,this.tooltipFocusOutListener]=this.addManagedElementListeners(n,{focusin:this.onTooltipFocusIn.bind(this),focusout:this.onTooltipFocusOut.bind(this)}))),this.eventSvc.dispatchEvent({type:"tooltipShow",tooltipGui:n,parentGui:this.tooltipCtrl.getGui()}),this.startHideTimeout()}onTooltipMouseEnter(){this.isInteractingWithTooltip=!0,this.unlockService()}onTooltipMouseLeave(){this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,this.lockService())}onTooltipFocusIn(){this.isInteractingWithTooltip=!0}isTooltipFocused(){const e=this.tooltipComp?.getGui(),t=tn(this.beans);return!!e&&e.contains(t)}onTooltipFocusOut(e){const t=this.tooltipCtrl.getGui();this.isTooltipFocused()||(this.isInteractingWithTooltip=!1,t.contains(e.relatedTarget)?this.startHideTimeout():this.hideTooltip())}positionTooltip(){const e={type:"tooltip",ePopup:this.tooltipComp.getGui(),nudgeY:18,skipObserver:this.tooltipMouseTrack};this.lastMouseEvent?this.popupSvc?.positionPopupUnderMouseEvent({...e,mouseEvent:this.lastMouseEvent}):this.popupSvc?.positionPopupByComponent({...e,eventSource:this.tooltipCtrl.getGui(),position:"under",keepWithinBounds:!0,nudgeY:5})}destroyTooltipComp(){this.tooltipComp.getGui().classList.add("ag-tooltip-hiding");const e=this.tooltipPopupDestroyFunc,t=this.tooltipComp,r=this.tooltipTrigger===0?f9:0;window.setTimeout(()=>{e(),this.destroyBean(t)},r),this.clearTooltipListeners(),this.tooltipPopupDestroyFunc=void 0,this.tooltipComp=void 0}clearTooltipListeners(){for(const e of[this.tooltipMouseEnterListener,this.tooltipMouseLeaveListener,this.tooltipFocusInListener,this.tooltipFocusOutListener])e&&e();this.tooltipMouseEnterListener=this.tooltipMouseLeaveListener=this.tooltipFocusInListener=this.tooltipFocusOutListener=null}lockService(){pg=!0,this.interactiveTooltipTimeoutId=window.setTimeout(()=>{this.unlockService(),this.setToDoNothing()},i4)}unlockService(){pg=!1,this.clearInteractiveTimeout()}startHideTimeout(){this.clearHideTimeout(),this.hideTooltipTimeoutId=window.setTimeout(this.hideTooltip.bind(this),this.getTooltipDelay("hide"))}clearShowTimeout(){this.showTooltipTimeoutId&&(window.clearTimeout(this.showTooltipTimeoutId),this.showTooltipTimeoutId=void 0)}clearHideTimeout(){this.hideTooltipTimeoutId&&(window.clearTimeout(this.hideTooltipTimeoutId),this.hideTooltipTimeoutId=void 0)}clearInteractiveTimeout(){this.interactiveTooltipTimeoutId&&(window.clearTimeout(this.interactiveTooltipTimeoutId),this.interactiveTooltipTimeoutId=void 0)}clearTimeouts(){this.clearShowTimeout(),this.clearHideTimeout(),this.clearInteractiveTimeout()}},g9=class extends Hk{constructor(e,t,r){super(e,r),this.highlightTracker=t,this.onHighlight=this.onHighlight.bind(this)}postConstruct(){super.postConstruct(),this.wireHighlightListeners()}wireHighlightListeners(){this.addManagedPropertyListener("tooltipTrigger",({currentValue:e})=>{this.setTooltipMode(e)}),this.setTooltipMode(this.gos.get("tooltipTrigger")),this.highlightTracker.addEventListener("itemHighlighted",this.onHighlight)}onHighlight(e){this.tooltipMode===1&&(e.highlighted?this.attemptToShowTooltip():this.attemptToHideTooltip())}setTooltipMode(e="focus"){this.tooltipMode=e==="focus"?1:0}destroy(){this.highlightTracker.removeEventListener("itemHighlighted",this.onHighlight),super.destroy()}},gg=0,m9=200,v9=class extends _i{constructor(){super(...arguments),this.beanName="popupSvc",this.popupList=[]}postConstruct(){this.addManagedEventListeners({stylesChanged:this.handleThemeChange.bind(this)})}getPopupParent(){const e=this.gos.get("popupParent");return e||this.getDefaultPopupParent()}positionPopupUnderMouseEvent(e){const{ePopup:t,nudgeX:r,nudgeY:n,skipObserver:i}=e;this.positionPopup({ePopup:t,nudgeX:r,nudgeY:n,keepWithinBounds:!0,skipObserver:i,updatePosition:()=>this.calculatePointerAlign(e.mouseEvent),postProcessCallback:()=>this.callPostProcessPopup(e.additionalParams,e.type,e.ePopup,null,e.mouseEvent)})}calculatePointerAlign(e){const t=this.getParentRect();return{x:e.clientX-t.left,y:e.clientY-t.top}}positionPopupByComponent(e){const{ePopup:t,nudgeX:r,nudgeY:n,keepWithinBounds:i,eventSource:s,alignSide:o="left",position:a="over",type:l}=e,c=s.getBoundingClientRect(),u=this.getParentRect();this.setAlignedTo(s,t);const h=()=>{let d=c.left-u.left;o==="right"&&(d-=t.offsetWidth-c.width);let f;return a==="over"?(f=c.top-u.top,this.setAlignedStyles(t,"over")):(this.setAlignedStyles(t,"under"),this.shouldRenderUnderOrAbove(t,c,u,e.nudgeY||0)==="under"?f=c.top-u.top+c.height:f=c.top-t.offsetHeight-(n||0)*2-u.top),{x:d,y:f}};this.positionPopup({ePopup:t,nudgeX:r,nudgeY:n,keepWithinBounds:i,updatePosition:h,postProcessCallback:()=>this.callPostProcessPopup(e.additionalParams,l,t,s,null)})}positionPopupForMenu(e){const{eventSource:t,ePopup:r,event:n}=e,i=t.getBoundingClientRect(),s=this.getParentRect();this.setAlignedTo(t,r);let o=!1;const a=()=>{const l=this.keepXYWithinBounds(r,i.top-s.top,0),c=r.clientWidth>0?r.clientWidth:200;o||(r.style.minWidth=`${c}px`,o=!0);const h=s.right-s.left-c;let d;return this.gos.get("enableRtl")?(d=m(),d<0&&(d=f(),this.setAlignedStyles(r,"left")),d>h&&(d=0,this.setAlignedStyles(r,"right"))):(d=f(),d>h&&(d=m(),this.setAlignedStyles(r,"right")),d<0&&(d=0,this.setAlignedStyles(r,"left"))),{x:d,y:l};function f(){return i.right-s.left-2}function m(){return i.left-s.left-c}};this.positionPopup({ePopup:r,keepWithinBounds:!0,updatePosition:a,postProcessCallback:()=>this.callPostProcessPopup(e.additionalParams,"subMenu",r,t,n instanceof MouseEvent?n:void 0)})}shouldRenderUnderOrAbove(e,t,r,n){const i=r.bottom-t.bottom,s=t.top-r.top,o=e.offsetHeight+n;return i>o?"under":s>o||s>i?"above":"under"}setAlignedStyles(e,t){const r=this.getPopupIndex(e);if(r===-1)return;const n=this.popupList[r],{alignedToElement:i}=n;if(!i)return;const s=["right","left","over","above","under"];for(const o of s)i.classList.remove(`ag-has-popup-positioned-${o}`),e.classList.remove(`ag-popup-positioned-${o}`);t&&(i.classList.add(`ag-has-popup-positioned-${t}`),e.classList.add(`ag-popup-positioned-${t}`))}setAlignedTo(e,t){const r=this.getPopupIndex(t);if(r!==-1){const n=this.popupList[r];n.alignedToElement=e}}positionPopup(e){const{ePopup:t,keepWithinBounds:r,nudgeX:n,nudgeY:i,skipObserver:s,updatePosition:o}=e,a={width:0,height:0},l=(c=!1)=>{let{x:u,y:h}=o();c&&t.clientWidth===a.width&&t.clientHeight===a.height||(a.width=t.clientWidth,a.height=t.clientHeight,n&&(u+=n),i&&(h+=i),r&&(u=this.keepXYWithinBounds(t,u,1),h=this.keepXYWithinBounds(t,h,0)),t.style.left=`${u}px`,t.style.top=`${h}px`,e.postProcessCallback&&e.postProcessCallback())};if(l(),!s){const c=ha(this.beans,t,()=>l(!0));setTimeout(()=>c(),m9)}}getParentRect(){const e=Gn(this.beans);let t=this.getPopupParent();return t===e.body?t=e.documentElement:getComputedStyle(t).position==="static"&&(t=t.offsetParent),RT(t)}keepXYWithinBounds(e,t,r){const n=r===0,i=n?"clientHeight":"clientWidth",s=n?"top":"left",o=n?"height":"width",a=n?"scrollTop":"scrollLeft",l=Gn(this.beans),c=l.documentElement,u=this.getPopupParent(),h=e.getBoundingClientRect(),d=u.getBoundingClientRect(),f=l.documentElement.getBoundingClientRect(),m=u===l.body,v=Math.ceil(h[o]);let w=m?(n?kT:u0)(c)+c[a]:u[i];m&&(w-=Math.abs(f[s]-d[s]));const y=w-v;return Math.min(Math.max(t,0),Math.max(y,0))}addPopup(e){const{eChild:t,ariaLabel:r,ariaOwns:n,alwaysOnTop:i,positionCallback:s,anchorToElement:o}=e,a=this.getPopupIndex(t);if(a!==-1)return{hideFunc:this.popupList[a].hideFunc};this.initialisePopupPosition(t);const l=this.createPopupWrapper(t,!!i,r,n),c=this.addEventListenersToPopup({...e,wrapperEl:l});return s&&s(),this.addPopupToPopupList(t,l,c,o),{hideFunc:c}}initialisePopupPosition(e){const r=this.getPopupParent().getBoundingClientRect();bt(e.style.top)||(e.style.top=`${r.top*-1}px`),bt(e.style.left)||(e.style.left=`${r.left*-1}px`)}createPopupWrapper(e,t,r,n){const i=this.getPopupParent(),{environment:s,gos:o}=this.beans,a=nl({tag:"div"});return s.applyThemeClasses(a),a.classList.add("ag-popup"),e.classList.add(o.get("enableRtl")?"ag-rtl":"ag-ltr","ag-popup-child"),e.hasAttribute("role")||gc(e,"dialog"),r?ad(e,r):n&&(e.id||(e.id=`popup-component-${gg}`),H_(n,e.id)),a.appendChild(e),i.appendChild(a),t?this.setAlwaysOnTop(e,!0):this.bringPopupToFront(e),a}addEventListenersToPopup(e){const t=this.beans,r=Gn(t),{wrapperEl:n,eChild:i,closedCallback:s,afterGuiAttached:o,closeOnEsc:a,modal:l,ariaOwns:c}=e;let u=!1;const h=v=>{if(!n.contains(tn(t)))return;v.key===$e.ESCAPE&&!this.isStopPropagation(v)&&m({keyboardEvent:v})},d=v=>m({mouseEvent:v}),f=v=>m({touchEvent:v}),m=(v={})=>{const{mouseEvent:g,touchEvent:w,keyboardEvent:y,forceHide:C}=v;!C&&(this.isEventFromCurrentPopup({mouseEvent:g,touchEvent:w},i)||u)||(u=!0,n.remove(),r.removeEventListener("keydown",h),r.removeEventListener("mousedown",d),r.removeEventListener("touchstart",f),r.removeEventListener("contextmenu",d),this.eventSvc.removeListener("dragStarted",d),s&&s(g||w||y),this.removePopupFromPopupList(i,c))};return o&&o({hidePopup:m}),window.setTimeout(()=>{a&&r.addEventListener("keydown",h),l&&(r.addEventListener("mousedown",d),this.eventSvc.addListener("dragStarted",d),r.addEventListener("touchstart",f),r.addEventListener("contextmenu",d))},0),m}addPopupToPopupList(e,t,r,n){this.popupList.push({element:e,wrapper:t,hideFunc:r,instanceId:gg,isAnchored:!!n}),n&&this.setPopupPositionRelatedToElement(e,n),gg=gg+1}getPopupIndex(e){return this.popupList.findIndex(t=>t.element===e)}setPopupPositionRelatedToElement(e,t){const r=this.getPopupIndex(e);if(r===-1)return;const n=this.popupList[r];if(n.stopAnchoringPromise&&n.stopAnchoringPromise.then(s=>s&&s()),n.stopAnchoringPromise=void 0,n.isAnchored=!1,!t)return;const i=this.keepPopupPositionedRelativeTo({element:t,ePopup:e,hidePopup:n.hideFunc});return n.stopAnchoringPromise=i,n.isAnchored=!0,i}removePopupFromPopupList(e,t){this.setAlignedStyles(e,null),this.setPopupPositionRelatedToElement(e,null),t&&H_(t,null),this.popupList=this.popupList.filter(r=>r.element!==e)}keepPopupPositionedRelativeTo(e){const t=this.getPopupParent(),r=t.getBoundingClientRect(),{element:n,ePopup:i}=e,s=n.getBoundingClientRect(),o=h=>Number.parseInt(h.substring(0,h.length-1),10),a=(h,d)=>{const f=r[h]-s[h],m=o(i.style[h]);return{initialDiff:f,lastDiff:f,initial:m,last:m,direction:d}},l=a("top",0),c=a("left",1),u=this.beans.frameworkOverrides;return new hr(h=>{u.wrapIncoming(()=>{CP(()=>{const d=t.getBoundingClientRect(),f=n.getBoundingClientRect();if(f.top==0&&f.left==0&&f.height==0&&f.width==0){e.hidePopup();return}const v=(g,w)=>{const y=o(i.style[w]);g.last!==y&&(g.initial=y,g.last=y);const C=d[w]-f[w];if(C!=g.lastDiff){const k=this.keepXYWithinBounds(i,g.initial+g.initialDiff-C,g.direction);i.style[w]=`${k}px`,g.last=k}g.lastDiff=C};v(l,"top"),v(c,"left")},200).then(d=>{h(()=>{d!=null&&window.clearInterval(d)})})},"popupPositioning")})}isEventFromCurrentPopup(e,t){const{mouseEvent:r,touchEvent:n}=e,i=r||n;if(!i)return!1;const s=this.getPopupIndex(t);if(s===-1)return!1;for(let o=s;o<this.popupList.length;o++){const a=this.popupList[o];if(QM(a.element,i))return!0}return this.isElementWithinCustomPopup(i.target)}isElementWithinCustomPopup(e){const t=Gn(this.beans);for(;e&&e!==t.body;){if(e.classList.contains("ag-custom-component-popup")||e.parentElement===null)return!0;e=e.parentElement}return!1}getWrapper(e){for(;!e.classList.contains("ag-popup")&&e.parentElement;)e=e.parentElement;return e.classList.contains("ag-popup")?e:null}setAlwaysOnTop(e,t){const r=this.getWrapper(e);r&&(r.classList.toggle("ag-always-on-top",!!t),t&&this.bringPopupToFront(r))}bringPopupToFront(e){const t=this.getPopupParent(),r=Array.prototype.slice.call(t.querySelectorAll(".ag-popup")),n=r.length,i=this.getWrapper(e);if(!i||n<=1||!t.contains(e))return;const s=[],o=[];for(const d of r)d!==i&&(d.classList.contains("ag-always-on-top")?o.push(d):s.push(d));const a=[],l=o.length,h=i.classList.contains("ag-always-on-top")||!l?[...s,...o,i]:[...s,i,...o];for(let d=0;d<=n;d++){const f=h[d];if(r[d]===h[d]||f===i)continue;const m=f.querySelectorAll("div");for(const v of m)v.scrollTop!==0&&a.push([v,v.scrollTop]);d===0?t.insertAdjacentElement("afterbegin",f):h[d-1].insertAdjacentElement("afterend",f)}for(;a.length;){const d=a.pop();d[0].scrollTop=d[1]}}handleThemeChange(e){if(e.themeChanged){const t=this.beans.environment;for(const r of this.popupList)t.applyThemeClasses(r.wrapper)}}},b9=class extends by{constructor(){super({tag:"div",cls:"ag-tooltip"})}init(e){const{value:t}=e,r=this.getGui();r.textContent=yd(t);const n=e.location.replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase();r.classList.add(`ag-${n}-tooltip`)}},jk=(e,t)=>{if(t!=null&&e?.setPointerCapture)try{return e.setPointerCapture(t),e.hasPointerCapture(t)}catch{}return!1},w9=(e,t)=>{if(typeof PointerEvent>"u"||!(t instanceof PointerEvent))return null;const r=t.pointerId;if(!jk(e,r))return null;const n={eElement:e,pointerId:r,onLost(i){C9(n,i)}};return e.addEventListener("lostpointercapture",n.onLost),n},y9=e=>{if(!e)return;Vk(e);const{eElement:t,pointerId:r}=e;if(t){try{t.releasePointerCapture(r)}catch{}e.eElement=null}},Vk=e=>{const{eElement:t,onLost:r}=e;t&&r&&(t.removeEventListener("lostpointercapture",r),e.onLost=null)},C9=(e,t)=>{Vk(e);const{eElement:r,pointerId:n}=e;r&&t.pointerId===n&&jk(r,n)},pu,Nu,Z1={passive:!0},$a={passive:!1},oo=e=>{if(!Nu)Nu=new WeakSet;else if(Nu.has(e))return!1;return Nu.add(e),!0},x9=class extends _i{constructor(){super(...arguments),this.beanName="dragSvc",this.dragging=!1,this.drag=null,this.dragSources=[]}get startTarget(){return this.drag?.start.target??null}isPointer(){return!!pu?.has(ho(this.beans))}hasPointerCapture(){const e=this.drag?.pointerCapture;return!!(e&&this.beans.eRootDiv.hasPointerCapture?.(e.pointerId))}destroy(){this.drag&&this.cancelDrag();const e=this.dragSources;for(const t of e)o4(t);e.length=0,super.destroy()}removeDragSource(e){const t=this.dragSources;for(let r=0,n=t.length;r<n;++r){const i=t[r];if(i.params===e){t.splice(r,1),o4(i);break}}}addDragSource(e){if(!this.isAlive())return;const{eElement:t,includeTouch:r}=e,n=[];let i;if(r){const c=t.style;c&&(i=c.touchAction,c.touchAction="none")}const s={handlers:n,params:e,oldTouchAction:i};this.dragSources.push(s),$g(n,[t,"pointerdown",c=>this.onPointerDown(e,c),$a],[t,"mousedown",c=>this.onMouseDown(e,c)]);const l=this.gos.get("suppressTouch");r&&!l&&$g(n,[t,"touchstart",u=>this.onTouchStart(e,u),$a])}cancelDrag(e){const t=this.drag;e??(e=t?.eElement),e&&this.eventSvc.dispatchEvent({type:"dragCancelled",target:e}),t?.params.onDragCancel?.(),this.destroyDrag()}shouldPreventMouseEvent(e){const t=e.type;return(t==="mousemove"||t==="pointermove")&&e.cancelable&&uf(this.beans,e)&&!jh(Q1(e))}initDrag(e,...t){this.drag=e;const r=this.beans,n=a=>this.onScroll(a),i=a=>this.onKeyDown(a),s=ho(r),o=Gn(r);$g(e.handlers,[s,"contextmenu",Pu],[s,"keydown",i],[o,"scroll",n,{capture:!0}],[o.defaultView||window,"scroll",n],...t)}destroyDrag(){this.dragging=!1;const e=this.drag;if(e){const t=e.rootEl;pu?.get(t)===e&&pu.delete(t),this.drag=null,y9(e.pointerCapture),uy(e.handlers)}}onPointerDown(e,t){if(this.isPointer())return;const r=this.beans;if(Nu?.has(t))return;const n=t.pointerType;if(n==="touch"&&(r.gos.get("suppressTouch")||!e.includeTouch||(e.stopPropagationForTouch&&t.stopPropagation(),jh(Q1(t))))||!t.isPrimary||n==="mouse"&&t.button!==0)return;this.destroyDrag();const i=ho(r),s=e.eElement,o=t.pointerId,a=new J1(i,e,t,o);pu??(pu=new WeakMap),pu.set(i,a);const l=d=>{d.pointerId===o&&this.onMouseOrPointerMove(d)},c=d=>{d.pointerId===o&&this.onMouseOrPointerUp(d)},u=d=>{d.pointerId===o&&oo(d)&&this.cancelDrag()},h=d=>this.draggingPreventDefault(d);this.initDrag(a,[i,"pointerup",c],[i,"pointercancel",u],[i,"pointermove",l,$a],[i,"touchmove",h,$a],[s,"mousemove",h,$a]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):oo(t)}onTouchStart(e,t){if(this.gos.get("suppressTouch")||!e.includeTouch||!oo(t)||jh(Q1(t)))return;if(e.stopPropagationForTouch&&t.stopPropagation(),this.isPointer()){this.dragging&&Pu(t);return}this.destroyDrag();const n=this.beans,i=ho(n),s=new J1(i,e,t.touches[0]),o=d=>this.onTouchMove(d),a=d=>this.onTouchUp(d),l=d=>this.onTouchCancel(d),c=d=>this.draggingPreventDefault(d),u=ho(n),h=t.target??e.eElement;this.initDrag(s,[h,"touchmove",o,Z1],[h,"touchend",a,Z1],[h,"touchcancel",l,Z1],[u,"touchmove",c,$a],[u,"touchend",a,$a],[u,"touchcancel",l,$a]),e.dragStartPixels===0&&this.onMove(s.start)}draggingPreventDefault(e){this.dragging&&Pu(e)}onMouseDown(e,t){if(t.button!==0||Nu?.has(t)||this.isPointer())return;const r=this.beans;this.destroyDrag();const n=new J1(ho(r),e,t),i=a=>this.onMouseOrPointerMove(a),s=a=>this.onMouseOrPointerUp(a),o=ho(r);this.initDrag(n,[o,"mousemove",i],[o,"mouseup",s]),e.dragStartPixels===0?this.onMouseOrPointerMove(t):oo(t)}onScroll(e){if(!oo(e))return;const t=this.drag,r=t?.lastDrag;r&&this.dragging&&t.params?.onDragging?.(r)}onMouseOrPointerMove(e){oo(e)&&(bl()&&Gn(this.beans).getSelection()?.removeAllRanges(),this.shouldPreventMouseEvent(e)&&Pu(e),this.onMove(e))}onTouchCancel(e){const t=this.drag;!t||!oo(e)||Vu(t.start,e.changedTouches)&&this.cancelDrag()}onTouchMove(e){const t=this.drag;if(!t||!oo(e))return;const r=Vu(t.start,e.touches);r&&(this.onMove(r),this.draggingPreventDefault(e))}onMove(e){const t=this.drag;if(!t)return;t.lastDrag=e;const r=t.params;if(!this.dragging){const n=t.start,s=r.dragStartPixels??4;if(DT(e,n,s)||(this.dragging=!0,r.capturePointer&&(t.pointerCapture=w9(this.beans.eRootDiv,e)),this.eventSvc.dispatchEvent({type:"dragStarted",target:r.eElement}),r.onDragStart?.(n),this.drag!==t)||(r.onDragging?.(n),this.drag!==t))return}r.onDragging?.(e)}onTouchUp(e){const t=this.drag;t&&oo(e)&&this.onUp(Vu(t.start,e.changedTouches))}onMouseOrPointerUp(e){oo(e)&&this.onUp(e)}onUp(e){const t=this.drag;t&&(e||(e=t.lastDrag),e&&this.dragging&&(this.dragging=!1,t.params.onDragStop?.(e),this.eventSvc.dispatchEvent({type:"dragStopped",target:t.params.eElement})),this.destroyDrag())}onKeyDown(e){e.key===$e.ESCAPE&&this.cancelDrag()}},o4=e=>{uy(e.handlers);const t=e.oldTouchAction;if(t!=null){const r=e.params.eElement.style;r&&(r.touchAction=t)}},J1=class{constructor(e,t,r,n=null){this.rootEl=e,this.params=t,this.start=r,this.pointerId=n,this.handlers=[],this.lastDrag=null,this.pointerCapture=null,this.eElement=t.eElement}},Q1=e=>{const t=e.target;return t instanceof Element?t:null},S9=class extends _i{constructor(){super(...arguments),this.beanName="dragAndDrop",this.dragSourceAndParamsList=[],this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.dragSource=null,this.dragImageCompPromise=null,this.dragImageComp=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.dropTargets=[],this.externalDropZoneCount=0,this.lastDropTarget=null}addDragSource(e,t=!1){const r={capturePointer:!0,dragSource:e,eElement:e.eElement,dragStartPixels:e.dragStartPixels,onDragStart:n=>this.onDragStart(e,n),onDragStop:this.onDragStop.bind(this),onDragging:this.onDragging.bind(this),onDragCancel:this.onDragCancel.bind(this),includeTouch:t};this.dragSourceAndParamsList.push(r),this.beans.dragSvc.addDragSource(r)}setDragImageCompIcon(e,t=!1){const r=this.dragImageComp;r&&(t||this.dragImageLastIcon!==e)&&(this.dragImageLastIcon=e,r.setIcon(e,t))}removeDragSource(e){const{dragSourceAndParamsList:t,beans:r}=this;for(let n=0,i=t.length;n<i;n++)if(t[n].dragSource===e){const s=t[n];r.dragSvc?.removeDragSource(s),t.splice(n,1);break}}destroy(){const{dragSourceAndParamsList:e,dropTargets:t,beans:r}=this,n=r.dragSvc;for(const i of e)n?.removeDragSource(i);e.length=0,t.length=0,this.externalDropZoneCount=0,this.clearDragAndDropProperties(),super.destroy()}nudge(){const e=this.lastMouseEvent;e&&this.onDragging(e,!0)}onDragStart(e,t){this.lastMouseEvent=t,this.dragSource=e,this.dragItem=e.getDragItem();const r=e.eElement.getBoundingClientRect();this.dragInitialSourcePointerOffsetX=t.clientX-r.left,this.dragInitialSourcePointerOffsetY=t.clientY-r.top,e.onDragStarted?.(),this.createAndUpdateDragImageComp(e)}onDragStop(e){const{dragSource:t,lastDropTarget:r}=this;if(t?.onDragStopped?.(),r){const n=this.dropTargetEvent(r,e,!1);r.onDragStop?.(n)}this.clearDragAndDropProperties()}onDragCancel(){const{dragSource:e,lastDropTarget:t,lastMouseEvent:r}=this;if(e?.onDragCancelled?.(),t&&r){const n=this.dropTargetEvent(t,r,!1);t.onDragCancel?.(n)}this.clearDragAndDropProperties()}onDragging(e,t=!1){this.positionDragImageComp(e);const r=this.findCurrentDropTarget(e),{lastDropTarget:n,dragSource:i,dragItem:s}=this;let o=!1;if(r!==n){if(o=!0,n){const a=this.dropTargetEvent(n,e,t);n.onDragLeave?.(a)}if(n!==null&&!r?this.handleExit(i,s):n===null&&r&&this.handleEnter(i,s),r){const a=this.dropTargetEvent(r,e,t);r.onDragEnter?.(a)}this.lastDropTarget=r}else if(r){const a=this.dropTargetEvent(r,e,t);r.onDragging?.(a),a?.changed&&(o=!0)}this.lastMouseEvent=e,o&&this.updateDragImageComp()}clearDragAndDropProperties(){this.removeDragImageComp(this.dragImageComp),this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0,this.lastMouseEvent=null,this.lastDraggingEvent=null,this.lastDropTarget=null,this.dragItem=null,this.dragInitialSourcePointerOffsetX=0,this.dragInitialSourcePointerOffsetY=0,this.dragSource=null}getAllContainersFromDropTarget(e){const t=e.getContainer(),r=e.getSecondaryContainers?.(),n=r?.length;if(!n)return[[t]];const i=new Array(n+1);i[0]=[t];for(let s=0;s<n;++s)i[s+1]=r[s];return i}isMouseOnDropTarget(e,t){const r=this.getAllContainersFromDropTarget(t);let n=!1;const i=(a,l)=>{for(const c of l){const{width:u,height:h,left:d,right:f,top:m,bottom:v}=c.getBoundingClientRect();if(u===0||h===0)return!1;const g=a.clientX>=d&&a.clientX<f,w=a.clientY>=m&&a.clientY<v;if(!g||!w)return!1}return!0};for(const a of r)if(i(e,a)){n=!0;break}const{eElement:s,type:o}=this.dragSource;return t.targetContainsSource&&!t.getContainer().contains(s)?!1:n&&t.isInterestedIn(o,s)}findCurrentDropTarget(e){const t=[],r=this.dropTargets;for(let o=0,a=r.length;o<a;++o){const l=r[o];this.isMouseOnDropTarget(e,l)&&t.push(l)}const n=t.length;if(n===0)return null;if(n===1)return t[0];const s=ho(this.beans).elementsFromPoint(e.clientX,e.clientY);for(let o=0,a=s.length;o<a;++o){const l=s[o];for(let c=0,u=t.length;c<u;c++){const h=t[c],d=this.getAllContainersFromDropTarget(h);let f=!1;for(let m=0,v=d.length;m<v&&!f;m++){const g=d[m];for(let w=0,y=g.length;w<y;w++)if(g[w]===l){f=!0;break}}if(f)return h}}return null}addDropTarget(e){this.dropTargets.push(e),e.external&&this.externalDropZoneCount++}removeDropTarget(e){const t=e.getContainer(),r=this.dropTargets;let n=0;for(let i=0,s=r.length;i<s;++i){const o=r[i];if(o.getContainer()===t){o.external&&--this.externalDropZoneCount;continue}n!==i&&(r[n]=o),++n}r.length=n}hasExternalDropZones(){return this.externalDropZoneCount>0}findExternalZone(e){const t=this.dropTargets;for(let r=0,n=t.length;r<n;++r){const i=t[r];if(i.external&&i.getContainer()===e)return i}return null}dropTargetEvent(e,t,r){const{dragSource:n,dragItem:i,lastDraggingEvent:s,lastMouseEvent:o,dragInitialSourcePointerOffsetX:a,dragInitialSourcePointerOffsetY:l}=this,c=e.getContainer(),u=c.getBoundingClientRect(),{clientX:h,clientY:d}=t,f=h-(o?.clientX||0),m=d-(o?.clientY||0),v=this.createEvent({event:t,x:h-u.left,y:d-u.top,vDirection:m>0?"down":m<0?"up":null,hDirection:f<0?"left":f>0?"right":null,initialSourcePointerOffsetX:a,initialSourcePointerOffsetY:l,dragSource:n,fromNudge:r,dragItem:i,dropZoneTarget:c,dropTarget:s?.dropTarget??null,changed:!!s?.changed});return this.lastDraggingEvent=v,v}positionDragImageComp(e){const t=this.dragImageComp?.getGui();t&&iD(t,e,this.beans)}removeDragImageComp(e){this.dragImageComp===e&&(this.dragImageComp=null),e&&(e.getGui()?.remove(),this.destroyBean(e))}createAndUpdateDragImageComp(e){const t=this.createDragImageComp(e)??null;this.dragImageCompPromise=t,t?.then(r=>{if(t!==this.dragImageCompPromise||!this.lastMouseEvent||!this.isAlive()){this.destroyBean(r);return}this.dragImageCompPromise=null,this.dragImageLastIcon=void 0,this.dragImageLastLabel=void 0;const n=this.dragImageComp;n!==r&&(this.dragImageComp=r,this.removeDragImageComp(n)),r&&(this.appendDragImageComp(r),this.updateDragImageComp())})}appendDragImageComp(e){const t=e.getGui(),r=t.style;r.position="absolute",r.zIndex="9999",this.beans.dragSvc?.hasPointerCapture()&&(r.pointerEvents="none"),this.gos.setInstanceDomData(t),this.beans.environment.applyThemeClasses(t),r.top="20px",r.left="20px";const n=ry(this.beans);n?n.appendChild(t):this.warnNoBody()}updateDragImageComp(){const{dragImageComp:e,dragSource:t,lastDropTarget:r,lastDraggingEvent:n,dragImageLastLabel:i}=this;if(!e)return;this.setDragImageCompIcon(r?.getIconName?.(n)??null);let s=t?.dragItemName;typeof s=="function"&&(s=s(n)),s||(s=""),i!==s&&(this.dragImageLastLabel=s,e.setLabel(s))}},_9=class extends _i{constructor(e,t){super(),this.comp=e,this.stopPropagationCallbacks=t}initialiseTabGuard(e){this.eTopGuard=this.createTabGuard("top"),this.eBottomGuard=this.createTabGuard("bottom"),this.eFocusableElement=this.comp.getFocusableElement();const{eTopGuard:t,eBottomGuard:r,eFocusableElement:n,stopPropagationCallbacks:i}=this,s=[t,r],o={setTabIndex:w=>{for(const y of s)w==null?y.removeAttribute("tabindex"):y.setAttribute("tabindex",w)}};this.addTabGuards(t,r);const{focusTrapActive:a=!1,onFocusIn:l,onFocusOut:c,focusInnerElement:u,handleKeyDown:h,onTabKeyDown:d,shouldStopEventPropagation:f,isEmpty:m,forceFocusOutWhenTabGuardsAreEmpty:v,isFocusableContainer:g}=e;this.tabGuardCtrl=this.createManagedBean(new Tk({comp:o,focusTrapActive:a,eTopGuard:t,eBottomGuard:r,eFocusableElement:n,onFocusIn:l,onFocusOut:c,focusInnerElement:u,handleKeyDown:h,onTabKeyDown:d,shouldStopEventPropagation:f,isEmpty:m,forceFocusOutWhenTabGuardsAreEmpty:v,isFocusableContainer:g},i))}getTabGuardCtrl(){return this.tabGuardCtrl}createTabGuard(e){const t=Gn(this.beans).createElement("div"),r=e==="top"?Yu.TAB_GUARD_TOP:Yu.TAB_GUARD_BOTTOM;return t.classList.add(Yu.TAB_GUARD,r),gc(t,"presentation"),t}addTabGuards(e,t){const r=this.eFocusableElement;r.prepend(e),r.append(t)}removeAllChildrenExceptTabGuards(){const e=[this.eTopGuard,this.eBottomGuard];Hi(this.comp.getFocusableElement()),this.addTabGuards(...e)}forceFocusOutOfContainer(e=!1){this.tabGuardCtrl.forceFocusOutOfContainer(e)}appendChild(e,t,r){cy(t)||(t=t.getGui());const{eBottomGuard:n}=this;n?n.before(t):e(t,r)}destroy(){const{eTopGuard:e,eBottomGuard:t}=this;ol(e),ol(t),super.destroy()}},E9=class extends Sd{initialiseTabGuard(e,t){this.tabGuardFeature=this.createManagedBean(new _9(this,t)),this.tabGuardFeature.initialiseTabGuard(e)}forceFocusOutOfContainer(e=!1){this.tabGuardFeature.forceFocusOutOfContainer(e)}appendChild(e,t){this.tabGuardFeature.appendChild(super.appendChild.bind(this),e,t)}},T9=class extends S9{createEvent(e){return Dt(this.gos,e)}createDragImageComp(e){const{gos:t,beans:r}=this;return HP(r.userCompFactory,Dt(t,{dragSource:e}))?.newAgStackInstance()}handleEnter(e,t){e?.onGridEnter?.(t)}handleExit(e,t){e?.onGridExit?.(t)}warnNoBody(){at(54)}isDropZoneWithinThisGrid(e){return this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody.contains(e.dropZoneTarget)}registerGridDropTarget(e,t){const r={getContainer:e,isInterestedIn:n=>n===1||n===0,getIconName:()=>"notAllowed"};this.addDropTarget(r),t.addDestroyFunc(()=>this.removeDropTarget(r))}};function Gk(e,t){return e+"_"+t}function yn(e){return e instanceof gf}var gf=class extends et{constructor(e,t,r,n){super(),this.providedColumnGroup=e,this.groupId=t,this.partId=r,this.pinned=n,this.isColumn=!1,this.displayedChildren=[],this.autoHeaderHeight=null,this.parent=null,this.colIdSanitised=Hh(this.getUniqueId())}reset(){this.parent=null,this.children=null,this.displayedChildren=null}getParent(){return this.parent}getUniqueId(){return Gk(this.groupId,this.partId)}isEmptyGroup(){return this.displayedChildren.length===0}isMoving(){const e=this.getProvidedColumnGroup().getLeafColumns();return!e||e.length===0?!1:e.every(t=>t.isMoving())}checkLeft(){for(const e of this.displayedChildren)yn(e)&&e.checkLeft();if(this.displayedChildren.length>0)if(this.gos.get("enableRtl")){const t=zr(this.displayedChildren).getLeft();this.setLeft(t)}else{const e=this.displayedChildren[0].getLeft();this.setLeft(e)}else this.setLeft(null)}getLeft(){return this.left}getOldLeft(){return this.oldLeft}setLeft(e){this.oldLeft=this.left,this.left!==e&&(this.left=e,this.dispatchLocalEvent({type:"leftChanged"}))}getPinned(){return this.pinned}getGroupId(){return this.groupId}getPartId(){return this.partId}getActualWidth(){let e=0;for(const t of this.displayedChildren??[])e+=t.getActualWidth();return e}isResizable(){if(!this.displayedChildren)return!1;let e=!1;for(const t of this.displayedChildren)t.isResizable()&&(e=!0);return e}getMinWidth(){let e=0;for(const t of this.displayedChildren)e+=t.getMinWidth();return e}addChild(e){this.children||(this.children=[]),this.children.push(e)}getDisplayedChildren(){return this.displayedChildren}getLeafColumns(){const e=[];return this.addLeafColumns(e),e}getDisplayedLeafColumns(){const e=[];return this.addDisplayedLeafColumns(e),e}getDefinition(){return this.providedColumnGroup.getColGroupDef()}getColGroupDef(){return this.providedColumnGroup.getColGroupDef()}isPadding(){return this.providedColumnGroup.isPadding()}isExpandable(){return this.providedColumnGroup.isExpandable()}isExpanded(){return this.providedColumnGroup.isExpanded()}setExpanded(e){this.providedColumnGroup.setExpanded(e)}isAutoHeaderHeight(){return!!this.getColGroupDef()?.autoHeaderHeight}getAutoHeaderHeight(){return this.autoHeaderHeight}setAutoHeaderHeight(e){const t=e!==this.autoHeaderHeight;return this.autoHeaderHeight=e,t}addDisplayedLeafColumns(e){for(const t of this.displayedChildren??[])cl(t)?e.push(t):yn(t)&&t.addDisplayedLeafColumns(e)}addLeafColumns(e){for(const t of this.children??[])cl(t)?e.push(t):yn(t)&&t.addLeafColumns(e)}getChildren(){return this.children}getColumnGroupShow(){return this.providedColumnGroup.getColumnGroupShow()}getProvidedColumnGroup(){return this.providedColumnGroup}getPaddingLevel(){const e=this.getParent();return!this.isPadding()||!e?.isPadding()?0:1+e.getPaddingLevel()}calculateDisplayedColumns(){this.displayedChildren=[];let e=this;for(;e?.isPadding();)e=e.getParent();if(!(e?e.getProvidedColumnGroup().isExpandable():!1)){this.displayedChildren=this.children,this.dispatchLocalEvent({type:"displayedChildrenChanged"});return}for(const r of this.children??[]){if(yn(r)&&!r.displayedChildren?.length)continue;switch(r.getColumnGroupShow()){case"open":e.getProvidedColumnGroup().isExpanded()&&this.displayedChildren.push(r);break;case"closed":e.getProvidedColumnGroup().isExpanded()||this.displayedChildren.push(r);break;default:this.displayedChildren.push(r);break}}this.dispatchLocalEvent({type:"displayedChildrenChanged"})}},a4="row-group-",Ty="t-",ky="b-",k9=0,ul=class{constructor(e){this.id=void 0,this.destroyed=!1,this._groupData=void 0,this.master=!1,this.detail=void 0,this.rowIndex=null,this.field=null,this.rowGroupColumn=null,this.key=null,this.sourceRowIndex=-1,this._leafs=void 0,this.childrenMapped=null,this.treeParent=null,this.treeNodeFlags=0,this.displayed=!1,this.rowTop=null,this.oldRowTop=null,this.selectable=!0,this.__objectId=k9++,this.alreadyRendered=!1,this.formulaRowIndex=null,this.hovered=!1,this.__selected=!1,this.beans=e}get groupData(){const e=this._groupData;return e!==void 0?e:this.footer?this.sibling?.groupData:this.beans.groupStage?.loadGroupData(this)??null}set groupData(e){this._groupData=e}get allLeafChildren(){const e=this._leafs;return e===void 0?this.beans.groupStage?.loadLeafs?.(this)??null:e}set allLeafChildren(e){this._leafs=e}setData(e){this.setDataCommon(e,!1)}updateData(e){this.setDataCommon(e,!0)}setDataCommon(e,t){const{valueCache:r,eventSvc:n}=this.beans,i=this.data;this.data=e,r?.onDataChanged(),this.updateDataOnDetailNode(),this.resetQuickFilterAggregateText();const s=this.createDataChangedEvent(e,i,t);if(this.__localEventService?.dispatchEvent(s),this.sibling){this.sibling.data=e;const a=this.sibling.createDataChangedEvent(e,i,t);this.sibling.__localEventService?.dispatchEvent(a)}n.dispatchEvent({type:"rowNodeDataChanged",node:this});const o=this.pinnedSibling;o&&(o.data=e,o.__localEventService?.dispatchEvent(o.createDataChangedEvent(e,i,t)),n.dispatchEvent({type:"rowNodeDataChanged",node:o}))}updateDataOnDetailNode(){const e=this.detailNode;e&&(e.data=this.data)}createDataChangedEvent(e,t,r){return{type:"dataChanged",node:this,oldData:t,newData:e,update:r}}getRowIndexString(){return this.rowIndex==null?(Ar(13),null):this.rowPinned==="top"?Ty+this.rowIndex:this.rowPinned==="bottom"?ky+this.rowIndex:this.rowIndex.toString()}setDataAndId(e,t){const{selectionSvc:r}=this.beans,n=r?.createDaemonNode?.(this),i=this.data;this.data=e,this.updateDataOnDetailNode(),this.setId(t),r&&(r.updateRowSelectable(this),r.syncInRowNode(this,n));const s=this.createDataChangedEvent(e,i,!1);this.__localEventService?.dispatchEvent(s)}setId(e){const t=ld(this.beans.gos);if(t)if(this.data){const r=this.parent?.getRoute()??[];this.id=t({data:this.data,parentKeys:r.length>0?r:void 0,level:this.level,rowPinned:this.rowPinned}),this.id.startsWith(a4)&&Ar(14,{groupPrefix:a4})}else this.id=void 0;else this.id=e}setRowTop(e){if(this.oldRowTop=this.rowTop,this.rowTop===e)return;this.rowTop=e,this.dispatchRowEvent("topChanged");const t=e!==null;this.displayed!==t&&(this.displayed=t,this.dispatchRowEvent("displayedChanged"))}clearRowTopAndRowIndex(){this.oldRowTop=null,this.setRowTop(null),this.setRowIndex(null)}setHovered(e){this.hovered=e}isHovered(){return this.hovered}setRowHeight(e,t=!1){this.rowHeight=e,this.rowHeightEstimated=t,this.dispatchRowEvent("heightChanged")}setExpanded(e,t,r){this.beans.expansionSvc?.setExpanded(this,e,t,r)}setDataValue(e,t,r){const{colModel:n,valueSvc:i,gos:s,editSvc:o}=this.beans,a=typeof e!="string"?e:n.getCol(e)??n.getColDefCol(e);if(!a)return!1;const l=i.getValueForDisplay({column:a,node:this,source:"api"}).value;if(s.get("readOnlyEdit")){const{beans:{eventSvc:u},data:h,rowIndex:d,rowPinned:f}=this;return u.dispatchEvent({type:"cellEditRequest",event:null,rowIndex:d,rowPinned:f,column:a,colDef:a.colDef,data:h,node:this,oldValue:l,newValue:t,value:t,source:r}),!1}if(o&&!o.committing){const u=o.setDataValue({rowNode:this,column:a},t,r);if(u!=null)return u}const c=i.setValue(this,a,t,r);return this.dispatchCellChangedEvent(a,t,l),c&&this.pinnedSibling?.dispatchCellChangedEvent(a,t,l),c}updateHasChildren(){let e=this.group&&!this.footer||!!this.childrenAfterGroup?.length;const{rowChildrenSvc:t}=this.beans;t&&(e=t.getHasChildrenValue(this)),e!==this.__hasChildren&&(this.__hasChildren=!!e,this.dispatchRowEvent("hasChildrenChanged"))}hasChildren(){return this.__hasChildren==null&&this.updateHasChildren(),this.__hasChildren}dispatchCellChangedEvent(e,t,r){const n={type:"cellChanged",node:this,column:e,newValue:t,oldValue:r};this.__localEventService?.dispatchEvent(n)}resetQuickFilterAggregateText(){this.quickFilterAggregateText=null}isExpandable(){return this.beans.expansionSvc?.isExpandable(this)??!1}isSelected(){if(this.footer)return this.sibling.isSelected();const e=this.rowPinned&&this.pinnedSibling;return e?e.isSelected():this.__selected}depthFirstSearch(e){const t=this.childrenAfterGroup;if(t)for(let r=0,n=t.length;r<n;++r)t[r].depthFirstSearch(e);e(this)}dispatchRowEvent(e){this.__localEventService?.dispatchEvent({type:e,node:this})}setSelected(e,t=!1,r="api"){this.beans.selectionSvc?.setNodesSelected({nodes:[this],newValue:e,clearSelection:t,source:r})}isRowPinned(){return!!this.rowPinned}__addEventListener(e,t){(this.__localEventService??(this.__localEventService=new pc)).addEventListener(e,t)}__removeEventListener(e,t){this.removeLocalListener(e,t)}addEventListener(e,t){this.beans.validation?.checkRowEvents(e);const r=this.__localEventService??(this.__localEventService=new pc);this.frameworkEventListenerService=this.beans.frameworkOverrides.createLocalEventListenerWrapper?.(this.frameworkEventListenerService,r);const n=this.frameworkEventListenerService?.wrap(e,t)??t;r.addEventListener(e,n)}removeEventListener(e,t){const r=this.frameworkEventListenerService?.unwrap(e,t)??t;this.removeLocalListener(e,r)}removeLocalListener(e,t){const r=this.__localEventService;r&&(r.removeEventListener(e,t),r.noRegisteredListenersExist()&&(this.__localEventService=null))}isFullWidthCell(){if(at(61),this.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this}):!1}getRoute(){if(this.level===-1)return[];if(this.key==null)return;const e=[];let t=this;for(;t?.key!=null;)e.push(t.key),t=t.parent;return e.reverse()}setRowIndex(e){this.rowIndex!==e&&(this.rowIndex=e,this.dispatchRowEvent("rowIndexChanged"))}setAllChildrenCount(e){this.allChildrenCount!==e&&(this.allChildrenCount=e,this.dispatchRowEvent("allChildrenCountChanged"))}setUiLevel(e){this.uiLevel!==e&&(this.uiLevel=e,this.dispatchRowEvent("uiLevelChanged"))}getFirstChild(){const e=this.childStore;return e?e.getFirstNode():this.childrenAfterSort?.[0]??null}_destroy(e){if(this.destroyed)return!1;if(this.destroyed=!0,e?this.clearRowTopAndRowIndex():(this.setRowTop(null),this.setRowIndex(null)),!this.footer){const t=this.detailNode;t&&t._destroy(e);const r=this.sibling;r&&r._destroy(e)}return!0}};function R9(e,t,r){return Dt(t,{type:r,node:e,data:e.data,rowIndex:e.rowIndex,rowPinned:e.rowPinned})}var A9=new Set(["__autoHeights","__checkAutoHeightsDebounced","__localEventService","__objectId","_groupData","_leafs","childStore","groupValue","oldRowTop","sticky","treeNodeFlags","treeParent"]),F9=(e,t)=>{const r=new ul(t);for(const n of Object.keys(e))A9.has(n)||(r[n]=e[n]);return r.oldRowTop=null,r},hw=(e,t,r)=>{if(!r)return;let n=r.rowIndex;if(n==null)return;n+=t;const i=e.getRowCount();for(;n>=0&&n<i;){const s=e.getRow(n);if(!s||!s.footer&&!s.detail)return s;n+=t}},zk={agSetColumnFilter:"agSetColumnFilterHandler",agMultiColumnFilter:"agMultiColumnFilterHandler",agGroupColumnFilter:"agGroupColumnFilterHandler",agNumberColumnFilter:"agNumberColumnFilterHandler",agDateColumnFilter:"agDateColumnFilterHandler",agTextColumnFilter:"agTextColumnFilterHandler"},M9=new Set(Object.values(zk));function qa(e,t){const r=e.filterUi;if(!r)return null;if(r.created)return r.promise;if(t)return null;const n=r.create(r.refreshed),i=r;return i.created=!0,i.promise=n,n}function D9(e,t,r,n,i,s,o){return t.refresh?.({...r,model:n,source:s,additionalEventAttributes:o}),e().then(a=>{if(a){const{filter:l,filterParams:c}=a;Uk(l,c,n,i,s,o)}})}function Uk(e,t,r,n,i,s){e?.refresh?.({...t,model:r,state:n,source:i,additionalEventAttributes:s})}function Wk(e,t,r,n){const i=e();i?.created&&i.promise.then(s=>{const o=t();Uk(s,i.filterParams,o,r()??{model:o},"ui",n)})}function l4(e){let t,r=!1,n;const{action:i,filterParams:s,getFilterUi:o,getModel:a,getState:l,updateState:c,updateModel:u,processModelToApply:h}=e;switch(i){case"apply":{const d=l();n=d?.model??null,h&&(n=h(n)),t={state:d?.state,model:n},r=!0;break}case"clear":{t={model:null},s?.buttons?.includes("apply")||(r=!0,n=null);break}case"reset":{t={model:null},r=!0,n=null;break}case"cancel":{t={model:a()};break}}c(t),r?u(n):Wk(o,a,l,{fromAction:i})}function Hn(e,t){return e[t]??null}function ks(e){return nl(e)}function P9(e){return{tag:"div",cls:e}}var I9=class extends pn{constructor(e){const{className:t="ag-filter-apply-panel"}=e??{};super(P9(t)),this.listeners=[],this.validationMessage=null,this.className=t}updateButtons(e,t){const r=this.buttons;if(this.buttons=e,r===e)return;const n=this.getGui();Hi(n);let i;this.destroyListeners();const s=document.createDocumentFragment(),o=this.className,a=({type:c,label:u})=>{const h=w=>{this.dispatchLocalEvent({type:c,event:w})};["apply","clear","reset","cancel"].includes(c)||at(75);const d=c==="apply",m=ks({tag:"button",attrs:{type:d&&t?"submit":"button"},ref:`${c}FilterButton`,cls:`ag-button ag-standard-button ${o}-button${d?" "+o+"-apply-button":""}`,children:u});this.activateTabIndex([m]),d&&(i=m);const v=w=>{w.key===$e.ENTER&&(w.preventDefault(),h(w))},g=this.listeners;m.addEventListener("click",h),g.push(()=>m.removeEventListener("click",h)),m.addEventListener("keydown",v),g.push(()=>m.removeEventListener("keydown",v)),s.append(m)};for(const c of e)a(c);this.eApply=i;const l=this.validationTooltipFeature;i&&!l?this.validationTooltipFeature=this.createOptionalManagedBean(this.beans.registry.createDynamicBean("tooltipFeature",!1,{getGui:()=>this.eApply,getLocation:()=>"advancedFilter",getTooltipShowDelayOverride:()=>1e3})):!i&&l&&(this.validationTooltipFeature=this.destroyBean(l)),n.append(s)}getApplyButton(){return this.eApply}updateValidity(e,t=null){const r=this.eApply;r&&(lf(r,!e),this.validationMessage=t,this.validationTooltipFeature?.setTooltipAndRefresh(this.validationMessage))}destroyListeners(){for(const e of this.listeners)e();this.listeners=[]}destroy(){this.destroyListeners(),super.destroy()}},O9={applyFilter:"Apply",clearFilter:"Clear",resetFilter:"Reset",cancelFilter:"Cancel",textFilter:"Text Filter",numberFilter:"Number Filter",dateFilter:"Date Filter",setFilter:"Set Filter",filterOoo:"Filter...",empty:"Choose one",equals:"Equals",notEqual:"Does not equal",lessThan:"Less than",greaterThan:"Greater than",inRange:"Between",inRangeStart:"From",inRangeEnd:"To",lessThanOrEqual:"Less than or equal to",greaterThanOrEqual:"Greater than or equal to",contains:"Contains",notContains:"Does not contain",startsWith:"Begins with",endsWith:"Ends with",blank:"Blank",notBlank:"Not blank",before:"Before",after:"After",andCondition:"AND",orCondition:"OR",dateFormatOoo:"yyyy-mm-dd",filterSummaryInactive:"is (All)",filterSummaryContains:"contains",filterSummaryNotContains:"does not contain",filterSummaryTextEquals:"equals",filterSummaryTextNotEqual:"does not equal",filterSummaryStartsWith:"begins with",filterSummaryEndsWith:"ends with",filterSummaryBlank:"is blank",filterSummaryNotBlank:"is not blank",filterSummaryEquals:"=",filterSummaryNotEqual:"!=",filterSummaryGreaterThan:">",filterSummaryGreaterThanOrEqual:">=",filterSummaryLessThan:"<",filterSummaryLessThanOrEqual:"<=",filterSummaryInRange:"between",filterSummaryInRangeValues:e=>`(${e[0]}, ${e[1]})`,filterSummaryTextQuote:e=>`"${e[0]}"`,minDateValidation:e=>`Date must be after ${e[0]}`,maxDateValidation:e=>`Date must be before ${e[0]}`,strictMinValueValidation:e=>`Must be greater than ${e[0]}`,strictMaxValueValidation:e=>`Must be less than ${e[0]}`};function go(e,t,r){return oD(e,O9,t,r)}function Ry(e,t){const{debounceMs:r}=e;return am(e)?(r!=null&&at(71),0):r??t}function am(e){return(e.buttons?.indexOf("apply")??-1)>=0}function $k(e,t,r,n){let i=go(e,r);if(typeof t=="function"){const s=go(e,n);i=t({filterOptionKey:n,filterOption:s,placeholder:i})}else typeof t=="string"&&(i=t);return i}var N9=class extends pn{constructor(e,t,r,n,i,s){super(),this.column=e,this.wrapper=t,this.eventParent=r,this.updateModel=n,this.isGlobalButtons=i,this.enableGlobalButtonCheck=s,this.hidePopup=null,this.applyActive=!1}postConstruct(){const{comp:e,params:t}=this.wrapper,r=t,n=r.useForm,i=n?"form":"div";this.setTemplate({tag:i,cls:"ag-filter-wrapper"}),n&&this.addManagedElementListeners(this.getGui(),{submit:s=>{s?.preventDefault()},keydown:this.handleKeyDown.bind(this)}),this.appendChild(e.getGui()),this.params=r,this.resetButtonsPanel(r),this.addManagedListeners(this.eventParent,{filterParamsChanged:({column:s,params:o})=>{s===this.column&&this.resetButtonsPanel(o,this.params)},filterStateChanged:({column:s,state:o})=>{s===this.column&&this.eButtons?.updateValidity(o.valid!==!1)},filterAction:({column:s,action:o,event:a})=>{s===this.column&&this.afterAction(o,a)},...this.enableGlobalButtonCheck?{filterGlobalButtons:({isGlobal:s})=>{if(s!==this.isGlobalButtons){this.isGlobalButtons=s;const o=this.params;this.resetButtonsPanel(o,o,!0)}}}:void 0})}afterGuiAttached(e){e&&(this.hidePopup=e.hidePopup)}resetButtonsPanel(e,t,r){const{buttons:n,readOnly:i}=t??{},{buttons:s,readOnly:o,useForm:a}=e;if(!r&&i===o&&of(n,s))return;const l=s&&s.length>0&&!e.readOnly&&!this.isGlobalButtons;let c=this.eButtons;if(l){const u=s.map(h=>{const d=`${h}Filter`;return{type:h,label:go(this,d)}});if(this.applyActive=am(this.params),!c){c=this.createBean(new I9),this.appendChild(c.getGui());const h=this.column,d=f=>({event:m})=>{this.updateModel(h,f,{fromButtons:!0}),this.afterAction(f,m)};c?.addManagedListeners(c,{apply:d("apply"),clear:d("clear"),reset:d("reset"),cancel:d("cancel")}),this.eButtons=c}c.updateButtons(u,a)}else this.applyActive=!1,c&&(ol(c.getGui()),this.eButtons=this.destroyBean(c))}close(e){const t=this.hidePopup;if(!t)return;const r=e,n=r?.key;let i;(n===$e.ENTER||n===$e.SPACE)&&(i={keyboardEvent:r}),t(i),this.hidePopup=null}afterAction(e,t){const{params:r,applyActive:n}=this,i=r?.closeOnApply;switch(e){case"apply":{t?.preventDefault(),i&&n&&this.close(t);break}case"reset":{i&&n&&this.close();break}case"cancel":{i&&this.close(t);break}}}handleKeyDown(e){!e.defaultPrevented&&e.key===$e.ENTER&&this.applyActive&&(this.updateModel(this.column,"apply",{fromButtons:!0}),this.afterAction("apply",e))}destroy(){this.hidePopup=null,this.eButtons=this.destroyBean(this.eButtons)}},L9={tag:"div",cls:"ag-filter"},B9=class extends pn{constructor(e,t,r){super(L9),this.column=e,this.source=t,this.enableGlobalButtonCheck=r,this.wrapper=null}postConstruct(){this.beans.colFilter?.activeFilterComps.add(this),this.createFilter(!0),this.addManagedEventListeners({filterDestroyed:this.onFilterDestroyed.bind(this)})}hasFilter(){return this.wrapper!=null}getFilter(){return this.wrapper?.then(e=>e.comp)??null}afterInit(){return this.wrapper?.then(()=>{})??hr.resolve()}afterGuiAttached(e){this.afterGuiAttachedParams=e,this.wrapper?.then(t=>{this.comp?.afterGuiAttached(e),t?.comp?.afterGuiAttached?.(e)})}afterGuiDetached(){this.wrapper?.then(e=>{e?.comp?.afterGuiDetached?.()})}createFilter(e){const{column:t,source:r,beans:{colFilter:n}}=this,i=n.getFilterUiForDisplay(t)??null;this.wrapper=i,i?.then(s=>{if(!s)return;const{isHandler:o,comp:a}=s;let l;if(o){const c=!!this.enableGlobalButtonCheck,u=this.createBean(new N9(t,s,n,n.updateModel.bind(n),c&&n.isGlobalButtons,c));this.comp=u,l=u.getGui()}else l=a.getGui(),bt(l)||at(69,{guiFromFilter:l});this.appendChild(l),e?this.eventSvc.dispatchEvent({type:"filterOpened",column:t,source:r,eGui:this.getGui()}):a.afterGuiAttached?.(this.afterGuiAttachedParams)})}onFilterDestroyed(e){const{source:t,column:r}=e;(t==="api"||t==="paramsUpdated")&&r.getId()===this.column.getId()&&this.beans.colModel.getColDefCol(this.column)&&(Hi(this.getGui()),this.comp=this.destroyBean(this.comp),this.createFilter())}destroy(){this.beans.colFilter?.activeFilterComps.delete(this),this.eventSvc.dispatchEvent({type:"filterClosed",column:this.column}),this.wrapper=null,this.comp=this.destroyBean(this.comp),this.afterGuiAttachedParams=void 0,super.destroy()}},c4={january:"January",february:"February",march:"March",april:"April",may:"May",june:"June",july:"July",august:"August",september:"September",october:"October",november:"November",december:"December"},u4=["january","february","march","april","may","june","july","august","september","october","november","december"];function H9(e,t){return e==null?-1:t==null?1:Number.parseFloat(e)-Number.parseFloat(t)}function d4(e){return e instanceof Date&&!isNaN(e.getTime())}var fw={number:()=>{},boolean:()=>({maxNumConditions:1,debounceMs:0,filterOptions:["empty",{displayKey:"true",displayName:"True",predicate:(e,t)=>t,numberOfInputs:0},{displayKey:"false",displayName:"False",predicate:(e,t)=>t===!1,numberOfInputs:0}]}),date:()=>({isValidDate:d4}),dateString:({dataTypeDefinition:e})=>({comparator:(t,r)=>{const n=e.dateParser(r);return r==null||n<t?-1:n>t?1:0},isValidDate:t=>typeof t=="string"&&d4(e.dateParser(t))}),dateTime:e=>fw.date(e),dateTimeString:e=>fw.dateString(e),object:()=>{},text:()=>{}},pw={number:()=>({comparator:H9}),boolean:({t:e})=>({valueFormatter:t=>bt(t.value)?e(String(t.value),t.value?"True":"False"):e("blanks","(Blanks)")}),date:({formatValue:e,t})=>({valueFormatter:r=>{const n=e(r);return bt(n)?n:t("blanks","(Blanks)")},treeList:!0,treeListFormatter:(r,n)=>{if(r==="NaN")return t("invalidDate","Invalid Date");if(n===1&&r!=null){const i=u4[Number(r)-1];return t(i,c4[i])}return r??t("blanks","(Blanks)")},treeListPathGetter:r=>fg(r,!1)}),dateString:({formatValue:e,dataTypeDefinition:t,t:r})=>({valueFormatter:n=>{const i=e(n);return bt(i)?i:r("blanks","(Blanks)")},treeList:!0,treeListPathGetter:n=>fg(t.dateParser(n??void 0),!1),treeListFormatter:(n,i)=>{if(i===1&&n!=null){const s=u4[Number(n)-1];return r(s,c4[s])}return n??r("blanks","(Blanks)")}}),dateTime:e=>{const t=pw.date(e);return t.treeListPathGetter=fg,t},dateTimeString(e){const t=e.dataTypeDefinition.dateParser,r=pw.dateString(e);return r.treeListPathGetter=n=>fg(t(n??void 0)),r},object:({formatValue:e,t})=>({valueFormatter:r=>{const n=e(r);return bt(n)?n:t("blanks","(Blanks)")}}),text:()=>{}};function j9(e,t,r,n,i,s,o){let a=t,l=r;const c=e==="agSetColumnFilter";!l&&n.baseDataType==="object"&&!c&&(l=({column:f,node:m})=>i({column:f,node:m,value:s.valueSvc.getValue(f,m)}));const h=(c?pw:fw)[n.baseDataType],d=h({dataTypeDefinition:n,formatValue:i,t:o});return a=typeof t=="object"?{...d,...t}:d,{filterParams:a,filterValueGetter:l}}var V9={boolean:"agTextColumnFilter",date:"agDateColumnFilter",dateString:"agDateColumnFilter",dateTime:"agDateColumnFilter",dateTimeString:"agDateColumnFilter",number:"agNumberColumnFilter",object:"agTextColumnFilter",text:"agTextColumnFilter"},G9={boolean:"agTextColumnFloatingFilter",date:"agDateColumnFloatingFilter",dateString:"agDateColumnFloatingFilter",dateTime:"agDateColumnFloatingFilter",dateTimeString:"agDateColumnFloatingFilter",number:"agNumberColumnFloatingFilter",object:"agTextColumnFloatingFilter",text:"agTextColumnFloatingFilter"};function z9(e,t=!1){return(t?G9:V9)[e??"text"]}var U9=class extends f7{},qk="__ag_Grid_Stop_Propagation";function wc(e){e[qk]=!0}function na(e){return e[qk]===!0}var Ay={isStopPropagation:na,stopPropagation:wc},zf=class extends Ek{constructor(e,t){super(e,Ay,t)}},W9=class extends pn{constructor(e,t){super(),this.filterNameKey=e,this.cssIdentifier=t,this.applyActive=!1,this.debouncePending=!1,this.defaultDebounceMs=0}postConstruct(){const e={tag:"div",cls:`ag-filter-body-wrapper ag-${this.cssIdentifier}-body-wrapper`,children:[this.createBodyTemplate()]};this.setTemplate(e,this.getAgComponents()),this.createManagedBean(new zf(this.getFocusableElement(),{handleKeyDown:this.handleKeyDown.bind(this)})),this.positionableFeature=this.createBean(new U9(this.getPositionableElement(),{forcePopupParentAsOffsetParent:!0}))}handleKeyDown(e){}init(e){const t=e;this.setParams(t),this.setModelIntoUi(t.state.model,!0).then(()=>this.updateUiVisibility())}areStatesEqual(e,t){return e===t}refresh(e){const t=e,r=this.params;this.params=t;const{source:n,state:i,additionalEventAttributes:s}=t;n==="colDef"&&this.updateParams(t,r);const o=this.state;this.state=i;const a=s?.fromAction;return(a&&a!=="apply"||i.model!==o.model||!this.areStatesEqual(i.state,o.state))&&this.setModelIntoUi(i.model),!0}setParams(e){this.params=e,this.state=e.state,this.commonUpdateParams(e)}updateParams(e,t){this.commonUpdateParams(e,t)}commonUpdateParams(e,t){this.applyActive=am(e),this.setupApplyDebounced()}doesFilterPass(e){at(283);const{getHandler:t,model:r,column:n}=this.params;return t().doesFilterPass({...e,model:r,handlerParams:this.beans.colFilter.getHandlerParams(n)})}getFilterTitle(){return this.translate(this.filterNameKey)}isFilterActive(){return at(284),this.params.model!=null}setupApplyDebounced(){const e=Ry(this.params,this.defaultDebounceMs),t=zn(this,this.checkApplyDebounce.bind(this),e);this.applyDebounced=()=>{this.debouncePending=!0,t()}}checkApplyDebounce(){this.debouncePending&&(this.debouncePending=!1,this.doApplyModel())}getModel(){return at(285),this.params.model}setModel(e){at(286);const{beans:t,params:r}=this;return t.colFilter.setModelForColumnLegacy(r.column,e)}applyModel(e="api"){return this.doApplyModel()}canApply(e){return!0}doApplyModel(e){const{params:t,state:{valid:r=!0,model:n}}=this;if(!r)return!1;const i=!this.areModelsEqual(t.model,n);return i&&t.onAction("apply",e),i}onNewRowsLoaded(){}onUiChanged(e,t=!1){this.updateUiVisibility();const r=this.getModelFromUi(),n={model:r,state:this.getState(),valid:this.canApply(r)};this.state=n;const{params:i,gos:s,eventSvc:o,applyActive:a}=this;i.onStateChange(n),i.onUiChange(this.getUiChangeEventParams()),s.get("enableFilterHandlers")||o.dispatchEvent({type:"filterModified",column:i.column,filterInstance:this}),n.valid&&(e??(e=a?void 0:"debounce"),e==="immediately"?this.doApplyModel({afterFloatingFilter:t,afterDataChange:!1}):e==="debounce"&&this.applyDebounced())}getState(){}getUiChangeEventParams(){}afterGuiAttached(e){this.lastContainerType=e?.container,this.refreshFilterResizer(e?.container)}refreshFilterResizer(e){const{positionableFeature:t,gos:r}=this;if(!t)return;const n=e==="floatingFilter"||e==="columnFilter";n?(t.restoreLastSize(),t.setResizable(r.get("enableRtl")?{bottom:!0,bottomLeft:!0,left:!0}:{bottom:!0,bottomRight:!0,right:!0})):(t.removeSizeFromEl(),t.setResizable(!1)),t.constrainSizeToAvailableHeight(n)}afterGuiDetached(){this.checkApplyDebounce(),this.positionableFeature?.constrainSizeToAvailableHeight(!1)}destroy(){this.positionableFeature=this.destroyBean(this.positionableFeature),super.destroy()}translate(e,t){return go(this,e,t)}getPositionableElement(){return this.getGui()}areModelsEqual(e,t){return e===t||e==null&&t==null?!0:e==null||t==null?!1:this.areNonNullModelsEqual(e,t)}};function Kk(e){return!!e.operator}function $9(e,t,r){if(t==null)return null;let n=null;const{compName:i,jsComp:s,fwComp:o}=bk(e,t);return i?n={agSetColumnFilter:"agSetColumnFloatingFilter",agMultiColumnFilter:"agMultiColumnFloatingFilter",agGroupColumnFilter:"agGroupColumnFloatingFilter",agNumberColumnFilter:"agNumberColumnFloatingFilter",agDateColumnFilter:"agDateColumnFloatingFilter",agTextColumnFilter:"agTextColumnFloatingFilter"}[i]:s==null&&o==null&&t.filter===!0&&(n=r()),n}var e0={AUTO_HEIGHT:"ag-layout-auto-height",NORMAL:"ag-layout-normal",PRINT:"ag-layout-print"},Fy=class extends et{constructor(e){super(),this.view=e}postConstruct(){this.addManagedPropertyListener("domLayout",this.updateLayoutClasses.bind(this)),this.updateLayoutClasses()}updateLayoutClasses(){const e=this.gos.get("domLayout"),t={autoHeight:e==="autoHeight",normal:e==="normal",print:e==="print"},r=t.autoHeight?e0.AUTO_HEIGHT:t.print?e0.PRINT:e0.NORMAL;this.view.updateLayoutClasses(r,t)}},Ka="Viewport",h4="fakeVScrollComp",eb=["fakeHScrollComp","centerHeader","topCenter","bottomCenter","stickyTopCenter","stickyBottomCenter"],f4=100,tb=150,q9=class extends et{constructor(e){super(),this.clearRetryListenerFncs=[],this.lastScrollSource=[null,null],this.scrollLeft=-1,this.nextScrollTop=-1,this.scrollTop=-1,this.lastOffsetHeight=-1,this.lastScrollTop=-1,this.lastIsHorizontalScrollShowing=!1,this.scrollTimer=0,this.isScrollActive=!1,this.isVerticalPositionInvalidated=!0,this.isHorizontalPositionInvalidated=!0,this.eBodyViewport=e,this.resetLastHScrollDebounced=zn(this,()=>this.lastScrollSource[1]=null,tb),this.resetLastVScrollDebounced=zn(this,()=>this.lastScrollSource[0]=null,tb)}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.animationFrameSvc=e.animationFrameSvc,this.visibleCols=e.visibleCols}destroy(){super.destroy(),this.clearRetryListenerFncs=[],window.clearTimeout(this.scrollTimer)}postConstruct(){this.enableRtl=this.gos.get("enableRtl");const e=this.invalidateVerticalScroll.bind(this),t=this.invalidateHorizontalScroll.bind(this);this.addManagedEventListeners({displayedColumnsWidthChanged:this.onDisplayedColumnsWidthChanged.bind(this),bodyHeightChanged:e,scrollGapChanged:t}),this.addManagedElementListeners(this.eBodyViewport,{scroll:e}),this.ctrlsSvc.whenReady(this,r=>{this.centerRowsCtrl=r.center,this.onDisplayedColumnsWidthChanged(),this.addScrollListener()})}invalidateHorizontalScroll(){this.isHorizontalPositionInvalidated=!0}invalidateVerticalScroll(){this.isVerticalPositionInvalidated=!0}addScrollListener(){this.addHorizontalScrollListeners(),this.addVerticalScrollListeners()}addHorizontalScrollListeners(){this.addManagedElementListeners(this.centerRowsCtrl.eViewport,{scroll:this.onHScroll.bind(this,Ka)});for(const e of eb){const t=this.ctrlsSvc.get(e);this.registerScrollPartner(t,this.onHScroll.bind(this,e))}}addVerticalScrollListeners(){const e=this.ctrlsSvc.get("fakeVScrollComp"),t=this.gos.get("debounceVerticalScrollbar"),r=t?zn(this,this.onVScroll.bind(this,Ka),f4):this.onVScroll.bind(this,Ka),n=t?zn(this,this.onVScroll.bind(this,h4),f4):this.onVScroll.bind(this,h4);this.addManagedElementListeners(this.eBodyViewport,{scroll:r}),this.registerScrollPartner(e,n)}registerScrollPartner(e,t){e.onScrollCallback(t)}onDisplayedColumnsWidthChanged(){this.enableRtl&&this.horizontallyScrollHeaderCenterAndFloatingCenter()}horizontallyScrollHeaderCenterAndFloatingCenter(e){this.centerRowsCtrl!=null&&(e===void 0&&(e=this.centerRowsCtrl.getCenterViewportScrollLeft()),this.setScrollLeftForAllContainersExceptCurrent(Math.abs(e)))}setScrollLeftForAllContainersExceptCurrent(e){for(const t of[...eb,Ka]){if(this.lastScrollSource[1]===t)continue;const r=this.getViewportForSource(t);h0(r,e,this.enableRtl)}}getViewportForSource(e){return e===Ka?this.centerRowsCtrl.eViewport:this.ctrlsSvc.get(e).eViewport}isControllingScroll(e,t){return this.lastScrollSource[t]==null?(t===0?this.lastScrollSource[0]=e:this.lastScrollSource[1]=e,!0):this.lastScrollSource[t]===e}onHScroll(e){if(!this.isControllingScroll(e,1))return;const t=this.centerRowsCtrl.eViewport,{scrollLeft:r}=t;if(this.shouldBlockScrollUpdate(1,r,!0))return;const n=d0(this.getViewportForSource(e),this.enableRtl);this.doHorizontalScroll(n),this.resetLastHScrollDebounced()}onVScroll(e){if(!this.isControllingScroll(e,0))return;let t;if(e===Ka?t=this.eBodyViewport.scrollTop:t=this.ctrlsSvc.get("fakeVScrollComp").getScrollPosition(),this.shouldBlockScrollUpdate(0,t,!0))return;const{animationFrameSvc:r}=this;r?.setScrollTop(t),this.nextScrollTop=t,e===Ka?this.ctrlsSvc.get("fakeVScrollComp").setScrollPosition(t):this.eBodyViewport.scrollTop=t,r?.active?r.schedule():this.scrollGridIfNeeded(!0),this.resetLastVScrollDebounced()}doHorizontalScroll(e){const t=this.ctrlsSvc.get("fakeHScrollComp").getScrollPosition();this.scrollLeft===e&&e===t||(this.scrollLeft=e,this.fireScrollEvent(1),this.horizontallyScrollHeaderCenterAndFloatingCenter(e),this.centerRowsCtrl.onHorizontalViewportChanged(!0))}isScrolling(){return this.isScrollActive}fireScrollEvent(e){const t={type:"bodyScroll",direction:e===1?"horizontal":"vertical",left:this.scrollLeft,top:this.scrollTop};this.isScrollActive=!0,this.eventSvc.dispatchEvent(t),window.clearTimeout(this.scrollTimer),this.scrollTimer=window.setTimeout(()=>{this.scrollTimer=0,this.isScrollActive=!1,this.eventSvc.dispatchEvent({...t,type:"bodyScrollEnd"})},tb)}shouldBlockScrollUpdate(e,t,r=!1){return r&&!ac()?!1:e===0?this.shouldBlockVerticalScroll(t):this.shouldBlockHorizontalScroll(t)}shouldBlockVerticalScroll(e){const t=iy(this.eBodyViewport),{scrollHeight:r}=this.eBodyViewport;return e<0||e+t>r}shouldBlockHorizontalScroll(e){const t=this.centerRowsCtrl.getCenterWidth(),{scrollWidth:r}=this.centerRowsCtrl.eViewport;if(this.enableRtl){if(e>0)return!0}else if(e<0)return!0;return Math.abs(e)+t>r}redrawRowsAfterScroll(){this.fireScrollEvent(0)}checkScrollLeft(){const e=this.scrollLeft;let t=!1;for(const r of eb)if(this.getViewportForSource(r).scrollLeft!==e){t=!0;break}t&&this.onHScroll(Ka)}scrollGridIfNeeded(e=!1){const t=this.scrollTop!=this.nextScrollTop;return t&&(this.scrollTop=this.nextScrollTop,e&&this.invalidateVerticalScroll(),this.redrawRowsAfterScroll()),t}setHorizontalScrollPosition(e,t=!1){const n=this.centerRowsCtrl.eViewport.scrollWidth-this.centerRowsCtrl.getCenterWidth();!t&&this.shouldBlockScrollUpdate(1,e)&&(this.enableRtl?e=e>0?0:n:e=Math.min(Math.max(e,0),n)),h0(this.centerRowsCtrl.eViewport,Math.abs(e),this.enableRtl),this.doHorizontalScroll(e)}setVerticalScrollPosition(e){this.invalidateVerticalScroll(),this.eBodyViewport.scrollTop=e}getVScrollPosition(){if(!this.isVerticalPositionInvalidated){const{lastOffsetHeight:r,lastScrollTop:n}=this;return{top:n,bottom:n+r}}this.isVerticalPositionInvalidated=!1;const{scrollTop:e,offsetHeight:t}=this.eBodyViewport;return this.lastScrollTop=e,this.lastOffsetHeight=t,{top:e,bottom:e+t}}getApproximateVScollPosition(){return this.lastScrollTop>=0&&this.lastOffsetHeight>=0?{top:this.scrollTop,bottom:this.scrollTop+this.lastOffsetHeight}:this.getVScrollPosition()}getHScrollPosition(){return this.centerRowsCtrl.getHScrollPosition()}isHorizontalScrollShowing(){return this.isHorizontalPositionInvalidated&&(this.lastIsHorizontalScrollShowing=this.centerRowsCtrl.isHorizontalScrollShowing(),this.isHorizontalPositionInvalidated=!1),this.lastIsHorizontalScrollShowing}scrollHorizontally(e){const t=this.centerRowsCtrl.eViewport.scrollLeft;return this.setHorizontalScrollPosition(t+e),this.centerRowsCtrl.eViewport.scrollLeft-t}scrollToTop(){this.eBodyViewport.scrollTop=0}ensureNodeVisible(e,t=null){const{rowModel:r}=this.beans,n=r.getRowCount();let i=-1;for(let s=0;s<n;s++){const o=r.getRow(s);if(typeof e=="function"){if(o&&e(o)){i=s;break}}else if(e===o||e===o.data){i=s;break}}i>=0&&this.ensureIndexVisible(i,t)}ensureIndexVisible(e,t,r=0){if(ni(this.gos,"print"))return;const{rowModel:n}=this.beans,i=n.getRowCount();if(typeof e!="number"||e<0||e>=i){at(88,{index:e});return}this.clearRetryListeners();const{frameworkOverrides:s,pageBounds:o,rowContainerHeight:a,rowRenderer:l}=this.beans;s.wrapIncoming(()=>{const c=this.ctrlsSvc.getGridBodyCtrl(),u=n.getRow(e);let h,d,f=0;this.invalidateVerticalScroll();do{const{stickyTopHeight:m,stickyBottomHeight:v}=c,g=u.rowTop,w=u.rowHeight,y=o.getPixelOffset(),C=u.rowTop-y,k=C+u.rowHeight,F=this.getVScrollPosition(),I=a.divStretchOffset,N=F.top+I,j=F.bottom+I,L=j-N,W=a.getScrollPositionForPixel(C),K=a.getScrollPositionForPixel(k-L),z=Math.min((W+K)/2,C),M=N+m>C,B=j-v<k;let R=null;t==="top"?R=W-m:t==="bottom"?R=K+v:t==="middle"?R=z:M?R=W-m:B&&(K-W>L?R=W-m:R=K+v),R!==null&&(this.setVerticalScrollPosition(R),l.redraw({afterScroll:!0})),h=g!==u.rowTop||w!==u.rowHeight,d=m!==c.stickyTopHeight||v!==c.stickyBottomHeight,f++}while((h||d)&&f<10);if(this.animationFrameSvc?.flushAllFrames(),r<10&&(u?.stub||!this.beans.rowAutoHeight?.areRowsMeasured())){const m=this.getVScrollPosition().top;this.clearRetryListenerFncs=this.addManagedEventListeners({bodyScroll:()=>{const v=this.getVScrollPosition().top;m!==v&&this.clearRetryListeners()},modelUpdated:()=>{this.clearRetryListeners(),!(e>=n.getRowCount())&&this.ensureIndexVisible(e,t,r+1)}})}})}clearRetryListeners(){for(const e of this.clearRetryListenerFncs)e();this.clearRetryListenerFncs=[]}ensureColumnVisible(e,t="auto"){const{colModel:r,frameworkOverrides:n}=this.beans,i=r.getCol(e);if(!i||i.isPinned()||!this.visibleCols.isColDisplayed(i))return;const s=this.getPositionedHorizontalScroll(i,t);n.wrapIncoming(()=>{s!==null&&this.centerRowsCtrl.setCenterViewportScrollLeft(s),this.centerRowsCtrl.onHorizontalViewportChanged(),this.animationFrameSvc?.flushAllFrames()})}getPositionedHorizontalScroll(e,t){const{columnBeforeStart:r,columnAfterEnd:n}=this.isColumnOutsideViewport(e),i=this.centerRowsCtrl.getCenterWidth()<e.getActualWidth(),s=this.centerRowsCtrl.getCenterWidth(),o=this.enableRtl;let a=(o?r:n)||i,l=o?n:r;t!=="auto"&&(a=t==="start",l=t==="end");const c=t==="middle";if(a||l||c){const{colLeft:u,colMiddle:h,colRight:d}=this.getColumnBounds(e);return c?h-s/2:a?o?d:u:o?u-s:d-s}return null}isColumnOutsideViewport(e){const{start:t,end:r}=this.getViewportBounds(),{colLeft:n,colRight:i}=this.getColumnBounds(e),s=this.enableRtl,o=s?t>i:r<i,a=s?r<n:t>n;return{columnBeforeStart:o,columnAfterEnd:a}}getColumnBounds(e){const t=this.enableRtl,r=this.visibleCols.bodyWidth,n=e.getActualWidth(),i=e.getLeft(),s=t?-1:1,o=t?r-i:i,a=o+n*s,l=o+n/2*s;return{colLeft:o,colMiddle:l,colRight:a}}getViewportBounds(){const e=this.centerRowsCtrl.getCenterWidth(),t=this.centerRowsCtrl.getCenterViewportScrollLeft(),r=t,n=e+t;return{start:r,end:n,width:e}}},My=class extends et{constructor(e,t=!1){super(),this.callback=e,this.addSpacer=t}postConstruct(){const e=this.setWidth.bind(this);this.addManagedPropertyListener("domLayout",e),this.addManagedEventListeners({columnContainerWidthChanged:e,displayedColumnsChanged:e,leftPinnedWidthChanged:e}),this.addSpacer&&this.addManagedEventListeners({rightPinnedWidthChanged:e,scrollVisibilityChanged:e,scrollbarWidthChanged:e}),this.setWidth()}setWidth(){const e=ni(this.gos,"print"),{visibleCols:t,scrollVisibleSvc:r}=this.beans,n=t.bodyWidth,i=t.getColsLeftWidth(),s=t.getDisplayedColumnsRightWidth();let o;e?o=n+i+s:(o=n,this.addSpacer&&(this.gos.get("enableRtl")?i:s)===0&&r.verticalScrollShowing&&(o+=r.getScrollbarWidth())),this.callback(o)}},K9=class extends et{constructor(e){super(),this.centerContainerCtrl=e}wireBeans(e){this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.listenForResize()}),this.addManagedEventListeners({scrollbarWidthChanged:this.onScrollbarWidthChanged.bind(this)}),this.addManagedPropertyListeners(["alwaysShowHorizontalScroll","alwaysShowVerticalScroll"],()=>{this.checkViewportAndScrolls()})}listenForResize(){const{beans:e,centerContainerCtrl:t,gridBodyCtrl:r}=this,n=()=>{fa(e,()=>{this.onCenterViewportResized()})};t.registerViewportResizeListener(n),r.registerBodyViewportResizeListener(n)}onScrollbarWidthChanged(){this.checkViewportAndScrolls()}onCenterViewportResized(){if(this.scrollVisibleSvc.updateScrollGap(),this.centerContainerCtrl.isViewportInTheDOMTree()){const{pinnedCols:e,colFlex:t}=this.beans;e?.keepPinnedColumnsNarrowerThanViewport(),this.checkViewportAndScrolls();const r=this.centerContainerCtrl.getCenterWidth();r!==this.centerWidth&&(this.centerWidth=r,t?.refreshFlexedColumns({viewportWidth:this.centerWidth,updateBodyWidths:!0,fireResizedEvent:!0}))}else this.bodyHeight=0}checkViewportAndScrolls(){this.updateScrollVisibleService(),this.checkBodyHeight(),this.onHorizontalViewportChanged(),this.gridBodyCtrl.scrollFeature.checkScrollLeft()}getBodyHeight(){return this.bodyHeight}checkBodyHeight(){const e=this.gridBodyCtrl.eBodyViewport,t=iy(e);this.bodyHeight!==t&&(this.bodyHeight=t,this.eventSvc.dispatchEvent({type:"bodyHeightChanged"}))}updateScrollVisibleService(){this.updateScrollVisibleServiceImpl(),setTimeout(this.updateScrollVisibleServiceImpl.bind(this),500)}updateScrollVisibleServiceImpl(){if(!this.isAlive())return;const e={horizontalScrollShowing:this.centerContainerCtrl.isHorizontalScrollShowing(),verticalScrollShowing:this.gridBodyCtrl.isVerticalScrollShowing()};this.scrollVisibleSvc.setScrollsVisible(e)}onHorizontalViewportChanged(){const e=this.centerContainerCtrl.getCenterWidth(),t=this.centerContainerCtrl.getViewportScrollLeft();this.beans.colViewport.setScrollPosition(e,t)}};function t0(e,t,r,n){const i=t.getColDef().cellRendererParams?.suppressMouseEventHandling;return Xk(e,t,r,n,i)}function X9(e,t,r,n){const i=t?.suppressMouseEventHandling;return Xk(e,void 0,r,n,i)}function Xk(e,t,r,n,i){return i?i(Dt(e,{column:t,node:r,event:n})):!1}function Yk(e,t,r){let n=t;for(;n;){const i=KT(e,n,r);if(i)return i;n=n.parentElement}return null}var E0="cellCtrl";function Dy(e,t){return Yk(e,t,E0)}var T0="renderedRow";function Y9(e,t){return Yk(e,t,T0)}function gw(e,t,r,n,i){const s=n?n.getColDef().suppressKeyboardEvent:void 0;if(!s)return!1;const o=Dt(e,{event:t,editing:i,column:n,node:r,data:r.data,colDef:n.getColDef()});return!!(s&&s(o))}function Z9(e){const{pinnedRowModel:t,rowModel:r,rangeSvc:n,visibleCols:i}=e;if(!n||i.allCols.length===0)return;const s=t?.isEmpty("top")??!0,o=t?.isEmpty("bottom")??!0,a=s?null:"top";let l,c;o?(l=null,c=r.getRowCount()-1):(l="bottom",c=t?.getPinnedBottomRowCount()??-1),n.setCellRange({rowStartIndex:0,rowStartPinned:a,rowEndIndex:c,rowEndPinned:l})}var J9=class extends et{constructor(e){super(),this.element=e}postConstruct(){this.addKeyboardListeners(),this.addMouseListeners(),this.beans.touchSvc?.mockRowContextMenu(this),this.editSvc=this.beans.editSvc}addKeyboardListeners(){const e="keydown",t=this.processKeyboardEvent.bind(this,e);this.addManagedElementListeners(this.element,{[e]:t})}addMouseListeners(){const t=["dblclick","contextmenu","mouseover","mouseout","click",MT("touchstart")?"touchstart":"mousedown"];for(const r of t){const n=this.processMouseEvent.bind(this,r);this.addManagedElementListeners(this.element,{[r]:n})}}processMouseEvent(e,t){if(!uf(this.beans,t)||na(t))return;const{cellCtrl:r,rowCtrl:n}=this.getControlsForEventTarget(t.target);e==="contextmenu"?(r?.column&&r.dispatchCellContextMenuEvent(t),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(t,void 0,n,r)):(r&&r.onMouseEvent(e,t),n&&n.onMouseEvent(e,t))}getControlsForEventTarget(e){const{gos:t}=this;return{cellCtrl:Dy(t,e),rowCtrl:Y9(t,e)}}processKeyboardEvent(e,t){const{cellCtrl:r,rowCtrl:n}=this.getControlsForEventTarget(t.target);t.defaultPrevented||(r?this.processCellKeyboardEvent(r,e,t):n?.isFullWidth()&&this.processFullWidthRowKeyboardEvent(n,e,t))}processCellKeyboardEvent(e,t,r){const n=this.editSvc?.isEditing(e,{withOpenEditor:!0})??!1;!gw(this.gos,r,e.rowNode,e.column,n)&&t==="keydown"&&(!n&&this.beans.navigation?.handlePageScrollingKey(r)||e.onKeyDown(r),this.doGridOperations(r,n),Rk(r)&&e.processCharacter(r)),t==="keydown"&&this.eventSvc.dispatchEvent(e.createEvent(r,"cellKeyDown"))}processFullWidthRowKeyboardEvent(e,t,r){const{rowNode:n}=e,{focusSvc:i,navigation:s}=this.beans,a=i.getFocusedCell()?.column;if(!gw(this.gos,r,n,a,!1)){const c=r.key;if(t==="keydown")switch(c){case $e.PAGE_HOME:case $e.PAGE_END:case $e.PAGE_UP:case $e.PAGE_DOWN:s?.handlePageScrollingKey(r,!0);break;case $e.LEFT:case $e.RIGHT:if(!this.gos.get("embedFullWidthRows"))break;case $e.UP:case $e.DOWN:e.onKeyboardNavigate(r);break;case $e.TAB:e.onTabKeyDown(r);break}}t==="keydown"&&this.eventSvc.dispatchEvent(e.createRowEvent("cellKeyDown",r))}doGridOperations(e,t){if(!e.ctrlKey&&!e.metaKey||t||!uf(this.beans,e))return;const r=wk(e),{clipboardSvc:n,undoRedo:i}=this.beans;if(r===$e.A)return this.onCtrlAndA(e);if(r===$e.C)return this.onCtrlAndC(n,e);if(r===$e.D)return this.onCtrlAndD(n,e);if(r===$e.V)return this.onCtrlAndV(n,e);if(r===$e.X)return this.onCtrlAndX(n,e);if(r===$e.Y)return this.onCtrlAndY(i);if(r===$e.Z)return this.onCtrlAndZ(i,e)}onCtrlAndA(e){const{beans:{rowModel:t,rangeSvc:r,selectionSvc:n},gos:i}=this;r&&ll(i)&&!jD(i)&&t.isRowsToRender()?Z9(this.beans):n&&n.selectAllRowNodes({source:"keyboardSelectAll",selectAll:ek(i)}),e.preventDefault()}onCtrlAndC(e,t){if(!e||this.gos.get("enableCellTextSelection"))return;const{cellCtrl:r}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(r,{withOpenEditor:!0})||(t.preventDefault(),e.copyToClipboard())}onCtrlAndX(e,t){if(!e||this.gos.get("enableCellTextSelection")||this.gos.get("suppressCutToClipboard"))return;const{cellCtrl:r}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(r,{withOpenEditor:!0})||(t.preventDefault(),e.cutToClipboard(void 0,"ui"))}onCtrlAndV(e,t){const{cellCtrl:r}=this.getControlsForEventTarget(t.target);this.editSvc?.isEditing(r,{withOpenEditor:!0})||e&&!this.gos.get("suppressClipboardPaste")&&e.pasteFromClipboard()}onCtrlAndD(e,t){e&&!this.gos.get("suppressClipboardPaste")&&e.copyRangeDown(),t.preventDefault()}onCtrlAndZ(e,t){!this.gos.get("undoRedoCellEditing")||!e||(t.preventDefault(),t.shiftKey?e.redo("ui"):e.undo("ui"))}onCtrlAndY(e){e?.redo("ui")}},Zk=class extends et{constructor(e,t){super(),this.eContainer=e,this.eViewport=t}postConstruct(){this.addManagedEventListeners({rowContainerHeightChanged:this.onHeightChanged.bind(this,this.beans.rowContainerHeight)})}onHeightChanged(e){const t=e.uiContainerHeight,r=t!=null?`${t}px`:"";this.eContainer.style.height=r,this.eViewport&&(this.eViewport.style.height=r)}},mg=e=>e.topRowCtrls,vg=e=>e.getStickyTopRowCtrls(),bg=e=>e.getStickyBottomRowCtrls(),wg=e=>e.bottomRowCtrls,yg=e=>e.allRowCtrls,rb=e=>e.getCtrls("top"),nb=e=>e.getCtrls("center"),ib=e=>e.getCtrls("bottom"),Q9={center:{type:"center",name:"center-cols",getRowCtrls:yg,getSpannedRowCtrls:nb},left:{type:"left",name:"pinned-left-cols",pinnedType:"left",getRowCtrls:yg,getSpannedRowCtrls:nb},right:{type:"right",name:"pinned-right-cols",pinnedType:"right",getRowCtrls:yg,getSpannedRowCtrls:nb},fullWidth:{type:"fullWidth",name:"full-width",fullWidth:!0,getRowCtrls:yg},topCenter:{type:"center",name:"floating-top",getRowCtrls:mg,getSpannedRowCtrls:rb},topLeft:{type:"left",name:"pinned-left-floating",container:"ag-pinned-left-floating-top",pinnedType:"left",getRowCtrls:mg,getSpannedRowCtrls:rb},topRight:{type:"right",name:"pinned-right-floating",container:"ag-pinned-right-floating-top",pinnedType:"right",getRowCtrls:mg,getSpannedRowCtrls:rb},topFullWidth:{type:"fullWidth",name:"floating-top-full-width",fullWidth:!0,getRowCtrls:mg},stickyTopCenter:{type:"center",name:"sticky-top",getRowCtrls:vg},stickyTopLeft:{type:"left",name:"pinned-left-sticky-top",container:"ag-pinned-left-sticky-top",pinnedType:"left",getRowCtrls:vg},stickyTopRight:{type:"right",name:"pinned-right-sticky-top",container:"ag-pinned-right-sticky-top",pinnedType:"right",getRowCtrls:vg},stickyTopFullWidth:{type:"fullWidth",name:"sticky-top-full-width",fullWidth:!0,getRowCtrls:vg},stickyBottomCenter:{type:"center",name:"sticky-bottom",getRowCtrls:bg},stickyBottomLeft:{type:"left",name:"pinned-left-sticky-bottom",container:"ag-pinned-left-sticky-bottom",pinnedType:"left",getRowCtrls:bg},stickyBottomRight:{type:"right",name:"pinned-right-sticky-bottom",container:"ag-pinned-right-sticky-bottom",pinnedType:"right",getRowCtrls:bg},stickyBottomFullWidth:{type:"fullWidth",name:"sticky-bottom-full-width",fullWidth:!0,getRowCtrls:bg},bottomCenter:{type:"center",name:"floating-bottom",getRowCtrls:wg,getSpannedRowCtrls:ib},bottomLeft:{type:"left",name:"pinned-left-floating-bottom",container:"ag-pinned-left-floating-bottom",pinnedType:"left",getRowCtrls:wg,getSpannedRowCtrls:ib},bottomRight:{type:"right",name:"pinned-right-floating-bottom",container:"ag-pinned-right-floating-bottom",pinnedType:"right",getRowCtrls:wg,getSpannedRowCtrls:ib},bottomFullWidth:{type:"fullWidth",name:"floating-bottom-full-width",fullWidth:!0,getRowCtrls:wg}};function Jk(e){return`ag-${Uf(e).name}-viewport`}function r0(e){const t=Uf(e);return t.container??`ag-${t.name}-container`}function eI(e){return`ag-${Uf(e).name}-spanned-cells-container`}function Uf(e){return Q9[e]}var tI=["topCenter","topLeft","topRight"],rI=["bottomCenter","bottomLeft","bottomRight"],nI=["center","left","right"],iI=["center","left","right","fullWidth"],sI=["stickyTopCenter","stickyBottomCenter","center","topCenter","bottomCenter"],oI=["left","bottomLeft","topLeft","stickyTopLeft","stickyBottomLeft"],aI=["right","bottomRight","topRight","stickyTopRight","stickyBottomRight"],Qk=["stickyTopCenter","stickyTopLeft","stickyTopRight"],eR=["stickyBottomCenter","stickyBottomLeft","stickyBottomRight"],lI=[...Qk,"stickyTopFullWidth",...eR,"stickyBottomFullWidth"],cI=[...tI,...rI,...nI,...Qk,...eR],uI=class extends et{constructor(e){super(),this.name=e,this.visible=!0,this.EMPTY_CTRLS=[],this.options=Uf(e)}postConstruct(){this.enableRtl=this.gos.get("enableRtl"),this.forContainers(["center"],()=>{this.viewportSizeFeature=this.createManagedBean(new K9(this)),this.addManagedEventListeners({stickyTopOffsetChanged:this.onStickyTopOffsetChanged.bind(this)})})}onStickyTopOffsetChanged(e){this.comp.setOffsetTop(`${e.offset}px`)}registerWithCtrlsService(){this.options.fullWidth||this.beans.ctrlsSvc.register(this.name,this)}forContainers(e,t){e.indexOf(this.name)>=0&&t()}setComp(e,t,r,n){this.comp=e,this.eContainer=t,this.eSpannedContainer=r,this.eViewport=n,this.createManagedBean(new J9(this.eViewport??this.eContainer)),this.addPreventScrollWhileDragging(),this.listenOnDomOrder();const{pinnedCols:i,rangeSvc:s}=this.beans,o=()=>this.onPinnedWidthChanged();this.forContainers(oI,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(i?.createPinnedWidthFeature(!0,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({leftPinnedWidthChanged:o})}),this.forContainers(aI,()=>{this.pinnedWidthFeature=this.createOptionalManagedBean(i?.createPinnedWidthFeature(!1,this.eContainer,this.eSpannedContainer)),this.addManagedEventListeners({rightPinnedWidthChanged:o})}),this.forContainers(iI,()=>this.createManagedBean(new Zk(this.eContainer,this.name==="center"?n:void 0))),s&&this.forContainers(cI,()=>this.createManagedBean(s.createDragListenerFeature(this.eContainer))),this.forContainers(sI,()=>this.createManagedBean(new My(a=>this.comp.setContainerWidth(`${a}px`)))),this.visible=this.isContainerVisible(),this.addListeners(),this.registerWithCtrlsService()}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}addListeners(){const{spannedRowRenderer:e,gos:t}=this.beans,r=this.onDisplayedColumnsChanged.bind(this);this.addManagedEventListeners({displayedColumnsChanged:r,displayedColumnsWidthChanged:r,displayedRowsChanged:n=>this.onDisplayedRowsChanged(n.afterScroll)}),r(),this.onDisplayedRowsChanged(),e&&this.options.getSpannedRowCtrls&&t.get("enableCellSpan")&&this.addManagedListeners(e,{spannedRowsUpdated:()=>{const n=this.options.getSpannedRowCtrls(e);n&&this.comp.setSpannedRowCtrls(n,!1)}})}listenOnDomOrder(){if(lI.indexOf(this.name)>=0){this.comp.setDomOrder(!0);return}const t=()=>{const r=this.gos.get("ensureDomOrder"),n=ni(this.gos,"print");this.comp.setDomOrder(r||n)};this.addManagedPropertyListener("domLayout",t),t()}onDisplayedColumnsChanged(){this.forContainers(["center"],()=>this.onHorizontalViewportChanged())}addPreventScrollWhileDragging(){const{dragSvc:e}=this.beans;if(!e)return;const t=r=>{e.dragging&&r.cancelable&&r.preventDefault()};this.eContainer.addEventListener("touchmove",t,{passive:!1}),this.addDestroyFunc(()=>this.eContainer.removeEventListener("touchmove",t))}onHorizontalViewportChanged(e=!1){const t=this.getCenterWidth(),r=this.getCenterViewportScrollLeft();this.beans.colViewport.setScrollPosition(t,r,e)}hasHorizontalScrollGap(){return this.eContainer.clientWidth-this.eViewport.clientWidth<0}hasVerticalScrollGap(){return this.eContainer.clientHeight-this.eViewport.clientHeight<0}getCenterWidth(){return cf(this.eViewport)}getCenterViewportScrollLeft(){return d0(this.eViewport,this.enableRtl)}registerViewportResizeListener(e){const t=ha(this.beans,this.eViewport,e);this.addDestroyFunc(()=>t())}isViewportInTheDOMTree(){return sy(this.eViewport)}getViewportScrollLeft(){return d0(this.eViewport,this.enableRtl)}isHorizontalScrollShowing(){return this.gos.get("alwaysShowHorizontalScroll")||ay(this.eViewport)}setHorizontalScroll(e){this.comp.setHorizontalScroll(e)}getHScrollPosition(){return{left:this.eViewport.scrollLeft,right:this.eViewport.scrollLeft+this.eViewport.offsetWidth}}setCenterViewportScrollLeft(e){h0(this.eViewport,e,this.enableRtl)}isContainerVisible(){return!(this.options.pinnedType!=null)||!!this.pinnedWidthFeature&&this.pinnedWidthFeature.getWidth()>0}onPinnedWidthChanged(){const e=this.isContainerVisible();this.visible!=e&&(this.visible=e,this.onDisplayedRowsChanged())}onDisplayedRowsChanged(e=!1){const t=this.options.getRowCtrls(this.beans.rowRenderer);if(!this.visible||t.length===0){this.comp.setRowCtrls({rowCtrls:this.EMPTY_CTRLS});return}const r=ni(this.gos,"print"),i=this.gos.get("embedFullWidthRows")||r,s=t.filter(o=>{const a=o.isFullWidth();return this.options.fullWidth?!i&&a:i||!a});this.comp.setRowCtrls({rowCtrls:s,useFlushSync:e})}},dI="ag-force-vertical-scroll",hI="ag-selectable",fI="ag-column-moving",pI=class extends et{constructor(){super(...arguments),this.stickyTopHeight=0,this.stickyBottomHeight=0}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colModel=e.colModel,this.scrollVisibleSvc=e.scrollVisibleSvc,this.pinnedRowModel=e.pinnedRowModel,this.filterManager=e.filterManager,this.rowGroupColsSvc=e.rowGroupColsSvc}setComp(e,t,r,n,i,s,o){this.comp=e,this.eGridBody=t,this.eBodyViewport=r,this.eTop=n,this.eBottom=i,this.eStickyTop=s,this.eStickyBottom=o,this.eCenterColsViewport=r.querySelector(`.${Jk("center")}`),this.eFullWidthContainer=r.querySelector(`.${r0("fullWidth")}`),this.eStickyTopFullWidthContainer=s.querySelector(`.${r0("stickyTopFullWidth")}`),this.eStickyBottomFullWidthContainer=o.querySelector(`.${r0("stickyBottomFullWidth")}`),this.setCellTextSelection(this.gos.get("enableCellTextSelection")),this.addManagedPropertyListener("enableCellTextSelection",a=>this.setCellTextSelection(a.currentValue)),this.createManagedBean(new Fy(this.comp)),this.scrollFeature=this.createManagedBean(new q9(r)),this.beans.rowDragSvc?.setupRowDrag(r,this),this.setupRowAnimationCssClass(),this.addEventListeners(),this.addFocusListeners([n,r,i,s,o]),this.setGridRootRole(),this.onGridColumnsChanged(),this.addBodyViewportListener(),this.setFloatingHeights(),this.disableBrowserDragging(),this.addStopEditingWhenGridLosesFocus(),this.updateScrollingClasses(),this.filterManager?.setupAdvFilterHeaderComp(n),this.ctrlsSvc.register("gridBodyCtrl",this)}addEventListeners(){const e=this.setFloatingHeights.bind(this),t=this.setGridRootRole.bind(this),r=this.toggleRowResizeStyles.bind(this);this.addManagedEventListeners({gridColumnsChanged:this.onGridColumnsChanged.bind(this),scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this),scrollGapChanged:this.updateScrollingClasses.bind(this),pinnedRowDataChanged:e,pinnedHeightChanged:e,pinnedRowsChanged:e,headerHeightChanged:this.setStickyTopOffsetTop.bind(this),columnRowGroupChanged:t,columnPivotChanged:t,rowResizeStarted:r,rowResizeEnded:r}),this.addManagedPropertyListener("treeData",t)}toggleRowResizeStyles(e){const t=e.type==="rowResizeStarted";this.eBodyViewport.classList.toggle("ag-prevent-animation",t)}onGridColumnsChanged(){const e=this.beans.colModel.getCols();this.comp.setColumnCount(e.length)}onScrollVisibilityChanged(){const{scrollVisibleSvc:e}=this,t=e.verticalScrollShowing;this.setVerticalScrollPaddingVisible(t),this.setStickyWidth(t),this.setStickyBottomOffsetBottom();const r=t&&e.getScrollbarWidth()||0,n=xk()?16:0,i=`calc(100% + ${r+n}px)`;fa(this.beans,()=>this.comp.setBodyViewportWidth(i)),this.updateScrollingClasses()}setGridRootRole(){const{rowGroupColsSvc:e,colModel:t,gos:r}=this;let n=r.get("treeData");if(!n){const i=t.isPivotMode();n=(e?e.columns.length:0)>=(i?2:1)}this.comp.setGridRootRole(n?"treegrid":"grid")}addFocusListeners(e){for(const t of e)this.addManagedElementListeners(t,{focusin:r=>{const{target:n}=r,i=nc(n,"ag-root",t);t.classList.toggle("ag-has-focus",!i)},focusout:r=>{const{target:n,relatedTarget:i}=r,s=t.contains(i),o=nc(i,"ag-root",t);nc(n,"ag-root",t)||(!s||o)&&t.classList.remove("ag-has-focus")}})}setColumnMovingCss(e){this.comp.setColumnMovingCss(fI,e)}setCellTextSelection(e=!1){this.comp.setCellSelectableCss(hI,e)}updateScrollingClasses(){const{eGridBody:{classList:e},scrollVisibleSvc:t}=this;e.toggle("ag-body-vertical-content-no-gap",!t.verticalScrollGap),e.toggle("ag-body-horizontal-content-no-gap",!t.horizontalScrollGap)}disableBrowserDragging(){this.addManagedElementListeners(this.eGridBody,{dragstart:e=>{if(e.target instanceof HTMLImageElement)return e.preventDefault(),!1}})}addStopEditingWhenGridLosesFocus(){this.beans.editSvc?.addStopEditingWhenGridLosesFocus([this.eBodyViewport,this.eBottom,this.eTop,this.eStickyTop,this.eStickyBottom])}updateRowCount(){const e=(this.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.filterManager?.getHeaderRowCount()??0),{rowModel:t}=this.beans,r=t.isLastRowIndexKnown()?t.getRowCount():-1,n=r===-1?-1:e+r;this.comp.setRowCount(n)}registerBodyViewportResizeListener(e){this.comp.registerBodyViewportResizeListener(e)}setVerticalScrollPaddingVisible(e){const t=e?"scroll":"hidden";this.comp.setPinnedTopBottomOverflowY(t)}isVerticalScrollShowing(){const e=this.gos.get("alwaysShowVerticalScroll"),t=e?dI:null,r=ni(this.gos,"normal");return this.comp.setAlwaysVerticalScrollClass(t,e),e||r&&AT(this.eBodyViewport)}setupRowAnimationCssClass(){const{rowContainerHeight:e,environment:t}=this.beans;let r=t.sizesMeasured;const n=()=>{const i=r&&Uu(this.gos)&&!e.stretching,s=i?"ag-row-animation":"ag-row-no-animation";this.comp.setRowAnimationCssOnBodyViewport(s,i)};n(),this.addManagedEventListeners({heightScaleChanged:n}),this.addManagedPropertyListener("animateRows",n),this.addManagedEventListeners({stylesChanged:()=>{!r&&t.sizesMeasured&&(r=!0,n())}})}addBodyViewportListener(){const{eBodyViewport:e,eStickyTop:t,eStickyBottom:r,eTop:n,eBottom:i,beans:{popupSvc:s,touchSvc:o}}=this,a=this.onBodyViewportContextMenu.bind(this);this.addManagedElementListeners(e,{contextmenu:a}),o?.mockBodyContextMenu(this,a),this.addManagedElementListeners(e,{wheel:this.onBodyViewportWheel.bind(this,s)});const l=this.onStickyWheel.bind(this);for(const u of[t,r,n,i])this.addManagedElementListeners(u,{wheel:l});const c=this.onHorizontalWheel.bind(this);for(const u of["left","right","topLeft","topRight","bottomLeft","bottomRight"])this.addManagedElementListeners(this.ctrlsSvc.get(u).eContainer,{wheel:c});this.addFullWidthContainerWheelListener()}addFullWidthContainerWheelListener(){this.addManagedElementListeners(this.eFullWidthContainer,{wheel:e=>this.onFullWidthContainerWheel(e)})}onFullWidthContainerWheel(e){const{deltaX:t,deltaY:r,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(r))&&uf(this.beans,e)&&this.scrollGridBodyToMatchEvent(e)}onStickyWheel(e){const{deltaY:t}=e;this.scrollVertically(t)>0&&e.preventDefault()}onHorizontalWheel(e){const{deltaX:t,deltaY:r,shiftKey:n}=e;(n||Math.abs(t)>Math.abs(r))&&this.scrollGridBodyToMatchEvent(e)}scrollGridBodyToMatchEvent(e){const{deltaX:t,deltaY:r}=e;e.preventDefault(),this.eCenterColsViewport.scrollBy({left:t||r})}onBodyViewportContextMenu(e,t,r){if(!e&&!r)return;this.gos.get("preventDefaultOnContextMenu")&&(e||r).preventDefault();const{target:n}=e||t;(n===this.eBodyViewport||n===this.ctrlsSvc.get("center").eViewport)&&this.beans.contextMenuSvc?.showContextMenu({mouseEvent:e,touchEvent:r,value:null,anchorToElement:this.eGridBody,source:"ui"})}onBodyViewportWheel(e,t){this.gos.get("suppressScrollWhenPopupsAreOpen")&&e?.hasAnchoredPopup()&&t.preventDefault()}scrollVertically(e){const t=this.eBodyViewport.scrollTop;return this.scrollFeature.setVerticalScrollPosition(t+e),this.eBodyViewport.scrollTop-t}setFloatingHeights(){const{pinnedRowModel:e,beans:{environment:t}}=this,r=e?.getPinnedTopTotalHeight(),n=e?.getPinnedBottomTotalHeight(),i=t.getPinnedRowBorderWidth(),s=t.getRowBorderWidth(),o=i-s,a=r?o+r:0,l=n?o+n:0;this.comp.setTopHeight(a),this.comp.setBottomHeight(l),this.comp.setTopInvisible(a<=0),this.comp.setBottomInvisible(l<=0),this.setStickyTopOffsetTop(),this.setStickyBottomOffsetBottom()}setStickyTopHeight(e=0){this.comp.setStickyTopHeight(`${e}px`),this.stickyTopHeight=e}setStickyBottomHeight(e=0){this.comp.setStickyBottomHeight(`${e}px`),this.stickyBottomHeight=e}setStickyWidth(e){if(!e)this.comp.setStickyTopWidth("100%"),this.comp.setStickyBottomWidth("100%");else{const t=this.scrollVisibleSvc.getScrollbarWidth();this.comp.setStickyTopWidth(`calc(100% - ${t}px)`),this.comp.setStickyBottomWidth(`calc(100% - ${t}px)`)}}setStickyTopOffsetTop(){const t=this.ctrlsSvc.get("gridHeaderCtrl").headerHeight+(this.filterManager?.getHeaderHeight()??0),r=this.pinnedRowModel?.getPinnedTopTotalHeight()??0;let n=0;t>0&&(n+=t),r>0&&(n+=r),n>0&&(n+=1),this.comp.setStickyTopTop(`${n}px`)}setStickyBottomOffsetBottom(){const{pinnedRowModel:e,scrollVisibleSvc:t,comp:r}=this,n=e?.getPinnedBottomTotalHeight()??0,s=t.horizontalScrollShowing&&t.getScrollbarWidth()||0,o=n+s;r.setStickyBottomBottom(`${o}px`)}};function gI(e,t){return Dy(e,t.target)?.getFocusedCellPosition()??null}function p4(e,t){const r=ni(e.gos,"normal"),n=t;let i,s;n.clientX!=null||n.clientY!=null?(i=n.clientX,s=n.clientY):(i=n.x,s=n.y);const{pageFirstPixel:o}=e.pageBounds.getCurrentPagePixelRange();if(s+=o,r){const a=e.ctrlsSvc.getScrollFeature(),l=a.getVScrollPosition(),c=a.getHScrollPosition();i+=c.left,s+=l.top}return{x:i,y:s}}var tR=class extends pn{constructor(e,t){super(),this.direction=t,this.eViewport=xt,this.eContainer=xt,this.hideTimeout=0,this.setTemplate(e)}postConstruct(){this.addManagedEventListeners({scrollVisibilityChanged:this.onScrollVisibilityChanged.bind(this)}),this.onScrollVisibilityChanged(),this.toggleCss("ag-apple-scrollbar",yk()||ac())}destroy(){super.destroy(),window.clearTimeout(this.hideTimeout)}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.invisibleScrollbar=xk(),this.invisibleScrollbar&&(this.hideAndShowInvisibleScrollAsNeeded(),this.addActiveListenerToggles()))}addActiveListenerToggles(){const e=this.getGui(),t=()=>this.toggleCss("ag-scrollbar-active",!0),r=()=>this.toggleCss("ag-scrollbar-active",!1);this.addManagedListeners(e,{mouseenter:t,mousedown:t,touchstart:t,mouseleave:r,touchend:r})}onScrollVisibilityChanged(){this.invisibleScrollbar===void 0&&this.initialiseInvisibleScrollbar(),fa(this.beans,()=>this.setScrollVisible())}hideAndShowInvisibleScrollAsNeeded(){this.addManagedEventListeners({bodyScroll:e=>{e.direction===this.direction&&(this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=0),this.toggleCss("ag-scrollbar-scrolling",!0))},bodyScrollEnd:()=>{this.hideTimeout=window.setTimeout(()=>{this.toggleCss("ag-scrollbar-scrolling",!1),this.hideTimeout=0},400)}})}attemptSettingScrollPosition(e){const t=this.eViewport;fD(this,()=>da(t),()=>this.setScrollPosition(e),100)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}},mI={tag:"div",cls:"ag-body-horizontal-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eLeftSpacer",cls:"ag-horizontal-left-spacer"},{tag:"div",ref:"eViewport",cls:"ag-body-horizontal-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-horizontal-scroll-container"}]},{tag:"div",ref:"eRightSpacer",cls:"ag-horizontal-right-spacer"}]},vI=class extends tR{constructor(){super(mI,"horizontal"),this.eLeftSpacer=xt,this.eRightSpacer=xt,this.setScrollVisibleDebounce=0}wireBeans(e){this.visibleCols=e.visibleCols,this.scrollVisibleSvc=e.scrollVisibleSvc}postConstruct(){super.postConstruct();const e=this.setFakeHScrollSpacerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e,pinnedRowDataChanged:this.refreshCompBottom.bind(this)}),this.addManagedPropertyListener("domLayout",e),this.beans.ctrlsSvc.register("fakeHScrollComp",this),this.createManagedBean(new My(t=>this.eContainer.style.width=`${t}px`)),this.addManagedPropertyListeners(["suppressHorizontalScroll"],this.onScrollVisibilityChanged.bind(this))}destroy(){window.clearTimeout(this.setScrollVisibleDebounce),super.destroy()}initialiseInvisibleScrollbar(){this.invisibleScrollbar===void 0&&(this.enableRtl=this.gos.get("enableRtl"),super.initialiseInvisibleScrollbar(),this.invisibleScrollbar&&this.refreshCompBottom())}refreshCompBottom(){if(!this.invisibleScrollbar)return;const e=this.beans.pinnedRowModel?.getPinnedBottomTotalHeight()??0;this.getGui().style.bottom=`${e}px`}onScrollVisibilityChanged(){super.onScrollVisibilityChanged(),this.setFakeHScrollSpacerWidths()}setFakeHScrollSpacerWidths(){const e=this.scrollVisibleSvc.verticalScrollShowing;let t=this.visibleCols.getDisplayedColumnsRightWidth();const r=!this.enableRtl&&e,n=this.scrollVisibleSvc.getScrollbarWidth();r&&(t+=n),So(this.eRightSpacer,t),this.eRightSpacer.classList.toggle("ag-scroller-corner",t<=n);let i=this.visibleCols.getColsLeftWidth();this.enableRtl&&e&&(i+=n),So(this.eLeftSpacer,i),this.eLeftSpacer.classList.toggle("ag-scroller-corner",i<=n)}setScrollVisible(){const e=this.scrollVisibleSvc.horizontalScrollShowing,t=this.invisibleScrollbar,r=this.gos.get("suppressHorizontalScroll"),n=e&&this.scrollVisibleSvc.getScrollbarWidth()||0,s=r?0:n===0&&t?16:n,o=()=>{this.setScrollVisibleDebounce=0,this.toggleCss("ag-scrollbar-invisible",t),Vh(this.getGui(),s),Vh(this.eViewport,s),Vh(this.eContainer,s),s||this.eContainer.style.setProperty("min-height","1px"),this.setVisible(e,{skipAriaHidden:!0})};window.clearTimeout(this.setScrollVisibleDebounce),e?this.setScrollVisibleDebounce=window.setTimeout(o,100):o()}getScrollPosition(){return d0(this.eViewport,this.enableRtl)}setScrollPosition(e){da(this.eViewport)||this.attemptSettingScrollPosition(e),h0(this.eViewport,e,this.enableRtl)}},bI={tag:"div",cls:"ag-body-vertical-scroll",attrs:{"aria-hidden":"true"},children:[{tag:"div",ref:"eViewport",cls:"ag-body-vertical-scroll-viewport",children:[{tag:"div",ref:"eContainer",cls:"ag-body-vertical-scroll-container"}]}]},wI=class extends tR{constructor(){super(bI,"vertical")}postConstruct(){super.postConstruct(),this.createManagedBean(new Zk(this.eContainer));const{ctrlsSvc:e}=this.beans;e.register("fakeVScrollComp",this),this.addManagedEventListeners({rowContainerHeightChanged:this.onRowContainerHeightChanged.bind(this,e)})}setScrollVisible(){const{scrollVisibleSvc:e}=this.beans,t=e.verticalScrollShowing,r=this.invisibleScrollbar,n=t&&e.getScrollbarWidth()||0,i=n===0&&r?16:n;this.toggleCss("ag-scrollbar-invisible",r),So(this.getGui(),i),So(this.eViewport,i),So(this.eContainer,i),this.setDisplayed(t,{skipAriaHidden:!0})}onRowContainerHeightChanged(e){const r=e.getGridBodyCtrl().eBodyViewport,n=this.getScrollPosition(),i=r.scrollTop;n!=i&&this.setScrollPosition(i,!0)}getScrollPosition(){return this.eViewport.scrollTop}setScrollPosition(e,t){!t&&!da(this.eViewport)&&this.attemptSettingScrollPosition(e),this.eViewport.scrollTop=e}},yI="ag-column-first",CI="ag-column-last";function rR(e,t,r,n){return Yr(e)?[]:SI(e.headerClass,e,t,r,n)}function nR(e,t,r){e.toggleCss(yI,r.isColAtEdge(t,"first")),e.toggleCss(CI,r.isColAtEdge(t,"last"))}function xI(e,t,r,n){return Dt(t,{colDef:e,column:r,columnGroup:n})}function SI(e,t,r,n,i){if(Yr(e))return[];let s;if(typeof e=="function"){const o=xI(t,r,n,i);s=e(o)}else s=e;return typeof s=="string"?[s]:Array.isArray(s)?[...s]:[]}function _I(e){const{rowIndex:t,rowPinned:r,column:n}=e;return`${t}.${r??"null"}.${n.getId()}`}function Py(e,t){const r=e.column===t.column,n=e.rowPinned===t.rowPinned,i=e.rowIndex===t.rowIndex;return r&&n&&i}function EI(e,t){switch(e.rowPinned){case"top":if(t.rowPinned!=="top")return!0;break;case"bottom":if(t.rowPinned!=="bottom")return!1;break;default:if(bt(t.rowPinned))return t.rowPinned!=="top";break}return e.rowIndex<t.rowIndex}function TI(e,t){return!e&&!t?!0:!e||!t?!1:e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned}function kI(e){let t=0,r;const{pinnedRowModel:n,rowModel:i,pageBounds:s}=e;return n?.getPinnedTopRowCount()?r="top":i.getRowCount()?(r=null,t=s.getFirstRow()):n?.getPinnedBottomRowCount()&&(r="bottom"),r===void 0?null:{rowIndex:t,rowPinned:r}}function RI(e){let t,r=null;const{pinnedRowModel:n,pageBounds:i}=e,s=n?.getPinnedBottomRowCount(),o=n?.getPinnedTopRowCount();return s?(r="bottom",t=s-1):e.rowModel.getRowCount()?t=i.getLastRow():o&&(r="top",t=o-1),t===void 0?null:{rowIndex:t,rowPinned:r}}function ca(e,t){switch(t.rowPinned){case"top":return e.pinnedRowModel?.getPinnedTopRow(t.rowIndex);case"bottom":return e.pinnedRowModel?.getPinnedBottomRow(t.rowIndex);default:return e.rowModel.getRow(t.rowIndex)}}function Lu(e,t){const r=e.spannedRowRenderer?.getCellByPosition(t);if(r)return r;const n=e.rowRenderer.getRowByPosition(t);return n?n.getCellCtrl(t.column):null}function AI(e,t,r){const{rowModel:n,pinnedRowModel:i}=e;let s;return s??(s=n?.getRowNode(t)),r?s??(s=i?.getPinnedRowById(t,r)):(s??(s=i?.getPinnedRowById(t,"top")),s??(s=i?.getPinnedRowById(t,"bottom"))),s}function k0(e,t,r=!1){const{rowIndex:n,rowPinned:i}=t,{pageBounds:s,pinnedRowModel:o,rowModel:a}=e;if(n===0)return i==="top"?null:i==="bottom"&&a.isRowsToRender()?{rowIndex:s.getLastRow(),rowPinned:null}:o?.isRowsToRender("top")?{rowIndex:o.getPinnedTopRowCount()-1,rowPinned:"top"}:null;if(r){const l=i?void 0:a.getRow(n);return iR(e,l,!0)??{rowIndex:n-1,rowPinned:i}}return{rowIndex:n-1,rowPinned:i}}function g4(e,t,r=!1){const{rowIndex:n,rowPinned:i}=t,{pageBounds:s,pinnedRowModel:o,rowModel:a}=e;if(FI(e,t))return i==="bottom"?null:i==="top"&&a.isRowsToRender()?{rowIndex:s.getFirstRow(),rowPinned:null}:o?.isRowsToRender("bottom")?{rowIndex:0,rowPinned:"bottom"}:null;if(r){const l=i?void 0:a.getRow(n);return iR(e,l)??{rowIndex:n+1,rowPinned:i}}return{rowIndex:n+1,rowPinned:i}}function iR(e,t,r=!1){const{gos:n,rowRenderer:i}=e;if(!t?.sticky||!XT(n))return;const s=i.getStickyTopRowCtrls(),o=i.getStickyBottomRowCtrls(),a=!o.some(h=>h.rowNode.rowIndex===t.rowIndex),l=a?s:o,c=(r?-1:1)*(a?-1:1);let u;for(let h=0;h<l.length;h++)if(l[h].rowNode.rowIndex===t.rowIndex){u=l[h+c];break}return u?{rowIndex:u.rowNode.rowIndex,rowPinned:null}:void 0}function FI(e,t){const{rowPinned:r,rowIndex:n}=t,{pinnedRowModel:i,pageBounds:s}=e;return r==="top"?(i?.getPinnedTopRowCount()??0)-1<=n:r==="bottom"?(i?.getPinnedBottomRowCount()??0)-1<=n:s.getLastRow()<=n}function MI(e,t,r){t.addManagedElementListeners(r,{keydown:n=>{if(!n.defaultPrevented&&n.key===$e.TAB){const i=n.shiftKey;Mc(e,r,!1,i)||dd(e,i)&&n.preventDefault()}}})}function DI(e,t){return e.ctrlsSvc.get("gridCtrl").focusInnerElement(t)}function lc(e){return e.gos.get("suppressHeaderFocus")||!!e.overlays?.exclusive}function lm(e){return e.gos.get("suppressCellFocus")||!!e.overlays?.exclusive}function dd(e,t,r=!1){const n=e.ctrlsSvc.get("gridCtrl");return!r&&n.focusNextInnerContainer(t)?!0:((r||!t&&!n.isDetailGrid())&&n.forceFocusOutOfContainer(t),!1)}function PI(e,t){const r=e.focusSvc,n=r.getFocusedCell();if(n&&t&&Py(n,t)){const{rowIndex:i,rowPinned:s,column:o}=t;ty(e)&&r.setFocusedCell({rowIndex:i,column:o,rowPinned:s,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!Sk()})}}function yo(e){return e.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0}function Iy(e){const t=[],r=e.ctrlsSvc.getHeaderRowContainerCtrls();for(const n of r){if(!n)continue;const i=n.getGroupRowCount()||0;for(let s=0;s<i;s++){const o=n.getGroupRowCtrlAtIndex(s),a=t[s];if(o){const l=II(e,o);(a==null||l>a)&&(t[s]=l)}}}return t}function II(e,t){let n=e.colModel.isPivotMode()?NI(e):oR(e);const i=t.getHeaderCellCtrls();for(const s of i){const{column:o}=s,a=o.getAutoHeaderHeight();a!=null&&a>n&&o.isAutoHeaderHeight()&&(n=a)}return n}function Oy(e){let r=e.colModel.isPivotMode()?OI(e):Wf(e);return e.colModel.forAllCols(n=>{const i=n.getAutoHeaderHeight();i!=null&&i>r&&n.isAutoHeaderHeight()&&(r=i)}),r}function Wf(e){return e.gos.get("headerHeight")??e.environment.getDefaultHeaderHeight()}function sR(e){return e.gos.get("floatingFiltersHeight")??Wf(e)}function oR(e){return e.gos.get("groupHeaderHeight")??Wf(e)}function OI(e){return e.gos.get("pivotHeaderHeight")??Wf(e)}function NI(e){return e.gos.get("pivotGroupHeaderHeight")??oR(e)}function LI(e,t){return e.headerRowIndex===t.headerRowIndex&&e.column===t.column}var BI=class extends et{setComp(e,t,r){this.comp=e,this.eGui=t;const{beans:n}=this,{headerNavigation:i,touchSvc:s,ctrlsSvc:o}=n;i&&this.createManagedBean(new zf(r,{onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addManagedEventListeners({columnPivotModeChanged:this.onPivotModeChanged.bind(this,n),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this,n)}),this.onPivotModeChanged(n),this.setupHeaderHeight();const a=this.onHeaderContextMenu.bind(this);this.addManagedElementListeners(this.eGui,{contextmenu:a}),s?.mockHeaderContextMenu(this,a),o.register("gridHeaderCtrl",this)}setupHeaderHeight(){const e=this.setHeaderHeight.bind(this);e(),this.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],e),this.addManagedEventListeners({headerRowsChanged:e,columnHeaderHeightChanged:e,columnGroupHeaderHeightChanged:()=>fa(this.beans,()=>e()),stylesChanged:e,advancedFilterEnabledChanged:e})}setHeaderHeight(){const{beans:e}=this;let t=0;const r=Iy(e).reduce((s,o)=>s+o,0),n=Oy(e);if(e.filterManager?.hasFloatingFilters()&&(t+=sR(e)),t+=r,t+=n,this.headerHeight===t)return;this.headerHeight=t;const i=`${t+1}px`;this.comp.setHeightAndMinHeight(i),this.eventSvc.dispatchEvent({type:"headerHeightChanged"})}onPivotModeChanged(e){const t=e.colModel.isPivotMode();this.comp.toggleCss("ag-pivot-on",t),this.comp.toggleCss("ag-pivot-off",!t)}onDisplayedColumnsChanged(e){const r=e.visibleCols.allCols.some(n=>n.isSpanHeaderHeight());this.comp.toggleCss("ag-header-allow-overflow",r)}onTabKeyDown(e){const t=this.gos.get("enableRtl"),r=e.shiftKey,n=r!==t?"LEFT":"RIGHT",{beans:i}=this,{headerNavigation:s,focusSvc:o}=i;(s.navigateHorizontally(n,!0,e)||!r&&o.focusOverlay(!1)||dd(i,r,!0))&&e.preventDefault()}handleKeyDown(e){let t=null;const{headerNavigation:r}=this.beans;switch(e.key){case $e.LEFT:t="LEFT";case $e.RIGHT:{bt(t)||(t="RIGHT"),r.navigateHorizontally(t,!1,e)&&e.preventDefault();break}case $e.UP:t="UP";case $e.DOWN:{bt(t)||(t="DOWN"),r.navigateVertically(t,e)&&e.preventDefault();break}default:return}}onFocusOut(e){const{relatedTarget:t}=e,{eGui:r,beans:n}=this;!t&&r.contains(tn(n))||r.contains(t)||(n.focusSvc.focusedHeader=null)}onHeaderContextMenu(e,t,r){const{menuSvc:n,ctrlsSvc:i}=this.beans;if(!e&&!r||!n?.isHeaderContextMenuEnabled())return;const{target:s}=e??t;(s===this.eGui||s===i.getHeaderRowContainerCtrl()?.eViewport)&&n.showHeaderContextMenu(void 0,e,r)}},Ny=class extends et{constructor(e,t,r,n){super(),this.columnOrGroup=e,this.eCell=t,this.colsSpanning=n,this.columnOrGroup=e,this.ariaEl=t.querySelector("[role=columnheader]")||t,this.beans=r}setColsSpanning(e){this.colsSpanning=e,this.onLeftChanged()}getColumnOrGroup(){const{beans:e,colsSpanning:t}=this;return e.gos.get("enableRtl")&&t?zr(t):this.columnOrGroup}postConstruct(){const e=this.onLeftChanged.bind(this);this.addManagedListeners(this.columnOrGroup,{leftChanged:e}),this.setLeftFirstTime(),this.addManagedEventListeners({displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}setLeftFirstTime(){const{gos:e,colAnimation:t}=this.beans,r=e.get("suppressColumnMoveAnimation"),n=bt(this.columnOrGroup.getOldLeft());t?.isActive()&&n&&!r?this.animateInLeft():this.onLeftChanged()}animateInLeft(){const e=this.getColumnOrGroup(),t=this.modifyLeftForPrintLayout(e,e.getOldLeft()),r=this.modifyLeftForPrintLayout(e,e.getLeft());this.setLeft(t),this.actualLeft=r,this.beans.colAnimation.executeNextVMTurn(()=>{this.actualLeft===r&&this.setLeft(r)})}onLeftChanged(){const e=this.getColumnOrGroup(),t=e.getLeft();this.actualLeft=this.modifyLeftForPrintLayout(e,t),this.setLeft(this.actualLeft)}modifyLeftForPrintLayout(e,t){const{gos:r,visibleCols:n}=this.beans;if(!ni(r,"print")||e.getPinned()==="left")return t;const s=n.getColsLeftWidth();if(e.getPinned()==="right"){const o=n.bodyWidth;return s+o+t}return s+t}setLeft(e){if(bt(e)&&(this.eCell.style.left=`${e}px`),yn(this.columnOrGroup)){const t=this.columnOrGroup.getLeafColumns();if(!t.length)return;t.length>1&&UM(this.ariaEl,t.length)}}},HI=0,aR="headerCtrl",Ly=class extends et{constructor(e,t){super(),this.column=e,this.rowCtrl=t,this.resizeToggleTimeout=0,this.resizeMultiplier=1,this.resizeFeature=null,this.lastFocusEvent=null,this.dragSource=null,this.reAttemptToFocus=!1,this.instanceId=e.getUniqueId()+"-"+HI++}postConstruct(){const e=this.refreshTabIndex.bind(this);this.addManagedPropertyListeners(["suppressHeaderFocus"],e),this.addManagedEventListeners({overlayExclusiveChanged:e})}setComp(e,t,r,n,i){t.setAttribute("col-id",this.column.colIdSanitised),this.wireComp(e,t,r,n,i),this.reAttemptToFocus&&(this.reAttemptToFocus=!1,this.focus(this.lastFocusEvent??void 0))}shouldStopEventPropagation(e){const{headerRowIndex:t,column:r}=this.beans.focusSvc.focusedHeader,n=r.getDefinition(),i=n?.suppressHeaderKeyboardEvent;if(!bt(i))return!1;const s=Dt(this.gos,{colDef:n,column:r,headerRowIndex:t,event:e});return!!i(s)}getWrapperHasFocus(){return tn(this.beans)===this.eGui}setGui(e,t){this.eGui=e,this.addDomData(t),t.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this)}),t.addManagedElementListeners(this.eGui,{focus:this.onGuiFocus.bind(this)}),this.onDisplayedColumnsChanged(),this.refreshTabIndex()}refreshHeaderStyles(){const e=this.column.getDefinition();if(!e)return;const{headerStyle:t}=e;let r;if(typeof t=="function"){const n=this.getHeaderClassParams();r=t(n)}else r=t;r&&this.comp.setUserStyles(r)}onGuiFocus(){this.eventSvc.dispatchEvent({type:"headerFocused",column:this.column})}setupAutoHeight(e){const{wrapperElement:t,checkMeasuringCallback:r,compBean:n}=e,{beans:i}=this,s=h=>{if(!this.isAlive()||!n.isAlive())return;const{paddingTop:d,paddingBottom:f,borderBottomWidth:m,borderTopWidth:v}=Ac(this.eGui),g=d+f+m+v,y=t.offsetHeight+g;if(h<5){const k=!Gn(i)?.contains(t),F=y==0;if(k||F){Jb(()=>s(h+1),"raf",i);return}}this.setColHeaderHeight(this.column,y)};let o=!1,a;const l=()=>{const h=this.column.isAutoHeaderHeight();h&&!o&&c(),!h&&o&&u()},c=()=>{o=!0,this.comp.toggleCss("ag-header-cell-auto-height",!0),s(0),a=ha(this.beans,t,()=>s(0))},u=()=>{o=!1,a&&a(),this.comp.toggleCss("ag-header-cell-auto-height",!1),a=void 0};l(),n.addDestroyFunc(()=>u()),n.addManagedListeners(this.column,{widthChanged:()=>o&&s(0)}),n.addManagedEventListeners({sortChanged:()=>{o&&window.setTimeout(()=>s(0))}}),r&&r(l)}onDisplayedColumnsChanged(){const{comp:e,column:t,beans:r,eGui:n}=this;!e||!t||!n||(nR(e,t,r.visibleCols),_T(n,r.visibleCols.getAriaColIndex(t)))}addResizeAndMoveKeyboardListeners(e){e.addManagedListeners(this.eGui,{keydown:this.onGuiKeyDown.bind(this),keyup:this.onGuiKeyUp.bind(this)})}refreshTabIndex(){const e=lc(this.beans);this.eGui&&Oi(this.eGui,"tabindex",e?null:"-1")}onGuiKeyDown(e){const t=tn(this.beans),r=e.key===$e.LEFT||e.key===$e.RIGHT;if(this.isResizing&&(e.preventDefault(),e.stopImmediatePropagation()),t!==this.eGui||!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey)return;if((this.isResizing||r)&&(e.preventDefault(),e.stopImmediatePropagation()),(e.ctrlKey||e.metaKey)&&wk(e)===$e.C)return this.beans.clipboardSvc?.copyToClipboard();if(!r)return;const s=e.key===$e.LEFT!==this.gos.get("enableRtl")?"left":"right";if(e.altKey){this.isResizing=!0,this.resizeMultiplier+=1;const o=this.getViewportAdjustedResizeDiff(e);this.resizeHeader(o,e.shiftKey),this.resizeFeature?.toggleColumnResizing(!0)}else this.moveHeader(s)}moveHeader(e){this.beans.colMoves?.moveHeader(e,this.eGui,this.column,this.rowCtrl.pinned,this)}getViewportAdjustedResizeDiff(e){const t=this.getResizeDiff(e),{pinnedCols:r}=this.beans;return r?r.getHeaderResizeDiff(t,this.column):t}getResizeDiff(e){const{gos:t,column:r}=this;let n=e.key===$e.LEFT!==t.get("enableRtl");const i=r.getPinned(),s=t.get("enableRtl");return i&&s!==(i==="right")&&(n=!n),(n?-1:1)*this.resizeMultiplier}onGuiKeyUp(){this.isResizing&&(this.resizeToggleTimeout&&(window.clearTimeout(this.resizeToggleTimeout),this.resizeToggleTimeout=0),this.isResizing=!1,this.resizeMultiplier=1,this.resizeToggleTimeout=window.setTimeout(()=>{this.resizeFeature?.toggleColumnResizing(!1)},150))}handleKeyDown(e){const t=this.getWrapperHasFocus();switch(e.key){case $e.PAGE_DOWN:case $e.PAGE_UP:case $e.PAGE_HOME:case $e.PAGE_END:t&&e.preventDefault()}}addDomData(e){const t=aR,{eGui:r,gos:n}=this;vc(n,r,t,this),e.addDestroyFunc(()=>vc(n,r,t,null))}focus(e){if(!this.isAlive())return!1;const{eGui:t}=this;return t?(this.lastFocusEvent=e||null,t.focus()):this.reAttemptToFocus=!0,!0}focusThis(){this.beans.focusSvc.focusedHeader={headerRowIndex:this.rowCtrl.rowIndex,column:this.column}}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop?.removeDragSource(this.dragSource),this.dragSource=null)}handleContextMenuMouseEvent(e,t,r){const n=e??t,{menuSvc:i,gos:s}=this.beans;s.get("preventDefaultOnContextMenu")&&n.preventDefault(),i?.isHeaderContextMenuEnabled(r)&&i.showHeaderContextMenu(r,e,t),this.dispatchColumnMouseEvent("columnHeaderContextMenu",r)}dispatchColumnMouseEvent(e,t){this.eventSvc.dispatchEvent({type:e,column:t})}setColHeaderHeight(e,t){if(!e.setAutoHeaderHeight(t))return;const{eventSvc:r}=this;e.isColumn?r.dispatchEvent({type:"columnHeaderHeightChanged",column:e,columns:[e],source:"autosizeColumnHeaderHeight"}):r.dispatchEvent({type:"columnGroupHeaderHeightChanged",columnGroup:e,source:"autosizeColumnGroupHeaderHeight"})}clearComponent(){this.removeDragSource(),this.resizeFeature=null,this.comp=null,this.eGui=null}destroy(){super.destroy(),this.column=null,this.lastFocusEvent=null,this.rowCtrl=null}},jI=class extends Ly{constructor(){super(...arguments),this.refreshFunctions={},this.userHeaderClasses=new Set,this.ariaDescriptionProperties=new Map}wireComp(e,t,r,n,i){this.comp=e;const{rowCtrl:s,column:o,beans:a}=this,{colResize:l,context:c,colHover:u,rangeSvc:h}=a,d=Vf(this,c,i);this.setGui(t,d),this.updateState(),this.setupWidth(d),this.setupMovingCss(d),this.setupMenuClass(d),this.setupSortableClass(d),this.setupWrapTextClass(),this.refreshSpanHeaderHeight(),this.setupAutoHeight({wrapperElement:n,checkMeasuringCallback:m=>this.setRefreshFunction("measuring",m),compBean:d}),this.addColumnHoverListener(d),this.setupFilterClass(d),this.setupStylesFromColDef(),this.setupClassesFromColDef(),this.setupTooltip(),this.addActiveHeaderMouseListeners(d),this.setupSelectAll(d),this.setupUserComp(),this.refreshAria(),l?this.resizeFeature=d.createManagedBean(l.createResizeFeature(s.pinned,o,r,e,this)):Gr(r,!1),u?.createHoverFeature(d,[o],t),h?.createRangeHighlightFeature(d,o,e),d.createManagedBean(new Ny(o,t,a)),d.createManagedBean(new zf(t,{shouldStopEventPropagation:m=>this.shouldStopEventPropagation(m),onTabKeyDown:()=>null,handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this),onFocusOut:this.onFocusOut.bind(this)})),this.addResizeAndMoveKeyboardListeners(d),d.addManagedPropertyListeners(["suppressMovableColumns","suppressMenuHide","suppressAggFuncInHeader","enableAdvancedFilter"],()=>this.refresh()),d.addManagedListeners(o,{colDefChanged:()=>this.refresh(),formulaRefChanged:()=>this.refresh(),headerHighlightChanged:this.onHeaderHighlightChanged.bind(this)});const f=()=>this.checkDisplayName();d.addManagedEventListeners({columnValueChanged:f,columnRowGroupChanged:f,columnPivotChanged:f,headerHeightChanged:this.onHeaderHeightChanged.bind(this)}),d.addDestroyFunc(()=>{this.refreshFunctions={},this.selectAllFeature=null,this.dragSourceElement=void 0,this.userCompDetails=null,this.userHeaderClasses.clear(),this.ariaDescriptionProperties.clear(),this.clearComponent()})}resizeHeader(e,t){this.beans.colResize?.resizeHeader(this.column,e,t)}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.colDef;return Dt(t.gos,{colDef:r,column:e,floatingFilter:!1})}setupUserComp(){const e=this.lookupUserCompDetails();e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setUserCompDetails(e)}lookupUserCompDetails(){const e=this.createParams(),t=this.column.getColDef();return jP(this.beans.userCompFactory,t,e)}createParams(){const{menuSvc:e,sortSvc:t,colFilter:r,gos:n}=this.beans;return Dt(n,{column:this.column,displayName:this.displayName,enableSorting:this.column.isSortable(),enableMenu:this.menuEnabled,enableFilterButton:this.openFilterEnabled&&!!e?.isHeaderFilterButtonEnabled(this.column),enableFilterIcon:!!r&&(!this.openFilterEnabled||rs(this.gos)),showColumnMenu:(s,o)=>{e?.showColumnMenu({column:this.column,buttonElement:s,positionBy:"button",onClosedCallback:o})},showColumnMenuAfterMouseClick:(s,o)=>{e?.showColumnMenu({column:this.column,mouseEvent:s,positionBy:"mouse",onClosedCallback:o})},showFilter:s=>{e?.showFilterMenu({column:this.column,buttonElement:s,containerType:"columnFilter",positionBy:"button"})},progressSort:s=>{t?.progressSort(this.column,!!s,"uiColumnSorted")},setSort:(s,o)=>{t?.setSortForColumn(this.column,Gs(s),!!o,"uiColumnSorted")},eGridHeader:this.eGui,setTooltip:(s,o)=>{n.assertModuleRegistered("Tooltip",3),this.setupTooltip(s,o)}})}setupSelectAll(e){const{selectionSvc:t}=this.beans;t&&(this.selectAllFeature=e.createOptionalManagedBean(t.createSelectAllFeature(this.column)),this.selectAllFeature?.setComp(this),e.addManagedPropertyListener("rowSelection",()=>{const r=t.createSelectAllFeature(this.column);r&&!this.selectAllFeature?(this.selectAllFeature=e.createManagedBean(r),this.selectAllFeature?.setComp(this),this.comp.refreshSelectAllGui()):this.selectAllFeature&&!r&&(this.comp.removeSelectAllGui(),this.selectAllFeature=this.destroyBean(this.selectAllFeature))}))}getSelectAllGui(){return this.selectAllFeature?.getCheckboxGui()}handleKeyDown(e){super.handleKeyDown(e),e.key===$e.SPACE?this.selectAllFeature?.onSpaceKeyDown(e):e.key===$e.ENTER?this.onEnterKeyDown(e):e.key===$e.DOWN&&e.altKey&&this.showMenuOnKeyPress(e,!1)}onEnterKeyDown(e){const{column:t,gos:r,sortable:n,beans:i}=this;let s=!1;(e.ctrlKey||e.metaKey)&&(s=this.showMenuOnKeyPress(e,!0)),s||(!e.altKey&&$u(r)?i.rangeSvc?.handleColumnSelection(t,e):n&&i.sortSvc?.progressSort(t,e.shiftKey,"uiColumnSorted"))}showMenuOnKeyPress(e,t){const r=this.comp.getUserCompInstance();return m4(r)&&r.onMenuKeyboardShortcut(t)?(e.preventDefault(),!0):!1}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription()),Sk()&&this.setActiveHeader(!0)}onFocusOut(e){this.eGui.contains(e.relatedTarget)||this.setActiveHeader(!1)}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderTooltip(this.tooltipFeature,this,e,t)}setupStylesFromColDef(){this.setRefreshFunction("headerStyles",this.refreshHeaderStyles.bind(this)),this.refreshHeaderStyles()}setupClassesFromColDef(){const e=()=>{const t=this.column.getColDef(),r=rR(t,this.gos,this.column,null),n=this.userHeaderClasses;this.userHeaderClasses=new Set(r);for(const i of r)n.has(i)?n.delete(i):this.comp.toggleCss(i,!0);for(const i of n)this.comp.toggleCss(i,!1)};this.setRefreshFunction("headerClasses",e),e()}setDragSource(e){this.dragSourceElement=e,this.removeDragSource(),!(!e||!this.draggable)&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null)}updateState(){const{menuSvc:e}=this.beans;this.menuEnabled=!!e?.isColumnMenuInHeaderEnabled(this.column),this.openFilterEnabled=!!e?.isFilterMenuInHeaderEnabled(this.column),this.sortable=this.column.isSortable(),this.displayName=this.calculateDisplayName(),this.draggable=this.workOutDraggable()}setRefreshFunction(e,t){this.refreshFunctions[e]=t}refresh(){this.updateState(),this.refreshHeaderComp(),this.refreshAria();for(const e of Object.values(this.refreshFunctions))e()}refreshHeaderComp(){const e=this.lookupUserCompDetails();if(!e)return;(this.comp.getUserCompInstance()!=null&&this.userCompDetails.componentClass==e.componentClass?this.attemptHeaderCompRefresh(e.params):!1)?this.setDragSource(this.dragSourceElement):this.setCompDetails(e)}attemptHeaderCompRefresh(e){const t=this.comp.getUserCompInstance();return!t||!t.refresh?!1:t.refresh(e)}calculateDisplayName(){return this.beans.colNames.getDisplayNameForColumn(this.column,"header",!0)}checkDisplayName(){this.displayName!==this.calculateDisplayName()&&this.refresh()}workOutDraggable(){const e=this.column.getColDef();return!!(!this.gos.get("suppressMovableColumns")&&!e.suppressMovable&&!e.lockPosition)||!!e.enableRowGroup||!!e.enablePivot}setupWidth(e){const t=()=>{const r=this.column.getActualWidth();this.comp.setWidth(`${r}px`)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupMovingCss(e){const t=()=>{this.comp.toggleCss("ag-header-cell-moving",this.column.isMoving())};e.addManagedListeners(this.column,{movingChanged:t}),t()}setupMenuClass(e){const t=()=>{this.comp?.toggleCss("ag-column-menu-visible",this.column.isMenuVisible())};e.addManagedListeners(this.column,{menuVisibleChanged:t}),t()}setupSortableClass(e){const t=()=>{this.comp.toggleCss("ag-header-cell-sortable",!!this.sortable)};t(),this.setRefreshFunction("updateSortable",t),e.addManagedEventListeners({sortChanged:this.refreshAriaSort.bind(this)})}setupFilterClass(e){const t=()=>{const r=this.column.isFilterActive();this.comp.toggleCss("ag-header-cell-filtered",r),this.refreshAria()};e.addManagedListeners(this.column,{filterActiveChanged:t}),t()}setupWrapTextClass(){const e=()=>{const t=!!this.column.getColDef().wrapHeaderText;this.comp.toggleCss("ag-header-cell-wrap-text",t)};e(),this.setRefreshFunction("wrapText",e)}onHeaderHighlightChanged(){const e=this.column.getHighlighted(),t=e===0,r=e===1;this.comp.toggleCss("ag-header-highlight-before",t),this.comp.toggleCss("ag-header-highlight-after",r)}onDisplayedColumnsChanged(){super.onDisplayedColumnsChanged(),this.isAlive()&&this.onHeaderHeightChanged()}onHeaderHeightChanged(){this.refreshSpanHeaderHeight()}refreshSpanHeaderHeight(){const{eGui:e,column:t,comp:r,beans:n}=this,i=Iy(this.beans),s=i.reduce((d,f)=>d+f,0)===0;if(r.toggleCss("ag-header-parent-hidden",s),!t.isSpanHeaderHeight()){e.style.removeProperty("top"),e.style.removeProperty("height"),r.toggleCss("ag-header-span-height",!1),r.toggleCss("ag-header-span-total",!1);return}const{numberOfParents:o,isSpanningTotal:a}=this.column.getColumnGroupPaddingInfo();r.toggleCss("ag-header-span-height",o>0);const l=Oy(n);if(o===0){r.toggleCss("ag-header-span-total",!1),e.style.setProperty("top","0px"),e.style.setProperty("height",`${l}px`);return}r.toggleCss("ag-header-span-total",a);const c=(this.column.getFirstRealParent()?.getLevel()??-1)+1,u=i.length-c;let h=0;for(let d=0;d<u;d++)h+=i[i.length-1-d];e.style.setProperty("top",`${-h}px`),e.style.setProperty("height",`${l+h}px`)}refreshAriaSort(){let e=null;const{beans:t,column:r,comp:n,sortable:i}=this;if(i){const s=this.getLocaleTextFunc(),o=t.sortSvc?.getDisplaySortForColumn(r)??null;n.setAriaSort(IM(o)),e=s("ariaSortableColumn","Press ENTER to sort")}else n.setAriaSort();this.setAriaDescriptionProperty("sort",e)}refreshAriaMenu(){let e=null;this.menuEnabled&&(e=this.getLocaleTextFunc()("ariaMenuColumn","Press ALT DOWN to open column menu")),this.setAriaDescriptionProperty("menu",e)}refreshAriaFilterButton(){let e=null;const{openFilterEnabled:t,gos:r}=this;t&&!rs(r)&&(e=this.getLocaleTextFunc()("ariaFilterColumn","Press CTRL ENTER to open filter")),this.setAriaDescriptionProperty("filterButton",e)}refreshAriaFiltered(){let e=null;this.column.isFilterActive()&&(e=this.getLocaleTextFunc()("ariaColumnFiltered","Column Filtered")),this.setAriaDescriptionProperty("filter",e)}refreshAriaCellSelection(){let e=null;const{gos:t,column:r,beans:n}=this;if($u(t)){const s=this.getLocaleTextFunc(),o=n.rangeSvc?.isColumnInAnyRange(r);e=s("ariaColumnCellSelection",`Press CTRL+SPACE to ${o?"de":""}select all visible cells in this column`)}this.setAriaDescriptionProperty("cellSelection",e)}setAriaDescriptionProperty(e,t){const r=this.ariaDescriptionProperties;t!=null?r.set(e,t):r.delete(e)}announceAriaDescription(){const{beans:e,eGui:t,ariaDescriptionProperties:r}=this;if(!t.contains(tn(e)))return;const n=Array.from(r.keys()).sort((i,s)=>i==="filter"?-1:s.charCodeAt(0)-i.charCodeAt(0)).map(i=>r.get(i)).join(". ");e.ariaAnnounce?.announceValue(n,"columnHeader")}refreshAria(){this.refreshAriaSort(),this.refreshAriaMenu(),this.refreshAriaFilterButton(),this.refreshAriaFiltered(),this.refreshAriaCellSelection()}addColumnHoverListener(e){this.beans.colHover?.addHeaderColumnHoverListener(e,this.comp,this.column)}addActiveHeaderMouseListeners(e){const t=i=>this.handleMouseOverChange(i.type==="mouseenter"),r=()=>{this.setActiveHeader(!0),this.dispatchColumnMouseEvent("columnHeaderClicked",this.column)},n=i=>this.handleContextMenuMouseEvent(i,void 0,this.column);e.addManagedListeners(this.eGui,{mouseenter:t,mouseleave:t,click:r,contextmenu:n})}handleMouseOverChange(e){this.setActiveHeader(e),this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column})}setActiveHeader(e){this.comp.toggleCss("ag-header-active",e)}getAnchorElementForMenu(e){const t=this.comp.getUserCompInstance();return m4(t)?t.getAnchorElementForMenu(e):this.eGui}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function m4(e){return typeof e?.getAnchorElementForMenu=="function"&&typeof e.onMenuKeyboardShortcut=="function"}var VI=0,sb=class extends et{constructor(e,t,r){super(),this.rowIndex=e,this.pinned=t,this.type=r,this.instanceId=VI++,this.comp=null,this.allCtrls=[];let n="ag-header-row-column";r==="group"?n="ag-header-row-group":r==="filter"&&(n="ag-header-row-filter"),this.headerRowClass=`ag-header-row ${n}`}setRowIndex(e){this.rowIndex=e,this.comp?.setRowIndex(this.getAriaRowIndex()),this.onRowHeightChanged()}postConstruct(){this.isPrintLayout=ni(this.gos,"print"),this.isEnsureDomOrder=this.gos.get("ensureDomOrder")}areCellsRendered(){return this.comp?this.allCtrls.every(e=>e.eGui!=null):!1}setComp(e,t,r=!0){this.comp=e,t=Vf(this,this.beans.context,t),r&&(this.setRowIndex(this.rowIndex),this.onVirtualColumnsChanged()),this.setWidth(),this.addEventListeners(t)}getAriaRowIndex(){return this.rowIndex+1}addEventListeners(e){const t=this.onRowHeightChanged.bind(this),r=this.onDisplayedColumnsChanged.bind(this);e.addManagedEventListeners({columnResized:this.setWidth.bind(this),displayedColumnsChanged:r,virtualColumnsChanged:n=>this.onVirtualColumnsChanged(n.afterScroll),columnGroupHeaderHeightChanged:t,columnHeaderHeightChanged:t,stylesChanged:t,advancedFilterEnabledChanged:t}),e.addManagedPropertyListener("domLayout",r),e.addManagedPropertyListener("ensureDomOrder",n=>this.isEnsureDomOrder=n.currentValue),e.addManagedPropertyListeners(["headerHeight","pivotHeaderHeight","groupHeaderHeight","pivotGroupHeaderHeight","floatingFiltersHeight"],t)}onDisplayedColumnsChanged(){this.isPrintLayout=ni(this.gos,"print"),this.onVirtualColumnsChanged(),this.setWidth(),this.onRowHeightChanged()}setWidth(){if(!this.comp)return;const e=this.getWidthForRow();this.comp.setWidth(`${e}px`)}getWidthForRow(){const{visibleCols:e}=this.beans;return this.isPrintLayout?this.pinned!=null?0:e.getContainerWidth("right")+e.getContainerWidth("left")+e.getContainerWidth(null):e.getContainerWidth(this.pinned)}onRowHeightChanged(){if(!this.comp)return;const{topOffset:e,rowHeight:t}=this.getTopAndHeight();this.comp.setTop(e+"px"),this.comp.setHeight(t+"px")}getTopAndHeight(){let e=0;const t=Iy(this.beans);for(let i=0;i<t.length;i++){if(i===this.rowIndex&&this.type==="group")return{topOffset:e,rowHeight:t[i]};e+=t[i]}const r=Oy(this.beans);if(this.type==="column")return{topOffset:e,rowHeight:r};e+=r;const n=sR(this.beans);return{topOffset:e,rowHeight:n}}onVirtualColumnsChanged(e=!1){if(!this.comp)return;const t=this.getUpdatedHeaderCtrls(),r=this.isEnsureDomOrder||this.isPrintLayout;this.comp.setHeaderCtrls(t,r,e)}getUpdatedHeaderCtrls(){const e=this.ctrlsById;this.ctrlsById=new Map;const t=this.getColumnsInViewport();for(const n of t)this.recycleAndCreateHeaderCtrls(n,this.ctrlsById,e);const r=n=>{const{focusSvc:i,visibleCols:s}=this.beans;return i.isHeaderWrapperFocused(n)?s.isVisible(n.column):!1};if(e)for(const[n,i]of e)r(i)?this.ctrlsById.set(n,i):this.destroyBean(i);return this.allCtrls=Array.from(this.ctrlsById.values()),this.allCtrls}getHeaderCellCtrls(){return this.allCtrls}recycleAndCreateHeaderCtrls(e,t,r){if(e.isEmptyGroup())return;const n=e.getUniqueId();let i;if(r&&(i=r.get(n),r.delete(n)),i&&i.column!=e&&(this.destroyBean(i),i=void 0),i==null)switch(this.type){case"filter":{i=this.createBean(this.beans.registry.createDynamicBean("headerFilterCellCtrl",!0,e,this));break}case"group":i=this.createBean(this.beans.registry.createDynamicBean("headerGroupCellCtrl",!0,e,this));break;default:i=this.createBean(new jI(e,this));break}t.set(n,i)}getColumnsInViewport(){if(!this.isPrintLayout)return this.getComponentsToRender();if(this.pinned)return[];const e=[];for(const t of["left",null,"right"])e.push(...this.getComponentsToRender(t));return e}getComponentsToRender(e=this.pinned){return this.type==="group"?this.beans.colViewport.getHeadersToRender(e,this.rowIndex):this.beans.colViewport.getColumnHeadersToRender(e)}focusHeader(e,t){const r=this.allCtrls.find(i=>i.column==e);return r?r.focus(t):!1}destroy(){this.allCtrls=this.destroyBeans(this.allCtrls),this.ctrlsById=void 0,this.comp=null,super.destroy()}},GI=class extends et{constructor(e){super(),this.pinned=e,this.hidden=!1,this.includeFloatingFilter=!1,this.groupsRowCtrls=[]}setComp(e,t){this.comp=e,this.eViewport=t;const{pinnedCols:r,ctrlsSvc:n,colModel:i,colMoves:s}=this.beans;this.setupCenterWidth(),r?.setupHeaderPinnedWidth(this),this.setupDragAndDrop(s,this.eViewport);const o=this.refresh.bind(this,!0);this.addManagedEventListeners({displayedColumnsChanged:o,advancedFilterEnabledChanged:o});const a=`${typeof this.pinned=="string"?this.pinned:"center"}Header`;n.register(a,this),i.ready&&this.refresh()}getAllCtrls(){const e=[...this.groupsRowCtrls];return this.columnsRowCtrl&&e.push(this.columnsRowCtrl),this.filtersRowCtrl&&e.push(this.filtersRowCtrl),e}refresh(e=!1){const{focusSvc:t,filterManager:r,visibleCols:n}=this.beans;let i=0;const s=t.getFocusHeaderToUseAfterRefresh(),o=()=>{const h=n.headerGroupRowCount;i=h,e||(this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls));const d=this.groupsRowCtrls.length;if(d!==h){if(d>h){for(let f=h;f<d;f++)this.destroyBean(this.groupsRowCtrls[f]);this.groupsRowCtrls.length=h;return}for(let f=d;f<h;f++){const m=this.createBean(new sb(f,this.pinned,"group"));this.groupsRowCtrls.push(m)}}},a=()=>{const h=i++;if(this.hidden){this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl);return}this.columnsRowCtrl==null||!e?(this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.columnsRowCtrl=this.createBean(new sb(h,this.pinned,"column"))):this.columnsRowCtrl.rowIndex!==h&&this.columnsRowCtrl.setRowIndex(h)},l=()=>{this.includeFloatingFilter=!!r?.hasFloatingFilters()&&!this.hidden;const h=()=>{this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl)};if(!this.includeFloatingFilter){h();return}e||h();const d=i++;this.filtersRowCtrl?this.filtersRowCtrl.rowIndex!==d&&this.filtersRowCtrl.setRowIndex(d):this.filtersRowCtrl=this.createBean(new sb(d,this.pinned,"filter"))},c=this.getAllCtrls();o(),a(),l();const u=this.getAllCtrls();this.comp.setCtrls(u),this.restoreFocusOnHeader(t,s),c.length!==u.length&&this.beans.eventSvc.dispatchEvent({type:"headerRowsChanged"})}getHeaderCtrlForColumn(e){const t=r=>r?.getHeaderCellCtrls().find(n=>n.column===e);if(cl(e))return t(this.columnsRowCtrl);if(this.groupsRowCtrls.length!==0)for(let r=0;r<this.groupsRowCtrls.length;r++){const n=t(this.groupsRowCtrls[r]);if(n)return n}}getHtmlElementForColumnHeader(e){return this.getHeaderCtrlForColumn(e)?.eGui??null}getRowType(e){return this.getAllCtrls()[e]?.type}focusHeader(e,t,r){const i=this.getAllCtrls()[e];return i?i.focusHeader(t,r):!1}getGroupRowCount(){return this.groupsRowCtrls.length}getGroupRowCtrlAtIndex(e){return this.groupsRowCtrls[e]}getRowCount(){return this.groupsRowCtrls.length+(this.columnsRowCtrl?1:0)+(this.filtersRowCtrl?1:0)}setHorizontalScroll(e){this.comp.setViewportScrollLeft(e)}onScrollCallback(e){this.addManagedElementListeners(this.eViewport,{scroll:e})}destroy(){this.filtersRowCtrl=this.destroyBean(this.filtersRowCtrl),this.columnsRowCtrl=this.destroyBean(this.columnsRowCtrl),this.groupsRowCtrls=this.destroyBeans(this.groupsRowCtrls),super.destroy()}setupDragAndDrop(e,t){const r=e?.createBodyDropTarget(this.pinned,t);r&&this.createManagedBean(r)}restoreFocusOnHeader(e,t){if(!t)return;const{column:r}=t;r.getPinned()==this.pinned&&e.focusHeaderPosition({headerPosition:t,scroll:!1})}setupCenterWidth(){this.pinned==null&&this.createManagedBean(new My(e=>this.comp.setCenterWidth(`${e}px`),!0))}},zI=class extends et{constructor(){super(...arguments),this.beanName="menuSvc"}postConstruct(){const{enterpriseMenuFactory:e,filterMenuFactory:t}=this.beans;this.activeMenuFactory=e??t}showColumnMenu(e){this.showColumnMenuCommon(this.activeMenuFactory,e,"columnMenu")}showFilterMenu(e){this.showColumnMenuCommon(b4(this.beans),e,e.containerType,!0)}showHeaderContextMenu(e,t,r){this.activeMenuFactory?.showMenuAfterContextMenuEvent(e,t,r)}hidePopupMenu(){this.beans.contextMenuSvc?.hideActiveMenu(),this.activeMenuFactory?.hideActiveMenu()}hideFilterMenu(){b4(this.beans)?.hideActiveMenu()}isColumnMenuInHeaderEnabled(e){const{suppressHeaderMenuButton:t}=e.getColDef();return!t&&!!this.activeMenuFactory?.isMenuEnabled(e)&&(rs(this.gos)||!!this.beans.enterpriseMenuFactory)}isFilterMenuInHeaderEnabled(e){return!e.getColDef().suppressHeaderFilterButton&&!!this.beans.filterManager?.isFilterAllowed(e)}isHeaderContextMenuEnabled(e){return!(e&&cl(e)?e.getColDef():e?.getColGroupDef())?.suppressHeaderContextMenu&&this.gos.get("columnMenu")==="new"}isHeaderMenuButtonAlwaysShowEnabled(){return this.isSuppressMenuHide()}isHeaderMenuButtonEnabled(){const e=!this.isSuppressMenuHide();return!(ac()&&e)}isHeaderFilterButtonEnabled(e){return this.isFilterMenuInHeaderEnabled(e)&&!rs(this.gos)&&!this.isFloatingFilterButtonDisplayed(e)}isFilterMenuItemEnabled(e){return!!this.beans.filterManager?.isFilterAllowed(e)&&!rs(this.gos)&&!this.isFilterMenuInHeaderEnabled(e)&&!this.isFloatingFilterButtonDisplayed(e)}isFloatingFilterButtonEnabled(e){return!e.getColDef().suppressFloatingFilterButton}isFloatingFilterButtonDisplayed(e){return!!e.getColDef().floatingFilter&&this.isFloatingFilterButtonEnabled(e)}isSuppressMenuHide(){const e=this.gos,t=e.get("suppressMenuHide");return rs(e)?e.exists("suppressMenuHide")?t:!1:t}showColumnMenuCommon(e,t,r,n){const{positionBy:i,onClosedCallback:s}=t,o=t.column;if(i==="button"){const{buttonElement:a}=t;e?.showMenuAfterButtonClick(o,a,r,s,n)}else if(i==="mouse"){const{mouseEvent:a}=t;e?.showMenuAfterMouseEvent(o,a,r,s,n)}else if(o){const a=this.beans,l=a.ctrlsSvc;l.getScrollFeature().ensureColumnVisible(o,"auto"),fa(a,()=>{const c=l.getHeaderRowContainerCtrl(o.getPinned())?.getHeaderCtrlForColumn(o);c&&e?.showMenuAfterButtonClick(o,c.getAnchorElementForMenu(n),r,s,n)})}}};function v4(e,t,r){e.menuVisible!==t&&(e.menuVisible=t,e.dispatchColEvent("menuVisibleChanged",r))}function b4(e){const{enterpriseMenuFactory:t,filterMenuFactory:r,gos:n}=e;return t&&rs(n)?t:r}var cm=class extends by{constructor(){super(...arguments),this.errorMessages=null}init(e){this.params=e,this.initialiseEditor(e),this.eEditor.onValueChange(()=>e.validate())}destroy(){this.errorMessages=null}},um=class extends pn{constructor(){super()}};function UI(e,t,r){const n=Li(e,t,r);if(n){const{className:s}=n;if(typeof s=="string"&&s.includes("ag-icon")||typeof s=="object"&&s["ag-icon"])return n}const i=ks({tag:"span"});return i.appendChild(n),i}function Li(e,t,r){let n=null;e==="smallDown"?at(262):e==="smallLeft"?at(263):e==="smallRight"&&at(264);const i=r?.getColDef().icons;if(i&&(n=i[e]),t.gos&&!n){const s=t.gos.get("icons");s&&(n=s[e])}if(n){let s;if(typeof n=="function")s=n();else if(typeof n=="string")s=n;else{at(38,{iconName:e});return}if(typeof s=="string")return oy(s);if(cy(s))return s;at(133,{iconName:e});return}else{const s=t.registry.getIcon(e);return s||t.validation?.validateIcon(e),ks({tag:"span",cls:`ag-icon ag-icon-${s??e}`,role:"presentation",attrs:{unselectable:"on"}})}}var WI={tag:"div",cls:"ag-overlay-loading-center",children:[{tag:"span",ref:"eLoadingIcon",cls:"ag-loading-icon"},{tag:"span",ref:"eLoadingText",cls:"ag-loading-text"}]},$I=class extends um{constructor(){super(...arguments),this.eLoadingIcon=xt,this.eLoadingText=xt}init(e){const{beans:t,gos:r}=this,n=ea(r.get("overlayLoadingTemplate")?.trim());if(this.setTemplate(n??WI),!n){const i=Li("overlayLoading",t,null);i&&this.eLoadingIcon.appendChild(i);const s=e.loading?.overlayText??this.getLocaleTextFunc()("loadingOoo","Loading...");this.eLoadingText.textContent=s,t.ariaAnnounce.announceValue(s,"overlay")}}},qI={tag:"div",cls:"ag-overlay-exporting-center",children:[{tag:"span",ref:"eExportingIcon",cls:"ag-loading-icon"},{tag:"span",ref:"eExportingText",cls:"ag-exporting-text"}]},KI=class extends um{constructor(){super(...arguments),this.eExportingIcon=xt,this.eExportingText=xt}init(e){const{beans:t}=this;this.setTemplate(qI);const r=Li("overlayExporting",t,null);r&&this.eExportingIcon.appendChild(r);const n=e.exporting?.overlayText??this.getLocaleTextFunc()("exportingOoo","Exporting...");this.eExportingText.textContent=n,t.ariaAnnounce.announceValue(n,"overlay")}},XI={tag:"span",cls:"ag-overlay-no-rows-center"},YI=class extends um{init(e){const{beans:t,gos:r}=this,n=ea(r.get("overlayNoRowsTemplate")?.trim());if(this.setTemplate(n??XI),!n){const i=e.noRows?.overlayText??this.getLocaleTextFunc()("noRowsToShow","No Rows To Show");this.getGui().textContent=i,t.ariaAnnounce.announceValue(i,"overlay")}}},ZI={tag:"span",cls:"ag-overlay-no-matching-rows-center"},JI=class extends um{init(e){const{beans:t}=this;this.setTemplate(ZI);const r=e.noMatchingRows?.overlayText??this.getLocaleTextFunc()("noMatchingRows","No Matching Rows");this.getGui().textContent=r,t.ariaAnnounce.announceValue(r,"overlay")}},QI=".ag-dnd-ghost{align-items:center;background-color:var(--ag-drag-and-drop-image-background-color);border:var(--ag-drag-and-drop-image-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-drag-and-drop-image-shadow);color:var(--ag-text-color);cursor:move;display:flex;font-weight:500;gap:var(--ag-cell-widget-spacing);height:var(--ag-header-height);overflow:hidden;padding-left:var(--ag-cell-horizontal-padding);padding-right:var(--ag-cell-horizontal-padding);text-overflow:ellipsis;transform:translateY(calc(var(--ag-spacing)*2));white-space:nowrap}.ag-dnd-ghost-not-allowed{border:var(--ag-drag-and-drop-image-not-allowed-border)}",eO={tag:"div",children:[{tag:"div",ref:"eGhost",cls:"ag-dnd-ghost ag-unselectable",children:[{tag:"span",ref:"eIcon",cls:"ag-dnd-ghost-icon ag-shake-left-to-right"},{tag:"div",ref:"eLabel",cls:"ag-dnd-ghost-label"}]}]},tO=class extends pn{constructor(){super(),this.dragSource=null,this.eIcon=xt,this.eLabel=xt,this.eGhost=xt,this.registerCSS(QI)}postConstruct(){const e=t=>UI(t,this.beans,null);this.dropIconMap={pinned:e("columnMovePin"),hide:e("columnMoveHide"),move:e("columnMoveMove"),left:e("columnMoveLeft"),right:e("columnMoveRight"),group:e("columnMoveGroup"),aggregate:e("columnMoveValue"),pivot:e("columnMovePivot"),notAllowed:e("dropNotAllowed")}}init(e){this.dragSource=e.dragSource,this.setTemplate(eO),this.beans.environment.applyThemeClasses(this.eGhost)}destroy(){this.dragSource=null,super.destroy()}setIcon(e,t){const{eGhost:r,eIcon:n,dragSource:i,dropIconMap:s,gos:o}=this;Hi(n);let a=null;e||(e=i?.getDefaultIconName?i.getDefaultIconName():"notAllowed"),a=s[e],r.classList.toggle("ag-dnd-ghost-not-allowed",e==="notAllowed"),n.classList.toggle("ag-shake-left-to-right",t),!(a===s.hide&&o.get("suppressDragLeaveHidesColumns"))&&a&&n.appendChild(a)}setLabel(e){this.eLabel.textContent=e}},rO=".ag-checkbox-cell{height:100%}",nO={tag:"div",cls:"ag-cell-wrapper ag-checkbox-cell",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},iO=class extends pn{constructor(){super(nO,[Cy]),this.eCheckbox=xt,this.registerCSS(rO)}init(e){this.refresh(e);const{eCheckbox:t,beans:r}=this,n=t.getInputElement();n.setAttribute("tabindex","-1"),CT(n,"polite"),this.addManagedListeners(n,{click:i=>{if(wc(i),t.isDisabled())return;const s=t.getValue();this.onCheckboxChanged(s)},dblclick:i=>{wc(i)}}),this.addManagedElementListeners(e.eGridCell,{keydown:i=>{if(i.key===$e.SPACE&&!t.isDisabled()){e.eGridCell===tn(r)&&t.toggle();const s=t.getValue();this.onCheckboxChanged(s),i.preventDefault()}}})}refresh(e){return this.params=e,this.updateCheckbox(e),!0}updateCheckbox(e){let t,r=!0;const{value:n,column:i,node:s}=e;if(s.group&&i)if(typeof n=="boolean")t=n;else{const h=i.getColId();h.startsWith(im)?t=n==null||n===""?void 0:n==="true":s.aggData&&s.aggData[h]!==void 0||s.sourceRowIndex>=0?t=n??void 0:r=!1}else t=n??void 0;const{eCheckbox:o}=this;if(!r){o.setDisplayed(!1);return}o.setValue(t);const a=e.disabled??!i?.isCellEditable(s);o.setDisabled(a);const l=this.getLocaleTextFunc(),c=tm(l,t),u=a?c:`${l("ariaToggleCellValue","Press SPACE to toggle cell value")} (${c})`;o.setInputAriaLabel(u)}onCheckboxChanged(e){const{params:t}=this,{column:r,node:n,value:i}=t,{editSvc:s}=this.beans;if(!r)return;const o={rowNode:n,column:r};s?.dispatchCellEvent(o,null,"cellEditingStarted",{value:i});const a=n.setDataValue(r,e,"ui");s?.dispatchCellEvent(o,null,"cellEditingStopped",{oldValue:i,newValue:e,valueChanged:a}),a||this.updateCheckbox(t)}},w4=class{constructor(e,t){this.beans=e,this.floating=t,this.all=new Set,this.visible=new Set,this.order=[],this.queued=new Set}size(){return this.visible.size}add(e){const{all:t,visible:r,order:n}=this;t.has(e)||(t.add(e),r.add(e),n.push(e),this.sort())}delete(e){this.all.delete(e),this.visible.delete(e),this.queued.delete(e.id),Eo(this.order,e)}has(e){return this.visible.has(e)}forEach(e){this.order.forEach(e)}getByIndex(e){return this.order[e]}getById(e){for(const t of this.visible)if(t.id==e)return t}clear(){const{all:e,visible:t,order:r,queued:n}=this;e.clear(),n.clear(),t.clear(),r.length=0}sort(){const{sortSvc:e,rowNodeSorter:t,gos:r}=this.beans,n=e?.getSortOptions()??[],i=this.order,s=aO(i);if(i.sort((a,l)=>t?.compareRowNodes(n,a,l)||(a.pinnedSibling?.rowIndex??0)-(l.pinnedSibling?.rowIndex??0)),!s)return;const o=YT(r);o==="bottom"||o==="pinnedBottom"?this.order.push(s):this.order.unshift(s)}hide(e){const{all:t,visible:r}=this,n=r.size;return t.forEach(i=>e(i)?r.delete(i):r.add(i)),this.order=Array.from(r),this.sort(),n!=r.size}queue(e){this.queued.add(e)}unqueue(e){this.queued.delete(e)}forEachQueued(e){this.queued.forEach(e)}};function lR(e){if(e.level===-1)return!0;const t=e.parent;return t?.childrenAfterSort?.some(r=>r==e)?lR(t):!1}function ob(e,t){const{gos:r,rowModel:n,filterManager:i}=e;return Cd(r)?!n.getRowNode(t.id):i?.isAnyFilterPresent()?!lR(t):r.get("pivotMode")?!t.group:!1}function sO(e){return!!e.footer&&e.level===-1}function oO(e){return!!e.pinnedSibling&&sO(e.pinnedSibling)}function aO(e){const t=e.findIndex(oO);if(t>-1)return e.splice(t,1)?.[0]}var y4=class extends et{postConstruct(){const{gos:e,beans:t}=this;this.top=new w4(t,"top"),this.bottom=new w4(t,"bottom");const r=i=>ob(t,i.pinnedSibling),n=()=>{const i=e.get("isRowPinned");i&&e.get("enableRowPinning")&&t.rowModel.forEachNode(s=>this.pinRow(s,i(s)),!0),this.refreshRowPositions(),this.dispatchRowPinnedEvents()};this.addManagedEventListeners({stylesChanged:this.onGridStylesChanges.bind(this),modelUpdated:({keepRenderedRows:i})=>{this.tryToEmptyQueues(),this.pinGrandTotalRow();let s=!1;this.forContainers(a=>{s||(s=a.hide(r))});const o=this.refreshRowPositions();(!i||o||s)&&this.dispatchRowPinnedEvents()},columnRowGroupChanged:()=>{this.forContainers(cO),this.refreshRowPositions()},rowNodeDataChanged:({node:i})=>{(e.get("isRowPinnable")?.(i)??!0)||this.pinRow(i,null)},firstDataRendered:n}),this.addManagedPropertyListener("pivotMode",()=>{this.forContainers(i=>i.hide(r)),this.dispatchRowPinnedEvents()}),this.addManagedPropertyListener("grandTotalRow",({currentValue:i})=>{this._grandTotalPinned=i==="pinnedBottom"?"bottom":i==="pinnedTop"?"top":null}),this.addManagedPropertyListener("isRowPinned",n)}destroy(){this.reset(!1),super.destroy()}reset(e=!0){this.forContainers(t=>{const r=[];t.forEach(n=>r.push(n)),r.forEach(n=>this.pinRow(n,null)),t.clear()}),e&&this.dispatchRowPinnedEvents()}pinRow(e,t,r){if(e.footer&&e.level>-1)return;if(e.footer&&e.level===-1){this._grandTotalPinned=t,dO(this.beans);return}const n=e.rowPinned??e.pinnedSibling?.rowPinned;if(n!=null&&t!=null&&t!=n){const o=e.rowPinned?e:e.pinnedSibling,a=e.rowPinned?e.pinnedSibling:e;this.pinRow(o,null,r),this.pinRow(a,t,r);return}const s=r&&uO(this.beans,e,r);if(s){s.forEach(o=>this.pinRow(o,t));return}if(t==null){const o=e.rowPinned?e:e.pinnedSibling,a=this.findPinnedRowNode(o);if(!a)return;a.delete(o);const l=o.pinnedSibling;ab(o),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(l)}else{const o=C4(this.beans,e,t),a=this.getContainer(t);a.add(o),ob(this.beans,e)&&a.hide(l=>ob(this.beans,l.pinnedSibling)),this.refreshRowPositions(t),this.dispatchRowPinnedEvents(e)}}isManual(){return!0}isEmpty(e){return this.getContainer(e).size()===0}isRowsToRender(e){return!this.isEmpty(e)}ensureRowHeightsValid(){let e=!1,t=0;const r=n=>{if(n.rowHeightEstimated){const i=al(this.beans,n);n.setRowTop(t),n.setRowHeight(i.height),t+=i.height,e=!0}};return this.bottom.forEach(r),t=0,this.top.forEach(r),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}getPinnedTopTotalHeight(){return x4(this.top)}getPinnedBottomTotalHeight(){return x4(this.bottom)}getPinnedTopRowCount(){return this.top.size()}getPinnedBottomRowCount(){return this.bottom.size()}getPinnedTopRow(e){return this.top.getByIndex(e)}getPinnedBottomRow(e){return this.bottom.getByIndex(e)}getPinnedRowById(e,t){return this.getContainer(t).getById(e)}forEachPinnedRow(e,t){this.getContainer(e).forEach(t)}getPinnedState(){const e=t=>{const r=[];return this.forEachPinnedRow(t,n=>r.push(n.pinnedSibling.id)),r};return{top:e("top"),bottom:e("bottom")}}setPinnedState(e){this.forContainers((t,r)=>{for(const n of e[r]){const i=this.beans.rowModel.getRowNode(n);i?this.pinRow(i,r):t.queue(n)}})}getGrandTotalPinned(){return this._grandTotalPinned}setGrandTotalPinned(e){this._grandTotalPinned=e}tryToEmptyQueues(){this.forContainers((e,t)=>{const r=new Set;e.forEachQueued(n=>{const i=this.beans.rowModel.getRowNode(n);i&&r.add(i)});for(const n of r)e.unqueue(n.id),this.pinRow(n,t)})}pinGrandTotalRow(){const{gos:e,beans:t,_grandTotalPinned:r}=this,n=t.rowModel;if(!rn(e))return;const i=n.rootNode?.sibling;if(!i)return;const s=i.pinnedSibling,o=s&&this.findPinnedRowNode(s);if(r){if(o&&o.floating!==r&&(o.delete(s),ab(s)),!o||o.floating!==r){const a=C4(t,i,r);this.getContainer(r).add(a)}}else{if(!o)return;o.delete(s),ab(s)}}onGridStylesChanges(e){e.rowHeightChanged&&this.forContainers(t=>t.forEach(r=>r.setRowHeight(r.rowHeight,!0)))}getContainer(e){return e==="top"?this.top:this.bottom}findPinnedRowNode(e){if(this.top.has(e))return this.top;if(this.bottom.has(e))return this.bottom}refreshRowPositions(e){const t=n=>lO(this.beans,n);if(e)return t(this.getContainer(e));let r=!1;return this.forContainers(n=>{const i=t(n);r||(r=i)}),r}forContainers(e){e(this.top,"top"),e(this.bottom,"bottom")}dispatchRowPinnedEvents(e){this.eventSvc.dispatchEvent({type:"pinnedRowsChanged"}),e?.dispatchRowEvent("rowPinned")}};function lO(e,t){let r=0,n=!1;return t.forEach((i,s)=>{if(n||(n=i.rowTop!==r),i.setRowTop(r),i.rowHeightEstimated||i.rowHeight==null){const o=al(e,i).height;n||(n=i.rowHeight!==o),i.setRowHeight(o)}i.setRowIndex(s),r+=i.rowHeight}),n}function C4(e,t,r){if(t.pinnedSibling)return t.pinnedSibling;const n=F9(t,e);n.setRowTop(null),n.setRowIndex(null),n.rowPinned=r;const i=r==="top"?Ty:ky;return n.id=`${i}${r}-${t.id}`,n.pinnedSibling=t,t.pinnedSibling=n,n}function ab(e){if(!e.pinnedSibling)return;e.rowPinned=null,e._destroy(!1);const t=e.pinnedSibling;e.pinnedSibling=void 0,t&&(t.pinnedSibling=void 0,t.rowPinned=null)}function cO(e){const t=new Set;e.forEach(r=>{r.group&&t.add(r)}),t.forEach(r=>e.delete(r))}function uO(e,t,r){const{rowSpanSvc:n}=e,i=(r&&n?.isCellSpanning(r,t))??!1;if(r&&i)return n?.getCellSpan(r,t)?.spannedNodes}function x4(e){const t=e.size();if(t===0)return 0;const r=e.getByIndex(t-1);return r===void 0?0:r.rowTop+r.rowHeight}function dO({gos:e,rowModel:t}){rn(e)&&t.refreshModel({step:"map"})}var S4=class extends et{constructor(){super(...arguments),this.nextId=0,this.pinnedTopRows={cache:{},order:[]},this.pinnedBottomRows={cache:{},order:[]}}postConstruct(){const e=this.gos;this.setPinnedRowData(e.get("pinnedTopRowData"),"top"),this.setPinnedRowData(e.get("pinnedBottomRowData"),"bottom"),this.addManagedPropertyListener("pinnedTopRowData",t=>this.setPinnedRowData(t.currentValue,"top")),this.addManagedPropertyListener("pinnedBottomRowData",t=>this.setPinnedRowData(t.currentValue,"bottom")),this.addManagedEventListeners({stylesChanged:this.onGridStylesChanges.bind(this)})}reset(){}isEmpty(e){return this.getCache(e).order.length===0}isRowsToRender(e){return!this.isEmpty(e)}isManual(){return!1}pinRow(e,t){}onGridStylesChanges(e){if(e.rowHeightChanged){const t=r=>{r.setRowHeight(r.rowHeight,!0)};Ch(this.pinnedBottomRows,t),Ch(this.pinnedTopRows,t)}}ensureRowHeightsValid(){let e=!1,t=0;const r=n=>{if(n.rowHeightEstimated){const i=al(this.beans,n);n.setRowTop(t),n.setRowHeight(i.height),t+=i.height,e=!0}};return Ch(this.pinnedBottomRows,r),t=0,Ch(this.pinnedTopRows,r),this.eventSvc.dispatchEvent({type:"pinnedHeightChanged"}),e}setPinnedRowData(e,t){this.updateNodesFromRowData(e,t),this.eventSvc.dispatchEvent({type:"pinnedRowDataChanged"})}updateNodesFromRowData(e,t){const r=this.getCache(t);if(e===void 0){r.order.length=0,r.cache={};return}const n=ld(this.gos),i=t==="top"?Ty:ky,s=new Set(r.order),o=[],a=new Set;let l=0,c=-1;for(const u of e){const h=n?.({data:u,level:0,rowPinned:t})??i+this.nextId++;if(a.has(h)){at(96,{id:h,data:u});continue}c++,a.add(h),o.push(h);const d=Uh(r,h);if(d!==void 0)d.data!==u&&d.updateData(u),l+=this.setRowTopAndRowIndex(d,l,c),s.delete(h);else{const f=new ul(this.beans);f.id=h,f.data=u,f.rowPinned=t,l+=this.setRowTopAndRowIndex(f,l,c),r.cache[h]=f,r.order.push(h)}}for(const u of s)Uh(r,u)?.clearRowTopAndRowIndex(),delete r.cache[u];r.order=o}setRowTopAndRowIndex(e,t,r){return e.setRowTop(t),e.setRowHeight(al(this.beans,e).height),e.setRowIndex(r),e.rowHeight}getPinnedTopTotalHeight(){return _4(this.pinnedTopRows)}getPinnedBottomTotalHeight(){return _4(this.pinnedBottomRows)}getPinnedTopRowCount(){return vw(this.pinnedTopRows)}getPinnedBottomRowCount(){return vw(this.pinnedBottomRows)}getPinnedTopRow(e){return mw(this.pinnedTopRows,e)}getPinnedBottomRow(e){return mw(this.pinnedBottomRows,e)}getPinnedRowById(e,t){return Uh(this.getCache(t),e)}forEachPinnedRow(e,t){return Ch(this.getCache(e),t)}getCache(e){return e==="top"?this.pinnedTopRows:this.pinnedBottomRows}getPinnedState(){return{top:[],bottom:[]}}setPinnedState(){}getGrandTotalPinned(){}setGrandTotalPinned(){}};function _4(e){const t=vw(e);if(t===0)return 0;const r=mw(e,t-1);return r===void 0?0:r.rowTop+r.rowHeight}function Uh(e,t){return e.cache[t]}function mw(e,t){return Uh(e,e.order[t])}function Ch(e,t){e.order.forEach((r,n)=>{const i=Uh(e,r);i&&t(i,n)})}function vw(e){return e.order.length}var hO=class extends et{constructor(){super(...arguments),this.beanName="pinnedRowModel"}postConstruct(){const{gos:e}=this,t=()=>{const r=e.get("enableRowPinning"),n=YT(e),s=!!r||(n==="pinnedBottom"||n==="pinnedTop"),o=s?this.inner instanceof S4:this.inner instanceof y4;this.inner&&o&&this.destroyBean(this.inner),(o||!this.inner)&&(this.inner=this.createManagedBean(s?new y4:new S4))};this.addManagedPropertyListeners(["enableRowPinning","grandTotalRow"],t),t()}reset(){return this.inner.reset()}isEmpty(e){return this.inner.isEmpty(e)}isManual(){return this.inner.isManual()}isRowsToRender(e){return this.inner.isRowsToRender(e)}pinRow(e,t,r){return this.inner.pinRow(e,t,r)}ensureRowHeightsValid(){return this.inner.ensureRowHeightsValid()}getPinnedRowById(e,t){return this.inner.getPinnedRowById(e,t)}getPinnedTopTotalHeight(){return this.inner.getPinnedTopTotalHeight()}getPinnedBottomTotalHeight(){return this.inner.getPinnedBottomTotalHeight()}getPinnedTopRowCount(){return this.inner.getPinnedTopRowCount()}getPinnedBottomRowCount(){return this.inner.getPinnedBottomRowCount()}getPinnedTopRow(e){return this.inner.getPinnedTopRow(e)}getPinnedBottomRow(e){return this.inner.getPinnedBottomRow(e)}forEachPinnedRow(e,t){return this.inner.forEachPinnedRow(e,t)}getPinnedState(){return this.inner.getPinnedState()}setPinnedState(e){return this.inner.setPinnedState(e)}setGrandTotalPinned(e){return this.inner.setGrandTotalPinned(e)}getGrandTotalPinned(){return this.inner.getGrandTotalPinned()}},R0=e=>{let t=e.childrenAfterGroup;for(;t?.length;){const r=t[0];if(r.sourceRowIndex>=0)return r;t=r.childrenAfterGroup}},fO=(e,t,r,n)=>{if(!t.size||!e)return!1;let i=!1;const s=e.length??0;let o=-1;r&&(o=r.sourceRowIndex,r=o<0?R0(r):null,r&&(o=r.sourceRowIndex)),o<0||o>=s?o=s:n||++o;let a=o,l=Math.min(o,s-1);for(const h of t){const d=h.sourceRowIndex;d<a&&(a=d),d>l&&(l=d)}let c=a;for(let h=a;h<o;++h){const d=e[h];t.has(d)||(d.sourceRowIndex!==c&&(d.sourceRowIndex=c,e[c]=d,i=!0),++c)}let u=l;for(let h=l;h>=o;--h){const d=e[h];t.has(d)||(d.sourceRowIndex!==u&&(d.sourceRowIndex=u,e[u]=d,i=!0),--u)}for(const h of t)h.sourceRowIndex!==c&&(h.sourceRowIndex=c,e[c]=h,i=!0),++c;return i},n0=class{constructor(){this.reordered=!1,this.removals=[],this.updates=new Set,this.adds=new Set}};function $f(e){return!!(e.rowPinned&&e.pinnedSibling)}function ws(e,t,r,n){const i=t==="top";if(!r)return ws(e,t,i?e.getPinnedTopRow(0):e.getPinnedBottomRow(0),n);if(!n){const l=i?e.getPinnedTopRowCount():e.getPinnedBottomRowCount();return ws(e,t,r,i?e.getPinnedTopRow(l-1):e.getPinnedBottomRow(l-1))}let s=!1,o=!1;const a=[];return e.forEachPinnedRow(t,l=>{if(l===r&&!s){s=!0,a.push(l);return}if(s&&l===n){o=!0,a.push(l);return}s&&!o&&a.push(l)}),a}var pO={tag:"div",cls:"ag-selection-checkbox",role:"presentation",children:[{tag:"ag-checkbox",ref:"eCheckbox",role:"presentation"}]},gO=class extends pn{constructor(){super(pO,[Cy]),this.eCheckbox=xt}postConstruct(){this.eCheckbox.setPassive(!0)}onDataChanged(){this.onSelectionChanged()}onSelectableChanged(){this.showOrHideSelect()}onSelectionChanged(){const e=this.getLocaleTextFunc(),{rowNode:t,eCheckbox:r}=this,n=t.isSelected(),i=tm(e,n),[s,o]=t.selectable?["ariaRowToggleSelection","Press Space to toggle row selection"]:["ariaRowSelectionDisabled","Row Selection is disabled for this row"],a=e(s,o);r.setValue(n,!0),r.setInputAriaLabel(`${a} (${i})`)}init(e){if(this.rowNode=e.rowNode,this.column=e.column,this.overrides=e.overrides,this.onSelectionChanged(),this.addManagedListeners(this.eCheckbox.getWrapperElement(),{dblclick:wc,click:n=>{wc(n),!this.eCheckbox.isDisabled()&&this.beans.selectionSvc?.handleSelectionEvent(n,this.rowNode,"checkboxSelected")}}),this.addManagedListeners(this.rowNode,{rowSelected:this.onSelectionChanged.bind(this),dataChanged:this.onDataChanged.bind(this),selectableChanged:this.onSelectableChanged.bind(this)}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:i})=>{const s=typeof n=="object"?V1(n):void 0,o=typeof i=="object"?V1(i):void 0;s!==o&&this.onSelectableChanged()}),nw(this.gos)||typeof this.getIsVisible()=="function"){const n=this.showOrHideSelect.bind(this);this.addManagedEventListeners({displayedColumnsChanged:n}),this.addManagedListeners(this.rowNode,{dataChanged:n,cellChanged:n}),this.showOrHideSelect()}this.eCheckbox.getInputElement().setAttribute("tabindex","-1")}showOrHideSelect(){const{column:e,rowNode:t,overrides:r,gos:n}=this,i=t.selectable,s=this.getIsVisible();let o;if(typeof s=="function"){const h=r?.callbackParams;if(!e)o=s({...h,node:t,data:t.data});else{const d=e.createColumnFunctionCallbackParams(t);o=s({...h,...d})}}else o=s??!1;const a=i&&!o||!i&&o,l=i||o,c=n.get("rowSelection"),u=c&&typeof c!="string"?!V1(c):!!e?.getColDef().showDisabledCheckboxes;this.setVisible(l&&(a?u:!0)),this.setDisplayed(l&&(a?u:!0)),l&&this.eCheckbox.setDisabled(a),r?.removeHidden&&this.setDisplayed(l)}getIsVisible(){const e=this.overrides;if(e)return e.isVisible;const t=this.gos.get("rowSelection");return t&&typeof t!="string"?Wu(t):this.column?.getColDef()?.checkboxSelection}},mO=class{constructor(e,t){this.rowModel=e,this.pinnedRowModel=t,this.selectAll=!1,this.rootId=null,this.endId=null,this.cachedRange=[]}reset(){this.rootId=null,this.endId=null,this.cachedRange.length=0}setRoot(e){this.rootId=e.id,this.endId=null,this.cachedRange.length=0}setEndRange(e){this.endId=e.id,this.cachedRange.length=0}getRange(){if(this.cachedRange.length===0){const e=this.getRoot(),t=this.getEnd();if(e==null||t==null)return this.cachedRange;this.cachedRange=this.getNodesInRange(e,t)??[]}return this.cachedRange}isInRange(e){return this.rootId===null?!1:this.getRange().some(t=>t.id===e.id)}getRoot(e){if(this.rootId)return this.getRowNode(this.rootId);if(e)return this.setRoot(e),e}getEnd(){if(this.endId)return this.getRowNode(this.endId)}getRowNode(e){let t;const{rowModel:r,pinnedRowModel:n}=this;return t??(t=r.getRowNode(e)),n?.isManual()&&(t??(t=n.getPinnedRowById(e,"top")),t??(t=n.getPinnedRowById(e,"bottom"))),t}truncate(e){const t=this.getRange();if(t.length===0)return{keep:[],discard:[]};const r=t[0].id===this.rootId,n=t.findIndex(i=>i.id===e.id);if(n>-1){const i=t.slice(0,n),s=t.slice(n+1);return this.setEndRange(e),r?{keep:i,discard:s}:{keep:s,discard:i}}else return{keep:t,discard:[]}}extend(e,t=!1){const r=this.getRoot();if(r==null){const i=this.getRange().slice();return t&&e.depthFirstSearch(s=>!s.group&&i.push(s)),i.push(e),this.setRoot(e),{keep:i,discard:[]}}const n=this.getNodesInRange(r,e);if(!n)return this.setRoot(e),{keep:[e],discard:[]};if(n.find(i=>i.id===this.endId))return this.setEndRange(e),{keep:this.getRange(),discard:[]};{const i=this.getRange().slice();return this.setEndRange(e),{keep:this.getRange(),discard:i}}}getNodesInRange(e,t){const{pinnedRowModel:r,rowModel:n}=this;if(!r?.isManual())return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&!t.rowPinned)return ws(r,"top",e,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),t)??[]);if(e.rowPinned==="bottom"&&!t.rowPinned){const i=ws(r,"bottom",void 0,e),s=n.getRowCount(),o=n.getRow(s-1);return(n.getNodesInRangeForSelection(t,o)??[]).concat(i)}if(!e.rowPinned&&!t.rowPinned)return n.getNodesInRangeForSelection(e,t);if(e.rowPinned==="top"&&t.rowPinned==="top")return ws(r,"top",e,t);if(e.rowPinned==="bottom"&&t.rowPinned==="top"){const i=ws(r,"top",t,void 0),s=ws(r,"bottom",void 0,e),o=n.getRow(0),a=n.getRow(n.getRowCount()-1);return i.concat(n.getNodesInRangeForSelection(o,a)??[]).concat(s)}if(!e.rowPinned&&t.rowPinned==="top")return ws(r,"top",t,void 0).concat(n.getNodesInRangeForSelection(n.getRow(0),e)??[]);if(e.rowPinned==="top"&&t.rowPinned==="bottom"){const i=ws(r,"top",e,void 0),s=ws(r,"bottom",void 0,t),o=n.getRow(0),a=n.getRow(n.getRowCount()-1);return i.concat(n.getNodesInRangeForSelection(o,a)??[]).concat(s)}if(e.rowPinned==="bottom"&&t.rowPinned==="bottom")return ws(r,"bottom",e,t);if(!e.rowPinned&&t.rowPinned==="bottom"){const i=ws(r,"bottom",void 0,t),s=n.getRow(n.getRowCount());return(n.getNodesInRangeForSelection(e,s)??[]).concat(i)}return null}},vO=class extends et{constructor(e){super(),this.column=e,this.cbSelectAllVisible=!1,this.processingEventFromCheckbox=!1}onSpaceKeyDown(e){const t=this.cbSelectAll;t.isDisplayed()&&!t.getGui().contains(tn(this.beans))&&(e.preventDefault(),t.setValue(!t.getValue()))}getCheckboxGui(){return this.cbSelectAll.getGui()}setComp(e){this.headerCellCtrl=e;const t=this.createManagedBean(new yy);this.cbSelectAll=t,t.addCss("ag-header-select-all"),gc(t.getGui(),"presentation"),this.showOrHideSelectAll();const r=this.updateStateOfCheckbox.bind(this);this.addManagedEventListeners({newColumnsLoaded:()=>this.showOrHideSelectAll(),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),selectionChanged:r,paginationChanged:r,modelUpdated:r}),this.addManagedPropertyListener("rowSelection",({currentValue:n,previousValue:i})=>{const s=o=>typeof o=="string"||!o||o.mode==="singleRow"?void 0:o.selectAll;s(n)!==s(i)&&this.showOrHideSelectAll(),this.updateStateOfCheckbox()}),this.addManagedListeners(t,{fieldValueChanged:this.onCbSelectAll.bind(this)}),t.getInputElement().setAttribute("tabindex","-1"),this.refreshSelectAllLabel()}onDisplayedColumnsChanged(e){this.isAlive()&&this.showOrHideSelectAll(e.source==="uiColumnMoved")}showOrHideSelectAll(e=!1){const t=this.isCheckboxSelection();this.cbSelectAllVisible=t,this.cbSelectAll.setDisplayed(t),t&&(this.checkRightRowModelType("selectAllCheckbox"),this.checkSelectionType("selectAllCheckbox"),this.updateStateOfCheckbox()),this.refreshSelectAllLabel(e)}updateStateOfCheckbox(){if(!this.cbSelectAllVisible||this.processingEventFromCheckbox)return;this.processingEventFromCheckbox=!0;const e=this.getSelectAllMode(),t=this.beans.selectionSvc,r=this.cbSelectAll,n=t.getSelectAllState(e);r.setValue(n);const i=t.hasNodesToSelect(e);r.setDisabled(!i),this.refreshSelectAllLabel(),this.processingEventFromCheckbox=!1}refreshSelectAllLabel(e=!1){const t=this.getLocaleTextFunc(),{headerCellCtrl:r,cbSelectAll:n,cbSelectAllVisible:i}=this,s=n.getValue(),o=tm(t,s),a=t("ariaRowSelectAll","Press Space to toggle all rows selection");r.setAriaDescriptionProperty("selectAll",i?`${a} (${o})`:null),n.setInputAriaLabel(t("ariaHeaderSelection","Column with Header Selection")),e||r.announceAriaDescription()}checkSelectionType(e){return v0(this.gos)?!0:(at(128,{feature:e}),!1)}checkRightRowModelType(e){const{gos:t,rowModel:r}=this.beans;return rn(t)||Cd(t)?!0:(at(129,{feature:e,rowModel:r.getType()}),!1)}onCbSelectAll(){if(this.processingEventFromCheckbox||!this.cbSelectAllVisible)return;const e=this.cbSelectAll.getValue(),t=this.getSelectAllMode();let r="uiSelectAll";t==="currentPage"?r="uiSelectAllCurrentPage":t==="filtered"&&(r="uiSelectAllFiltered");const n={source:r,selectAll:t},i=this.beans.selectionSvc;e?i.selectAllRowNodes(n):i.deselectAllRowNodes(n)}isCheckboxSelection(){const{column:e,gos:t,beans:r}=this,s=typeof t.get("rowSelection")=="object"?"headerCheckbox":"headerCheckboxSelection";return cR(r,e)&&this.checkRightRowModelType(s)&&this.checkSelectionType(s)}getSelectAllMode(){const e=ek(this.gos,!1);if(e)return e;const{headerCheckboxSelectionCurrentPageOnly:t,headerCheckboxSelectionFilteredOnly:r}=this.column.getColDef();return t?"currentPage":r?"filtered":"all"}destroy(){super.destroy(),this.cbSelectAll=void 0,this.headerCellCtrl=void 0}};function cR({gos:e,selectionColSvc:t},r){const n=e.get("rowSelection"),i=r.getColDef(),{headerCheckboxSelection:s}=i;let o=!1;if(typeof n=="object"){const l=vl(r),c=my(r);(g0(n)==="autoGroupColumn"&&c||l&&t?.isSelectionColumnEnabled())&&(o=Xg(n))}else typeof s=="function"?o=s(Dt(e,{column:r,colDef:i})):o=!!s;return o}var bO=class extends et{postConstruct(){const{gos:e,beans:t}=this;this.selectionCtx=new mO(t.rowModel,t.pinnedRowModel),this.addManagedPropertyListeners(["isRowSelectable","rowSelection"],()=>{const r=nw(e);r!==this.isRowSelectable&&(this.isRowSelectable=r,this.updateSelectable())}),this.isRowSelectable=nw(e),this.addManagedEventListeners({cellValueChanged:r=>this.updateRowSelectable(r.node),rowNodeDataChanged:r=>this.updateRowSelectable(r.node)})}destroy(){super.destroy(),this.selectionCtx.reset()}createCheckboxSelectionComponent(){return new gO}createSelectAllFeature(e){if(cR(this.beans,e))return new vO(e)}isMultiSelect(){return v0(this.gos)}onRowCtrlSelected(e,t,r){const n=!!e.rowNode.isSelected();e.forEachGui(r,i=>{i.rowComp.toggleCss("ag-row-selected",n);const s=i.element;ET(s,n),s.contains(tn(this.beans))&&t(i)})}announceAriaRowSelection(e){if(this.isRowSelectionBlocked(e))return;const t=e.isSelected(),r=this.beans.editSvc?.isEditing({rowNode:e});if(!e.selectable||r)return;const i=this.getLocaleTextFunc()(t?"ariaRowDeselect":"ariaRowSelect",`Press SPACE to ${t?"deselect":"select"} this row`);this.beans.ariaAnnounce?.announceValue(i,"rowSelection")}isRowSelectionBlocked(e){return!e.selectable||e.rowPinned&&!$f(e)||!sc(this.gos)}updateRowSelectable(e,t){const r=e.rowPinned&&e.pinnedSibling?e.pinnedSibling.selectable:this.isRowSelectable?.(e)??!0;return this.setRowSelectable(e,r,t),r}setRowSelectable(e,t,r){if(e.selectable!==t){if(e.selectable=t,e.dispatchRowEvent("selectableChanged"),r)return;if(hf(this.gos)){const i=this.calculateSelectedFromChildren(e);this.setNodesSelected({nodes:[e],newValue:i??!1,source:"selectableChanged"});return}e.isSelected()&&!e.selectable&&this.setNodesSelected({nodes:[e],newValue:!1,source:"selectableChanged"})}}calculateSelectedFromChildren(e){let t=!1,r=!1;if(!e.childrenAfterGroup?.length)return e.selectable?e.__selected:null;for(let n=0;n<e.childrenAfterGroup.length;n++){const i=e.childrenAfterGroup[n];let s=i.isSelected();if(!i.selectable){const o=this.calculateSelectedFromChildren(i);if(o===null)continue;s=o}switch(s){case!0:t=!0;break;case!1:r=!0;break;default:return}}if(!(t&&r))return t?!0:r?!1:e.selectable?e.__selected:null}selectRowNode(e,t,r,n="api"){if(t&&e.destroyed)return!1;const i=!e.selectable&&t,s=e.__selected===t;if(i||s)return!1;e.__selected=t,e.dispatchRowEvent("rowSelected");const o=e.sibling;o&&o.footer&&o.__localEventService&&o.dispatchRowEvent("rowSelected");const a=e.pinnedSibling;return a?.rowPinned&&a.__localEventService&&a.dispatchRowEvent("rowSelected"),this.eventSvc.dispatchEvent({...R9(e,this.gos,"rowSelected"),event:r||null,source:n}),!0}isCellCheckboxSelection(e,t){const r=this.gos.get("rowSelection");if(r&&typeof r!="string"){const n=vl(e)&&Wu(r);return e.isColumnFunc(t,n)}else return e.isColumnFunc(t,e.colDef.checkboxSelection)}inferNodeSelections(e,t,r,n){const{gos:i,selectionCtx:s}=this,o=e.isSelected(),a=hf(i),l=LD(i),c=BD(i),u=this.isMultiSelect(),h=n==="rowClicked";if(h&&!(l||c))return null;if(t&&r&&u){const d=s.getRoot();if(d)if(d.isSelected()){const f=s.isInRange(e)?s.truncate(e):s.extend(e,a);return{deselect:f.discard,select:f.keep,reset:!1}}else{const f=s.extend(e,a);return{select:[],deselect:f.keep,reset:!1}}else return null}else if(t&&u){const d=s.selectAll?this.beans.rowModel.getRow(0):void 0,f=s.getRoot(d),m=s.isInRange(e)?s.truncate(e):s.extend(e,a);return{select:m.keep,deselect:m.discard,reset:s.selectAll||!!(f&&!f.isSelected())}}else if(r){if(h){const d=!o;return d&&!l||!d&&!c?null:(s.setRoot(e),{node:e,newValue:d,clearSelection:!1})}return s.setRoot(e),{node:e,newValue:!o,clearSelection:!u}}else{s.setRoot(e);const d=HD(i),f=b0(i)==="filteredDescendants",m=h&&(!d||!l);if(f&&o===void 0&&rn(i))return{node:e,newValue:!1,checkFilteredNodes:!0,clearSelection:!u||m};if(h){const v=o?!d:l;return v===o&&!m||v&&!l||!v&&!c?null:{node:e,newValue:v,clearSelection:!u||m,keepDescendants:e.group&&a}}return{node:e,newValue:!o,clearSelection:!u||m}}}},wO=class extends E9{initialiseTabGuard(t){super.initialiseTabGuard(t,Ay)}},yO=class extends Tk{constructor(e){super(e,Ay)}},CO=500,xO=550,Cg,SO=e=>{if(!Cg)Cg=new WeakSet;else if(Cg.has(e))return!1;return Cg.add(e),!0},$l=class{constructor(e,t=!1){this.eElement=e,this.preventClick=t,this.startListener=null,this.handlers=[],this.eventSvc=void 0,this.touchStart=null,this.lastTapTime=null,this.longPressTimer=0,this.moved=!1}addEventListener(e,t){let r=this.eventSvc;if(!r){if(r===null)return;this.eventSvc=r=new pc;const n=this.onTouchStart.bind(this);this.startListener=n,this.eElement.addEventListener("touchstart",n,{passive:!0})}r.addEventListener(e,t)}removeEventListener(e,t){this.eventSvc?.removeEventListener(e,t)}onTouchStart(e){if(this.touchStart||!SO(e))return;const t=e.touches[0];this.touchStart=t;const r=this.handlers;if(!r.length){const n=this.eElement,i=n.ownerDocument,s=this.onTouchMove.bind(this),o=this.onTouchEnd.bind(this),a=this.onTouchCancel.bind(this),l={passive:!0},c={passive:!1};$g(r,[n,"touchmove",s,l],[i,"touchcancel",a,l],[i,"touchend",o,c],[i,"contextmenu",Pu,c])}this.clearLongPress(),this.longPressTimer=window.setTimeout(()=>{this.longPressTimer=0,this.touchStart===t&&!this.moved&&(this.moved=!0,this.eventSvc?.dispatchEvent({type:"longTap",touchStart:t,touchEvent:e}))},xO)}onTouchMove(e){const{moved:t,touchStart:r}=this;if(!t&&r){const n=Vu(r,e.touches);n&&!DT(n,r,4)&&(this.clearLongPress(),this.moved=!0)}}onTouchEnd(e){const t=this.touchStart;!t||!Vu(t,e.changedTouches)||(this.moved||(this.eventSvc?.dispatchEvent({type:"tap",touchStart:t}),this.checkDoubleTap(t)),this.preventClick&&Pu(e),this.cancel())}onTouchCancel(e){const t=this.touchStart;!t||!Vu(t,e.changedTouches)||(this.lastTapTime=null,this.cancel())}checkDoubleTap(e){let t=Date.now();const r=this.lastTapTime;r&&t-r>CO&&(this.eventSvc?.dispatchEvent({type:"doubleTap",touchStart:e}),t=null),this.lastTapTime=t}cancel(){this.clearLongPress(),uy(this.handlers),this.touchStart=null}clearLongPress(){window.clearTimeout(this.longPressTimer),this.longPressTimer=0,this.moved=!1}destroy(){const e=this.startListener;e&&(this.startListener=null,this.eElement.removeEventListener("touchstart",e)),this.cancel(),this.eElement=null,this.eventSvc=null}},uR=class{constructor(e="javascript"){this.frameworkName=e,this.renderingEngine="vanilla",this.batchFrameworkComps=!1,this.wrapIncoming=t=>t(),this.wrapOutgoing=t=>t(),this.baseDocLink=`${LT}/${this.frameworkName}-data-grid`,ED(this.baseDocLink)}frameworkComponent(e){return null}isFrameworkComponent(e){return!1}getDocLink(e){return this.baseDocLink+(e?"/"+e:"")}};function _O(e){return{beanName:"gridApi",bean:e.getBean("apiFunctionSvc").api}}var EO=["licenseManager","environment","eventSvc","gos","paginationAutoPageSizeSvc","apiFunctionSvc","gridApi","registry","agCompUtils","userCompFactory","rowContainerHeight","horizontalResizeSvc","localeSvc","pinnedRowModel","dragSvc","colGroupSvc","visibleCols","popupSvc","selectionSvc","colFilter","quickFilter","filterManager","colModel","headerNavigation","pageBounds","pagination","pageBoundsListener","rowSpanSvc","stickyRowSvc","rowRenderer","expressionSvc","alignedGridsSvc","navigation","valueCache","valueSvc","autoWidthCalc","filterMenuFactory","dragAndDrop","focusSvc","cellNavigation","cellStyles","scrollVisibleSvc","sortSvc","colHover","colAnimation","autoColSvc","selectionColSvc","changeDetectionSvc","animationFrameSvc","undoRedo","colDefFactory","rowStyleSvc","rowNodeBlockLoader","rowNodeSorter","ctrlsSvc","pinnedCols","dataTypeSvc","syncSvc","overlays","stateSvc","expansionSvc","apiEventSvc","ariaAnnounce","menuSvc","colMoves","colAutosize","colFlex","colResize","pivotColsSvc","valueColsSvc","rowGroupColsSvc","colNames","colViewport","pivotResultCols","showRowGroupCols","validation"],E4=Object.fromEntries(EO.map((e,t)=>[e,t]));function TO(e,t){const r=(e.beanName?E4[e.beanName]:void 0)??Number.MAX_SAFE_INTEGER,n=(t.beanName?E4[t.beanName]:void 0)??Number.MAX_SAFE_INTEGER;return r-n}function kO(e,t){return e?.beanName==="gridDestroySvc"?-1:t?.beanName==="gridDestroySvc"?1:0}var RO=class extends et{constructor(){super(...arguments),this.additionalFocusableContainers=new Set}setComp(e,t,r){this.view=e,this.eGridHostDiv=t,this.eGui=r,this.eGui.setAttribute("grid-id",this.beans.context.getId());const{dragAndDrop:n,ctrlsSvc:i}=this.beans;n?.registerGridDropTarget(()=>this.eGui,this),this.createManagedBean(new Fy(this.view)),this.view.setRtlClass(this.gos.get("enableRtl")?"ag-rtl":"ag-ltr");const s=ha(this.beans,this.eGridHostDiv,this.onGridSizeChanged.bind(this));this.addDestroyFunc(()=>s()),i.register("gridCtrl",this)}isDetailGrid(){return _k(this.getGui())?.getAttribute("row-id")?.startsWith("detail")||!1}getOptionalSelectors(){const e=this.beans;return{paginationSelector:e.pagination?.getPaginationSelector(),gridHeaderDropZonesSelector:e.registry?.getSelector("AG-GRID-HEADER-DROP-ZONES"),sideBarSelector:e.sideBar?.getSelector(),statusBarSelector:e.registry?.getSelector("AG-STATUS-BAR"),watermarkSelector:e.licenseManager?.getWatermarkSelector()}}onGridSizeChanged(){this.eventSvc.dispatchEvent({type:"gridSizeChanged",clientWidth:this.eGridHostDiv.clientWidth,clientHeight:this.eGridHostDiv.clientHeight})}destroyGridUi(){this.view.destroyGridUi()}getGui(){return this.eGui}setResizeCursor(e){const{view:t}=this;if(e===!1)t.setCursor(null);else{const r=e===1?"ew-resize":"ns-resize";t.setCursor(r)}}disableUserSelect(e){this.view.setUserSelect(e?"none":null)}focusNextInnerContainer(e){const t=this.getFocusableContainers(),{indexWithFocus:r,nextIndex:n}=this.getNextFocusableIndex(t,e);if(n<0||n>=t.length)return!1;if(n===0){if(r>0){const{visibleCols:i,focusSvc:s}=this.beans,o=i.allCols,a=zr(o);if(s.focusGridView({column:a,backwards:!0}))return!0}return!1}return this.focusContainer(t[n],e)}focusInnerElement(e){if(this.gos.getCallback("focusGridInnerElement")?.({fromBottom:!!e}))return!0;const r=this.getFocusableContainers(),{focusSvc:n,visibleCols:i}=this.beans,s=i.allCols;if(e){if(r.length>1)return this.focusContainer(zr(r),e);const o=zr(s);if(n.focusGridView({column:o,backwards:e}))return!0}if(this.gos.get("headerHeight")===0||lc(this.beans)){if(n.focusGridView({column:s[0],backwards:e}))return!0;for(let o=1;o<r.length;o++)if(bc(r[o].getGui(),e))return!0;return!1}return n.focusFirstHeader()}forceFocusOutOfContainer(e=!1){this.view.forceFocusOutOfContainer(e)}addFocusableContainer(e){this.additionalFocusableContainers.add(e)}removeFocusableContainer(e){this.additionalFocusableContainers.delete(e)}allowFocusForNextCoreContainer(e){const t=this.view.getFocusableContainers(),{nextIndex:r}=this.getNextFocusableIndex(t,e),n=t[r];n?this.focusContainer(n):this.forceFocusOutOfContainer(e)}isFocusable(){const e=this.beans;return!lm(e)||!lc(e)||!!e.sideBar?.comp?.isDisplayed()}getNextFocusableIndex(e,t){const r=tn(this.beans),n=e.findIndex(s=>s.getGui().contains(r)),i=n+(t?-1:1);return{indexWithFocus:n,nextIndex:i}}focusContainer(e,t){e.setAllowFocus?.(!0);const r=bc(e.getGui(),t,!1,!0);return e.setAllowFocus?.(!1),r}getFocusableContainers(){return[...this.view.getFocusableContainers(),...this.additionalFocusableContainers]}destroy(){this.additionalFocusableContainers.clear(),super.destroy()}},jt=(e,t)=>{for(const r of Object.keys(t))t[r]=e;return t},T4={dispatchEvent:"CommunityCore",...jt("CommunityCore",{destroy:0,getGridId:0,getGridOption:0,isDestroyed:0,setGridOption:0,updateGridOptions:0,isModuleRegistered:0}),...jt("GridState",{getState:0,setState:0}),...jt("SharedRowSelection",{setNodesSelected:0,selectAll:0,deselectAll:0,selectAllFiltered:0,deselectAllFiltered:0,selectAllOnCurrentPage:0,deselectAllOnCurrentPage:0,getSelectedNodes:0,getSelectedRows:0}),...jt("RowApi",{redrawRows:0,setRowNodeExpanded:0,getRowNode:0,addRenderedRowListener:0,getRenderedNodes:0,forEachNode:0,getFirstDisplayedRowIndex:0,getLastDisplayedRowIndex:0,getDisplayedRowAtIndex:0,getDisplayedRowCount:0}),...jt("ScrollApi",{getVerticalPixelRange:0,getHorizontalPixelRange:0,ensureColumnVisible:0,ensureIndexVisible:0,ensureNodeVisible:0}),...jt("KeyboardNavigation",{getFocusedCell:0,clearFocusedCell:0,setFocusedCell:0,tabToNextCell:0,tabToPreviousCell:0,setFocusedHeader:0}),...jt("EventApi",{addEventListener:0,addGlobalListener:0,removeEventListener:0,removeGlobalListener:0}),...jt("ValueCache",{expireValueCache:0}),...jt("CellApi",{getCellValue:0}),...jt("SharedMenu",{showColumnMenu:0,hidePopupMenu:0}),...jt("Sort",{onSortChanged:0}),...jt("PinnedRow",{getPinnedTopRowCount:0,getPinnedBottomRowCount:0,getPinnedTopRow:0,getPinnedBottomRow:0,forEachPinnedRow:0}),...jt("Overlay",{showLoadingOverlay:0,showNoRowsOverlay:0,hideOverlay:0}),...jt("RenderApi",{setGridAriaProperty:0,refreshCells:0,refreshHeader:0,isAnimationFrameQueueEmpty:0,flushAllAnimationFrames:0,getSizesForCurrentTheme:0,getCellRendererInstances:0}),...jt("HighlightChanges",{flashCells:0}),...jt("RowDrag",{addRowDropZone:0,removeRowDropZone:0,getRowDropZoneParams:0,getRowDropPositionIndicator:0,setRowDropPositionIndicator:0}),...jt("ColumnApi",{getColumnDefs:0,getColumnDef:0,getDisplayNameForColumn:0,getColumn:0,getColumns:0,applyColumnState:0,getColumnState:0,resetColumnState:0,isPinning:0,isPinningLeft:0,isPinningRight:0,getDisplayedColAfter:0,getDisplayedColBefore:0,setColumnsVisible:0,setColumnsPinned:0,getAllGridColumns:0,getDisplayedLeftColumns:0,getDisplayedCenterColumns:0,getDisplayedRightColumns:0,getAllDisplayedColumns:0,getAllDisplayedVirtualColumns:0}),...jt("ColumnAutoSize",{sizeColumnsToFit:0,autoSizeColumns:0,autoSizeAllColumns:0}),...jt("ColumnGroup",{setColumnGroupOpened:0,getColumnGroup:0,getProvidedColumnGroup:0,getDisplayNameForColumnGroup:0,getColumnGroupState:0,setColumnGroupState:0,resetColumnGroupState:0,getLeftDisplayedColumnGroups:0,getCenterDisplayedColumnGroups:0,getRightDisplayedColumnGroups:0,getAllDisplayedColumnGroups:0}),...jt("ColumnMove",{moveColumnByIndex:0,moveColumns:0}),...jt("ColumnResize",{setColumnWidths:0}),...jt("ColumnHover",{isColumnHovered:0}),...jt("EditCore",{getCellEditorInstances:0,getEditingCells:0,getEditRowValues:0,stopEditing:0,startEditingCell:0,isEditing:0,validateEdit:0}),...jt("BatchEdit",{startBatchEdit:0,cancelBatchEdit:0,commitBatchEdit:0,isBatchEditing:0}),...jt("UndoRedoEdit",{undoCellEditing:0,redoCellEditing:0,getCurrentUndoSize:0,getCurrentRedoSize:0}),...jt("FilterCore",{isAnyFilterPresent:0,onFilterChanged:0}),...jt("ColumnFilter",{isColumnFilterPresent:0,getColumnFilterInstance:0,destroyFilter:0,setFilterModel:0,getFilterModel:0,getColumnFilterModel:0,setColumnFilterModel:0,showColumnFilter:0,hideColumnFilter:0,getColumnFilterHandler:0,doFilterAction:0}),...jt("QuickFilter",{isQuickFilterPresent:0,getQuickFilter:0,resetQuickFilter:0}),...jt("Find",{findGetActiveMatch:0,findGetTotalMatches:0,findGoTo:0,findNext:0,findPrevious:0,findGetNumMatches:0,findGetParts:0,findClearActive:0,findRefresh:0}),...jt("Pagination",{paginationIsLastPageFound:0,paginationGetPageSize:0,paginationGetCurrentPage:0,paginationGetTotalPages:0,paginationGetRowCount:0,paginationGoToNextPage:0,paginationGoToPreviousPage:0,paginationGoToFirstPage:0,paginationGoToLastPage:0,paginationGoToPage:0}),...jt("CsrmSsrmSharedApi",{expandAll:0,collapseAll:0}),...jt("SsrmInfiniteSharedApi",{setRowCount:0,getCacheBlockState:0,isLastRowIndexKnown:0}),...jt("ClientSideRowModelApi",{onGroupExpandedOrCollapsed:0,refreshClientSideRowModel:0,isRowDataEmpty:0,forEachLeafNode:0,forEachNodeAfterFilter:0,forEachNodeAfterFilterAndSort:0,applyTransaction:0,applyTransactionAsync:0,flushAsyncTransactions:0,getBestCostNodeSelection:0,onRowHeightChanged:0,resetRowHeights:0}),...jt("CsvExport",{getDataAsCsv:0,exportDataAsCsv:0}),...jt("InfiniteRowModel",{refreshInfiniteCache:0,purgeInfiniteCache:0,getInfiniteRowCount:0}),...jt("AdvancedFilter",{getAdvancedFilterModel:0,setAdvancedFilterModel:0,showAdvancedFilterBuilder:0,hideAdvancedFilterBuilder:0}),...jt("IntegratedCharts",{getChartModels:0,getChartRef:0,getChartImageDataURL:0,downloadChart:0,openChartToolPanel:0,closeChartToolPanel:0,createRangeChart:0,createPivotChart:0,createCrossFilterChart:0,updateChart:0,restoreChart:0}),...jt("Clipboard",{copyToClipboard:0,cutToClipboard:0,copySelectedRowsToClipboard:0,copySelectedRangeToClipboard:0,copySelectedRangeDown:0,pasteFromClipboard:0}),...jt("ExcelExport",{getDataAsExcel:0,exportDataAsExcel:0,getSheetDataForExcel:0,getMultipleSheetsAsExcel:0,exportMultipleSheetsAsExcel:0}),...jt("SharedMasterDetail",{addDetailGridInfo:0,removeDetailGridInfo:0,getDetailGridInfo:0,forEachDetailGridInfo:0}),...jt("ContextMenu",{showContextMenu:0}),...jt("ColumnMenu",{showColumnChooser:0,hideColumnChooser:0}),...jt("CellSelection",{getCellRanges:0,addCellRange:0,clearRangeSelection:0,clearCellSelection:0}),...jt("SharedRowGrouping",{setRowGroupColumns:0,removeRowGroupColumns:0,addRowGroupColumns:0,getRowGroupColumns:0,moveRowGroupColumn:0}),...jt("SharedAggregation",{addAggFuncs:0,clearAggFuncs:0,setColumnAggFunc:0}),...jt("SharedPivot",{isPivotMode:0,getPivotResultColumn:0,setValueColumns:0,getValueColumns:0,removeValueColumns:0,addValueColumns:0,setPivotColumns:0,removePivotColumns:0,addPivotColumns:0,getPivotColumns:0,setPivotResultColumns:0,getPivotResultColumns:0}),...jt("ServerSideRowModelApi",{getServerSideSelectionState:0,setServerSideSelectionState:0,applyServerSideTransaction:0,applyServerSideTransactionAsync:0,applyServerSideRowData:0,retryServerSideLoads:0,flushServerSideAsyncTransactions:0,refreshServerSide:0,getServerSideGroupLevelState:0,onRowHeightChanged:0,resetRowHeights:0}),...jt("SideBar",{isSideBarVisible:0,setSideBarVisible:0,setSideBarPosition:0,openToolPanel:0,closeToolPanel:0,getOpenedToolPanel:0,refreshToolPanel:0,isToolPanelShowing:0,getToolPanelInstance:0,getSideBar:0}),...jt("StatusBar",{getStatusPanel:0}),...jt("AiToolkit",{getStructuredSchema:0})},lb={isDestroyed:()=>!0,destroy(){},preConstruct(){},postConstruct(){},preWireBeans(){},wireBeans(){}},AO=(e,t)=>e.eventSvc.dispatchEvent(t),dR=class{};Reflect.defineProperty(dR,"name",{value:"GridApi"});var FO=class extends et{constructor(){super(),this.beanName="apiFunctionSvc",this.api=new dR,this.fns={...lb,dispatchEvent:AO},this.preDestroyLink="";const{api:e}=this;for(const t of Object.keys(T4))e[t]=this.makeApi(t)[t]}postConstruct(){this.preDestroyLink=this.beans.frameworkOverrides.getDocLink("grid-lifecycle/#grid-pre-destroyed")}addFunction(e,t){const{fns:r,beans:n}=this;r!==lb&&(r[e]=n?.validation?.validateApiFunction(e,t)??t)}makeApi(e){return{[e]:(...t)=>{const{beans:r,fns:{[e]:n}}=this;return n?n(r,...t):this.apiNotFound(e)}}}apiNotFound(e){const{beans:t,gos:r,preDestroyLink:n}=this;if(!t)at(26,{fnName:e,preDestroyLink:n});else{const i=T4[e];r.assertModuleRegistered(i,`api.${e}`)&&at(27,{fnName:e,module:i})}}destroy(){super.destroy(),this.fns=lb,this.beans=null}};function MO(e){return e.context.getId()}function DO(e){e.gridDestroySvc.destroy()}function PO(e){return e.gridDestroySvc.destroyCalled}function IO(e,t){return e.gos.get(t)}function OO(e,t,r){hR(e,{[t]:r})}function hR(e,t){e.gos.updateGridOptions({options:t})}function NO(e,t){const r=t.replace(/Module$/,"");return e.gos.isModuleRegistered(r)}var LO={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{draggable:"true"}},BO=class extends pn{constructor(e,t,r){super(LO),this.rowNode=e,this.column=t,this.eCell=r}postConstruct(){this.getGui().appendChild(Li("rowDrag",this.beans,null)),this.addGuiEventListener("mousedown",t=>{t.stopPropagation()}),this.addDragSource(),this.checkVisibility()}addDragSource(){this.addGuiEventListener("dragstart",this.onDragStart.bind(this))}onDragStart(e){const{rowNode:t,column:r,eCell:n,gos:i}=this,s=r.getColDef().dndSourceOnRowDrag,o=e.dataTransfer;if(o.setDragImage(n,0,0),s){const a=Dt(i,{rowNode:t,dragEvent:e});s(a)}else try{const a=JSON.stringify(t.data);o.setData("application/json",a),o.setData("text/plain",a)}catch{}}checkVisibility(){const e=this.column.isDndSource(this.rowNode);this.setDisplayed(e)}};function HO(e,t){e.rowDragSvc?.rowDragFeature?.addRowDropZone(t)}function jO(e,t){const r=e.dragAndDrop?.findExternalZone(t.getContainer());r&&e.dragAndDrop?.removeDropTarget(r)}function VO(e,t){return e.rowDragSvc?.rowDragFeature?.getRowDropZone(t)}function GO(e){const t=e.rowDropHighlightSvc;return t?{row:t.row,dropIndicatorPosition:t.position}:{row:null,dropIndicatorPosition:"none"}}function zO(e,t){const r=e.rowDropHighlightSvc;if(!r)return;const n=t?.row;let i=t?.dropIndicatorPosition;i!=="above"&&i!=="below"&&i!=="inside"&&(i="none");const s=n?.rowIndex;s==null||i==="none"?r.clear():r.set(n,i)}var UO=class extends x9{shouldPreventMouseEvent(e){return this.gos.get("enableCellTextSelection")&&super.shouldPreventMouseEvent(e)}},WO=class extends et{constructor(){super(...arguments),this.beanName="horizontalResizeSvc"}addResizeBar(e){const t={dragStartPixels:e.dragStartPixels||0,eElement:e.eResizeBar,onDragStart:this.onDragStart.bind(this,e),onDragStop:this.onDragStop.bind(this,e),onDragging:this.onDragging.bind(this,e),onDragCancel:this.onDragStop.bind(this,e),includeTouch:!0,stopPropagationForTouch:!0},{dragSvc:r}=this.beans;return r.addDragSource(t),()=>r.removeDragSource(t)}onDragStart(e,t){this.dragStartX=t.clientX,this.setResizeIcons();const r=t instanceof MouseEvent&&t.shiftKey===!0;e.onResizeStart(r)}setResizeIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(1),e.disableUserSelect(!0)}onDragStop(e){e.onResizeEnd(this.resizeAmount),this.resetIcons()}resetIcons(){const e=this.beans.ctrlsSvc.get("gridCtrl");e.setResizeCursor(!1),e.disableUserSelect(!1)}onDragging(e,t){this.resizeAmount=t.clientX-this.dragStartX,e.onResizing(this.resizeAmount)}},$O={tag:"div",cls:"ag-drag-handle ag-row-drag",attrs:{"aria-hidden":"true"}},xg={skipAriaHidden:!0},qO=class extends pn{constructor(e,t,r,n,i,s=!1){super(),this.cellValueFn=e,this.rowNode=t,this.column=r,this.customGui=n,this.dragStartPixels=i,this.alwaysVisible=s,this.dragSource=null,this.disabled=!1}isCustomGui(){return this.customGui!=null}postConstruct(){const{beans:e,customGui:t}=this;t?this.setDragElement(t,this.dragStartPixels):(this.setTemplate($O),this.getGui().appendChild(Li("rowDrag",e,null)),this.addDragSource()),this.alwaysVisible||this.initCellDrag()}initCellDrag(){const{beans:e,rowNode:t}=this,r=this.refreshVisibility.bind(this);this.addManagedListeners(e.eventSvc,{rowDragVisibilityChanged:r}),this.addManagedListeners(t,{dataChanged:r,cellChanged:r}),this.refreshVisibility()}setDragElement(e,t){this.setTemplateFromElement(e,void 0,void 0,!0),this.addDragSource(t)}refreshVisibility(){if(this.alwaysVisible)return;const{beans:e,column:t,rowNode:r}=this,{gos:n,dragAndDrop:i,rowDragSvc:s}=e,o=s?.visibility;let l=!(o==="suppress"||o==="hidden"&&!i?.hasExternalDropZones()),c=l;if(l&&!this.isCustomGui()&&t){const u=t.getColDef().rowDrag;if(u===!1)l=!1;else{const h=typeof u=="function";c=t.isRowDrag(r),l=h||c}}l&&c&&r.footer&&n.get("rowDragManaged")&&(c=!1,l=!0),c&&(c=l),l||this.setDisplayed(l,xg),c||this.setVisible(c,xg),this.setDisabled(!c||o==="disabled"&&!i?.hasExternalDropZones()),l&&this.setDisplayed(l,xg),c&&this.setVisible(c,xg)}setDisabled(e){e!==this.disabled&&(this.disabled=e,this.getGui()?.classList?.toggle("ag-drag-handle-disabled",e))}getSelectedNodes(){const e=this.rowNode;if(!this.gos.get("rowDragMultiRow"))return[e];const r=this.beans.selectionSvc?.getSelectedNodes()??[];return r.indexOf(e)!==-1?r:[e]}getDragItem(){const{column:e,rowNode:t}=this;return{rowNode:t,rowNodes:this.getSelectedNodes(),columns:e?[e]:void 0,defaultTextValue:this.cellValueFn()}}addDragSource(e=4){if(this.dragSource&&this.removeDragSource(),this.gos.get("rowDragManaged")&&this.rowNode.footer)return;const t=this.getGui();this.gos.get("enableCellTextSelection")&&(this.removeMouseDownListener(),this.mouseDownListener=this.addManagedElementListeners(t,{mousedown:n=>{n?.preventDefault()}})[0]);const r=this.getLocaleTextFunc();this.dragSource={type:2,eElement:t,dragItemName:n=>this.getDragItemName(n,r),getDragItem:()=>this.getDragItem(),dragStartPixels:e,dragSourceDomDataKey:this.gos.getDomDataKey()},this.beans.dragAndDrop.addDragSource(this.dragSource,!0)}getDragItemName(e,t){const r=e?.dragItem||this.getDragItem(),n=(e?.dropTarget?.rows.length??r.rowNodes?.length)||1,i=this.column?.getColDef()?.rowDragText??this.gos.get("rowDragText");if(i)return i(r,n);if(n!==1)return`${n} ${t("rowDragRows","rows")}`;const s=this.cellValueFn();return s||`1 ${t("rowDragRow","rows")}`}destroy(){this.removeDragSource(),this.removeMouseDownListener(),super.destroy()}removeDragSource(){this.dragSource&&(this.beans.dragAndDrop.removeDragSource(this.dragSource),this.dragSource=null)}removeMouseDownListener(){this.mouseDownListener&&(this.mouseDownListener(),this.mouseDownListener=void 0)}},mf=class{constructor(e,t){this.active=!0,this.nodeIdsToColumns={},this.mapToItems={},this.keepingColumns=e,this.pathRoot={rowNode:t,children:null},this.mapToItems[t.id]=this.pathRoot}depthFirstSearchChangedPath(e,t){const{rowNode:r,children:n}=e;if(n)for(let i=0;i<n.length;++i)this.depthFirstSearchChangedPath(n[i],t);t(r)}depthFirstSearchEverything(e,t,r){const n=e.childrenAfterGroup;if(n)for(let i=0,s=n.length;i<s;++i){const o=n[i];o.childrenAfterGroup?this.depthFirstSearchEverything(o,t,r):r&&t(o)}t(e)}forEachChangedNodeDepthFirst(e,t=!1,r=!1){this.active&&!r?this.depthFirstSearchChangedPath(this.pathRoot,e):this.depthFirstSearchEverything(this.pathRoot.rowNode,e,t)}executeFromRootNode(e){e(this.pathRoot.rowNode)}createPathItems(e){let t=e,r=0;for(;!this.mapToItems[t.id];){const n={rowNode:t,children:null};this.mapToItems[t.id]=n,r++,t=t.parent}return r}populateColumnsMap(e,t){if(!this.keepingColumns||!t)return;let r=e;for(;r;){this.nodeIdsToColumns[r.id]||(this.nodeIdsToColumns[r.id]={});for(const n of t)this.nodeIdsToColumns[r.id][n.getId()]=!0;r=r.parent}}linkPathItems(e,t){let r=e;for(let n=0;n<t;n++){const i=this.mapToItems[r.id],s=this.mapToItems[r.parent.id];s.children||(s.children=[]),s.children.push(i),r=r.parent}}addParentNode(e,t){if(!e||e.isRowPinned())return;const r=this.createPathItems(e);this.linkPathItems(e,r),this.populateColumnsMap(e,t)}canSkip(e){return this.active&&!this.mapToItems[e.id]}getValueColumnsForNode(e,t){if(!this.keepingColumns)return t;const r=this.nodeIdsToColumns[e.id];return t.filter(i=>r[i.getId()])}getNotValueColumnsForNode(e,t){if(!this.keepingColumns)return null;const r=this.nodeIdsToColumns[e.id];return t.filter(i=>!r[i.getId()])}},KO=.25,XO=class extends et{constructor(e){super(),this.eContainer=e,this.lastDraggingEvent=null,this.autoScroll=null,this.autoScrollChanged=!1,this.autoScrollChanging=!1,this.autoScrollOldV=null}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,t=>{const r=()=>t.gridBodyCtrl.scrollFeature.getVScrollPosition().top,n=new d7({scrollContainer:t.gridBodyCtrl.eBodyViewport,scrollAxis:"y",getVerticalPosition:r,setVerticalPosition:i=>t.gridBodyCtrl.scrollFeature.setVerticalScrollPosition(i),onScrollCallback:()=>{const i=r();if(this.autoScrollOldV!==i){this.autoScrollOldV=i,this.autoScrollChanging=!0;return}const s=this.autoScrollChanging;this.autoScrollChanged=s,this.autoScrollChanging=!1,s&&(e.dragAndDrop?.nudge(),this.autoScrollChanged=!1)}});this.autoScroll=n,this.clearAutoScroll()})}destroy(){super.destroy(),this.clearAutoScroll(),this.autoScroll=null,this.lastDraggingEvent=null,this.eContainer=null}getContainer(){return this.eContainer}isInterestedIn(e){return e===2}getIconName(e){return e?.dropTarget?.allowed===!1||this.beans.rowDragSvc.visibility!=="visible"?"notAllowed":"move"}getRowNodes(e){if(!this.isFromThisGrid(e))return e.dragItem.rowNodes||[];const t=e.dragItem.rowNode;if(this.gos.get("rowDragMultiRow")){const r=this.beans.selectionSvc?.getSelectedNodes();if(r&&r.indexOf(t)>=0)return r.slice().sort(YO)}return[t]}onDragEnter(e){this.dragging(e,!0)}onDragging(e){this.dragging(e,!1)}dragging(e,t){const{lastDraggingEvent:r,beans:n}=this;if(t){const a=this.getRowNodes(e);e.dragItem.rowNodes=a,R4(a,!0)}this.lastDraggingEvent=e;const i=e.fromNudge,s=this.makeRowsDrop(r,e,i,!1);n.rowDropHighlightSvc?.fromDrag(e),t&&this.dispatchGridEvent("rowDragEnter",e),this.dispatchGridEvent("rowDragMove",e);const o=this.autoScroll;s?.rowDragManaged&&s.moved&&s.allowed&&s.sameGrid&&!s.suppressMoveWhenRowDragging&&(!i&&!o?.scrolling||this.autoScrollChanged)&&this.dropRows(s),o?.check(e.event)}isFromThisGrid(e){return e.dragSource.dragSourceDomDataKey===this.gos.getDomDataKey()}makeRowsDrop(e,t,r,n){const{beans:i,gos:s}=this,o=this.newRowsDrop(t,n),a=i.rowModel;if(t.dropTarget=o,t.changed=!1,!o)return null;let{sameGrid:l,rootNode:c,source:u,target:h}=o;h??(h=a.getRow(a.getRowCount()-1)??null);const d=this.beans.groupEditSvc,f=!!d?.canSetParent(o);let m=null;if(h?.footer){const g=hw(a,-1,h)??hw(a,1,h);f&&(m=h.sibling??c),h=g??null}h?.detail&&(h=h.parent),o.moved&&(o.moved=u!==h);let v=.5;if(h&&(l&&o.moved&&(m||!f)?v=u.rowIndex>h.rowIndex?-.5:.5:v=(o.y-h.rowTop-h.rowHeight/2)/h.rowHeight||0),!f&&l&&h&&o.moved&&rn(s)){const g=ZO(a,o);g&&(v=u.rowIndex>g.rowIndex?-.5:.5,h=g,o.moved&&(o.moved=u!==h))}return o.target=h,o.newParent=m,o.pointerPos=JO(h,o.y),o.yDelta=v,d?.fixRowsDrop(o,f,r,v),this.validateRowsDrop(o,f,n),t.changed||(t.changed=k4(e?.dropTarget,o)),o}newRowsDrop(e,t){const{beans:r,gos:n}=this,i=r.rowModel.rootNode,s=rn(n)?n.get("rowDragManaged"):!1,o=n.get("suppressMoveWhenRowDragging"),a=this.isFromThisGrid(e);let{rowNode:l,rowNodes:c}=e.dragItem;if(c||(c=l?[l]:[]),l||(l=c[0]),!l||!i)return null;const u=this.beans.dragAndDrop.isDropZoneWithinThisGrid(e);let h=!0;s&&(!c.length||r.rowDragSvc.visibility!=="visible"||(o||!a)&&!u)&&(h=!1);const d=p4(r,e).y,f=this.getOverNode(d);return{api:r.gridApi,context:r.gridOptions.context,draggingEvent:e,rowDragManaged:s,suppressMoveWhenRowDragging:o,sameGrid:a,withinGrid:u,treeData:!1,rootNode:i,moved:l!==f,y:d,overNode:f,overIndex:f?.rowIndex??-1,pointerPos:"none",position:"none",source:l,target:f??null,newParent:null,rows:c,allowed:h,highlight:!t&&s&&o&&(u||!a),yDelta:0,inside:!1,droppedManaged:!1}}validateRowsDrop(e,t,r){const{source:n,target:i,yDelta:s,inside:o,moved:a,rowDragManaged:l,suppressMoveWhenRowDragging:c}=e;e.moved&&(e.moved=n!==i);const{position:u,fallbackPosition:h}=this.computeDropPosition(a,o,s);e.position=u,t||(e.newParent=null),this.enforceSuppressMoveWhenRowDragging(e,c,"initial");const d=(!l||e.allowed)&&this.gos.get("isRowValidDropPosition");d&&this.applyDropValidator(e,t,r,l,d),l&&(e.rows=this.filterRows(e)),this.beans.groupEditSvc?.clearNewSameParent(e,t),this.enforceSuppressMoveWhenRowDragging(e,c,"final"),e.position==="inside"&&(!e.allowed||!e.newParent)&&(e.position=h)}computeDropPosition(e,t,r){const n=r<0?"above":"below";return e?{position:t?"inside":n,fallbackPosition:n}:{position:"none",fallbackPosition:n}}enforceSuppressMoveWhenRowDragging(e,t,r){if(t){if(r==="initial"){e.moved||(e.allowed=!1);return}(!e.rows.length||e.position==="none")&&(e.allowed=!1)}}applyDropValidator(e,t,r,n,i){this.beans.groupEditSvc?.clearNewSameParent(e,t);const s=i(e);if(!s){e.allowed=!1;return}if(typeof s!="object")return;s.rows!==void 0&&(e.rows=s.rows??[]),t&&s.newParent!==void 0&&(e.newParent=s.newParent),s.target!==void 0&&(e.target=s.target),s.position&&(e.position=s.position),s.allowed!==void 0?e.allowed=s.allowed:n||(e.allowed=!0);const o=e.draggingEvent;s.changed&&o&&(o.changed=!0),!r&&s.highlight!==void 0&&(e.highlight=s.highlight)}addRowDropZone(e){if(!e.getContainer()){at(55);return}const t=this.beans.dragAndDrop;if(t.findExternalZone(e.getContainer())){at(56);return}const r=e.fromGrid?e:{getContainer:e.getContainer,onDragEnter:e.onDragEnter&&(i=>e.onDragEnter(this.rowDragEvent("rowDragEnter",i))),onDragLeave:e.onDragLeave&&(i=>e.onDragLeave(this.rowDragEvent("rowDragLeave",i))),onDragging:e.onDragging&&(i=>e.onDragging(this.rowDragEvent("rowDragMove",i))),onDragStop:e.onDragStop&&(i=>e.onDragStop(this.rowDragEvent("rowDragEnd",i))),onDragCancel:e.onDragCancel&&(i=>e.onDragCancel(this.rowDragEvent("rowDragCancel",i)))},n={isInterestedIn:i=>i===2,getIconName:()=>"move",external:!0,...r};t.addDropTarget(n),this.addDestroyFunc(()=>t.removeDropTarget(n))}getRowDropZone(e){return{getContainer:this.getContainer.bind(this),onDragEnter:r=>{this.onDragEnter(r),e?.onDragEnter?.(this.rowDragEvent("rowDragEnter",r))},onDragLeave:r=>{this.onDragLeave(r),e?.onDragLeave?.(this.rowDragEvent("rowDragLeave",r))},onDragging:r=>{this.onDragging(r),e?.onDragging?.(this.rowDragEvent("rowDragMove",r))},onDragStop:r=>{this.onDragStop(r),e?.onDragStop?.(this.rowDragEvent("rowDragEnd",r))},onDragCancel:r=>{this.onDragCancel(r),e?.onDragCancel?.(this.rowDragEvent("rowDragCancel",r))},fromGrid:!0}}getOverNode(e){const{pageBounds:t,rowModel:r}=this.beans,i=e>t.getCurrentPagePixelRange().pageLastPixel?-1:r.getRowIndexAtPixel(e);return i>=0?r.getRow(i):void 0}rowDragEvent(e,t){const r=this.beans,{dragItem:n,dropTarget:i,event:s,vDirection:o}=t,a=i?.rootNode===r.rowModel.rootNode,l=a?i.y:p4(r,t).y,c=a?i.overNode:this.getOverNode(l),u=a?i.overIndex:c?.rowIndex??-1;return{api:r.gridApi,context:r.gridOptions.context,type:e,event:s,node:n.rowNode,nodes:n.rowNodes,overIndex:u,overNode:c,y:l,vDirection:o,rowsDrop:i}}dispatchGridEvent(e,t){const r=this.rowDragEvent(e,t);this.eventSvc.dispatchEvent(r)}onDragLeave(e){this.dispatchGridEvent("rowDragLeave",e),this.stopDragging(e,!1)}onDragStop(e){const t=this.lastDraggingEvent?.dropTarget??null,r=this.makeRowsDrop(this.lastDraggingEvent,e,!1,!0);this.dispatchGridEvent("rowDragEnd",e),r?.allowed&&r.rowDragManaged&&(!t?.droppedManaged||k4(t,r))&&this.dropRows(r),this.stopDragging(e,!0)}onDragCancel(e){this.dispatchGridEvent("rowDragCancel",e),this.stopDragging(e,!0)}stopDragging(e,t){this.clearAutoScroll(),this.beans.groupEditSvc?.stopDragging(t),this.beans.rowDropHighlightSvc?.fromDrag(null),R4(e.dragItem.rowNodes,!1),this.lastDraggingEvent=null}clearAutoScroll(){this.autoScroll?.ensureCleared(),this.autoScrollChanged=!1,this.autoScrollChanging=!1,this.autoScrollOldV=null}dropRows(e){return e.droppedManaged=!0,e.sameGrid?this.csrmMoveRows(e):this.csrmAddRows(e)}csrmAddRows({position:e,target:t,rows:r}){const n=ld(this.gos),i=this.beans.rowModel,s=r.filter(({data:a,rowPinned:l})=>!i.getRowNode(n?.({data:a,level:0,rowPinned:l})??a.id)).map(({data:a})=>a);if(s.length===0)return!1;let o;if(t){const a=t.sourceRowIndex>=0?t:R0(t);a&&(o=a.sourceRowIndex+(e==="above"?0:1))}return i.updateRowData({add:s,addIndex:o}),!0}filterRows(e){const{groupEditSvc:t}=this.beans,{rows:r,sameGrid:n}=e;let i;for(let s=0,o=r.length;s<o;++s){let a=!0;const l=r[s];(!l||l.footer||n&&l.destroyed&&!l.group||!this.csrmGetLeaf(l))&&(a=!1),a&&t&&!t.canDropRow(l,e)&&(a=!1),a?i?.push(l):i??(i=r.slice(0,s))}return i??r}csrmMoveRows(e){const t=this.beans.groupEditSvc;return t?.isGroupingDrop(e)?t.dropGroupEdit(e):this.csrmMoveRowsReorder(e)}csrmMoveRowsReorder({position:e,target:t,rows:r,newParent:n,rootNode:i}){let s=!1;const o=new Set;for(const d of r){n&&d.parent!==n&&(d.treeParent=n,s=!0);const f=this.csrmGetLeaf(d);f&&o.add(f)}if(!s&&o.size===0)return!1;const a=this.beans.focusSvc,l=a.getFocusedCell(),c=l&&Lu(this.beans,l);if(o.size&&fO(i._leafs,o,t,e==="above")&&(s=!0),!s)return!1;const u=this.beans.rowModel,h=new n0;return h.reordered=!0,u.refreshModel({step:"group",keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame"),changedPath:new mf(!1,i),changedRowNodes:h}),c?c.focusCell():a.clearFocusedCell(),!0}csrmGetLeaf(e){if(e.sourceRowIndex>=0)return e.destroyed?void 0:e;const t=this.beans.groupEditSvc;return t?t.csrmFirstLeaf(e):R0(e)}},k4=(e,t)=>e!==t&&(!e||e.sameGrid!==t.sameGrid||e.allowed!==t.allowed||e.position!==t.position||e.target!==t.target||e.source!==t.source||e.newParent!==t.newParent||!ml(e.rows,t.rows)),YO=({rowIndex:e},{rowIndex:t})=>e!==null&&t!==null?e-t:0,R4=(e,t)=>{for(let r=0,n=e?.length||0;r<n;++r){const i=e[r];i.dragging!==t&&(i.dragging=t,i.dispatchRowEvent("draggingChanged"))}},ZO=(e,t)=>{let r=null,n=t.target;if(n&&t.rows.indexOf(n)<0)return null;const i=t.source;if(!n||!i)return null;let s=n.rowIndex-i.rowIndex;const o=s<0?-1:1;s=t.suppressMoveWhenRowDragging?Math.abs(s):1;const a=new Set(t.rows);do{const l=hw(e,o,n);if(!l)break;a.has(l)||(r=l,--s),n=l}while(s>0);return r},JO=(e,t)=>{const r=e?.rowTop,n=e?.rowHeight??0;if(r==null||!n||n<=0)return"none";const i=t-r,s=n*KO;return i<=s?"above":i>=n-s?"below":"inside"},QO=class extends et{constructor(){super(...arguments),this.beanName="rowDragSvc",this.rowDragFeature=null,this.visibility="suppress"}setupRowDrag(e,t){const r=t.createManagedBean(new XO(e)),n=this.beans.dragAndDrop;n.addDropTarget(r),t.addDestroyFunc(()=>n.removeDropTarget(r)),this.rowDragFeature=r;const i=()=>this.refreshVisibility();this.addManagedPropertyListeners(["rowDragManaged","suppressRowDrag","refreshAfterGroupEdit"],i),this.addManagedEventListeners({newColumnsLoaded:i,columnRowGroupChanged:i,columnPivotModeChanged:i,sortChanged:i,filterChanged:i}),this.visibility=this.computeVisibility()}createRowDragComp(e,t,r,n,i,s){return new qO(e,t,r,n,i,s)}createRowDragCompForRow(e,t){if(ll(this.gos))return;const r=this.getLocaleTextFunc();return this.createRowDragComp(()=>`1 ${r("rowDragRow","row")}`,e,void 0,t,void 0,!0)}createRowDragCompForCell(e,t,r,n,i,s){const o=this.gos;return o.get("rowDragManaged")&&(!rn(o)||o.get("pagination"))?void 0:this.createRowDragComp(r,e,t,n,i,s)}cancelRowDrag(){this.rowDragFeature?.lastDraggingEvent&&this.beans.dragSvc?.cancelDrag()}computeVisibility(){const e=this.beans,t=e.gos;if(t.get("suppressRowDrag"))return"suppress";if(!t.get("rowDragManaged"))return"visible";const n=e.colModel.isPivotMode();return(n||e.rowGroupColsSvc?.columns?.length)&&!t.get("refreshAfterGroupEdit")?"hidden":n||e.filterManager?.isAnyFilterPresent()||e.sortSvc?.isSortActive()?"disabled":"visible"}refreshVisibility(){const e=this.visibility,t=this.computeVisibility();e!==t&&(this.visibility=t,this.eventSvc?.dispatchEvent({type:"rowDragVisibilityChanged"}))}},eN=class extends et{constructor(){super(...arguments),this.beanName="rowDropHighlightSvc",this.uiLevel=0,this.dragging=!1,this.row=null,this.position="none"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this)})}onModelUpdated(){const e=this.row,t=this.dragging;!e||e?.rowIndex===null||this.position==="none"?this.clear():this.set(e,this.position),this.dragging=t}destroy(){this.clear(),super.destroy()}clear(){const e=this.row;this.dragging=!1,e&&(this.uiLevel=0,this.position="none",this.row=null,e.dispatchRowEvent("rowHighlightChanged"))}set(e,t){const r=e!==this.row,n=e.uiLevel,i=t!==this.position,s=n!==this.uiLevel;this.dragging=!1,(r||i||s)&&(r&&this.clear(),this.uiLevel=n,this.position=t,this.row=e,e.dispatchRowEvent("rowHighlightChanged"))}fromDrag(e){const t=e?.dropTarget;if(t){const{highlight:r,target:n,position:i}=t;if(r&&n&&i!=="none"){this.set(n,i),this.dragging=!0;return}}this.dragging&&this.clear()}},fR={moduleName:"Drag",version:wt,beans:[UO]},tN={moduleName:"DragAndDrop",version:wt,dynamicBeans:{dndSourceComp:BO},icons:{rowDrag:"grip"}},pR={moduleName:"SharedDragAndDrop",version:wt,beans:[T9],dependsOn:[fR],userComponents:{agDragAndDropImage:tO},icons:{columnMovePin:"pin",columnMoveHide:"eye-slash",columnMoveMove:"arrows",columnMoveLeft:"left",columnMoveRight:"right",columnMoveGroup:"group",columnMoveValue:"aggregation",columnMovePivot:"pivot",dropNotAllowed:"not-allowed",rowDrag:"grip"}},rN={moduleName:"RowDrag",version:wt,beans:[eN,QO],apiFunctions:{addRowDropZone:HO,removeRowDropZone:jO,getRowDropZoneParams:VO,getRowDropPositionIndicator:GO,setRowDropPositionIndicator:zO},dependsOn:[pR]},nN={moduleName:"HorizontalResize",version:wt,beans:[WO],dependsOn:[fR]},iN=":where(.ag-ltr) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:left .2s}.ag-header-group-cell{transition:left .2s,width .2s}}:where(.ag-rtl) :where(.ag-column-moving){.ag-cell,.ag-header-cell,.ag-spanned-cell-wrapper{transition:right .2s}.ag-header-group-cell{transition:right .2s,width .2s}}",sN=class extends et{constructor(){super(...arguments),this.beanName="colAnimation",this.executeNextFuncs=[],this.executeLaterFuncs=[],this.active=!1,this.activeNext=!1,this.suppressAnimation=!1,this.animationThreadCount=0}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>this.gridBodyCtrl=e.gridBodyCtrl)}isActive(){return this.active&&!this.suppressAnimation}setSuppressAnimation(e){this.suppressAnimation=e}start(){if(this.active)return;const{gos:e}=this;e.get("suppressColumnMoveAnimation")||e.get("enableRtl")||(this.ensureAnimationCssClassPresent(),this.active=!0,this.activeNext=!0)}finish(){this.active&&this.flush(()=>this.activeNext=!1,()=>this.active=!1)}executeNextVMTurn(e){this.activeNext?this.executeNextFuncs.push(e):e()}executeLaterVMTurn(e){this.active?this.executeLaterFuncs.push(e):e()}ensureAnimationCssClassPresent(){this.animationThreadCount++;const e=this.animationThreadCount,{gridBodyCtrl:t}=this;t.setColumnMovingCss(!0),this.executeLaterFuncs.push(()=>{this.animationThreadCount===e&&t.setColumnMovingCss(!1)})}flush(e,t){const{executeNextFuncs:r,executeLaterFuncs:n}=this;if(r.length===0&&n.length===0){e(),t();return}const i=s=>{for(;s.length;){const o=s.pop();o&&o()}};this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e(),i(r)},0),window.setTimeout(()=>{t(),i(n)},200)})}};function oN(e,t,r){e.colMoves?.moveColumnByIndex(t,r,"api")}function aN(e,t,r){e.colMoves?.moveColumns(t,r,"api")}var lN=class extends et{constructor(e){super(),this.pinned=e,this.columnsToAggregate=[],this.columnsToGroup=[],this.columnsToPivot=[]}onDragEnter(e){if(this.clearColumnsList(),this.gos.get("functionsReadOnly"))return;const t=e.dragItem.columns;if(t)for(const r of t)r.isPrimary()&&(r.isAnyFunctionActive()||(r.isAllowValue()?this.columnsToAggregate.push(r):r.isAllowRowGroup()?this.columnsToGroup.push(r):r.isAllowPivot()&&this.columnsToPivot.push(r)))}getIconName(){return this.columnsToAggregate.length+this.columnsToGroup.length+this.columnsToPivot.length>0?this.pinned?"pinned":"move":null}onDragLeave(e){this.clearColumnsList()}clearColumnsList(){this.columnsToAggregate.length=0,this.columnsToGroup.length=0,this.columnsToPivot.length=0}onDragging(e){}onDragStop(e){const{valueColsSvc:t,rowGroupColsSvc:r,pivotColsSvc:n}=this.beans;this.columnsToAggregate.length>0&&t?.addColumns(this.columnsToAggregate,"toolPanelDragAndDrop"),this.columnsToGroup.length>0&&r?.addColumns(this.columnsToGroup,"toolPanelDragAndDrop"),this.columnsToPivot.length>0&&n?.addColumns(this.columnsToPivot,"toolPanelDragAndDrop")}onDragCancel(){this.clearColumnsList()}};function cN(e,t){!t||t.length<=1||t.filter(n=>e.indexOf(n)<0).length>0||t.sort((n,i)=>{const s=e.indexOf(n),o=e.indexOf(i);return s-o})}function uN(e){const t=[...e];for(const r of e){let n=null,i=r.getParent();for(;i!=null&&i.getDisplayedLeafColumns().length===1;)n=i,i=i.getParent();if(n!=null){const o=!!n.getColGroupDef()?.marryChildren?n.getProvidedColumnGroup().getLeafColumns():n.getLeafColumns();for(const a of o)t.includes(a)||t.push(a)}}return t}function dN(e,t,r,n){const i=n.allCols;let s=null,o=null;for(let a=0;a<e.length;a++){const l=e[a],c=r.getProposedColumnOrder(t,l);if(!r.doesOrderPassRules(c))continue;const u=c.filter(d=>i.includes(d));if(o===null)o=u;else if(!ml(u,o))break;const h=fN(c);(s===null||h<s.fragCount)&&(s={move:l,fragCount:h})}return s}function gR(e){const{isFromHeader:t,fromLeft:r,xPosition:n,fromEnter:i,fakeEvent:s,pinned:o,gos:a,colModel:l,colMoves:c,visibleCols:u}=e;let{allMovingColumns:h}=e;t&&(h=uN(h));const d=h.slice();cN(l.getCols(),d);const f=gN({movingCols:d,draggingRight:r,xPosition:n,pinned:o,gos:a,colModel:l,visibleCols:u}),m=hN(d,l);if(f.length===0)return;const v=f[0];if(m!==null&&(t||!i)&&!s&&(!r&&v>=m||r&&v<=m))return;const w=dN(f,d,c,u);if(!w)return;const y=w.move;if(!(y>l.getCols().length-d.length))return{columns:d,toIndex:y}}function mR(e){const{columns:t,toIndex:r}=gR(e)||{},{finished:n,colMoves:i}=e;return!t||r==null?null:(i.moveColumns(t,r,"uiColumnMoved",n),n?null:{columns:t,toIndex:r})}function hN(e,t){const r=t.getCols(),n=e.map(l=>r.indexOf(l)).sort((l,c)=>l-c),i=n[0];return zr(n)-i!==n.length-1?null:i}function fN(e){function t(n){const i=[];let s=n.getOriginalParent();for(;s!=null;)i.push(s),s=s.getOriginalParent();return i}let r=0;for(let n=0;n<e.length-1;n++){let i=t(e[n]),s=t(e[n+1]);[i,s]=i.length>s.length?[i,s]:[s,i];for(const o of i)s.indexOf(o)===-1&&r++}return r}function pN(e,t){switch(t){case"left":return e.leftCols;case"right":return e.rightCols;default:return e.centerCols}}function gN(e){const{movingCols:t,draggingRight:r,xPosition:n,pinned:i,gos:s,colModel:o,visibleCols:a}=e;if(s.get("suppressMovableColumns")||t.some(C=>C.getColDef().suppressMovable))return[];const c=pN(a,i),u=o.getCols(),h=c.filter(C=>t.includes(C)),d=c.filter(C=>!t.includes(C)),f=u.filter(C=>!t.includes(C));let m=0,v=n;if(r){let C=0;for(const k of h)C+=k.getActualWidth();v-=C}if(v>0){for(let C=0;C<d.length;C++){const k=d[C];if(v-=k.getActualWidth(),v<0)break;m++}r&&m++}let g;if(m>0){const C=d[m-1];g=f.indexOf(C)+1}else g=f.indexOf(d[0]),g===-1&&(g=0);const w=[g],y=(C,k)=>C-k;if(r){let C=g+1;const k=u.length-1;for(;C<=k;)w.push(C),C++;w.sort(y)}else{let C=g;const k=u.length-1;let F=u[C];for(;C<=k&&c.indexOf(F)<0;)C++,w.push(C),F=u[C];C=g-1;const I=0;for(;C>=I;)w.push(C),C--;w.sort(y).reverse()}return w}function bw(e){const{pinned:t,fromKeyboard:r,gos:n,ctrlsSvc:i,useHeaderRow:s,skipScrollPadding:o}=e;let a=i.getHeaderRowContainerCtrl(t)?.eViewport,{x:l}=e;return a?(r&&(l-=a.getBoundingClientRect().left),n.get("enableRtl")&&(s&&(a=a.querySelector(".ag-header-row")),l=a.clientWidth-l),t==null&&!o&&(l+=i.get("center").getCenterViewportScrollLeft()),l):0}function cb(e,t){for(const r of e)r.moving=t,r.dispatchColEvent("movingChanged","uiColumnMoved")}var A4=7,ww=100,Sg=ww/2,mN=5,vN=100,bN=class extends et{constructor(e){super(),this.pinned=e,this.needToMoveLeft=!1,this.needToMoveRight=!1,this.lastMovedInfo=null,this.isCenterContainer=!bt(e)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}getIconName(){const{pinned:e,lastDraggingEvent:t}=this,{dragItem:r}=t||{},n=r?.columns??[];for(const i of n){const s=i.getPinned();if(i.getColDef().lockPinned){if(s==e)return"move";continue}const o=r?.containerType;if(o===e||!e)return"move";if(e&&(!s||o!==e))return"pinned"}return"notAllowed"}onDragEnter(e){const t=e.dragItem,r=t.columns;if(e.dragSource.type===0)this.setColumnsVisible(r,!0,"uiColumnDragged");else{const i=t.visibleState,s=(r||[]).filter(o=>i[o.getId()]&&!o.isVisible());this.setColumnsVisible(s,!0,"uiColumnDragged")}this.gos.get("suppressMoveWhenColumnDragging")||this.attemptToPinColumns(r,this.pinned),this.onDragging(e,!0,!0)}onDragging(e=this.lastDraggingEvent,t=!1,r=!1,n=!1){const{gos:i,ctrlsSvc:s}=this.beans,o=i.get("suppressMoveWhenColumnDragging");if(n&&!o){this.finishColumnMoving();return}if(this.lastDraggingEvent=e,!e||!n&&Yr(e.hDirection))return;const a=bw({x:e.x,pinned:this.pinned,gos:i,ctrlsSvc:s});t||this.checkCenterForScrolling(a),o?this.handleColumnDragWhileSuppressingMovement(e,t,r,a,n):this.handleColumnDragWhileAllowingMovement(e,t,r,a,n)}onDragLeave(){this.ensureIntervalCleared(),this.clearHighlighted(),this.updateDragItemContainerType(),this.lastMovedInfo=null}onDragStop(){this.onDragging(this.lastDraggingEvent,!1,!0,!0),this.ensureIntervalCleared(),this.lastMovedInfo=null}onDragCancel(){this.clearHighlighted(),this.ensureIntervalCleared(),this.lastMovedInfo=null}setColumnsVisible(e,t,r){if(!e?.length)return;const n=e.filter(i=>!i.getColDef().lockVisible);n.length&&this.beans.colModel.setColsVisible(n,t,r)}finishColumnMoving(){this.clearHighlighted();const e=this.lastMovedInfo;if(!e)return;const{columns:t,toIndex:r}=e;this.beans.colMoves.moveColumns(t,r,"uiColumnMoved",!0)}updateDragItemContainerType(){const{lastDraggingEvent:e}=this;if(this.gos.get("suppressMoveWhenColumnDragging")||!e)return;const t=e.dragItem;t&&(t.containerType=this.pinned)}handleColumnDragWhileSuppressingMovement(e,t,r,n,i){const s=this.getAllMovingColumns(e,!0);if(i){const o=this.isAttemptingToPin(s);o&&this.attemptToPinColumns(s,void 0,!0);const{fromLeft:a,xPosition:l}=this.getNormalisedXPositionInfo(s,o)||{};if(a==null||l==null){this.finishColumnMoving();return}this.moveColumnsAfterHighlight({allMovingColumns:s,xPosition:l,fromEnter:t,fakeEvent:r,fromLeft:a})}else{if(!this.beans.dragAndDrop.isDropZoneWithinThisGrid(e))return;this.highlightHoveredColumn(s,n)}}handleColumnDragWhileAllowingMovement(e,t,r,n,i){const s=this.getAllMovingColumns(e),o=this.normaliseDirection(e.hDirection)==="right",a=e.dragSource.type===1,l=this.getMoveColumnParams({allMovingColumns:s,isFromHeader:a,xPosition:n,fromLeft:o,fromEnter:t,fakeEvent:r}),c=mR({...l,finished:i});c&&(this.lastMovedInfo=c)}getAllMovingColumns(e,t=!1){const r=e.dragSource.getDragItem();let n=null;t?(n=r.columnsInSplit,n||(n=r.columns)):n=r.columns;const i=s=>s.getColDef().lockPinned?s.getPinned()==this.pinned:!0;return n?n.filter(i):[]}getMoveColumnParams(e){const{allMovingColumns:t,isFromHeader:r,xPosition:n,fromLeft:i,fromEnter:s,fakeEvent:o}=e,{gos:a,colModel:l,colMoves:c,visibleCols:u}=this.beans;return{allMovingColumns:t,isFromHeader:r,fromLeft:i,xPosition:n,pinned:this.pinned,fromEnter:s,fakeEvent:o,gos:a,colModel:l,colMoves:c,visibleCols:u}}highlightHoveredColumn(e,t){const{gos:r,colModel:n}=this.beans,i=r.get("enableRtl"),s=n.getCols().filter(u=>u.isVisible()&&u.getPinned()===this.pinned);let o=null,a=null,l=null;for(const u of s){if(a=u.getActualWidth(),o=this.getNormalisedColumnLeft(u,0,i),o!=null){const h=o+a;if(o<=t&&h>=t){l=u;break}}o=null,a=null}if(l)e.indexOf(l)!==-1&&(l=null);else{for(let u=s.length-1;u>=0;u--){const h=s[u],d=s[u].getParent();if(!d){l=h;break}const f=d?.getDisplayedLeafColumns();if(f.length){l=zr(f);break}}if(!l)return;o=this.getNormalisedColumnLeft(l,0,i),a=l.getActualWidth()}if(this.lastHighlightedColumn?.column!==l&&this.clearHighlighted(),l==null||o==null||a==null)return;let c;t-o<a/2?c=0:c=1,F4(l,c),this.lastHighlightedColumn={column:l,position:c}}getNormalisedXPositionInfo(e,t){const{gos:r,visibleCols:n}=this.beans,i=r.get("enableRtl"),{firstMovingCol:s,column:o,position:a}=this.getColumnMoveAndTargetInfo(e,t,i);if(!s||!o||a==null)return;const l=n.allCols,c=l.indexOf(s),u=l.indexOf(o),h=a===0,d=c<u||c===u&&!h;let f=0;if(h?d&&(f-=1):d||(f+=1),u+f===c)return;const m=l[u+f];if(!m)return;const v=this.getNormalisedColumnLeft(m,20,i);return{fromLeft:d,xPosition:v}}getColumnMoveAndTargetInfo(e,t,r){const n=this.lastHighlightedColumn||{},{firstMovingCol:i,lastMovingCol:s}=wN(e);if(!i||!s||n.column||!t)return{firstMovingCol:i,...n};const a=this.getPinDirection()==="left";return{firstMovingCol:i,position:a?1:0,column:a!==r?i:s}}normaliseDirection(e){if(this.gos.get("enableRtl"))switch(e){case"left":return"right";case"right":return"left"}return e}getNormalisedColumnLeft(e,t,r){const{gos:n,ctrlsSvc:i}=this.beans,s=e.getLeft();if(s==null)return null;const o=e.getActualWidth();return bw({x:r?s+o-t:s+t,pinned:e.getPinned(),useHeaderRow:r,skipScrollPadding:!0,gos:n,ctrlsSvc:i})}isAttemptingToPin(e){const t=this.needToMoveLeft||this.needToMoveRight,r=this.failedMoveAttempts>A4;return t&&r||e.some(n=>n.getPinned()!==this.pinned)}moveColumnsAfterHighlight(e){const{allMovingColumns:t,xPosition:r,fromEnter:n,fakeEvent:i,fromLeft:s}=e,o=this.getMoveColumnParams({allMovingColumns:t,isFromHeader:!0,xPosition:r,fromLeft:s,fromEnter:n,fakeEvent:i}),{columns:a,toIndex:l}=gR(o)||{};a&&l!=null&&(this.lastMovedInfo={columns:a,toIndex:l}),this.finishColumnMoving()}clearHighlighted(){const{lastHighlightedColumn:e}=this;e&&(F4(e.column,null),this.lastHighlightedColumn=null)}checkCenterForScrolling(e){if(!this.isCenterContainer)return;const t=this.beans.ctrlsSvc.get("center"),r=t.getCenterViewportScrollLeft(),n=r+t.getCenterWidth();let i,s;this.gos.get("enableRtl")?(i=e<r+Sg,s=e>n-Sg):(s=e<r+Sg,i=e>n-Sg),this.needToMoveRight=i,this.needToMoveLeft=s,s||i?this.ensureIntervalStarted():this.ensureIntervalCleared()}ensureIntervalStarted(){this.movingIntervalId||(this.intervalCount=0,this.failedMoveAttempts=0,this.movingIntervalId=window.setInterval(this.moveInterval.bind(this),vN),this.beans.dragAndDrop.setDragImageCompIcon(this.needToMoveLeft?"left":"right",!0))}ensureIntervalCleared(){this.movingIntervalId&&(window.clearInterval(this.movingIntervalId),this.movingIntervalId=null,this.failedMoveAttempts=0,this.beans.dragAndDrop.setDragImageCompIcon(this.getIconName()))}moveInterval(){let e;this.intervalCount++,e=10+this.intervalCount*mN,e>ww&&(e=ww);let t=null;const r=this.gridBodyCon.scrollFeature;if(this.needToMoveLeft?t=r.scrollHorizontally(-e):this.needToMoveRight&&(t=r.scrollHorizontally(e)),t!==0)this.onDragging(this.lastDraggingEvent),this.failedMoveAttempts=0;else{this.failedMoveAttempts++;const{pinnedCols:n,dragAndDrop:i,gos:s}=this.beans;if(this.failedMoveAttempts<=A4+1||!n)return;if(i.setDragImageCompIcon("pinned"),!s.get("suppressMoveWhenColumnDragging")){const o=this.lastDraggingEvent?.dragItem.columns;this.attemptToPinColumns(o,void 0,!0)}}}getPinDirection(){if(this.needToMoveLeft||this.pinned==="left")return"left";if(this.needToMoveRight||this.pinned==="right")return"right"}attemptToPinColumns(e,t,r=!1){const n=(e||[]).filter(o=>!o.getColDef().lockPinned);if(!n.length)return 0;r&&(t=this.getPinDirection());const{pinnedCols:i,dragAndDrop:s}=this.beans;return i?.setColsPinned(n,t,"uiColumnDragged"),r&&s.nudge(),n.length}destroy(){super.destroy(),this.lastDraggingEvent=null,this.clearHighlighted(),this.lastMovedInfo=null}};function F4(e,t){e.highlighted!==t&&(e.highlighted=t,e.dispatchColEvent("headerHighlightChanged","uiColumnMoved"))}function wN(e){const t=e.length;let r,n;for(let i=0;i<t;i++){if(!r){const s=e[i];s.getLeft()!=null&&(r=s)}if(!n){const s=e[t-1-i];s.getLeft()!=null&&(n=s)}if(r&&n)break}return{firstMovingCol:r,lastMovingCol:n}}var yN=class extends et{constructor(e,t){super(),this.pinned=e,this.eContainer=t}postConstruct(){const{ctrlsSvc:e,dragAndDrop:t}=this.beans,r=this.pinned;e.whenReady(this,n=>{let i;const s=n.gridBodyCtrl.eBodyViewport;switch(r){case"left":i=[[s,n.left.eContainer],[n.bottomLeft.eContainer],[n.topLeft.eContainer]];break;case"right":i=[[s,n.right.eContainer],[n.bottomRight.eContainer],[n.topRight.eContainer]];break;default:i=[[s,n.center.eViewport],[n.bottomCenter.eViewport],[n.topCenter.eViewport]];break}this.eSecondaryContainers=i}),this.moveColumnFeature=this.createManagedBean(new bN(r)),this.bodyDropPivotTarget=this.createManagedBean(new lN(r)),t.addDropTarget(this),this.addDestroyFunc(()=>t.removeDropTarget(this))}isInterestedIn(e){return e===1||e===0&&this.gos.get("allowDragFromColumnsToolPanel")}getSecondaryContainers(){return this.eSecondaryContainers}getContainer(){return this.eContainer}getIconName(){return this.currentDropListener.getIconName()}isDropColumnInPivotMode(e){return this.beans.colModel.isPivotMode()&&e.dragSource.type===0}onDragEnter(e){this.currentDropListener=this.isDropColumnInPivotMode(e)?this.bodyDropPivotTarget:this.moveColumnFeature,this.currentDropListener.onDragEnter(e)}onDragLeave(e){this.currentDropListener.onDragLeave(e)}onDragging(e){this.currentDropListener.onDragging(e)}onDragStop(e){this.currentDropListener.onDragStop(e)}onDragCancel(){this.currentDropListener.onDragCancel()}},CN=class extends et{constructor(){super(...arguments),this.beanName="colMoves"}moveColumnByIndex(e,t,r){const n=this.beans.colModel.getCols();if(!n)return;const i=n[e];this.moveColumns([i],t,r)}moveColumns(e,t,r,n=!0){const{colModel:i,colAnimation:s,visibleCols:o,eventSvc:a}=this.beans,l=i.getCols();if(!l)return;if(t>l.length-e.length){at(30,{toIndex:t});return}s?.start();const c=i.getColsForKeys(e);this.doesMovePassRules(c,t)&&(q_(i.getCols(),c,t),o.refresh(r),a.dispatchEvent({type:"columnMoved",columns:c,column:c.length===1?c[0]:null,toIndex:t,finished:n,source:r})),s?.finish()}doesMovePassRules(e,t){const r=this.getProposedColumnOrder(e,t);return this.doesOrderPassRules(r)}doesOrderPassRules(e){const{colModel:t,gos:r}=this.beans;return!(!ck(e,t.getColTree())||!(i=>{const s=c=>c?c==="left"||c===!0?-1:1:0,o=r.get("enableRtl");let a=o?1:-1,l=!0;for(const c of i){const u=s(c.getColDef().lockPosition);o?u>a&&(l=!1):u<a&&(l=!1),a=u}return l})(e))}getProposedColumnOrder(e,t){const n=this.beans.colModel.getCols().slice();return q_(n,e,t),n}createBodyDropTarget(e,t){return new yN(e,t)}moveHeader(e,t,r,n,i){const{ctrlsSvc:s,gos:o,colModel:a,visibleCols:l,focusSvc:c}=this.beans,u=t.getBoundingClientRect(),h=u.left,d=yn(r),f=d?u.width:r.getActualWidth(),m=e==="left"!==o.get("enableRtl"),v=bw({x:m?h-20:h+f+20,pinned:n,fromKeyboard:!0,gos:o,ctrlsSvc:s}),g=c.focusedHeader;mR({allMovingColumns:d?r.getLeafColumns():[r],isFromHeader:!0,fromLeft:e==="right",xPosition:v,pinned:n,fromEnter:!1,fakeEvent:!1,gos:o,colModel:a,colMoves:this,visibleCols:l,finished:!0});let w;if(d){const y=r.getDisplayedLeafColumns();w=m?y[0]:zr(y)}else w=r;if(s.getScrollFeature().ensureColumnVisible(w,"auto"),(!i.isAlive()||o.get("ensureDomOrder"))&&g){let y;if(d){const C=r.getGroupId(),k=r.getLeafColumns();if(!k.length)return;const F=k[0].getParent();if(!F)return;y=xN(F,C)}else y=r;y&&c.focusHeaderPosition({headerPosition:{...g,column:y}})}}setDragSourceForHeader(e,t,r){const{gos:n,colModel:i,dragAndDrop:s,visibleCols:o}=this.beans;let a=!n.get("suppressDragLeaveHidesColumns");const l=yn(t),c=l?t.getProvidedColumnGroup().getLeafColumns():[t],h={type:1,eElement:e,getDefaultIconName:()=>a?"hide":"notAllowed",getDragItem:l?()=>_N(t,o.allCols):()=>SN(t),dragItemName:r,onDragStarted:()=>{a=!n.get("suppressDragLeaveHidesColumns"),cb(c,!0)},onDragStopped:()=>cb(c,!1),onDragCancelled:()=>cb(c,!1),onGridEnter:d=>{if(a){const{columns:f=[],visibleState:m}=d??{},v=l?w=>!m||m[w.getColId()]:()=>!0,g=f.filter(w=>!w.getColDef().lockVisible&&v(w));i.setColsVisible(g,!0,"uiColumnMoved")}},onGridExit:d=>{if(a){const f=d?.columns?.filter(m=>!m.getColDef().lockVisible)||[];i.setColsVisible(f,!1,"uiColumnMoved")}}};return s.addDragSource(h,!0),h}};function xN(e,t){for(;e;){if(e.getGroupId()===t)return e;e=e.getParent()}}function SN(e){const t={};return t[e.getId()]=e.isVisible(),{columns:[e],visibleState:t,containerType:e.pinned}}function _N(e,t){const r=e.getProvidedColumnGroup().getLeafColumns(),n={};for(const a of r)n[a.getId()]=a.isVisible();const i=[];for(const a of t)r.indexOf(a)>=0&&(i.push(a),Eo(r,a));for(const a of r)i.push(a);const s=[],o=e.getLeafColumns();for(const a of i)o.indexOf(a)!==-1&&s.push(a);return{columns:i,columnsInSplit:s,visibleState:n,containerType:s[0]?.pinned}}var EN={moduleName:"ColumnMove",version:wt,beans:[CN,sN],apiFunctions:{moveColumnByIndex:oN,moveColumns:aN},dependsOn:[pR],css:[iN]},TN=class extends et{constructor(){super(...arguments),this.beanName="autoWidthCalc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowContainerCtrl=e.center})}getPreferredWidthForColumn(e,t){const r=this.getHeaderCellForColumn(e);if(!r)return-1;const n=this.beans.rowRenderer.getAllCellsNotSpanningForColumn(e);return t||n.push(r),this.getPreferredWidthForElements(n)}getPreferredWidthForColumnGroup(e){const t=this.getHeaderCellForColumn(e);return t?this.getPreferredWidthForElements([t]):-1}getPreferredWidthForElements(e,t){const r=document.createElement("form");r.style.position="fixed";const n=this.centerRowContainerCtrl.eContainer;for(const s of e)this.cloneItemIntoDummy(s,r);n.appendChild(r);const i=r.offsetWidth;return r.remove(),t=t??this.gos.get("autoSizePadding"),i+t}getHeaderCellForColumn(e){let t=null;for(const r of this.beans.ctrlsSvc.getHeaderRowContainerCtrls()){const n=r.getHtmlElementForColumnHeader(e);n!=null&&(t=n)}return t}cloneItemIntoDummy(e,t){const r=e.cloneNode(!0);r.style.width="",r.style.position="static",r.style.left="";const n=document.createElement("div"),i=n.classList;["ag-header-cell","ag-header-group-cell"].some(a=>r.classList.contains(a))?(i.add("ag-header","ag-header-row"),n.style.position="static"):i.add("ag-row");let o=e.parentElement;for(;o;){if(["ag-header-row","ag-row"].some(l=>o.classList.contains(l))){for(let l=0;l<o.classList.length;l++){const c=o.classList[l];c!="ag-row-position-absolute"&&i.add(c)}break}o=o.parentElement}n.appendChild(r),t.appendChild(n)}},vR={moduleName:"AutoWidth",version:wt,beans:[TN]};function kN(e,t,r=!0,n="api"){e.colResize?.setColumnWidths(t,!1,r,n)}var RN=class extends et{constructor(e,t,r,n){super(),this.comp=e,this.eResize=t,this.pinned=r,this.columnGroup=n}postConstruct(){if(!this.columnGroup.isResizable()){this.comp.setResizableDisplayed(!1);return}const{horizontalResizeSvc:e,gos:t,colAutosize:r}=this.beans,n=e.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});this.addDestroyFunc(n),!t.get("suppressAutoSize")&&r&&this.addDestroyFunc(r.addColumnGroupResize(this.eResize,this.columnGroup,()=>this.resizeLeafColumnsToFit("uiColumnResized")))}onResizeStart(e){const{columnsToResize:t,resizeStartWidth:r,resizeRatios:n,groupAfterColumns:i,groupAfterStartWidth:s,groupAfterRatios:o}=this.getInitialValues(e);this.resizeCols=t,this.resizeStartWidth=r,this.resizeRatios=n,this.resizeTakeFromCols=i,this.resizeTakeFromStartWidth=s,this.resizeTakeFromRatios=o,this.toggleColumnResizing(!0)}onResizing(e,t,r="uiColumnResized"){const n=this.normaliseDragChange(t),i=this.resizeStartWidth+n;this.resizeColumnsFromLocalValues(i,r,e)}getInitialValues(e){const t=l=>l.reduce((c,u)=>c+u.getActualWidth(),0),r=(l,c)=>l.map(u=>u.getActualWidth()/c),n=this.getColumnsToResize(),i=t(n),s=r(n,i),o={columnsToResize:n,resizeStartWidth:i,resizeRatios:s};let a=null;if(e&&(a=this.beans.colGroupSvc?.getGroupAtDirection(this.columnGroup,"After")??null),a){const l=a.getDisplayedLeafColumns(),c=o.groupAfterColumns=l.filter(h=>h.isResizable()),u=o.groupAfterStartWidth=t(c);o.groupAfterRatios=r(c,u)}else o.groupAfterColumns=void 0,o.groupAfterStartWidth=void 0,o.groupAfterRatios=void 0;return o}resizeLeafColumnsToFit(e){const t=this.beans.autoWidthCalc.getPreferredWidthForColumnGroup(this.columnGroup),r=this.getInitialValues();t>r.resizeStartWidth&&this.resizeColumns(r,t,e,!0)}resizeColumnsFromLocalValues(e,t,r=!0){if(!this.resizeCols||!this.resizeRatios)return;const n={columnsToResize:this.resizeCols,resizeStartWidth:this.resizeStartWidth,resizeRatios:this.resizeRatios,groupAfterColumns:this.resizeTakeFromCols,groupAfterStartWidth:this.resizeTakeFromStartWidth,groupAfterRatios:this.resizeTakeFromRatios};this.resizeColumns(n,e,t,r)}resizeColumns(e,t,r,n=!0){const{columnsToResize:i,resizeStartWidth:s,resizeRatios:o,groupAfterColumns:a,groupAfterStartWidth:l,groupAfterRatios:c}=e,u=[];if(u.push({columns:i,ratios:o,width:t}),a){const h=t-s;u.push({columns:a,ratios:c,width:l-h})}this.beans.colResize?.resizeColumnSets({resizeSets:u,finished:n,source:r}),n&&this.toggleColumnResizing(!1)}toggleColumnResizing(e){this.comp.toggleCss("ag-column-resizing",e)}getColumnsToResize(){return this.columnGroup.getDisplayedLeafColumns().filter(t=>t.isResizable())}normaliseDragChange(e){let t=e;return this.gos.get("enableRtl")?this.pinned!=="left"&&(t*=-1):this.pinned==="right"&&(t*=-1),t}destroy(){super.destroy(),this.resizeCols=void 0,this.resizeRatios=void 0,this.resizeTakeFromCols=void 0,this.resizeTakeFromRatios=void 0}},AN=class extends et{constructor(e,t,r,n,i){super(),this.pinned=e,this.column=t,this.eResize=r,this.comp=n,this.ctrl=i}postConstruct(){const e=[];let t,r;const n=()=>{if(Gr(this.eResize,t),!t)return;const{horizontalResizeSvc:o,colAutosize:a}=this.beans,l=o.addResizeBar({eResizeBar:this.eResize,onResizeStart:this.onResizeStart.bind(this),onResizing:this.onResizing.bind(this,!1),onResizeEnd:this.onResizing.bind(this,!0)});e.push(l),r&&a&&e.push(a.addColumnAutosizeListeners(this.eResize,this.column))},i=()=>{for(const o of e)o();e.length=0},s=()=>{const o=this.column.isResizable(),a=!this.gos.get("suppressAutoSize")&&!this.column.getColDef().suppressAutoSize;(o!==t||a!==r)&&(t=o,r=a,i(),n())};s(),this.addDestroyFunc(i),this.ctrl.setRefreshFunction("resize",s)}onResizing(e,t){const{column:r,lastResizeAmount:n,resizeStartWidth:i,beans:s}=this,o=this.normaliseResizeAmount(t),a=i+o,l=[{key:r,newWidth:a}],{pinnedCols:c,ctrlsSvc:u,colResize:h}=s;if(this.column.getPinned()){const d=c?.leftWidth??0,f=c?.rightWidth??0,m=cf(u.getGridBodyCtrl().eBodyViewport)-50;if(d+f+(o-n)>m)return}this.lastResizeAmount=o,h?.setColumnWidths(l,this.resizeWithShiftKey,e,"uiColumnResized"),e&&this.toggleColumnResizing(!1)}onResizeStart(e){this.resizeStartWidth=this.column.getActualWidth(),this.lastResizeAmount=0,this.resizeWithShiftKey=e,this.toggleColumnResizing(!0)}toggleColumnResizing(e){this.column.resizing=e,this.comp.toggleCss("ag-column-resizing",e)}normaliseResizeAmount(e){let t=e;const r=this.pinned!=="left",n=this.pinned==="right";return this.gos.get("enableRtl")?r&&(t*=-1):n&&(t*=-1),t}},FN=class extends et{constructor(){super(...arguments),this.beanName="colResize"}setColumnWidths(e,t,r,n){const i=[],{colModel:s,gos:o,visibleCols:a}=this.beans;for(const l of e){const c=s.getColDefCol(l.key)||s.getCol(l.key);if(!c)continue;if(i.push({width:l.newWidth,ratios:[1],columns:[c]}),o.get("colResizeDefault")==="shift"&&(t=!t),t){const h=a.getColAfter(c);if(!h)continue;const d=c.getActualWidth()-l.newWidth,f=h.getActualWidth()+d;i.push({width:f,ratios:[1],columns:[h]})}}i.length!==0&&this.resizeColumnSets({resizeSets:i,finished:r,source:n})}resizeColumnSets(e){const{resizeSets:t,finished:r,source:n}=e;if(!(!t||t.every(u=>MN(u)))){if(r){const u=t&&t.length>0?t[0].columns:null;cd(this.eventSvc,u,r,n)}return}const s=[],o=[];for(const u of t){const{width:h,columns:d,ratios:f}=u,m={},v={};for(const y of d)o.push(y);let g=!0,w=0;for(;g;){if(w++,w>1e3){Ar(31);break}g=!1;const y=[];let C=0,k=h;d.forEach((I,N)=>{if(v[I.getId()])k-=m[I.getId()];else{y.push(I);const L=f[N];C+=L}});const F=1/C;y.forEach((I,N)=>{const j=N===y.length-1;let L;j?L=k:(L=Math.round(f[N]*h*F),k-=L);const W=I.getMinWidth(),K=I.getMaxWidth();L<W?(L=W,v[I.getId()]=!0,g=!0):K>0&&L>K&&(L=K,v[I.getId()]=!0,g=!0),m[I.getId()]=L})}for(const y of d){const C=m[y.getId()];y.getActualWidth()!==C&&(y.setActualWidth(C,n),s.push(y))}}const a=s.length>0;let l=[];if(a){const{colFlex:u,visibleCols:h,colViewport:d}=this.beans;l=u?.refreshFlexedColumns({resizingCols:o,skipSetLeft:!0})??[],h.setLeftValues(n),h.updateBodyWidths(),d.checkViewportColumns()}const c=o.concat(l);(a||r)&&cd(this.eventSvc,c,r,n,l)}resizeHeader(e,t,r){if(!e.isResizable())return;const n=e.getActualWidth(),i=e.getMinWidth(),s=e.getMaxWidth(),o=Math.min(Math.max(n+t,i),s);this.setColumnWidths([{key:e,newWidth:o}],r,!0,"uiColumnResized")}createResizeFeature(e,t,r,n,i){return new AN(e,t,r,n,i)}createGroupResizeFeature(e,t,r,n){return new RN(e,t,r,n)}};function MN(e){const{columns:t,width:r}=e;let n=0,i=0,s=!0;for(const l of t){const c=l.getMinWidth();n+=c||0;const u=l.getMaxWidth();u>0?i+=u:s=!1}const o=r>=n,a=!s||r<=i;return o&&a}var DN={moduleName:"ColumnResize",version:wt,beans:[FN],apiFunctions:{setColumnWidths:kN},dependsOn:[nN,vR]},PN=class extends et{constructor(e,t){super(),this.removeChildListenersFuncs=[],this.columnGroup=t,this.comp=e}postConstruct(){this.addListenersToChildrenColumns(),this.addManagedListeners(this.columnGroup,{displayedChildrenChanged:this.onDisplayedChildrenChanged.bind(this)}),this.onWidthChanged(),this.addDestroyFunc(this.removeListenersOnChildrenColumns.bind(this))}addListenersToChildrenColumns(){this.removeListenersOnChildrenColumns();const e=this.onWidthChanged.bind(this);for(const t of this.columnGroup.getLeafColumns())t.__addEventListener("widthChanged",e),t.__addEventListener("visibleChanged",e),this.removeChildListenersFuncs.push(()=>{t.__removeEventListener("widthChanged",e),t.__removeEventListener("visibleChanged",e)})}removeListenersOnChildrenColumns(){for(const e of this.removeChildListenersFuncs)e();this.removeChildListenersFuncs=[]}onDisplayedChildrenChanged(){this.addListenersToChildrenColumns(),this.onWidthChanged()}onWidthChanged(){const e=this.columnGroup.getActualWidth();this.comp.setWidth(`${e}px`),this.comp.toggleCss("ag-hidden",e===0)}},IN=class extends Ly{constructor(){super(...arguments),this.onSuppressColMoveChange=()=>{!this.isAlive()||this.isSuppressMoving()?this.removeDragSource():this.dragSource||this.setDragSource(this.eGui)}}wireComp(e,t,r,n,i){const{column:s,beans:o}=this,{context:a,colNames:l,colHover:c,rangeSvc:u,colResize:h}=o;this.comp=e,i=Vf(this,a,i),this.setGui(t,i),this.displayName=l.getDisplayNameForColumnGroup(s,"header"),this.refreshHeaderStyles(),this.addClasses(),this.setupMovingCss(i),this.setupExpandable(i),this.setupTooltip(),this.refreshAnnouncement(),this.setupAutoHeight({wrapperElement:n,compBean:i}),this.setupUserComp(),this.addHeaderMouseListeners(i,n),this.addManagedPropertyListener("groupHeaderHeight",this.refreshMaxHeaderHeight.bind(this)),this.refreshMaxHeaderHeight();const d=this.rowCtrl.pinned,f=s.getProvidedColumnGroup().getLeafColumns();c?.createHoverFeature(i,f,t),u?.createRangeHighlightFeature(i,s,e),i.createManagedBean(new Ny(s,t,o)),i.createManagedBean(new PN(e,s)),h?this.resizeFeature=i.createManagedBean(h.createGroupResizeFeature(e,r,d,s)):e.setResizableDisplayed(!1),i.createManagedBean(new zf(t,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:()=>{},handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)})),this.addHighlightListeners(i,f),this.addManagedEventListeners({cellSelectionChanged:()=>this.refreshAnnouncement()}),i.addManagedPropertyListener("suppressMovableColumns",this.onSuppressColMoveChange),this.addResizeAndMoveKeyboardListeners(i),i.addDestroyFunc(()=>this.clearComponent())}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.getDefinition();return Dt(t.gos,{colDef:r,columnGroup:e,floatingFilter:!1})}refreshMaxHeaderHeight(){const{gos:e,comp:t}=this,r=e.get("groupHeaderHeight");r!=null?r===0?t.setHeaderWrapperHidden(!0):t.setHeaderWrapperMaxHeight(r):(t.setHeaderWrapperHidden(!1),t.setHeaderWrapperMaxHeight(null))}addHighlightListeners(e,t){if(this.beans.gos.get("suppressMoveWhenColumnDragging"))for(const r of t)e.addManagedListeners(r,{headerHighlightChanged:this.onLeafColumnHighlightChanged.bind(this,r)})}onLeafColumnHighlightChanged(e){const t=this.column.getDisplayedLeafColumns(),r=t[0]===e,n=zr(t)===e;if(!r&&!n)return;const i=e.getHighlighted(),s=!!this.rowCtrl.getHeaderCellCtrls().find(l=>l.column.isMoving());let o=!1,a=!1;if(s){const l=this.beans.gos.get("enableRtl"),c=i===1,u=i===0;r&&(l?a=c:o=u),n&&(l?o=u:a=c)}this.comp.toggleCss("ag-header-highlight-before",o),this.comp.toggleCss("ag-header-highlight-after",a)}resizeHeader(e,t){const{resizeFeature:r}=this;if(!r)return;const n=r.getInitialValues(t);r.resizeColumns(n,n.resizeStartWidth+e,"uiColumnResized",!0)}resizeLeafColumnsToFit(e){this.resizeFeature?.resizeLeafColumnsToFit(e)}setupUserComp(){const{colGroupSvc:e,userCompFactory:t,gos:r,enterpriseMenuFactory:n}=this.beans,i=this.column,s=i.getProvidedColumnGroup(),o=Dt(r,{displayName:this.displayName,columnGroup:i,setExpanded:l=>{e.setColumnGroupOpened(s,l,"gridInitializing")},setTooltip:(l,c)=>{r.assertModuleRegistered("Tooltip",3),this.setupTooltip(l,c)},showColumnMenu:(l,c)=>n?.showMenuAfterButtonClick(s,l,"columnMenu",c),showColumnMenuAfterMouseClick:(l,c)=>n?.showMenuAfterMouseEvent(s,l,"columnMenu",c),eGridHeader:this.eGui}),a=GP(t,o);a&&this.comp.setUserCompDetails(a)}addHeaderMouseListeners(e,t){const{column:r,comp:n,beans:{rangeSvc:i},gos:s}=this,o=u=>this.handleMouseOverChange(u.type==="mouseenter"),a=()=>this.dispatchColumnMouseEvent("columnHeaderClicked",r.getProvidedColumnGroup()),l=u=>this.handleContextMenuMouseEvent(u,void 0,r.getProvidedColumnGroup());e.addManagedListeners(this.eGui,{mouseenter:o,mouseleave:o,click:a,contextmenu:l}),n.toggleCss("ag-header-group-cell-selectable",$u(s));const c=i?.createHeaderGroupCellMouseListenerFeature(this.column,t);c&&this.createManagedBean(c)}handleMouseOverChange(e){this.eventSvc.dispatchEvent({type:e?"columnHeaderMouseOver":"columnHeaderMouseLeave",column:this.column.getProvidedColumnGroup()})}setupTooltip(e,t){this.tooltipFeature=this.beans.tooltipSvc?.setupHeaderGroupTooltip(this.tooltipFeature,this,e,t)}setupExpandable(e){const t=this.column.getProvidedColumnGroup();this.refreshExpanded();const r=this.refreshExpanded.bind(this);e.addManagedListeners(t,{expandedChanged:r,expandableChanged:r})}refreshExpanded(){const{column:e}=this;this.expandable=e.isExpandable();const t=e.isExpanded();this.expandable?this.comp.setAriaExpanded(t?"true":"false"):this.comp.setAriaExpanded(void 0),this.refreshHeaderStyles()}addClasses(){const{column:e}=this,t=e.getColGroupDef(),r=rR(t,this.gos,null,e);e.isPadding()?(r.push("ag-header-group-cell-no-group"),e.getLeafColumns().every(i=>i.isSpanHeaderHeight())&&r.push("ag-header-span-height")):(r.push("ag-header-group-cell-with-group"),t?.wrapHeaderText&&r.push("ag-header-cell-wrap-text"));for(const n of r)this.comp.toggleCss(n,!0)}setupMovingCss(e){const{column:t}=this,n=t.getProvidedColumnGroup().getLeafColumns(),i=()=>this.comp.toggleCss("ag-header-cell-moving",t.isMoving());for(const s of n)e.addManagedListeners(s,{movingChanged:i});i()}onFocusIn(e){this.eGui.contains(e.relatedTarget)||(this.focusThis(),this.announceAriaDescription())}handleKeyDown(e){if(super.handleKeyDown(e),!this.getWrapperHasFocus())return;const{column:r,expandable:n,gos:i,beans:s}=this,o=$u(i);if(e.key==$e.ENTER){if(o&&!e.altKey)s.rangeSvc?.handleColumnSelection(r,e);else if(n){const a=!r.isExpanded();s.colGroupSvc.setColumnGroupOpened(r.getProvidedColumnGroup(),a,"uiColumnExpanded")}}}refreshAnnouncement(){let e;const{gos:t,column:r,beans:n}=this;if($u(t)){const s=this.getLocaleTextFunc(),o=n.rangeSvc?.isColumnInAnyRange(r);e=s("ariaColumnCellSelection",`Press CTRL+SPACE to ${o?"de":""}select all visible cells in this column group`)}this.ariaAnnouncement=e}announceAriaDescription(){const{beans:e,eGui:t,ariaAnnouncement:r}=this;!r||!t.contains(tn(e))||e.ariaAnnounce?.announceValue(r,"columnHeader")}setDragSource(e){!this.isAlive()||this.isSuppressMoving()||(this.removeDragSource(),e&&(this.dragSource=this.beans.colMoves?.setDragSourceForHeader(e,this.column,this.displayName)??null))}isSuppressMoving(){return this.gos.get("suppressMovableColumns")||this.column.getLeafColumns().some(e=>e.getColDef().suppressMovable||e.getColDef().lockPosition)}destroy(){this.tooltipFeature=this.destroyBean(this.tooltipFeature),super.destroy()}};function ON(e,t,r){e.colGroupSvc?.setColumnGroupOpened(t,r,"api")}function NN(e,t,r){return e.colGroupSvc?.getColumnGroup(t,r)??null}function LN(e,t){return e.colGroupSvc?.getProvidedColGroup(t)??null}function BN(e,t,r){return e.colNames.getDisplayNameForColumnGroup(t,r)||""}function HN(e){return e.colGroupSvc?.getColumnGroupState()??[]}function jN(e,t){e.colGroupSvc?.setColumnGroupState(t,"api")}function VN(e){e.colGroupSvc?.resetColumnGroupState("api")}function GN(e){return e.visibleCols.treeLeft}function zN(e){return e.visibleCols.treeCenter}function UN(e){return e.visibleCols.treeRight}function WN(e){return e.visibleCols.getAllTrees()}function $N(e,t){for(let r=0;r<t.length;r++){const n=e.indexOf(t[r]);n>=0&&(e[n]=e[e.length-1],e.pop())}}var qN=class extends et{constructor(){super(...arguments),this.beanName="visibleCols",this.colsAndGroupsMap={},this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.headerGroupRowCount=0,this.bodyWidth=0,this.leftWidth=0,this.rightWidth=0,this.isBodyWidthDirty=!0}refresh(e,t=!1){const{colFlex:r,colModel:n,colGroupSvc:i,colViewport:s,selectionColSvc:o}=this.beans;t||this.buildTrees(n,i),i?.updateOpenClosedVisibility(),this.leftCols=ub(this.treeLeft),this.centerCols=ub(this.treeCenter),this.rightCols=ub(this.treeRight),o?.refreshVisibility(this.leftCols,this.centerCols,this.rightCols),this.joinColsAriaOrder(n),this.joinCols(),this.headerGroupRowCount=this.getHeaderRowCount(),this.setLeftValues(e),this.autoHeightCols=this.allCols.filter(a=>a.isAutoHeight()),r?.refreshFlexedColumns(),this.updateBodyWidths(),this.setFirstRightAndLastLeftPinned(n,this.leftCols,this.rightCols,e),s.checkViewportColumns(!1),this.eventSvc.dispatchEvent({type:"displayedColumnsChanged",source:e})}getHeaderRowCount(){if(!this.gos.get("hidePaddedHeaderRows"))return this.beans.colModel.cols.treeDepth;let e=0;for(const t of this.allCols){let r=t.getParent();for(;r;){if(!r.isPadding()){const n=r.getProvidedColumnGroup().getLevel()+1;n>e&&(e=n);break}r=r.getParent()}}return e}updateBodyWidths(){const e=Yo(this.centerCols),t=Yo(this.leftCols),r=Yo(this.rightCols);this.isBodyWidthDirty=this.bodyWidth!==e,(this.bodyWidth!==e||this.leftWidth!==t||this.rightWidth!==r)&&(this.bodyWidth=e,this.leftWidth=t,this.rightWidth=r,this.eventSvc.dispatchEvent({type:"columnContainerWidthChanged"}),this.eventSvc.dispatchEvent({type:"displayedColumnsWidthChanged"}))}setLeftValues(e){this.setLeftValuesOfCols(e),this.setLeftValuesOfGroups()}setFirstRightAndLastLeftPinned(e,t,r,n){let i,s;this.gos.get("enableRtl")?(i=t?t[0]:null,s=r?zr(r):null):(i=t?zr(t):null,s=r?r[0]:null);for(const o of e.getCols())o.setLastLeftPinned(o===i,n),o.setFirstRightPinned(o===s,n)}buildTrees(e,t){const r=e.getColsToShow(),n=r.filter(l=>l.getPinned()=="left"),i=r.filter(l=>l.getPinned()=="right"),s=r.filter(l=>l.getPinned()!="left"&&l.getPinned()!="right"),o=new pk,a=l=>t?t.createColumnGroups(l):l.columns;this.treeLeft=a({columns:n,idCreator:o,pinned:"left",oldDisplayedGroups:this.treeLeft}),this.treeRight=a({columns:i,idCreator:o,pinned:"right",oldDisplayedGroups:this.treeRight}),this.treeCenter=a({columns:s,idCreator:o,pinned:null,oldDisplayedGroups:this.treeCenter}),this.updateColsAndGroupsMap()}clear(){this.leftCols=[],this.rightCols=[],this.centerCols=[],this.allCols=[],this.ariaOrderColumns=[]}joinColsAriaOrder(e){const t=e.getCols(),r=[],n=[],i=[];for(const s of t){const o=s.getPinned();o?o===!0||o==="left"?r.push(s):i.push(s):n.push(s)}this.ariaOrderColumns=r.concat(n).concat(i)}getAriaColIndex(e){let t;return yn(e)?t=e.getLeafColumns()[0]:t=e,this.ariaOrderColumns.indexOf(t)+1}setLeftValuesOfGroups(){for(const e of[this.treeLeft,this.treeRight,this.treeCenter])for(const t of e)yn(t)&&t.checkLeft()}setLeftValuesOfCols(e){const{colModel:t}=this.beans;if(!t.getColDefCols())return;const n=t.getCols().slice(0),i=this.gos.get("enableRtl");for(const s of[this.leftCols,this.rightCols,this.centerCols]){if(i){let o=Yo(s);for(const a of s)o-=a.getActualWidth(),a.setLeft(o,e)}else{let o=0;for(const a of s)a.setLeft(o,e),o+=a.getActualWidth()}$N(n,s)}for(const s of n)s.setLeft(null,e)}joinCols(){this.gos.get("enableRtl")?this.allCols=this.rightCols.concat(this.centerCols).concat(this.leftCols):this.allCols=this.leftCols.concat(this.centerCols).concat(this.rightCols)}getAllTrees(){return this.treeLeft&&this.treeRight&&this.treeCenter?this.treeLeft.concat(this.treeCenter).concat(this.treeRight):null}isColDisplayed(e){return this.allCols.indexOf(e)>=0}getLeftColsForRow(e){const{leftCols:t,beans:{colModel:r}}=this;return r.colSpanActive?this.getColsForRow(e,t):t}getRightColsForRow(e){const{rightCols:t,beans:{colModel:r}}=this;return r.colSpanActive?this.getColsForRow(e,t):t}getColsForRow(e,t,r,n){const i=[];let s=null;for(let o=0;o<t.length;o++){const a=t[o],l=t.length-o,c=Math.min(a.getColSpan(e),l),u=[a];if(c>1){const d=c-1;for(let f=1;f<=d;f++)u.push(t[o+f]);o+=d}let h;if(r){h=!1;for(const d of u)r(d)&&(h=!0)}else h=!0;h&&(i.length===0&&s&&n&&n(a)&&i.push(s),i.push(a)),s=a}return i}getContainerWidth(e){switch(e){case"left":return this.leftWidth;case"right":return this.rightWidth;default:return this.bodyWidth}}getColBefore(e){const t=this.allCols,r=t.indexOf(e);return r>0?t[r-1]:null}isPinningLeft(){return this.leftCols.length>0}isPinningRight(){return this.rightCols.length>0}updateColsAndGroupsMap(){this.colsAndGroupsMap={};const e=t=>{this.colsAndGroupsMap[t.getUniqueId()]=t};cc(this.treeCenter,!1,e),cc(this.treeLeft,!1,e),cc(this.treeRight,!1,e)}isVisible(e){return this.colsAndGroupsMap[e.getUniqueId()]===e}getFirstColumn(){const e=this.gos.get("enableRtl"),t=["leftCols","centerCols","rightCols"];e&&t.reverse();for(let r=0;r<t.length;r++){const n=this[t[r]];if(n.length)return e?zr(n):n[0]}return null}getColAfter(e){const t=this.allCols,r=t.indexOf(e);return r<t.length-1?t[r+1]:null}getColsLeftWidth(){return Yo(this.leftCols)}getDisplayedColumnsRightWidth(){return Yo(this.rightCols)}isColAtEdge(e,t){const r=this.allCols;if(!r.length)return!1;const n=t==="first";let i;if(yn(e)){const s=e.getDisplayedLeafColumns();if(!s.length)return!1;i=n?s[0]:zr(s)}else i=e;return(n?r[0]:zr(r))===i}};function cc(e,t,r){if(e)for(let n=0;n<e.length;n++){const i=e[n];if(yn(i)){const s=t?i.getDisplayedChildren():i.getChildren();cc(s,t,r)}r(i)}}function ub(e){const t=[];return cc(e,!0,r=>{cl(r)&&t.push(r)}),t}var KN=class extends et{constructor(){super(...arguments),this.beanName="colGroupSvc"}getColumnGroupState(){const e=[],t=this.beans.colModel.getColTree();return ra(null,t,r=>{ci(r)&&e.push({groupId:r.getGroupId(),open:r.isExpanded()})}),e}resetColumnGroupState(e){const t=this.beans.colModel.getColDefColTree();if(!t)return;const r=[];ra(null,t,n=>{if(ci(n)){const i=n.getColGroupDef(),s={groupId:n.getGroupId(),open:i?i.openByDefault:void 0};r.push(s)}}),this.setColumnGroupState(r,e)}setColumnGroupState(e,t){const{colModel:r,colAnimation:n,visibleCols:i,eventSvc:s}=this.beans;if(!r.getColTree().length)return;n?.start();const a=[];for(const l of e){const c=l.groupId,u=l.open,h=this.getProvidedColGroup(c);h&&h.isExpanded()!==u&&(h.setExpanded(u),a.push(h))}i.refresh(t,!0),a.length&&s.dispatchEvent({type:"columnGroupOpened",columnGroup:a.length===1?a[0]:void 0,columnGroups:a}),n?.finish()}setColumnGroupOpened(e,t,r){let n;ci(e)?n=e.getId():n=e||"",this.setColumnGroupState([{groupId:n,open:t}],r)}getProvidedColGroup(e){let t=null;return ra(null,this.beans.colModel.getColTree(),r=>{ci(r)&&r.getId()===e&&(t=r)}),t}getGroupAtDirection(e,t){const r=e.getProvidedColumnGroup().getLevel()+e.getPaddingLevel(),n=e.getDisplayedLeafColumns(),i=t==="After"?zr(n):n[0],s=`getCol${t}`;for(;;){const o=this.beans.visibleCols[s](i);if(!o)return null;const a=this.getColGroupAtLevel(o,r);if(a!==e)return a}}getColGroupAtLevel(e,t){let r=e.getParent(),n,i;for(;n=r.getProvidedColumnGroup().getLevel(),i=r.getPaddingLevel(),!(n+i<=t);)r=r.getParent();return r}updateOpenClosedVisibility(){const e=this.beans.visibleCols.getAllTrees();cc(e,!1,t=>{yn(t)&&t.calculateDisplayedColumns()})}getColumnGroup(e,t){if(!e)return null;if(yn(e))return e;const r=this.beans.visibleCols.getAllTrees(),n=typeof t=="number";let i=null;return cc(r,!1,s=>{if(yn(s)){const o=s;let a;n?a=e===o.getGroupId()&&t===o.getPartId():a=e===o.getGroupId(),a&&(i=o)}}),i}createColumnGroups(e){const{columns:t,idCreator:r,pinned:n,oldDisplayedGroups:i,isStandaloneStructure:s}=e,o=this.mapOldGroupsById(i),a=[];let l=t;for(;l.length;){const c=l;l=[];let u=0;const h=d=>{const f=u;u=d;const m=c[f],g=(yn(m)?m.getProvidedColumnGroup():m).getOriginalParent();if(g==null){for(let y=f;y<d;y++)a.push(c[y]);return}const w=this.createColumnGroup(g,r,o,n,s);for(let y=f;y<d;y++)w.addChild(c[y]);l.push(w)};for(let d=1;d<c.length;d++){const f=c[d],v=(yn(f)?f.getProvidedColumnGroup():f).getOriginalParent(),g=c[u],y=(yn(g)?g.getProvidedColumnGroup():g).getOriginalParent();v!==y&&h(d)}u<c.length&&h(c.length)}return s||this.setupParentsIntoCols(a,null),a}createProvidedColumnGroup(e,t,r,n,i,s,o){const a=i.getUniqueKey(t.groupId||null,null),l=$_(this.beans,t,a),c=new Jg(l,a,!1,r);this.createBean(c);const u=this.findExistingGroup(t,s);u&&s.splice(u.idx,1);const h=u?.group;h&&c.setExpanded(h.isExpanded());const d=ok(this.beans,l.children,r+1,e,n,i,s,o);return c.setChildren(d),c}balanceColumnTree(e,t,r,n){const i=[];for(let s=0;s<e.length;s++){const o=e[s];if(ci(o)){const a=o,l=this.balanceColumnTree(a.getChildren(),t+1,r,n);a.setChildren(l),i.push(a)}else{let a,l;for(let c=t;c<r;c++){const u=n.getUniqueKey(null,null),h=$_(this.beans,null,u),d=new Jg(h,u,!0,c);this.createBean(d),l&&l.setChildren([d]),l=d,a||(a=l)}if(a&&l)if(i.push(a),e.some(u=>ci(u))){l.setChildren([o]);continue}else{l.setChildren(e);break}i.push(o)}}return i}findDepth(e){let t=0,r=e;for(;r?.[0]&&ci(r[0]);)t++,r=r[0].getChildren();return t}findMaxDepth(e,t){let r=t;for(let n=0;n<e.length;n++){const i=e[n];if(ci(i)){const s=i,o=this.findMaxDepth(s.getChildren(),t+1);r<o&&(r=o)}}return r}balanceTreeForAutoCols(e,t){const r=[];for(const n of e){let i=n;for(let s=t-1;s>=0;s--){const o=new Jg(null,`FAKE_PATH_${n.getId()}}_${s}`,!0,s);this.createBean(o),o.setChildren([i]),i.originalParent=o,i=o}t===0&&(n.originalParent=null),r.push(i)}return r}findExistingGroup(e,t){if(e.groupId!=null)for(let n=0;n<t.length;n++){const i=t[n];if(i.getColGroupDef()&&i.getId()===e.groupId)return{idx:n,group:i}}}createColumnGroup(e,t,r,n,i){const s=e.getGroupId(),o=t.getInstanceIdForKey(s),a=Gk(s,o);let l=r[a];return l&&l.getProvidedColumnGroup()!==e&&(l=null),bt(l)?l.reset():(l=new gf(e,s,o,n),i||this.createBean(l)),l}mapOldGroupsById(e){const t={},r=n=>{for(const i of n)if(yn(i)){const s=i;t[i.getUniqueId()]=s,r(s.getChildren())}};return e&&r(e),t}setupParentsIntoCols(e,t){for(const r of e??[])if(r.parent!==t&&(this.beans.colViewport.colsWithinViewportHash=""),r.parent=t,yn(r)){const n=r;this.setupParentsIntoCols(n.getChildren(),n)}}},XN={moduleName:"ColumnGroup",version:wt,dynamicBeans:{headerGroupCellCtrl:IN},beans:[KN],apiFunctions:{getAllDisplayedColumnGroups:WN,getCenterDisplayedColumnGroups:zN,getColumnGroup:NN,getColumnGroupState:HN,getDisplayNameForColumnGroup:BN,getLeftDisplayedColumnGroups:GN,getProvidedColumnGroup:LN,getRightDisplayedColumnGroups:UN,resetColumnGroupState:VN,setColumnGroupOpened:ON,setColumnGroupState:jN}},YN={tag:"div",cls:"ag-skeleton-container"},ZN=class extends pn{constructor(){super(YN)}init(t){const r=`ag-cell-skeleton-renderer-${this.getCompId()}`;this.getGui().setAttribute("id",r),this.addDestroyFunc(()=>af(t.eParentOfValue)),af(t.eParentOfValue,r),t.deferRender?this.setupLoading(t):t.node.failedLoad?this.setupFailed():this.setupLoading(t)}setupFailed(){const t=this.getLocaleTextFunc();this.getGui().textContent=t("loadingError","ERR");const r=t("ariaSkeletonCellLoadingFailed","Row failed to load");ad(this.getGui(),r)}setupLoading(t){const r=ks({tag:"div",cls:"ag-skeleton-effect"}),n=t.node.rowIndex;if(n!=null){const o=75+25*(n%2===0?Math.sin(n):Math.cos(n));r.style.width=`${o}%`}this.getGui().appendChild(r);const i=this.getLocaleTextFunc(),s=t.deferRender?i("ariaDeferSkeletonCellLoading","Cell is loading"):i("ariaSkeletonCellLoading","Row data is loading");ad(this.getGui(),s)}refresh(t){return!1}},JN={moduleName:"CheckboxCellRenderer",version:wt,userComponents:{agCheckboxCellRenderer:iO}},QN={moduleName:"SkeletonCellRenderer",version:wt,userComponents:{agSkeletonCellRenderer:ZN}};function eL(e,t){const r=e.colModel.getColDefCol(t);return r?r.getColDef():null}function tL(e){return e.colModel.getColumnDefs(!0)}function rL(e,t,r){return e.colNames.getDisplayNameForColumn(t,r)||""}function nL(e,t){return e.colModel.getColDefCol(t)}function iL(e){return e.colModel.getColDefCols()}function sL(e,t){return Ws(e,t,"api")}function oL(e){return C0(e)}function aL(e){gP(e,"api")}function lL(e){return e.visibleCols.isPinningLeft()||e.visibleCols.isPinningRight()}function cL(e){return e.visibleCols.isPinningLeft()}function uL(e){return e.visibleCols.isPinningRight()}function dL(e,t){return e.visibleCols.getColAfter(t)}function hL(e,t){return e.visibleCols.getColBefore(t)}function fL(e,t,r){e.colModel.setColsVisible(t,r,"api")}function pL(e,t,r){e.pinnedCols?.setColsPinned(t,r,"api")}function gL(e){return e.colModel.getCols()}function mL(e){return e.visibleCols.leftCols}function vL(e){return e.visibleCols.centerCols}function bL(e){return e.visibleCols.rightCols}function wL(e){return e.visibleCols.allCols}function yL(e){return e.colViewport.getViewportColumns()}function yw(e,t){if(!e)return;const r=e,n={};for(const i of Object.keys(r)){if(t&&t.indexOf(i)>=0||IT.has(i))continue;const s=r[i];typeof s=="object"&&s!==null&&s.constructor===Object?n[i]=yw(s):n[i]=s}return n}var CL=class extends et{constructor(){super(...arguments),this.beanName="colDefFactory"}wireBeans(e){this.rowGroupColsSvc=e.rowGroupColsSvc,this.pivotColsSvc=e.pivotColsSvc}getColumnDefs(e,t,r,n,i=!1){const s=e.slice();t?s.sort((l,c)=>r.indexOf(l)-r.indexOf(c)):(r||i)&&s.sort((l,c)=>n.indexOf(l)-n.indexOf(c));const o=this.rowGroupColsSvc?.columns,a=this.pivotColsSvc?.columns;return this.buildColumnDefs(s,o,a)}buildColumnDefs(e,t=[],r=[]){const n=[],i={};for(const s of e){const o=this.createDefFromColumn(s,t,r);let a=!0,l=o,c=s.getOriginalParent(),u=null;for(;c;){let h=null;if(c.isPadding()){c=c.getOriginalParent();continue}const d=i[c.getGroupId()];if(d){d.children.push(l),a=!1;break}if(h=this.createDefFromGroup(c),h&&(h.children=[l],i[h.groupId]=h,l=h,c=c.getOriginalParent()),c!=null&&u===c){a=!1;break}u=c}a&&n.push(l)}return n}createDefFromGroup(e){const t=yw(e.getColGroupDef(),["children"]);return t&&(t.groupId=e.getGroupId()),t}createDefFromColumn(e,t,r){const n=yw(e.getColDef());return n.colId=e.getColId(),n.width=e.getActualWidth(),n.rowGroup=e.isRowGroupActive(),n.rowGroupIndex=e.isRowGroupActive()?t.indexOf(e):null,n.pivot=e.isPivotActive(),n.pivotIndex=e.isPivotActive()?r.indexOf(e):null,n.aggFunc=e.isValueActive()?e.getAggFunc():null,n.hide=e.isVisible()?void 0:!0,n.pinned=e.isPinned()?e.getPinned():null,n.sort=e.getSortDef(),n.sortIndex=e.getSortIndex()!=null?e.getSortIndex():null,n}},xL=class extends et{constructor(){super(...arguments),this.beanName="colFlex",this.columnsHidden=!1}refreshFlexedColumns(e={}){const t=e.source??"flex";e.viewportWidth!=null&&(this.flexViewportWidth=e.viewportWidth);const r=this.flexViewportWidth,{visibleCols:n,colDelayRenderSvc:i}=this.beans,s=n.centerCols;let o=-1;if(e.resizingCols){const v=new Set(e.resizingCols);for(let g=s.length-1;g>=0;g--)if(v.has(s[g])){o=g;break}}let a=!1;const l=s.map((v,g)=>{const w=v.getFlex(),y=w!=null&&w>0&&g>o;return a||(a=y),{col:v,isFlex:y,flex:Math.max(0,w??0),initialSize:v.getActualWidth(),min:v.getMinWidth(),max:v.getMaxWidth(),targetSize:0}});if(a?(i?.hideColumns("colFlex"),this.columnsHidden=!0):this.columnsHidden&&this.revealColumns(i),!r||!a)return[];let c=l.length,u=l.reduce((v,g)=>v+g.flex,0),h=r;const d=(v,g)=>{v.frozenSize=g,v.col.setActualWidth(g,t),h-=g,u-=v.flex,c-=1},f=v=>v.frozenSize!=null;for(const v of l)v.isFlex||d(v,v.initialSize);for(;c>0;){const v=Math.round(u<1?h*u:h);let g,w=0,y=0;for(const F of l){if(f(F))continue;g=F,y+=v*(F.flex/u);const I=y-w,N=Math.round(I);F.targetSize=N,w+=N}g&&(g.targetSize+=v-w);let C=0;for(const F of l){if(f(F))continue;const I=F.targetSize,N=Math.min(Math.max(I,F.min),F.max);C+=N-I,F.violationType=N===I?void 0:N<I?"max":"min",F.targetSize=N}const k=C===0?"all":C>0?"min":"max";for(const F of l)f(F)||(k==="all"||F.violationType===k)&&d(F,F.targetSize)}e.skipSetLeft||n.setLeftValues(t),e.updateBodyWidths&&n.updateBodyWidths();const m=l.filter(v=>v.isFlex&&!v.violationType).map(v=>v.col);if(e.fireResizedEvent){const v=l.filter(w=>w.initialSize!==w.frozenSize).map(w=>w.col),g=l.filter(w=>w.flex).map(w=>w.col);cd(this.eventSvc,v,!0,t,g)}return this.revealColumns(i),m}revealColumns(e){this.columnsHidden&&(e?.revealColumns("colFlex"),this.columnsHidden=!1)}initCol(e){const{flex:t,initialFlex:r}=e.colDef;t!==void 0?e.flex=t:r!==void 0&&(e.flex=r)}setColFlex(e,t){e.flex=t??null,e.dispatchStateUpdatedEvent("flex")}};function Wh(e,t,r){if(!t||!e)return;if(!r)return e[t];const n=t.split(".");let i=e;for(let s=0;s<n.length;s++){if(i==null)return;i=i[n[s]]}return i}var SL=["dateTimeString","dateString","text","number","boolean","date"],_L=class extends et{constructor(){super(...arguments),this.beanName="dataTypeSvc",this.dataTypeDefinitions={},this.isPendingInference=!1,this.isColumnTypeOverrideInDataTypeDefinitions=!1,this.columnStateUpdatesPendingInference={},this.columnStateUpdateListenerDestroyFuncs=[],this.columnDefinitionPropsPerDataType={number(){return{cellEditor:"agNumberCellEditor"}},boolean(){return{cellEditor:"agCheckboxCellEditor",cellRenderer:"agCheckboxCellRenderer",getFindText:()=>null,suppressKeyboardEvent:e=>!!e.colDef.editable&&e.event.key===$e.SPACE}},date({formatValue:e}){return{cellEditor:"agDateCellEditor",keyCreator:e}},dateString({formatValue:e}){return{cellEditor:"agDateStringCellEditor",keyCreator:e}},dateTime(e){return this.date(e)},dateTimeString(e){return this.dateString(e)},object({formatValue:e,colModel:t,colId:r}){return{cellEditorParams:{useFormatter:!0},comparator:(n,i)=>{const s=t.getColDefCol(r),o=s?.getColDef();if(!s||!o)return 0;const a=n==null?"":e({column:s,node:null,value:n}),l=i==null?"":e({column:s,node:null,value:i});return a===l?0:a>l?1:-1},keyCreator:e}},text(){return{}}}}wireBeans(e){this.colModel=e.colModel}postConstruct(){this.processDataTypeDefinitions(),this.addManagedPropertyListener("dataTypeDefinitions",e=>{this.processDataTypeDefinitions(),this.colModel.recreateColumnDefs(e)})}processDataTypeDefinitions(){const e=this.getDefaultDataTypes(),t={},r={},n=u=>h=>{const{column:d,node:f,value:m}=h;let v=d.getColDef().valueFormatter;return v===u.groupSafeValueFormatter&&(v=u.valueFormatter),this.beans.valueSvc.formatValue(d,f,m,v)};for(const u of Object.keys(e)){const h=e[u],d={...h,groupSafeValueFormatter:P4(h,this.gos)};t[u]=d,r[u]=n(d)}const i=this.gos.get("dataTypeDefinitions")??{},s={};for(const u of Object.keys(i)){const h=i[u],d=this.processDataTypeDefinition(h,i,[u],e);d&&(t[u]=d,h.dataTypeMatcher&&(s[u]=h.dataTypeMatcher),r[u]=n(d))}const{valueParser:o,valueFormatter:a}=e.object,{valueParser:l,valueFormatter:c}=t.object;this.hasObjectValueParser=l!==o,this.hasObjectValueFormatter=c!==a,this.formatValueFuncs=r,this.dataTypeDefinitions=t,this.dataTypeMatchers=this.sortKeysInMatchers(s,e)}sortKeysInMatchers(e,t){const r={...e};for(const n of SL)delete r[n],r[n]=e[n]??t[n].dataTypeMatcher;return r}processDataTypeDefinition(e,t,r,n){let i;const s=e.extendsDataType;if(e.columnTypes&&(this.isColumnTypeOverrideInDataTypeDefinitions=!0),e.extendsDataType===e.baseDataType){let o=n[s];const a=t[s];if(o&&a&&(o=a),!D4(e,o,s))return;i=M4(o,e)}else{if(r.includes(s)){at(44);return}const o=t[s];if(!D4(e,o,s))return;const a=this.processDataTypeDefinition(o,t,[...r,s],n);if(!a)return;i=M4(a,e)}return{...i,groupSafeValueFormatter:P4(i,this.gos)}}updateColDefAndGetColumnType(e,t,r){let{cellDataType:n}=t;const{field:i}=t;if(n===void 0&&(n=e.cellDataType),(n==null||n===!0)&&(n=this.canInferCellDataType(e,t)?this.inferCellDataType(i,r):!1),!n){e.cellDataType=!1;return}const s=this.dataTypeDefinitions[n];if(!s){at(47,{cellDataType:n});return}return e.cellDataType=n,s.groupSafeValueFormatter&&(e.valueFormatter=s.groupSafeValueFormatter),s.valueParser&&(e.valueParser=s.valueParser),s.suppressDefaultProperties||this.setColDefPropertiesForBaseDataType(e,n,s,r),s.columnTypes}addColumnListeners(e){if(!this.isPendingInference)return;const t=this.columnStateUpdatesPendingInference[e.getColId()];if(!t)return;const r=n=>{t.add(n.key)};e.__addEventListener("columnStateUpdated",r),this.columnStateUpdateListenerDestroyFuncs.push(()=>e.__removeEventListener("columnStateUpdated",r))}canInferCellDataType(e,t){const{gos:r}=this;if(!rn(r))return!1;const n={cellRenderer:!0,valueGetter:!0,valueParser:!0,refData:!0};if(db(t,n))return!1;const i=t.type===null?e.type:t.type;if(i){const s=r.get("columnTypes")??{};if(y0(i).some(a=>{const l=s[a.trim()];return l&&db(l,n)}))return!1}return!db(e,n)}inferCellDataType(e,t){if(!e)return;let r;const n=this.getInitialData();if(n){const s=e.includes(".")&&!this.gos.get("suppressFieldDotNotation");r=Wh(n,e,s)}else this.initWaitForRowData(t);return r==null?void 0:Object.keys(this.dataTypeMatchers).find(s=>this.dataTypeMatchers[s](r))??"object"}getInitialData(){const e=this.gos.get("rowData");if(e?.length)return e[0];if(this.initialData)return this.initialData;{const t=this.beans.rowModel.rootNode?._leafs;if(t?.length)return t[0].data}return null}initWaitForRowData(e){if(this.columnStateUpdatesPendingInference[e]=new Set,this.isPendingInference)return;this.isPendingInference=!0;const t=this.isColumnTypeOverrideInDataTypeDefinitions,{colAutosize:r,eventSvc:n}=this.beans;t&&r&&(r.shouldQueueResizeOperations=!0);const[i]=this.addManagedEventListeners({rowDataUpdateStarted:s=>{const{firstRowData:o}=s;o&&(i?.(),this.isPendingInference=!1,this.processColumnsPendingInference(o,t),this.columnStateUpdatesPendingInference={},t&&r?.processResizeOperations(),n.dispatchEvent({type:"dataTypesInferred"}))}})}processColumnsPendingInference(e,t){this.initialData=e;const r=[];this.destroyColumnStateUpdateListeners();const n={},i={};for(const s of Object.keys(this.columnStateUpdatesPendingInference)){const o=this.columnStateUpdatesPendingInference[s],a=this.colModel.getCol(s);if(!a)return;const l=a.getColDef();if(!this.resetColDefIntoCol(a,"cellDataTypeInferred"))return;const c=a.getColDef();if(t&&c.type&&c.type!==l.type){const u=TL(a,o);u.rowGroup&&u.rowGroupIndex==null&&(n[s]=u),u.pivot&&u.pivotIndex==null&&(i[s]=u),r.push(u)}}t&&r.push(...this.generateColumnStateForRowGroupAndPivotIndexes(n,i)),r.length&&Ws(this.beans,{state:r},"cellDataTypeInferred"),this.initialData=null}generateColumnStateForRowGroupAndPivotIndexes(e,t){const r={},{rowGroupColsSvc:n,pivotColsSvc:i}=this.beans;return n?.restoreColumnOrder(r,e),i?.restoreColumnOrder(r,t),Object.values(r)}resetColDefIntoCol(e,t){const r=e.getUserProvidedColDef();if(!r)return!1;const n=iw(this.beans,r,e.getColId());return e.setColDef(n,r,t),!0}getDateStringTypeDefinition(e){const{dateString:t}=this.dataTypeDefinitions;return e?this.getDataTypeDefinition(e)??t:t}getDateParserFunction(e){return this.getDateStringTypeDefinition(e).dateParser}getDateFormatterFunction(e){return this.getDateStringTypeDefinition(e).dateFormatter}getDateIncludesTimeFlag(e){return e==="dateTime"||e==="dateTimeString"}getDataTypeDefinition(e){const t=e.getColDef();if(t.cellDataType)return this.dataTypeDefinitions[t.cellDataType]}getBaseDataType(e){return this.getDataTypeDefinition(e)?.baseDataType}checkType(e,t){if(t==null)return!0;const r=this.getDataTypeDefinition(e)?.dataTypeMatcher;return!r||e.getColDef().allowFormula&&this.beans.formula?.isFormula(t)?!0:r(t)}validateColDef(e){const t=r=>at(48,{property:r});if(e.cellDataType==="object"){const{object:r}=this.dataTypeDefinitions;e.valueFormatter===r.groupSafeValueFormatter&&!this.hasObjectValueFormatter&&t("Formatter"),e.editable&&e.valueParser===r.valueParser&&!this.hasObjectValueParser&&t("Parser")}}postProcess(e){const t=e.cellDataType;if(!t||typeof t!="string")return;const{dataTypeDefinitions:r,beans:n,formatValueFuncs:i}=this,s=r[t];s&&n.colFilter?.setColDefPropsForDataType(e,s,i[t])}getFormatValue(e){return this.formatValueFuncs[e]}isColPendingInference(e){return this.isPendingInference&&!!this.columnStateUpdatesPendingInference[e]}setColDefPropertiesForBaseDataType(e,t,r,n){const i=this.formatValueFuncs[t],s=this.columnDefinitionPropsPerDataType[r.baseDataType]({colDef:e,cellDataType:t,colModel:this.colModel,dataTypeDefinition:r,colId:n,formatValue:i});Object.assign(e,s)}getDateObjectTypeDef(e){const t=this.getLocaleTextFunc(),r=this.getDateIncludesTimeFlag(e);return{baseDataType:e,valueParser:n=>ji(n.newValue&&String(n.newValue)),valueFormatter:n=>n.value==null?"":!(n.value instanceof Date)||isNaN(n.value.getTime())?t("invalidDate","Invalid Date"):ns(n.value,r)??"",dataTypeMatcher:n=>n instanceof Date}}getDateStringTypeDef(e){const t=this.getDateIncludesTimeFlag(e);return{baseDataType:e,dateParser:r=>ji(r)??void 0,dateFormatter:r=>ns(r??null,t)??void 0,valueParser:r=>Qg(String(r.newValue))?r.newValue:null,valueFormatter:r=>Qg(String(r.value))?String(r.value):"",dataTypeMatcher:r=>typeof r=="string"&&Qg(r)}}getDefaultDataTypes(){const e=this.getLocaleTextFunc();return{number:{baseDataType:"number",valueParser:t=>t.newValue?.trim?.()===""?null:Number(t.newValue),valueFormatter:t=>t.value==null?"":typeof t.value!="number"||isNaN(t.value)?e("invalidNumber","Invalid Number"):String(t.value),dataTypeMatcher:t=>typeof t=="number"},text:{baseDataType:"text",valueParser:t=>t.newValue===""?null:Xb(t.newValue),dataTypeMatcher:t=>typeof t=="string"},boolean:{baseDataType:"boolean",valueParser:t=>t.newValue==null?t.newValue:t.newValue?.trim?.()===""?null:String(t.newValue).toLowerCase()==="true",valueFormatter:t=>t.value==null?"":String(t.value),dataTypeMatcher:t=>typeof t=="boolean"},date:this.getDateObjectTypeDef("date"),dateString:this.getDateStringTypeDef("dateString"),dateTime:this.getDateObjectTypeDef("dateTime"),dateTimeString:{...this.getDateStringTypeDef("dateTimeString"),dataTypeMatcher:t=>typeof t=="string"&&m7(t)},object:{baseDataType:"object",valueParser:()=>null,valueFormatter:t=>Xb(t.value)??""}}}destroyColumnStateUpdateListeners(){for(const e of this.columnStateUpdateListenerDestroyFuncs)e();this.columnStateUpdateListenerDestroyFuncs=[]}destroy(){this.dataTypeDefinitions={},this.dataTypeMatchers={},this.formatValueFuncs={},this.columnStateUpdatesPendingInference={},this.destroyColumnStateUpdateListeners(),super.destroy()}};function M4(e,t){const r={...e,...t};return e.columnTypes&&t.columnTypes&&t.appendColumnTypes&&(r.columnTypes=[...y0(e.columnTypes),...y0(t.columnTypes)]),r}function D4(e,t,r){return t?t.baseDataType!==e.baseDataType?(at(46),!1):!0:(at(45,{parentCellDataType:r}),!1)}function P4(e,t){if(e.valueFormatter)return r=>{if(r.node?.group){const n=(r.colDef.pivotValueColumn??r.column).getAggFunc();if(n){if(n==="first"||n==="last")return e.valueFormatter(r);if(e.baseDataType==="number"&&n!=="count"){if(typeof r.value=="number")return e.valueFormatter(r);if(typeof r.value=="object"){if(!r.value)return;if("toNumber"in r.value)return e.valueFormatter({...r,value:r.value.toNumber()});if("value"in r.value)return e.valueFormatter({...r,value:r.value.value})}}return}}else if(t.get("groupHideOpenParents")&&r.column.isRowGroupActive()&&typeof r.value=="string"&&!e.dataTypeMatcher?.(r.value))return;return e.valueFormatter(r)}}function EL(e,t,r,n){if(!t[r])return!1;const i=e[r];return i===null?(t[r]=!1,!1):n===void 0?!!i:i===n}function db(e,t){return[["cellRenderer","agSparklineCellRenderer"],["valueGetter",void 0],["valueParser",void 0],["refData",void 0]].some(([r,n])=>EL(e,t,r,n))}function TL(e,t){const r=fk(e);for(const n of t)delete r[n],n==="rowGroup"?delete r.rowGroupIndex:n==="pivot"&&delete r.pivotIndex;return r}var kL={moduleName:"DataType",version:wt,beans:[_L],dependsOn:[JN]},RL={moduleName:"ColumnFlex",version:wt,beans:[xL]},bR={moduleName:"ColumnApi",version:wt,beans:[CL],apiFunctions:{getColumnDef:eL,getDisplayNameForColumn:rL,getColumn:nL,getColumns:iL,applyColumnState:sL,getColumnState:oL,resetColumnState:aL,isPinning:lL,isPinningLeft:cL,isPinningRight:uL,getDisplayedColAfter:dL,getDisplayedColBefore:hL,setColumnsVisible:fL,setColumnsPinned:pL,getAllGridColumns:gL,getDisplayedLeftColumns:mL,getDisplayedCenterColumns:vL,getDisplayedRightColumns:bL,getAllDisplayedColumns:wL,getAllDisplayedVirtualColumns:yL,getColumnDefs:tL}};function AL(e){if(!e||e==null)return null;const t=/([a-z])([A-Z])/g,r=/([A-Z]+)([A-Z])([a-z])/g;return e.replace(t,"$1 $2").replace(r,"$1 $2$3").replace(/\./g," ").split(" ").map(i=>i.substring(0,1).toUpperCase()+(i.length>1?i.substring(1,i.length):"")).join(" ")}var FL=class extends et{constructor(){super(...arguments),this.beanName="colNames"}getDisplayNameForColumn(e,t,r=!1){if(!e)return null;const n=this.getHeaderName(e.getColDef(),e,null,null,t),{aggColNameSvc:i}=this.beans;return r&&i?i.getHeaderName(e,n):n}getDisplayNameForProvidedColumnGroup(e,t,r){const n=t?.getColGroupDef();return n?this.getHeaderName(n,null,e,t,r):null}getDisplayNameForColumnGroup(e,t){return this.getDisplayNameForProvidedColumnGroup(e,e.getProvidedColumnGroup(),t)}getHeaderName(e,t,r,n,i){const s=e.headerValueGetter;if(s){const o=Dt(this.gos,{colDef:e,column:t,columnGroup:r,providedColumnGroup:n,location:i});return typeof s=="function"?s(o):typeof s=="string"?this.beans.expressionSvc?.evaluate(s,o)??null:""}else{if(e.headerName!=null)return e.headerName;if(e.field)return AL(e.field)}return""}},ML=class extends et{constructor(){super(...arguments),this.beanName="colViewport",this.colsWithinViewport=[],this.headerColsWithinViewport=[],this.colsWithinViewportHash="",this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.columnsToRenderLeft=[],this.columnsToRenderRight=[],this.columnsToRenderCenter=[]}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel}postConstruct(){this.suppressColumnVirtualisation=this.gos.get("suppressColumnVirtualisation")}setScrollPosition(e,t,r=!1){const{visibleCols:n}=this,i=n.isBodyWidthDirty;if(!(e===this.scrollWidth&&t===this.scrollPosition&&!i)){if(this.scrollWidth=e,this.scrollPosition=t,n.isBodyWidthDirty=!0,this.gos.get("enableRtl")){const o=n.bodyWidth;this.viewportLeft=o-t-e,this.viewportRight=o-t}else this.viewportLeft=t,this.viewportRight=e+t;this.colModel.ready&&this.checkViewportColumns(r)}}getColumnHeadersToRender(e){switch(e){case"left":return this.columnsToRenderLeft;case"right":return this.columnsToRenderRight;default:return this.columnsToRenderCenter}}getHeadersToRender(e,t){let r;switch(e){case"left":r=this.rowsOfHeadersToRenderLeft[t];break;case"right":r=this.rowsOfHeadersToRenderRight[t];break;default:r=this.rowsOfHeadersToRenderCenter[t];break}return r??[]}extractViewportColumns(){const e=this.visibleCols.centerCols;this.isColumnVirtualisationSuppressed()?(this.colsWithinViewport=e,this.headerColsWithinViewport=e):(this.colsWithinViewport=e.filter(this.isColumnInRowViewport.bind(this)),this.headerColsWithinViewport=e.filter(this.isColumnInHeaderViewport.bind(this)))}isColumnVirtualisationSuppressed(){return this.suppressColumnVirtualisation||this.viewportRight===0}clear(){this.rowsOfHeadersToRenderLeft={},this.rowsOfHeadersToRenderRight={},this.rowsOfHeadersToRenderCenter={},this.colsWithinViewportHash=""}isColumnInHeaderViewport(e){return e.isAutoHeaderHeight()||DL(e)?!0:this.isColumnInRowViewport(e)}isColumnInRowViewport(e){if(e.isAutoHeight())return!0;const t=e.getLeft()||0,r=t+e.getActualWidth(),n=this.viewportLeft-200,i=this.viewportRight+200,s=t<n&&r<n,o=t>i&&r>i;return!s&&!o}getViewportColumns(){const{leftCols:e,rightCols:t}=this.visibleCols;return this.colsWithinViewport.concat(e).concat(t)}getColsWithinViewport(e){if(!this.colModel.colSpanActive)return this.colsWithinViewport;const t=s=>{const o=s.getLeft();return bt(o)&&o>this.viewportLeft},r=this.isColumnVirtualisationSuppressed()?void 0:this.isColumnInRowViewport.bind(this),{visibleCols:n}=this,i=n.centerCols;return n.getColsForRow(e,i,r,t)}checkViewportColumns(e=!1){this.extractViewport()&&this.eventSvc.dispatchEvent({type:"virtualColumnsChanged",afterScroll:e})}calculateHeaderRows(){const{leftCols:e,rightCols:t}=this.visibleCols;this.columnsToRenderLeft=e,this.columnsToRenderRight=t,this.columnsToRenderCenter=this.colsWithinViewport;const r=n=>{const i=new Set,s={};for(const o of n){let a=o.getParent();const l=o.isSpanHeaderHeight();for(;a&&!i.has(a);){if(l&&a.isPadding()){a=a.getParent();continue}const u=a.getProvidedColumnGroup().getLevel();s[u]??(s[u]=[]),s[u].push(a),i.add(a),a=a.getParent()}}return s};this.rowsOfHeadersToRenderLeft=r(e),this.rowsOfHeadersToRenderRight=r(t),this.rowsOfHeadersToRenderCenter=r(this.headerColsWithinViewport)}extractViewport(){const e=n=>`${n.getId()}-${n.getPinned()||"normal"}`;this.extractViewportColumns();const t=this.getViewportColumns().map(e).join("#"),r=this.colsWithinViewportHash!==t;return r&&(this.colsWithinViewportHash=t,this.calculateHeaderRows()),r}};function DL(e){for(;e;){if(e.isAutoHeaderHeight())return!0;e=e.getParent()}return!1}var PL=class extends et{constructor(){super(...arguments),this.beanName="agCompUtils"}adaptFunction(e,t){if(!e.cellRenderer)return null;class r{refresh(){return!1}getGui(){return this.eGui}init(i){const s=t(i),o=typeof s;if(o==="string"||o==="number"||o==="boolean"){this.eGui=oy("<span>"+s+"</span>");return}if(s==null){this.eGui=ks({tag:"span"});return}this.eGui=s}}return r}},IL={moduleName:"CellRendererFunction",version:wt,beans:[PL]},OL=class extends u9{constructor(){super(...arguments),this.agGridDefaults={},this.agGridDefaultOverrides={},this.jsComps={},this.selectors={},this.icons={}}postConstruct(){const e=this.gos.get("components");if(e!=null)for(const t of Object.keys(e))this.jsComps[t]=e[t]}registerModule(e){const{icons:t,userComponents:r,dynamicBeans:n,selectors:i}=e;if(r){const s=(o,a,l,c)=>{this.agGridDefaults[o]=a,(l||c)&&(this.agGridDefaultOverrides[o]={params:l,processParams:c})};for(const o of Object.keys(r)){let a=r[o];if(JP(a)&&(a=a.getComp(this.beans)),typeof a=="object"){const{classImp:l,params:c,processParams:u}=a;s(o,l,c,u)}else s(o,a)}}this.registerDynamicBeans(n);for(const s of i??[])this.selectors[s.selector]=s;if(t)for(const s of Object.keys(t))this.icons[s]=t[s]}getUserComponent(e,t){const r=(a,l,c,u)=>({componentFromFramework:l,component:a,params:c,processParams:u}),{frameworkOverrides:n}=this.beans,i=n.frameworkComponent(t,this.gos.get("components"));if(i!=null)return r(i,!0);const s=this.jsComps[t];if(s){const a=n.isFrameworkComponent(s);return r(s,a)}const o=this.agGridDefaults[t];if(o){const a=this.agGridDefaultOverrides[t];return r(o,!1,a?.params,a?.processParams)}return this.beans.validation?.missingUserComponent(e,t,this.agGridDefaults,this.jsComps),null}getSelector(e){return this.selectors[e]}getIcon(e){return this.icons[e]}getDynamicError(e,t){return t?_o(279,{name:e}):this.beans.validation?.missingDynamicBean(e)??_o(256)}},NL=23,LL=class extends et{constructor(){super(...arguments),this.beanName="ctrlsSvc",this.params={},this.ready=!1,this.readyCallbacks=[]}postConstruct(){this.addEventListener("ready",()=>{if(this.updateReady(),this.ready){for(const e of this.readyCallbacks)e(this.params);this.readyCallbacks.length=0}},this.beans.frameworkOverrides.runWhenReadyAsync?.()??!1)}updateReady(){const e=Object.values(this.params);this.ready=e.length===NL&&e.every(t=>t?.isAlive()??!1)}whenReady(e,t){this.ready?t(this.params):this.readyCallbacks.push(t),e.addDestroyFunc(()=>{const r=this.readyCallbacks.indexOf(t);r>=0&&this.readyCallbacks.splice(r,1)})}register(e,t){this.params[e]=t,this.updateReady(),this.ready&&this.dispatchLocalEvent({type:"ready"}),t.addDestroyFunc(()=>{this.updateReady()})}get(e){return this.params[e]}getGridBodyCtrl(){return this.params.gridBodyCtrl}getHeaderRowContainerCtrls(){const{leftHeader:e,centerHeader:t,rightHeader:r}=this.params;return[e,r,t]}getHeaderRowContainerCtrl(e){const t=this.params;switch(e){case"left":return t.leftHeader;case"right":return t.rightHeader;default:return t.centerHeader}}getScrollFeature(){return this.getGridBodyCtrl().scrollFeature}},BL='.ag-aria-description-container{border:0;z-index:9999;clip:rect(1px,1px,1px,1px);height:1px;overflow:hidden;padding:0;position:absolute;white-space:nowrap;width:1px}.ag-unselectable{-webkit-user-select:none;-moz-user-select:none;user-select:none}.ag-selectable{-webkit-user-select:text;-moz-user-select:text;user-select:text}.ag-shake-left-to-right{animation-direction:alternate;animation-duration:.2s;animation-iteration-count:infinite;animation-name:ag-shake-left-to-right}@keyframes ag-shake-left-to-right{0%{padding-left:6px;padding-right:2px}to{padding-left:2px;padding-right:6px}}.ag-body-horizontal-scroll-viewport,.ag-body-vertical-scroll-viewport,.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{flex:1 1 auto;height:100%;min-width:0;overflow:hidden;position:relative}.ag-viewport{position:relative}.ag-spanning-container{position:absolute;top:0;z-index:1}.ag-body-viewport,.ag-center-cols-viewport,.ag-floating-bottom-viewport,.ag-floating-top-viewport,.ag-header-viewport,.ag-sticky-bottom-viewport,.ag-sticky-top-viewport{overflow-x:auto;-ms-overflow-style:none!important;scrollbar-width:none!important;&::-webkit-scrollbar{display:none!important}}.ag-body-viewport{display:flex;overflow-x:hidden;&:where(.ag-layout-normal){overflow-y:auto;-webkit-overflow-scrolling:touch}}.ag-floating-bottom-container,.ag-floating-top-container,.ag-sticky-bottom-container,.ag-sticky-top-container{min-height:1px}.ag-center-cols-viewport{min-height:100%;width:100%}.ag-body-horizontal-scroll-viewport{overflow-x:scroll}.ag-body-vertical-scroll-viewport{overflow-y:scroll}.ag-body-container,.ag-body-horizontal-scroll-container,.ag-body-vertical-scroll-container,.ag-center-cols-container,.ag-floating-bottom-container,.ag-floating-bottom-full-width-container,.ag-floating-top-container,.ag-full-width-container,.ag-header-container,.ag-pinned-left-cols-container,.ag-pinned-right-cols-container,.ag-sticky-bottom-container,.ag-sticky-top-container{position:relative}.ag-floating-bottom-container,.ag-floating-top-container,.ag-header-container,.ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top,.ag-sticky-bottom-container,.ag-sticky-top-container{height:100%;white-space:nowrap}.ag-center-cols-container,.ag-pinned-right-cols-container{display:block}.ag-body-horizontal-scroll-container{height:100%}.ag-body-vertical-scroll-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container,.ag-full-width-container,.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{pointer-events:none;position:absolute;top:0}:where(.ag-ltr) .ag-floating-bottom-full-width-container,:where(.ag-ltr) .ag-floating-top-full-width-container,:where(.ag-ltr) .ag-full-width-container,:where(.ag-ltr) .ag-sticky-bottom-full-width-container,:where(.ag-ltr) .ag-sticky-top-full-width-container{left:0}:where(.ag-rtl) .ag-floating-bottom-full-width-container,:where(.ag-rtl) .ag-floating-top-full-width-container,:where(.ag-rtl) .ag-full-width-container,:where(.ag-rtl) .ag-sticky-bottom-full-width-container,:where(.ag-rtl) .ag-sticky-top-full-width-container{right:0}.ag-full-width-container{width:100%}.ag-floating-bottom-full-width-container,.ag-floating-top-full-width-container{display:inline-block;height:100%;overflow:hidden;width:100%}.ag-body{display:flex;flex:1 1 auto;flex-direction:row!important;min-height:0;position:relative}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:flex;min-height:0;min-width:0;position:relative;&:where(.ag-scrollbar-invisible){bottom:0;position:absolute;&:where(.ag-apple-scrollbar){opacity:0;transition:opacity .4s;visibility:hidden;&:where(.ag-scrollbar-scrolling,.ag-scrollbar-active){opacity:1;visibility:visible}}}}.ag-body-horizontal-scroll{width:100%;&:where(.ag-scrollbar-invisible){left:0;right:0}}.ag-body-vertical-scroll{height:100%;&:where(.ag-scrollbar-invisible){top:0;z-index:10}}:where(.ag-ltr) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){right:0}}:where(.ag-rtl) .ag-body-vertical-scroll{&:where(.ag-scrollbar-invisible){left:0}}.ag-force-vertical-scroll{overflow-y:scroll!important}.ag-horizontal-left-spacer,.ag-horizontal-right-spacer{height:100%;min-width:0;overflow-x:scroll;&:where(.ag-scroller-corner){overflow-x:hidden}}:where(.ag-row-animation) .ag-row{transition:transform .4s,top .4s,opacity .2s;&:where(.ag-after-created){transition:transform .4s,top .4s,height .4s,opacity .2s}}:where(.ag-row-animation.ag-prevent-animation) .ag-row{transition:none!important;&:where(.ag-row.ag-after-created){transition:none!important}}:where(.ag-row-no-animation) .ag-row{transition:none}.ag-row-loading{align-items:center;display:flex}.ag-row-position-absolute{position:absolute}.ag-row-position-relative{position:relative}.ag-full-width-row{overflow:hidden;pointer-events:all}.ag-row-inline-editing{z-index:1}.ag-row-dragging{z-index:2}.ag-stub-cell{align-items:center;display:flex}.ag-cell{display:inline-block;height:100%;position:absolute;white-space:nowrap;&:focus-visible{box-shadow:none}}.ag-cell-value{flex:1 1 auto}.ag-cell-value:not(.ag-allow-overflow),.ag-group-value{overflow:hidden;text-overflow:ellipsis}.ag-cell-wrap-text{white-space:normal;word-break:break-word}:where(.ag-cell) .ag-icon{display:inline-block;vertical-align:middle}.ag-floating-top{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-top:not(.ag-invisible)){border-bottom:var(--ag-pinned-row-border)}.ag-floating-bottom{display:flex;overflow:hidden;position:relative;white-space:nowrap;width:100%}:where(.ag-floating-bottom:not(.ag-invisible)){border-top:var(--ag-pinned-row-border)}.ag-sticky-bottom,.ag-sticky-top{background-color:var(--ag-data-background-color);display:flex;height:0;overflow:hidden;position:absolute;width:100%;z-index:1}.ag-opacity-zero{opacity:0!important}.ag-cell-label-container{align-items:center;display:flex;flex-direction:row-reverse;height:100%;justify-content:space-between;width:100%}:where(.ag-right-aligned-header){.ag-cell-label-container{flex-direction:row}.ag-header-cell-text{text-align:end}}.ag-column-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr){direction:ltr;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row}}:where(.ag-rtl){direction:rtl;text-align:right;.ag-body,.ag-body-horizontal-scroll,.ag-body-viewport,.ag-floating-bottom,.ag-floating-top,.ag-header,.ag-sticky-bottom,.ag-sticky-top{flex-direction:row-reverse}.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{display:block}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(180deg)}}:where(.ag-rtl){.ag-icon-contracted,.ag-icon-expanded,.ag-icon-tree-closed{transform:rotate(-180deg)}}:where(.ag-ltr) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-left:var(--ag-row-group-indent-size)}:where(.ag-rtl) .ag-row:not(.ag-row-level-0) .ag-pivot-leaf-group{margin-right:var(--ag-row-group-indent-size)}:where(.ag-ltr) .ag-row-group-leaf-indent{margin-left:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}:where(.ag-rtl) .ag-row-group-leaf-indent{margin-right:calc(var(--ag-cell-widget-spacing) + var(--ag-icon-size))}.ag-value-change-delta{padding:0 2px}.ag-value-change-delta-up{color:var(--ag-value-change-delta-up-color)}.ag-value-change-delta-down{color:var(--ag-value-change-delta-down-color)}.ag-value-change-value{background-color:transparent;border-radius:1px;padding-left:1px;padding-right:1px;transition:background-color 1s}.ag-value-change-value-highlight{background-color:var(--ag-value-change-value-highlight-background-color);transition:background-color .1s}.ag-cell-data-changed{background-color:var(--ag-value-change-value-highlight-background-color)!important}.ag-cell-data-changed-animation{background-color:transparent}.ag-cell-highlight{background-color:var(--ag-range-selection-highlight-color)!important}.ag-row,.ag-spanned-row{color:var(--ag-cell-text-color);font-family:var(--ag-cell-font-family);font-size:var(--ag-data-font-size);white-space:nowrap;--ag-internal-content-line-height:calc(min(var(--ag-row-height), var(--ag-line-height, 1000px)) - var(--ag-internal-row-border-width, 1px) - 2px)}.ag-row{background-color:var(--ag-data-background-color);border-bottom:var(--ag-row-border);height:var(--ag-row-height);width:100%;&.ag-row-editing-invalid{background-color:var(--ag-full-row-edit-invalid-background-color)}}:where(.ag-body-vertical-content-no-gap>div>div>div,.ag-body-vertical-content-no-gap>div>div>div>div)>.ag-row-last{border-bottom-color:transparent}.ag-sticky-bottom{border-top:var(--ag-row-border);box-sizing:content-box!important}.ag-group-contracted,.ag-group-expanded{cursor:pointer}.ag-cell,.ag-full-width-row .ag-cell-wrapper.ag-row-group{border:1px solid transparent;line-height:var(--ag-internal-content-line-height);-webkit-font-smoothing:subpixel-antialiased}:where(.ag-ltr) .ag-cell{border-right:var(--ag-column-border)}:where(.ag-rtl) .ag-cell{border-left:var(--ag-column-border)}.ag-spanned-cell-wrapper{background-color:var(--ag-data-background-color);position:absolute}.ag-spanned-cell-wrapper>.ag-spanned-cell{display:block;position:relative}:where(.ag-ltr) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-right-color:transparent}:where(.ag-rtl) :where(.ag-body-horizontal-content-no-gap) .ag-column-last{border-left-color:transparent}.ag-cell-wrapper{align-items:center;display:flex;>:where(:not(.ag-cell-value,.ag-group-value)){align-items:center;display:flex;height:var(--ag-internal-content-line-height)}&:where(.ag-row-group){align-items:flex-start}:where(.ag-full-width-row) &:where(.ag-row-group){align-items:center;height:100%}}:where(.ag-ltr) .ag-cell-wrapper{padding-left:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-rtl) .ag-cell-wrapper{padding-right:calc(var(--ag-indentation-level)*var(--ag-row-group-indent-size))}:where(.ag-cell-wrap-text:not(.ag-cell-auto-height)) .ag-cell-wrapper{align-items:normal;height:100%;:where(.ag-cell-value){height:100%}}:where(.ag-ltr) .ag-row>.ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}:where(.ag-rtl) .ag-row>.ag-cell-wrapper.ag-row-group{padding-right:calc(var(--ag-cell-horizontal-padding) + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-cell-focus:not(.ag-cell-range-selected):focus-within,.ag-cell-range-single-cell,.ag-cell-range-single-cell.ag-cell-range-handle,.ag-context-menu-open .ag-cell-focus:not(.ag-cell-range-selected),.ag-context-menu-open .ag-full-width-row.ag-row-focus .ag-cell-wrapper.ag-row-group,.ag-full-width-row.ag-row-focus:focus .ag-cell-wrapper.ag-row-group{border:1px solid;border-color:var(--ag-range-selection-border-color);border-style:var(--ag-range-selection-border-style);outline:initial}.ag-full-width-row.ag-row-focus:focus{box-shadow:none}:where(.ag-ltr) .ag-group-contracted,:where(.ag-ltr) .ag-group-expanded,:where(.ag-ltr) .ag-row-drag,:where(.ag-ltr) .ag-selection-checkbox{margin-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-group-contracted,:where(.ag-rtl) .ag-group-expanded,:where(.ag-rtl) .ag-row-drag,:where(.ag-rtl) .ag-selection-checkbox{margin-left:var(--ag-cell-widget-spacing)}.ag-drag-handle-disabled{opacity:.35;pointer-events:none}:where(.ag-ltr) .ag-group-child-count{margin-left:3px}:where(.ag-rtl) .ag-group-child-count{margin-right:3px}.ag-row-highlight-above:after,.ag-row-highlight-below:after,.ag-row-highlight-inside:after{background-color:var(--ag-row-drag-indicator-color);border-radius:calc(var(--ag-row-drag-indicator-width)/2);content:"";height:var(--ag-row-drag-indicator-width);pointer-events:none;position:absolute;width:calc(100% - 1px)}:where(.ag-ltr) .ag-row-highlight-above:after,:where(.ag-ltr) .ag-row-highlight-below:after,:where(.ag-ltr) .ag-row-highlight-inside:after{left:1px}:where(.ag-rtl) .ag-row-highlight-above:after,:where(.ag-rtl) .ag-row-highlight-below:after,:where(.ag-rtl) .ag-row-highlight-inside:after{right:1px}.ag-row-highlight-above:after{top:0}.ag-row-highlight-below:after{bottom:0}.ag-row-highlight-indent:after{display:block;width:auto}:where(.ag-ltr) .ag-row-highlight-indent:after{left:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size));right:1px}:where(.ag-rtl) .ag-row-highlight-indent:after{left:1px;right:calc((var(--ag-cell-widget-spacing) + var(--ag-icon-size))*2 + var(--ag-cell-horizontal-padding) + var(--ag-row-highlight-level)*var(--ag-row-group-indent-size))}.ag-row-highlight-inside:after{background-color:var(--ag-selected-row-background-color);border:1px solid var(--ag-range-selection-border-color);display:block;height:auto;inset:0;width:auto}.ag-body,.ag-floating-bottom,.ag-floating-top{background-color:var(--ag-data-background-color)}.ag-row-odd{background-color:var(--ag-odd-row-background-color)}.ag-row-selected:before{background-color:var(--ag-selected-row-background-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-full-width-row.ag-row-group:before,.ag-row-hover:not(.ag-full-width-row):before{background-color:var(--ag-row-hover-color);content:"";display:block;inset:0;pointer-events:none;position:absolute}.ag-row-hover.ag-row-selected:before{background-color:var(--ag-row-hover-color);background-image:linear-gradient(var(--ag-selected-row-background-color),var(--ag-selected-row-background-color))}.ag-row.ag-full-width-row.ag-row-group>*{position:relative}.ag-column-hover{background-color:var(--ag-column-hover-color)}.ag-header-range-highlight{background-color:var(--ag-range-header-highlight-color)}.ag-right-aligned-cell{font-variant-numeric:tabular-nums}:where(.ag-ltr) .ag-right-aligned-cell{text-align:right}:where(.ag-rtl) .ag-right-aligned-cell{text-align:left}.ag-right-aligned-cell .ag-cell-value,.ag-right-aligned-cell .ag-group-value{margin-left:auto}:where(.ag-ltr) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-ltr) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level));padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}:where(.ag-rtl) .ag-cell:not(.ag-cell-inline-editing),:where(.ag-rtl) .ag-full-width-row .ag-cell-wrapper.ag-row-group{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px + var(--ag-row-group-indent-size)*var(--ag-indentation-level))}.ag-row>.ag-cell-wrapper{padding-left:calc(var(--ag-cell-horizontal-padding) - 1px);padding-right:calc(var(--ag-cell-horizontal-padding) - 1px)}.ag-row-dragging{cursor:move;opacity:.5}.ag-details-row{background-color:var(--ag-data-background-color);padding:calc(var(--ag-spacing)*3.75)}.ag-layout-auto-height,.ag-layout-print{.ag-center-cols-container,.ag-center-cols-viewport{min-height:150px}}.ag-overlay-exporting-wrapper,.ag-overlay-loading-wrapper,.ag-overlay-modal-wrapper{background-color:var(--ag-modal-overlay-background-color)}.ag-skeleton-container{align-content:center;height:100%;width:100%}.ag-skeleton-effect{animation:ag-skeleton-loading 1.5s ease-in-out .5s infinite;background-color:var(--ag-row-loading-skeleton-effect-color);border-radius:.25rem;height:1em;width:100%}:where(.ag-ltr) .ag-right-aligned-cell .ag-skeleton-effect{margin-left:auto}:where(.ag-rtl) .ag-right-aligned-cell .ag-skeleton-effect{margin-right:auto}@keyframes ag-skeleton-loading{0%{background-color:var(--ag-row-loading-skeleton-effect-color)}50%{background-color:color-mix(in srgb,transparent,var(--ag-row-loading-skeleton-effect-color) 40%)}to{background-color:var(--ag-row-loading-skeleton-effect-color)}}.ag-loading{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-loading{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-loading{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-ltr) .ag-loading-icon{padding-right:var(--ag-cell-widget-spacing)}:where(.ag-rtl) .ag-loading-icon{padding-left:var(--ag-cell-widget-spacing)}.ag-icon-loading{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}.ag-header{background-color:var(--ag-header-background-color);border-bottom:var(--ag-header-row-border);color:var(--ag-header-text-color);display:flex;font-family:var(--ag-header-font-family);font-size:var(--ag-header-font-size);font-weight:var(--ag-header-font-weight);overflow:hidden;white-space:nowrap;width:100%}.ag-header-row{height:var(--ag-header-height);position:absolute}.ag-floating-filter-button-button,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,:where(.ag-header-cell-sortable) .ag-header-cell-label,:where(.ag-header-group-cell-selectable) .ag-header-cell-comp-wrapper{cursor:pointer}:where(.ag-ltr) .ag-header-expand-icon{margin-left:4px}:where(.ag-rtl) .ag-header-expand-icon{margin-right:4px}.ag-header-row:where(:not(:first-child)){:where(.ag-header-cell:not(.ag-header-span-height.ag-header-span-total,.ag-header-parent-hidden),.ag-header-group-cell.ag-header-group-cell-with-group){border-top:var(--ag-header-row-border)}}.ag-header-row:where(:not(.ag-header-row-column-group)){overflow:hidden}:where(.ag-header.ag-header-allow-overflow) .ag-header-row{overflow:visible}.ag-header-cell{display:inline-flex;overflow:hidden}.ag-header-group-cell{contain:paint;display:flex}.ag-header-cell,.ag-header-group-cell{align-items:center;gap:var(--ag-cell-widget-spacing);height:100%;padding:0 var(--ag-cell-horizontal-padding);position:absolute}@property --ag-internal-moving-color{syntax:"<color>";inherits:false;initial-value:transparent}@property --ag-internal-hover-color{syntax:"<color>";inherits:false;initial-value:transparent}.ag-header-cell:where(:not(.ag-floating-filter)),.ag-header-group-cell{&:before{background-image:linear-gradient(var(--ag-internal-hover-color),var(--ag-internal-hover-color)),linear-gradient(var(--ag-internal-moving-color),var(--ag-internal-moving-color));content:"";inset:0;position:absolute;--ag-internal-moving-color:transparent;--ag-internal-hover-color:transparent;transition:--ag-internal-moving-color var(--ag-header-cell-background-transition-duration),--ag-internal-hover-color var(--ag-header-cell-background-transition-duration)}&:where(:hover):before{--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}&:where(.ag-header-cell-moving):before{--ag-internal-moving-color:var(--ag-header-cell-moving-background-color);--ag-internal-hover-color:var(--ag-header-cell-hover-background-color)}}:where(.ag-header-cell:not(.ag-floating-filter) *,.ag-header-group-cell *){position:relative;z-index:1}.ag-header-cell-menu-button:where(:not(.ag-header-menu-always-show)){opacity:0;transition:opacity .2s}.ag-header-cell-filter-button,:where(.ag-header-cell.ag-header-active) .ag-header-cell-menu-button{opacity:1}.ag-header-cell-label,.ag-header-group-cell-label{align-items:center;align-self:stretch;display:flex;flex:1 1 auto;overflow:hidden;padding:5px 0}:where(.ag-ltr) .ag-sort-indicator-icon{padding-left:var(--ag-spacing)}:where(.ag-rtl) .ag-sort-indicator-icon{padding-right:var(--ag-spacing)}.ag-header-cell-label{text-overflow:ellipsis}.ag-header-group-cell-label.ag-sticky-label{flex:none;max-width:100%;overflow:visible;position:sticky}:where(.ag-ltr) .ag-header-group-cell-label.ag-sticky-label{left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-header-group-cell-label.ag-sticky-label{right:var(--ag-cell-horizontal-padding)}.ag-header-cell-text,.ag-header-group-text{overflow:hidden;text-overflow:ellipsis}.ag-header-cell-text{word-break:break-word}.ag-header-cell-comp-wrapper{width:100%}:where(.ag-header-group-cell) .ag-header-cell-comp-wrapper{display:flex}:where(.ag-header-cell:not(.ag-header-cell-auto-height)) .ag-header-cell-comp-wrapper{align-items:center;display:flex;height:100%}.ag-header-cell-wrap-text .ag-header-cell-comp-wrapper{white-space:normal}.ag-header-cell-comp-wrapper-limited-height>*{overflow:hidden}:where(.ag-right-aligned-header) .ag-header-cell-label{flex-direction:row-reverse}:where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-col-ref{color:var(--ag-subtle-text-color)}}:where(.ag-ltr) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-col-ref{margin-right:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell:not(.ag-right-aligned-header)){.ag-header-col-ref{margin-left:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-header-cell.ag-right-aligned-header){.ag-header-col-ref{color:var(--ag-subtle-text-color)}}:where(.ag-ltr) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-col-ref{margin-left:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-right:var(--ag-spacing)}}:where(.ag-rtl) :where(.ag-header-cell.ag-right-aligned-header){.ag-header-col-ref{margin-right:var(--ag-spacing)}.ag-header-label-icon,.ag-header-menu-icon{margin-left:var(--ag-spacing)}}.ag-header-cell:after,.ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{content:"";height:var(--ag-header-column-border-height);position:absolute;top:calc(50% - var(--ag-header-column-border-height)*.5);z-index:1}:where(.ag-ltr) .ag-header-cell:after,:where(.ag-ltr) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-right:var(--ag-header-column-border);right:0}:where(.ag-rtl) .ag-header-cell:after,:where(.ag-rtl) .ag-header-group-cell:where(:not(.ag-header-span-height.ag-header-group-cell-no-group)):after{border-left:var(--ag-header-column-border);left:0}.ag-header-highlight-after:after,.ag-header-highlight-before:after{background-color:var(--ag-column-drag-indicator-color);border-radius:calc(var(--ag-column-drag-indicator-width)/2);content:"";height:100%;position:absolute;top:0;width:var(--ag-column-drag-indicator-width)}:where(.ag-ltr) .ag-header-highlight-before:after{left:0}:where(.ag-rtl) .ag-header-highlight-before:after{right:0}:where(.ag-ltr) .ag-header-highlight-after:after{right:0;:where(.ag-pinned-left-header) &{right:1px}}:where(.ag-rtl) .ag-header-highlight-after:after{left:0;:where(.ag-pinned-left-header) &{left:1px}}.ag-header-cell-resize{align-items:center;cursor:ew-resize;display:flex;height:100%;position:absolute;top:0;width:8px;z-index:2;&:after{background-color:var(--ag-header-column-resize-handle-color);content:"";height:var(--ag-header-column-resize-handle-height);position:absolute;top:calc(50% - var(--ag-header-column-resize-handle-height)*.5);width:var(--ag-header-column-resize-handle-width);z-index:1}}:where(.ag-ltr) .ag-header-cell-resize{right:-3px;&:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-rtl) .ag-header-cell-resize{left:-3px;&:after{right:calc(50% - var(--ag-header-column-resize-handle-width))}}:where(.ag-header-cell.ag-header-span-height) .ag-header-cell-resize:after{height:calc(100% - var(--ag-spacing)*4);top:calc(var(--ag-spacing)*2)}.ag-header-group-cell-no-group:where(.ag-header-span-height){display:none}.ag-sort-indicator-container{display:flex;gap:var(--ag-spacing)}.ag-layout-print{&.ag-body{display:block;height:unset}&.ag-root-wrapper{display:inline-block}.ag-body-horizontal-scroll,.ag-body-vertical-scroll{display:none}&.ag-force-vertical-scroll{overflow-y:visible!important}}@media print{.ag-root-wrapper.ag-layout-print{display:table;.ag-body-horizontal-scroll-viewport,.ag-body-viewport,.ag-center-cols-container,.ag-center-cols-viewport,.ag-root,.ag-root-wrapper-body,.ag-virtual-list-viewport{display:block!important;height:auto!important;overflow:hidden!important}.ag-cell,.ag-row{-moz-column-break-inside:avoid;break-inside:avoid}}}ag-grid,ag-grid-angular{display:block}.ag-root-wrapper{border:var(--ag-wrapper-border);border-radius:var(--ag-wrapper-border-radius);display:flex;flex-direction:column;overflow:hidden;position:relative;&.ag-layout-normal{height:100%}}.ag-root-wrapper-body{display:flex;flex-direction:row;&.ag-layout-normal{flex:1 1 auto;height:0;min-height:0}}.ag-root{display:flex;flex-direction:column;position:relative;&.ag-layout-auto-height,&.ag-layout-normal{flex:1 1 auto;overflow:hidden;width:0}&.ag-layout-normal{height:100%}}.ag-drag-handle{color:var(--ag-drag-handle-color);cursor:grab;:where(.ag-icon){color:var(--ag-drag-handle-color)}}.ag-chart-menu-icon,.ag-chart-settings-next,.ag-chart-settings-prev,.ag-column-group-icons,.ag-column-select-header-icon,.ag-filter-toolpanel-expand,.ag-floating-filter-button-button,.ag-group-title-bar-icon,.ag-header-cell-filter-button,.ag-header-cell-menu-button,.ag-header-expand-icon,.ag-panel-title-bar-button,.ag-panel-title-bar-button-icon,.ag-set-filter-group-icons,:where(.ag-group-contracted) .ag-icon,:where(.ag-group-expanded) .ag-icon{background-color:var(--ag-icon-button-background-color);border-radius:var(--ag-icon-button-border-radius);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-background-color);color:var(--ag-icon-button-color);&:hover{background-color:var(--ag-icon-button-hover-background-color);box-shadow:0 0 0 var(--ag-icon-button-background-spread) var(--ag-icon-button-hover-background-color);color:var(--ag-icon-button-hover-color)}}:where(.ag-filter-active,.ag-filter-toolpanel-group-instance-header-icon,.ag-filter-toolpanel-instance-header-icon){position:relative;&:after{background-color:var(--ag-icon-button-active-indicator-color);border-radius:50%;content:"";height:6px;position:absolute;top:-1px;width:6px}}:where(.ag-ltr) :where(.ag-filter-active,.ag-filter-toolpanel-group-instance-header-icon,.ag-filter-toolpanel-instance-header-icon){&:after{right:-1px}}:where(.ag-rtl) :where(.ag-filter-active,.ag-filter-toolpanel-group-instance-header-icon,.ag-filter-toolpanel-instance-header-icon){&:after{left:-1px}}.ag-filter-active{background-image:linear-gradient(var(--ag-icon-button-active-background-color),var(--ag-icon-button-active-background-color));border-radius:1px;outline:solid var(--ag-icon-button-background-spread) var(--ag-icon-button-active-background-color);:where(.ag-icon-filter){clip-path:path("M8,0C8,4.415 11.585,8 16,8L16,16L0,16L0,0L8,0Z");color:var(--ag-icon-button-active-color)}}.ag-menu{background-color:var(--ag-menu-background-color);border:var(--ag-menu-border);border-radius:var(--ag-border-radius);box-shadow:var(--ag-menu-shadow);color:var(--ag-menu-text-color);max-height:100%;overflow-y:auto;position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}',HL={wrapperBorder:!0,rowBorder:!0,headerRowBorder:!0,footerRowBorder:{ref:"rowBorder"},columnBorder:{style:"solid",width:1,color:"transparent"},headerColumnBorder:!1,headerColumnBorderHeight:"100%",pinnedColumnBorder:!0,pinnedRowBorder:!0,sidePanelBorder:!0,sideBarPanelWidth:250,sideBarBackgroundColor:{ref:"chromeBackgroundColor"},sideButtonBarBackgroundColor:{ref:"sideBarBackgroundColor"},sideButtonBarTopPadding:0,sideButtonSelectedUnderlineWidth:2,sideButtonSelectedUnderlineColor:"transparent",sideButtonSelectedUnderlineTransitionDuration:0,sideButtonBackgroundColor:"transparent",sideButtonTextColor:{ref:"textColor"},sideButtonHoverBackgroundColor:{ref:"sideButtonBackgroundColor"},sideButtonHoverTextColor:{ref:"sideButtonTextColor"},sideButtonSelectedBackgroundColor:Ni,sideButtonSelectedTextColor:{ref:"sideButtonTextColor"},sideButtonBorder:"solid 1px transparent",sideButtonSelectedBorder:!0,sideButtonLeftPadding:{ref:"spacing"},sideButtonRightPadding:{ref:"spacing"},sideButtonVerticalPadding:{calc:"spacing * 3"},headerBackgroundColor:{ref:"chromeBackgroundColor"},headerFontFamily:{ref:"fontFamily"},cellFontFamily:{ref:"fontFamily"},headerFontWeight:500,headerFontSize:{ref:"fontSize"},dataFontSize:{ref:"fontSize"},headerTextColor:{ref:"textColor"},headerCellHoverBackgroundColor:"transparent",headerCellMovingBackgroundColor:{ref:"headerCellHoverBackgroundColor"},headerCellBackgroundTransitionDuration:"0.2s",cellTextColor:{ref:"textColor"},rangeSelectionBorderStyle:"solid",rangeSelectionBorderColor:Jo,rangeSelectionBackgroundColor:fo(.2),rangeSelectionChartBackgroundColor:"#0058FF1A",rangeSelectionChartCategoryBackgroundColor:"#00FF841A",rangeSelectionHighlightColor:fo(.5),rangeHeaderHighlightColor:z7(.08),rowNumbersSelectedColor:fo(.5),rowHoverColor:fo(.08),columnHoverColor:fo(.05),selectedRowBackgroundColor:fo(.12),modalOverlayBackgroundColor:{ref:"backgroundColor",mix:.66},dataBackgroundColor:Ni,oddRowBackgroundColor:{ref:"dataBackgroundColor"},wrapperBorderRadius:8,cellHorizontalPadding:{calc:"spacing * 2 * cellHorizontalPaddingScale"},cellWidgetSpacing:{calc:"spacing * 1.5"},cellHorizontalPaddingScale:1,rowGroupIndentSize:{calc:"cellWidgetSpacing + iconSize"},valueChangeDeltaUpColor:"#43a047",valueChangeDeltaDownColor:"#e53935",valueChangeValueHighlightBackgroundColor:"#16a08580",rowHeight:{calc:"max(iconSize, dataFontSize) + spacing * 3.25 * rowVerticalPaddingScale"},rowVerticalPaddingScale:1,headerHeight:{calc:"max(iconSize, dataFontSize) + spacing * 4 * headerVerticalPaddingScale"},headerVerticalPaddingScale:1,paginationPanelHeight:{ref:"rowHeight",calc:"max(rowHeight, 22px)"},dragHandleColor:bs(.7),headerColumnResizeHandleHeight:"30%",headerColumnResizeHandleWidth:2,headerColumnResizeHandleColor:{ref:"borderColor"},widgetContainerHorizontalPadding:{calc:"spacing * 1.5"},widgetContainerVerticalPadding:{calc:"spacing * 1.5"},widgetHorizontalSpacing:{calc:"spacing * 1.5"},widgetVerticalSpacing:{ref:"spacing"},iconButtonColor:{ref:"iconColor"},iconButtonBackgroundColor:"transparent",iconButtonBackgroundSpread:4,iconButtonBorderRadius:1,iconButtonHoverColor:{ref:"iconButtonColor"},iconButtonHoverBackgroundColor:bs(.1),iconButtonActiveColor:Jo,iconButtonActiveBackgroundColor:fo(.28),iconButtonActiveIndicatorColor:Jo,menuBorder:{color:bs(.2)},menuBackgroundColor:Ss(.03),menuTextColor:Ss(.95),menuShadow:{ref:"popupShadow"},menuSeparatorColor:{ref:"borderColor"},setFilterIndentSize:{ref:"iconSize"},chartMenuPanelWidth:260,chartMenuLabelColor:bs(.8),dialogShadow:{ref:"popupShadow"},cellEditingBorder:{color:Jo},cellEditingShadow:{ref:"cardShadow"},fullRowEditInvalidBackgroundColor:{ref:"invalidColor",onto:"backgroundColor",mix:.25},dialogBorder:{color:bs(.2)},panelBackgroundColor:Ni,panelTitleBarHeight:{ref:"headerHeight"},panelTitleBarBackgroundColor:{ref:"headerBackgroundColor"},panelTitleBarIconColor:{ref:"headerTextColor"},panelTitleBarTextColor:{ref:"headerTextColor"},panelTitleBarFontWeight:{ref:"headerFontWeight"},panelTitleBarBorder:!0,columnSelectIndentSize:{ref:"iconSize"},toolPanelSeparatorBorder:!0,columnDropCellBackgroundColor:bs(.07),columnDropCellTextColor:{ref:"textColor"},columnDropCellDragHandleColor:{ref:"textColor"},columnDropCellBorder:{color:bs(.13)},selectCellBackgroundColor:bs(.07),selectCellBorder:{color:bs(.13)},advancedFilterBuilderButtonBarBorder:!0,advancedFilterBuilderIndentSize:{calc:"spacing * 2 + iconSize"},advancedFilterBuilderJoinPillColor:"#f08e8d",advancedFilterBuilderColumnPillColor:"#a6e194",advancedFilterBuilderOptionPillColor:"#f3c08b",advancedFilterBuilderValuePillColor:"#85c0e4",filterPanelApplyButtonColor:Ni,filterPanelApplyButtonBackgroundColor:Jo,filterPanelCardSubtleColor:{ref:"textColor",mix:.7},filterPanelCardSubtleHoverColor:{ref:"textColor"},findMatchColor:Iu,findMatchBackgroundColor:"#ffff00",findActiveMatchColor:Iu,findActiveMatchBackgroundColor:"#ffa500",filterToolPanelGroupIndent:{ref:"spacing"},rowLoadingSkeletonEffectColor:bs(.15),statusBarLabelColor:Iu,statusBarLabelFontWeight:500,statusBarValueColor:Iu,statusBarValueFontWeight:500,pinnedSourceRowTextColor:{ref:"textColor"},pinnedSourceRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedSourceRowFontWeight:600,pinnedRowFontWeight:600,pinnedRowBackgroundColor:{ref:"dataBackgroundColor"},pinnedRowTextColor:{ref:"textColor"},rowDragIndicatorColor:{ref:"rangeSelectionBorderColor"},rowDragIndicatorWidth:2,columnDragIndicatorColor:{ref:"accentColor"},columnDragIndicatorWidth:2},jL=".ag-cell-batch-edit{background-color:var(--ag-cell-batch-edit-background-color);color:var(--ag-cell-batch-edit-text-color);display:inherit}.ag-row-batch-edit{background-color:var(--ag-row-batch-edit-background-color);color:var(--ag-row-batch-edit-text-color)}",wR={cellBatchEditBackgroundColor:"rgba(220 181 139 / 16%)",cellBatchEditTextColor:"#422f00",rowBatchEditBackgroundColor:{ref:"cellBatchEditBackgroundColor"},rowBatchEditTextColor:{ref:"cellBatchEditTextColor"}},VL={...wR,cellBatchEditTextColor:"#f3d0b3"},GL=()=>To({feature:"batchEditStyle",params:wR,css:jL}),zL=GL(),UL=":where(.ag-button){background:none;border:none;color:inherit;cursor:pointer;font-family:inherit;font-size:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0;text-indent:inherit;text-shadow:inherit;text-transform:inherit;word-spacing:inherit;&:disabled{cursor:default}&:focus-visible{box-shadow:var(--ag-focus-shadow);outline:none}}.ag-standard-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:var(--ag-button-background-color);border:var(--ag-button-border);border-radius:var(--ag-button-border-radius);color:var(--ag-button-text-color);cursor:pointer;font-weight:var(--ag-button-font-weight);padding:var(--ag-button-vertical-padding) var(--ag-button-horizontal-padding);&:hover{background-color:var(--ag-button-hover-background-color);border:var(--ag-button-hover-border);color:var(--ag-button-hover-text-color)}&:active{background-color:var(--ag-button-active-background-color);border:var(--ag-button-active-border);color:var(--ag-button-active-text-color)}&:disabled{background-color:var(--ag-button-disabled-background-color);border:var(--ag-button-disabled-border);color:var(--ag-button-disabled-text-color)}}",WL={buttonTextColor:"inherit",buttonFontWeight:"normal",buttonBackgroundColor:"transparent",buttonBorder:!1,buttonBorderRadius:{ref:"borderRadius"},buttonHorizontalPadding:{calc:"spacing * 2"},buttonVerticalPadding:{ref:"spacing"},buttonHoverTextColor:{ref:"buttonTextColor"},buttonHoverBackgroundColor:{ref:"buttonBackgroundColor"},buttonHoverBorder:{ref:"buttonBorder"},buttonActiveTextColor:{ref:"buttonHoverTextColor"},buttonActiveBackgroundColor:{ref:"buttonHoverBackgroundColor"},buttonActiveBorder:{ref:"buttonHoverBorder"},buttonDisabledTextColor:{ref:"inputDisabledTextColor"},buttonDisabledBackgroundColor:{ref:"inputDisabledBackgroundColor"},buttonDisabledBorder:{ref:"inputDisabledBorder"}},$L=()=>To({feature:"buttonStyle",params:{...WL,buttonBackgroundColor:Ni,buttonBorder:!0,buttonHoverBackgroundColor:{ref:"rowHoverColor"},buttonActiveBorder:{color:Jo}},css:UL}),qL=$L(),KL=".ag-column-drop-vertical-empty-message{align-items:center;border:dashed var(--ag-border-width);border-color:var(--ag-border-color);display:flex;inset:0;justify-content:center;margin:calc(var(--ag-spacing)*1.5) calc(var(--ag-spacing)*2);overflow:hidden;padding:calc(var(--ag-spacing)*2);position:absolute}",XL=()=>To({feature:"columnDropStyle",css:KL}),yR=XL(),YL={warn:(...e)=>{at(e[0],e[1])},error:(...e)=>{Ar(e[0],e[1])},preInitErr:(...e)=>{Fh(e[0],e[2],e[1])}},ZL=()=>e9(YL).withParams(HL).withPart(qL).withPart(yR).withPart(zL),JL='.ag-checkbox-input-wrapper,.ag-radio-button-input-wrapper{background-color:var(--ag-checkbox-unchecked-background-color);border:solid var(--ag-checkbox-border-width) var(--ag-checkbox-unchecked-border-color);flex:none;height:var(--ag-icon-size);position:relative;width:var(--ag-icon-size);:where(input){-webkit-appearance:none;-moz-appearance:none;appearance:none;cursor:pointer;display:block;height:var(--ag-icon-size);margin:0;opacity:0;width:var(--ag-icon-size)}&:after{content:"";display:block;inset:0;-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;pointer-events:none;position:absolute}&:where(.ag-checked){background-color:var(--ag-checkbox-checked-background-color);border-color:var(--ag-checkbox-checked-border-color);&:after{background-color:var(--ag-checkbox-checked-shape-color)}}&:where(:focus-within,:active){box-shadow:var(--ag-focus-shadow)}&:where(.ag-disabled){filter:grayscale();opacity:.5}}.ag-checkbox-input-wrapper{border-radius:var(--ag-checkbox-border-radius);&:where(.ag-checked):after{-webkit-mask-image:var(--ag-checkbox-checked-shape-image);mask-image:var(--ag-checkbox-checked-shape-image)}&:where(.ag-indeterminate){background-color:var(--ag-checkbox-indeterminate-background-color);border-color:var(--ag-checkbox-indeterminate-border-color);&:after{background-color:var(--ag-checkbox-indeterminate-shape-color);-webkit-mask-image:var(--ag-checkbox-indeterminate-shape-image);mask-image:var(--ag-checkbox-indeterminate-shape-image)}}}.ag-cell-editing-error .ag-checkbox-input-wrapper:focus-within{box-shadow:var(--ag-focus-error-shadow)}.ag-radio-button-input-wrapper{border-radius:100%;&:where(.ag-checked):after{-webkit-mask-image:var(--ag-radio-checked-shape-image);mask-image:var(--ag-radio-checked-shape-image)}}',QL=()=>To({feature:"checkboxStyle",params:{checkboxBorderWidth:1,checkboxBorderRadius:{ref:"borderRadius"},checkboxUncheckedBackgroundColor:Ni,checkboxUncheckedBorderColor:Ss(.3),checkboxCheckedBackgroundColor:Jo,checkboxCheckedBorderColor:{ref:"checkboxCheckedBackgroundColor"},checkboxCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="7" fill="none"><path stroke="#000" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.75" d="M1 3.5 3.5 6l5-5"/></svg>'},checkboxCheckedShapeColor:Ni,checkboxIndeterminateBackgroundColor:Ss(.3),checkboxIndeterminateBorderColor:{ref:"checkboxIndeterminateBackgroundColor"},checkboxIndeterminateShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="10" height="2" fill="none"><rect width="10" height="2" fill="#000" rx="1"/></svg>'},checkboxIndeterminateShapeColor:Ni,radioCheckedShapeImage:{svg:'<svg xmlns="http://www.w3.org/2000/svg" width="6" height="6" fill="none"><circle cx="3" cy="3" r="3" fill="#000"/></svg>'}},css:JL}),eB=QL(),CR=()=>({..._0,...VL,backgroundColor:"hsl(217, 0%, 17%)",foregroundColor:"#FFF",chromeBackgroundColor:Ss(.05),rowHoverColor:fo(.15),selectedRowBackgroundColor:fo(.2),menuBackgroundColor:Ss(.1),browserColorScheme:"dark",popupShadow:"0 0px 20px #000A",cardShadow:"0 1px 4px 1px #000A",advancedFilterBuilderJoinPillColor:"#7a3a37",advancedFilterBuilderColumnPillColor:"#355f2d",advancedFilterBuilderOptionPillColor:"#5a3168",advancedFilterBuilderValuePillColor:"#374c86",filterPanelApplyButtonColor:Iu,findMatchColor:Ni,findActiveMatchColor:Ni,checkboxUncheckedBorderColor:Ss(.4),toggleButtonOffBackgroundColor:Ss(.4),rowBatchEditBackgroundColor:Ss(.1)}),tB=()=>({...CR(),backgroundColor:"#1f2836"}),rB=()=>To({feature:"colorScheme",params:_0,modeParams:{light:_0,dark:CR(),"dark-blue":tB()}}),nB=rB(),xR={aggregation:'<path d="M18 7V4H6l6 8-6 8h12v-3"/>',arrows:'<polyline points="5 9 2 12 5 15"/><polyline points="9 5 12 2 15 5"/><polyline points="15 19 12 22 9 19"/><polyline points="19 9 22 12 19 15"/><line x1="2" x2="22" y1="12" y2="12"/><line x1="12" x2="12" y1="2" y2="22"/>',asc:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>',cancel:'<path d="m18 6-12 12"/><path d="m6 6 12 12"/>',chart:'<line x1="18" x2="18" y1="20" y2="10"/><line x1="12" x2="12" y1="20" y2="4"/><line x1="6" x2="6" y1="20" y2="14"/>',"color-picker":'<path d="m19 11-8-8-8.6 8.6a2 2 0 0 0 0 2.8l5.2 5.2c.8.8 2 .8 2.8 0L19 11Z"/><path d="m5 2 5 5"/><path d="M2 13h15"/><path d="M22 20a2 2 0 1 1-4 0c0-1.6 1.7-2.4 2-4 .3 1.6 2 2.4 2 4Z"/>',columns:'<path d="M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18"/>',contracted:'<path d="m9 18 6-6-6-6"/>',copy:'<rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>',cross:'<path d="M18 6 6 18"/><path d="m6 6 12 12"/>',csv:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',cut:'<circle cx="6" cy="6" r="3"/><path d="M8.12 8.12 12 12"/><path d="M20 4 8.12 15.88"/><circle cx="6" cy="18" r="3"/><path d="M14.8 14.8 20 20"/>',desc:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',down:'<path d="M12 5v14"/><path d="m19 12-7 7-7-7"/>',excel:'<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><path d="M8 13h2"/><path d="M8 17h2"/><path d="M14 13h2"/><path d="M14 17h2"/>',expanded:'<path d="m15 18-6-6 6-6"/>',eye:'<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/>',"eye-slash":'<path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" x2="22" y1="2" y2="22"/>',filter:'<path d="M3 6h18"/><path d="M7 12h10"/><path d="M10 18h4"/>',first:'<path d="m17 18-6-6 6-6"/><path d="M7 6v12"/>',grip:'<circle cx="5" cy="8" r="0.5"/><circle cx="12" cy="8" r="0.5"/><circle cx="19" cy="8" r="0.5"/><circle cx="5" cy="16" r="0.5"/><circle cx="12" cy="16" r="0.5"/><circle cx="19" cy="16" r="0.5"/><g stroke="none" fill="currentColor"><circle cx="5" cy="8" r="1"/><circle cx="12" cy="8" r="1"/><circle cx="19" cy="8" r="1"/><circle cx="5" cy="16" r="1"/><circle cx="12" cy="16" r="1"/><circle cx="19" cy="16" r="1"/></g>',group:'<path d="M16 12H3"/><path d="M16 18H3"/><path d="M10 6H3"/><path d="M21 18V8a2 2 0 0 0-2-2h-5"/><path d="m16 8-2-2 2-2"/>',last:'<path d="m7 18 6-6-6-6"/><path d="M17 6v12"/>',left:'<path d="m12 19-7-7 7-7"/><path d="M19 12H5"/>',linked:'<path d="M9 17H7A5 5 0 0 1 7 7h2"/><path d="M15 7h2a5 5 0 1 1 0 10h-2"/><line x1="8" x2="16" y1="12" y2="12"/>',loading:'<line x1="12" x2="12" y1="2" y2="6"/><line x1="12" x2="12" y1="18" y2="22"/><line x1="4.93" x2="7.76" y1="4.93" y2="7.76"/><line x1="16.24" x2="19.07" y1="16.24" y2="19.07"/><line x1="2" x2="6" y1="12" y2="12"/><line x1="18" x2="22" y1="12" y2="12"/><line x1="4.93" x2="7.76" y1="19.07" y2="16.24"/><line x1="16.24" x2="19.07" y1="7.76" y2="4.93"/>',maximize:'<polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/>',menu:'<line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/>',"menu-alt":'<circle cx="12" cy="5" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="12" r="0.75" fill="#D9D9D9"/><circle cx="12" cy="19" r="0.75" fill="#D9D9D9"/>',minimize:'<polyline points="4 14 10 14 10 20"/><polyline points="20 10 14 10 14 4"/><line x1="14" x2="21" y1="10" y2="3"/><line x1="3" x2="10" y1="21" y2="14"/>',minus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/>',next:'<path d="m9 18 6-6-6-6"/>',none:'<path d="m7 15 5 5 5-5"/><path d="m7 9 5-5 5 5"/>',"not-allowed":'<circle cx="12" cy="12" r="10"/><path d="m4.9 4.9 14.2 14.2"/>',paste:'<path d="M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z"/><path d="M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10"/><path d="m17 10 4 4-4 4"/>',pin:'<line x1="12" x2="12" y1="17" y2="22"/><path d="M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z"/>',pivot:'<path d="M15 3v18"/><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M21 9H3"/><path d="M21 15H3"/>',plus:'<circle cx="12" cy="12" r="10"/><path d="M8 12h8"/><path d="M12 8v8"/>',previous:'<path d="m15 18-6-6 6-6"/>',right:'<path d="M5 12h14"/><path d="m12 5 7 7-7 7"/>',save:'<path d="M12 17V3"/><path d="m6 11 6 6 6-6"/><path d="M19 21H5"/>',settings:'<path d="M20 7h-9"/><path d="M14 17H5"/><circle cx="17" cy="17" r="3"/><circle cx="7" cy="7" r="3"/>',"small-left":'<path d="m15 18-6-6 6-6"/>',"small-right":'<path d="m9 18 6-6-6-6"/>',tick:'<path d="M20 6 9 17l-5-5"/>',"tree-closed":'<path d="m9 18 6-6-6-6"/>',"tree-indeterminate":'<path d="M5 12h14"/>',"tree-open":'<path d="m6 9 6 6 6-6"/>',unlinked:'<path d="M9 17H7A5 5 0 0 1 7 7"/><path d="M15 7h2a5 5 0 0 1 4 8"/><line x1="8" x2="12" y1="12" y2="12"/><line x1="2" x2="22" y1="2" y2="22"/>',up:'<path d="m5 12 7-7 7 7"/><path d="M12 19V5"/>'},SR={aasc:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M13.2012 8.07928C13.6346 8.0793 14.0128 8.15365 14.3359 8.30193C14.6609 8.45018 14.9141 8.65595 15.0947 8.9201C15.2754 9.18439 15.3683 9.49109 15.374 9.83904H14.1904C14.1676 9.60898 14.0695 9.4303 13.8965 9.30291C13.7235 9.1756 13.4889 9.1115 13.1924 9.1115C12.9909 9.1115 12.8204 9.1404 12.6816 9.19744C12.543 9.25255 12.4364 9.32917 12.3623 9.42791C12.2901 9.52678 12.2539 9.63933 12.2539 9.76482C12.2501 9.8692 12.272 9.9604 12.3193 10.0383C12.3688 10.1162 12.4369 10.1843 12.5225 10.2414C12.6079 10.2964 12.7064 10.3451 12.8184 10.3869C12.9304 10.4268 13.0505 10.4609 13.1777 10.4894L13.7031 10.6144C13.9578 10.6715 14.1914 10.7479 14.4043 10.8429C14.6173 10.938 14.8021 11.0547 14.958 11.1935C15.1138 11.3323 15.2348 11.4957 15.3203 11.6838C15.4077 11.8719 15.4522 12.088 15.4541 12.3312C15.4522 12.6885 15.3611 12.9986 15.1807 13.2609C15.0019 13.5214 14.7427 13.7248 14.4043 13.8693C14.0678 14.0118 13.6617 14.0832 13.1865 14.0832C12.7153 14.0832 12.3048 14.0107 11.9551 13.8664C11.6071 13.7219 11.3345 13.5071 11.1387 13.2238C10.9449 12.9387 10.8435 12.5862 10.834 12.1662H12.0283C12.0416 12.362 12.0984 12.5252 12.1973 12.6564C12.298 12.7857 12.4323 12.8838 12.5996 12.9504C12.7688 13.0149 12.96 13.047 13.1729 13.047C13.3817 13.047 13.563 13.0169 13.7168 12.9562C13.8727 12.8954 13.9935 12.8106 14.0791 12.7023C14.1647 12.5939 14.208 12.469 14.208 12.3283C14.2079 12.1974 14.1686 12.0875 14.0908 11.9982C14.0148 11.9089 13.9022 11.8324 13.7539 11.7697C13.6076 11.707 13.4276 11.6501 13.2148 11.5988L12.5791 11.4387C12.0869 11.3189 11.6982 11.1318 11.4131 10.8771C11.128 10.6224 10.9855 10.2793 10.9873 9.84783C10.9854 9.49418 11.0804 9.18439 11.2705 8.9201C11.4625 8.65603 11.7261 8.45015 12.0605 8.30193C12.3951 8.15369 12.7754 8.07928 13.2012 8.07928Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M5.8125 14.0002H4.48926L4.05664 12.6681H1.94824L1.51465 14.0002H0.19043L2.20703 8.15935H3.79883L5.8125 14.0002ZM2.26172 11.7043H3.74316L3.02539 9.49334H2.98047L2.26172 11.7043Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M8.45215 8.15935C8.88165 8.15935 9.24031 8.22251 9.52734 8.34978C9.81445 8.47717 10.0303 8.65477 10.1748 8.88103C10.3192 9.10536 10.3916 9.36368 10.3916 9.65642C10.3916 9.88452 10.3461 10.085 10.2549 10.258C10.1637 10.4289 10.0384 10.5696 9.87891 10.6799C9.72117 10.7882 9.54024 10.8657 9.33691 10.9113V10.9679C9.55917 10.9775 9.76716 11.0406 9.96094 11.1564C10.1568 11.2724 10.3158 11.4356 10.4375 11.6447C10.5591 11.8519 10.6201 12.099 10.6201 12.3859C10.6201 12.6958 10.5427 12.9727 10.3887 13.216C10.2366 13.4573 10.0113 13.6486 9.71289 13.7892C9.41443 13.9299 9.04655 14.0002 8.60938 14.0002H6.11426V8.15935H8.45215ZM7.34863 12.9904H8.35547C8.69943 12.9904 8.95057 12.9252 9.1084 12.7941C9.26621 12.661 9.34473 12.4834 9.34473 12.2629C9.34468 12.1014 9.30643 11.9587 9.22852 11.8351C9.15056 11.7116 9.03903 11.6145 8.89453 11.5441C8.75195 11.4738 8.58148 11.4387 8.38379 11.4387H7.34863V12.9904ZM7.34863 10.6037H8.26465C8.43369 10.6036 8.58376 10.5737 8.71484 10.5148C8.84793 10.454 8.95227 10.3683 9.02832 10.258C9.10628 10.1477 9.14551 10.0155 9.14551 9.8615C9.14546 9.65055 9.07008 9.48001 8.91992 9.35076C8.77165 9.22169 8.56064 9.15741 8.28711 9.1574H7.34863V10.6037Z" fill="black"/><path d="M7.16602 0.377127C7.44584 0.189493 7.82551 0.20905 8.08496 0.442557L11.418 3.44256C11.7257 3.71966 11.7507 4.19428 11.4736 4.50213C11.1966 4.80961 10.7228 4.83441 10.415 4.55779L7.60938 2.03338L5.11328 4.53045C4.82042 4.82326 4.34562 4.82322 4.05273 4.53045C3.75986 4.23757 3.75989 3.7628 4.05273 3.4699L7.05273 0.4699L7.16602 0.377127Z" fill="black"/></svg>',adesc:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.3867 11.4697C10.6796 11.1771 11.1544 11.1769 11.4473 11.4697C11.7399 11.7626 11.7399 12.2374 11.4473 12.5303L8.44727 15.5303L8.33398 15.623C8.05425 15.8106 7.67449 15.7909 7.41504 15.5576L4.08203 12.5576C3.77415 12.2805 3.74927 11.8059 4.02637 11.498C4.30342 11.1907 4.77722 11.1657 5.08496 11.4424L7.89062 13.9668L10.3867 11.4697Z" fill="black"/><path d="M13.2012 3.0791C13.6346 3.07912 14.0128 3.1535 14.3359 3.30176C14.6611 3.45006 14.9141 3.65661 15.0947 3.9209C15.2752 4.18513 15.3683 4.49104 15.374 4.83887H14.1904C14.1676 4.60882 14.0695 4.43012 13.8965 4.30273C13.7235 4.17546 13.4889 4.11133 13.1924 4.11133C12.9909 4.11133 12.8204 4.14023 12.6816 4.19727C12.5431 4.25236 12.4364 4.32902 12.3623 4.42773C12.2901 4.52659 12.2539 4.63919 12.2539 4.76465C12.2501 4.86901 12.272 4.96023 12.3193 5.03809C12.3688 5.11604 12.4369 5.18417 12.5225 5.24121C12.6079 5.29623 12.7064 5.34496 12.8184 5.38672C12.9304 5.42661 13.0505 5.46075 13.1777 5.48926L13.7031 5.61426C13.9578 5.67128 14.1914 5.74776 14.4043 5.84277C14.6172 5.93784 14.8021 6.05457 14.958 6.19336C15.1139 6.33216 15.2348 6.49633 15.3203 6.68457C15.4076 6.8727 15.4522 7.08885 15.4541 7.33203C15.4521 7.68929 15.3612 7.99944 15.1807 8.26172C15.0019 8.52216 14.7427 8.72465 14.4043 8.86914C14.0678 9.01165 13.6617 9.08301 13.1865 9.08301C12.7153 9.08299 12.3048 9.01057 11.9551 8.86621C11.6072 8.72173 11.3345 8.50786 11.1387 8.22461C10.9447 7.9394 10.8435 7.58622 10.834 7.16602H12.0283C12.0416 7.36176 12.0985 7.52509 12.1973 7.65625C12.298 7.78554 12.4323 7.88365 12.5996 7.9502C12.7688 8.01477 12.96 8.04785 13.1729 8.04785C13.3817 8.04781 13.5629 8.01678 13.7168 7.95605C13.8727 7.89522 13.9935 7.81051 14.0791 7.70215C14.1646 7.59387 14.2079 7.46965 14.208 7.3291C14.208 7.19796 14.1687 7.08739 14.0908 6.99805C14.0148 6.90868 13.9022 6.83228 13.7539 6.76953C13.6076 6.70685 13.4276 6.64993 13.2148 6.59863L12.5791 6.43848C12.0868 6.31871 11.6982 6.13163 11.4131 5.87695C11.1279 5.62221 10.9855 5.27916 10.9873 4.84766C10.9854 4.49404 11.0804 4.18517 11.2705 3.9209C11.4625 3.65661 11.7259 3.45006 12.0605 3.30176C12.3951 3.15353 12.7754 3.0791 13.2012 3.0791Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M5.8125 9H4.48926L4.05664 7.66797H1.94824L1.51465 9H0.19043L2.20703 3.15918H3.79883L5.8125 9ZM2.26172 6.7041H3.74316L3.02539 4.49414H2.98047L2.26172 6.7041Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M8.45215 3.15918C8.88181 3.15918 9.24025 3.22322 9.52734 3.35059C9.81445 3.47798 10.0303 3.6546 10.1748 3.88086C10.3193 4.10518 10.3916 4.36351 10.3916 4.65625C10.3916 4.88432 10.3461 5.08484 10.2549 5.25781C10.1636 5.4289 10.0386 5.57039 9.87891 5.68066C9.72118 5.78898 9.54022 5.86549 9.33691 5.91113V5.96875C9.55913 5.9783 9.76719 6.04044 9.96094 6.15625C10.1568 6.27223 10.3158 6.43538 10.4375 6.64453C10.5591 6.85173 10.6201 7.09875 10.6201 7.38574C10.6201 7.69567 10.5427 7.97245 10.3887 8.21582C10.2366 8.45719 10.0113 8.64841 9.71289 8.78906C9.41442 8.9297 9.04658 8.99999 8.60938 9H6.11426V3.15918H8.45215ZM7.34863 7.99023H8.35547C8.69948 7.99023 8.95057 7.92504 9.1084 7.79395C9.26621 7.66085 9.34473 7.48325 9.34473 7.2627C9.34466 7.10125 9.3064 6.95844 9.22852 6.83496C9.15056 6.71143 9.03899 6.61427 8.89453 6.54395C8.75196 6.47365 8.58145 6.43848 8.38379 6.43848H7.34863V7.99023ZM7.34863 5.60352H8.26465C8.43369 5.60347 8.58376 5.57354 8.71484 5.51465C8.84791 5.45381 8.95228 5.36807 9.02832 5.25781C9.10623 5.14755 9.14551 5.01529 9.14551 4.86133C9.14542 4.65046 9.07002 4.48078 8.91992 4.35156C8.77163 4.22228 8.56087 4.15724 8.28711 4.15723H7.34863V5.60352Z" fill="black"/></svg>',"chevron-down":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M12 6L8 10L4 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-left":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 12L6 8L10 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-right":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M6 12L10 8L6 4" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"chevron-up":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M4 10L8 6L12 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>',"column-arrow":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 32 32"><path fill-rule="evenodd" clip-rule="evenodd" d="M0 26C0 28.2092 1.79086 30 4 30H14C16.2091 30 18 28.2092 18 26V15H25.8786L24.4394 16.4393C23.8536 17.0251 23.8536 17.9749 24.4394 18.5607C25.0252 19.1464 25.9748 19.1464 26.5606 18.5607L30.5606 14.5607C31.1464 13.9749 31.1464 13.0251 30.5606 12.4393L26.5606 8.43934C25.9748 7.85356 25.0252 7.85356 24.4394 8.43934C23.8536 9.02512 23.8536 9.97488 24.4394 10.5607L25.8786 12H18V6C18 3.79086 16.2091 2 14 2H4C1.79086 2 0 3.79086 0 6V26ZM14 5H10.5V12H15V6C15 5.44772 14.5523 5 14 5ZM4 5H7.5V12H3V6C3 5.44772 3.44772 5 4 5ZM10.5 15H15V26C15 26.5522 14.5523 27 14 27H10.5V15ZM4 27H7.5V15H3V26C3 26.5522 3.44772 27 4 27Z" fill="currentColor"/></svg>',edit:'<svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M3.5 10.6262V12.5012H5.375L10.905 6.97122L9.03 5.09622L3.5 10.6262ZM12.355 5.52122C12.4014 5.47497 12.4381 5.42002 12.4632 5.35953C12.4883 5.29905 12.5012 5.23421 12.5012 5.16872C12.5012 5.10324 12.4883 5.0384 12.4632 4.97791C12.4381 4.91742 12.4014 4.86248 12.355 4.81622L11.185 3.64622C11.1387 3.59987 11.0838 3.5631 11.0233 3.53801C10.9628 3.51291 10.898 3.5 10.8325 3.5C10.767 3.5 10.7022 3.51291 10.6417 3.53801C10.5812 3.5631 10.5263 3.59987 10.48 3.64622L9.565 4.56122L11.44 6.43622L12.355 5.52122Z" fill="currentColor"/></svg>',"filter-add":'<svg width="16" height="16" viewBox="0 0 16 16" class="ag-icon" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.12126 7.75L10.8517 7.75" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M6.65934 11.748L9.32778 11.748" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M12.2943 1.04872V6.19184M14.9886 3.74341H9.68478" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/><path d="M8.25488 3C8.04799 3.18323 7.91706 3.45099 7.91699 3.74902C7.91713 4.04868 8.04988 4.31681 8.25879 4.5H2C1.58579 4.5 1.25 4.16421 1.25 3.75C1.25 3.33579 1.58579 3 2 3H8.25488Z" fill="currentColor"/></svg>',"pinned-bottom":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M3.47 12.28A.75.75 0 0 1 4 11h8a.75.75 0 0 1 0 1.5H4a.75.75 0 0 1-.53-.22ZM12.731 5.256a.75.75 0 0 1-.2.524l-4 4a.75.75 0 0 1-1.06 0l-4-4a.75.75 0 1 1 1.06-1.06l2.72 2.72V2a.75.75 0 0 1 1.5 0v5.44l2.72-2.72a.75.75 0 0 1 1.26.536Z"/></svg>',"pinned-top":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" viewBox="0 0 16 16"><path fill="currentColor" d="M12.53 3.72A.75.75 0 0 1 12 5H4a.75.75 0 0 1 0-1.5h8a.75.75 0 0 1 .53.22ZM3.269 10.744a.75.75 0 0 1 .2-.524l4-4a.75.75 0 0 1 1.06 0l4 4a.75.75 0 1 1-1.06 1.06L8.75 8.56V14a.75.75 0 0 1-1.5 0V8.56l-2.72 2.72a.75.75 0 0 1-1.26-.536Z"/></svg>',"small-down":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 10.667 16 21.334l8.667-10.667H7.334Z"/></svg>',"small-up":'<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="black" stroke="none" viewBox="0 0 32 32"><path d="M7.334 21.333 16 10.666l8.667 10.667H7.334Z"/></svg>',"un-pin":'<svg xmlns="http://www.w3.org/2000/svg" fill="none" class="ag-icon" viewBox="0 0 16 16"><path fill="currentColor" d="M8 11a.75.75 0 0 0-.75.75v3.333a.75.75 0 1 0 1.5 0V11.75A.75.75 0 0 0 8 11Z"/><path fill="currentColor" d="M13.11 1.436a.75.75 0 0 0-1.22-.872l-10 14a.75.75 0 1 0 1.22.872L5.207 12.5h7.376a.75.75 0 0 0 .75-.75v-1.174a2.08 2.08 0 0 0-1.153-1.863l-1.185-.599-.005-.002a.58.58 0 0 1-.323-.522V5.165a2.083 2.083 0 0 0 1.854-2.904l.589-.825Zm-3.943 5.52v.634a2.08 2.08 0 0 0 1.153 1.863l1.185.6.005.002a.58.58 0 0 1 .323.522V11H6.28l2.887-4.044ZM9.277 1H5.25a2.084 2.084 0 0 0-.083 4.165v1.676l1.5-2.132v-.292a.75.75 0 0 0-.75-.75H5.25a.584.584 0 0 1 0-1.167h2.972L9.277 1Z"/></svg>'},iB=(e={})=>{let t="";for(const r of[...Object.keys(xR),...Object.keys(SR)]){const n=sB(r,e.strokeWidth);t+=`.ag-icon-${r}::before { mask-image: url('data:image/svg+xml,${encodeURIComponent(n)}'); }
`}return t},sB=(e,t=1.5)=>{const r=SR[e];if(r)return r;const n=xR[e];if(!n)throw new Error(`Missing icon data for ${e}`);return`<svg xmlns="http://www.w3.org/2000/svg" class="ag-icon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke="black" stroke-width="${t}" viewBox="0 0 24 24"><style>* { vector-effect: non-scaling-stroke; }</style>`+n+"</svg>"},oB=(e={})=>To({feature:"iconSet",css:()=>iB(e)}),aB=oB(),lB=':where(.ag-input-field-input[type=number]:not(.ag-number-field-input-stepper)){-webkit-appearance:textfield;-moz-appearance:textfield;appearance:textfield;&::-webkit-inner-spin-button,&::-webkit-outer-spin-button{-webkit-appearance:none;appearance:none;margin:0}}.ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){background-color:var(--ag-input-background-color);border:var(--ag-input-border);border-radius:var(--ag-input-border-radius);color:var(--ag-input-text-color);font-family:inherit;font-size:inherit;line-height:inherit;margin:0;min-height:var(--ag-input-height);padding:0;&:where(:disabled){background-color:var(--ag-input-disabled-background-color);border:var(--ag-input-disabled-border);color:var(--ag-input-disabled-text-color)}&:where(:focus){background-color:var(--ag-input-focus-background-color);border:var(--ag-input-focus-border);box-shadow:var(--ag-input-focus-shadow);color:var(--ag-input-focus-text-color);outline:none}&:where(:invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&:where(.invalid){background-color:var(--ag-input-invalid-background-color);border:var(--ag-input-invalid-border);color:var(--ag-input-invalid-text-color)}&::-moz-placeholder{color:var(--ag-input-placeholder-text-color)}&::placeholder{color:var(--ag-input-placeholder-text-color)}}:where(.ag-ltr) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-left:var(--ag-input-padding-start)}:where(.ag-rtl) .ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){padding-right:var(--ag-input-padding-start)}:where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select,.ag-floating-filter-search-icon){.ag-input-wrapper:before{background-color:currentcolor;color:var(--ag-input-icon-color);content:"";display:block;height:12px;-webkit-mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");mask-image:url("data:image/svg+xml;charset=utf-8;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMiIgaGVpZ2h0PSIxMiIgZmlsbD0ibm9uZSIgc3Ryb2tlPSIjMDAwIiBzdHJva2UtbGluZWNhcD0icm91bmQiIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iMS41Ij48cGF0aCBkPSJNNS4zIDlhMy43IDMuNyAwIDEgMCAwLTcuNSAzLjcgMy43IDAgMCAwIDAgNy41Wk0xMC41IDEwLjUgOC4zIDguMiIvPjwvc3ZnPg==");-webkit-mask-position:center;mask-position:center;-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;opacity:.5;position:absolute;width:12px}}:where(.ag-ltr) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select,.ag-floating-filter-search-icon){.ag-input-wrapper:before{margin-left:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-left:calc(var(--ag-spacing)*1.5 + 12px)}}:where(.ag-rtl) :where(.ag-column-select-header-filter-wrapper,.ag-filter-toolpanel-search,.ag-mini-filter,.ag-filter-filter,.ag-filter-add-select,.ag-floating-filter-search-icon){.ag-input-wrapper:before{margin-right:var(--ag-spacing)}.ag-number-field-input,.ag-text-field-input{padding-right:calc(var(--ag-spacing)*1.5 + 12px)}}',cB=".ag-input-field-input:where(input:not([type]),input[type=text],input[type=number],input[type=tel],input[type=date],input[type=datetime-local],textarea){&:focus{box-shadow:var(--ag-focus-shadow);&:where(.invalid),&:where(:invalid){box-shadow:var(--ag-focus-error-shadow)}}}",uB={inputBackgroundColor:"transparent",inputBorder:!1,inputBorderRadius:0,inputTextColor:{ref:"textColor"},inputPlaceholderTextColor:{ref:"inputTextColor",mix:.5},inputPaddingStart:0,inputHeight:{calc:"max(iconSize, fontSize) + spacing * 2"},inputFocusBackgroundColor:{ref:"inputBackgroundColor"},inputFocusBorder:{ref:"inputBorder"},inputFocusShadow:"none",inputFocusTextColor:{ref:"inputTextColor"},inputDisabledBackgroundColor:{ref:"inputBackgroundColor"},inputDisabledBorder:{ref:"inputBorder"},inputDisabledTextColor:{ref:"inputTextColor"},inputInvalidBackgroundColor:{ref:"inputBackgroundColor"},inputInvalidBorder:{ref:"inputBorder"},inputInvalidTextColor:{ref:"inputTextColor"},inputIconColor:{ref:"inputTextColor"},pickerButtonBorder:!1,pickerButtonFocusBorder:{ref:"inputFocusBorder"},pickerButtonBackgroundColor:{ref:"backgroundColor"},pickerButtonFocusBackgroundColor:{ref:"backgroundColor"},pickerListBorder:!1,pickerListBackgroundColor:{ref:"backgroundColor"},colorPickerThumbSize:18,colorPickerTrackSize:12,colorPickerThumbBorderWidth:3,colorPickerTrackBorderRadius:12,colorPickerColorBorderRadius:4},dB=()=>To({feature:"inputStyle",params:{...uB,inputBackgroundColor:Ni,inputBorder:!0,inputBorderRadius:{ref:"borderRadius"},inputPaddingStart:{ref:"spacing"},inputFocusBorder:{color:Jo},inputFocusShadow:{ref:"focusShadow"},inputDisabledBackgroundColor:Ss(.06),inputDisabledTextColor:{ref:"textColor",mix:.5},inputInvalidBorder:{color:{ref:"invalidColor"}},pickerButtonBorder:!0,pickerListBorder:!0},css:()=>lB+cB}),hB=dB(),fB='.ag-tabs-header{background-color:var(--ag-tab-bar-background-color);border-bottom:var(--ag-tab-bar-border);display:flex;flex:1;gap:var(--ag-tab-spacing);padding:var(--ag-tab-bar-top-padding) var(--ag-tab-bar-horizontal-padding) 0}.ag-tabs-header-wrapper{display:flex}.ag-tabs-close-button-wrapper{align-items:center;border:0;display:flex;padding:var(--ag-spacing)}:where(.ag-ltr) .ag-tabs-close-button-wrapper{border-right:solid var(--ag-border-width) var(--ag-border-color)}:where(.ag-rtl) .ag-tabs-close-button-wrapper{border-left:solid var(--ag-border-width) var(--ag-border-color)}.ag-tabs-close-button{background-color:unset;border:0;cursor:pointer;padding:0}.ag-tab{align-items:center;background-color:var(--ag-tab-background-color);border-left:var(--ag-tab-selected-border-width) solid transparent;border-right:var(--ag-tab-selected-border-width) solid transparent;color:var(--ag-tab-text-color);cursor:pointer;display:flex;flex:1;justify-content:center;padding:var(--ag-tab-top-padding) var(--ag-tab-horizontal-padding) var(--ag-tab-bottom-padding);position:relative;&:hover{background-color:var(--ag-tab-hover-background-color);color:var(--ag-tab-hover-text-color)}&.ag-tab-selected{background-color:var(--ag-tab-selected-background-color);color:var(--ag-tab-selected-text-color)}&:after{background-color:var(--ag-tab-selected-underline-color);bottom:0;content:"";display:block;height:var(--ag-tab-selected-underline-width);left:0;opacity:0;position:absolute;right:0;transition:opacity var(--ag-tab-selected-underline-transition-duration)}&.ag-tab-selected:after{opacity:1}}:where(.ag-ltr) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-left-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-right-color:var(--ag-tab-selected-border-color)}}}:where(.ag-rtl) .ag-tab{&.ag-tab-selected{&:where(:not(:first-of-type)){border-right-color:var(--ag-tab-selected-border-color)}&:where(:not(:last-of-type)){border-left-color:var(--ag-tab-selected-border-color)}}}',pB={tabBarBackgroundColor:"transparent",tabBarHorizontalPadding:0,tabBarTopPadding:0,tabBackgroundColor:"transparent",tabTextColor:{ref:"textColor"},tabHorizontalPadding:{ref:"spacing"},tabTopPadding:{ref:"spacing"},tabBottomPadding:{ref:"spacing"},tabSpacing:"0",tabHoverBackgroundColor:{ref:"tabBackgroundColor"},tabHoverTextColor:{ref:"tabTextColor"},tabSelectedBackgroundColor:{ref:"tabBackgroundColor"},tabSelectedTextColor:{ref:"tabTextColor"},tabSelectedBorderWidth:{ref:"borderWidth"},tabSelectedBorderColor:"transparent",tabSelectedUnderlineColor:"transparent",tabSelectedUnderlineWidth:0,tabSelectedUnderlineTransitionDuration:0,tabBarBorder:!1},gB=()=>To({feature:"tabStyle",params:{...pB,tabBarBorder:!0,tabBarBackgroundColor:bs(.05),tabTextColor:{ref:"textColor",mix:.7},tabSelectedTextColor:{ref:"textColor"},tabHoverTextColor:{ref:"textColor"},tabSelectedBorderColor:{ref:"borderColor"},tabSelectedBackgroundColor:Ni},css:fB}),mB=gB(),vB=()=>ZL().withPart(eB).withPart(nB).withPart(aB).withPart(mB).withPart(hB).withPart(yR).withParams({fontFamily:[{googleFont:"IBM Plex Sans"},"-apple-system","BlinkMacSystemFont","Segoe UI","Roboto","Oxygen-Sans","Ubuntu"]}),bB=vB(),wB={cssName:"--ag-cell-horizontal-padding",changeKey:"cellHorizontalPaddingChanged",defaultValue:16},yB={cssName:"--ag-indentation-level",changeKey:"indentationLevelChanged",defaultValue:0,noWarn:!0,cacheDefault:!0},CB={cssName:"--ag-row-group-indent-size",changeKey:"rowGroupIndentSizeChanged",defaultValue:0},I4={cssName:"--ag-row-height",changeKey:"rowHeightChanged",defaultValue:42},O4={cssName:"--ag-header-height",changeKey:"headerHeightChanged",defaultValue:48},hb={cssName:"--ag-row-border",changeKey:"rowBorderWidthChanged",defaultValue:1,border:!0},N4={cssName:"--ag-pinned-row-border",changeKey:"pinnedRowBorderWidthChanged",defaultValue:1,border:!0};function xB(e,t){for(const r of t.sort((n,i)=>n.moduleName.localeCompare(i.moduleName))){const n=r.css;n&&e.set(`module-${r.moduleName}`,n)}}var SB=class extends l9{initVariables(){this.addManagedPropertyListener("rowHeight",()=>this.refreshRowHeightVariable()),this.getSizeEl(I4),this.getSizeEl(O4),this.getSizeEl(hb),this.getSizeEl(N4),this.refreshRowBorderWidthVariable()}getPinnedRowBorderWidth(){return this.getCSSVariablePixelValue(N4)}getRowBorderWidth(){return this.getCSSVariablePixelValue(hb)}getDefaultRowHeight(){return this.getCSSVariablePixelValue(I4)}getDefaultHeaderHeight(){return this.getCSSVariablePixelValue(O4)}getDefaultCellHorizontalPadding(){return this.getCSSVariablePixelValue(wB)}getCellPaddingLeft(){const e=this.getDefaultCellHorizontalPadding(),t=this.getCSSVariablePixelValue(yB),r=this.getCSSVariablePixelValue(CB);return e-1+r*t}getCellPadding(){const e=this.getDefaultCellHorizontalPadding()-1;return this.getCellPaddingLeft()+e}getDefaultColumnMinWidth(){return Math.min(36,this.getDefaultRowHeight())}refreshRowHeightVariable(){const{eRootDiv:e}=this,t=e.style.getPropertyValue("--ag-line-height").trim(),r=this.gos.get("rowHeight");if(r==null||isNaN(r)||!isFinite(r))return t!==null&&e.style.setProperty("--ag-line-height",null),-1;const n=`${r}px`;return t!=n?(e.style.setProperty("--ag-line-height",n),r):t!=""?Number.parseFloat(t):-1}fireStylesChangedEvent(e){e==="rowBorderWidthChanged"&&this.refreshRowBorderWidthVariable(),super.fireStylesChangedEvent(e)}refreshRowBorderWidthVariable(){const e=this.getCSSVariablePixelValue(hb);this.eRootDiv.style.setProperty("--ag-internal-row-border-width",`${e}px`)}postProcessThemeChange(e,t){e&&getComputedStyle(this.getMeasurementContainer()).getPropertyValue("--ag-legacy-styles-loaded")&&Ar(t?106:239)}getAdditionalCss(){const e=new Map;return e.set("core",[BL]),xB(e,Array.from(yD())),e}getDefaultTheme(){return bB}varError(e){at(9,{variable:e})}themeError(e){Ar(240,{theme:e})}shadowRootError(){Ar(293)}},_B=class extends d9{postConstruct(){const{globalListener:e,globalSyncListener:t}=this.beans;e&&this.addGlobalListener(e,!0),t&&this.addGlobalListener(t,!1)}};function _R(e,t,r){const n=e.visibleCols.headerGroupRowCount;if(r>=n)return{column:t,headerRowIndex:r};let i=t.getParent();for(;i&&i.getProvidedColumnGroup().getLevel()>r;)i=i.getParent();const s=t.isSpanHeaderHeight();return!i||s&&i.isPadding()?{column:t,headerRowIndex:n}:{column:i,headerRowIndex:i.getProvidedColumnGroup().getLevel()}}var EB=class extends et{constructor(){super(...arguments),this.beanName="headerNavigation",this.currentHeaderRowWithoutSpan=-1}postConstruct(){const e=this.beans;e.ctrlsSvc.whenReady(this,r=>{this.gridBodyCon=r.gridBodyCtrl});const t=Gn(e);this.addManagedElementListeners(t,{mousedown:()=>{this.currentHeaderRowWithoutSpan=-1}})}getHeaderPositionForColumn(e,t){let r;const{colModel:n,colGroupSvc:i,ctrlsSvc:s}=this.beans;if(typeof e=="string"?(r=n.getCol(e),r||(r=i?.getColumnGroup(e)??null)):r=e,!r)return null;const a=s.getHeaderRowContainerCtrl()?.getAllCtrls(),l=zr(a||[]).type==="filter",c=yo(this.beans)-1;let u=-1,h=r;for(;h;)u++,h=h.getParent();let d=u;return t&&l&&d===c-1&&d++,d===-1?null:{headerRowIndex:d,column:r}}navigateVertically(e,t){const{focusSvc:r,visibleCols:n}=this.beans,{focusedHeader:i}=r;if(!i)return!1;const{headerRowIndex:s}=i,o=i.column,a=yo(this.beans),l=this.getHeaderRowType(s),c=n.headerGroupRowCount;let{headerRowIndex:u,column:h,headerRowIndexWithoutSpan:d}=e==="UP"?TB(l,o,s):kB(o,s,c),f=!1;return u<0&&(u=0,h=o,f=!0),u>=a?(u=-1,this.currentHeaderRowWithoutSpan=-1):d!==void 0&&(this.currentHeaderRowWithoutSpan=d),!f&&!h?!1:r.focusHeaderPosition({headerPosition:{headerRowIndex:u,column:h},allowUserOverride:!0,event:t})}navigateHorizontally(e,t=!1,r){const{focusSvc:n,gos:i}=this.beans,s={...n.focusedHeader};let o,a;this.currentHeaderRowWithoutSpan!==-1?s.headerRowIndex=this.currentHeaderRowWithoutSpan:this.currentHeaderRowWithoutSpan=s.headerRowIndex,e==="LEFT"!==i.get("enableRtl")?(a="Before",o=this.findHeader(s,a)):(a="After",o=this.findHeader(s,a));const l=i.getCallback("tabToNextHeader");if(t&&l){const c=n.focusHeaderPositionFromUserFunc({userFunc:l,headerPosition:o,direction:a});if(c){const{headerRowIndex:u}=n.focusedHeader||{};u!=null&&u!=s.headerRowIndex&&(this.currentHeaderRowWithoutSpan=u)}return c}return o||!t?n.focusHeaderPosition({headerPosition:o,direction:a,fromTab:t,allowUserOverride:!0,event:r}):this.focusNextHeaderRow(s,a,r)}focusNextHeaderRow(e,t,r){const n=this.beans,i=e.headerRowIndex;let s=null,o;const a=yo(n),l=this.beans.visibleCols.allCols;if(t==="Before"){if(i<=0)return!1;s=zr(l),o=i-1,this.currentHeaderRowWithoutSpan-=1}else s=l[0],o=i+1,this.currentHeaderRowWithoutSpan<a?this.currentHeaderRowWithoutSpan+=1:this.currentHeaderRowWithoutSpan=-1;let{column:c,headerRowIndex:u}=_R(this.beans,s,o);return u>=a&&(u=-1),n.focusSvc.focusHeaderPosition({headerPosition:{column:c,headerRowIndex:u},direction:t,fromTab:!0,allowUserOverride:!0,event:r})}scrollToColumn(e,t="After"){if(e.getPinned())return;let r;if(yn(e)){const n=e.getDisplayedLeafColumns();r=t==="Before"?zr(n):n[0]}else r=e;this.gridBodyCon.scrollFeature.ensureColumnVisible(r)}findHeader(e,t){const{colGroupSvc:r,visibleCols:n}=this.beans;let i=e.column;if(i instanceof gf){const l=i.getDisplayedLeafColumns();i=t==="Before"?l[0]:l[l.length-1]}const s=t==="Before"?n.getColBefore(i):n.getColAfter(i);if(!s)return;const o=n.headerGroupRowCount;if(e.headerRowIndex>=o)return{headerRowIndex:e.headerRowIndex,column:s};const a=r?.getColGroupAtLevel(s,e.headerRowIndex);return a?a.isPadding()&&s.isSpanHeaderHeight()?{headerRowIndex:n.headerGroupRowCount,column:s}:{headerRowIndex:e.headerRowIndex,column:a??s}:{headerRowIndex:s instanceof Fc&&s.isSpanHeaderHeight()?n.headerGroupRowCount:e.headerRowIndex,column:s}}getHeaderRowType(e){const t=this.beans.ctrlsSvc.getHeaderRowContainerCtrl();if(t)return t.getRowType(e)}};function TB(e,t,r){const n=r-1;if(e!=="filter"){const i=t instanceof Fc&&t.isSpanHeaderHeight();let s=t.getParent();for(;s&&(s.getProvidedColumnGroup().getLevel()>n||i&&s.isPadding());)s=s.getParent();if(s)return i?{column:s,headerRowIndex:s.getProvidedColumnGroup().getLevel(),headerRowIndexWithoutSpan:n}:{column:s,headerRowIndex:n,headerRowIndexWithoutSpan:n}}return{column:t,headerRowIndex:n,headerRowIndexWithoutSpan:n}}function kB(e,t,r){const n=t+1,i={column:e,headerRowIndex:n,headerRowIndexWithoutSpan:n};if(e instanceof gf){if(n>=r)return{column:e.getDisplayedLeafColumns()[0],headerRowIndex:r,headerRowIndexWithoutSpan:n};let o=e.getDisplayedChildren()[0];if(o instanceof gf&&o.isPadding()){const l=o.getDisplayedLeafColumns()[0];l.isSpanHeaderHeight()&&(o=l)}i.column=o,o instanceof Fc&&o.isSpanHeaderHeight()&&(i.headerRowIndex=r,i.headerRowIndexWithoutSpan=n)}return i}var RB=class extends et{constructor(){super(...arguments),this.beanName="focusSvc",this.focusFallbackTimeout=null,this.needsFocusRestored=!1}wireBeans(e){this.colModel=e.colModel,this.visibleCols=e.visibleCols,this.rowRenderer=e.rowRenderer,this.navigation=e.navigation,this.filterManager=e.filterManager,this.overlays=e.overlays}postConstruct(){const e=this.clearFocusedCell.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:this.onColumnEverythingChanged.bind(this),columnGroupOpened:e,columnRowGroupChanged:e}),this.addDestroyFunc(c7(this.beans))}attemptToRecoverFocus(){this.needsFocusRestored=!0,this.focusFallbackTimeout!=null&&clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=window.setTimeout(this.setFocusRecovered.bind(this),100)}setFocusRecovered(){this.needsFocusRestored=!1,this.focusFallbackTimeout!=null&&(clearTimeout(this.focusFallbackTimeout),this.focusFallbackTimeout=null)}shouldTakeFocus(){return this.gos.get("suppressFocusAfterRefresh")?(this.setFocusRecovered(),!1):this.needsFocusRestored?(this.setFocusRecovered(),!0):this.doesRowOrCellHaveBrowserFocus()}onColumnEverythingChanged(){if(!this.focusedCell)return;const e=this.focusedCell.column,t=this.colModel.getCol(e.getId());e!==t&&this.clearFocusedCell()}getFocusCellToUseAfterRefresh(){const{gos:e,focusedCell:t}=this;return e.get("suppressFocusAfterRefresh")||e.get("suppressCellFocus")||!t||!this.doesRowOrCellHaveBrowserFocus()?null:t}getFocusHeaderToUseAfterRefresh(){return this.gos.get("suppressFocusAfterRefresh")||!this.focusedHeader||!this.isDomDataPresentInHierarchy(tn(this.beans),aR)?null:this.focusedHeader}doesRowOrCellHaveBrowserFocus(){const e=tn(this.beans);return this.isDomDataPresentInHierarchy(e,E0)?!0:this.isDomDataPresentInHierarchy(e,T0)}isDomDataPresentInHierarchy(e,t){let r=e;for(;r;){if(KT(this.gos,r,t))return!0;r=r.parentNode}return!1}getFocusedCell(){return this.focusedCell}getFocusEventParams(e){const{rowIndex:t,rowPinned:r,column:n}=e,i={rowIndex:t,rowPinned:r,column:n,isFullWidthCell:!1},s=this.rowRenderer.getRowByPosition({rowIndex:t,rowPinned:r});return s&&(i.isFullWidthCell=s.isFullWidth()),i}clearFocusedCell(){if(this.focusedCell==null)return;const e=this.getFocusEventParams(this.focusedCell);this.focusedCell=null,this.eventSvc.dispatchEvent({type:"cellFocusCleared",...e})}setFocusedCell(e){this.setFocusRecovered();const{column:t,rowIndex:r,rowPinned:n,forceBrowserFocus:i=!1,preventScrollOnBrowserFocus:s=!1,sourceEvent:o}=e,a=this.colModel.getCol(t);if(!a){this.focusedCell=null;return}this.focusedCell={rowIndex:r,rowPinned:ea(n),column:a};const l=this.getFocusEventParams(this.focusedCell);this.eventSvc.dispatchEvent({type:"cellFocused",...l,...this.previousCellFocusParams&&{previousParams:this.previousCellFocusParams},forceBrowserFocus:i,preventScrollOnBrowserFocus:s,sourceEvent:o}),this.previousCellFocusParams=l}isCellFocused(e){return this.focusedCell==null?!1:Py(e,this.focusedCell)}isHeaderWrapperFocused(e){if(this.focusedHeader==null)return!1;const{column:t,rowCtrl:{rowIndex:r,pinned:n}}=e,{column:i,headerRowIndex:s}=this.focusedHeader;return t===i&&r===s&&n==i.getPinned()}focusHeaderPosition(e){if(this.setFocusRecovered(),lc(this.beans))return!1;const{direction:t,fromTab:r,allowUserOverride:n,event:i,fromCell:s,rowWithoutSpanValue:o,scroll:a=!0}=e;let{headerPosition:l}=e;if(s&&this.filterManager?.isAdvFilterHeaderActive())return this.focusAdvancedFilter(l);if(n){const c=this.focusedHeader,u=yo(this.beans);if(r){const h=this.gos.getCallback("tabToNextHeader");h&&(l=this.getHeaderPositionFromUserFunc({userFunc:h,direction:t,currentPosition:c,headerPosition:l,headerRowCount:u}))}else{const h=this.gos.getCallback("navigateToNextHeader");if(h&&i){const d={key:i.key,previousHeaderPosition:c,nextHeaderPosition:l,headerRowCount:u,event:i};l=h(d)}}}return l?this.focusProvidedHeaderPosition({headerPosition:l,direction:t,event:i,fromCell:s,rowWithoutSpanValue:o,scroll:a}):!1}focusHeaderPositionFromUserFunc(e){if(lc(this.beans))return!1;const{userFunc:t,headerPosition:r,direction:n,event:i}=e,s=this.focusedHeader,o=yo(this.beans),a=this.getHeaderPositionFromUserFunc({userFunc:t,direction:n,currentPosition:s,headerPosition:r,headerRowCount:o});return!!a&&this.focusProvidedHeaderPosition({headerPosition:a,direction:n,event:i})}getHeaderPositionFromUserFunc(e){const{userFunc:t,direction:r,currentPosition:n,headerPosition:i,headerRowCount:s}=e,a=t({backwards:r==="Before",previousHeaderPosition:n,nextHeaderPosition:i,headerRowCount:s});return a===!0?n:a===!1?null:a}focusProvidedHeaderPosition(e){const{headerPosition:t,direction:r,fromCell:n,rowWithoutSpanValue:i,event:s,scroll:o=!0}=e,{column:a,headerRowIndex:l}=t,{filterManager:c,ctrlsSvc:u,headerNavigation:h}=this.beans;if(this.focusedHeader&&LI(e.headerPosition,this.focusedHeader))return!1;if(l===-1)return c?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(t):this.focusGridView({column:a,event:s});o&&h?.scrollToColumn(a,r);const f=u.getHeaderRowContainerCtrl(a.getPinned())?.focusHeader(t.headerRowIndex,a,s)||!1;return h&&f&&(i!=null||n)&&(h.currentHeaderRowWithoutSpan=i??-1),f}focusFirstHeader(){if(this.overlays?.exclusive&&this.focusOverlay())return!0;const e=this.visibleCols.allCols[0];if(!e)return!1;const t=_R(this.beans,e,0);return this.focusHeaderPosition({headerPosition:t,rowWithoutSpanValue:0})}focusLastHeader(e){if(this.overlays?.exclusive&&this.focusOverlay(!0))return!0;const t=yo(this.beans)-1,r=zr(this.visibleCols.allCols);return this.focusHeaderPosition({headerPosition:{headerRowIndex:t,column:r},rowWithoutSpanValue:-1,event:e})}focusPreviousFromFirstCell(e){return this.filterManager?.isAdvFilterHeaderActive()?this.focusAdvancedFilter(null):this.focusLastHeader(e)}isAnyCellFocused(){return!!this.focusedCell}isRowFocused(e,t){return this.focusedCell==null?!1:this.focusedCell.rowIndex===e&&this.focusedCell.rowPinned===ea(t)}focusOverlay(e){const t=this.overlays?.isVisible()&&this.overlays.eWrapper?.getGui();return!!t&&bc(t,e)}focusGridView(e){const{backwards:t=!1,canFocusOverlay:r=!0,event:n}=e;if(this.overlays?.exclusive)return r&&this.focusOverlay(t);if(lm(this.beans))return t&&!lc(this.beans)?this.focusLastHeader():r&&this.focusOverlay(t)?!0:t?!1:dd(this.beans,t);const i=t?RI(this.beans):kI(this.beans);if(i){const s=e.column??this.focusedHeader?.column,{rowIndex:o,rowPinned:a}=i,l=ca(this.beans,i);if(!s||!l||o==null)return!1;if(s.isSuppressNavigable(l)){const c=this.gos.get("enableRtl");let u;return!n||n.key===$e.TAB?u=c?$e.LEFT:$e.RIGHT:u=n.key,this.beans.navigation?.navigateToNextCell(null,u,{rowIndex:o,column:s,rowPinned:a||null},!0),!0}return this.navigation?.ensureCellVisible({rowIndex:o,column:s,rowPinned:a}),t&&this.rowRenderer.getRowByPosition(i)?.isFullWidth()&&this.navigation?.tryToFocusFullWidthRow(i,t)||(this.setFocusedCell({rowIndex:o,column:s,rowPinned:ea(a),forceBrowserFocus:!0}),this.beans.rangeSvc?.setRangeToCell({rowIndex:o,rowPinned:a,column:s})),!0}return!!(r&&this.focusOverlay(t)||t&&this.focusLastHeader())}focusAdvancedFilter(e){return this.advFilterFocusColumn=e?.column,this.beans.advancedFilter?.getCtrl().focusHeaderComp()??!1}focusNextFromAdvancedFilter(e,t){const r=(t?void 0:this.advFilterFocusColumn)??this.visibleCols.allCols?.[0];return e?this.focusHeaderPosition({headerPosition:{column:r,headerRowIndex:yo(this.beans)-1}}):this.focusGridView({column:r})}clearAdvancedFilterColumn(){this.advFilterFocusColumn=void 0}},AB=class extends et{constructor(){super(...arguments),this.beanName="scrollVisibleSvc"}wireBeans(e){this.ctrlsSvc=e.ctrlsSvc,this.colAnimation=e.colAnimation}postConstruct(){this.horizontalScrollShowing=this.gos.get("alwaysShowHorizontalScroll")===!0,this.verticalScrollShowing=this.gos.get("alwaysShowVerticalScroll")===!0,this.getScrollbarWidth(),this.addManagedEventListeners({displayedColumnsChanged:this.updateScrollVisible.bind(this),displayedColumnsWidthChanged:this.updateScrollVisible.bind(this)})}updateScrollVisible(){const{colAnimation:e}=this;e?.isActive()?e.executeLaterVMTurn(()=>{e.executeLaterVMTurn(()=>this.updateScrollVisibleImpl())}):this.updateScrollVisibleImpl()}updateScrollVisibleImpl(){const e=this.ctrlsSvc.get("center");if(!e||this.colAnimation?.isActive())return;const t={horizontalScrollShowing:e.isHorizontalScrollShowing(),verticalScrollShowing:this.verticalScrollShowing};this.setScrollsVisible(t),this.updateScrollGap()}updateScrollGap(){const e=this.ctrlsSvc.get("center"),t=e.hasHorizontalScrollGap(),r=e.hasVerticalScrollGap();(this.horizontalScrollGap!==t||this.verticalScrollGap!==r)&&(this.horizontalScrollGap=t,this.verticalScrollGap=r,this.eventSvc.dispatchEvent({type:"scrollGapChanged"}))}setScrollsVisible(e){(this.horizontalScrollShowing!==e.horizontalScrollShowing||this.verticalScrollShowing!==e.verticalScrollShowing)&&(this.horizontalScrollShowing=e.horizontalScrollShowing,this.verticalScrollShowing=e.verticalScrollShowing,this.eventSvc.dispatchEvent({type:"scrollVisibilityChanged"}))}getScrollbarWidth(){if(this.scrollbarWidth==null){const e=this.gos.get("scrollbarWidth"),r=typeof e=="number"&&e>=0?e:o7();r!=null&&(this.scrollbarWidth=r,this.eventSvc.dispatchEvent({type:"scrollbarWidthChanged"}))}return this.scrollbarWidth}},FB=class extends et{constructor(){super(...arguments),this.beanName="gridDestroySvc",this.destroyCalled=!1}destroy(){if(this.destroyCalled)return;const{stateSvc:e,ctrlsSvc:t,context:r}=this.beans;this.eventSvc.dispatchEvent({type:"gridPreDestroyed",state:e?.getState()??{}}),this.destroyCalled=!0,t.get("gridCtrl")?.destroyGridUi(),r.destroy(),super.destroy()}},i0=new Set(["gridPreDestroyed","fillStart","pasteStart"]),MB=["columnEverythingChanged","newColumnsLoaded","columnPivotModeChanged","pivotMaxColumnsExceeded","columnRowGroupChanged","expandOrCollapseAll","columnPivotChanged","gridColumnsChanged","columnValueChanged","columnMoved","columnVisible","columnPinned","columnGroupOpened","columnResized","displayedColumnsChanged","virtualColumnsChanged","columnHeaderMouseOver","columnHeaderMouseLeave","columnHeaderClicked","columnHeaderContextMenu","asyncTransactionsFlushed","rowGroupOpened","rowDataUpdated","pinnedRowDataChanged","pinnedRowsChanged","rangeSelectionChanged","cellSelectionChanged","chartCreated","chartRangeSelectionChanged","chartOptionsChanged","chartDestroyed","toolPanelVisibleChanged","toolPanelSizeChanged","modelUpdated","cutStart","cutEnd","pasteStart","pasteEnd","fillStart","fillEnd","cellSelectionDeleteStart","cellSelectionDeleteEnd","rangeDeleteStart","rangeDeleteEnd","undoStarted","undoEnded","redoStarted","redoEnded","cellClicked","cellDoubleClicked","cellMouseDown","cellContextMenu","cellValueChanged","cellEditRequest","rowValueChanged","headerFocused","cellFocused","rowSelected","selectionChanged","tooltipShow","tooltipHide","cellKeyDown","cellMouseOver","cellMouseOut","filterChanged","filterModified","filterUiChanged","filterOpened","floatingFilterUiChanged","advancedFilterBuilderVisibleChanged","sortChanged","virtualRowRemoved","rowClicked","rowDoubleClicked","gridReady","gridPreDestroyed","gridSizeChanged","viewportChanged","firstDataRendered","dragStarted","dragStopped","dragCancelled","rowEditingStarted","rowEditingStopped","cellEditingStarted","cellEditingStopped","bodyScroll","bodyScrollEnd","paginationChanged","componentStateChanged","storeRefreshed","stateUpdated","columnMenuVisibleChanged","contextMenuVisibleChanged","rowDragEnter","rowDragMove","rowDragLeave","rowDragEnd","rowDragCancel","findChanged","rowResizeStarted","rowResizeEnded","columnsReset","bulkEditingStarted","bulkEditingStopped","batchEditingStarted","batchEditingStopped"],By=MB.reduce((e,t)=>(e[t]=zD(t),e),{}),Ju={agSetColumnFilter:"SetFilter",agSetColumnFloatingFilter:"SetFilter",agMultiColumnFilter:"MultiFilter",agMultiColumnFloatingFilter:"MultiFilter",agGroupColumnFilter:"GroupFilter",agGroupColumnFloatingFilter:"GroupFilter",agGroupCellRenderer:"GroupCellRenderer",agGroupRowRenderer:"GroupCellRenderer",agRichSelect:"RichSelect",agRichSelectCellEditor:"RichSelect",agDetailCellRenderer:"SharedMasterDetail",agSparklineCellRenderer:"Sparklines",agDragAndDropImage:"SharedDragAndDrop",agColumnHeader:"ColumnHeaderComp",agColumnGroupHeader:"ColumnGroupHeaderComp",agSortIndicator:"Sort",agAnimateShowChangeCellRenderer:"HighlightChanges",agAnimateSlideCellRenderer:"HighlightChanges",agLoadingCellRenderer:"LoadingCellRenderer",agSkeletonCellRenderer:"SkeletonCellRenderer",agCheckboxCellRenderer:"CheckboxCellRenderer",agLoadingOverlay:"Overlay",agExportingOverlay:"Overlay",agNoRowsOverlay:"Overlay",agNoMatchingRowsOverlay:"Overlay",agTooltipComponent:"Tooltip",agReadOnlyFloatingFilter:"CustomFilter",agTextColumnFilter:"TextFilter",agNumberColumnFilter:"NumberFilter",agDateColumnFilter:"DateFilter",agDateInput:"DateFilter",agTextColumnFloatingFilter:"TextFilter",agNumberColumnFloatingFilter:"NumberFilter",agDateColumnFloatingFilter:"DateFilter",agCellEditor:"TextEditor",agSelectCellEditor:"SelectEditor",agTextCellEditor:"TextEditor",agNumberCellEditor:"NumberEditor",agDateCellEditor:"DateEditor",agDateStringCellEditor:"DateEditor",agCheckboxCellEditor:"CheckboxEditor",agLargeTextCellEditor:"LargeTextEditor",agMenuItem:"MenuItem",agColumnsToolPanel:"ColumnsToolPanel",agFiltersToolPanel:"FiltersToolPanel",agNewFiltersToolPanel:"NewFiltersToolPanel",agAggregationComponent:"StatusBar",agSelectedRowCountComponent:"StatusBar",agTotalRowCountComponent:"StatusBar",agFilteredRowCountComponent:"StatusBar",agTotalAndFilteredRowCountComponent:"StatusBar",agFindCellRenderer:"Find"};function L4(e){return`"${e}"`}var DB=()=>({checkboxSelection:{version:"32.2",message:"Use `rowSelection.checkboxes` in `GridOptions` instead."},headerCheckboxSelection:{version:"32.2",message:"Use `rowSelection.headerCheckbox = true` in `GridOptions` instead."},headerCheckboxSelectionFilteredOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "filtered"` in `GridOptions` instead.'},headerCheckboxSelectionCurrentPageOnly:{version:"32.2",message:'Use `rowSelection.selectAll = "currentPage"` in `GridOptions` instead.'},showDisabledCheckboxes:{version:"32.2",message:"Use `rowSelection.hideDisabledCheckboxes = true` in `GridOptions` instead."},rowGroupingHierarchy:{version:"34.3",message:"Use `colDef.groupHierarchy` instead."}}),PB={allowFormula:"Formula",aggFunc:"SharedAggregation",autoHeight:"RowAutoHeight",cellClass:"CellStyle",cellClassRules:"CellStyle",cellEditor:({cellEditor:e,editable:t})=>t?typeof e=="string"?Ju[e]??"CustomEditor":"CustomEditor":null,cellRenderer:({cellRenderer:e})=>typeof e!="string"?null:Ju[e],cellStyle:"CellStyle",columnChooserParams:"ColumnMenu",contextMenuItems:"ContextMenu",dndSource:"DragAndDrop",dndSourceOnRowDrag:"DragAndDrop",editable:({editable:e,cellEditor:t})=>e&&!t?"TextEditor":null,enableCellChangeFlash:"HighlightChanges",enablePivot:"SharedPivot",enableRowGroup:"SharedRowGrouping",enableValue:"SharedAggregation",filter:({filter:e})=>e&&typeof e!="string"&&typeof e!="boolean"?"CustomFilter":typeof e=="string"?Ju[e]??"ColumnFilter":"ColumnFilter",floatingFilter:"ColumnFilter",getQuickFilterText:"QuickFilter",headerTooltip:"Tooltip",headerTooltipValueGetter:"Tooltip",mainMenuItems:"ColumnMenu",menuTabs:e=>{const t=["columnsMenuTab","generalMenuTab"];return e.menuTabs?.some(r=>t.includes(r))?"ColumnMenu":null},pivot:"SharedPivot",pivotIndex:"SharedPivot",rowDrag:"RowDrag",rowGroup:"SharedRowGrouping",rowGroupIndex:"SharedRowGrouping",tooltipField:"Tooltip",tooltipValueGetter:"Tooltip",tooltipComponentSelector:"Tooltip",spanRows:"CellSpan",groupHierarchy:"SharedRowGrouping"},IB=()=>({autoHeight:{supportedRowModels:["clientSide","serverSide"],validate:(t,{paginationAutoPageSize:r})=>r?"colDef.autoHeight is not supported with paginationAutoPageSize.":null},allowFormula:{supportedRowModels:["clientSide"]},cellRendererParams:{validate:t=>(t.rowGroup!=null||t.rowGroupIndex!=null||t.cellRenderer==="agGroupCellRenderer")&&"checkbox"in t.cellRendererParams?'Since v33.0, `cellRendererParams.checkbox` has been deprecated. Use `rowSelection.checkboxLocation = "autoGroupColumn"` instead.':null},flex:{validate:(t,r)=>r.autoSizeStrategy?"colDef.flex is not supported with gridOptions.autoSizeStrategy":null},headerCheckboxSelection:{supportedRowModels:["clientSide","serverSide"],validate:(t,{rowSelection:r})=>r==="multiple"?null:"headerCheckboxSelection is only supported with rowSelection=multiple"},headerCheckboxSelectionCurrentPageOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:r})=>r==="multiple"?null:"headerCheckboxSelectionCurrentPageOnly is only supported with rowSelection=multiple"},headerCheckboxSelectionFilteredOnly:{supportedRowModels:["clientSide"],validate:(t,{rowSelection:r})=>r==="multiple"?null:"headerCheckboxSelectionFilteredOnly is only supported with rowSelection=multiple"},headerValueGetter:{validate:t=>{const r=t.headerValueGetter;return typeof r=="function"||typeof r=="string"?null:"headerValueGetter must be a function or a valid string expression"}},icons:{validate:({icons:t})=>{if(t){if(t.smallDown)return _o(262);if(t.smallLeft)return _o(263);if(t.smallRight)return _o(264)}return null}},sort:{validate:t=>qu(t.sort)||il(t.sort)?null:`sort must be of type (SortDirection | SortDef), currently it is ${typeof t.sort=="object"?JSON.stringify(t.sort):Kg(t.sort)}`},initialSort:{validate:t=>qu(t.initialSort)||il(t.initialSort)?null:`initialSort must be of non-null type (SortDirection | SortDef), currently it is ${typeof t.initialSort=="object"?JSON.stringify(t.initialSort):Kg(t.initialSort)}`},sortingOrder:{validate:t=>{const r=t.sortingOrder;if(Array.isArray(r)&&r.length>0){const n=r.filter(i=>!(qu(i)||il(i)));if(n.length>0)return`sortingOrder must be an array of type non-null (SortDirection | SortDef)[], incorrect items are: [${n.map(i=>typeof i=="string"||i==null?Kg(i):JSON.stringify(i)).join(", ")}]`}else if(!Array.isArray(r)||!r.length)return`sortingOrder must be an array with at least one element, currently it is [${r}]`;return null}},type:{validate:t=>{const r=t.type;return r instanceof Array?r.some(i=>typeof i!="string")?"if colDef.type is supplied an array it should be of type 'string[]'":null:typeof r=="string"?null:"colDef.type should be of type 'string' | 'string[]'"}},rowSpan:{validate:(t,{suppressRowTransform:r})=>r?null:"colDef.rowSpan requires suppressRowTransform to be enabled."},spanRows:{dependencies:{editable:{required:[!1,void 0]},rowDrag:{required:[!1,void 0]},colSpan:{required:[void 0]},rowSpan:{required:[void 0]}},validate:(t,{rowSelection:r,cellSelection:n,suppressRowTransform:i,enableCellSpan:s,rowDragEntireRow:o,enableCellTextSelection:a})=>typeof r=="object"&&r?.mode==="singleRow"&&r?.enableClickSelection?"colDef.spanRows is not supported with rowSelection.clickSelection":n?"colDef.spanRows is not supported with cellSelection.":i?"colDef.spanRows is not supported with suppressRowTransform.":s?o?"colDef.spanRows is not supported with rowDragEntireRow.":a?"colDef.spanRows is not supported with enableCellTextSelection.":null:"colDef.spanRows requires enableCellSpan to be enabled."},groupHierarchy:{validate(t,{groupHierarchyConfig:r={}},n){const i=new Set(["year","quarter","month","formattedMonth","day","hour","minute","second"]),s=[];for(const o of t.groupHierarchy??[]){if(typeof o=="object"){n.validation?.validateColDef(o);continue}!i.has(o)&&!(o in r)&&s.push(L4(o))}if(s.length>0){const o=`The following parts of colDef.groupHierarchy are not recognised: ${s.join(", ")}.`,a=`Choose one of ${[...i].map(L4).join(", ")}, or define your own parts in gridOptions.groupHierarchyConfig.`;return`${o}
${a}`}return null}}}),OB={headerName:void 0,columnGroupShow:void 0,headerStyle:void 0,headerClass:void 0,toolPanelClass:void 0,headerValueGetter:void 0,pivotKeys:void 0,groupId:void 0,colId:void 0,sort:void 0,initialSort:void 0,field:void 0,type:void 0,cellDataType:void 0,tooltipComponent:void 0,tooltipField:void 0,headerTooltip:void 0,headerTooltipValueGetter:void 0,cellClass:void 0,showRowGroup:void 0,filter:void 0,initialAggFunc:void 0,defaultAggFunc:void 0,aggFunc:void 0,pinned:void 0,initialPinned:void 0,chartDataType:void 0,cellAriaRole:void 0,cellEditorPopupPosition:void 0,headerGroupComponent:void 0,headerGroupComponentParams:void 0,cellStyle:void 0,cellRenderer:void 0,cellRendererParams:void 0,cellEditor:void 0,cellEditorParams:void 0,filterParams:void 0,pivotValueColumn:void 0,headerComponent:void 0,headerComponentParams:void 0,floatingFilterComponent:void 0,floatingFilterComponentParams:void 0,tooltipComponentParams:void 0,refData:void 0,columnChooserParams:void 0,children:void 0,sortingOrder:void 0,allowedAggFuncs:void 0,menuTabs:void 0,pivotTotalColumnIds:void 0,cellClassRules:void 0,icons:void 0,sortIndex:void 0,initialSortIndex:void 0,flex:void 0,initialFlex:void 0,width:void 0,initialWidth:void 0,minWidth:void 0,maxWidth:void 0,rowGroupIndex:void 0,initialRowGroupIndex:void 0,pivotIndex:void 0,initialPivotIndex:void 0,suppressColumnsToolPanel:void 0,suppressFiltersToolPanel:void 0,openByDefault:void 0,marryChildren:void 0,suppressStickyLabel:void 0,hide:void 0,initialHide:void 0,rowGroup:void 0,initialRowGroup:void 0,pivot:void 0,initialPivot:void 0,checkboxSelection:void 0,showDisabledCheckboxes:void 0,headerCheckboxSelection:void 0,headerCheckboxSelectionFilteredOnly:void 0,headerCheckboxSelectionCurrentPageOnly:void 0,suppressHeaderMenuButton:void 0,suppressMovable:void 0,lockPosition:void 0,lockVisible:void 0,lockPinned:void 0,unSortIcon:void 0,suppressSizeToFit:void 0,suppressAutoSize:void 0,enableRowGroup:void 0,enablePivot:void 0,enableValue:void 0,editable:void 0,suppressPaste:void 0,suppressNavigable:void 0,enableCellChangeFlash:void 0,rowDrag:void 0,dndSource:void 0,autoHeight:void 0,wrapText:void 0,sortable:void 0,resizable:void 0,singleClickEdit:void 0,floatingFilter:void 0,cellEditorPopup:void 0,suppressFillHandle:void 0,wrapHeaderText:void 0,autoHeaderHeight:void 0,dndSourceOnRowDrag:void 0,valueGetter:void 0,valueSetter:void 0,filterValueGetter:void 0,keyCreator:void 0,valueFormatter:void 0,valueParser:void 0,comparator:void 0,equals:void 0,pivotComparator:void 0,suppressKeyboardEvent:void 0,suppressHeaderKeyboardEvent:void 0,colSpan:void 0,rowSpan:void 0,spanRows:void 0,getQuickFilterText:void 0,onCellValueChanged:void 0,onCellClicked:void 0,onCellDoubleClicked:void 0,onCellContextMenu:void 0,rowDragText:void 0,tooltipValueGetter:void 0,tooltipComponentSelector:void 0,cellRendererSelector:void 0,cellEditorSelector:void 0,suppressSpanHeaderHeight:void 0,useValueFormatterForExport:void 0,useValueParserForImport:void 0,mainMenuItems:void 0,contextMenuItems:void 0,suppressFloatingFilterButton:void 0,suppressHeaderFilterButton:void 0,suppressHeaderContextMenu:void 0,loadingCellRenderer:void 0,loadingCellRendererParams:void 0,loadingCellRendererSelector:void 0,context:void 0,dateComponent:void 0,dateComponentParams:void 0,getFindText:void 0,rowGroupingHierarchy:void 0,groupHierarchy:void 0,allowFormula:void 0},NB=()=>Object.keys(OB),LB=()=>({objectName:"colDef",allProperties:NB(),docsUrl:"column-properties/",deprecations:DB(),validations:IB()}),BB=["overlayLoadingTemplate","overlayNoRowsTemplate","gridId","quickFilterText","rowModelType","editType","domLayout","clipboardDelimiter","rowGroupPanelShow","multiSortKey","pivotColumnGroupTotals","pivotRowTotals","pivotPanelShow","fillHandleDirection","groupDisplayType","treeDataDisplayType","treeDataChildrenField","treeDataParentIdField","colResizeDefault","tooltipTrigger","serverSidePivotResultFieldSeparator","columnMenu","tooltipShowMode","invalidEditValueMode","grandTotalRow","themeCssLayer","findSearchValue","styleNonce","renderingMode"],HB=["components","rowStyle","context","autoGroupColumnDef","localeText","icons","datasource","dragAndDropImageComponentParams","serverSideDatasource","viewportDatasource","groupRowRendererParams","aggFuncs","fullWidthCellRendererParams","defaultColGroupDef","defaultColDef","defaultCsvExportParams","defaultExcelExportParams","columnTypes","rowClassRules","detailCellRendererParams","loadingCellRendererParams","overlayComponentParams","loadingOverlayComponentParams","noRowsOverlayComponentParams","activeOverlayParams","popupParent","themeStyleContainer","statusBar","chartThemeOverrides","customChartThemes","chartToolPanelsDef","dataTypeDefinitions","advancedFilterParent","advancedFilterBuilderParams","advancedFilterParams","formulaDataSource","formulaFuncs","initialState","autoSizeStrategy","selectionColumnDef","findOptions","filterHandlers","groupHierarchyConfig"],jB=["sortingOrder","alignedGrids","rowData","columnDefs","excelStyles","pinnedTopRowData","pinnedBottomRowData","chartThemes","rowClass","paginationPageSizeSelector","suppressOverlays"],ER=["rowHeight","detailRowHeight","rowBuffer","headerHeight","groupHeaderHeight","groupLockGroupColumns","floatingFiltersHeight","pivotHeaderHeight","pivotGroupHeaderHeight","groupDefaultExpanded","pivotDefaultExpanded","viewportRowModelPageSize","viewportRowModelBufferSize","autoSizePadding","maxBlocksInCache","maxConcurrentDatasourceRequests","tooltipShowDelay","tooltipHideDelay","cacheOverflowSize","paginationPageSize","cacheBlockSize","infiniteInitialRowCount","serverSideInitialRowCount","scrollbarWidth","asyncTransactionWaitMillis","blockLoadDebounceMillis","keepDetailRowsCount","undoRedoCellEditingLimit","cellFlashDuration","cellFadeDuration","tabIndex","pivotMaxGeneratedColumns","rowDragInsertDelay"],VB=["theme","rowSelection"],GB=["cellSelection","sideBar","rowNumbers","suppressGroupChangesColumnVisibility","groupAggFiltering","suppressStickyTotalRow","groupHideParentOfSingleChild","enableRowPinning"],TR=["loadThemeGoogleFonts","suppressMakeColumnVisibleAfterUnGroup","suppressRowClickSelection","suppressCellFocus","suppressHeaderFocus","suppressHorizontalScroll","groupSelectsChildren","alwaysShowHorizontalScroll","alwaysShowVerticalScroll","debug","enableBrowserTooltips","enableCellExpressions","groupSuppressBlankHeader","suppressMenuHide","suppressRowDeselection","unSortIcon","suppressMultiSort","alwaysMultiSort","singleClickEdit","suppressLoadingOverlay","suppressNoRowsOverlay","suppressAutoSize","skipHeaderOnAutoSize","suppressColumnMoveAnimation","suppressMoveWhenColumnDragging","suppressMovableColumns","suppressFieldDotNotation","enableRangeSelection","enableRangeHandle","enableFillHandle","suppressClearOnFillReduction","deltaSort","suppressTouch","allowContextMenuWithControlKey","suppressContextMenu","suppressDragLeaveHidesColumns","suppressRowGroupHidesColumns","suppressMiddleClickScrolls","suppressPreventDefaultOnMouseWheel","suppressCopyRowsToClipboard","copyHeadersToClipboard","copyGroupHeadersToClipboard","pivotMode","suppressAggFuncInHeader","suppressColumnVirtualisation","alwaysAggregateAtRootLevel","suppressFocusAfterRefresh","functionsReadOnly","animateRows","groupSelectsFiltered","groupRemoveSingleChildren","groupRemoveLowestSingleChildren","enableRtl","enableCellSpan","suppressClickEdit","rowDragEntireRow","rowDragManaged","refreshAfterGroupEdit","suppressRowDrag","suppressMoveWhenRowDragging","rowDragMultiRow","enableGroupEdit","embedFullWidthRows","suppressPaginationPanel","groupHideOpenParents","groupAllowUnbalanced","pagination","paginationAutoPageSize","suppressScrollOnNewData","suppressScrollWhenPopupsAreOpen","purgeClosedRowNodes","cacheQuickFilter","includeHiddenColumnsInQuickFilter","ensureDomOrder","accentedSort","suppressChangeDetection","valueCache","valueCacheNeverExpires","aggregateOnlyChangedColumns","suppressAnimationFrame","suppressExcelExport","suppressCsvExport","includeHiddenColumnsInAdvancedFilter","suppressMultiRangeSelection","enterNavigatesVerticallyAfterEdit","enterNavigatesVertically","suppressPropertyNamesCheck","rowMultiSelectWithClick","suppressRowHoverHighlight","suppressRowTransform","suppressClipboardPaste","suppressLastEmptyLineOnPaste","enableCharts","suppressMaintainUnsortedOrder","enableCellTextSelection","suppressBrowserResizeObserver","suppressMaxRenderedRowRestriction","excludeChildrenWhenTreeDataFiltering","tooltipMouseTrack","tooltipInteraction","keepDetailRows","paginateChildRows","preventDefaultOnContextMenu","undoRedoCellEditing","allowDragFromColumnsToolPanel","pivotSuppressAutoColumn","suppressExpandablePivotGroups","debounceVerticalScrollbar","detailRowAutoHeight","serverSideSortAllLevels","serverSideEnableClientSideSort","serverSideOnlyRefreshFilteredGroups","suppressAggFilteredOnly","showOpenedGroup","suppressClipboardApi","suppressModelUpdateAfterUpdateTransaction","stopEditingWhenCellsLoseFocus","groupMaintainOrder","columnHoverHighlight","readOnlyEdit","suppressRowVirtualisation","enableCellEditingOnBackspace","resetRowDataOnUpdate","removePivotHeaderRowWhenSingleValueColumn","suppressCopySingleCellRanges","suppressGroupRowsSticky","suppressCutToClipboard","rowGroupPanelSuppressSort","allowShowChangeAfterFilter","enableAdvancedFilter","masterDetail","treeData","reactiveCustomComponents","applyQuickFilterBeforePivotOrAgg","suppressServerSideFullWidthLoadingRow","suppressAdvancedFilterEval","loading","maintainColumnOrder","enableStrictPivotColumnOrder","suppressSetFilterByDefault","enableFilterHandlers","suppressStartEditOnTab","hidePaddedHeaderRows","ssrmExpandAllAffectsAllRows","animateColumnResizing"],zB=["doesExternalFilterPass","processPivotResultColDef","processPivotResultColGroupDef","getBusinessKeyForNode","isRowSelectable","rowDragText","groupRowRenderer","dragAndDropImageComponent","fullWidthCellRenderer","loadingCellRenderer","overlayComponent","loadingOverlayComponent","noRowsOverlayComponent","overlayComponentSelector","activeOverlay","detailCellRenderer","quickFilterParser","quickFilterMatcher","getLocaleText","isExternalFilterPresent","getRowHeight","getRowClass","getRowStyle","getFullRowEditValidationErrors","getContextMenuItems","getMainMenuItems","processRowPostCreate","processCellForClipboard","getGroupRowAgg","isFullWidthRow","sendToClipboard","focusGridInnerElement","navigateToNextHeader","tabToNextHeader","navigateToNextCell","tabToNextCell","processCellFromClipboard","getDocument","postProcessPopup","getChildCount","getDataPath","isRowMaster","postSortRows","processHeaderForClipboard","processUnpinnedColumns","processGroupHeaderForClipboard","paginationNumberFormatter","processDataFromClipboard","getServerSideGroupKey","isServerSideGroup","createChartContainer","getChartToolbarItems","fillOperation","isApplyServerSideTransaction","getServerSideGroupLevelParams","isServerSideGroupOpenByDefault","isGroupOpenByDefault","initialGroupOrderComparator","loadingCellRendererSelector","getRowId","chartMenuItems","groupTotalRow","alwaysPassFilter","isRowPinnable","isRowPinned","isRowValidDropPosition"],UB=()=>[...jB,...HB,...BB,...ER,...zB,...TR,...GB,...VB],WB=()=>({suppressLoadingOverlay:{version:"32",message:"Use `loading`=false instead."},enableFillHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeHandle:{version:"32.2",message:"Use `cellSelection.handle` instead."},enableRangeSelection:{version:"32.2",message:"Use `cellSelection = true` instead."},suppressMultiRangeSelection:{version:"32.2",message:"Use `cellSelection.suppressMultiRanges` instead."},suppressClearOnFillReduction:{version:"32.2",message:"Use `cellSelection.handle.suppressClearOnFillReduction` instead."},fillHandleDirection:{version:"32.2",message:"Use `cellSelection.handle.direction` instead."},fillOperation:{version:"32.2",message:"Use `cellSelection.handle.setFillValue` instead."},suppressRowClickSelection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},suppressRowDeselection:{version:"32.2",message:"Use `rowSelection.enableClickSelection` instead."},rowMultiSelectWithClick:{version:"32.2",message:"Use `rowSelection.enableSelectionWithoutKeys` instead."},groupSelectsChildren:{version:"32.2",message:'Use `rowSelection.groupSelects = "descendants"` instead.'},groupSelectsFiltered:{version:"32.2",message:'Use `rowSelection.groupSelects = "filteredDescendants"` instead.'},isRowSelectable:{version:"32.2",message:"Use `selectionOptions.isRowSelectable` instead."},suppressCopySingleCellRanges:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},suppressCopyRowsToClipboard:{version:"32.2",message:"Use `rowSelection.copySelectedRows` instead."},onRangeSelectionChanged:{version:"32.2",message:"Use `onCellSelectionChanged` instead."},onRangeDeleteStart:{version:"32.2",message:"Use `onCellSelectionDeleteStart` instead."},onRangeDeleteEnd:{version:"32.2",message:"Use `onCellSelectionDeleteEnd` instead."},suppressBrowserResizeObserver:{version:"32.2",message:"The grid always uses the browser's ResizeObserver, this grid option has no effect."},onColumnEverythingChanged:{version:"32.2",message:"Either use `onDisplayedColumnsChanged` which is fired at the same time, or use one of the more specific column events."},groupRemoveSingleChildren:{version:"33",message:"Use `groupHideParentOfSingleChild` instead."},groupRemoveLowestSingleChildren:{version:"33",message:'Use `groupHideParentOfSingleChild: "leafGroupsOnly"` instead.'},suppressRowGroupHidesColumns:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressHideOnGroup"` instead.'},suppressMakeColumnVisibleAfterUnGroup:{version:"33",message:'Use `suppressGroupChangesColumnVisibility: "suppressShowOnUngroup"` instead.'},unSortIcon:{version:"33",message:"Use `defaultColDef.unSortIcon` instead."},sortingOrder:{version:"33",message:"Use `defaultColDef.sortingOrder` instead."},suppressPropertyNamesCheck:{version:"33",message:"`gridOptions` and `columnDefs` both have a `context` property that should be used for arbitrary user data. This means that column definitions and gridOptions should only contain valid properties making this property redundant."},suppressAdvancedFilterEval:{version:"34",message:"Advanced filter no longer uses function evaluation, so this option has no effect."}});function ao(e,t,r){return typeof t=="number"||t==null?t==null||t>=r?null:`${e}: value should be greater than or equal to ${r}`:`${e}: value should be a number`}var $B={alignedGrids:"AlignedGrids",allowContextMenuWithControlKey:"ContextMenu",autoSizeStrategy:"ColumnAutoSize",cellSelection:"CellSelection",columnHoverHighlight:"ColumnHover",datasource:"InfiniteRowModel",doesExternalFilterPass:"ExternalFilter",editType:"EditCore",invalidEditValueMode:"EditCore",enableAdvancedFilter:"AdvancedFilter",enableCellSpan:"CellSpan",enableCharts:"IntegratedCharts",enableRangeSelection:"CellSelection",enableRowPinning:"PinnedRow",findSearchValue:"Find",getFullRowEditValidationErrors:"EditCore",getContextMenuItems:"ContextMenu",getLocaleText:"Locale",getMainMenuItems:"ColumnMenu",getRowClass:"RowStyle",getRowStyle:"RowStyle",groupTotalRow:"SharedRowGrouping",grandTotalRow:"ClientSideRowModelHierarchy",initialState:"GridState",isExternalFilterPresent:"ExternalFilter",isRowPinnable:"PinnedRow",isRowPinned:"PinnedRow",localeText:"Locale",masterDetail:"SharedMasterDetail",pagination:"Pagination",pinnedBottomRowData:"PinnedRow",pinnedTopRowData:"PinnedRow",pivotMode:"SharedPivot",pivotPanelShow:"RowGroupingPanel",quickFilterText:"QuickFilter",rowClass:"RowStyle",rowClassRules:"RowStyle",rowData:"ClientSideRowModel",rowDragManaged:"RowDrag",refreshAfterGroupEdit:["RowGrouping","TreeData"],rowGroupPanelShow:"RowGroupingPanel",rowNumbers:"RowNumbers",rowSelection:"SharedRowSelection",rowStyle:"RowStyle",serverSideDatasource:"ServerSideRowModel",sideBar:"SideBar",statusBar:"StatusBar",treeData:"SharedTreeData",undoRedoCellEditing:"UndoRedoEdit",valueCache:"ValueCache",viewportDatasource:"ViewportRowModel"},qB=()=>{const e={autoSizePadding:{validate({autoSizePadding:r}){return ao("autoSizePadding",r,0)}},cacheBlockSize:{supportedRowModels:["serverSide","infinite"],validate({cacheBlockSize:r}){return ao("cacheBlockSize",r,1)}},cacheOverflowSize:{validate({cacheOverflowSize:r}){return ao("cacheOverflowSize",r,1)}},datasource:{supportedRowModels:["infinite"]},domLayout:{validate:r=>{const n=r.domLayout,i=["autoHeight","normal","print"];return n&&!i.includes(n)?`domLayout must be one of [${i.join()}], currently it's ${n}`:null}},enableFillHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeHandle:{dependencies:{enableRangeSelection:{required:[!0]}}},enableRangeSelection:{dependencies:{rowDragEntireRow:{required:[!1,void 0]}}},enableRowPinning:{supportedRowModels:["clientSide"],validate({enableRowPinning:r,pinnedTopRowData:n,pinnedBottomRowData:i}){return r&&(n||i)?"Manual row pinning cannot be used together with pinned row data. Either set `enableRowPinning` to `false`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":null}},isRowPinnable:{supportedRowModels:["clientSide"],validate({enableRowPinning:r,isRowPinnable:n,pinnedTopRowData:i,pinnedBottomRowData:s}){return n&&(i||s)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinnable`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!r&&n?"`isRowPinnable` requires `enableRowPinning` to be set.":null}},isRowPinned:{supportedRowModels:["clientSide"],validate({enableRowPinning:r,isRowPinned:n,pinnedTopRowData:i,pinnedBottomRowData:s}){return n&&(i||s)?"Manual row pinning cannot be used together with pinned row data. Either remove `isRowPinned`, or remove `pinnedTopRowData` and `pinnedBottomRowData`.":!r&&n?"`isRowPinned` requires `enableRowPinning` to be set.":null}},groupDefaultExpanded:{supportedRowModels:["clientSide"]},groupHideOpenParents:{supportedRowModels:["clientSide","serverSide"],dependencies:{groupTotalRow:{required:[void 0,"bottom"]},treeData:{required:[void 0,!1],reason:"Tree Data has values at the group level so it doesn't make sense to hide them."}}},groupHideParentOfSingleChild:{dependencies:{groupHideOpenParents:{required:[void 0,!1]}}},groupRemoveLowestSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveSingleChildren:{required:[void 0,!1]}}},groupRemoveSingleChildren:{dependencies:{groupHideOpenParents:{required:[void 0,!1]},groupRemoveLowestSingleChildren:{required:[void 0,!1]}}},groupSelectsChildren:{dependencies:{rowSelection:{required:["multiple"]}}},groupHierarchyConfig:{validate({groupHierarchyConfig:r={}},n,i){for(const s of Object.keys(r))i.validation?.validateColDef(r[s]);return null}},icons:{validate:({icons:r})=>{if(r){if(r.smallDown)return _o(262);if(r.smallLeft)return _o(263);if(r.smallRight)return _o(264)}return null}},infiniteInitialRowCount:{validate({infiniteInitialRowCount:r}){return ao("infiniteInitialRowCount",r,1)}},initialGroupOrderComparator:{supportedRowModels:["clientSide"]},ssrmExpandAllAffectsAllRows:{validate:r=>{if(typeof r.ssrmExpandAllAffectsAllRows=="boolean"){if(r.rowModelType!=="serverSide")return"'ssrmExpandAllAffectsAllRows' is only supported with the Server Side Row Model.";if(r.ssrmExpandAllAffectsAllRows&&typeof r.getRowId!="function")return"'getRowId' callback must be provided for Server Side Row Model grouping to work correctly."}return null}},keepDetailRowsCount:{validate({keepDetailRowsCount:r}){return ao("keepDetailRowsCount",r,1)}},paginationPageSize:{validate({paginationPageSize:r}){return ao("paginationPageSize",r,1)}},paginationPageSizeSelector:{validate:r=>{const n=r.paginationPageSizeSelector;return typeof n=="boolean"||n==null||n.length?null:`'paginationPageSizeSelector' cannot be an empty array.
                    If you want to hide the page size selector, set paginationPageSizeSelector to false.`}},pivotMode:{dependencies:{treeData:{required:[!1,void 0],reason:"Pivot Mode is not supported with Tree Data."}}},quickFilterText:{supportedRowModels:["clientSide"]},rowBuffer:{validate({rowBuffer:r}){return ao("rowBuffer",r,0)}},rowClass:{validate:r=>typeof r.rowClass=="function"?"rowClass should not be a function, please use getRowClass instead":null},rowData:{supportedRowModels:["clientSide"]},rowDragManaged:{supportedRowModels:["clientSide"],dependencies:{pagination:{required:[!1,void 0]}}},rowSelection:{validate({rowSelection:r}){return r&&typeof r=="string"?'As of version 32.2.1, using `rowSelection` with the values "single" or "multiple" has been deprecated. Use the object value instead.':r&&typeof r!="object"?"Expected `RowSelectionOptions` object for the `rowSelection` property.":r&&r.mode!=="multiRow"&&r.mode!=="singleRow"?`Selection mode "${r.mode}" is invalid. Use one of 'singleRow' or 'multiRow'.`:null}},rowStyle:{validate:r=>{const n=r.rowStyle;return n&&typeof n=="function"?"rowStyle should be an object of key/value styles, not be a function, use getRowStyle() instead":null}},serverSideDatasource:{supportedRowModels:["serverSide"]},serverSideInitialRowCount:{supportedRowModels:["serverSide"],validate({serverSideInitialRowCount:r}){return ao("serverSideInitialRowCount",r,1)}},serverSideOnlyRefreshFilteredGroups:{supportedRowModels:["serverSide"]},serverSideSortAllLevels:{supportedRowModels:["serverSide"]},sortingOrder:{validate:r=>{const n=r.sortingOrder;if(Array.isArray(n)&&n.length>0){const i=n.filter(s=>!Gs(s));if(i.length>0)return`sortingOrder must be an array of type (SortDirection | SortDef)[], incorrect items are: ${i.map(s=>typeof s=="string"||s==null?Kg(s):JSON.stringify(s))}]`}else if(!Array.isArray(n)||!n.length)return`sortingOrder must be an array with at least one element, currently it's ${n}`;return null}},tooltipHideDelay:{validate:r=>r.tooltipHideDelay&&r.tooltipHideDelay<0?"tooltipHideDelay should not be lower than 0":null},tooltipShowDelay:{validate:r=>r.tooltipShowDelay&&r.tooltipShowDelay<0?"tooltipShowDelay should not be lower than 0":null},treeData:{supportedRowModels:["clientSide","serverSide"],validate:r=>{const n=r.rowModelType??"clientSide";switch(n){case"clientSide":{const{treeDataChildrenField:i,treeDataParentIdField:s,getDataPath:o,getRowId:a}=r;if(!i&&!s&&!o)return"treeData requires either 'treeDataChildrenField' or 'treeDataParentIdField' or 'getDataPath' in the clientSide row model.";if(i){if(o)return"Cannot use both 'treeDataChildrenField' and 'getDataPath' at the same time.";if(s)return"Cannot use both 'treeDataChildrenField' and 'treeDataParentIdField' at the same time."}if(s){if(!a)return"getRowId callback not provided, tree data with parent id cannot be built.";if(o)return"Cannot use both 'treeDataParentIdField' and 'getDataPath' at the same time."}return null}case"serverSide":{const i=`treeData requires 'isServerSideGroup' and 'getServerSideGroupKey' in the ${n} row model.`;return r.isServerSideGroup&&r.getServerSideGroupKey?null:i}}return null}},viewportDatasource:{supportedRowModels:["viewport"]},viewportRowModelBufferSize:{validate({viewportRowModelBufferSize:r}){return ao("viewportRowModelBufferSize",r,0)}},viewportRowModelPageSize:{validate({viewportRowModelPageSize:r}){return ao("viewportRowModelPageSize",r,1)}},rowDragEntireRow:{dependencies:{cellSelection:{required:[void 0]}}},autoGroupColumnDef:{validate({autoGroupColumnDef:r,showOpenedGroup:n}){return r?.field&&n?"autoGroupColumnDef.field and showOpenedGroup are not supported when used together.":r?.valueGetter&&n?"autoGroupColumnDef.valueGetter and showOpenedGroup are not supported when used together.":null}},renderingMode:{validate:r=>{const n=r.renderingMode,i=["default","legacy"];return n&&!i.includes(n)?`renderingMode must be one of [${i.join()}], currently it's ${n}`:null}},autoSizeStrategy:{validate:({autoSizeStrategy:r})=>{if(!r)return null;const n=["fitCellContents","fitGridWidth","fitProvidedWidth"],i=r.type;return i!=="fitCellContents"&&i!=="fitGridWidth"&&i!=="fitProvidedWidth"?`Invalid Auto-size strategy. \`autoSizeStrategy\` must be one of ${n.map(s=>'"'+s+'"').join(", ")}, currently it's ${i}`:i==="fitProvidedWidth"&&typeof r.width!="number"?`When using the 'fitProvidedWidth' auto-size strategy, must provide a numeric \`width\`. You provided ${r.width}`:null}}},t={};for(const r of TR)t[r]={expectedType:"boolean"};for(const r of ER)t[r]={expectedType:"number"};return xi(t,e),t},KB=()=>({objectName:"gridOptions",allProperties:[...UB(),...Object.values(By)],propertyExceptions:["api"],docsUrl:"grid-options/",deprecations:WB(),validations:qB()}),XB=0,YB=0,B4="__ag_grid_instance",ZB=class extends et{constructor(){super(...arguments),this.beanName="gos",this.domDataKey="__AG_"+Math.random().toString(),this.instanceId=YB++,this.gridReadyFired=!1,this.queueEvents=[],this.propEventSvc=new pc,this.globalEventHandlerFactory=e=>(t,r)=>{if(!this.isAlive())return;const n=i0.has(t);if(n&&!e||!n&&e||!JB(t))return;const i=(s,o)=>{const a=By[s],l=this.gridOptions[a];typeof l=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>l(o))};if(this.gridReadyFired)i(t,r);else if(t==="gridReady"){i(t,r),this.gridReadyFired=!0;for(const s of this.queueEvents)i(s.eventName,s.event);this.queueEvents=[]}else this.queueEvents.push({eventName:t,event:r})}}wireBeans(e){this.gridOptions=e.gridOptions,this.validation=e.validation,this.api=e.gridApi,this.gridId=e.context.getId()}get gridOptionsContext(){return this.gridOptions.context}postConstruct(){this.validateGridOptions(this.gridOptions),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory().bind(this),!0),this.eventSvc.addGlobalListener(this.globalEventHandlerFactory(!0).bind(this),!1),this.propEventSvc.setFrameworkOverrides(this.beans.frameworkOverrides),this.addManagedEventListeners({gridOptionsChanged:({options:e})=>{this.updateGridOptions({options:e,force:!0,source:"optionsUpdated"})}})}destroy(){super.destroy(),this.queueEvents=[]}get(e){return this.gridOptions[e]??NT[e]}getCallback(e){return this.mergeGridCommonParams(this.gridOptions[e])}exists(e){return bt(this.gridOptions[e])}mergeGridCommonParams(e){return e&&(r=>e(this.addCommon(r)))}updateGridOptions({options:e,force:t,source:r="api"}){const n={id:XB++,properties:[]},i=[],{gridOptions:s,validation:o}=this;for(const a of Object.keys(e)){const l=hy.applyGlobalGridOption(a,e[a]);o?.warnOnInitialPropertyUpdate(r,a);const c=t||typeof l=="object"&&r==="api",u=s[a];if(c||u!==l){s[a]=l;const h={type:a,currentValue:l,previousValue:u,changeSet:n,source:r};i.push(h)}}this.validateGridOptions(this.gridOptions),n.properties=i.map(a=>a.type);for(const a of i)mc(this,`Updated property ${a.type} from`,a.previousValue," to ",a.currentValue),this.propEventSvc.dispatchEvent(a)}addPropertyEventListener(e,t){this.propEventSvc.addEventListener(e,t)}removePropertyEventListener(e,t){this.propEventSvc.removeEventListener(e,t)}getDomDataKey(){return this.domDataKey}addCommon(e){return e.api=this.api,e.context=this.gridOptionsContext,e}validateOptions(e,t){for(const r of Object.keys(e)){const n=e[r];if(n==null||n===!1)continue;let i=t[r];typeof i=="function"&&(i=i(e,this.gridOptions,this.beans)),i&&this.assertModuleRegistered(i,r)}}validateGridOptions(e){this.validateOptions(e,$B),this.validation?.processGridOptions(e)}validateColDef(e,t,r){(r||!this.beans.dataTypeSvc?.isColPendingInference(t))&&(this.validateOptions(e,PB),this.validation?.validateColDef(e))}assertModuleRegistered(e,t){const r=Array.isArray(e)?e.some(n=>this.isModuleRegistered(n)):this.isModuleRegistered(e);return r||Ar(200,{...this.getModuleErrorParams(),moduleName:e,reasonOrId:t}),r}getModuleErrorParams(){return{gridId:this.gridId,gridScoped:fy(),rowModelType:this.get("rowModelType"),isUmd:VT()}}isModuleRegistered(e){return Qb(e,this.gridId,this.get("rowModelType"))}setInstanceDomData(e){e[B4]=this.instanceId}isElementInThisInstance(e){let t=e;for(;t;){const r=t[B4];if(bt(r))return r===this.instanceId;t=t.parentElement}return!1}};function JB(e){return!!By[e]}var QB=class extends et{constructor(e,t){super(),this.column=e,this.eGui=t,this.lastMovingChanged=0}postConstruct(){this.addManagedElementListeners(this.eGui,{click:e=>e&&this.onClick(e)}),this.addManagedListeners(this.column,{movingChanged:()=>{this.lastMovingChanged=Date.now()}})}onClick(e){const{sortSvc:t,rangeSvc:r,gos:n}=this.beans;if(!($u(n)?e.altKey:!0))r?.handleColumnSelection(this.column,e);else if(this.column.isSortable()){const s=this.column.isMoving(),a=Date.now()-this.lastMovingChanged<50;s||a||t?.progressSortFromEvent(this.column,e)}}};function eH(e,t){const r={"aria-hidden":"true"};return{tag:"div",cls:"ag-cell-label-container",role:"presentation",children:[{tag:"span",ref:"eMenu",cls:"ag-header-icon ag-header-cell-menu-button",attrs:r},{tag:"span",ref:"eFilterButton",cls:"ag-header-icon ag-header-cell-filter-button",attrs:r},{tag:"div",ref:"eLabel",cls:"ag-header-cell-label",role:"presentation",children:[e?{tag:"span",ref:"eColRef",cls:"ag-header-col-ref"}:null,{tag:"span",ref:"eText",cls:"ag-header-cell-text"},{tag:"span",ref:"eFilter",cls:"ag-header-icon ag-header-label-icon ag-filter-icon",attrs:r},t?{tag:"ag-sort-indicator",ref:"eSortIndicator"}:null]}]}}var tH=class extends pn{constructor(){super(...arguments),this.eFilter=xt,this.eFilterButton=xt,this.eSortIndicator=xt,this.eMenu=xt,this.eLabel=xt,this.eText=xt,this.eColRef=xt,this.eSortOrder=xt,this.eSortAsc=xt,this.eSortDesc=xt,this.eSortMixed=xt,this.eSortNone=xt,this.eSortAbsoluteAsc=xt,this.eSortAbsoluteDesc=xt,this.isLoadingInnerComponent=!1}refresh(e){const t=this.params;if(this.params=e,this.workOutTemplate(e,!!this.beans?.sortSvc)!=this.currentTemplate||this.workOutShowMenu()!=this.currentShowMenu||e.enableSorting!=this.currentSort||e.column.formulaRef!=this.currentRef||this.currentSuppressMenuHide!=null&&this.shouldSuppressMenuHide()!=this.currentSuppressMenuHide||t.enableFilterButton!=e.enableFilterButton||t.enableFilterIcon!=e.enableFilterIcon)return!1;if(this.innerHeaderComponent){const r={...e};xi(r,e.innerHeaderComponentParams),this.innerHeaderComponent.refresh?.(r)}else this.setDisplayName(e);return!0}workOutTemplate(e,t){const{formula:r}=this.beans,n=e.template;return n?n?.trim?n.trim():n:eH(!!r?.active,t)}init(e){this.params=e;const{sortSvc:t,touchSvc:r,rowNumbersSvc:n,userCompFactory:i}=this.beans,s=t?.getSortIndicatorSelector();this.currentTemplate=this.workOutTemplate(e,!!s),this.setTemplate(this.currentTemplate,s?[s]:void 0),this.eLabel&&(this.mouseListener??(this.mouseListener=this.createManagedBean(new QB(e.column,this.eLabel)))),r?.setupForHeader(this),this.setMenu(),this.setupSort(),this.setupColumnRefIndicator(),n?.setupForHeader(this),this.setupFilterIcon(),this.setupFilterButton(),this.workOutInnerHeaderComponent(i,e),this.setDisplayName(e)}workOutInnerHeaderComponent(e,t){const r=VP(e,t,t);r&&(this.isLoadingInnerComponent=!0,r.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderComponent=n,this.eText&&this.eText.appendChild(n.getGui())):this.destroyBean(n))}))}setDisplayName(e){const{displayName:t}=e,r=this.currentDisplayName;this.currentDisplayName=t,!(!this.eText||r===t||this.innerHeaderComponent||this.isLoadingInnerComponent)&&(this.eText.textContent=yd(t))}addInIcon(e,t,r){const n=Li(e,this.beans,r);n&&t.appendChild(n)}workOutShowMenu(){return this.params.enableMenu&&!!this.beans.menuSvc?.isHeaderMenuButtonEnabled()}shouldSuppressMenuHide(){return!!this.beans.menuSvc?.isHeaderMenuButtonAlwaysShowEnabled()}setMenu(){if(!this.eMenu)return;if(this.currentShowMenu=this.workOutShowMenu(),!this.currentShowMenu){ol(this.eMenu),this.eMenu=void 0;return}const{gos:e,eMenu:t,params:r}=this,n=rs(e);this.addInIcon(n?"menu":"menuAlt",t,r.column),t.classList.toggle("ag-header-menu-icon",!n);const i=this.shouldSuppressMenuHide();this.currentSuppressMenuHide=i,this.addManagedElementListeners(t,{click:()=>this.showColumnMenu(this.eMenu)}),this.toggleMenuAlwaysShow(i)}toggleMenuAlwaysShow(e){this.eMenu?.classList.toggle("ag-header-menu-always-show",e)}showColumnMenu(e){const{currentSuppressMenuHide:t,params:r}=this;t||this.toggleMenuAlwaysShow(!0),r.showColumnMenu(e,()=>{t||this.toggleMenuAlwaysShow(!1)})}onMenuKeyboardShortcut(e){const{params:t,gos:r,beans:n,eMenu:i,eFilterButton:s}=this,o=t.column,a=rs(r);if(e&&!a){if(n.menuSvc?.isFilterMenuInHeaderEnabled(o))return t.showFilter(s??i??this.getGui()),!0}else if(t.enableMenu)return this.showColumnMenu(i??s??this.getGui()),!0;return!1}setupSort(){const{sortSvc:e}=this.beans;if(!e)return;const{enableSorting:t,column:r}=this.params;if(this.currentSort=t,!this.eSortIndicator){this.eSortIndicator=this.createBean(e.createSortIndicator(!0));const{eSortIndicator:n,eSortOrder:i,eSortAsc:s,eSortDesc:o,eSortMixed:a,eSortNone:l,eSortAbsoluteAsc:c,eSortAbsoluteDesc:u}=this;n.attachCustomElements(i,s,o,a,l,c,u)}this.eSortIndicator.setupSort(r),this.currentSort&&e.setupHeader(this,r)}setupColumnRefIndicator(){const{eColRef:e,beans:{editModelSvc:t},params:r}=this;e&&(this.currentRef=r.column.formulaRef,e.textContent=this.currentRef,Gr(e,!1),this.addManagedEventListeners({cellEditingStarted:()=>{const n=t?.getEditPositions(),i=!!this.currentRef&&!!n?.some(s=>s.column.isAllowFormula());Gr(e,i)},cellEditingStopped:()=>{Gr(e,!1)}}))}setupFilterIcon(){const{eFilter:e,params:t}=this;if(!e)return;const r=()=>{const n=t.column.isFilterActive();Gr(e,n,{skipAriaHidden:!0})};this.configureFilter(t.enableFilterIcon,e,r,"filterActive")}setupFilterButton(){const{eFilterButton:e,params:t}=this;if(!e)return;this.configureFilter(t.enableFilterButton,e,this.onFilterChangedButton.bind(this),"filter")?this.addManagedElementListeners(e,{click:()=>t.showFilter(e)}):this.eFilterButton=void 0}configureFilter(e,t,r,n){if(!e)return ol(t),!1;const i=this.params.column;return this.addInIcon(n,t,i),this.addManagedListeners(i,{filterChanged:r}),r(),!0}onFilterChangedButton(){const e=this.params.column.isFilterActive();this.eFilterButton.classList.toggle("ag-filter-active",e)}getAnchorElementForMenu(e){const{eFilterButton:t,eMenu:r}=this;return e?t??r??this.getGui():r??t??this.getGui()}destroy(){super.destroy(),this.innerHeaderComponent=this.destroyBean(this.innerHeaderComponent),this.mouseListener=this.destroyBean(this.mouseListener)}},rH={tag:"div",cls:"ag-header-group-cell-label",role:"presentation",children:[{tag:"span",ref:"agLabel",cls:"ag-header-group-text",role:"presentation"},{tag:"span",ref:"agOpened",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-expanded"},{tag:"span",ref:"agClosed",cls:"ag-header-icon ag-header-expand-icon ag-header-expand-icon-collapsed"}]},nH=class extends pn{constructor(){super(rH),this.agOpened=xt,this.agClosed=xt,this.agLabel=xt,this.isLoadingInnerComponent=!1}init(e){const{userCompFactory:t,touchSvc:r}=this.beans;this.params=e,this.checkWarnings(),this.workOutInnerHeaderGroupComponent(t,e),this.setupLabel(e),this.addGroupExpandIcon(e),this.setupExpandIcons(),r?.setupForHeaderGroup(this)}checkWarnings(){this.params.template&&at(89)}workOutInnerHeaderGroupComponent(e,t){const r=zP(e,t,t);r&&(this.isLoadingInnerComponent=!0,r.newAgStackInstance().then(n=>{this.isLoadingInnerComponent=!1,n&&(this.isAlive()?(this.innerHeaderGroupComponent=n,this.agLabel.appendChild(n.getGui())):this.destroyBean(n))}))}setupExpandIcons(){const{agOpened:e,agClosed:t,params:{columnGroup:r},beans:{colGroupSvc:n}}=this;this.addInIcon("columnGroupOpened",e),this.addInIcon("columnGroupClosed",t);const i=l=>{if(na(l))return;const c=!r.isExpanded();n.setColumnGroupOpened(r.getProvidedColumnGroup(),c,"uiColumnExpanded")};this.addTouchAndClickListeners(t,i),this.addTouchAndClickListeners(e,i);const s=l=>{wc(l)};this.addManagedElementListeners(t,{dblclick:s}),this.addManagedElementListeners(e,{dblclick:s}),this.addManagedElementListeners(this.getGui(),{dblclick:i}),this.updateIconVisibility();const o=r.getProvidedColumnGroup(),a=this.updateIconVisibility.bind(this);this.addManagedListeners(o,{expandedChanged:a,expandableChanged:a})}addTouchAndClickListeners(e,t){this.beans.touchSvc?.setupForHeaderGroupElement(this,e,t),this.addManagedElementListeners(e,{click:t})}updateIconVisibility(){const{agOpened:e,agClosed:t,params:{columnGroup:r}}=this;if(r.isExpandable()){const n=r.isExpanded();Gr(e,n),Gr(t,!n)}else Gr(e,!1),Gr(t,!1)}addInIcon(e,t){const r=Li(e,this.beans,null);r&&t.appendChild(r)}addGroupExpandIcon(e){if(!e.columnGroup.isExpandable()){const{agOpened:t,agClosed:r}=this;Gr(t,!1),Gr(r,!1)}}setupLabel(e){const{displayName:t,columnGroup:r}=e,{innerHeaderGroupComponent:n,isLoadingInnerComponent:i}=this,s=n||i;bt(t)&&!s&&(this.agLabel.textContent=yd(t)),this.toggleCss("ag-sticky-label",!r.getColGroupDef()?.suppressStickyLabel)}destroy(){super.destroy(),this.innerHeaderGroupComponent&&(this.destroyBean(this.innerHeaderGroupComponent),this.innerHeaderGroupComponent=void 0)}},iH={moduleName:"ColumnHeaderComp",version:wt,userComponents:{agColumnHeader:tH},icons:{menu:"menu",menuAlt:"menu-alt"}},sH={moduleName:"ColumnGroupHeaderComp",version:wt,userComponents:{agColumnGroupHeader:nH},icons:{columnGroupOpened:"expanded",columnGroupClosed:"contracted"}},oH=class extends et{constructor(){super(...arguments),this.beanName="animationFrameSvc",this.p1={list:[],sorted:!1},this.p2={list:[],sorted:!1},this.f1={list:[],sorted:!1},this.destroyTasks=[],this.ticking=!1,this.scrollGoingDown=!0,this.lastScrollTop=0,this.taskCount=0}setScrollTop(e){this.scrollGoingDown=e>=this.lastScrollTop,e===0&&(this.scrollGoingDown=!0),this.lastScrollTop=e}postConstruct(){this.active=!this.gos.get("suppressAnimationFrame"),this.batchFrameworkComps=this.beans.frameworkOverrides.batchFrameworkComps}verify(){this.active===!1&&at(92)}createTask(e,t,r,n,i=!1){this.verify();let s=r;n&&this.batchFrameworkComps&&(s="f1");const o={task:e,index:t,createOrder:++this.taskCount,deferred:i};this.addTaskToList(this[s],o),this.schedule()}addTaskToList(e,t){e.list.push(t),e.sorted=!1}sortTaskList(e){if(e.sorted)return;const t=this.scrollGoingDown?1:-1;e.list.sort((r,n)=>r.deferred!==n.deferred?r.deferred?-1:1:r.index!==n.index?t*(n.index-r.index):n.createOrder-r.createOrder),e.sorted=!0}addDestroyTask(e){this.verify(),this.destroyTasks.push(e),this.schedule()}executeFrame(e){const{p1:t,p2:r,f1:n,destroyTasks:i,beans:s}=this,{ctrlsSvc:o,frameworkOverrides:a}=s,l=t.list,c=r.list,u=n.list,h=Date.now();let d=0;const f=e<=0,m=o.getScrollFeature();for(;f||d<e;){if(!m.scrollGridIfNeeded()){let g;if(l.length)this.sortTaskList(t),g=l.pop().task;else if(c.length)this.sortTaskList(r),g=c.pop().task;else if(u.length)a.wrapOutgoing(()=>{for(;(f||d<e)&&!m.scrollGridIfNeeded();){if(u.length)this.sortTaskList(n),g=u.pop().task,g();else break;d=Date.now()-h}}),g=()=>{};else if(i.length)g=i.pop();else break;g()}d=Date.now()-h}l.length||c.length||u.length||i.length?this.requestFrame():this.ticking=!1}flushAllFrames(){this.active&&this.executeFrame(-1)}schedule(){this.active&&(this.ticking||(this.ticking=!0,this.requestFrame()))}requestFrame(){const e=this.executeFrame.bind(this,60);fa(this.beans,e)}isQueueEmpty(){return!this.ticking}},aH={moduleName:"AnimationFrame",version:wt,beans:[oH]},lH=class extends et{constructor(){super(...arguments),this.beanName="iconSvc"}createIconNoSpan(e,t){return Li(e,this.beans,t?.column)}},cH=class extends et{constructor(){super(...arguments),this.beanName="touchSvc"}mockBodyContextMenu(e,t){this.mockContextMenu(e,e.eBodyViewport,t)}mockHeaderContextMenu(e,t){this.mockContextMenu(e,e.eGui,t)}mockRowContextMenu(e){if(!ac())return;const t=(r,n,i)=>{const{rowCtrl:s,cellCtrl:o}=e.getControlsForEventTarget(i?.target??null);o?.column&&o.dispatchCellContextMenuEvent(i??null),this.beans.contextMenuSvc?.handleContextMenuMouseEvent(void 0,i,s,o)};this.mockContextMenu(e,e.element,t)}handleCellDoubleClick(e,t){return(()=>{if(!ac()||MT("dblclick"))return!1;const n=Date.now(),i=n-e.lastIPadMouseClickEvent<200;return e.lastIPadMouseClickEvent=n,i})()?(e.onCellDoubleClicked(t),t.preventDefault(),!0):!1}setupForHeader(e){const{gos:t,sortSvc:r,menuSvc:n}=this.beans;if(t.get("suppressTouch"))return;const{params:i,eMenu:s,eFilterButton:o}=e,a=new $l(e.getGui(),!0);e.addDestroyFunc(()=>a.destroy());const l=e.shouldSuppressMenuHide(),c=l&&bt(s)&&i.enableMenu;let u=a;if(c&&(u=new $l(s,!0),e.addDestroyFunc(()=>u.destroy())),i.enableMenu||n?.isHeaderContextMenuEnabled(i.column)){const h=c?"tap":"longTap",d=f=>i.showColumnMenuAfterMouseClick(f.touchStart);e.addManagedListeners(u,{[h]:d}),e.addManagedListeners(a,{longTap:d})}if(i.enableSorting){const h=d=>{const f=d.touchStart.target;l&&(s?.contains(f)||o?.contains(f))||r?.progressSort(i.column,!1,"uiColumnSorted")};e.addManagedListeners(a,{tap:h})}if(i.enableFilterButton&&o){const h=new $l(o,!0);e.addManagedListeners(h,{tap:()=>i.showFilter(o)}),e.addDestroyFunc(()=>h.destroy())}}setupForHeaderGroup(e){const t=e.params;if(this.beans.menuSvc?.isHeaderContextMenuEnabled(t.columnGroup.getProvidedColumnGroup())){const r=new $l(t.eGridHeader,!0),n=i=>t.showColumnMenuAfterMouseClick(i.touchStart);e.addManagedListeners(r,{longTap:n}),e.addDestroyFunc(()=>r.destroy())}}setupForHeaderGroupElement(e,t,r){const n=new $l(t,!0);e.addManagedListeners(n,{tap:r}),e.addDestroyFunc(()=>n.destroy())}mockContextMenu(e,t,r){if(!ac())return;const n=new $l(t),i=s=>{uf(this.beans,s.touchEvent)&&r(void 0,s.touchStart,s.touchEvent)};e.addManagedListeners(n,{longTap:i}),e.addDestroyFunc(()=>n.destroy())}},uH={moduleName:"Touch",version:wt,beans:[cH]},dH=class extends et{constructor(){super(...arguments),this.beanName="cellNavigation"}wireBeans(e){this.rowSpanSvc=e.rowSpanSvc}getNextCellToFocus(e,t,r=!1){return r?this.getNextCellToFocusWithCtrlPressed(e,t):this.getNextCellToFocusWithoutCtrlPressed(e,t)}getNextCellToFocusWithCtrlPressed(e,t){const r=e===$e.UP,n=e===$e.DOWN,i=e===$e.LEFT;let s,o;const{pageBounds:a,gos:l,visibleCols:c,pinnedRowModel:u}=this.beans,{rowPinned:h}=t;if(r||n)h&&u?r?o=0:o=h==="top"?u.getPinnedTopRowCount()-1:u.getPinnedBottomRowCount()-1:o=r?a.getFirstRow():a.getLastRow(),s=t.column;else{const d=l.get("enableRtl");o=t.rowIndex,s=(i!==d?c.allCols:[...c.allCols].reverse()).find(m=>this.isCellGoodToFocusOn({rowIndex:o,rowPinned:null,column:m}))}return s?{rowIndex:o,rowPinned:h,column:s}:null}getNextCellToFocusWithoutCtrlPressed(e,t){let r=t,n=!1;for(;!n;){switch(e){case $e.UP:r=this.getCellAbove(r);break;case $e.DOWN:r=this.getCellBelow(r);break;case $e.RIGHT:r=this.gos.get("enableRtl")?this.getCellToLeft(r):this.getCellToRight(r);break;case $e.LEFT:r=this.gos.get("enableRtl")?this.getCellToRight(r):this.getCellToLeft(r);break;default:r=null,at(8,{key:e});break}r?n=this.isCellGoodToFocusOn(r):n=!0}return r}isCellGoodToFocusOn(e){const t=e.column;let r;const{pinnedRowModel:n,rowModel:i}=this.beans;switch(e.rowPinned){case"top":r=n?.getPinnedTopRow(e.rowIndex);break;case"bottom":r=n?.getPinnedBottomRow(e.rowIndex);break;default:r=i.getRow(e.rowIndex);break}return r?!this.isSuppressNavigable(t,r):!1}getCellToLeft(e){if(!e)return null;const t=this.beans.visibleCols.getColBefore(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellToRight(e){if(!e)return null;const t=this.beans.visibleCols.getColAfter(e.column);return t?{rowIndex:e.rowIndex,column:t,rowPinned:e.rowPinned}:null}getCellBelow(e){if(!e)return null;const t=this.rowSpanSvc?.getCellEnd(e)??e,r=g4(this.beans,t,!0);return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null}getCellAbove(e){if(!e)return null;const t=this.rowSpanSvc?.getCellStart(e)??e,r=k0(this.beans,{rowIndex:t.rowIndex,rowPinned:t.rowPinned},!0);return r?{rowIndex:r.rowIndex,column:e.column,rowPinned:r.rowPinned}:null}getNextTabbedCell(e,t){return t?this.getNextTabbedCellBackwards(e):this.getNextTabbedCellForwards(e)}getNextTabbedCellForwards(e){const{visibleCols:t,pagination:r}=this.beans,n=t.allCols;let i=e.rowIndex,s=e.rowPinned,o=t.getColAfter(e.column);if(!o){o=n[0];const a=g4(this.beans,e,!0);if(Yr(a)||!a.rowPinned&&!(r?.isRowInPage(a.rowIndex)??!0))return null;i=a?a.rowIndex:null,s=a?a.rowPinned:null}return{rowIndex:i,column:o,rowPinned:s}}getNextTabbedCellBackwards(e){const{beans:t}=this,{visibleCols:r,pagination:n}=t,i=r.allCols;let s=e.rowIndex,o=e.rowPinned,a=r.getColBefore(e.column);if(!a){a=zr(i);const l=k0(t,{rowIndex:e.rowIndex,rowPinned:e.rowPinned},!0);if(Yr(l)||!l.rowPinned&&!(n?.isRowInPage(l.rowIndex)??!0))return null;s=l?l.rowIndex:null,o=l?l.rowPinned:null}return{rowIndex:s,column:a,rowPinned:o}}isSuppressNavigable(e,t){const{suppressNavigable:r}=e.colDef;if(typeof r=="boolean")return r;if(typeof r=="function"){const n=e.createColumnFunctionCallbackParams(t);return r(n)}return!1}};function hH(e){return e.focusSvc.getFocusedCell()}function fH(e){return e.focusSvc.clearFocusedCell()}function pH(e,t,r,n){e.focusSvc.setFocusedCell({rowIndex:t,column:r,rowPinned:n,forceBrowserFocus:!0})}function gH(e,t){return e.navigation?.tabToNextCell(!1,t)??!1}function mH(e,t){return e.navigation?.tabToNextCell(!0,t)??!1}function vH(e,t,r=!1){const n=e.headerNavigation?.getHeaderPositionForColumn(t,r);n&&e.focusSvc.focusHeaderPosition({headerPosition:n})}var bH=class extends et{constructor(){super(...arguments),this.beanName="editModelSvc",this.edits=new Map,this.cellValidations=new kR,this.rowValidations=new RR,this.suspendEdits=!1}suspend(e){this.suspendEdits=e}removeEdits({rowNode:e,column:t}){if(!this.hasEdits({rowNode:e})||!e)return;const r=this.getEditRow(e);t?r.delete(t):r.clear(),r.size===0&&this.edits.delete(e)}getEditRow(e,t={}){if(this.suspendEdits||this.edits.size===0)return;const r=e&&this.edits.get(e);if(r)return r;if(t.checkSiblings){const n=e.pinnedSibling;if(n)return this.getEditRow(n)}}getEditRowDataValue(e,{checkSiblings:t}={}){if(!e||this.edits.size===0)return;const r=this.getEditRow(e),n=e.pinnedSibling,i=t&&n&&this.getEditRow(n);if(!r&&!i)return;const s=Object.assign({},e.data),o=(a,l)=>a.forEach(({pendingValue:c},u)=>{c!==Rs&&(l[u.getColId()]=c)});return r&&o(r,s),i&&o(i,s),s}getEdit(e,t){const r=this._getEdit(e);return t&&r?{...r}:r}_getEdit(e){if(!this.suspendEdits&&this.edits.size!==0)return e.rowNode&&e.column&&this.getEditRow(e.rowNode)?.get(e.column)}getEditMap(e=!0){if(this.suspendEdits||this.edits.size===0)return new Map;if(!e)return this.edits;const t=new Map;return this.edits.forEach((r,n)=>{const i=new Map;r.forEach(({editorState:s,...o},a)=>i.set(a,{...o})),t.set(n,i)}),t}setEditMap(e){this.edits.clear(),e.forEach((t,r)=>{const n=new Map;t.forEach((i,s)=>n.set(s,{...i})),this.edits.set(r,n)})}setEdit(e,t){(this.edits.size===0||!this.edits.has(e.rowNode))&&this.edits.set(e.rowNode,new Map);const r=this._getEdit(e),n=Object.assign({editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0},...r,...t});return this.getEditRow(e.rowNode).set(e.column,n),n}clearEditValue(e){const{rowNode:t,column:r}=e;if(t)if(r){const n=this._getEdit(e);n&&(n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed")}else this.getEditRow(t)?.forEach(n=>{n.editorValue=void 0,n.pendingValue=n.sourceValue,n.state="changed"})}getState(e){if(!this.suspendEdits)return this.getEdit(e)?.state}getEditPositions(e){if(this.suspendEdits||(e??this.edits).size===0)return[];const t=[];return(e??this.edits).forEach((r,n)=>{for(const i of r.keys()){const{editorState:s,...o}=r.get(i);t.push({rowNode:n,column:i,...o})}}),t}hasRowEdits(e,t){return this.suspendEdits||this.edits.size===0?!1:!!this.getEditRow(e,t)}hasEdits(e={},t={}){if(this.suspendEdits||this.edits.size===0)return!1;const{rowNode:r,column:n}=e,{withOpenEditor:i}=t;if(r){const s=this.getEditRow(r,t);return s?n?i?this.getEdit(e)?.state==="editing":s.has(n)??!1:s.size!==0?i?Array.from(s.values()).some(({state:o})=>o==="editing"):!0:!1:!1}return i?this.getEditPositions().some(({state:s})=>s==="editing"):this.edits.size>0}start(e){const t=this.getEditRow(e.rowNode)??new Map,{rowNode:r,column:n}=e;n&&!t.has(n)&&t.set(n,{editorValue:void 0,pendingValue:Rs,sourceValue:this.beans.valueSvc.getValue(n,r,!1,"api"),state:"editing",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}}),this.edits.set(r,t)}stop(e){this.hasEdits(e)&&(e?this.removeEdits(e):this.clear())}clear(){for(const e of this.edits.values())e.clear();this.edits.clear()}getCellValidationModel(){return this.cellValidations}getRowValidationModel(){return this.rowValidations}setCellValidationModel(e){this.cellValidations=e}setRowValidationModel(e){this.rowValidations=e}destroy(){super.destroy(),this.clear()}},kR=class{constructor(){this.cellValidations=new Map}getCellValidation(e){const{rowNode:t,column:r}=e||{};return this.cellValidations?.get(t)?.get(r)}hasCellValidation(e){return!e?.rowNode||!e.column?this.cellValidations.size>0:!!this.getCellValidation(e)}setCellValidation(e,t){const{rowNode:r,column:n}=e;this.cellValidations.has(r)||this.cellValidations.set(r,new Map),this.cellValidations.get(r).set(n,t)}clearCellValidation(e){const{rowNode:t,column:r}=e;this.cellValidations.get(t)?.delete(r)}setCellValidationMap(e){this.cellValidations=e}getCellValidationMap(){return this.cellValidations}clearCellValidationMap(){this.cellValidations.clear()}},RR=class{constructor(){this.rowValidations=new Map}getRowValidation(e){const{rowNode:t}=e||{};return this.rowValidations.get(t)}hasRowValidation(e){return e?.rowNode?!!this.getRowValidation(e):this.rowValidations.size>0}setRowValidation({rowNode:e},t){this.rowValidations.set(e,t)}clearRowValidation({rowNode:e}){this.rowValidations.delete(e)}setRowValidationMap(e){this.rowValidations=e}getRowValidationMap(){return this.rowValidations}clearRowValidationMap(){this.rowValidations.clear()}};function A0(e,t={}){const{rowIndex:r,rowId:n,rowCtrl:i,rowPinned:s}=t;if(i)return i;const{rowModel:o,rowRenderer:a}=e;let{rowNode:l}=t;return l||(n?l=AI(e,n,s):r!=null&&(l=o.getRow(r))),a.getRowCtrls(l?[l]:[])?.[0]}function en(e,t={}){const{cellCtrl:r,colId:n,columnId:i,column:s}=t;if(r)return r;const o=e.colModel.getCol(n??i??Cw(s)),a=t.rowCtrl??A0(e,t),l=a?.getCellCtrl(o)??void 0;if(l)return l;const c=t.rowNode??a?.rowNode;if(c)return e.rowRenderer.getCellCtrls([c],[o])?.[0]}function H4(e){const{editSvc:t}=e;t?.isBatchEditing()?(el(e,{persist:!0}),Qu(e)):t?.stopEditing(void 0,{source:"api"})}function wH(e,t,r){const{gos:n,popupSvc:i}=t;if(!n.get("stopEditingWhenCellsLoseFocus"))return;const s=o=>{const a=o.relatedTarget;if(aw(a)===null){H4(t);return}let l=r.some(c=>c.contains(a))&&n.isElementInThisInstance(a);l||(l=!!i&&(i.getActivePopups().some(c=>c.contains(a))||i.isElementWithinCustomPopup(a))),l||H4(t)};for(const o of r)e.addManagedElementListeners(o,{focusout:s})}function Cw(e){if(e)return typeof e=="string"?e:e.getColId()}var Rs=Symbol("unedited");function AR(e,t={}){const r=[],n=e.rowRenderer.getCellCtrls(t.rowNodes,t.columns);for(const i of n){const s=i.comp?.getCellEditor();s&&r.push({ctrl:i,editor:ff(s)})}return r}var yH=(e,t={})=>AR(e,t).map(r=>r.editor);function CH(e,t,r,n,i,s){t.length===0&&r?.rowNode&&r?.column&&hd(e,r,{key:n,event:i,cellStartedEdit:s});const{valueSvc:o,editSvc:a,editModelSvc:l}=e,{rowNode:c,column:u}=r??{};for(const h of t){const{rowNode:d,column:f}=h,m=en(e,h);if(!m){if(d&&f){const g=o.getValue(f,d,void 0,"api"),C=(r?.rowNode===d&&r?.column===f&&n||void 0)??a?.getCellDataValue(h,!1)??o.getValueForDisplay({column:f,node:d})?.value??g??Rs;l?.setEdit(h,{pendingValue:fd(e,C,!1,f),sourceValue:g,state:"editing"})}continue}const v=s&&c===m.rowNode&&m.column===u;hd(e,{rowNode:c,column:m.column},{key:v?n:null,event:v?i:null,cellStartedEdit:v&&s})}}function Co({pendingValue:e,sourceValue:t}){return e===Rs&&(e=t),e!==t}function hd(e,t,r){const{key:n,event:i,cellStartedEdit:s,silent:o}=r??{},{editModelSvc:a,editSvc:l,gos:c,userCompFactory:u}=e,h=en(e,t),d=h?.comp?.getCellEditor(),f=MR(e,t,n,s&&!o),m=t.column.isAllowFormula(),v=a?.getEdit(t),g=f.value??v?.sourceValue;if(d){a?.setEdit(t,{editorValue:fd(e,g,!0,t.column),state:"editing"}),d.refresh?.(f);return}const w=t.column.getColDef(),y=vk(u,m?{...w,cellEditor:"agTextCellEditor"}:w,f);if(!y)return;const{popupFromSelector:C,popupPositionFromSelector:k}=y,F=C??!!w.cellEditorPopup,I=k??w.cellEditorPopupPosition;if(DR(y.params,i),!h)return;const{rangeFeature:N,rowCtrl:j,comp:L,onEditorAttachedFuncs:W}=h;a?.setEdit(t,{editorValue:fd(e,g,!0,t.column),state:"editing"}),h.editCompDetails=y,W.push(()=>N?.unsetComp()),L?.setEditDetails(y,F,I,c.get("reactiveCustomComponents")),j?.refreshRow({suppressFlash:!0});const K=a?.getEdit(t,!0);!o&&!K?.editorState?.cellStartedEditing&&(l?.dispatchCellEvent(t,i,"cellEditingStarted",{value:g}),a?.setEdit(t,{editorState:{cellStartedEditing:!0}}))}function FR(e,t,r){const n={editorValueExists:!1};if(Hy(e)&&(t.getValidationErrors?.()?.length??0)>0||r?.isCancelling)return n;if(r?.isStopping){const s=t?.isCancelAfterEnd?.();if(s)return{...n,isCancelAfterEnd:s}}return{editorValue:t.getValue(),editorValueExists:!0}}function MR(e,t,r,n){const{valueSvc:i,gos:s,editSvc:o}=e,a=e.gos.get("enableGroupEdit"),l=en(e,t),c=t.rowNode?.rowIndex??void 0,u=o?.isBatchEditing(),h=e.colModel.getCol(t.column.getId()),{rowNode:d,column:f}=t,m=l.comp?.getCellEditor(),v=o?.getCellDataValue(t,!1),g=v===void 0?m?FR(e,m)?.editorValue:void 0:v,w=g===Rs?i.getValueForDisplay({column:h,node:d})?.value:g;let y=a?g:w;return f.isAllowFormula()&&e.formula?.isFormula(y)&&(y=e.formula?.normaliseFormula(y,!0)??y),Dt(s,{value:y,eventKey:r??null,column:f,colDef:f.getColDef(),rowIndex:c,node:d,data:d.data,cellStartedEdit:n??!1,onKeyDown:l?.onKeyDown.bind(l),stopEditing:C=>{o.stopEditing(t,{source:u?"ui":"api",suppressNavigateAfterEdit:C}),vf(e,t)},eGridCell:l?.eGui,parseValue:C=>i.parseValue(h,d,C,l?.value),formatValue:l?.formatValue.bind(l),validate:()=>{o?.validateEdit()}})}function s0(e,t){const{editModelSvc:r}=e;r?.getEditMap().forEach((n,i)=>{n.forEach((s,o)=>{!t&&(s.state==="editing"||s.pendingValue===Rs)||!Co(s)&&(s.state!=="editing"||t)&&r?.removeEdits({rowNode:i,column:o})})})}function xH(e,t){const r=t.comp?.getCellEditor();if(!r?.refresh)return;const{eventKey:n,cellStartedEdit:i}=t.editCompDetails.params,{column:s}=t,o=MR(e,t,n,i),a=s.getColDef(),l=vk(e.userCompFactory,a,o);r.refresh(DR(l.params,n))}function DR(e,t){return t instanceof KeyboardEvent&&e.column.getColDef().cellEditor==="agNumberCellEditor"?e.suppressPreventDefault=["-","+",".","e"].includes(t?.key??"")||e.suppressPreventDefault:t?.preventDefault?.(),e}function el(e,t){for(const r of e.editModelSvc?.getEditPositions()??[]){const n=en(e,r);if(!n)continue;const i=n.comp?.getCellEditor();if(!i)continue;const{editorValue:s,editorValueExists:o,isCancelAfterEnd:a}=FR(e,i,t);a&&e.editModelSvc?.setEdit(r,{editorState:{isCancelAfterEnd:a}}),o0(e,r,s,void 0,!o,t)}}function o0(e,t,r,n,i,s){const{editModelSvc:o,valueSvc:a}=e;if(!o)return;const{rowNode:l,column:c}=t;if(!(l&&c))return;let u=o.getEdit(t,!0);if(!u?.sourceValue){const h={sourceValue:a.getValue(c,l,void 0,"api"),pendingValue:u?fd(e,u.editorValue,!1,c):Rs};s?.persist&&(h.state="changed"),u=o.setEdit(t,h)}o.setEdit(t,{editorValue:i?fd(e,u.sourceValue,!0,c):r}),s?.persist&&SH(e,t)}function fd(e,t,r,n){const{formula:i}=e;return n.isAllowFormula()&&i?.isFormula(t)?i?.normaliseFormula(t,r)??t:t}function SH(e,t){const{editModelSvc:r}=e,n=r?.getEdit(t,!0);r?.setEdit(t,{pendingValue:fd(e,n?.editorValue,!1,t.column)})}function Qu(e,t,r){t||(t=e.editModelSvc?.getEditPositions());for(const n of t??[])vf(e,n,r)}function vf(e,t,r,n=en(e,t)){const i=e.gos.get("enableGroupEdit"),s=e.editModelSvc,o=s?.getEdit(t,!0);if(!n){o&&s?.setEdit(t,{state:"changed"});return}const a=n.comp,l=a?.getCellEditor();if(a&&!l){if(n?.refreshCell(),o){s?.setEdit(t,{state:"changed"});const u=i?j4(r,o):{valueChanged:!1,newValue:void 0,oldValue:o.sourceValue};V4(e,t,u,r)}return}if(Hy(e)){const u=o&&l?.getValidationErrors?.(),h=s?.getCellValidationModel();u?.length?h?.setCellValidation(t,{errorMessages:u}):h?.clearCellValidation(t)}o&&s?.setEdit(t,{state:"changed"}),a?.setEditDetails(),a?.refreshEditStyles(!1,!1),n?.refreshCell({force:!0,suppressFlash:!0});const c=s?.getEdit(t);if(c&&c.state==="changed"){const u=i?j4(r,c):{valueChanged:Co(c)&&!r?.cancel,newValue:r?.cancel||c.editorState.isCancelAfterEnd?void 0:c?.editorValue??o?.pendingValue,oldValue:c?.sourceValue};V4(e,t,u,r)}}function j4(e,t){return e?.cancel?{valueChanged:!1,oldValue:t.sourceValue,newValue:void 0,value:t.sourceValue}:{valueChanged:Co(t),oldValue:t.sourceValue,newValue:t.pendingValue,value:t.sourceValue}}function V4(e,t,r,{silent:n,event:i}={}){const{editSvc:s,editModelSvc:o}=e,a=o?.getEdit(t),{editorState:l}=a||{},{isCancelBeforeStart:c}=l||{};!n&&!c&&(s?.dispatchCellEvent(t,i,"cellEditingStopped",r),o?.setEdit(t,{editorState:{cellStoppedEditing:!0}}))}function Hy(e){const{gos:t,colModel:r}=e,n=!!t.get("getFullRowEditValidationErrors"),i=r.getColumnDefs()?.filter(o=>o.editable).some(({cellEditorParams:o})=>{const{minLength:a,maxLength:l,getValidationErrors:c,min:u,max:h}=o||{};return a!==void 0||l!==void 0||c!==void 0||u!==void 0||h!==void 0}),s=e.gridApi.getCellEditorInstances().some(o=>o.getValidationElement||o.getValidationErrors);return i||n||s}function yc(e,t){if(!(t||Hy(e)))return;const r=AR(e),n=new kR,{ariaAnnounce:i,localeSvc:s,editModelSvc:o,gos:a}=e,l=a.get("editType")==="fullRow",u=PT(s)("ariaValidationErrorPrefix","Cell Editor Validation");for(const d of r){const{ctrl:f,editor:m}=d,{rowNode:v,column:g}=f,w=m.getValidationErrors?.()??[],y=m.getValidationElement?.(!1)||!m.isPopup?.()&&f.eGui;if(y){const C=w!=null&&w.length>0,k=C?w.join(". "):"";ny(y,C),C&&i.announceValue(`${u} ${w}`,"editorValidation"),y instanceof HTMLInputElement?y.setCustomValidity(k):y.classList.toggle("invalid",C)}w?.length>0&&n.setCellValidation({rowNode:v,column:g},{errorMessages:w})}el(e,{persist:!1}),o?.setCellValidationModel(n);const h=new Set;for(const{ctrl:d}of r)h.add(d.rowCtrl);if(l){const d=_H(e);o?.setRowValidationModel(d)}for(const d of h.values()){d.rowEditStyleFeature?.applyRowStyles();for(const f of d.getAllCellCtrls())f.tooltipFeature?.refreshTooltip(!0),f.editorTooltipFeature?.refreshTooltip(!0),f.editStyleFeature?.applyCellStyles?.()}}var _H=e=>{const t=new RR,r=e.gos.get("getFullRowEditValidationErrors"),n=e.editModelSvc?.getEditMap();if(!n)return t;for(const i of n.keys()){const s=n.get(i);if(!s)continue;const o=[],{rowIndex:a,rowPinned:l}=i;for(const u of s.keys()){const h=s.get(u);if(!h)continue;const{editorValue:d,pendingValue:f,sourceValue:m}=h,v=d??(f===Rs?void 0:f)??m;o.push({column:u,colId:u.getColId(),rowIndex:a,rowPinned:l,oldValue:m,newValue:v})}const c=r?.({editorsState:o})??[];c.length>0&&t.setRowValidation({rowNode:i},{errorMessages:c})}return t};function EH(e){yc(e,!0);const t=e.editModelSvc?.getCellValidationModel().getCellValidationMap();if(!t)return null;const r=[];return t.forEach((n,i)=>{n.forEach(({errorMessages:s},o)=>{r.push({column:o,rowIndex:i.rowIndex,rowPinned:i.rowPinned,messages:s??null})})}),r}function TH(e,t,r,{rowNode:n,column:i},s){return Dt(e.gos,{type:r,node:n,data:n.data,value:s,column:i,colDef:i.getColDef(),rowPinned:n.rowPinned,event:t,rowIndex:n.rowIndex})}function kH(e,t=!1){return e===$e.DELETE?!0:!t&&e===$e.BACKSPACE?yk():!1}var RH=class extends et{constructor(e,t,r,n){super(),this.cellCtrl=e,this.rowNode=r,this.rowCtrl=n,this.beans=t}init(){this.eGui=this.cellCtrl.eGui}onKeyDown(e){const t=e.key;switch(t){case $e.ENTER:this.onEnterKeyDown(e);break;case $e.F2:this.onF2KeyDown(e);break;case $e.ESCAPE:this.onEscapeKeyDown(e);break;case $e.TAB:this.onTabKeyDown(e);break;case $e.BACKSPACE:case $e.DELETE:this.onBackspaceOrDeleteKeyDown(t,e);break;case $e.DOWN:case $e.UP:case $e.RIGHT:case $e.LEFT:this.onNavigationKeyDown(e,t);break}}onNavigationKeyDown(e,t){const{cellCtrl:r,beans:n}=this;if(!n.editSvc?.isEditing(r,{withOpenEditor:!0})){if(e.shiftKey&&r.isRangeSelectionEnabled())this.onShiftRangeSelect(e);else{const i=r.getFocusedCellPosition();n.navigation?.navigateToNextCell(e,t,i,!0)}e.preventDefault()}}onShiftRangeSelect(e){const{rangeSvc:t,navigation:r}=this.beans;if(!t)return;const n=t.extendLatestRangeInDirection(e);n&&(e.key===$e.LEFT||e.key===$e.RIGHT?r?.ensureColumnVisible(n.column):r?.ensureRowVisible(n.rowIndex))}onTabKeyDown(e){this.beans.navigation?.onTabKeyDown(this.cellCtrl,e)}onBackspaceOrDeleteKeyDown(e,t){const{cellCtrl:r,beans:n,rowNode:i}=this,{gos:s,rangeSvc:o,eventSvc:a,editSvc:l}=n;if(a.dispatchEvent({type:"keyShortcutChangedCellStart"}),kH(e,s.get("enableCellEditingOnBackspace"))&&!l?.isEditing(r,{withOpenEditor:!0})){if(o&&ll(s))o.clearCellRangeCellValues({dispatchWrapperEvents:!0,wrapperEventSource:"deleteKey"});else if(r.isCellEditable()){const{column:c}=r,u=this.beans.valueSvc.getDeleteValue(c,i);i.setDataValue(c,u,"cellClear")}}else l?.isEditing(r,{withOpenEditor:!0})||n.editSvc?.startEditing(r,{startedEdit:!0,event:t});a.dispatchEvent({type:"keyShortcutChangedCellEnd"})}onEnterKeyDown(e){const{cellCtrl:t,beans:r}=this,{editSvc:n,navigation:i}=r,s=n?.isEditing(t,{withOpenEditor:!0}),o=t.rowNode,a=n?.isRowEditing(o,{withOpenEditor:!0}),l=c=>{n?.startEditing(c,{startedEdit:!0,event:e,source:"edit"})&&e.preventDefault()};if(s||a){if(this.isCtrlEnter(e)){n?.applyBulkEdit(t,r?.rangeSvc?.getCellRanges()||[]);return}if(yc(r),n?.checkNavWithValidation(void 0,e)==="block-stop")return;n?.isEditing(t,{withOpenEditor:!0})?n?.stopEditing(t,{event:e,source:"edit"}):a&&!t.isCellEditable()?n?.stopEditing({rowNode:o},{event:e,source:"edit"}):l(t)}else if(r.gos.get("enterNavigatesVertically")){const c=e.shiftKey?$e.UP:$e.DOWN;i?.navigateToNextCell(null,c,t.cellPosition,!1)}else{if(n?.hasValidationErrors())return;n?.hasValidationErrors(t)&&n.revertSingleCellEdit(t,!0),l(t)}}isCtrlEnter(e){return(e.ctrlKey||e.metaKey)&&e.key===$e.ENTER}onF2KeyDown(e){const{cellCtrl:t,beans:{editSvc:r}}=this;r?.isEditing()&&(yc(this.beans),r?.checkNavWithValidation(void 0,e)==="block-stop")||r?.startEditing(t,{startedEdit:!0,event:e})}onEscapeKeyDown(e){const{cellCtrl:t,beans:{editSvc:r}}=this;r?.checkNavWithValidation(t,e)==="block-stop"&&r.revertSingleCellEdit(t),setTimeout(()=>{r?.stopEditing(t,{event:e,cancel:!0})})}processCharacter(e){const r=e.target!==this.eGui,{beans:{editSvc:n},cellCtrl:i}=this;if(r||n?.isEditing(i,{withOpenEditor:!0}))return;if(e.key===$e.SPACE)this.onSpaceKeyDown(e);else if(n?.isCellEditable(i,"ui")){if(n?.hasValidationErrors()&&!n?.hasValidationErrors(i))return;n?.startEditing(i,{startedEdit:!0,event:e,source:"api"}),!i.editCompDetails?.params?.suppressPreventDefault&&e.preventDefault()}}onSpaceKeyDown(e){const{gos:t,editSvc:r}=this.beans,{rowNode:n}=this.cellCtrl;!r?.isEditing(this.cellCtrl,{withOpenEditor:!0})&&sc(t)&&this.beans.selectionSvc?.handleSelectionEvent(e,n,"spaceKey"),e.preventDefault()}},AH=class extends et{constructor(e,t,r){super(),this.cellCtrl=e,this.column=r,this.beans=t}onMouseEvent(e,t){if(!na(t))switch(e){case"click":this.onCellClicked(t);break;case"mousedown":case"touchstart":this.onMouseDown(t);break;case"dblclick":this.onCellDoubleClicked(t);break;case"mouseout":this.onMouseOut(t);break;case"mouseover":this.onMouseOver(t);break}}onCellClicked(e){if(this.beans.touchSvc?.handleCellDoubleClick(this,e))return;const{eventSvc:t,rangeSvc:r,editSvc:n,editModelSvc:i,frameworkOverrides:s,gos:o}=this.beans,a=e.ctrlKey||e.metaKey,{cellCtrl:l}=this,{column:c,cellPosition:u,rowNode:h}=l,d=t0(o,c,h,e);r&&a&&!d&&r.getCellRangeCount(u)>1&&r.intersectLastRange(!0);const f=l.createEvent(e,"cellClicked");f.isEventHandlingSuppressed=d,t.dispatchEvent(f);const m=c.getColDef();if(m.onCellClicked&&window.setTimeout(()=>{s.wrapOutgoing(()=>{m.onCellClicked(f)})},0),!d&&i?.getState(l)!=="editing"){const v=n?.isEditing(),g=i?.getCellValidationModel().getCellValidationMap().size??0,w=i?.getRowValidationModel().getRowValidationMap().size??0;if(v&&(g>0||w>0))return;n?.shouldStartEditing(l,e)?n?.startEditing(l,{event:e}):n?.shouldStopEditing(l,e)&&(this.beans.gos.get("editType")==="fullRow"?n?.stopEditing(l,{event:e,source:"edit"}):n?.stopEditing(void 0,{event:e,source:"edit"}))}}onCellDoubleClicked(e){const{column:t,beans:r,cellCtrl:n}=this,{eventSvc:i,frameworkOverrides:s,editSvc:o,editModelSvc:a,gos:l}=r,c=t0(l,n.column,n.rowNode,e),u=t.getColDef(),h=n.createEvent(e,"cellDoubleClicked");if(h.isEventHandlingSuppressed=c,i.dispatchEvent(h),typeof u.onCellDoubleClicked=="function"&&window.setTimeout(()=>{s.wrapOutgoing(()=>{u.onCellDoubleClicked(h)})},0),!c&&o?.shouldStartEditing(n,e)&&a?.getState(n)!=="editing"){const d=o?.isEditing(),f=a?.getCellValidationModel().getCellValidationMap().size??0,m=a?.getRowValidationModel().getRowValidationMap().size??0;if(d&&(f>0||m>0))return;o?.startEditing(n,{event:e})}}onMouseDown(e){const{shiftKey:t}=e,r=e.target,{cellCtrl:n,beans:i}=this,{eventSvc:s,rangeSvc:o,rowNumbersSvc:a,focusSvc:l,gos:c,editSvc:u}=i,{column:h,rowNode:d,cellPosition:f}=n,m=t0(c,h,d,e),v=()=>{const C=n.createEvent(e,"cellMouseDown");C.isEventHandlingSuppressed=m,s.dispatchEvent(C)};if(m){v();return}if(this.isRightClickInExistingRange(e))return;const g=o&&!o.isEmpty(),w=this.containsWidget(r),y=ta(h);if(!(a&&y&&!a.handleMouseDownOnCell(f,e))){if(!t||!g){const C=u?.isEditing(n),F=c.get("enableCellTextSelection")&&e.defaultPrevented,I=(bl()||F)&&!C&&!jh(r)&&!w;n.focusCell(I,e)}if(t&&g&&!l.isCellFocused(f)){e.preventDefault();const C=l.getFocusedCell();if(C){const{column:k,rowIndex:F,rowPinned:I}=C;u?.isEditing(C)&&u?.stopEditing(C),l.setFocusedCell({column:k,rowIndex:F,rowPinned:I,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,sourceEvent:e})}}w||(o?.handleCellMouseDown(e,f),v())}}isRightClickInExistingRange(e){const{rangeSvc:t}=this.beans;if(t){const r=t.isCellInAnyRange(this.cellCtrl.cellPosition),n=$D(this.beans,e);if(r&&n)return!0}return!1}containsWidget(e){return nc(e,"ag-selection-checkbox",3)||nc(e,"ag-drag-handle",3)}onMouseOut(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:r}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOut")),r?.clearMouseOver()}onMouseOver(e){if(this.mouseStayingInsideCell(e))return;const{eventSvc:t,colHover:r}=this.beans;t.dispatchEvent(this.cellCtrl.createEvent(e,"cellMouseOver")),r?.setMouseOver([this.column])}mouseStayingInsideCell(e){if(!e.target||!e.relatedTarget)return!1;const t=this.cellCtrl.eGui,r=t.contains(e.target),n=t.contains(e.relatedTarget);return r&&n}},FH=class extends et{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.column=e.column,this.rowNode=e.rowNode}setupRowSpan(){this.rowSpan=this.column.getRowSpan(this.rowNode),this.addManagedListeners(this.beans.eventSvc,{newColumnsLoaded:()=>this.onNewColumnsLoaded()})}init(){this.eSetLeft=this.cellCtrl.getRootElement(),this.eContent=this.cellCtrl.eGui;const e=this.cellCtrl.getCellSpan();if(e||(this.setupColSpan(),this.setupRowSpan()),this.onLeftChanged(),this.onWidthChanged(),e||this._legacyApplyRowSpan(),e){const t=this.refreshSpanHeight.bind(this,e);t(),this.addManagedListeners(this.beans.eventSvc,{paginationChanged:t,recalculateRowBounds:t,pinnedHeightChanged:t})}}refreshSpanHeight(e){const t=e.getCellHeight();t!=null&&(this.eContent.style.height=`${t}px`)}onNewColumnsLoaded(){const e=this.column.getRowSpan(this.rowNode);this.rowSpan!==e&&(this.rowSpan=e,this._legacyApplyRowSpan(!0))}onDisplayColumnsChanged(){const e=this.getColSpanningList();ml(this.colsSpanning,e)||(this.colsSpanning=e,this.onWidthChanged(),this.onLeftChanged())}setupColSpan(){this.column.getColDef().colSpan!=null&&(this.colsSpanning=this.getColSpanningList(),this.addManagedListeners(this.beans.eventSvc,{displayedColumnsChanged:this.onDisplayColumnsChanged.bind(this),displayedColumnsWidthChanged:this.onWidthChanged.bind(this)}))}onWidthChanged(){if(!this.eContent)return;const e=this.getCellWidth();this.eContent.style.width=`${e}px`}getCellWidth(){return this.colsSpanning?this.colsSpanning.reduce((e,t)=>e+t.getActualWidth(),0):this.column.getActualWidth()}getColSpanningList(){const{column:e,rowNode:t}=this,r=e.getColSpan(t),n=[];if(r===1)n.push(e);else{let i=e;const s=e.getPinned();for(let o=0;i&&o<r&&(n.push(i),i=this.beans.visibleCols.getColAfter(i),!(!i||Yr(i)||s!==i.getPinned()));o++);}return n}onLeftChanged(){if(!this.eSetLeft)return;const e=this.modifyLeftForPrintLayout(this.getCellLeft());this.eSetLeft.style.left=e+"px"}getCellLeft(){let e;return this.beans.gos.get("enableRtl")&&this.colsSpanning?e=zr(this.colsSpanning):e=this.column,e.getLeft()}modifyLeftForPrintLayout(e){if(!this.cellCtrl.printLayout||this.column.getPinned()==="left")return e;const{visibleCols:t}=this.beans,r=t.getColsLeftWidth();if(this.column.getPinned()==="right"){const n=t.bodyWidth;return r+n+(e||0)}return r+(e||0)}_legacyApplyRowSpan(e){if(this.rowSpan===1&&!e)return;const r=oc(this.beans)*this.rowSpan;this.eContent.style.height=`${r}px`,this.eContent.style.zIndex="1"}destroy(){super.destroy()}},MH="ag-cell",DH="ag-cell-auto-height",PH="ag-cell-normal-height",IH="ag-cell-focus",OH="ag-cell-first-right-pinned",NH="ag-cell-last-left-pinned",LH="ag-cell-not-inline-editing",BH="ag-cell-wrap-text",HH=0,ed=class extends et{constructor(e,t,r,n){super(),this.column=e,this.rowNode=t,this.rowCtrl=n,this.rangeFeature=void 0,this.rowResizeFeature=void 0,this.positionFeature=void 0,this.customStyleFeature=void 0,this.editStyleFeature=void 0,this.mouseListener=void 0,this.keyboardListener=void 0,this.suppressRefreshCell=!1,this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.focusEventWhileNotReady=null,this.hasBeenFocused=!1,this.hasEdit=!1,this.tooltipFeature=void 0,this.editorTooltipFeature=void 0,this.formulaTooltipFeature=void 0,this.beans=r,this.gos=r.gos,this.editSvc=r.editSvc,this.hasEdit=!!r.editSvc;const{colId:i}=e;this.instanceId=i+"-"+HH++,this.createCellPosition(),this.updateAndFormatValue(!1)}addFeatures(){const{beans:e}=this;this.positionFeature=new FH(this,e),this.customStyleFeature=e.cellStyles?.createCellCustomStyleFeature(this),this.editStyleFeature=e.editSvc?.createCellStyleFeature(this),this.mouseListener=new AH(this,e,this.column),this.keyboardListener=new RH(this,e,this.rowNode,this.rowCtrl),this.enableTooltipFeature(),this.enableFormulaTooltipFeature();const{rangeSvc:t}=e;t&&ll(e.gos)&&(this.rangeFeature=t.createCellRangeFeature(this)),ta(this.column)&&(this.rowResizeFeature=this.beans.rowNumbersSvc.createRowNumbersRowResizerFeature(this))}isCellSpanning(){return!1}getCellSpan(){}removeFeatures(){const e=this.beans.context;this.positionFeature=e.destroyBean(this.positionFeature),this.editorTooltipFeature=e.destroyBean(this.editorTooltipFeature),this.customStyleFeature=e.destroyBean(this.customStyleFeature),this.editStyleFeature=e.destroyBean(this.editStyleFeature),this.mouseListener=e.destroyBean(this.mouseListener),this.keyboardListener=e.destroyBean(this.keyboardListener),this.rangeFeature=e.destroyBean(this.rangeFeature),this.rowResizeFeature=e.destroyBean(this.rowResizeFeature),this.disableTooltipFeature(),this.disableFormulaTooltipFeature()}enableTooltipFeature(e,t){this.tooltipFeature=this.beans.tooltipSvc?.enableCellTooltipFeature(this,e,t)}enableFormulaTooltipFeature(){this.formulaTooltipFeature=this.beans.tooltipSvc?.setupFormulaTooltip(this)}disableTooltipFeature(){this.tooltipFeature=this.beans.context.destroyBean(this.tooltipFeature)}disableFormulaTooltipFeature(){this.formulaTooltipFeature=this.beans.context.destroyBean(this.formulaTooltipFeature)}enableEditorTooltipFeature(e){this.editorTooltipFeature&&this.disableEditorTooltipFeature(),this.editorTooltipFeature=this.beans.tooltipSvc?.setupCellEditorTooltip(this,e),yc(this.beans)}disableEditorTooltipFeature(){this.editorTooltipFeature=this.beans.context.destroyBean(this.editorTooltipFeature)}setComp(e,t,r,n,i,s,o){if(this.comp=e,this.eGui=t,this.printLayout=i,o??(o=this),this.addDomData(o),this.addFeatures(),o.addDestroyFunc(()=>this.removeFeatures()),this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.setupFocus(),this.applyStaticCssClasses(),this.setWrapText(),this.onFirstRightPinnedChanged(),this.onLastLeftPinnedChanged(),this.onColumnHover(),this.setupControlComps(),this.setupAutoHeight(n,o),this.refreshFirstAndLastStyles(),this.checkFormulaError(),this.refreshAriaColIndex(),this.positionFeature?.init(),this.customStyleFeature?.setComp(e),this.editStyleFeature?.setComp(e),this.tooltipFeature?.refreshTooltip(),this.keyboardListener?.init(),this.rangeFeature?.setComp(e),this.rowResizeFeature?.refreshRowResizer(),s&&this.isCellEditable()||this.hasEdit&&this.editSvc?.isEditing(this,{withOpenEditor:!0})?this.editSvc?.startEditing(this,{startedEdit:!1,source:"api",silent:!0,continueEditing:!0}):this.showValue(!1,!0),this.onCompAttachedFuncs.length){for(const a of this.onCompAttachedFuncs)a();this.onCompAttachedFuncs=[]}}checkFormulaError(){const e=!!this.beans.formula?.getFormulaError(this.column,this.rowNode);this.eGui.classList.toggle("formula-error",e),this.formulaTooltipFeature?.refreshTooltip(),e?this.disableTooltipFeature():this.enableTooltipFeature()}setupAutoHeight(e,t){this.isAutoHeight=this.beans.rowAutoHeight?.setupCellAutoHeight(this,e,t)??!1}getCellAriaRole(){return this.column.getColDef().cellAriaRole??"gridcell"}isCellRenderer(){const e=this.column.getColDef();return e.cellRenderer!=null||e.cellRendererSelector!=null}getValueToDisplay(){return this.valueFormatted??this.value}getDeferLoadingCellRenderer(){const{beans:e,column:t}=this,{userCompFactory:r,ctrlsSvc:n,eventSvc:i}=e,s=t.getColDef(),o=this.createCellRendererParams();o.deferRender=!0;const a=Z_(r,s,o);if(n.getGridBodyCtrl()?.scrollFeature?.isScrolling()){let l;const c=new hr(h=>{l=h}),[u]=this.addManagedListeners(i,{bodyScrollEnd:()=>{l(),u()}});return{loadingComp:a,onReady:c}}return{loadingComp:a,onReady:hr.resolve()}}showValue(e,t){const{beans:r,column:n,rowNode:i,rangeFeature:s}=this,{userCompFactory:o}=r;let a=this.getValueToDisplay(),l;const c=i.stub&&i.groupData?.[n.getId()]==null,u=n.getColDef();if(c||this.isCellRenderer()){const h=this.createCellRendererParams();!c||ta(n)?l=Y_(o,u,h):l=Z_(o,u,h)}if(!l&&!c&&r.findSvc?.isMatch(i,n)){const h=this.createCellRendererParams();l=Y_(o,{...n.getColDef(),cellRenderer:"agFindCellRenderer"},h)}if(this.hasEdit&&this.editSvc.isBatchEditing()&&this.editSvc.isRowEditing(i,{checkSiblings:!0})){const h=this.editSvc.prepDetailsDuringBatch(this,{compDetails:l,valueToDisplay:a});h&&(h.compDetails?l=h.compDetails:h.valueToDisplay&&(a=h.valueToDisplay))}this.comp.setRenderDetails(l,a,e),this.customRowDragComp?.refreshVisibility(),!t&&s&&fa(r,()=>s?.refreshHandle()),this.rowResizeFeature?.refreshRowResizer()}setupControlComps(){const e=this.column.getColDef();this.includeSelection=this.isIncludeControl(this.isCheckboxSelection(e),!0),this.includeRowDrag=this.isIncludeControl(e.rowDrag),this.includeDndSource=this.isIncludeControl(e.dndSource),this.comp.setIncludeSelection(this.includeSelection),this.comp.setIncludeDndSource(this.includeDndSource),this.comp.setIncludeRowDrag(this.includeRowDrag)}isForceWrapper(){return this.beans.gos.get("enableCellTextSelection")||this.column.isAutoHeight()}getCellValueClass(){const e="ag-cell-value",t=this.column.getColDef().cellRenderer==="agCheckboxCellRenderer";let r="";return t&&(r=" ag-allow-overflow"),`${e}${r}`}isIncludeControl(e,t=!1){return(this.rowNode.rowPinned==null||t&&$f(this.rowNode))&&!!e}isCheckboxSelection(e){const{rowSelection:t,groupDisplayType:r}=this.beans.gridOptions,n=g0(t),i=vl(this.column);return r==="custom"&&n!=="selectionColumn"&&i?!1:e.checkboxSelection||i&&typeof t=="object"&&Wu(t)}refreshShouldDestroy(){const e=this.column.getColDef(),t=this.includeSelection!=this.isIncludeControl(this.isCheckboxSelection(e),!0),r=this.includeRowDrag!=this.isIncludeControl(e.rowDrag),n=this.includeDndSource!=this.isIncludeControl(e.dndSource),i=this.isAutoHeight!=this.column.isAutoHeight();return t||r||n||i}onPopupEditorClosed(){const{editSvc:e}=this.beans;e?.isEditing(this,{withOpenEditor:!0})&&e?.stopEditing(this,{source:e?.isBatchEditing()?"ui":"api"})}stopEditing(e=!1){const{editSvc:t}=this.beans;return t?.stopEditing(this,{cancel:e,source:t?.isBatchEditing()?"ui":"api"})??!1}createCellRendererParams(){const{value:e,valueFormatted:t,column:r,rowNode:n,comp:i,eGui:s,beans:{valueSvc:o,gos:a,editSvc:l}}=this;return Dt(a,{value:e,valueFormatted:t,getValue:()=>o.getValueForDisplay({column:r,node:n}).value,setValue:u=>l?.setDataValue({rowNode:n,column:r},u)||n.setDataValue(r,u),formatValue:this.formatValue.bind(this),data:n.data,node:n,pinned:r.getPinned(),colDef:r.getColDef(),column:r,refreshCell:this.refreshCell.bind(this),eGridCell:s,eParentOfValue:i.getParentOfValue(),registerRowDragger:(u,h,d,f)=>this.registerRowDragger(u,h,f),setTooltip:(u,h)=>{a.assertModuleRegistered("Tooltip",3),this.tooltipFeature&&this.disableTooltipFeature(),this.enableTooltipFeature(u,h),this.tooltipFeature?.refreshTooltip()}})}onCellChanged(e){e.column===this.column&&this.refreshCell({})}refreshOrDestroyCell(e){if(this.refreshShouldDestroy()?this.rowCtrl?.recreateCell(this):this.refreshCell(e),this.hasEdit&&this.editCompDetails){const{editSvc:t,comp:r}=this;!r?.getCellEditor()&&t.isEditing(this,{withOpenEditor:!0})&&t.startEditing(this,{startedEdit:!1,source:"api",silent:!0})}}refreshCell({force:e,suppressFlash:t,newData:r}={}){const{editStyleFeature:n,customStyleFeature:i,rowCtrl:{rowEditStyleFeature:s},beans:{cellFlashSvc:o,filterManager:a},column:l,comp:c,suppressRefreshCell:u,tooltipFeature:h}=this;if(u)return;const{field:d,valueGetter:f,showRowGroup:m,enableCellChangeFlash:v}=l.getColDef(),g=d==null&&f==null&&m==null,w=e||g||r,y=!!c,C=this.updateAndFormatValue(y),k=w||C;if(y){if(k){this.showValue(!!r,!1);const F=a?.isSuppressFlashingCellsBecauseFiltering();!t&&!F&&v&&o?.flashCell(this),n?.applyCellStyles?.(),i?.applyUserStyles(),i?.applyClassesFromColDef(),s?.applyRowStyles(),this.checkFormulaError()}h?.refreshTooltip(),i?.applyCellClassRules()}}isCellEditable(){return this.column.isCellEditable(this.rowNode)}formatValue(e){return this.callValueFormatter(e)??e}callValueFormatter(e){return this.beans.valueSvc.formatValue(this.column,this.rowNode,e)}updateAndFormatValue(e){const t=this.value,r=this.valueFormatted,{value:n,valueFormatted:i}=this.beans.valueSvc.getValueForDisplay({column:this.column,node:this.rowNode,includeValueFormatted:!0});return this.value=n,this.valueFormatted=i,e?!this.valuesAreEqual(t,this.value)||this.valueFormatted!=r:!0}valuesAreEqual(e,t){const r=this.column.getColDef();return r.equals?r.equals(e,t):e===t}addDomData(e){const t=this.eGui;vc(this.beans.gos,t,E0,this),e.addDestroyFunc(()=>vc(this.beans.gos,t,E0,null))}createEvent(e,t){const{rowNode:r,column:n,value:i,beans:s}=this;return TH(s,e,t,{rowNode:r,column:n},i)}processCharacter(e){this.keyboardListener?.processCharacter(e)}onKeyDown(e){this.keyboardListener?.onKeyDown(e)}onMouseEvent(e,t){this.mouseListener?.onMouseEvent(e,t)}getColSpanningList(){return this.positionFeature?.getColSpanningList()??[]}onLeftChanged(){this.comp&&this.positionFeature?.onLeftChanged()}onDisplayedColumnsChanged(){this.eGui&&(this.refreshAriaColIndex(),this.refreshFirstAndLastStyles())}refreshFirstAndLastStyles(){const{comp:e,column:t,beans:r}=this;nR(e,t,r.visibleCols)}refreshAriaColIndex(){const e=this.beans.visibleCols.getAriaColIndex(this.column);_T(this.eGui,e)}onWidthChanged(){return this.positionFeature?.onWidthChanged()}getRowPosition(){const{rowIndex:e,rowPinned:t}=this.cellPosition;return{rowIndex:e,rowPinned:t}}updateRangeBordersIfRangeCount(){this.comp&&this.rangeFeature?.updateRangeBordersIfRangeCount()}onCellSelectionChanged(){this.comp&&this.rangeFeature?.onCellSelectionChanged()}isRangeSelectionEnabled(){return this.rangeFeature!=null}focusCell(e=!1,t){const r=this.editSvc?.allowedFocusTargetOnValidation(this);r&&r!==this||this.beans.focusSvc.setFocusedCell({...this.getFocusedCellPosition(),forceBrowserFocus:e,sourceEvent:t})}restoreFocus(e=!1){const{beans:{editSvc:t,focusSvc:r},comp:n}=this;if(!n||t?.isEditing(this)||!this.isCellFocused()||!r.shouldTakeFocus())return;const i=()=>{if(!this.isAlive())return;const s=n.getFocusableElement();this.isCellFocused()&&s.focus({preventScroll:!0})};if(e){setTimeout(i,0);return}i()}onRowIndexChanged(){this.createCellPosition(),this.onCellFocused(),this.restoreFocus(),this.rangeFeature?.onCellSelectionChanged(),this.rowResizeFeature?.refreshRowResizer()}onSuppressCellFocusChanged(e){const t=this.eGui;t&&(ta(this.column)&&(e=!0),Oi(t,"tabindex",e?void 0:-1))}onFirstRightPinnedChanged(){if(!this.comp)return;const e=this.column.isFirstRightPinned();this.comp.toggleCss(OH,e)}onLastLeftPinnedChanged(){if(!this.comp)return;const e=this.column.isLastLeftPinned();this.comp.toggleCss(NH,e)}checkCellFocused(){return this.beans.focusSvc.isCellFocused(this.cellPosition)}isCellFocused(){const e=this.checkCellFocused();return this.hasBeenFocused||(this.hasBeenFocused=e),e}setupFocus(){this.restoreFocus(!0),this.onCellFocused(this.focusEventWhileNotReady??void 0)}onCellFocused(e){const{beans:t}=this;if(lm(t))return;if(!this.comp){e&&(this.focusEventWhileNotReady=e);return}const r=this.isCellFocused(),n=t.editSvc?.isEditing(this)??!1;if(this.comp.toggleCss(IH,r),r&&e?.forceBrowserFocus){let i=this.comp.getFocusableElement();if(n){const s=Xu(i,null,!0);s.length&&(i=s[0])}i.focus({preventScroll:!!e.preventScrollOnBrowserFocus})}r&&e&&this.rowCtrl.announceDescription()}createCellPosition(){const{rowIndex:e,rowPinned:t}=this.rowNode;this.cellPosition={rowIndex:e,rowPinned:ea(t),column:this.column}}applyStaticCssClasses(){const{comp:e}=this;e.toggleCss(MH,!0),e.toggleCss(LH,!0);const t=this.column.isAutoHeight()==!0;e.toggleCss(DH,t),e.toggleCss(PH,!t)}onColumnHover(){this.beans.colHover?.onCellColumnHover(this.column,this.comp)}onColDefChanged(){this.comp&&(this.column.isTooltipEnabled()?(this.disableTooltipFeature(),this.enableTooltipFeature()):this.disableTooltipFeature(),this.setWrapText(),this.editSvc?.isEditing(this)?this.editSvc?.handleColDefChanged(this):this.refreshOrDestroyCell({force:!0,suppressFlash:!0}))}setWrapText(){const e=this.column.getColDef().wrapText==!0;this.comp.toggleCss(BH,e)}dispatchCellContextMenuEvent(e){const t=this.column.getColDef(),r=this.createEvent(e,"cellContextMenu"),{beans:n}=this;n.eventSvc.dispatchEvent(r),t.onCellContextMenu&&window.setTimeout(()=>{n.frameworkOverrides.wrapOutgoing(()=>{t.onCellContextMenu(r)})},0)}getCellRenderer(){return this.comp?.getCellRenderer()??null}destroy(){this.onCompAttachedFuncs=[],this.onEditorAttachedFuncs=[],this.isCellFocused()&&this.hasBrowserFocus()&&this.beans.focusSvc.attemptToRecoverFocus(),super.destroy()}hasBrowserFocus(){return this.eGui?.contains(tn(this.beans))??!1}createSelectionCheckbox(){const e=this.beans.selectionSvc?.createCheckboxSelectionComponent();if(e)return this.beans.context.createBean(e),e.init({rowNode:this.rowNode,column:this.column}),e}createDndSource(){const e=this.beans.registry.createDynamicBean("dndSourceComp",!1,this.rowNode,this.column,this.eGui);return e&&this.beans.context.createBean(e),e}registerRowDragger(e,t,r){if(this.customRowDragComp){this.customRowDragComp.setDragElement(e,t);return}const n=this.createRowDragComp(e,t,r);n&&(this.customRowDragComp=n,this.addDestroyFunc(()=>{this.beans.context.destroyBean(n),this.customRowDragComp=null}),n.refreshVisibility())}createRowDragComp(e,t,r){const n=this.beans.rowDragSvc?.createRowDragCompForCell(this.rowNode,this.column,()=>this.value,e,t,r);if(n)return this.beans.context.createBean(n),n}cellEditorAttached(){for(const e of this.onEditorAttachedFuncs)e();this.onEditorAttachedFuncs=[]}setFocusedCellPosition(e){}getFocusedCellPosition(){return this.cellPosition}refreshAriaRowIndex(){}getRootElement(){return this.eGui}};function jy(e,t,r,n,i,s){if(r==null&&t==null)return;const o={},a={},l=(c,u)=>{for(const h of c.split(" "))h.trim()!=""&&u(h)};if(r){const c=Object.keys(r);for(let u=0;u<c.length;u++){const h=c[u],d=r[h];let f;typeof d=="string"?f=e?e.evaluate(d,n):!0:typeof d=="function"&&(f=d(n)),l(h,m=>{f?o[m]=!0:a[m]=!0})}}if(t&&s)for(const c of Object.keys(t))l(c,u=>{o[u]||(a[u]=!0)});s&&Object.keys(a).forEach(s),Object.keys(o).forEach(i)}function G4(e){if(e.group)return e.level;const t=e.parent;return t?t.level+1:0}var jH=class extends et{constructor(){super(...arguments),this.beanName="rowStyleSvc"}processClassesFromGridOptions(e,t){const r=this.gos,n=o=>{if(typeof o=="string")e.push(o);else if(Array.isArray(o))for(const a of o)e.push(a)},i=r.get("rowClass");i&&n(i);const s=r.getCallback("getRowClass");if(s){const o={data:t.data,node:t,rowIndex:t.rowIndex},a=s(o);n(a)}}preProcessRowClassRules(e,t){this.processRowClassRules(t,r=>{e.push(r)},()=>{})}processRowClassRules(e,t,r){const{gos:n,expressionSvc:i}=this.beans,s=Dt(n,{data:e.data,node:e,rowIndex:e.rowIndex});jy(i,void 0,n.get("rowClassRules"),s,t,r)}processStylesFromGridOptions(e){const t=this.gos,r=t.get("rowStyle"),n=t.getCallback("getRowStyle");let i;if(n){const s={data:e.data,node:e,rowIndex:e.rowIndex};i=n(s)}if(i||r)return Object.assign({},r,i)}},VH=0,F0=class extends et{constructor(e,t,r,n,i){super(),this.rowNode=e,this.useAnimationFrameForCreate=n,this.printLayout=i,this.allRowGuis=[],this.active=!0,this.centerCellCtrls={list:[],map:{}},this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}},this.slideInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.fadeInAnimation={left:!1,center:!1,right:!1,fullWidth:!1},this.rowDragComps=[],this.lastMouseDownOnDragger=!1,this.emptyStyle={},this.updateColumnListsPending=!1,this.rowId=null,this.businessKey=null,this.beans=t,this.gos=t.gos,this.paginationPage=t.pagination?.getCurrentPage()??0,this.suppressRowTransform=this.gos.get("suppressRowTransform"),this.instanceId=e.id+"-"+VH++,this.rowId=Hh(e.id),this.initRowBusinessKey(),this.rowFocused=t.focusSvc.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned),this.rowLevel=G4(this.rowNode),this.setRowType(),this.setAnimateFlags(r),this.rowStyles=this.processStylesFromGridOptions(),this.rowEditStyleFeature=t.editSvc?.createRowStyleFeature(this),this.addListeners()}initRowBusinessKey(){this.businessKeyForNodeFunc=this.gos.get("getBusinessKeyForNode"),this.updateRowBusinessKey()}updateRowBusinessKey(){if(typeof this.businessKeyForNodeFunc!="function")return;const e=this.businessKeyForNodeFunc(this.rowNode);this.businessKey=Hh(e)}updateGui(e,t){e==="left"?this.leftGui=t:e==="right"?this.rightGui=t:e==="fullWidth"?this.fullWidthGui=t:this.centerGui=t}setComp(e,t,r,n){const{context:i,focusSvc:s}=this.beans;n=Vf(this,i,n);const o={rowComp:e,element:t,containerType:r,compBean:n};this.allRowGuis.push(o),this.updateGui(r,o),this.initialiseRowComp(o);const a=this.rowNode,l=this.rowType==="FullWidthLoading"||a.stub,c=!a.data&&this.beans.rowModel.getType()==="infinite";!l&&!c&&!a.rowPinned&&this.beans.rowRenderer.dispatchFirstDataRenderedEvent();const u=this.fullWidthGui?.element;u&&!this.beans.editSvc?.isEditing(this)&&s.isRowFocused(a.rowIndex,a.rowPinned)&&s.shouldTakeFocus()&&setTimeout(()=>u.focus({preventScroll:!0}),0)}unsetComp(e){this.allRowGuis=this.allRowGuis.filter(t=>t.containerType!==e),this.updateGui(e,void 0)}isCacheable(){return this.rowType==="FullWidthDetail"&&this.gos.get("keepDetailRows")}setCached(e){const t=e?"none":"";for(const r of this.allRowGuis)r.element.style.display=t}initialiseRowComp(e){const t=this.gos;this.onSuppressCellFocusChanged(this.beans.gos.get("suppressCellFocus")),this.listenOnDomOrder(e),this.onRowHeightChanged(e),this.updateRowIndexes(e),this.setFocusedClasses(e),this.setStylesFromGridOptions(!1,e),sc(t)&&this.rowNode.selectable&&this.onRowSelected(e),this.updateColumnLists(!this.useAnimationFrameForCreate);const r=e.rowComp,n=this.getInitialRowClasses(e.containerType);for(const i of n)r.toggleCss(i,!0);this.executeSlideAndFadeAnimations(e),this.rowNode.group&&Yb(e.element,this.rowNode.expanded==!0),this.setRowCompRowId(r),this.setRowCompRowBusinessKey(r),vc(t,e.element,T0,this),e.compBean.addDestroyFunc(()=>vc(t,e.element,T0,null)),this.useAnimationFrameForCreate?this.beans.animationFrameSvc.createTask(this.addHoverFunctionality.bind(this,e),this.rowNode.rowIndex,"p2",!1):this.addHoverFunctionality(e),this.isFullWidth()&&this.setupFullWidth(e),t.get("rowDragEntireRow")&&this.addRowDraggerToRow(e),this.useAnimationFrameForCreate&&this.beans.animationFrameSvc.addDestroyTask(()=>{this.isAlive()&&e.rowComp.toggleCss("ag-after-created",!0)}),this.executeProcessRowPostCreateFunc()}setRowCompRowBusinessKey(e){this.businessKey!=null&&e.setRowBusinessKey(this.businessKey)}setRowCompRowId(e){const t=Hh(this.rowNode.id);this.rowId=t,t!=null&&e.setRowId(t)}executeSlideAndFadeAnimations(e){const{containerType:t}=e;this.slideInAnimation[t]&&(Jb(()=>{this.onTopChanged()}),this.slideInAnimation[t]=!1),this.fadeInAnimation[t]&&(Jb(()=>{e.rowComp.toggleCss("ag-opacity-zero",!1)}),this.fadeInAnimation[t]=!1)}addRowDraggerToRow(e){const t=this.beans.rowDragSvc?.createRowDragCompForRow(this.rowNode,e.element);if(!t)return;const r=this.createBean(t,this.beans.context);this.rowDragComps.push(r),e.compBean.addDestroyFunc(()=>{this.rowDragComps=this.rowDragComps.filter(n=>n!==r),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,this.beans.context),this.destroyBean(r,this.beans.context)})}setupFullWidth(e){const t=this.getPinnedForContainer(e.containerType),r=this.createFullWidthCompDetails(e.element,t);e.rowComp.showFullWidth(r)}getFullWidthCellRenderers(){return this.gos.get("embedFullWidthRows")?this.allRowGuis.map(e=>e?.rowComp?.getFullWidthCellRenderer()):[this.fullWidthGui?.rowComp?.getFullWidthCellRenderer()]}executeProcessRowPostCreateFunc(){const e=this.gos.getCallback("processRowPostCreate");if(!e||!this.areAllContainersReady())return;const t={eRow:this.centerGui.element,ePinnedLeftRow:this.leftGui?this.leftGui.element:void 0,ePinnedRightRow:this.rightGui?this.rightGui.element:void 0,node:this.rowNode,rowIndex:this.rowNode.rowIndex,addRenderedRowListener:this.addEventListener.bind(this)};e(t)}areAllContainersReady(){const{leftGui:e,centerGui:t,rightGui:r,beans:{visibleCols:n}}=this,i=!!e||!n.isPinningLeft(),s=!!t,o=!!r||!n.isPinningRight();return i&&s&&o}isNodeFullWidthCell(){if(this.rowNode.detail)return!0;const e=this.beans.gos.getCallback("isFullWidthRow");return e?e({rowNode:this.rowNode}):!1}setRowType(){const{rowNode:e,gos:t,beans:{colModel:r}}=this,n=e.stub&&!t.get("suppressServerSideFullWidthLoadingRow")&&!t.get("groupHideOpenParents"),i=this.isNodeFullWidthCell(),s=t.get("masterDetail")&&e.detail,o=r.isPivotMode(),a=JT(t,e,o);n?this.rowType="FullWidthLoading":s?this.rowType="FullWidthDetail":i?this.rowType="FullWidth":a?this.rowType="FullWidthGroup":this.rowType="Normal"}updateColumnLists(e=!1,t=!1){if(this.isFullWidth())return;const{animationFrameSvc:r}=this.beans;if(!r?.active||e||this.printLayout){this.updateColumnListsImpl(t);return}this.updateColumnListsPending||(r.createTask(()=>{this.active&&this.updateColumnListsImpl(!0)},this.rowNode.rowIndex,"p1",!1),this.updateColumnListsPending=!0)}getNewCellCtrl(e){if(!this.beans.rowSpanSvc?.isCellSpanning(e,this.rowNode))return new ed(e,this.rowNode,this.beans,this)}isCorrectCtrlForSpan(e){return!this.beans.rowSpanSvc?.isCellSpanning(e.column,this.rowNode)}createCellCtrls(e,t,r=null){const n={list:[],map:{}},i=(c,u,h)=>{h!=null?n.list.splice(h,0,u):n.list.push(u),n.map[c]=u},s=[];for(const c of t){const u=c.getInstanceId();let h=e.map[u];h&&!this.isCorrectCtrlForSpan(h)&&(h.destroy(),h=void 0),h||(h=this.getNewCellCtrl(c)),h&&i(u,h)}for(const c of e.list){const u=c.column.getInstanceId();if(n.map[u]!=null)continue;!this.isCellEligibleToBeRemoved(c,r)?s.push([u,c]):c.destroy()}if(s.length)for(const[c,u]of s){const h=n.list.findIndex(f=>f.column.getLeft()>u.column.getLeft()),d=h===-1?void 0:Math.max(h-1,0);i(c,u,d)}const{focusSvc:o,visibleCols:a}=this.beans,l=o.getFocusedCell();if(l&&l.column.getPinned()==r){const c=l.column.getInstanceId();if(!n.map[c]&&a.allCols.includes(l.column)){const h=this.createFocusedCellCtrl();if(h){const d=n.list.findIndex(m=>m.column.getLeft()>h.column.getLeft()),f=d===-1?void 0:Math.max(d-1,0);i(c,h,f)}}}return n}createFocusedCellCtrl(){const{focusSvc:e,rowSpanSvc:t}=this.beans,r=e.getFocusedCell();if(!r)return;const n=t?.getCellSpan(r.column,this.rowNode);if(n){if(n.firstNode!==this.rowNode||!n.doesSpanContain(r))return}else if(!e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned))return;return this.getNewCellCtrl(r.column)}updateColumnListsImpl(e){this.updateColumnListsPending=!1,this.createAllCellCtrls(),this.setCellCtrls(e)}setCellCtrls(e){for(const t of this.allRowGuis){const r=this.getCellCtrlsForContainer(t.containerType);t.rowComp.setCellCtrls(r,e)}}getCellCtrlsForContainer(e){switch(e){case"left":return this.leftCellCtrls.list;case"right":return this.rightCellCtrls.list;case"fullWidth":return[];case"center":return this.centerCellCtrls.list}}createAllCellCtrls(){const e=this.beans.colViewport,t=this.beans.visibleCols;if(this.printLayout)this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,t.allCols),this.leftCellCtrls={list:[],map:{}},this.rightCellCtrls={list:[],map:{}};else{const r=e.getColsWithinViewport(this.rowNode);this.centerCellCtrls=this.createCellCtrls(this.centerCellCtrls,r);const n=t.getLeftColsForRow(this.rowNode);this.leftCellCtrls=this.createCellCtrls(this.leftCellCtrls,n,"left");const i=t.getRightColsForRow(this.rowNode);this.rightCellCtrls=this.createCellCtrls(this.rightCellCtrls,i,"right")}}isCellEligibleToBeRemoved(e,t){const{column:i}=e;if(i.getPinned()!=t||!this.isCorrectCtrlForSpan(e))return!0;const{visibleCols:s,editSvc:o}=this.beans,a=o?.isEditing(e),l=e.isCellFocused();return a||l?!(s.allCols.indexOf(i)>=0):!0}getDomOrder(){return this.gos.get("ensureDomOrder")||ni(this.gos,"print")}listenOnDomOrder(e){const t=()=>{e.rowComp.setDomOrder(this.getDomOrder())};e.compBean.addManagedPropertyListeners(["domLayout","ensureDomOrder"],t)}setAnimateFlags(e){if(this.rowNode.sticky||!e)return;const t=bt(this.rowNode.oldRowTop),{visibleCols:r}=this.beans,n=r.isPinningLeft(),i=r.isPinningRight();if(t){const{slideInAnimation:s}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){s.fullWidth=!0;return}s.center=!0,s.left=n,s.right=i}else{const{fadeInAnimation:s}=this;if(this.isFullWidth()&&!this.gos.get("embedFullWidthRows")){s.fullWidth=!0;return}s.center=!0,s.left=n,s.right=i}}isFullWidth(){return this.rowType!=="Normal"}refreshFullWidth(){const e=(o,a)=>o?o.rowComp.refreshFullWidth(()=>this.createFullWidthCompDetails(o.element,a).params):!0,t=e(this.fullWidthGui,null),r=e(this.centerGui,null),n=e(this.leftGui,"left"),i=e(this.rightGui,"right");return t&&r&&n&&i}addListeners(){const{beans:e,gos:t,rowNode:r}=this,{expansionSvc:n,eventSvc:i,context:s,rowSpanSvc:o}=e;this.addManagedListeners(this.rowNode,{heightChanged:()=>this.onRowHeightChanged(),rowSelected:()=>this.onRowSelected(),rowIndexChanged:this.onRowIndexChanged.bind(this),topChanged:this.onTopChanged.bind(this),...n?.getRowExpandedListeners(this)??{}}),r.detail&&this.addManagedListeners(r.parent,{dataChanged:this.onRowNodeDataChanged.bind(this)}),this.addManagedListeners(r,{dataChanged:this.onRowNodeDataChanged.bind(this),cellChanged:this.postProcessCss.bind(this),rowHighlightChanged:this.onRowNodeHighlightChanged.bind(this),draggingChanged:this.postProcessRowDragging.bind(this),uiLevelChanged:this.onUiLevelChanged.bind(this),rowPinned:this.onRowPinned.bind(this)}),this.addManagedListeners(i,{paginationPixelOffsetChanged:this.onPaginationPixelOffsetChanged.bind(this),heightScaleChanged:this.onTopChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),virtualColumnsChanged:this.onVirtualColumnsChanged.bind(this),cellFocused:this.onCellFocusChanged.bind(this),cellFocusCleared:this.onCellFocusChanged.bind(this),paginationChanged:this.onPaginationChanged.bind(this),modelUpdated:this.refreshFirstAndLastRowStyles.bind(this),columnMoved:()=>this.updateColumnLists()}),o&&this.addManagedListeners(o,{spannedCellsUpdated:({pinned:a})=>{a&&!r.rowPinned||this.updateColumnLists()}}),this.addDestroyFunc(()=>{this.rowDragComps=this.destroyBeans(this.rowDragComps,s),this.tooltipFeature=this.destroyBean(this.tooltipFeature,s),this.rowEditStyleFeature=this.destroyBean(this.rowEditStyleFeature,s)}),this.addManagedPropertyListeners(["rowStyle","getRowStyle","rowClass","getRowClass","rowClassRules"],this.postProcessCss.bind(this)),this.addManagedPropertyListener("rowDragEntireRow",()=>{if(t.get("rowDragEntireRow")){for(const l of this.allRowGuis)this.addRowDraggerToRow(l);return}this.rowDragComps=this.destroyBeans(this.rowDragComps,s)}),this.addListenersForCellComps()}addListenersForCellComps(){this.addManagedListeners(this.rowNode,{rowIndexChanged:()=>{for(const e of this.getAllCellCtrls())e.onRowIndexChanged()},cellChanged:e=>{for(const t of this.getAllCellCtrls())t.onCellChanged(e)}})}onRowPinned(){for(const e of this.allRowGuis)e.rowComp.toggleCss("ag-row-pinned-source",!!this.rowNode.pinnedSibling)}onRowNodeDataChanged(e){this.refreshRow({suppressFlash:!e.update,newData:!e.update})}refreshRow(e){if(this.isFullWidth()!==!!this.isNodeFullWidthCell()){this.beans.rowRenderer.redrawRow(this.rowNode);return}if(this.isFullWidth()){this.refreshFullWidth()||this.beans.rowRenderer.redrawRow(this.rowNode);return}for(const r of this.getAllCellCtrls())r.refreshCell(e);for(const r of this.allRowGuis)this.setRowCompRowId(r.rowComp),this.updateRowBusinessKey(),this.setRowCompRowBusinessKey(r.rowComp);this.onRowSelected(),this.postProcessCss()}postProcessCss(){this.setStylesFromGridOptions(!0),this.postProcessClassesFromGridOptions(),this.postProcessRowClassRules(),this.rowEditStyleFeature?.applyRowStyles(),this.postProcessRowDragging()}onRowNodeHighlightChanged(){const e=this.beans.rowDropHighlightSvc,t=e?.row===this.rowNode?e.position:"none",r=t==="above",n=t==="inside",i=t==="below",s=t!=="none",o=r||i,a=this.rowNode.uiLevel,l=o&&a>0,c=l?a.toString():"0";for(const u of this.allRowGuis){const h=u.rowComp;h.toggleCss("ag-row-highlight-above",r),h.toggleCss("ag-row-highlight-inside",n),h.toggleCss("ag-row-highlight-below",i),h.toggleCss("ag-row-highlight-indent",l),s?u.element.style.setProperty("--ag-row-highlight-level",c):u.element.style.removeProperty("--ag-row-highlight-level")}}postProcessRowDragging(){const e=this.rowNode.dragging;for(const t of this.allRowGuis)t.rowComp.toggleCss("ag-row-dragging",e)}onDisplayedColumnsChanged(){this.updateColumnLists(!0),this.beans.rowAutoHeight?.requestCheckAutoHeight()}onVirtualColumnsChanged(){this.updateColumnLists(!1,!0)}getRowPosition(){return{rowPinned:ea(this.rowNode.rowPinned),rowIndex:this.rowNode.rowIndex}}onKeyboardNavigate(e){const t=this.findFullWidthInfoForEvent(e);if(!t)return;const{rowGui:r,column:n}=t;if(!(r.element===e.target))return;const o=this.rowNode,{focusSvc:a,navigation:l}=this.beans,c=a.getFocusedCell(),u={rowIndex:o.rowIndex,rowPinned:o.rowPinned,column:c?.column??n};l?.navigateToNextCell(e,e.key,u,!0),e.preventDefault()}onTabKeyDown(e){if(e.defaultPrevented||na(e))return;const t=this.allRowGuis.find(a=>a.element.contains(e.target)),r=t?t.element:null,n=r===e.target,i=tn(this.beans);let s=!1;r&&i&&(s=r.contains(i)&&i.classList.contains("ag-cell"));let o=null;!n&&!s&&(o=Mc(this.beans,r,!1,e.shiftKey)),(this.isFullWidth()&&n||!o)&&this.beans.navigation?.onTabKeyDown(this,e)}getFullWidthElement(){return this.fullWidthGui?this.fullWidthGui.element:null}getRowYPosition(){const e=this.allRowGuis.find(t=>da(t.element))?.element;return e?e.getBoundingClientRect().top:0}onSuppressCellFocusChanged(e){const t=this.isFullWidth()&&e?void 0:this.gos.get("tabIndex");for(const r of this.allRowGuis)Oi(r.element,"tabindex",t)}onFullWidthRowFocused(e){const t=this.rowNode,r=e?this.isFullWidth()&&e.rowIndex===t.rowIndex&&e.rowPinned==t.rowPinned:!1;let n;if(this.fullWidthGui)n=this.fullWidthGui.element;else{const s=this.beans.colModel.getCol(e?.column)?.pinned;s?n=s==="right"?this.rightGui?.element:this.leftGui?.element:n=this.centerGui?.element}n&&(n.classList.toggle("ag-full-width-focus",r),r&&e?.forceBrowserFocus&&n.focus({preventScroll:!0}))}recreateCell(e){this.centerCellCtrls=this.removeCellCtrl(this.centerCellCtrls,e),this.leftCellCtrls=this.removeCellCtrl(this.leftCellCtrls,e),this.rightCellCtrls=this.removeCellCtrl(this.rightCellCtrls,e),e.destroy(),this.updateColumnLists()}removeCellCtrl(e,t){const r={list:[],map:{}};for(const n of e.list)n!==t&&(r.list.push(n),r.map[n.column.getInstanceId()]=n);return r}onMouseEvent(e,t){switch(e){case"dblclick":this.onRowDblClick(t);break;case"click":this.onRowClick(t);break;case"touchstart":case"mousedown":this.onRowMouseDown(t);break}}createRowEvent(e,t){const{rowNode:r}=this;return Dt(this.gos,{type:e,node:r,data:r.data,rowIndex:r.rowIndex,rowPinned:r.rowPinned,event:t})}createRowEventWithSource(e,t){const r=this.createRowEvent(e,t);return r.source=this,r}onRowDblClick(e){if(na(e))return;const t=this.createRowEventWithSource("rowDoubleClicked",e);t.isEventHandlingSuppressed=this.isSuppressMouseEvent(e),this.beans.eventSvc.dispatchEvent(t)}findFullWidthInfoForEvent(e){if(!e)return;const t=this.findFullWidthRowGui(e.target),r=this.getColumnForFullWidth(t);if(!(!t||!r))return{rowGui:t,column:r}}findFullWidthRowGui(e){return this.allRowGuis.find(t=>t.element.contains(e))}getColumnForFullWidth(e){const{visibleCols:t}=this.beans;switch(e?.containerType){case"center":return t.centerCols[0];case"left":return t.leftCols[0];case"right":return t.rightCols[0];default:return t.allCols[0]}}onRowMouseDown(e){if(this.lastMouseDownOnDragger=nc(e.target,"ag-row-drag",3),!this.isFullWidth()||this.isSuppressMouseEvent(e))return;const{rangeSvc:t,focusSvc:r}=this.beans;t?.removeAllCellRanges();const n=this.findFullWidthInfoForEvent(e);if(!n)return;const{rowGui:i,column:s}=n,o=i.element,a=e.target,l=this.rowNode;let c=e.defaultPrevented||bl();o&&o.contains(a)&&jh(a)&&(c=!1),r.setFocusedCell({rowIndex:l.rowIndex,column:s,rowPinned:l.rowPinned,forceBrowserFocus:c})}isSuppressMouseEvent(e){const{gos:t,rowNode:r}=this;if(this.isFullWidth()){const i=this.findFullWidthRowGui(e.target);return X9(t,i?.rowComp.getFullWidthCellRendererParams(),r,e)}const n=Dy(t,e.target);return n!=null&&t0(t,n.column,r,e)}onRowClick(e){if(na(e)||this.lastMouseDownOnDragger)return;const r=this.isSuppressMouseEvent(e),{eventSvc:n,selectionSvc:i}=this.beans,s=this.createRowEventWithSource("rowClicked",e);s.isEventHandlingSuppressed=r,n.dispatchEvent(s),!r&&i?.handleSelectionEvent(e,this.rowNode,"rowClicked")}setupDetailRowAutoHeight(e){this.rowType==="FullWidthDetail"&&this.beans.masterDetailSvc?.setupDetailRowAutoHeight(this,e)}createFullWidthCompDetails(e,t){const{gos:r,rowNode:n}=this,i=Dt(r,{fullWidth:!0,data:n.data,node:n,value:n.key,valueFormatted:n.key,eGridCell:e,eParentOfValue:e,pinned:t,addRenderedRowListener:this.addEventListener.bind(this),registerRowDragger:(o,a,l,c)=>this.addFullWidthRowDragging(o,a,l,c),setTooltip:(o,a)=>{r.assertModuleRegistered("Tooltip",3),this.setupFullWidthRowTooltip(o,a)}}),s=this.beans.userCompFactory;switch(this.rowType){case"FullWidthDetail":return qP(s,i);case"FullWidthGroup":{const{value:o,valueFormatted:a}=this.beans.valueSvc.getValueForDisplay({node:this.rowNode,includeValueFormatted:!0});return i.value=o,i.valueFormatted=a,$P(s,i)}case"FullWidthLoading":return WP(s,i);default:return UP(s,i)}}setupFullWidthRowTooltip(e,t){this.fullWidthGui&&(this.tooltipFeature=this.beans.tooltipSvc?.setupFullWidthRowTooltip(this.tooltipFeature,this,e,t))}addFullWidthRowDragging(e,t,r="",n){const{rowDragSvc:i,context:s}=this.beans;if(!i||!this.isFullWidth())return;const o=i.createRowDragComp(()=>r,this.rowNode,void 0,e,t,n);this.createBean(o,s),this.addDestroyFunc(()=>{this.destroyBean(o,s)})}onUiLevelChanged(){const e=G4(this.rowNode);if(this.rowLevel!=e){const t="ag-row-level-"+e,r="ag-row-level-"+this.rowLevel;for(const n of this.allRowGuis)n.rowComp.toggleCss(t,!0),n.rowComp.toggleCss(r,!1)}this.rowLevel=e}isFirstRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getFirstRow()}isLastRowOnPage(){return this.rowNode.rowIndex===this.beans.pageBounds.getLastRow()}refreshFirstAndLastRowStyles(){const e=this.isFirstRowOnPage(),t=this.isLastRowOnPage();if(this.firstRowOnPage!==e){this.firstRowOnPage=e;for(const r of this.allRowGuis)r.rowComp.toggleCss("ag-row-first",e)}if(this.lastRowOnPage!==t){this.lastRowOnPage=t;for(const r of this.allRowGuis)r.rowComp.toggleCss("ag-row-last",t)}}getAllCellCtrls(){return this.leftCellCtrls.list.length===0&&this.rightCellCtrls.list.length===0?this.centerCellCtrls.list:[...this.centerCellCtrls.list,...this.leftCellCtrls.list,...this.rightCellCtrls.list]}postProcessClassesFromGridOptions(){const e=[];if(this.beans.rowStyleSvc?.processClassesFromGridOptions(e,this.rowNode),!!e.length)for(const t of e)for(const r of this.allRowGuis)r.rowComp.toggleCss(t,!0)}postProcessRowClassRules(){this.beans.rowStyleSvc?.processRowClassRules(this.rowNode,e=>{for(const t of this.allRowGuis)t.rowComp.toggleCss(e,!0)},e=>{for(const t of this.allRowGuis)t.rowComp.toggleCss(e,!1)})}setStylesFromGridOptions(e,t){e&&(this.rowStyles=this.processStylesFromGridOptions()),this.forEachGui(t,r=>r.rowComp.setUserStyles(this.rowStyles))}getPinnedForContainer(e){return e==="left"||e==="right"?e:null}getInitialRowClasses(e){const t=this.getPinnedForContainer(e),r=this.isFullWidth(),{rowNode:n,beans:i}=this,s=[];s.push("ag-row"),s.push(this.rowFocused?"ag-row-focus":"ag-row-no-focus"),this.fadeInAnimation[e]&&s.push("ag-opacity-zero"),s.push(n.rowIndex%2===0?"ag-row-even":"ag-row-odd"),n.isRowPinned()&&(s.push("ag-row-pinned"),i.pinnedRowModel?.isManual()&&s.push("ag-row-pinned-manual")),!n.isRowPinned()&&n.pinnedSibling&&s.push("ag-row-pinned-source"),n.isSelected()&&s.push("ag-row-selected"),n.footer&&s.push("ag-row-footer"),s.push("ag-row-level-"+this.rowLevel),n.stub&&s.push("ag-row-loading"),r&&s.push("ag-full-width-row"),i.expansionSvc?.addExpandedCss(s,n),n.dragging&&s.push("ag-row-dragging");const{rowStyleSvc:o}=i;return o&&(o.processClassesFromGridOptions(s,n),o.preProcessRowClassRules(s,n)),s.push(this.printLayout?"ag-row-position-relative":"ag-row-position-absolute"),this.isFirstRowOnPage()&&s.push("ag-row-first"),this.isLastRowOnPage()&&s.push("ag-row-last"),r&&(t==="left"&&s.push("ag-cell-last-left-pinned"),t==="right"&&s.push("ag-cell-first-right-pinned")),s}processStylesFromGridOptions(){return this.beans.rowStyleSvc?.processStylesFromGridOptions(this.rowNode)??this.emptyStyle}onRowSelected(e){this.beans.selectionSvc?.onRowCtrlSelected(this,t=>{(t===this.centerGui||t===this.fullWidthGui)&&this.announceDescription()},e)}announceDescription(){this.beans.selectionSvc?.announceAriaRowSelection(this.rowNode)}addHoverFunctionality(e){if(!this.active)return;const{element:t,compBean:r}=e,{rowNode:n,beans:i,gos:s}=this;r.addManagedListeners(t,{pointerenter:o=>{o.pointerType==="mouse"&&n.dispatchRowEvent("mouseEnter")},pointerleave:o=>{o.pointerType==="mouse"&&n.dispatchRowEvent("mouseLeave")}}),r.addManagedListeners(n,{mouseEnter:()=>{!i.dragSvc?.dragging&&!s.get("suppressRowHoverHighlight")&&(t.classList.add("ag-row-hover"),n.setHovered(!0))},mouseLeave:()=>{this.resetHoveredStatus(t)}})}resetHoveredStatus(e){const t=e?[e]:this.allRowGuis.map(r=>r.element);for(const r of t)r.classList.remove("ag-row-hover");this.rowNode.setHovered(!1)}roundRowTopToBounds(e){const t=this.beans.ctrlsSvc.getScrollFeature().getApproximateVScollPosition(),r=this.applyPaginationOffset(t.top,!0)-100,n=this.applyPaginationOffset(t.bottom,!0)+100;return Math.min(Math.max(r,e),n)}forEachGui(e,t){if(e)t(e);else for(const r of this.allRowGuis)t(r)}isRowRendered(){return this.allRowGuis.length>0}onRowHeightChanged(e){if(this.rowNode.rowHeight==null)return;const t=this.rowNode.rowHeight,r=this.beans.environment.getDefaultRowHeight(),i=qT(this.gos)?al(this.beans,this.rowNode).height:void 0,s=i?`${Math.min(r,i)-2}px`:void 0;this.forEachGui(e,o=>{o.element.style.height=`${t}px`,s&&o.element.style.setProperty("--ag-line-height",s)})}destroyFirstPass(e=!1){this.active=!1;const{rowNode:t}=this;if(!e&&Uu(this.gos)&&!t.sticky)if(t.rowTop!=null){const i=this.roundRowTopToBounds(t.rowTop);this.setRowTop(i)}else for(const i of this.allRowGuis)i.rowComp.toggleCss("ag-opacity-zero",!0);this.fullWidthGui?.element.contains(tn(this.beans))&&this.beans.focusSvc.attemptToRecoverFocus(),t.setHovered(!1);const r=this.createRowEvent("virtualRowRemoved");this.dispatchLocalEvent(r),this.beans.eventSvc.dispatchEvent(r),super.destroy()}destroySecondPass(){this.allRowGuis.length=0;const e=t=>{for(const r of t.list)r.destroy();return{list:[],map:{}}};this.centerCellCtrls=e(this.centerCellCtrls),this.leftCellCtrls=e(this.leftCellCtrls),this.rightCellCtrls=e(this.rightCellCtrls)}setFocusedClasses(e){this.forEachGui(e,t=>{t.rowComp.toggleCss("ag-row-focus",this.rowFocused),t.rowComp.toggleCss("ag-row-no-focus",!this.rowFocused)})}onCellFocusChanged(){const{focusSvc:e}=this.beans,t=e.isRowFocused(this.rowNode.rowIndex,this.rowNode.rowPinned);t!==this.rowFocused&&(this.rowFocused=t,this.setFocusedClasses())}onPaginationChanged(){const e=this.beans.pagination?.getCurrentPage()??0;this.paginationPage!==e&&(this.paginationPage=e,this.onTopChanged()),this.refreshFirstAndLastRowStyles()}onTopChanged(){this.setRowTop(this.rowNode.rowTop)}onPaginationPixelOffsetChanged(){this.onTopChanged()}applyPaginationOffset(e,t=!1){if(this.rowNode.isRowPinned()||this.rowNode.sticky)return e;const r=this.beans.pageBounds.getPixelOffset();return e+r*(t?1:-1)}setRowTop(e){if(!this.printLayout&&bt(e)){const t=this.applyPaginationOffset(e),i=`${this.rowNode.isRowPinned()||this.rowNode.sticky?t:this.beans.rowContainerHeight.getRealPixelPosition(t)}px`;this.setRowTopStyle(i)}}getInitialRowTop(e){return this.suppressRowTransform?this.getInitialRowTopShared(e):void 0}getInitialTransform(e){return this.suppressRowTransform?void 0:`translateY(${this.getInitialRowTopShared(e)})`}getInitialRowTopShared(e){if(this.printLayout)return"";const t=this.rowNode;let r;if(t.sticky)r=t.stickyRowTop;else{const n=this.slideInAnimation[e]?this.roundRowTopToBounds(t.oldRowTop):t.rowTop,i=this.applyPaginationOffset(n);r=t.isRowPinned()?i:this.beans.rowContainerHeight.getRealPixelPosition(i)}return r+"px"}setRowTopStyle(e){for(const t of this.allRowGuis)this.suppressRowTransform?t.rowComp.setTop(e):t.rowComp.setTransform(`translateY(${e})`)}getCellCtrl(e,t=!1){let r=null;for(const n of this.getAllCellCtrls())n.column==e&&(r=n);if(r!=null||t)return r;for(const n of this.getAllCellCtrls())n?.getColSpanningList().indexOf(e)>=0&&(r=n);return r}onRowIndexChanged(){this.rowNode.rowIndex!=null&&(this.onCellFocusChanged(),this.updateRowIndexes(),this.postProcessCss())}updateRowIndexes(e){const t=this.rowNode.getRowIndexString();if(t===null)return;const r=(this.beans.ctrlsSvc.getHeaderRowContainerCtrl()?.getRowCount()??0)+(this.beans.filterManager?.getHeaderRowCount()??0),n=this.rowNode.rowIndex%2===0,i=r+this.rowNode.rowIndex+1;this.forEachGui(e,s=>{s.rowComp.setRowIndex(t),s.rowComp.toggleCss("ag-row-even",n),s.rowComp.toggleCss("ag-row-odd",!n),ST(s.element,i)})}},GH=class extends et{constructor(){super(),this.beanName="navigation",this.onPageDown=V_(this.onPageDown,100),this.onPageUp=V_(this.onPageUp,100)}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.gridBodyCon=e.gridBodyCtrl})}handlePageScrollingKey(e,t=!1){const r=e.key,n=e.altKey,i=e.ctrlKey||e.metaKey,s=!!this.beans.rangeSvc&&e.shiftKey,o=gI(this.gos,e);let a=!1;switch(r){case $e.PAGE_HOME:case $e.PAGE_END:!i&&!n&&(this.onHomeOrEndKey(r),a=!0);break;case $e.LEFT:case $e.RIGHT:case $e.UP:case $e.DOWN:if(!o)return!1;i&&!n&&!s&&(this.onCtrlUpDownLeftRight(r,o),a=!0);break;case $e.PAGE_DOWN:case $e.PAGE_UP:!i&&!n&&(a=this.handlePageUpDown(r,o,t));break}return a&&e.preventDefault(),a}handlePageUpDown(e,t,r){return r&&(t=this.beans.focusSvc.getFocusedCell()),t?(e===$e.PAGE_UP?this.onPageUp(t):this.onPageDown(t),!0):!1}navigateTo({scrollIndex:e,scrollType:t,scrollColumn:r,focusIndex:n,focusColumn:i,isAsync:s,rowPinned:o}){const{scrollFeature:a}=this.gridBodyCon;bt(r)&&!r.isPinned()&&a.ensureColumnVisible(r),bt(e)&&a.ensureIndexVisible(e,t),s||a.ensureIndexVisible(n);const{focusSvc:l,rangeSvc:c}=this.beans;l.setFocusedCell({rowIndex:n,column:i,rowPinned:o,forceBrowserFocus:!0}),c?.setRangeToCell({rowIndex:n,rowPinned:o,column:i})}onPageDown(e){const t=this.beans,r=fb(t),n=this.getViewportHeight(),{pageBounds:i,rowModel:s,rowAutoHeight:o}=t,a=i.getPixelOffset(),l=r.top+n,c=s.getRowIndexAtPixel(l+a);o?.active?this.navigateToNextPageWithAutoHeight(e,c):this.navigateToNextPage(e,c)}onPageUp(e){const t=this.beans,r=fb(t),{pageBounds:n,rowModel:i,rowAutoHeight:s}=t,o=n.getPixelOffset(),a=r.top,l=i.getRowIndexAtPixel(a+o);s?.active?this.navigateToNextPageWithAutoHeight(e,l,!0):this.navigateToNextPage(e,l,!0)}navigateToNextPage(e,t,r=!1){const{pageBounds:n,rowModel:i}=this.beans,s=this.getViewportHeight(),o=n.getFirstRow(),a=n.getLastRow(),l=n.getPixelOffset(),c=i.getRow(e.rowIndex),u=r?c?.rowHeight-s-l:s-l,h=c?.rowTop+u;let d=i.getRowIndexAtPixel(h+l);if(d===e.rowIndex){const m=r?-1:1;t=d=e.rowIndex+m}let f;r?(f="bottom",d<o&&(d=o),t<o&&(t=o)):(f="top",d>a&&(d=a),t>a&&(t=a)),this.isRowTallerThanView(i.getRow(d))&&(t=d,f="top"),this.navigateTo({scrollIndex:t,scrollType:f,scrollColumn:null,focusIndex:d,focusColumn:e.column})}navigateToNextPageWithAutoHeight(e,t,r=!1){this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:t,focusColumn:e.column}),setTimeout(()=>{const n=this.getNextFocusIndexForAutoHeight(e,r);this.navigateTo({scrollIndex:t,scrollType:r?"bottom":"top",scrollColumn:null,focusIndex:n,focusColumn:e.column,isAsync:!0})},50)}getNextFocusIndexForAutoHeight(e,t=!1){const r=t?-1:1,n=this.getViewportHeight(),{pageBounds:i,rowModel:s}=this.beans,o=i.getLastRow();let a=0,l=e.rowIndex;for(;l>=0&&l<=o;){const c=s.getRow(l);if(c){const u=c.rowHeight??0;if(a+u>n)break;a+=u}l+=r}return Math.max(0,Math.min(l,o))}getViewportHeight(){const e=this.beans,t=fb(e),r=this.beans.scrollVisibleSvc.getScrollbarWidth();let n=t.bottom-t.top;return e.ctrlsSvc.get("center").isHorizontalScrollShowing()&&(n-=r),n}isRowTallerThanView(e){if(!e)return!1;const t=e.rowHeight;return typeof t!="number"?!1:t>this.getViewportHeight()}onCtrlUpDownLeftRight(e,t){const r=this.beans.cellNavigation.getNextCellToFocus(e,t,!0),n=this.getNormalisedPosition(r),{rowIndex:i,rowPinned:s,column:o}=n??r,a=o;this.navigateTo({scrollIndex:i,scrollType:null,scrollColumn:a,focusIndex:i,focusColumn:a,rowPinned:s})}onHomeOrEndKey(e){const t=e===$e.PAGE_HOME,{visibleCols:r,pageBounds:n,rowModel:i}=this.beans,s=r.allCols,o=t?n.getFirstRow():n.getLastRow(),a=i.getRow(o);if(!a)return;const l=(t?s:[...s].reverse()).find(c=>!c.isSuppressNavigable(a));l&&this.navigateTo({scrollIndex:o,scrollType:null,scrollColumn:l,focusIndex:o,focusColumn:l})}onTabKeyDown(e,t){const r=t.shiftKey,n=this.tabToNextCellCommon(e,r,t),i=this.beans,{ctrlsSvc:s,pageBounds:o,focusSvc:a,gos:l}=i;if(n!==!1){n?t.preventDefault():n===null&&s.get("gridCtrl").allowFocusForNextCoreContainer(r);return}if(r){const{rowIndex:c,rowPinned:u}=e.getRowPosition();(u?c===0:c===o.getFirstRow())&&(l.get("headerHeight")===0||lc(i)?dd(i,!0,!0):(t.preventDefault(),a.focusPreviousFromFirstCell(t)))}else e instanceof ed&&e.focusCell(!0),(a.focusOverlay(!1)||dd(i,r))&&t.preventDefault()}tabToNextCell(e,t){const r=this.beans,{focusSvc:n,rowRenderer:i}=r,s=n.getFocusedCell();if(!s)return!1;let o=Lu(r,s);return!o&&(o=i.getRowByPosition(s),!o?.isFullWidth())?!1:!!this.tabToNextCellCommon(o,e,t,"api")}tabToNextCellCommon(e,t,r,n="ui"){const{editSvc:i,focusSvc:s}=this.beans;let o;const a=e instanceof ed?e:e.getAllCellCtrls()?.[0];return i?.isEditing()?o=i?.moveToNextCell(a,t,r,n):o=this.moveToNextCellNotEditing(e,t,r),o===null?o:o||!!s.focusedHeader}moveToNextCellNotEditing(e,t,r){const n=this.beans.visibleCols.allCols;let i;if(e instanceof F0){if(i={...e.getRowPosition(),column:t?n[0]:zr(n)},this.gos.get("embedFullWidthRows")&&r){const o=e.findFullWidthInfoForEvent(r);o&&(i.column=o.column)}}else i=e.getFocusedCellPosition();const s=this.findNextCellToFocusOn(i,{backwards:t,startEditing:!1});if(s===!1)return null;if(s instanceof ed)s.focusCell(!0);else if(s)return this.tryToFocusFullWidthRow(s,t);return bt(s)}findNextCellToFocusOn(e,{backwards:t,startEditing:r,skipToNextEditableCell:n}){let i=e;const s=this.beans,{cellNavigation:o,gos:a,focusSvc:l,rowRenderer:c,rangeSvc:u}=s;for(;;){e!==i&&(e=i),t||(i=this.getLastCellOfColSpan(i)),i=o.getNextTabbedCell(i,t);const h=a.getCallback("tabToNextCell");if(bt(h)){const v=h({backwards:t,editing:r,previousCellPosition:e,nextCellPosition:i||null});if(v===!0)i=e;else{if(v===!1)return!1;i={rowIndex:v.rowIndex,column:v.column,rowPinned:v.rowPinned}}}if(!i)return null;if(i.rowIndex<0){const m=yo(s);return l.focusHeaderPosition({headerPosition:{headerRowIndex:m+i.rowIndex,column:i.column},fromCell:!0}),null}const d=a.get("editType")==="fullRow";if(r&&(!d||n)&&!this.isCellEditable(i))continue;this.ensureCellVisible(i);const f=Lu(s,i);if(!f){const m=c.getRowByPosition(i);if(!m||!m.isFullWidth()||r)continue;return{...m.getRowPosition(),column:i?.column}}if(!o.isSuppressNavigable(f.column,f.rowNode))return f.setFocusedCellPosition(i),u?.setRangeToCell(i),f}}isCellEditable(e){const t=this.lookupRowNodeForCell(e);return t?e.column.isCellEditable(t):!1}lookupRowNodeForCell({rowIndex:e,rowPinned:t}){const{pinnedRowModel:r,rowModel:n}=this.beans;return t==="top"?r?.getPinnedTopRow(e):t==="bottom"?r?.getPinnedBottomRow(e):n.getRow(e)}navigateToNextCell(e,t,r,n){let i=r,s=!1;const o=this.beans,{cellNavigation:a,focusSvc:l,gos:c}=o;for(;i&&(i===r||!this.isValidNavigateCell(i));)c.get("enableRtl")?t===$e.LEFT&&(i=this.getLastCellOfColSpan(i)):t===$e.RIGHT&&(i=this.getLastCellOfColSpan(i)),i=a.getNextCellToFocus(t,i),s=Yr(i);if(s&&e&&e.key===$e.UP&&(i={rowIndex:-1,rowPinned:null,column:r.column}),n){const h=c.getCallback("navigateToNextCell");if(bt(h)){const f=h({key:t,previousCellPosition:r,nextCellPosition:i||null,event:e});bt(f)?i={rowPinned:f.rowPinned,rowIndex:f.rowIndex,column:f.column}:i=null}}if(!i)return;if(i.rowIndex<0){const h=yo(o);l.focusHeaderPosition({headerPosition:{headerRowIndex:h+i.rowIndex,column:r.column},event:e||void 0,fromCell:!0});return}const u=this.getNormalisedPosition(i);u?this.focusPosition(u):this.tryToFocusFullWidthRow(i)}getNormalisedPosition(e){if(!!this.beans.spannedRowRenderer?.getCellByPosition(e))return e;this.ensureCellVisible(e);const r=Lu(this.beans,e);return r?(e=r.getFocusedCellPosition(),this.ensureCellVisible(e),e):null}tryToFocusFullWidthRow(e,t){const{visibleCols:r,rowRenderer:n,focusSvc:i,eventSvc:s}=this.beans,o=r.allCols;if(!n.getRowByPosition(e)?.isFullWidth())return!1;const l=i.getFocusedCell(),c={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column||(t?zr(o):o[0])};this.focusPosition(c);const u=t??(l!=null&&EI(c,l));return s.dispatchEvent({type:"fullWidthRowFocused",rowIndex:c.rowIndex,rowPinned:c.rowPinned,column:c.column,isFullWidthCell:!0,fromBelow:u}),!0}focusPosition(e){const{focusSvc:t,rangeSvc:r}=this.beans;t.setFocusedCell({rowIndex:e.rowIndex,column:e.column,rowPinned:e.rowPinned,forceBrowserFocus:!0}),r?.setRangeToCell(e)}isValidNavigateCell(e){return!!ca(this.beans,e)}getLastCellOfColSpan(e){const t=Lu(this.beans,e);if(!t)return e;const r=t.getColSpanningList();return r.length===1?e:{rowIndex:e.rowIndex,column:zr(r),rowPinned:e.rowPinned}}ensureCellVisible(e){const t=XT(this.gos),r=this.beans.rowModel.getRow(e.rowIndex),n=t&&r?.sticky,{scrollFeature:i}=this.gridBodyCon;!n&&Yr(e.rowPinned)&&i.ensureIndexVisible(e.rowIndex),e.column.isPinned()||i.ensureColumnVisible(e.column)}ensureColumnVisible(e){const t=this.gridBodyCon.scrollFeature;e.isPinned()||t.ensureColumnVisible(e)}ensureRowVisible(e){this.gridBodyCon.scrollFeature.ensureIndexVisible(e)}};function fb(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}var zH={moduleName:"KeyboardNavigation",version:wt,beans:[GH,dH,EB],apiFunctions:{getFocusedCell:hH,clearFocusedCell:fH,setFocusedCell:pH,setFocusedHeader:vH,tabToNextCell:gH,tabToPreviousCell:mH}},UH=class extends et{constructor(){super(...arguments),this.beanName="pageBoundsListener"}postConstruct(){this.addManagedEventListeners({modelUpdated:this.onModelUpdated.bind(this),recalculateRowBounds:this.calculatePages.bind(this)}),this.onModelUpdated()}onModelUpdated(e){this.calculatePages(),this.eventSvc.dispatchEvent({type:"paginationChanged",animate:e?.animate??!1,newData:e?.newData??!1,newPage:e?.newPage??!1,newPageSize:e?.newPageSize??!1,keepRenderedRows:e?.keepRenderedRows??!1})}calculatePages(){const{pageBounds:e,pagination:t,rowModel:r}=this.beans;t?t.calculatePages():e.calculateBounds(0,r.getRowCount()-1)}},WH=class extends et{constructor(){super(...arguments),this.beanName="pageBounds",this.pixelOffset=0}getFirstRow(){return this.topRowBounds?.rowIndex??-1}getLastRow(){return this.bottomRowBounds?.rowIndex??-1}getCurrentPageHeight(){const{topRowBounds:e,bottomRowBounds:t}=this;return!e||!t?0:Math.max(t.rowTop+t.rowHeight-e.rowTop,0)}getCurrentPagePixelRange(){const{topRowBounds:e,bottomRowBounds:t}=this,r=e?.rowTop??0,n=t?t.rowTop+t.rowHeight:0;return{pageFirstPixel:r,pageLastPixel:n}}calculateBounds(e,t){const{rowModel:r}=this.beans,n=r.getRowBounds(e);n&&(n.rowIndex=e),this.topRowBounds=n;const i=r.getRowBounds(t);i&&(i.rowIndex=t),this.bottomRowBounds=i,this.calculatePixelOffset()}getPixelOffset(){return this.pixelOffset}calculatePixelOffset(){const e=this.topRowBounds?.rowTop??0;this.pixelOffset!==e&&(this.pixelOffset=e,this.eventSvc.dispatchEvent({type:"paginationPixelOffsetChanged"}))}},$H=".ag-pinned-left-floating-bottom,.ag-pinned-left-floating-top,.ag-pinned-right-floating-bottom,.ag-pinned-right-floating-top{min-width:0;overflow:hidden;position:relative}.ag-pinned-left-sticky-top,.ag-pinned-right-sticky-top{height:100%;overflow:hidden;position:relative}.ag-sticky-bottom-full-width-container,.ag-sticky-top-full-width-container{height:100%;overflow:hidden;width:100%}.ag-pinned-left-header,.ag-pinned-right-header{display:inline-block;height:100%;overflow:hidden;position:relative}.ag-body-horizontal-scroll:not(.ag-scrollbar-invisible){.ag-horizontal-left-spacer:not(.ag-scroller-corner){border-right:var(--ag-pinned-column-border)}.ag-horizontal-right-spacer:not(.ag-scroller-corner){border-left:var(--ag-pinned-column-border)}}.ag-pinned-right-header{border-left:var(--ag-pinned-column-border)}.ag-pinned-left-header{border-right:var(--ag-pinned-column-border)}.ag-cell.ag-cell-first-right-pinned:not(.ag-cell-range-left,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-left:var(--ag-pinned-column-border)}.ag-cell.ag-cell-last-left-pinned:not(.ag-cell-range-right,.ag-cell-range-single-cell,.ag-cell-focus:not(.ag-cell-range-selected):focus-within){border-right:var(--ag-pinned-column-border)}.ag-pinned-left-header .ag-header-cell-resize:after{left:calc(50% - var(--ag-header-column-resize-handle-width))}.ag-pinned-right-header .ag-header-cell-resize:after{left:50%}.ag-pinned-left-header .ag-header-cell-resize{right:-3px}.ag-pinned-right-header .ag-header-cell-resize{left:-3px}",qH=class extends et{constructor(e,t){super(),this.isLeft=e,this.elements=t,this.getWidth=e?()=>this.beans.pinnedCols.leftWidth:()=>this.beans.pinnedCols.rightWidth}postConstruct(){this.addManagedEventListeners({[`${this.isLeft?"left":"right"}PinnedWidthChanged`]:this.onPinnedWidthChanged.bind(this)})}onPinnedWidthChanged(){const e=this.getWidth(),t=e>0;for(const r of this.elements)r&&(Gr(r,t),So(r,e))}},KH=class extends et{constructor(){super(...arguments),this.beanName="pinnedCols"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,t=>{this.gridBodyCtrl=t.gridBodyCtrl});const e=this.checkContainerWidths.bind(this);this.addManagedEventListeners({displayedColumnsChanged:e,displayedColumnsWidthChanged:e}),this.addManagedPropertyListener("domLayout",e)}checkContainerWidths(){const{gos:e,visibleCols:t,eventSvc:r}=this.beans,n=ni(e,"print"),i=n?0:t.getColsLeftWidth(),s=n?0:t.getDisplayedColumnsRightWidth();i!=this.leftWidth&&(this.leftWidth=i,r.dispatchEvent({type:"leftPinnedWidthChanged"})),s!=this.rightWidth&&(this.rightWidth=s,r.dispatchEvent({type:"rightPinnedWidthChanged"}))}keepPinnedColumnsNarrowerThanViewport(){const e=this.gridBodyCtrl.eBodyViewport,t=cf(e);if(t<=50)return;const r=this.getPinnedColumnsOverflowingViewport(t-50),n=this.gos.getCallback("processUnpinnedColumns"),{columns:i,hasLockedPinned:s}=r;let o=i;!o.length&&!s||(n&&(o=n({columns:o,viewportWidth:t})),o?.length&&(o=o.filter(a=>!ta(a)),this.setColsPinned(o,null,"viewportSizeFeature")))}createPinnedWidthFeature(e,...t){return new qH(e,t)}setColsPinned(e,t,r){const{colModel:n,colAnimation:i,visibleCols:s,gos:o}=this.beans;if(!n.cols||!e?.length)return;if(ni(o,"print")){at(37);return}i?.start();let a;t===!0||t==="left"?a="left":t==="right"?a="right":a=null;const l=[];for(const c of e){if(!c)continue;const u=n.getCol(c);u&&u.getPinned()!==a&&(this.setColPinned(u,a),l.push(u))}l.length&&(s.refresh(r),dk(this.eventSvc,l,r)),i?.finish()}initCol(e){const{pinned:t,initialPinned:r}=e.colDef;t!==void 0?this.setColPinned(e,t):this.setColPinned(e,r)}setColPinned(e,t){t===!0||t==="left"?e.pinned="left":t==="right"?e.pinned="right":e.pinned=null,e.dispatchStateUpdatedEvent("pinned")}setupHeaderPinnedWidth(e){const{scrollVisibleSvc:t}=this.beans;if(e.pinned==null)return;const r=e.pinned==="left",n=e.pinned==="right";e.hidden=!0;const i=()=>{const s=r?this.leftWidth:this.rightWidth;if(s==null)return;const o=s==0,a=e.hidden!==o,l=this.gos.get("enableRtl"),c=t.getScrollbarWidth(),h=t.verticalScrollShowing&&(l&&r||!l&&n)?s+c:s;e.comp.setPinnedContainerWidth(`${h}px`),e.comp.setDisplayed(!o),a&&(e.hidden=o,e.refresh())};e.addManagedEventListeners({leftPinnedWidthChanged:i,rightPinnedWidthChanged:i,scrollVisibilityChanged:i,scrollbarWidthChanged:i})}getHeaderResizeDiff(e,t){if(t.getPinned()){const{leftWidth:n,rightWidth:i}=this,s=cf(this.beans.ctrlsSvc.getGridBodyCtrl().eBodyViewport)-50;if(n+i+e>s)if(s>n+i)e=s-n-i;else return 0}return e}getPinnedColumnsOverflowingViewport(e){const t=this.rightWidth??0,r=this.leftWidth??0,n=t+r;let i=!1;if(n<e)return{columns:[],hasLockedPinned:i};const{visibleCols:s}=this.beans,o=[...s.leftCols],a=[...s.rightCols];let l=0,c=0;const u=0,h=[];let d=n-u-e;for(;(c<o.length||l<a.length)&&d>0;){if(l<a.length){const f=a[l++];if(f.colDef.lockPinned){i=!0;continue}d-=f.getActualWidth(),h.push(f)}if(c<o.length&&d>0){const f=o[c++];if(f.colDef.lockPinned){i=!0;continue}d-=f.getActualWidth(),h.push(f)}}return{columns:h,hasLockedPinned:i}}},XH={moduleName:"PinnedColumn",version:wt,beans:[KH],css:[$H]},YH=class extends _i{constructor(){super(),this.beanName="ariaAnnounce",this.descriptionContainer=null,this.pendingAnnouncements=new Map,this.lastAnnouncement="",this.updateAnnouncement=zn(this,this.updateAnnouncement.bind(this),200)}postConstruct(){const e=this.beans,t=Gn(e),r=this.descriptionContainer=t.createElement("div");r.classList.add("ag-aria-description-container"),CT(r,"polite"),LM(r,"additions text"),NM(r,!0),e.eRootDiv.appendChild(r)}announceValue(e,t){this.pendingAnnouncements.set(t,e),this.updateAnnouncement()}updateAnnouncement(){if(!this.descriptionContainer)return;const e=Array.from(this.pendingAnnouncements.values()).join(". ");this.pendingAnnouncements.clear(),this.descriptionContainer.textContent="",setTimeout(()=>{this.handleAnnouncementUpdate(e)},50)}handleAnnouncementUpdate(e){if(!this.isAlive()||!this.descriptionContainer)return;let t=e;if(t==null||t.replace(/[ .]/g,"")==""){this.lastAnnouncement="";return}this.lastAnnouncement===t&&(t=`${t}`),this.lastAnnouncement=t,this.descriptionContainer.textContent=t}destroy(){super.destroy();const{descriptionContainer:e}=this;e&&(Hi(e),e.remove()),this.descriptionContainer=null,this.pendingAnnouncements.clear()}},ZH=class extends YH{},JH={moduleName:"Aria",version:wt,beans:[ZH]},QH=":where(.ag-delay-render){.ag-cell,.ag-header-cell,.ag-header-group-cell,.ag-row,.ag-spanned-cell-wrapper{visibility:hidden}}",z4="ag-delay-render",ej=class extends et{constructor(){super(...arguments),this.beanName="colDelayRenderSvc",this.hideRequested=!1,this.alreadyRevealed=!1,this.timesRetried=0,this.requesters=new Set}hideColumns(e){this.alreadyRevealed||this.requesters.has(e)||(this.requesters.add(e),this.hideRequested||(this.beans.ctrlsSvc.whenReady(this,t=>{t.gridBodyCtrl.eGridBody.classList.add(z4)}),this.hideRequested=!0))}revealColumns(e){if(this.alreadyRevealed||!this.isAlive()||(this.requesters.delete(e),this.requesters.size>0))return;const{renderStatus:t,ctrlsSvc:r}=this.beans;if(t){if(!t.areHeaderCellsRendered()&&this.timesRetried<5){this.timesRetried++,setTimeout(()=>this.revealColumns(e));return}this.timesRetried=0}r.getGridBodyCtrl().eGridBody.classList.remove(z4),this.alreadyRevealed=!0}},tj={moduleName:"ColumnDelayRender",version:wt,beans:[ej],css:[QH]};function rj(e){e.overlays?.showLoadingOverlay()}function nj(e){e.overlays?.showNoRowsOverlay()}function ij(e){e.overlays?.hideOverlay()}var sj=".ag-overlay{inset:0;pointer-events:none;position:absolute;z-index:2}.ag-overlay-panel,.ag-overlay-wrapper{display:flex;height:100%;width:100%}.ag-overlay-wrapper{align-items:center;flex:none;justify-content:center;text-align:center}.ag-overlay-exporting-wrapper,.ag-overlay-loading-wrapper,.ag-overlay-modal-wrapper{pointer-events:all}.ag-overlay-exporting-center,.ag-overlay-loading-center{background:var(--ag-background-color);border:solid var(--ag-border-width) var(--ag-border-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-popup-shadow);display:flex;padding:var(--ag-spacing)}",oj={tag:"div",cls:"ag-overlay",role:"presentation",children:[{tag:"div",cls:"ag-overlay-panel",role:"presentation",children:[{tag:"div",ref:"eOverlayWrapper",cls:"ag-overlay-wrapper",role:"presentation"}]}]},PR=class extends pn{constructor(){super(oj),this.eOverlayWrapper=xt,this.activeOverlay=null,this.activePromise=null,this.activeCssClass=null,this.elToFocusAfter=null,this.overlayExclusive=!1,this.oldWrapperPadding=null,this.registerCSS(sj)}handleKeyDown(e){if(e.key!==$e.TAB||e.defaultPrevented||na(e))return;const{beans:t,eOverlayWrapper:r}=this;if(r&&Mc(t,r,!1,e.shiftKey))return;let i=!1;e.shiftKey?i=t.focusSvc.focusGridView({column:zr(t.visibleCols.allCols),backwards:!0,canFocusOverlay:!1}):i=dd(t,!1),i&&e.preventDefault()}updateLayoutClasses(e,t){const r=this.eOverlayWrapper;if(!r)return;const n=r.classList,{AUTO_HEIGHT:i,NORMAL:s,PRINT:o}=e0;n.toggle(i,t.autoHeight),n.toggle(s,t.normal),n.toggle(o,t.print)}postConstruct(){this.createManagedBean(new Fy(this)),this.setDisplayed(!1,{skipAriaHidden:!0}),this.beans.overlays.setWrapperComp(this,!1),this.addManagedElementListeners(this.getFocusableElement(),{keydown:this.handleKeyDown.bind(this)}),this.addManagedEventListeners({gridSizeChanged:this.refreshWrapperPadding.bind(this)})}setWrapperTypeClass(e){const t=this.eOverlayWrapper?.classList;if(!t){this.activeCssClass=null;return}this.activeCssClass&&t.toggle(this.activeCssClass,!1),this.activeCssClass=e,t.toggle(e,!0)}showOverlay(e,t,r){if(this.destroyActiveOverlay(),this.elToFocusAfter=null,this.activePromise=e,this.overlayExclusive=r,!e)return this.refreshWrapperPadding(),hr.resolve();if(this.setWrapperTypeClass(t),this.setDisplayed(!0,{skipAriaHidden:!0}),this.refreshWrapperPadding(),r&&this.isGridFocused()){const n=tn(this.beans);n&&!ty(this.beans)&&(this.elToFocusAfter=n)}return e.then(n=>{const i=this.eOverlayWrapper;if(!i){this.destroyBean(n);return}if(this.activePromise!==e){this.activeOverlay!==n&&(this.destroyBean(n),n=null);return}this.activePromise=null,n&&(this.activeOverlay!==n&&(i.appendChild(n.getGui()),this.activeOverlay=n),r&&this.isGridFocused()&&bc(i))}),e}refreshWrapperPadding(){if(!this.eOverlayWrapper){this.oldWrapperPadding=null;return}const e=!!this.activeOverlay||!!this.activePromise;let t=0;e&&!this.overlayExclusive&&(t=this.beans.ctrlsSvc.get("gridHeaderCtrl")?.headerHeight||0),t!==this.oldWrapperPadding&&(this.oldWrapperPadding=t,this.eOverlayWrapper.style.setProperty("padding-top",`${t}px`))}destroyActiveOverlay(){this.activePromise=null;const e=this.activeOverlay;if(!e){this.overlayExclusive=!1,this.elToFocusAfter=null,this.refreshWrapperPadding();return}let t=this.elToFocusAfter;this.elToFocusAfter=null,this.activeOverlay=null,this.overlayExclusive=!1,t&&!this.isGridFocused()&&(t=null),this.destroyBean(e);const r=this.eOverlayWrapper;r&&Hi(r),t?.focus?.({preventScroll:!0}),this.refreshWrapperPadding()}hideOverlay(){this.destroyActiveOverlay(),this.setDisplayed(!1,{skipAriaHidden:!0})}isGridFocused(){const e=tn(this.beans);return!!e&&this.beans.eGridDiv.contains(e)}destroy(){this.elToFocusAfter=null,this.destroyActiveOverlay(),this.beans.overlays.setWrapperComp(this,!0),super.destroy(),this.eOverlayWrapper=null}},aj={selector:"AG-OVERLAY-WRAPPER",component:PR},lj=["refresh"],qf=e=>({name:e,optionalMethods:lj}),Xl={id:"agLoadingOverlay",overlayType:"loading",comp:qf("loadingOverlayComponent"),wrapperCls:"ag-overlay-loading-wrapper",exclusive:!0,compKey:"loadingOverlayComponent",paramsKey:"loadingOverlayComponentParams",isSuppressed:e=>{const t=e.get("loading");return t===!1||e.get("suppressLoadingOverlay")===!0&&t!==!0}},Bu={id:"agNoRowsOverlay",overlayType:"noRows",comp:qf("noRowsOverlayComponent"),wrapperCls:"ag-overlay-no-rows-wrapper",compKey:"noRowsOverlayComponent",paramsKey:"noRowsOverlayComponentParams",isSuppressed:e=>e.get("suppressNoRowsOverlay")},Vy={id:"agNoMatchingRowsOverlay",overlayType:"noMatchingRows",comp:qf("noMatchingRowsOverlayComponent"),wrapperCls:"ag-overlay-no-matching-rows-wrapper"},M0={id:"agExportingOverlay",overlayType:"exporting",comp:qf("exportingOverlayComponent"),wrapperCls:"ag-overlay-exporting-wrapper",exclusive:!0},a0={id:"activeOverlay",comp:qf("activeOverlay"),wrapperCls:"ag-overlay-modal-wrapper",exclusive:!0},cj=e=>e?{agLoadingOverlay:Xl,agNoRowsOverlay:Bu,agNoMatchingRowsOverlay:Vy,agExportingOverlay:M0}[e]??a0:null,uj=e=>e?{loading:Xl,noRows:Bu,noMatchingRows:Vy,exporting:M0}[e]:null,dj=class extends et{constructor(){super(...arguments),this.beanName="overlays",this.eWrapper=void 0,this.exclusive=!1,this.oldExclusive=!1,this.currentDef=null,this.showInitialOverlay=!0,this.userForcedNoRows=!1,this.exportsInProgress=0,this.newColumnsLoadedCleanup=null}postConstruct(){const e=this.gos;this.showInitialOverlay=rn(e);const t=()=>{this.userForcedNoRows||this.updateOverlay(!1)},[r,n,i,s]=this.addManagedEventListeners({newColumnsLoaded:t,rowCountReady:()=>{this.disableInitialOverlay(),t(),n()},rowDataUpdated:t,modelUpdated:t});this.newColumnsLoadedCleanup=r,this.addManagedPropertyListeners(["loading","activeOverlay","activeOverlayParams","overlayComponentParams","loadingOverlayComponentParams","noRowsOverlayComponentParams"],o=>this.onPropChange(new Set(o.changeSet?.properties)))}destroy(){this.doHideOverlay(),super.destroy(),this.eWrapper=void 0}setWrapperComp(e,t){this.isAlive()&&(t?this.eWrapper===e&&(this.eWrapper=void 0):this.eWrapper=e,this.updateOverlay(!1))}isVisible(){return!!this.currentDef}showLoadingOverlay(){this.showInitialOverlay=!1;const e=this.gos;if(!this.eWrapper||e.get("activeOverlay")||this.isDisabled(Xl))return;const t=e.get("loading");!t&&t!==void 0||this.doShowOverlay(Xl)}showNoRowsOverlay(){this.showInitialOverlay=!1;const e=this.gos;!this.eWrapper||e.get("activeOverlay")||e.get("loading")||this.isDisabled(Bu)||(this.userForcedNoRows=!0,this.doShowOverlay(Bu))}async showExportOverlay(e){const{gos:t,beans:r}=this;if(!this.eWrapper||t.get("activeOverlay")||t.get("loading")||this.isDisabled(M0)||this.userForcedNoRows&&this.currentDef===Bu){e();return}const n=this.getDesiredDefWithOverride(M0);if(!n){e();return}this.exportsInProgress++,this.focusedCell=r.focusSvc.getFocusedCell(),await this.doShowOverlay(n),await new Promise(s=>setTimeout(()=>s()));const i=Date.now();try{e()}finally{const s=Date.now()-i,o=Math.max(0,300-s),a=()=>{this.exportsInProgress--,this.exportsInProgress===0&&(this.updateOverlay(!1),PI(r,this.focusedCell),this.focusedCell=null)};o>0?setTimeout(()=>a(),o):a()}}hideOverlay(){const e=this.gos;this.showInitialOverlay=!1;const t=this.userForcedNoRows;if(this.userForcedNoRows=!1,e.get("loading")){at(99);return}if(e.get("activeOverlay")){at(296);return}if(this.currentDef===Vy){at(297);return}this.doHideOverlay(),t&&this.getOverlayDef()!==Bu&&this.updateOverlay(!1)}getOverlayWrapperSelector(){return aj}getOverlayWrapperCompClass(){return PR}onPropChange(e){const t=e.has("activeOverlay");if((t||e.has("loading"))&&this.updateOverlay(t))return;const r=this.currentDef,n=this.eWrapper?.activeOverlay;if(n&&r){const i=e.has("activeOverlayParams");if(r===a0)i&&n.refresh?.(this.makeCompParams(!0));else{const s=r.paramsKey;(e.has("overlayComponentParams")||s&&e.has(s))&&n.refresh?.(this.makeCompParams(!1,s,r.overlayType))}}}updateOverlay(e){const t=this.eWrapper;if(!t)return this.currentDef=null,!1;const r=this.getDesiredDefWithOverride(),n=this.currentDef,i=r===a0&&e;return r!==n?r?(this.doShowOverlay(r),!0):(this.disableInitialOverlay(),this.doHideOverlay()):i&&r?(t.hideOverlay(),this.doShowOverlay(r),!0):(r||this.disableInitialOverlay(),!1)}getDesiredDefWithOverride(e){const{gos:t}=this;let r=cj(t.get("activeOverlay"));return r||(r=e??this.getOverlayDef(),r&&this.isDisabled(r)&&(r=null)),r}getOverlayDef(){const{gos:e,beans:t}=this,{colModel:r,rowModel:n}=t,i=e.get("loading");if(i!==void 0){if(this.disableInitialOverlay(),i)return Xl}else if(this.showInitialOverlay){if(!this.isDisabled(Xl)&&(!e.get("columnDefs")||!r.ready||!e.get("rowData")))return Xl;this.disableInitialOverlay()}else this.disableInitialOverlay();const o=n.getOverlayType();return uj(o)}disableInitialOverlay(){this.showInitialOverlay=!1,this.newColumnsLoadedCleanup?.(),this.newColumnsLoadedCleanup=null}doShowOverlay(e){const{gos:t,beans:r}=this,{userCompFactory:n}=r;this.currentDef=e;const i=e!==a0,s=!!e.exclusive;this.exclusive=s;let o;(e.paramsKey&&t.get(e.paramsKey)||e.compKey&&t.get(e.compKey))&&(o=e.paramsKey);let a;i&&(t.get("overlayComponent")||t.get("overlayComponentSelector"))&&(a=n.getCompDetailsFromGridOptions({name:"overlayComponent",optionalMethods:["refresh"]},void 0,this.makeCompParams(!1,e.paramsKey,e.overlayType))),a??(a=n.getCompDetailsFromGridOptions(e.comp,i?e.id:void 0,this.makeCompParams(!i,o,e.overlayType),!1));const l=a?.newAgStackInstance()??null,c=this.eWrapper?this.eWrapper.showOverlay(l,e.wrapperCls,s):hr.resolve();return this.eWrapper?.refreshWrapperPadding(),this.setExclusive(s),c}makeCompParams(e,t,r){const{gos:n}=this,i=e?n.get("activeOverlayParams"):{...n.get("overlayComponentParams"),...t&&n.get(t)||null,overlayType:r};return Dt(n,i??{})}doHideOverlay(){let e=!1;this.currentDef&&(this.currentDef=null,e=!0),this.exclusive=!1;const t=this.eWrapper;return t&&(t.hideOverlay(),t.refreshWrapperPadding(),this.setExclusive(!1)),e}setExclusive(e){this.oldExclusive!==e&&(this.oldExclusive=e,this.eventSvc.dispatchEvent({type:"overlayExclusiveChanged"}))}isDisabled(e){const{gos:t}=this;return e.overlayType&&t.get("suppressOverlays")?.includes(e.overlayType)||e.isSuppressed?.(t)===!0}},hj={moduleName:"Overlay",version:wt,userComponents:{agLoadingOverlay:$I,agNoRowsOverlay:YI,agNoMatchingRowsOverlay:JI,agExportingOverlay:KI},apiFunctions:{showLoadingOverlay:rj,showNoRowsOverlay:nj,hideOverlay:ij},icons:{overlayLoading:"loading",overlayExporting:"loading"},beans:[dj]},fj=class extends et{constructor(){super(...arguments),this.beanName="rowContainerHeight",this.scrollY=0,this.uiBodyHeight=0}postConstruct(){this.addManagedEventListeners({bodyHeightChanged:this.updateOffset.bind(this)}),this.maxDivHeight=s7(),mc(this.gos,"RowContainerHeightService - maxDivHeight = "+this.maxDivHeight)}updateOffset(){if(!this.stretching)return;const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition().top,t=this.getUiBodyHeight();(e!==this.scrollY||t!==this.uiBodyHeight)&&(this.scrollY=e,this.uiBodyHeight=t,this.calculateOffset())}calculateOffset(){this.setUiContainerHeight(this.maxDivHeight),this.pixelsToShave=this.modelHeight-this.uiContainerHeight,this.maxScrollY=this.uiContainerHeight-this.uiBodyHeight;const e=this.scrollY/this.maxScrollY,t=e*this.pixelsToShave;mc(this.gos,`RowContainerHeightService - Div Stretch Offset = ${t} (${this.pixelsToShave} * ${e})`),this.setDivStretchOffset(t)}setUiContainerHeight(e){e!==this.uiContainerHeight&&(this.uiContainerHeight=e,this.eventSvc.dispatchEvent({type:"rowContainerHeightChanged"}))}clearOffset(){this.setUiContainerHeight(this.modelHeight),this.pixelsToShave=0,this.setDivStretchOffset(0)}setDivStretchOffset(e){const t=typeof e=="number"?Math.floor(e):null;this.divStretchOffset!==t&&(this.divStretchOffset=t,this.eventSvc.dispatchEvent({type:"heightScaleChanged"}))}setModelHeight(e){this.modelHeight=e,this.stretching=e!=null&&this.maxDivHeight>0&&e>this.maxDivHeight,this.stretching?this.calculateOffset():this.clearOffset()}getRealPixelPosition(e){return e-this.divStretchOffset}getUiBodyHeight(){const e=this.beans.ctrlsSvc.getScrollFeature().getVScrollPosition();return e.bottom-e.top}getScrollPositionForPixel(e){if(this.pixelsToShave<=0)return e;const t=this.modelHeight-this.getUiBodyHeight(),r=e/t;return this.maxScrollY*r}},pj=400,gj=class extends et{constructor(){super(...arguments),this.beanName="rowRenderer",this.destroyFuncsForColumnListeners=[],this.rowCtrlsByRowIndex={},this.zombieRowCtrls={},this.allRowCtrls=[],this.topRowCtrls=[],this.bottomRowCtrls=[],this.refreshInProgress=!1,this.dataFirstRenderedFired=!1,this.setupRangeSelectionListeners=()=>{const e=()=>{for(const s of this.getAllCellCtrls())s.onCellSelectionChanged()},t=()=>{for(const s of this.getAllCellCtrls())s.updateRangeBordersIfRangeCount()},r=()=>{this.eventSvc.addListener("cellSelectionChanged",e),this.eventSvc.addListener("columnMoved",t),this.eventSvc.addListener("columnPinned",t),this.eventSvc.addListener("columnVisible",t)},n=()=>{this.eventSvc.removeListener("cellSelectionChanged",e),this.eventSvc.removeListener("columnMoved",t),this.eventSvc.removeListener("columnPinned",t),this.eventSvc.removeListener("columnVisible",t)};this.addDestroyFunc(()=>n()),this.addManagedPropertyListeners(["enableRangeSelection","cellSelection"],()=>{ll(this.gos)?r():n()}),ll(this.gos)&&r()}}wireBeans(e){this.pageBounds=e.pageBounds,this.colModel=e.colModel,this.pinnedRowModel=e.pinnedRowModel,this.rowModel=e.rowModel,this.focusSvc=e.focusSvc,this.rowContainerHeight=e.rowContainerHeight,this.ctrlsSvc=e.ctrlsSvc,this.editSvc=e.editSvc}postConstruct(){this.ctrlsSvc.whenReady(this,e=>{this.gridBodyCtrl=e.gridBodyCtrl,this.initialise()})}initialise(){this.addManagedEventListeners({paginationChanged:this.onPageLoaded.bind(this),pinnedRowDataChanged:this.onPinnedRowDataChanged.bind(this),pinnedRowsChanged:this.onPinnedRowsChanged.bind(this),displayedColumnsChanged:this.onDisplayedColumnsChanged.bind(this),bodyScroll:this.onBodyScroll.bind(this),bodyHeightChanged:this.redraw.bind(this,{})}),this.addManagedPropertyListeners(["domLayout","embedFullWidthRows"],()=>this.onDomLayoutChanged()),this.addManagedPropertyListeners(["suppressMaxRenderedRowRestriction","rowBuffer"],()=>this.redraw()),this.addManagedPropertyListener("suppressCellFocus",n=>this.onSuppressCellFocusChanged(n.currentValue)),this.addManagedPropertyListeners(["groupSuppressBlankHeader","getBusinessKeyForNode","fullWidthCellRenderer","fullWidthCellRendererParams","suppressStickyTotalRow","groupRowRenderer","groupRowRendererParams","loadingCellRenderer","loadingCellRendererParams","detailCellRenderer","detailCellRendererParams","enableRangeSelection","enableCellTextSelection"],()=>this.redrawRows()),this.addManagedPropertyListener("cellSelection",({currentValue:n,previousValue:i})=>{(!i&&n||i&&!n)&&this.redrawRows()});const{stickyRowSvc:e,gos:t,showRowGroupCols:r}=this.beans;if(r&&this.addManagedPropertyListener("showOpenedGroup",()=>{const n=r.columns;n.length&&this.refreshCells({columns:n,force:!0})}),e)this.stickyRowFeature=e.createStickyRowFeature(this,this.createRowCon.bind(this),this.destroyRowCtrls.bind(this));else{const n=this.gridBodyCtrl;n.setStickyTopHeight(0),n.setStickyBottomHeight(0)}this.registerCellEventListeners(),this.initialiseCache(),this.printLayout=ni(t,"print"),this.embedFullWidthRows=this.printLayout||t.get("embedFullWidthRows"),this.redrawAfterModelUpdate()}initialiseCache(){if(this.gos.get("keepDetailRows")){const e=this.getKeepDetailRowsCount(),t=e??3;this.cachedRowCtrls=new mj(t)}}getKeepDetailRowsCount(){return this.gos.get("keepDetailRowsCount")}getStickyTopRowCtrls(){return this.stickyRowFeature?.stickyTopRowCtrls??[]}getStickyBottomRowCtrls(){return this.stickyRowFeature?.stickyBottomRowCtrls??[]}updateAllRowCtrls(){const e=Object.values(this.rowCtrlsByRowIndex),t=Object.values(this.zombieRowCtrls),r=this.cachedRowCtrls?.getEntries()??[];t.length>0||r.length>0?this.allRowCtrls=[...e,...t,...r]:this.allRowCtrls=e}isCellBeingRendered(e,t){const r=this.rowCtrlsByRowIndex[e];return!t||!r?!!r:r.isFullWidth()?!0:!!this.beans.spannedRowRenderer?.getCellByPosition({rowIndex:e,column:t,rowPinned:null})||!!r.getCellCtrl(t)||!r.isRowRendered()}updateCellFocus(e){for(const t of this.getAllCellCtrls())t.onCellFocused(e);for(const t of this.getFullWidthRowCtrls())t.onFullWidthRowFocused(e)}onCellFocusChanged(e){if(e?.rowIndex!=null&&!e.rowPinned){const t=this.beans.colModel.getCol(e.column)??void 0;this.isCellBeingRendered(e.rowIndex,t)||this.redraw()}this.updateCellFocus(e)}onSuppressCellFocusChanged(e){for(const t of this.getAllCellCtrls())t.onSuppressCellFocusChanged(e);for(const t of this.getFullWidthRowCtrls())t.onSuppressCellFocusChanged(e)}registerCellEventListeners(){this.addManagedEventListeners({cellFocused:e=>this.onCellFocusChanged(e),cellFocusCleared:()=>this.updateCellFocus(),flashCells:e=>{const{cellFlashSvc:t}=this.beans;if(t)for(const r of this.getAllCellCtrls())t.onFlashCells(r,e)},columnHoverChanged:()=>{for(const e of this.getAllCellCtrls())e.onColumnHover()},displayedColumnsChanged:()=>{for(const e of this.getAllCellCtrls())e.onDisplayedColumnsChanged()},displayedColumnsWidthChanged:()=>{if(this.printLayout)for(const e of this.getAllCellCtrls())e.onLeftChanged()}}),this.setupRangeSelectionListeners(),this.refreshListenersToColumnsForCellComps(),this.addManagedEventListeners({gridColumnsChanged:this.refreshListenersToColumnsForCellComps.bind(this)}),this.addDestroyFunc(this.removeGridColumnListeners.bind(this))}removeGridColumnListeners(){for(const e of this.destroyFuncsForColumnListeners)e();this.destroyFuncsForColumnListeners.length=0}refreshListenersToColumnsForCellComps(){this.removeGridColumnListeners();const e=this.colModel.getCols();for(const t of e){const r=l=>{for(const c of this.getAllCellCtrls())c.column===t&&l(c)},n=()=>{r(l=>l.onLeftChanged())},i=()=>{r(l=>l.onWidthChanged())},s=()=>{r(l=>l.onFirstRightPinnedChanged())},o=()=>{r(l=>l.onLastLeftPinnedChanged())},a=()=>{r(l=>l.onColDefChanged())};t.__addEventListener("leftChanged",n),t.__addEventListener("widthChanged",i),t.__addEventListener("firstRightPinnedChanged",s),t.__addEventListener("lastLeftPinnedChanged",o),t.__addEventListener("colDefChanged",a),this.destroyFuncsForColumnListeners.push(()=>{t.__removeEventListener("leftChanged",n),t.__removeEventListener("widthChanged",i),t.__removeEventListener("firstRightPinnedChanged",s),t.__removeEventListener("lastLeftPinnedChanged",o),t.__removeEventListener("colDefChanged",a)})}}onDomLayoutChanged(){const e=ni(this.gos,"print"),t=e||this.gos.get("embedFullWidthRows"),r=t!==this.embedFullWidthRows||this.printLayout!==e;this.printLayout=e,this.embedFullWidthRows=t,r&&this.redrawAfterModelUpdate({domLayoutChanged:!0})}datasourceChanged(){this.firstRenderedRow=0,this.lastRenderedRow=-1;const e=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(e)}onPageLoaded(e){const t={recycleRows:e.keepRenderedRows,animate:e.animate,newData:e.newData,newPage:e.newPage,onlyBody:!0};this.redrawAfterModelUpdate(t)}getAllCellsNotSpanningForColumn(e){const t=[];for(const r of this.getAllRowCtrls()){const n=r.getCellCtrl(e,!0)?.eGui;n&&t.push(n)}return t}refreshFloatingRowComps(e=!0){this.refreshFloatingRows(this.topRowCtrls,"top",e),this.refreshFloatingRows(this.bottomRowCtrls,"bottom",e)}refreshFloatingRows(e,t,r){const{pinnedRowModel:n,beans:i,printLayout:s}=this,o=Object.fromEntries(e.map(l=>[l.rowNode.id,l]));n?.forEachPinnedRow(t,(l,c)=>{const u=e[c];u&&n.getPinnedRowById(u.rowNode.id,t)===void 0&&(u.destroyFirstPass(),u.destroySecondPass()),l.id in o&&r?(e[c]=o[l.id],delete o[l.id]):e[c]=new F0(l,i,!1,!1,s)});const a=(t==="top"?n?.getPinnedTopRowCount():n?.getPinnedBottomRowCount())??0;e.length=a}onPinnedRowDataChanged(){const e={recycleRows:!0};this.redrawAfterModelUpdate(e)}onPinnedRowsChanged(){this.redrawAfterModelUpdate({recycleRows:!0})}redrawRow(e,t=!1){if(e.sticky)this.stickyRowFeature?.refreshStickyNode(e);else if(this.cachedRowCtrls?.has(e)){this.cachedRowCtrls.removeRow(e);return}else{const r=n=>{const i=n[e.rowIndex];i&&i.rowNode===e&&(i.destroyFirstPass(),i.destroySecondPass(),n[e.rowIndex]=this.createRowCon(e,!1,!1))};switch(e.rowPinned){case"top":r(this.topRowCtrls);break;case"bottom":r(this.bottomRowCtrls);break;default:r(this.rowCtrlsByRowIndex),this.updateAllRowCtrls()}}t||this.dispatchDisplayedRowsChanged(!1)}redrawRows(e){const{editSvc:t}=this.beans;if(t?.isEditing()&&(t.isBatchEditing()?t.cleanupEditors():t.stopEditing(void 0,{source:"api"})),e!=null){for(const n of e??[])this.redrawRow(n,!0);this.dispatchDisplayedRowsChanged(!1);return}this.redrawAfterModelUpdate()}redrawAfterModelUpdate(e={}){this.getLockOnRefresh();const t=this.beans.focusSvc?.getFocusCellToUseAfterRefresh();this.updateContainerHeights(),this.scrollToTopIfNewData(e);const r=!e.domLayoutChanged&&!!e.recycleRows,n=e.animate&&Uu(this.gos),i=r?this.getRowsToRecycle():null;r||this.removeAllRowComps(),this.workOutFirstAndLastRowsToRender();const{stickyRowFeature:s,gos:o}=this;if(s){s.checkStickyRows();const a=s.extraTopHeight+s.extraBottomHeight;a&&this.updateContainerHeights(a)}this.recycleRows(i,n),this.gridBodyCtrl.updateRowCount(),e.onlyBody||this.refreshFloatingRowComps(o.get("enableRowPinning")?r:void 0),this.dispatchDisplayedRowsChanged(),t!=null&&this.restoreFocusedCell(t),this.releaseLockOnRefresh()}scrollToTopIfNewData(e){const t=e.newData||e.newPage,r=this.gos.get("suppressScrollOnNewData");t&&!r&&(this.gridBodyCtrl.scrollFeature.scrollToTop(),this.stickyRowFeature?.resetOffsets())}updateContainerHeights(e=0){const{rowContainerHeight:t}=this;if(this.printLayout){t.setModelHeight(null);return}let r=this.pageBounds.getCurrentPageHeight();r===0&&(r=1),t.setModelHeight(r+e)}getLockOnRefresh(){if(this.refreshInProgress)throw new Error(_o(252));this.refreshInProgress=!0,this.beans.frameworkOverrides.getLockOnRefresh?.()}releaseLockOnRefresh(){this.refreshInProgress=!1,this.beans.frameworkOverrides.releaseLockOnRefresh?.()}isRefreshInProgress(){return this.refreshInProgress}restoreFocusedCell(e){if(!e)return;const t=this.beans.focusSvc,r=this.findPositionToFocus(e);if(!r){t.focusHeaderPosition({headerPosition:{headerRowIndex:yo(this.beans)-1,column:e.column}});return}if(e.rowIndex!==r.rowIndex||e.rowPinned!=r.rowPinned){t.setFocusedCell({...r,preventScrollOnBrowserFocus:!0,forceBrowserFocus:!0});return}t.doesRowOrCellHaveBrowserFocus()||this.updateCellFocus(Dt(this.gos,{...r,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0,type:"cellFocused"}))}findPositionToFocus(e){const{pagination:t,pageBounds:r}=this.beans;let n=e;for(n.rowPinned==null&&t&&r&&!t.isRowInPage(n.rowIndex)&&(n={rowPinned:null,rowIndex:r.getFirstRow()});n;){if(n.rowPinned==null&&r)if(n.rowIndex<r.getFirstRow()){if(n=k0(this.beans,{rowPinned:null,rowIndex:0}),!n)return null}else n.rowIndex>r.getLastRow()&&(n={rowPinned:null,rowIndex:r.getLastRow()});const i=this.getRowByPosition(n);if(i?.isAlive())return{...i.getRowPosition(),column:e.column};n=k0(this.beans,n)}return null}getAllCellCtrls(){const e=[],t=this.getAllRowCtrls(),r=t.length;for(let n=0;n<r;n++){const i=t[n].getAllCellCtrls(),s=i.length;for(let o=0;o<s;o++)e.push(i[o])}return e}getAllRowCtrls(){const{spannedRowRenderer:e}=this.beans,t=this.getStickyTopRowCtrls(),r=this.getStickyBottomRowCtrls();return[...this.topRowCtrls,...this.bottomRowCtrls,...t,...r,...e?.getCtrls("top")??[],...e?.getCtrls("bottom")??[],...e?.getCtrls("center")??[],...Object.values(this.rowCtrlsByRowIndex)]}addRenderedRowListener(e,t,r){const n=this.rowCtrlsByRowIndex[t];n&&n.addEventListener(e,r)}refreshCells({rowNodes:e,columns:t,force:r,suppressFlash:n}={}){const i={force:r,newData:!1,suppressFlash:n};for(const s of this.getCellCtrls(e,t))s.refreshOrDestroyCell(i);this.refreshFullWidth(e)}refreshRows(e={}){for(const t of this.getRowCtrls(e.rowNodes))t.refreshRow(e);this.refreshFullWidth(e.rowNodes)}refreshFullWidth(e){if(!e)return;let t=!1;for(const r of this.getRowCtrls(e)){if(!r.isFullWidth())continue;r.refreshFullWidth()||(t=!0,this.redrawRow(r.rowNode,!0))}t&&this.dispatchDisplayedRowsChanged(!1)}getRowCtrls(e){const t=xw(e),r=this.getAllRowCtrls();return!e||!t?r:r.filter(n=>{const i=n.rowNode;return Sw(i,t)})}getCellCtrls(e,t){let r;bt(t)&&(r={},t.forEach(i=>{const s=this.colModel.getCol(i);bt(s)&&(r[s.getId()]=!0)}));const n=[];for(const i of this.getRowCtrls(e))for(const s of i.getAllCellCtrls()){const o=s.column.getId();r&&!r[o]||n.push(s)}return n}destroy(){this.removeAllRowComps(!0),super.destroy()}removeAllRowComps(e=!1){const t=Object.keys(this.rowCtrlsByRowIndex);this.removeRowCtrls(t,e),this.stickyRowFeature?.destroyStickyCtrls()}getRowsToRecycle(){const e=[];for(const r of Object.keys(this.rowCtrlsByRowIndex))this.rowCtrlsByRowIndex[r].rowNode.id==null&&e.push(r);this.removeRowCtrls(e);const t={};for(const r of Object.values(this.rowCtrlsByRowIndex)){const n=r.rowNode;t[n.id]=r}return this.rowCtrlsByRowIndex={},t}removeRowCtrls(e,t=!1){for(const r of e){const n=this.rowCtrlsByRowIndex[r];n&&(n.destroyFirstPass(t),n.destroySecondPass()),delete this.rowCtrlsByRowIndex[r]}}onBodyScroll(e){e.direction==="vertical"&&this.redraw({afterScroll:!0})}redraw(e={}){const{focusSvc:t,animationFrameSvc:r}=this.beans,{afterScroll:n}=e;let i;const s=this.stickyRowFeature;s&&(i=t?.getFocusCellToUseAfterRefresh()||void 0);const o=this.firstRenderedRow,a=this.lastRenderedRow;this.workOutFirstAndLastRowsToRender();let l=!1;if(s){l=s.checkStickyRows();const u=s.extraTopHeight+s.extraBottomHeight;u&&this.updateContainerHeights(u)}const c=this.firstRenderedRow!==o||this.lastRenderedRow!==a;if(!(n&&!l&&!c)&&(this.getLockOnRefresh(),this.recycleRows(null,!1,n),this.releaseLockOnRefresh(),this.dispatchDisplayedRowsChanged(n&&!l),i!=null)){const u=t?.getFocusCellToUseAfterRefresh();i!=null&&u==null&&(r?.flushAllFrames(),this.restoreFocusedCell(i))}}removeRowCompsNotToDraw(e,t){const r={};for(const s of e)r[s]=!0;const i=Object.keys(this.rowCtrlsByRowIndex).filter(s=>!r[s]);this.removeRowCtrls(i,t)}calculateIndexesToDraw(e){const t=[];for(let o=this.firstRenderedRow;o<=this.lastRenderedRow;o++)t.push(o);const r=this.beans.pagination,n=this.beans.focusSvc?.getFocusedCell()?.rowIndex;n!=null&&(n<this.firstRenderedRow||n>this.lastRenderedRow)&&(!r||r.isRowInPage(n))&&n<this.rowModel.getRowCount()&&t.push(n);const i=o=>{const a=o.rowNode.rowIndex;a==null||a===n||(a<this.firstRenderedRow||a>this.lastRenderedRow)&&this.doNotUnVirtualiseRow(o)&&t.push(a)};for(const o of Object.values(this.rowCtrlsByRowIndex))i(o);if(e)for(const o of Object.values(e))i(o);t.sort((o,a)=>o-a);const s=[];for(let o=0;o<t.length;o++){const a=t[o],l=this.rowModel.getRow(a);l&&!l.sticky&&s.push(a)}return s}recycleRows(e,t=!1,r=!1){const n=this.calculateIndexesToDraw(e);(this.printLayout||r)&&(t=!1),this.removeRowCompsNotToDraw(n,!t);for(const i of n)this.createOrUpdateRowCtrl(i,e,t,r);if(e){const{animationFrameSvc:i}=this.beans;i?.active&&r&&!this.printLayout?i.addDestroyTask(()=>{this.destroyRowCtrls(e,t),this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged()}):this.destroyRowCtrls(e,t)}this.updateAllRowCtrls()}dispatchDisplayedRowsChanged(e=!1){this.eventSvc.dispatchEvent({type:"displayedRowsChanged",afterScroll:e})}onDisplayedColumnsChanged(){const{visibleCols:e}=this.beans,t=e.isPinningLeft(),r=e.isPinningRight();(this.pinningLeft!==t||r!==this.pinningRight)&&(this.pinningLeft=t,this.pinningRight=r,this.embedFullWidthRows&&this.redrawFullWidthEmbeddedRows())}redrawFullWidthEmbeddedRows(){const e=[];for(const t of this.getFullWidthRowCtrls()){const r=t.rowNode.rowIndex;e.push(r.toString())}this.refreshFloatingRowComps(),this.removeRowCtrls(e),this.redraw({afterScroll:!0})}getFullWidthRowCtrls(e){const t=xw(e);return this.getAllRowCtrls().filter(r=>{if(!r.isFullWidth())return!1;const n=r.rowNode;return!(t!=null&&!Sw(n,t))})}createOrUpdateRowCtrl(e,t,r,n){let i,s=this.rowCtrlsByRowIndex[e];if(s||(i=this.rowModel.getRow(e),bt(i)&&bt(t)&&t[i.id]&&i.alreadyRendered&&(s=t[i.id],t[i.id]=null)),!s)if(i||(i=this.rowModel.getRow(e)),bt(i))s=this.createRowCon(i,r,n);else return;i&&(i.alreadyRendered=!0),this.rowCtrlsByRowIndex[e]=s}destroyRowCtrls(e,t){const r=[];if(e){for(const n of Object.values(e))if(n){if(this.cachedRowCtrls&&n.isCacheable()){this.cachedRowCtrls.addRow(n);continue}if(n.destroyFirstPass(!t),t){const i=n.instanceId;this.zombieRowCtrls[i]=n,r.push(()=>{n.destroySecondPass(),delete this.zombieRowCtrls[i]})}else n.destroySecondPass()}}t&&(r.push(()=>{this.isAlive()&&(this.updateAllRowCtrls(),this.dispatchDisplayedRowsChanged())}),window.setTimeout(()=>{for(const n of r)n()},pj))}getRowBuffer(){return this.gos.get("rowBuffer")}getRowBufferInPixels(){const e=this.getRowBuffer(),t=oc(this.beans);return e*t}workOutFirstAndLastRowsToRender(){const{rowContainerHeight:e,pageBounds:t,rowModel:r}=this;e.updateOffset();let n,i;if(!r.isRowsToRender())n=0,i=-1;else if(this.printLayout)this.beans.environment.refreshRowHeightVariable(),n=t.getFirstRow(),i=t.getLastRow();else{const u=this.getRowBufferInPixels(),h=this.ctrlsSvc.getScrollFeature(),d=this.gos.get("suppressRowVirtualisation");let f=!1,m,v;do{const k=t.getPixelOffset(),{pageFirstPixel:F,pageLastPixel:I}=t.getCurrentPagePixelRange(),N=e.divStretchOffset,j=h.getVScrollPosition(),L=j.top,W=j.bottom;d?(m=F+N,v=I+N):(m=Math.max(L+k-u,F)+N,v=Math.min(W+k+u,I)+N),this.firstVisibleVPixel=Math.max(L+k,F)+N,this.lastVisibleVPixel=Math.min(W+k,I)+N,f=this.ensureAllRowsInRangeHaveHeightsCalculated(m,v)}while(f);let g=r.getRowIndexAtPixel(m),w=r.getRowIndexAtPixel(v);const y=t.getFirstRow(),C=t.getLastRow();g<y&&(g=y),w>C&&(w=C),n=g,i=w}const s=ni(this.gos,"normal"),o=this.gos.get("suppressMaxRenderedRowRestriction"),a=Math.max(this.getRowBuffer(),500);s&&!o&&i-n>a&&(i=n+a);const l=n!==this.firstRenderedRow,c=i!==this.lastRenderedRow;(l||c)&&(this.firstRenderedRow=n,this.lastRenderedRow=i,this.eventSvc.dispatchEvent({type:"viewportChanged",firstRow:n,lastRow:i}))}dispatchFirstDataRenderedEvent(){this.dataFirstRenderedFired||(this.dataFirstRenderedFired=!0,fa(this.beans,()=>{this.beans.eventSvc.dispatchEvent({type:"firstDataRendered",firstRow:this.firstRenderedRow,lastRow:this.lastRenderedRow})}))}ensureAllRowsInRangeHaveHeightsCalculated(e,t){const r=this.pinnedRowModel?.ensureRowHeightsValid(),n=this.stickyRowFeature?.ensureRowHeightsValid(),{pageBounds:i,rowModel:s}=this,o=s.ensureRowHeightsValid(e,t,i.getFirstRow(),i.getLastRow());return(o||n)&&this.eventSvc.dispatchEvent({type:"recalculateRowBounds"}),n||o||r?(this.updateContainerHeights(),!0):!1}doNotUnVirtualiseRow(e){const n=e.rowNode,i=this.focusSvc.isRowFocused(n.rowIndex,n.rowPinned),s=this.editSvc?.isEditing(e),o=n.detail;return i||s||o?!!this.isRowPresent(n):!1}isRowPresent(e){return this.rowModel.isRowPresent(e)?this.beans.pagination?.isRowInPage(e.rowIndex)??!0:!1}createRowCon(e,t,r){const n=this.cachedRowCtrls?.getRow(e)??null;if(n)return n;const i=r&&!this.printLayout&&!!this.beans.animationFrameSvc?.active;return new F0(e,this.beans,t,i,this.printLayout)}getRenderedNodes(){const e=Object.values(this.rowCtrlsByRowIndex).map(n=>n.rowNode),t=this.getStickyTopRowCtrls().map(n=>n.rowNode),r=this.getStickyBottomRowCtrls().map(n=>n.rowNode);return[...t,...e,...r]}getRowByPosition(e){let t;const{rowIndex:r}=e;switch(e.rowPinned){case"top":t=this.topRowCtrls[r];break;case"bottom":t=this.bottomRowCtrls[r];break;default:t=this.rowCtrlsByRowIndex[r],t||(t=this.getStickyTopRowCtrls().find(n=>n.rowNode.rowIndex===r)||null,t||(t=this.getStickyBottomRowCtrls().find(n=>n.rowNode.rowIndex===r)||null));break}return t}isRangeInRenderedViewport(e,t){if(e==null||t==null)return!1;const n=e>this.lastRenderedRow;return!(t<this.firstRenderedRow)&&!n}},mj=class{constructor(e){this.entriesMap={},this.entriesList=[],this.maxCount=e}addRow(e){if(this.entriesMap[e.rowNode.id]=e,this.entriesList.push(e),e.setCached(!0),this.entriesList.length>this.maxCount){const t=this.entriesList[0];t.destroyFirstPass(),t.destroySecondPass(),this.removeFromCache(t)}}getRow(e){if(e?.id==null)return null;const t=this.entriesMap[e.id];return t?(this.removeFromCache(t),t.setCached(!1),t.rowNode!=e?null:t):null}has(e){return this.entriesMap[e.id]!=null}removeRow(e){const t=e.id,r=this.entriesMap[t];delete this.entriesMap[t],Eo(this.entriesList,r)}removeFromCache(e){const t=e.rowNode.id;delete this.entriesMap[t],Eo(this.entriesList,e)}getEntries(){return this.entriesList}};function xw(e){if(!e)return;const t={top:{},bottom:{},normal:{}};for(const r of e){const n=r.id;switch(r.rowPinned){case"top":t.top[n]=r;break;case"bottom":t.bottom[n]=r;break;default:t.normal[n]=r;break}}return t}function Sw(e,t){const r=e.id;switch(e.rowPinned){case"top":return t.top[r]!=null;case"bottom":return t.bottom[r]!=null;default:return t.normal[r]!=null}}var vj=class extends et{constructor(){super(...arguments),this.beanName="rowNodeSorter",this.accentedSort=!1,this.primaryColumnsSortGroups=!1,this.pivotActive=!1}postConstruct(){this.firstLeaf=rn(this.gos)?R0:bj,this.addManagedPropertyListeners(["accentedSort","autoGroupColumnDef","treeData"],this.updateOptions.bind(this));const e=this.updatePivotModeState.bind(this);this.addManagedEventListeners({columnPivotModeChanged:e,columnPivotChanged:e}),this.updateOptions(),e()}updateOptions(){this.accentedSort=!!this.gos.get("accentedSort"),this.primaryColumnsSortGroups=Zo(this.gos)}updatePivotModeState(){this.pivotActive=this.beans.colModel.isPivotActive()}doFullSortInPlace(e,t){return e.sort((r,n)=>this.compareRowNodes(t,r,n))}compareRowNodes(e,t,r){if(t===r)return 0;const n=this.accentedSort;for(let i=0,s=e.length;i<s;++i){const o=e[i],a=o.sort==="desc";let l=this.getValue(t,o.column),c=this.getValue(r,o.column),u;const h=this.getComparator(o,t);if(h?u=h(l,c,t,r,a):(o.type==="absolute"&&(l=U4(l),c=U4(c)),u=AM(l,c,n)),u)return o.sort==="asc"?u:-u}return 0}getComparator(e,t){const r=e.column.getColDef(),n=this.getComparatorFromColDef(r,e);if(n)return n;if(!r.showRowGroup)return;const i=!t.group&&r.field;if(!i)return;const s=this.beans.colModel.getColDefCol(i);if(s)return this.getComparatorFromColDef(s.getColDef(),e)}getComparatorFromColDef(e,t){const r=e.comparator;if(r!=null)return typeof r=="object"?r[la(t.type)]:r}getValue(e,t){const r=this.beans;if(this.primaryColumnsSortGroups){if(e.rowGroupColumn===t)return this.getGroupDataValue(e,t);if(e.group&&t.getColDef().showRowGroup)return}const n=r.valueSvc.getValue(t,e,!1,"api");if(t.isAllowFormula()){const i=r.formula;if(i?.isFormula(n))return i.resolveValue(t,e)}return n}getGroupDataValue(e,t){if(ZT(this.gos,this.pivotActive)){const n=this.firstLeaf(e);return n&&this.beans.valueSvc.getValue(t,n,!1,"api")}const r=this.beans.showRowGroupCols?.getShowRowGroupCol(t.getId());return r?e.groupData?.[r.getId()]:void 0}},bj=e=>{if(e.data)return e;let t=e.childrenAfterGroup;for(;t?.length;){const r=t[0];if(r.data)return r;t=r.childrenAfterGroup}},U4=e=>{if(!e)return e;const t=Number(e);return isNaN(t)?e:Math.abs(t)};function wj(e){e.sortSvc?.onSortChanged("api")}var zl=(e,t)=>({tag:"span",ref:`eSort${e}`,cls:`ag-sort-indicator-icon ag-sort-${t} ag-hidden`,attrs:{"aria-hidden":"true"}}),yj={tag:"span",cls:"ag-sort-indicator-container",children:[zl("Order","order"),zl("Asc","ascending-icon"),zl("Desc","descending-icon"),zl("Mixed","mixed-icon"),zl("AbsoluteAsc","absolute-ascending-icon"),zl("AbsoluteDesc","absolute-descending-icon"),zl("None","none-icon")]},Gy=class extends pn{constructor(e){super(),this.eSortOrder=xt,this.eSortAsc=xt,this.eSortDesc=xt,this.eSortMixed=xt,this.eSortNone=xt,this.eSortAbsoluteAsc=xt,this.eSortAbsoluteDesc=xt,e||this.setTemplate(yj)}attachCustomElements(e,t,r,n,i,s,o){this.eSortOrder=e,this.eSortAsc=t,this.eSortDesc=r,this.eSortMixed=n,this.eSortNone=i,this.eSortAbsoluteAsc=s,this.eSortAbsoluteDesc=o}setupSort(e,t=!1){if(this.column=e,this.suppressOrder=t,this.setupMultiSortIndicator(),!e.isSortable()&&!e.getColDef().showRowGroup)return;this.addInIcon("sortAscending",this.eSortAsc,e),this.addInIcon("sortDescending",this.eSortDesc,e),this.addInIcon("sortUnSort",this.eSortNone,e),this.addInIcon("sortAbsoluteAscending",this.eSortAbsoluteAsc,e),this.addInIcon("sortAbsoluteDescending",this.eSortAbsoluteDesc,e);const r=this.updateIcons.bind(this),n=this.onSortChanged.bind(this);this.addManagedPropertyListener("unSortIcon",r),this.addManagedEventListeners({newColumnsLoaded:r,sortChanged:n,columnRowGroupChanged:n}),this.onSortChanged()}addInIcon(e,t,r){if(t==null)return;const n=Li(e,this.beans,r);n&&t.appendChild(n)}onSortChanged(){this.updateIcons(),this.suppressOrder||this.updateSortOrder()}updateIcons(){const{eSortAsc:e,eSortDesc:t,eSortAbsoluteAsc:r,eSortAbsoluteDesc:n,eSortNone:i,column:s,gos:o,beans:a}=this,l=a.sortSvc.getDisplaySortForColumn(s),c=la(l?.type),u=nm(l?.direction),h=s.getAvailableSortTypes(),d=h.has("default"),f=h.has("absolute"),m=c==="absolute",v=c==="default",g=u==="asc",w=u==="desc";if(e&&Gr(e,g&&v&&d,{skipAriaHidden:!0}),t&&Gr(t,w&&v&&d,{skipAriaHidden:!0}),i){const y=!s.getColDef().unSortIcon&&!o.get("unSortIcon");Gr(i,!y&&!u,{skipAriaHidden:!0})}r&&Gr(r,g&&m&&f,{skipAriaHidden:!0}),n&&Gr(n,w&&m&&f,{skipAriaHidden:!0})}setupMultiSortIndicator(){const{eSortMixed:e,column:t,gos:r}=this;this.addInIcon("sortUnSort",e,t);const n=t.getColDef().showRowGroup;Zo(r)&&n&&(this.addManagedEventListeners({sortChanged:this.updateMultiSortIndicator.bind(this),columnRowGroupChanged:this.updateMultiSortIndicator.bind(this)}),this.updateMultiSortIndicator())}updateMultiSortIndicator(){const{eSortMixed:e,beans:t,column:r}=this;if(e){const n=t.sortSvc.getDisplaySortForColumn(r)?.direction==="mixed";Gr(e,n,{skipAriaHidden:!0})}}updateSortOrder(){const{eSortOrder:e,column:t,beans:{sortSvc:r}}=this;if(!e)return;const n=r.getColumnsWithSortingOrdered(),i=r.getDisplaySortIndexForColumn(t)??-1,s=n.some(a=>r.getDisplaySortIndexForColumn(a)??!1),o=i>=0&&s;Gr(e,o,{skipAriaHidden:!0}),i>=0?e.textContent=(i+1).toString():Hi(e)}},Cj={selector:"AG-SORT-INDICATOR",component:Gy},xj=class extends et{constructor(){super(...arguments),this.beanName="sortSvc"}progressSort(e,t,r){const n=this.getNextSortDirection(e);this.setSortForColumn(e,n,t,r)}progressSortFromEvent(e,t){const n=this.gos.get("multiSortKey")==="ctrl"?t.ctrlKey||t.metaKey:t.shiftKey;this.progressSort(e,n,"uiColumnSorted")}setSortForColumn(e,t,r,n){const{gos:i,showRowGroupCols:s}=this.beans,o=Zo(i);let a=[e];if(o&&e.getColDef().showRowGroup){const h=s?.getSourceColumnsForGroupColumn?.(e)?.filter(d=>d.isSortable());h&&(a=[e,...h])}for(const u of a)this.setColSort(u,t,n);const l=(r||i.get("alwaysMultiSort"))&&!i.get("suppressMultiSort"),c=[];if(!l){const u=this.clearSortBarTheseColumns(a,n);c.push(...u)}this.updateSortIndex(e),c.push(...a),this.dispatchSortChangedEvents(n,c)}updateSortIndex(e){const{gos:t,colModel:r,showRowGroupCols:n}=this.beans,i=Zo(t),s=n?.getShowRowGroupCol(e.getId()),o=i&&s||e,a=this.getColumnsWithSortingOrdered();r.forAllCols(u=>this.setColSortIndex(u,null));const l=a.filter(u=>i&&u.getColDef().showRowGroup?!1:u!==o);(o.getSortDef()?[...l,o]:l).forEach((u,h)=>this.setColSortIndex(u,h))}onSortChanged(e,t){this.dispatchSortChangedEvents(e,t)}isSortActive(){let e=!1;return this.beans.colModel.forAllCols(t=>{if(t.getSortDef())return e=!0,!0}),e}dispatchSortChangedEvents(e,t){const r={type:"sortChanged",source:e};t&&(r.columns=t),this.eventSvc.dispatchEvent(r)}clearSortBarTheseColumns(e,t){const r=[];return this.beans.colModel.forAllCols(n=>{e.includes(n)||(n.getSortDef()&&r.push(n),this.setColSort(n,void 0,t))}),r}getNextSortDirection(e){const t=e.getSortingOrder(),r=e.getSortDef();let i=t.findIndex(s=>Zg(s,r))+1;return i>=t.length&&(i=0),Gs(t[i])}getIndexedSortMap(){const{gos:e,colModel:t,showRowGroupCols:r,rowGroupColsSvc:n}=this.beans;let i=[];if(t.forAllCols(c=>{c.getSortDef()&&i.push(c)}),t.isPivotMode()){const c=Zo(e);i=i.filter(u=>{const h=!!u.getAggFunc(),d=!u.isPrimary(),f=c?r?.getShowRowGroupCol(u.getId()):u.getColDef().showRowGroup;return h||d||f})}const s=n?.columns.filter(c=>!!c.getSortDef())??[],o={};i.forEach((c,u)=>o[c.getId()]=u),i.sort((c,u)=>{const h=c.getSortIndex(),d=u.getSortIndex();if(h!=null&&d!=null)return h-d;if(h==null&&d==null){const f=o[c.getId()],m=o[u.getId()];return f>m?1:-1}else return d==null?-1:1});const a=Zo(e)&&!!s.length;a&&(i=[...new Set(i.map(c=>r?.getShowRowGroupCol(c.getId())??c))]);const l=new Map;if(i.forEach((c,u)=>l.set(c,u)),a)for(const c of s){const u=r.getShowRowGroupCol(c.getId());l.set(c,l.get(u))}return l}getColumnsWithSortingOrdered(){return[...this.getIndexedSortMap().entries()].sort(([,e],[,t])=>e-t).map(([e])=>e)}collectSortItems(e=!1){const t=[],r=this.getColumnsWithSortingOrdered();for(const n of r){const i=n.getSortDef()?.direction;if(!i)continue;const s=la(n.getSortDef()?.type),o={sort:i,type:s};e?o.colId=n.getId():o.column=n,t.push(o)}return t}getSortModel(){return this.collectSortItems(!0)}getSortOptions(){return this.collectSortItems()}canColumnDisplayMixedSort(e){const t=Zo(this.gos),r=!!e.getColDef().showRowGroup;return t&&r}getDisplaySortForColumn(e){const t=this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(e);if(!this.canColumnDisplayMixedSort(e)||!t?.length)return e.getSortDef();const n=e.getColDef().field!=null||!!e.getColDef().valueGetter?[e,...t]:t,i=n[0].getSortDef();return n.every(o=>Zg(o.getSortDef(),i))?i:{type:la(e.getSortDef()?.type),direction:"mixed"}}getDisplaySortIndexForColumn(e){return this.getIndexedSortMap().get(e)}setupHeader(e,t){const r=()=>{const{type:n,direction:i}=Gs(t.getSortDef());if(e.toggleCss("ag-header-cell-sorted-asc",i==="asc"),e.toggleCss("ag-header-cell-sorted-desc",i==="desc"),e.toggleCss("ag-header-cell-sorted-abs-asc",n==="absolute"&&i==="asc"),e.toggleCss("ag-header-cell-sorted-abs-desc",n==="absolute"&&i==="desc"),e.toggleCss("ag-header-cell-sorted-none",!i),t.getColDef().showRowGroup){const a=!this.beans.showRowGroupCols?.getSourceColumnsForGroupColumn(t)?.every(l=>i==l.getSortDef()?.direction);e.toggleCss("ag-header-cell-sorted-mixed",a)}};e.addManagedEventListeners({sortChanged:r,columnRowGroupChanged:r})}initCol(e){const{sortIndex:t,initialSortIndex:r}=e.colDef,n=sk(e.colDef);n&&e.setSortDef(n,!0),t!==void 0?t!==null&&(e.sortIndex=t):r!==null&&(e.sortIndex=r)}updateColSort(e,t,r){t!==void 0&&this.setColSort(e,Gs(t),r)}setColSort(e,t,r){Zg(e.getSortDef(),t)||(e.setSortDef(Gs(t),t===void 0),e.dispatchColEvent("sortChanged",r)),e.dispatchStateUpdatedEvent("sort")}setColSortIndex(e,t){e.sortIndex=t,e.dispatchStateUpdatedEvent("sortIndex")}createSortIndicator(e){return new Gy(e)}getSortIndicatorSelector(){return Cj}},IR={moduleName:"Sort",version:wt,beans:[xj,vj],apiFunctions:{onSortChanged:wj},userComponents:{agSortIndicator:Gy},icons:{sortAscending:"asc",sortDescending:"desc",sortUnSort:"none",sortAbsoluteAscending:"aasc",sortAbsoluteDescending:"adesc"}},Sj=class extends et{constructor(){super(...arguments),this.beanName="syncSvc",this.waitingForColumns=!1}postConstruct(){this.addManagedPropertyListener("columnDefs",e=>this.setColumnDefs(e))}start(){this.beans.ctrlsSvc.whenReady(this,()=>{const e=this.gos.get("columnDefs");e?this.setColumnsAndData(e):this.waitingForColumns=!0,this.gridReady()})}setColumnsAndData(e){const{colModel:t,rowModel:r}=this.beans;t.setColumnDefs(e??[],"gridInitializing"),r.start()}gridReady(){const{eventSvc:e,gos:t}=this;e.dispatchEvent({type:"gridReady"}),mc(t,`initialised successfully, enterprise = ${t.isModuleRegistered("EnterpriseCore")}`)}setColumnDefs(e){const t=this.gos.get("columnDefs");if(t){if(this.waitingForColumns){this.waitingForColumns=!1,this.setColumnsAndData(t);return}this.beans.colModel.setColumnDefs(t,Ku(e.source))}}};function _j(e){e.valueCache?.expire()}function Ej(e,t){const{colKey:r,rowNode:n,useFormatter:i}=t,s=e.colModel.getColDefCol(r)??e.colModel.getCol(r);if(Yr(s))return null;const o=e.valueSvc.getValueForDisplay({column:s,node:n,includeValueFormatted:i});return i?o.valueFormatted??yd(o.value):o.value}var Tj="paste",kj=class extends et{constructor(){super(...arguments),this.beanName="changeDetectionSvc",this.clientSideRowModel=null}postConstruct(){const{gos:e,rowModel:t}=this.beans;rn(e)&&(this.clientSideRowModel=t),this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this)})}onCellValueChanged(e){const{gos:t,rowRenderer:r}=this.beans;if(e.source===Tj||t.get("suppressChangeDetection"))return;const n=e.node,i=[n],s=this.clientSideRowModel,o=s?.rootNode;if(o&&!n.isRowPinned()){const a=t.get("aggregateOnlyChangedColumns"),l=new mf(a,o);l.addParentNode(n.parent,[e.column]),s.doAggregate(l),l.forEachChangedNodeDepthFirst(c=>{i.push(c),c.sibling&&i.push(c.sibling)})}r.refreshCells({rowNodes:i})}},Rj=class extends et{constructor(){super(...arguments),this.beanName="expressionSvc",this.cache={}}evaluate(e,t){if(typeof e=="string")return this.evaluateExpression(e,t);Ar(15,{expression:e})}evaluateExpression(e,t){try{return this.createExpressionFunction(e)(t.value,t.context,t.oldValue,t.newValue,t.value,t.node,t.data,t.colDef,t.rowIndex,t.api,t.getValue,t.column,t.columnGroup)}catch(r){return Ar(16,{expression:e,params:t,e:r}),null}}createExpressionFunction(e){const t=this.cache;if(t[e])return t[e];const r=this.createFunctionBody(e),n=new Function("x, ctx, oldValue, newValue, value, node, data, colDef, rowIndex, api, getValue, column, columnGroup",r);return t[e]=n,n}createFunctionBody(e){return e.includes("return")?e:"return "+e+";"}},Aj=class extends et{constructor(){super(...arguments),this.beanName="valueCache",this.cacheVersion=0}postConstruct(){const e=this.gos;this.active=e.get("valueCache"),this.neverExpires=e.get("valueCacheNeverExpires")}onDataChanged(){this.neverExpires||this.expire()}expire(){this.cacheVersion++}setValue(e,t,r){if(this.active){const n=this.cacheVersion;e.__cacheVersion!==n&&(e.__cacheVersion=n,e.__cacheData={}),e.__cacheData[t]=r}}getValue(e,t){if(!(!this.active||e.__cacheVersion!==this.cacheVersion))return e.__cacheData[t]}},Fj={moduleName:"ValueCache",version:wt,beans:[Aj],apiFunctions:{expireValueCache:_j}},Mj={moduleName:"Expression",version:wt,beans:[Rj]},Dj={moduleName:"ChangeDetection",version:wt,beans:[kj]},Pj={moduleName:"CellApi",version:wt,apiFunctions:{getCellValue:Ej}},Ij=class extends et{constructor(){super(...arguments),this.beanName="valueSvc",this.hasEditSvc=!1,this.initialised=!1,this.isSsrm=!1}wireBeans(e){this.expressionSvc=e.expressionSvc,this.colModel=e.colModel,this.valueCache=e.valueCache,this.dataTypeSvc=e.dataTypeSvc,this.editSvc=e.editSvc,this.hasEditSvc=!!e.editSvc,this.formulaDataSvc=e.formulaDataSvc}postConstruct(){this.initialised||this.init()}init(){const{gos:e,valueCache:t}=this;this.executeValueGetter=t?this.executeValueGetterWithValueCache.bind(this):this.executeValueGetterWithoutValueCache.bind(this),this.isSsrm=Cd(e),this.cellExpressions=e.get("enableCellExpressions"),this.isTreeData=e.get("treeData"),this.initialised=!0;const r=n=>this.callColumnCellValueChangedHandler(n);this.eventSvc.addListener("cellValueChanged",r,!0),this.addDestroyFunc(()=>this.eventSvc.removeListener("cellValueChanged",r,!0)),this.addManagedPropertyListener("treeData",n=>this.isTreeData=n.currentValue)}getValueForDisplay(e){const{column:t,node:r,includeValueFormatted:n,useRawFormula:i,exporting:s,source:o="ui"}=e,{showRowGroupColValueSvc:a}=this.beans,l=!t&&r.group,c=t?.colDef.showRowGroup,u=!this.isTreeData||r.footer;if(a&&u&&(l||c)){const C=a.getGroupValue(r,t);if(C==null)return{value:null,valueFormatted:null};if(!n)return{value:C.value,valueFormatted:null};const k=a.formatAndPrefixGroupColValue(C,t,s);return{value:C.value,valueFormatted:k}}if(!t)return{value:r.key,valueFormatted:null};const h=r.leafGroup&&this.colModel.isPivotMode(),d=r.group&&r.expanded&&!r.footer&&!h,f=this.gos.get("groupSuppressBlankHeader")||!r.sibling,m=d&&!f;let v=this.getValue(t,r,m,o),g=v;const{formula:w}=this.beans,y=n&&!(s&&t.colDef.useValueFormatterForExport===!1);return t.isAllowFormula()&&w?.isFormula(v)&&(i?(v=w.normaliseFormula(v,!0),g=w.resolveValue(t,r)):(v=w.resolveValue(t,r),g=v)),{value:v,valueFormatted:y?this.formatValue(t,r,g):null}}getValue(e,t,r=!1,n="ui"){if(this.initialised||this.init(),!t)return;if(this.hasEditSvc&&n==="ui"){const a=this.editSvc;if(a.isEditing()){const l=a.getCellDataValue({rowNode:t,column:e},!0);if(l!==void 0)return l}}const s=e.getColDef().showRowGroup;if(typeof s=="string"&&(this.beans.rowGroupColsSvc?.getColumnIndex(s)??-1)>t.level)return null;let o=this.resolveValue(e,t,r);if(this.cellExpressions&&B_(o)){const a=o.substring(1);o=this.executeValueGetter(a,t.data,e,t)}return o}getFormulaFromDataSource(e,t){const r=this.formulaDataSvc;if(!r?.hasDataSource()||!e.isAllowFormula())return;const n=r.getFormula({column:e,rowNode:t});return B_(n)?n:void 0}resolveValue(e,t,r){const n=e.getColDef(),i=e.getColId(),s=this.isTreeData,o=this.getFormulaFromDataSource(e,t);if(o!==void 0)return o;const a=!r&&t.aggData&&t.aggData[i]!==void 0;if(s&&a)return t.aggData[i];const l=t.data,c=n.field;if(s&&n.valueGetter)return this.executeValueGetter(n.valueGetter,l,e,t);if(s&&c&&l)return Wh(l,c,e.isFieldContainsDots());const u=t.groupData;if(u&&i in u)return t.groupData[i];if(a)return t.aggData[i];const d=n.showRowGroup,f=typeof d!="string"||!t.group,m=this.isSsrm&&r&&!!n.aggFunc,v=this.isSsrm&&t.footer&&t.field&&(d===!0||d===t.field);if(n.valueGetter&&!m)return f?this.executeValueGetter(n.valueGetter,l,e,t):void 0;if(v)return Wh(l,t.field,e.isFieldContainsDots());if(c&&l&&!m)return f?Wh(l,c,e.isFieldContainsDots()):void 0}parseValue(e,t,r,n){const i=e.getColDef();if(i.allowFormula&&this.beans.formula?.isFormula(r))return r;const s=i.valueParser;if(bt(s)){const o=Dt(this.gos,{node:t,data:t?.data,oldValue:n,newValue:r,colDef:i,column:e});return typeof s=="function"?s(o):this.expressionSvc?.evaluate(s,o)}return r}getDeleteValue(e,t){return bt(e.getColDef().valueParser)?this.parseValue(e,t,"",this.getValueForDisplay({column:e,node:t}).value)??null:null}formatValue(e,t,r,n,i=!0){const{expressionSvc:s}=this.beans;let o=null,a;const l=e.getColDef();if(n?a=n:i&&(a=l.valueFormatter),a){const c=t?t.data:null,u=Dt(this.gos,{value:r,node:t,data:c,colDef:l,column:e});typeof a=="function"?o=a(u):o=s?s.evaluate(a,u):null}else if(l.refData)return l.refData[r]||"";return o==null&&Array.isArray(r)&&(o=r.join(", ")),o}setValue(e,t,r,n){const i=this.colModel.getColDefCol(t);if(!e||!i)return!1;this.ensureRowData(e);const s=i.getColDef();if(!this.isSetValueSupported({column:i,newValue:r,colDef:s}))return!1;const o=Dt(this.gos,{node:e,data:e.data,oldValue:this.getValue(i,e,void 0,n),newValue:r,colDef:s,column:i});o.newValue=r;const a=this.handleExternalFormulaChange({column:i,eventSource:n,newValue:r,setterParams:o,rowNode:e});if(a!==null)return a;let l=this.computeValueChange({column:i,newValue:r,params:o,rowData:e.data,valueSetter:s.valueSetter,field:s.field});return l===void 0&&(l=!0),l?this.finishValueChange(e,i,o,n):!1}finishValueChange(e,t,r,n){e.resetQuickFilterAggregateText(),this.valueCache?.onDataChanged();const i=this.getValue(t,e);return this.dispatchCellValueChangedEvent(e,r,i,n),e.pinnedSibling&&this.dispatchCellValueChangedEvent(e.pinnedSibling,r,i,n),!0}ensureRowData(e){Yr(e.data)&&(e.data={})}isSetValueSupported(e){const{column:t,newValue:r,colDef:n}=e,{field:i,valueSetter:s}=n,o=this.beans.formula,a=t.isAllowFormula()&&o?.isFormula(r),l=!!this.formulaDataSvc?.hasDataSource();return Yr(i)&&Yr(s)&&!(l&&a)?(at(17),!1):this.dataTypeSvc&&!this.dataTypeSvc.checkType(t,r)?(at(135),!1):!0}handleExternalFormulaChange(e){const{column:t,rowNode:r,newValue:n,eventSource:i,setterParams:s}=e,o=this.beans.formula,a=this.formulaDataSvc;if(!a?.hasDataSource()||!t.isAllowFormula())return null;const l=o?.isFormula(n),c=a.getFormula({column:t,rowNode:r});if(l){if(!(c!==n))return!1;a.setFormula({column:t,rowNode:r,formula:n});const h=o?.resolveValue(t,r),d=t.getColDef();if(bt(d.valueSetter)||!Yr(d.field)){const f={...s,newValue:h};this.computeValueChange({column:t,newValue:h,params:f,rowData:r.data,valueSetter:d.valueSetter,field:d.field})}return this.finishValueChange(r,t,s,i)}return c!==void 0&&a.setFormula({column:t,rowNode:r,formula:void 0}),null}computeValueChange(e){const{valueSetter:t,params:r,rowData:n,field:i,column:s,newValue:o}=e;return bt(t)?typeof t=="function"?t(r):this.expressionSvc?.evaluate(t,r):this.setValueUsingField(n,i,o,s.isFieldContainsDots())}dispatchCellValueChangedEvent(e,t,r,n){this.eventSvc.dispatchEvent({type:"cellValueChanged",event:null,rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:t.column,colDef:t.colDef,data:e.data,node:e,oldValue:t.oldValue,newValue:r,value:r,source:n})}callColumnCellValueChangedHandler(e){const t=e.colDef.onCellValueChanged;typeof t=="function"&&this.beans.frameworkOverrides.wrapOutgoing(()=>{t({node:e.node,data:e.data,oldValue:e.oldValue,newValue:e.newValue,colDef:e.colDef,column:e.column,api:e.api,context:e.context})})}setValueUsingField(e,t,r,n){if(!t)return!1;let i=!1;if(!n)i=e[t]===r,i||(e[t]=r);else{const s=t.split(".");let o=e;for(;s.length>0&&o;){const a=s.shift();s.length===0?(i=o[a]===r,i||(o[a]=r)):o=o[a]}}return!i}executeValueGetterWithValueCache(e,t,r,n){const i=r.getColId(),s=this.valueCache.getValue(n,i);if(s!==void 0)return s;const o=this.executeValueGetterWithoutValueCache(e,t,r,n);return this.valueCache.setValue(n,i,o),o}executeValueGetterWithoutValueCache(e,t,r,n){const i=Dt(this.gos,{data:t,node:n,column:r,colDef:r.getColDef(),getValue:this.getValueCallback.bind(this,n)});let s;return typeof e=="function"?s=e(i):s=this.expressionSvc?.evaluate(e,i),s}getValueCallback(e,t){const r=this.colModel.getColDefCol(t);return r?this.getValue(r,e):null}getKeyForNode(e,t){const r=this.getValue(e,t),n=e.getColDef().keyCreator;let i=r;if(n){const s=Dt(this.gos,{value:r,colDef:e.getColDef(),column:e,node:t,data:t.data});i=n(s)}return typeof i=="string"||i==null||(i=String(i),i==="[object Object]"&&at(121)),i}},Oj={moduleName:"CommunityCore",version:wt,beans:[FB,FO,OL,SP,fj,qN,_B,ZB,wP,WH,UH,gj,Ij,RB,SB,AB,LL,Sj,FL,ML,lH],icons:{selectOpen:"small-down",smallDown:"small-down",colorPicker:"color-picker",smallUp:"small-up",checkboxChecked:"small-up",checkboxIndeterminate:"checkbox-indeterminate",checkboxUnchecked:"checkbox-unchecked",radioButtonOn:"radio-button-on",radioButtonOff:"radio-button-off",smallLeft:"small-left",smallRight:"small-right"},apiFunctions:{getGridId:MO,destroy:DO,isDestroyed:PO,getGridOption:IO,setGridOption:OO,updateGridOptions:hR,isModuleRegistered:NO},dependsOn:[kL,EN,DN,IR,iH,XN,sH,hj,Dj,aH,zH,XH,JH,uH,IL,RL,Mj,QN,tj]},OR={AdvancedFilter:1,AiToolkit:1,AllEnterprise:1,BatchEdit:1,CellSelection:1,Clipboard:1,ColumnMenu:1,ColumnsToolPanel:1,ContextMenu:1,ExcelExport:1,FiltersToolPanel:1,Find:1,GridCharts:1,IntegratedCharts:1,GroupFilter:1,MasterDetail:1,Menu:1,MultiFilter:1,NewFiltersToolPanel:1,Pivot:1,RangeSelection:1,RichSelect:1,RowNumbers:1,RowGrouping:1,RowGroupingPanel:1,ServerSideRowModelApi:1,ServerSideRowModel:1,SetFilter:1,SideBar:1,Sparklines:1,StatusBar:1,TreeData:1,ViewportRowModel:1,Formula:1},pb=["TextFilter","NumberFilter","DateFilter","SetFilter","MultiFilter","GroupFilter","CustomFilter"],Nj={EditCore:["TextEditor","NumberEditor","DateEditor","CheckboxEditor","LargeTextEditor","SelectEditor","RichSelect","CustomEditor"],CheckboxCellRenderer:["AllCommunity"],ClientSideRowModelHierarchy:["RowGrouping","Pivot","TreeData"],ColumnFilter:pb,ColumnGroupHeaderComp:["AllCommunity"],ColumnGroup:["AllCommunity"],ColumnHeaderComp:["AllCommunity"],ColumnMove:["AllCommunity"],ColumnResize:["AllCommunity"],CommunityCore:["AllCommunity"],CsrmSsrmSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],RowModelSharedApi:["ClientSideRowModelApi","ServerSideRowModelApi"],EnterpriseCore:["AllEnterprise"],FilterCore:[...pb,"QuickFilter","ExternalFilter","AdvancedFilter"],GroupCellRenderer:["RowGrouping","Pivot","TreeData","MasterDetail","ServerSideRowModel"],KeyboardNavigation:["AllCommunity"],LoadingCellRenderer:["ServerSideRowModel"],MenuCore:["ColumnMenu","ContextMenu"],MenuItem:["ColumnMenu","ContextMenu","MultiFilter","IntegratedCharts","ColumnsToolPanel"],Overlay:["AllCommunity"],PinnedColumn:["AllCommunity"],SharedAggregation:["RowGrouping","Pivot","TreeData","ServerSideRowModel"],SharedDragAndDrop:["AllCommunity"],SharedMasterDetail:["MasterDetail","ServerSideRowModel"],SharedMenu:[...pb,"ColumnMenu","ContextMenu"],SharedPivot:["Pivot","ServerSideRowModel"],SharedRowGrouping:["RowGrouping","ServerSideRowModel"],SharedRowSelection:["RowSelection","ServerSideRowModel"],SkeletonCellRenderer:["ServerSideRowModel"],Sort:["AllCommunity"],SsrmInfiniteSharedApi:["InfiniteRowModel","ServerSideRowModelApi"],SharedTreeData:["TreeData","ServerSideRowModel"]},Lj={InfiniteRowModel:"infinite",ClientSideRowModelApi:"clientSide",ClientSideRowModel:"clientSide",ServerSideRowModelApi:"serverSide",ServerSideRowModel:"serverSide",ViewportRowModel:"viewport"};function Bj(e,t){const r=[];for(const n of Array.isArray(e)?e:[e]){const i=Nj[n];if(i)for(const s of i){const o=Lj[s];(!o||o===t)&&r.push(s)}else r.push(n)}return r}var NR=()=>`No AG Grid modules are registered! It is recommended to start with all Community features via the AllCommunityModule:
                    
    import { ModuleRegistry, AllCommunityModule } from 'ag-grid-community';
    
    ModuleRegistry.registerModules([ AllCommunityModule ]);
    `,Hj=e=>{const t=e.map(n=>`import { ${$h(n)} } from '${OR[n]?"ag-grid-enterprise":"ag-grid-community"}';`);return e.some(n=>n==="IntegratedCharts"||n==="Sparklines")&&t.push("import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';"),`import { ModuleRegistry } from 'ag-grid-community'; 
${t.join(` 
`)} 

ModuleRegistry.registerModules([ ${e.map(n=>$h(n,!0)).join(", ")} ]); 

For more info see: ${zu}/modules/`};function $h(e,t=!1){return t&&(e==="IntegratedCharts"||e==="Sparklines")?`${e}Module.with(AgChartsEnterpriseModule)`:`${e}Module`}function jj(e,t){const r=t.filter(s=>s==="IntegratedCharts"||s==="Sparklines");let n="";return!globalThis?.agCharts&&r.length>0?n=`Unable to use ${e} as either the ag-charts-community or ag-charts-enterprise script needs to be included alongside ag-grid-enterprise.
`:t.some(s=>OR[s])&&(n=n+`Unable to use ${e} as that requires the ag-grid-enterprise script to be included.
`),n}function LR({moduleName:e,rowModelType:t}){return`To use the ${e}Module you must set the gridOption "rowModelType='${t}'"`}var W4=({reasonOrId:e,moduleName:t,gridScoped:r,gridId:n,rowModelType:i,additionalText:s,isUmd:o})=>{const a=Bj(t,i),l=typeof e=="string"?e:Uj[e];if(o)return jj(l,a);const c=a.filter(d=>d==="IntegratedCharts"||d==="Sparklines"),u=c.length>0?`${c.map(d=>$h(d)).join()} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.`:"";return`${`Unable to use ${l} as ${a.length>1?"one of "+a.map(d=>$h(d)).join(", "):$h(a[0])} is not registered${r?" for gridId: "+n:""}. ${u} Check if you have registered the module:
`}
${Hj(a)}`+(s?` 

${s}`:"")},$4=e=>`${e} must be initialised with an AG Charts module. One of 'AgChartsCommunityModule' / 'AgChartsEnterpriseModule'.

import { AgChartsEnterpriseModule } from 'ag-charts-enterprise';
import { ModuleRegistry } from 'ag-grid-community';
import { ${e} } from 'ag-grid-enterprise';
    
ModuleRegistry.registerModules([${e}.with(AgChartsEnterpriseModule)]);
    `,Vj=e=>`AG Grid: Unable to use the Clipboard API (navigator.clipboard.${e}()). The reason why it could not be used has been logged in the previous line. For this reason the grid has defaulted to using a workaround which doesn't perform as well. Either fix why Clipboard API is blocked, OR stop this message from appearing by setting grid property suppressClipboardApi=true (which will default the grid to using the workaround rather than the API.`,Gj={1:()=>"`rowData` must be an array",2:({nodeId:e})=>`Duplicate node id '${e}' detected from getRowId callback, this could cause issues in your grid.`,3:()=>"Calling gridApi.resetRowHeights() makes no sense when using Auto Row Height.",4:({id:e})=>`Could not find row id=${e}, data item was not found for this id`,5:({data:e})=>["Could not find data item as object was not found.",e," Consider using getRowId to help the Grid find matching row data"],6:()=>"'groupHideOpenParents' only works when specifying specific columns for 'colDef.showRowGroup'",7:()=>"Pivoting is not supported with aligned grids as it may produce different columns in each grid.",8:({key:e})=>`Unknown key for navigation ${e}`,9:({variable:e})=>`No value for ${e?.cssName}. This usually means that the grid has been initialised before styles have been loaded. The default value of ${e?.defaultValue} will be used and updated when styles load.`,10:({eventType:e})=>`As of v33, the '${e}' event is deprecated. Use the global 'modelUpdated' event to determine when row children have changed.`,11:()=>"No gridOptions provided to createGrid",12:({colKey:e})=>["column ",e," not found"],13:()=>"Could not find rowIndex, this means tasks are being executed on a rowNode that has been removed from the grid.",14:({groupPrefix:e})=>`Row IDs cannot start with ${e}, this is a reserved prefix for AG Grid's row grouping feature.`,15:({expression:e})=>["value should be either a string or a function",e],16:({expression:e,params:t,e:r})=>["Processing of the expression failed","Expression = ",e,"Params = ",t,"Exception = ",r],17:()=>"you need either field or valueSetter set on colDef for editing to work",18:()=>"alignedGrids contains an undefined option.",19:()=>"alignedGrids - No api found on the linked grid.",20:()=>`You may want to configure via a callback to avoid setup race conditions:
                     "alignedGrids: () => [linkedGrid]"`,21:()=>"pivoting is not supported with aligned grids. You can only use one of these features at a time in a grid.",22:({key:e})=>`${e} is an initial property and cannot be updated.`,23:()=>"The return of `getRowHeight` cannot be zero. If the intention is to hide rows, use a filter instead.",24:()=>"row height must be a number if not using standard row model",25:({id:e})=>["The getRowId callback must return a string. The ID ",e," is being cast to a string."],26:({fnName:e,preDestroyLink:t})=>`Grid API function ${e}() cannot be called as the grid has been destroyed.
 Either clear local references to the grid api, when it is destroyed, or check gridApi.isDestroyed() to avoid calling methods against a destroyed grid.
 To run logic when the grid is about to be destroyed use the gridPreDestroy event. See: ${t}`,27:({fnName:e,module:t})=>`API function '${e}' not registered to module '${t}'`,28:()=>"setRowCount cannot be used while using row grouping.",29:()=>"tried to call sizeColumnsToFit() but the grid is coming back with zero width, maybe the grid is not visible yet on the screen?",30:({toIndex:e})=>["tried to insert columns in invalid location, toIndex = ",e,"remember that you should not count the moving columns when calculating the new index"],31:()=>"infinite loop in resizeColumnSets",32:()=>"applyColumnState() - the state attribute should be an array, however an array was not found. Please provide an array of items (one for each col you want to change) for state.",33:()=>"stateItem.aggFunc must be a string. if using your own aggregation functions, register the functions first before using them in get/set state. This is because it is intended for the column state to be stored and retrieved as simple JSON.",34:({key:e})=>`the column type '${e}' is a default column type and cannot be overridden.`,35:()=>"Column type definitions 'columnTypes' with a 'type' attribute are not supported because a column type cannot refer to another column type. Only column definitions 'columnDefs' can use the 'type' attribute to refer to a column type.",36:({t:e})=>"colDef.type '"+e+"' does not correspond to defined gridOptions.columnTypes",37:()=>"Changing the column pinning status is not allowed with domLayout='print'",38:({iconName:e})=>`provided icon '${e}' needs to be a string or a function`,39:()=>"Applying column order broke a group where columns should be married together. Applying new order has been discarded.",40:({e,method:t})=>`${e}
${Vj(t)}`,41:()=>"Browser did not allow document.execCommand('copy'). Ensure 'api.copySelectedRowsToClipboard() is invoked via a user event, i.e. button click, otherwise the browser will prevent it for security reasons.",42:()=>"Browser does not support document.execCommand('copy') for clipboard operations",43:({iconName:e})=>`As of v33, icon '${e}' is deprecated. Use the icon CSS name instead.`,44:()=>'Data type definition hierarchies (via the "extendsDataType" property) cannot contain circular references.',45:({parentCellDataType:e})=>`The data type definition ${e} does not exist.`,46:()=>'The "baseDataType" property of a data type definition must match that of its parent.',47:({cellDataType:e})=>`Missing data type definition - "${e}"`,48:({property:e})=>`Cell data type is "object" but no Value ${e} has been provided. Please either provide an object data type definition with a Value ${e}, or set "colDef.value${e}"`,49:({methodName:e})=>`Framework component is missing the method ${e}()`,50:({compName:e})=>`Could not find component ${e}, did you forget to configure this component?`,51:()=>"Export cancelled. Export is not allowed as per your configuration.",52:()=>"There is no `window` associated with the current `document`",53:()=>"unknown value type during csv conversion",54:()=>"Could not find document body, it is needed for drag and drop and context menu.",55:()=>"addRowDropZone - A container target needs to be provided",56:()=>"addRowDropZone - target already exists in the list of DropZones. Use `removeRowDropZone` before adding it again.",57:()=>"unable to show popup filter, filter instantiation failed",58:()=>"no values found for select cellEditor",59:()=>"cannot select pinned rows",60:()=>"cannot select node until it has finished loading",61:()=>"since version v32.2.0, rowNode.isFullWidthCell() has been deprecated. Instead check `rowNode.detail` followed by the user provided `isFullWidthRow` grid option.",62:({colId:e})=>`setFilterModel() - no column found for colId: ${e}`,63:({colId:e})=>`setFilterModel() - unable to fully apply model, filtering disabled for colId: ${e}`,64:({colId:e})=>`setFilterModel() - unable to fully apply model, unable to create filter for colId: ${e}`,65:()=>"filter missing setModel method, which is needed for setFilterModel",66:()=>"filter API missing getModel method, which is needed for getFilterModel",67:()=>"Filter is missing isFilterActive() method",68:()=>"Column Filter API methods have been disabled as Advanced Filters are enabled.",69:({guiFromFilter:e})=>`getGui method from filter returned ${e}; it should be a DOM element.`,70:({newFilter:e})=>`Grid option quickFilterText only supports string inputs, received: ${typeof e}`,71:()=>"debounceMs is ignored when apply button is present",72:({keys:e})=>["ignoring FilterOptionDef as it doesn't contain one of ",e],73:()=>"invalid FilterOptionDef supplied as it doesn't contain a 'displayKey'",74:()=>"no filter options for filter",75:()=>"Unknown button type specified",76:({filterModelType:e})=>['Unexpected type of filter "',e,'", it looks like the filter was configured with incorrect Filter Options'],77:()=>"Filter model is missing 'conditions'",78:()=>'Filter Model contains more conditions than "filterParams.maxNumConditions". Additional conditions have been ignored.',79:()=>'"filterParams.maxNumConditions" must be greater than or equal to zero.',80:()=>'"filterParams.numAlwaysVisibleConditions" must be greater than or equal to zero.',81:()=>'"filterParams.numAlwaysVisibleConditions" cannot be greater than "filterParams.maxNumConditions".',82:({param:e})=>`DateFilter ${e} is not a number`,83:()=>"DateFilter minValidYear should be <= maxValidYear",84:()=>"DateFilter minValidDate should be <= maxValidDate",85:()=>"DateFilter should not have both minValidDate and minValidYear parameters set at the same time! minValidYear will be ignored.",86:()=>"DateFilter should not have both maxValidDate and maxValidYear parameters set at the same time! maxValidYear will be ignored.",87:()=>"DateFilter parameter minValidDate should always be lower than or equal to parameter maxValidDate.",88:({index:e})=>`Invalid row index for ensureIndexVisible: ${e}`,89:()=>"A template was provided for Header Group Comp - templates are only supported for Header Comps (not groups)",90:()=>"datasource is missing getRows method",91:()=>"Filter is missing method doesFilterPass",92:()=>"AnimationFrameService called but animation frames are off",93:()=>"cannot add multiple ranges when `cellSelection.suppressMultiRanges = true`",94:({paginationPageSizeOption:e,pageSizeSet:t,pageSizesSet:r,pageSizeOptions:n})=>`'paginationPageSize=${e}'${t?"":" (default value)"}, but ${e} is not included in${r?"":" the default"} paginationPageSizeSelector=[${n?.join(", ")}].`,95:({paginationPageSizeOption:e,paginationPageSizeSelector:t})=>`Either set '${t}' to an array that includes ${e} or to 'false' to disable the page size selector.`,96:({id:e,data:t})=>["Duplicate ID",e,"found for pinned row with data",t,"When `getRowId` is defined, it must return unique IDs for all pinned rows. Use the `rowPinned` parameter."],97:({colId:e})=>`cellEditor for column ${e} is missing getGui() method`,98:()=>"popup cellEditor does not work with fullRowEdit - you cannot use them both - either turn off fullRowEdit, or stop using popup editors.",99:()=>"Since v32, `api.hideOverlay()` does not hide the loading overlay when `loading=true`. Set `loading=false` instead.",101:({propertyName:e,componentName:t,agGridDefaults:r,jsComps:n})=>{const i=[],s=[...Object.keys(r??[]).filter(a=>!["agCellEditor","agGroupRowRenderer","agSortIndicator"].includes(a)),...Object.keys(n??[]).filter(a=>!!n[a])],o=uw({inputValue:t,allSuggestions:s,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return i.push(`Could not find '${t}' component. It was configured as "${e}: '${t}'" but it wasn't found in the list of registered components.
`),o.length>0&&i.push(`         Did you mean: [${o.slice(0,3)}]?
`),i.push("If using a custom component check it has been registered correctly."),i},102:()=>"selectAll: 'filtered' only works when gridOptions.rowModelType='clientSide'",103:()=>"Invalid selection state. When using client-side row model, the state must conform to `string[]`.",104:({value:e,param:t})=>`Numeric value ${e} passed to ${t} param will be interpreted as ${e} seconds. If this is intentional use "${e}s" to silence this warning.`,105:({e})=>["chart rendering failed",e],106:()=>`Theming API and Legacy Themes are both used in the same page. A Theming API theme has been provided to the 'theme' grid option, but the file (ag-grid.css) is also included and will cause styling issues. Remove ag-grid.css from the page. See the migration guide: ${zu}/theming-migration/`,107:({key:e,value:t})=>`Invalid value for theme param ${e} - ${t}`,108:({e})=>["chart update failed",e],109:({inputValue:e,allSuggestions:t})=>{const r=uw({inputValue:e,allSuggestions:t,hideIrrelevant:!0,filterByPercentageOfBestMatch:.8}).values;return[`Could not find '${e}' aggregate function. It was configured as "aggFunc: '${e}'" but it wasn't found in the list of registered aggregations.`,r.length>0?`         Did you mean: [${r.slice(0,3)}]?`:"","If using a custom aggregation function check it has been registered correctly."].join(`
`)},110:()=>"groupHideOpenParents only works when specifying specific columns for colDef.showRowGroup",111:()=>"Invalid selection state. When `groupSelects` is enabled, the state must conform to `IServerSideGroupSelectionState`.",113:()=>"Set Filter cannot initialise because you are using a row model that does not contain all rows in the browser. Either use a different filter type, or configure Set Filter such that you provide it with values",114:({component:e})=>`Could not find component with name of ${e}. Is it in Vue.components?`,116:()=>"Invalid selection state. The state must conform to `IServerSideSelectionState`.",117:()=>"selectAll must be of boolean type.",118:()=>"Infinite scrolling must be enabled in order to set the row count.",119:()=>"Unable to instantiate filter",120:()=>"MultiFloatingFilterComp expects MultiFilter as its parent",121:()=>"a column you are grouping or pivoting by has objects as values. If you want to group by complex objects then either a) use a colDef.keyCreator (see AG Grid docs) or b) to toString() on the object to return a key",122:()=>"could not find the document, document is empty",123:()=>"Advanced Filter is only supported with the Client-Side Row Model or Server-Side Row Model.",124:()=>"No active charts to update.",125:({chartId:e})=>`Unable to update chart. No active chart found with ID: ${e}.`,126:()=>"unable to restore chart as no chart model is provided",127:({allRange:e})=>`unable to create chart as ${e?"there are no columns in the grid":"no range is selected"}.`,128:({feature:e})=>`${e} is only available if using 'multiRow' selection mode.`,129:({feature:e,rowModel:t})=>`${e} is only available if using 'clientSide' or 'serverSide' rowModelType, you are using ${t}.`,130:()=>'cannot multi select unless selection mode is "multiRow"',132:()=>"Row selection features are not available unless `rowSelection` is enabled.",133:({iconName:e})=>`icon '${e}' function should return back a string or a dom object`,134:({iconName:e})=>`Did not find icon '${e}'`,135:()=>"Data type of the new value does not match the cell data type of the column",136:()=>"Unable to update chart as the 'type' is missing. It must be either 'rangeChartUpdate', 'pivotChartUpdate', or 'crossFilterChartUpdate'.",137:({type:e,currentChartType:t})=>`Unable to update chart as a '${e}' update type is not permitted on a ${t}.`,138:({chartType:e})=>`invalid chart type supplied: ${e}`,139:({customThemeName:e})=>`a custom chart theme with the name ${e} has been supplied but not added to the 'chartThemes' list`,140:({name:e})=>`no stock theme exists with the name '${e}' and no custom chart theme with that name was supplied to 'customChartThemes'`,141:()=>"cross filtering with row grouping is not supported.",142:()=>"cross filtering is only supported in the client side row model.",143:({panel:e})=>`'${e}' is not a valid Chart Tool Panel name`,144:({type:e})=>`Invalid charts data panel group name supplied: '${e}'`,145:({group:e})=>`As of v32, only one charts customize panel group can be expanded at a time. '${e}' will not be expanded.`,146:({comp:e})=>`Unable to instantiate component '${e}' as its module hasn't been loaded. Add 'ValidationModule' to see which module is required.`,147:({group:e})=>`Invalid charts customize panel group name supplied: '${e}'`,148:({group:e})=>`invalid chartGroupsDef config '${e}'`,149:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,150:()=>"'seriesChartTypes' are required when the 'customCombo' chart type is specified.",151:({chartType:e})=>`invalid chartType '${e}' supplied in 'seriesChartTypes', converting to 'line' instead.`,152:({colId:e})=>`no 'seriesChartType' found for colId = '${e}', defaulting to 'line'.`,153:({chartDataType:e})=>`unexpected chartDataType value '${e}' supplied, instead use 'category', 'series' or 'excluded'`,154:({colId:e})=>`cross filtering requires a 'agSetColumnFilter' or 'agMultiColumnFilter' to be defined on the column with id: ${e}`,155:({option:e})=>`'${e}' is not a valid Chart Toolbar Option`,156:({panel:e})=>`Invalid panel in chartToolPanelsDef.panels: '${e}'`,157:({unrecognisedGroupIds:e})=>["unable to find group(s) for supplied groupIds:",e],158:()=>"can not expand a column item that does not represent a column group header",159:()=>"Invalid params supplied to createExcelFileForExcel() - `ExcelExportParams.data` is empty.",160:()=>"Export cancelled. Export is not allowed as per your configuration.",161:()=>"The Excel Exporter is currently on Multi Sheet mode. End that operation by calling 'api.getMultipleSheetAsExcel()' or 'api.exportMultipleSheetsAsExcel()'",162:({id:e,dataType:t})=>`Unrecognized data type for excel export [${e}.dataType=${t}]`,163:({featureName:e})=>`Excel table export does not work with ${e}. The exported Excel file will not contain any Excel tables.
 Please turn off ${e} to enable Excel table exports.`,164:()=>"Unable to add data table to Excel sheet: A table already exists.",165:()=>"Unable to add data table to Excel sheet: Missing required parameters.",166:({unrecognisedGroupIds:e})=>["unable to find groups for these supplied groupIds:",e],167:({unrecognisedColIds:e})=>["unable to find columns for these supplied colIds:",e],168:()=>"detailCellRendererParams.template should be function or string",169:()=>'Reference to eDetailGrid was missing from the details template. Please add data-ref="eDetailGrid" to the template.',170:({providedStrategy:e})=>`invalid cellRendererParams.refreshStrategy = ${e} supplied, defaulting to refreshStrategy = 'rows'.`,171:()=>"could not find detail grid options for master detail, please set gridOptions.detailCellRendererParams.detailGridOptions",172:()=>"could not find getDetailRowData for master / detail, please set gridOptions.detailCellRendererParams.getDetailRowData",173:({group:e})=>`invalid chartGroupsDef config '${e}'`,174:({group:e,chartType:t})=>`invalid chartGroupsDef config '${e}.${t}'`,175:({menuTabName:e,itemsToConsider:t})=>[`Trying to render an invalid menu item '${e}'. Check that your 'menuTabs' contains one of `,t],176:({key:e})=>`unknown menu item type ${e}`,177:()=>"valid values for cellSelection.handle.direction are 'x', 'y' and 'xy'. Default to 'xy'.",178:({colId:e})=>`column ${e} is not visible`,179:()=>"totalValueGetter should be either a function or a string (expression)",180:()=>"agRichSelectCellEditor requires cellEditorParams.values to be set",181:()=>"agRichSelectCellEditor cannot have `multiSelect` and `allowTyping` set to `true`. AllowTyping has been turned off.",182:()=>'you cannot mix groupDisplayType = "multipleColumns" with treeData, only one column can be used to display groups when doing tree data',183:()=>"Group Column Filter only works on group columns. Please use a different filter.",184:({parentGroupData:e,childNodeData:t})=>["duplicate group keys for row data, keys should be unique",[e,t]],185:({data:e})=>["getDataPath() should not return an empty path",[e]],186:({rowId:e,rowData:t,duplicateRowsData:r})=>["duplicate group keys for row data, keys should be unique",e,t,...r??[]],187:({rowId:e,firstData:t,secondData:r})=>[`Duplicate node id ${e}. Row IDs are provided via the getRowId() callback. Please modify the getRowId() callback code to provide unique row id values.`,"first instance",t,"second instance",r],188:e=>`getRowId callback must be provided for Server Side Row Model ${e?.feature||"selection"} to work correctly.`,189:({startRow:e})=>`invalid value ${e} for startRow, the value should be >= 0`,190:({rowGroupId:e,data:t})=>["null and undefined values are not allowed for server side row model keys",e?`column = ${e}`:"","data is ",t],194:({method:e})=>`calling gridApi.${e}() is only possible when using rowModelType=\`clientSide\`.`,195:({justCurrentPage:e})=>`selecting just ${e?"current page":"filtered"} only works when gridOptions.rowModelType='clientSide'`,196:({key:e})=>`Provided ids must be of string type. Invalid id provided: ${e}`,197:()=>"`toggledNodes` must be an array of string ids.",199:()=>"getSelectedNodes and getSelectedRows functions cannot be used with select all functionality with the server-side row model. Use `api.getServerSideSelectionState()` instead.",200:W4,201:({rowModelType:e})=>`Could not find row model for rowModelType = ${e}`,202:()=>"`getSelectedNodes` and `getSelectedRows` functions cannot be used with `groupSelectsChildren` and the server-side row model. Use `api.getServerSideSelectionState()` instead.",203:()=>"Server Side Row Model does not support Dynamic Row Height and Cache Purging. Either a) remove getRowHeight() callback or b) remove maxBlocksInCache property. Purging has been disabled.",204:()=>"Server Side Row Model does not support Auto Row Height and Cache Purging. Either a) remove colDef.autoHeight or b) remove maxBlocksInCache property. Purging has been disabled.",205:({duplicateIdText:e})=>`Unable to display rows as duplicate row ids (${e}) were returned by the getRowId callback. Please modify the getRowId callback to provide unique ids.`,206:()=>"getRowId callback must be implemented for transactions to work. Transaction was ignored.",207:()=>'The Set Filter Parameter "defaultToNothingSelected" value was ignored because it does not work when "excelMode" is used.',208:()=>"Set Filter Value Formatter must return string values. Please ensure the Set Filter Value Formatter returns string values for complex objects.",209:()=>`Set Filter Key Creator is returning null for provided values and provided values are primitives. Please provide complex objects. See ${zu}/filter-set-filter-list/#filter-value-types`,210:()=>"Set Filter has a Key Creator, but provided values are primitives. Did you mean to provide complex objects?",211:()=>"property treeList=true for Set Filter params, but you did not provide a treeListPathGetter or values of type Date.",212:()=>"please review all your toolPanel components, it seems like at least one of them doesn't have an id",213:()=>"Advanced Filter does not work with Filters Tool Panel. Filters Tool Panel has been disabled.",214:({key:e})=>`unable to lookup Tool Panel as invalid key supplied: ${e}`,215:({key:e,defaultByKey:t})=>`the key ${e} is not a valid key for specifying a tool panel, valid keys are: ${Object.keys(t??{}).join(",")}`,216:({name:e})=>`Missing component for '${e}'`,217:({invalidColIds:e})=>["unable to find grid columns for the supplied colDef(s):",e],218:({property:e,defaultOffset:t})=>`${e} must be a number, the value you provided is not a valid number. Using the default of ${t}px.`,219:({property:e})=>`Property ${e} does not exist on the target object.`,220:({lineDash:e})=>`'${e}' is not a valid 'lineDash' option.`,221:()=>"agAggregationComponent should only be used with the client and server side row model.",222:()=>"agFilteredRowCountComponent should only be used with the client side row model.",223:()=>"agSelectedRowCountComponent should only be used with the client and server side row model.",224:()=>"agTotalAndFilteredRowCountComponent should only be used with the client side row model.",225:()=>"agTotalRowCountComponent should only be used with the client side row model.",226:()=>"viewport is missing init method.",227:()=>"menu item icon must be DOM node or string",228:({menuItemOrString:e})=>`unrecognised menu item ${e}`,230:()=>"detailCellRendererParams.template is not supported by AG Grid React. To change the template, provide a Custom Detail Cell Renderer. See https://www.ag-grid.com/react-data-grid/master-detail-custom-detail/",231:()=>"As of v32, using custom components with `reactiveCustomComponents = false` is deprecated.",232:()=>"Using both rowData and v-model. rowData will be ignored.",233:({methodName:e})=>`Framework component is missing the method ${e}()`,234:()=>'Group Column Filter does not work with the colDef property "field". This property will be ignored.',235:()=>'Group Column Filter does not work with the colDef property "filterValueGetter". This property will be ignored.',236:()=>'Group Column Filter does not work with the colDef property "filterParams". This property will be ignored.',237:()=>"Group Column Filter does not work with Tree Data enabled. Please disable Tree Data, or use a different filter.",238:()=>"setRowCount can only accept a positive row count.",239:()=>'Theming API and CSS File Themes are both used in the same page. In v33 we released the Theming API as the new default method of styling the grid. See the migration docs https://www.ag-grid.com/react-data-grid/theming-migration/. Because no value was provided to the `theme` grid option it defaulted to themeQuartz. But the file (ag-grid.css) is also included and will cause styling issues. Either pass the string "legacy" to the theme grid option to use v32 style themes, or remove ag-grid.css from the page to use Theming API.',240:({theme:e})=>`theme grid option must be a Theming API theme object or the string "legacy", received: ${e}`,243:()=>"Failed to deserialize state - each provided state object must be an object.",244:()=>"Failed to deserialize state - `selectAllChildren` must be a boolean value or undefined.",245:()=>"Failed to deserialize state - `toggledNodes` must be an array.",246:()=>"Failed to deserialize state - Every `toggledNode` requires an associated string id.",247:()=>`Row selection state could not be parsed due to invalid data. Ensure all child state has toggledNodes or does not conform with the parent rule. 
Please rebuild the selection state and reapply it.`,248:()=>"SetFloatingFilter expects SetFilter as its parent",249:()=>"Must supply a Value Formatter in Set Filter params when using a Key Creator",250:()=>"Must supply a Key Creator in Set Filter params when `treeList = true` on a group column, and Tree Data or Row Grouping is enabled.",251:({chartType:e})=>`AG Grid: Unable to create chart as an invalid chartType = '${e}' was supplied.`,252:()=>`cannot get grid to draw rows when it is in the middle of drawing rows. 
Your code probably called a grid API method while the grid was in the render stage. 
To overcome this, put the API call into a timeout, e.g. instead of api.redrawRows(), call setTimeout(function() { api.redrawRows(); }, 0). 
To see what part of your code that caused the refresh check this stacktrace.`,253:({version:e})=>["Illegal version string: ",e],254:()=>"Cannot create chart: no chart themes available.",255:({point:e})=>`Lone surrogate U+${e?.toString(16).toUpperCase()} is not a scalar value`,256:()=>"Unable to initialise. See validation error, or load ValidationModule if missing.",257:()=>$4("IntegratedChartsModule"),258:()=>$4("SparklinesModule"),259:({part:e})=>`the argument to theme.withPart must be a Theming API part object, received: ${e}`,260:({propName:e,compName:t,gridScoped:r,gridId:n,rowModelType:i})=>W4({reasonOrId:`AG Grid '${e}' component: ${t}`,moduleName:Ju[t],gridId:n,gridScoped:r,rowModelType:i}),261:()=>"As of v33, `column.isHovered()` is deprecated. Use `api.isColumnHovered(column)` instead.",262:()=>'As of v33, icon key "smallDown" is deprecated. Use "advancedFilterBuilderSelect" for Advanced Filter Builder dropdown, "selectOpen" for Select cell editor and dropdowns (e.g. Integrated Charts menu), "richSelectOpen" for Rich Select cell editor.',263:()=>'As of v33, icon key "smallLeft" is deprecated. Use "panelDelimiterRtl" for Row Group Panel / Pivot Panel, "subMenuOpenRtl" for sub-menus.',264:()=>'As of v33, icon key "smallRight" is deprecated. Use "panelDelimiter" for Row Group Panel / Pivot Panel, "subMenuOpen" for sub-menus.',265:({colId:e})=>`Unable to infer chart data type for column '${e}' if first data entry is null. Please specify "chartDataType", or a "cellDataType" in the column definition. For more information, see ${zu}/integrated-charts-range-chart#coldefchartdatatype .`,266:()=>'As of v33.1, using "keyCreator" with the Rich Select Editor has been deprecated. It now requires the "formatValue" callback to convert complex data to strings.',267:()=>"Detail grids can not use a different theme to the master grid, the `theme` detail grid option will be ignored.",268:()=>"Transactions aren't supported with tree data when using treeDataChildrenField",269:()=>"When `masterSelects: 'detail'`, detail grids must be configured with multi-row selection",270:({id:e,parentId:t})=>`Cycle detected for row with id='${e}' and parent id='${t}'. Resetting the parent for row with id='${e}' and showing it as a root-level node.`,271:({id:e,parentId:t})=>`Parent row not found for row with id='${e}' and parent id='${t}'. Showing row with id='${e}' as a root-level node.`,272:()=>NR(),273:({providedId:e,usedId:t})=>`Provided column id '${e}' was already in use, ensure all column and group ids are unique. Using '${t}' instead.`,274:({prop:e})=>{let t=`Since v33, ${e} has been deprecated.`;switch(e){case"maxComponentCreationTimeMs":t+=" This property is no longer required and so will be removed in a future version.";break;case"setGridApi":t+=" This method is not called by AG Grid. To access the GridApi see: https://ag-grid.com/react-data-grid/grid-interface/#grid-api ";break;case"children":t+=" For multiple versions AgGridReact does not support children.";break}return t},275:LR,276:()=>"Row Numbers Row Resizer cannot be used when Grid Columns have `autoHeight` enabled.",277:({colId:e})=>`'enableFilterHandlers' is set to true, but column '${e}' does not have 'filter.doesFilterPass' or 'filter.handler' set.`,278:({colId:e})=>`Unable to create filter handler for column '${e}'`,279:e=>{},280:({colId:e})=>`'name' must be provided for custom filter components for column '${e}`,281:({colId:e})=>`Filter for column '${e}' does not have 'filterParams.buttons', but the new Filters Tool Panel has buttons configured. Either configure buttons for the filter, or disable buttons on the Filters Tool Panel.`,282:()=>"New filter tool panel requires `enableFilterHandlers: true`.",283:()=>"As of v34, use the same method on the filter handler (`api.getColumnFilterHandler(colKey)`) instead.",284:()=>"As of v34, filters are active when they have a model. Use `api.getColumnFilterModel()` instead.",285:()=>"As of v34, use (`api.getColumnFilterModel()`) instead.",286:()=>"As of v34, use (`api.setColumnFilterModel()`) instead.",287:()=>"`api.doFilterAction()` requires `enableFilterHandlers = true",288:()=>"`api.getColumnFilterModel(key, true)` requires `enableFilterHandlers = true",289:({rowModelType:e})=>`Row Model '${e}' is not supported with Batch Editing`,290:({rowIndex:e,rowPinned:t})=>`Row with index '${e}' and pinned state '${t}' not found`,291:()=>"License Key being set multiple times with different values. This can result in an incorrect license key being used,",292:({colId:e})=>`The Multi Filter for column '${e}' has buttons configured against the child filters. When 'enableFilterHandlers=true', buttons must instead be provided against the parent Multi Filter params. The child filter buttons will be ignored.`,293:()=>"The grid was initialised detached from the DOM and was then inserted into a Shadow Root. Theme styles are probably broken. Pass the themeStyleContainer grid option to let the grid know where in the document to insert theme CSS.",294:()=>"When using the `agRichSelectCellEditor` setting `filterListAsync = true` requires `allowTyping = true` and the `values()` callback must return a Promise of filtered values.",295:({blockedService:e})=>`colDef.allowFormula is not supported with ${e}. Formulas has been turned off.`,296:()=>"Since v35, `api.hideOverlay()` does not hide the overlay when `activeOverlay` is set. Set `activeOverlay=null` instead.",297:()=>'`api.hideOverlay()` does not hide the no matching rows overlay as it is only controlled by grid state. Set `suppressOverlays=["noMatchingRows"] to not show it.'};function zj(e,t){const r=Gj[e];if(!r)return[`Missing error text for error id ${e}!`];const n=r(t),s=`
See ${WT(e,t)}`;return Array.isArray(n)?n.concat(s):[n,s]}var Uj={1:"Charting Aggregation",2:"pivotResultFields",3:"setTooltip"},q4=new WeakMap,K4=new WeakMap,Wj=1,$j=class{create(e,t,r,n,i,s){const o=hy.applyGlobalGridOptions(t),a=o.gridId??String(Wj++),l=this.getRegisteredModules(i,a,o.rowModelType),c=this.createBeansList(o.rowModelType,l,a),u=this.createProvidedBeans(e,o,i);if(!c)return;const d={providedBeanInstances:u,beanClasses:c,id:a,beanInitComparator:TO,beanDestroyComparator:kO,derivedBeans:[_O],destroyCallback:()=>{K4.delete(m),q4.delete(e),bD(a),s?.()}},f=new o9(d);this.registerModuleFeatures(f,l),r(f),f.getBean("syncSvc").start(),n?.(f);const m=f.getBean("gridApi");return q4.set(e,m),K4.set(m,e),m}getRegisteredModules(e,t,r){return df(Oj,void 0,!0),e?.modules?.forEach(n=>df(n,t)),wD(t,X4(r))}registerModuleFeatures(e,t){const r=e.getBean("registry"),n=e.getBean("apiFunctionSvc");for(const i of t){r.registerModule(i);const s=i.apiFunctions;if(s){const o=Object.keys(s);for(const a of o)n?.addFunction(a,s[a])}}}createProvidedBeans(e,t,r){let n=r?r.frameworkOverrides:null;Yr(n)&&(n=new uR);const i={gridOptions:t,eGridDiv:e,eRootDiv:e,globalListener:r?r.globalListener:null,globalSyncListener:r?r.globalSyncListener:null,frameworkOverrides:n};return r?.providedBeanInstances&&Object.assign(i,r.providedBeanInstances),i}createBeansList(e,t,r){const n={clientSide:"ClientSideRowModel",infinite:"InfiniteRowModel",serverSide:"ServerSideRowModel",viewport:"ViewportRowModel"},i=X4(e),s=n[i];if(!s){Fh(201,{rowModelType:i},`Unknown rowModelType ${i}.`);return}if(!xD()){Fh(272,void 0,NR());return}if(!e){const a=Object.entries(n).filter(([l,c])=>Qb(c,r,l));if(a.length==1){const[l,c]=a[0];if(l!==i){const u={moduleName:c,rowModelType:l};Fh(275,u,LR(u));return}}}if(!Qb(s,r,i)){const a=VT(),l=`rowModelType = '${i}'`,c=`Missing module ${s}Module for rowModelType ${i}.`;Fh(200,{reasonOrId:l,moduleName:s,gridScoped:fy(),gridId:r,rowModelType:i,isUmd:a},c);return}const o=new Set;for(const a of t)for(const l of a.beans??[])o.add(l);return Array.from(o)}};function X4(e){return e??"clientSide"}function wl(e){const t=e.rowModel;return t.getType()==="clientSide"?t:void 0}function dm(e){const t=e.rowModel;return t.getType()==="infinite"?t:void 0}function qj(e){const t=e.rowModel;return t.getType()==="serverSide"?t:void 0}var Kj=class extends et{constructor(){super(...arguments),this.beanName="localeSvc"}getLocaleTextFunc(){const e=this.gos,t=e.getCallback("getLocaleText");return t?aD(t):lD(e.get("localeText"))}};function Xj(e,t=!1){const r=[],n=[],i=[],s=[],o=[],a=[],l=[],c=[],u=[];let h=0;for(let d=0;d<e.length;d++){const{colId:f,sort:m,sortType:v,sortIndex:g,rowGroup:w,rowGroupIndex:y,aggFunc:C,pivot:k,pivotIndex:F,pinned:I,hide:N,width:j,flex:L}=e[d];u.push(f),m&&(r[g??h++]={colId:f,sort:m,type:v}),w&&(n[y??0]=f),typeof C=="string"&&i.push({colId:f,aggFunc:C}),k&&(s[F??0]=f),I&&(I==="right"?a:o).push(f),N&&l.push(f),(L!=null||j)&&c.push({colId:f,flex:L??void 0,width:j===null?void 0:j})}return{sort:r.length?{sortModel:gb(r)}:void 0,rowGroup:n.length?{groupColIds:gb(n)}:void 0,aggregation:i.length?{aggregationModel:i}:void 0,pivot:s.length||t?{pivotMode:t,pivotColIds:gb(s)}:void 0,columnPinning:o.length||a.length?{leftColIds:o,rightColIds:a}:void 0,columnVisibility:l.length?{hiddenColIds:l}:void 0,columnSizing:c.length?{columnSizingModel:c}:void 0,columnOrder:u.length?{orderedColIds:u}:void 0}}function gb(e){return e.filter(t=>t!=null)}function Yj(e){const t=[];for(const{groupId:r,open:n}of e)n&&t.push(r);return t.length?{openColumnGroupIds:t}:void 0}var Zj=class{wrap(e,t,r,n){const i=this.createWrapper(e,n);for(const s of t??[])this.createMethod(i,s,!0);for(const s of r??[])this.createMethod(i,s,!1);return i}createMethod(e,t,r){e.addMethod(t,this.createMethodProxy(e,t,r))}createMethodProxy(e,t,r){return function(){return e.hasMethod(t)?e.callMethod(t,arguments):(r&&at(49,{methodName:t}),null)}}};function mb(e){return e.get("tooltipShowMode")==="whenTruncated"}function Jj(e,t){if(typeof e!="number")return"";const r=t(),n=r("thousandSeparator",","),i=r("decimalSeparator",".");return e.toString().replace(".",i).replace(/(\d)(?=(\d{3})+(?!\d))/g,`$1${n}`)}var Qj=class extends et{getFileName(e){const t=this.getDefaultFileExtension();return e?.length||(e=this.getDefaultFileName()),e.includes(".")?e:`${e}.${t}`}getData(e){return this.beans.gridSerializer.serialize(this.createSerializingSession(e),e)}getDefaultFileName(){return`export.${this.getDefaultFileExtension()}`}},eV=class{constructor(e){const{colModel:t,rowGroupColsSvc:r,colNames:n,valueSvc:i,gos:s,processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c}=e;this.colModel=t,this.rowGroupColsSvc=r,this.colNames=n,this.valueSvc=i,this.gos=s,this.processCellCallback=o,this.processHeaderCallback=a,this.processGroupHeaderCallback=l,this.processRowGroupCallback=c}prepare(e){}extractHeaderValue(e){return this.getHeaderName(this.processHeaderCallback,e)??""}extractRowCellValue(e){const{column:t,node:r,currentColumnIndex:n,accumulatedRowIndex:i,type:s,useRawFormula:o}=e,a=n===0&&JT(this.gos,r,this.colModel.isPivotMode());if(this.processRowGroupCallback&&(this.gos.get("treeData")||r.group)&&(t.isRowGroupDisplayed(r.rowGroupColumn?.getColId()??"")||a))return{value:this.processRowGroupCallback(Dt(this.gos,{column:t,node:r}))??""};if(this.processCellCallback)return{value:this.processCellCallback(Dt(this.gos,{accumulatedRowIndex:i,column:t,node:r,value:this.valueSvc.getValueForDisplay({column:t,node:r}).value,type:s,parseValue:m=>this.valueSvc.parseValue(t,r,m,this.valueSvc.getValue(t,r,void 0)),formatValue:m=>this.valueSvc.formatValue(t,r,m)??m}))??""};const l=this.gos.get("treeData"),c=this.valueSvc,u=r.level===-1&&r.footer,h=t.colDef.showRowGroup===!0&&(r.group||l);if(!u&&(a||h)){let m="",v=r;for(;v&&v.level!==-1;){const{value:g,valueFormatted:w}=c.getValueForDisplay({column:a?void 0:t,node:v,includeValueFormatted:!0,exporting:!0});m=` -> ${w??g??""}${m}`,v=v.parent}return{value:m,valueFormatted:m}}const{value:d,valueFormatted:f}=c.getValueForDisplay({column:t,node:r,includeValueFormatted:!0,exporting:!0,useRawFormula:o});return{value:d??"",valueFormatted:f}}getHeaderName(e,t){return e?e(Dt(this.gos,{column:t})):this.colNames.getDisplayNameForColumn(t,"csv",!0)}};function tV(e,t){const r=document.defaultView||window;if(!r){at(52);return}const n=document.createElement("a"),i=r.URL.createObjectURL(t);n.setAttribute("href",i),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.dispatchEvent(new MouseEvent("click",{bubbles:!1,cancelable:!0,view:r})),n.remove(),r.setTimeout(()=>{r.URL.revokeObjectURL(i)},0)}var rV={enableBrowserTooltips:!0,tooltipTrigger:!0,tooltipMouseTrack:!0,tooltipShowMode:!0,tooltipInteraction:!0,defaultColGroupDef:!0,suppressAutoSize:!0,skipHeaderOnAutoSize:!0,autoSizeStrategy:!0,components:!0,stopEditingWhenCellsLoseFocus:!0,undoRedoCellEditing:!0,undoRedoCellEditingLimit:!0,excelStyles:!0,cacheQuickFilter:!0,customChartThemes:!0,chartThemeOverrides:!0,chartToolPanelsDef:!0,loadingCellRendererSelector:!0,localeText:!0,keepDetailRows:!0,keepDetailRowsCount:!0,detailRowHeight:!0,detailRowAutoHeight:!0,tabIndex:!0,valueCache:!0,valueCacheNeverExpires:!0,enableCellExpressions:!0,suppressTouch:!0,suppressBrowserResizeObserver:!0,suppressPropertyNamesCheck:!0,debug:!0,dragAndDropImageComponent:!0,overlayComponent:!0,suppressOverlays:!0,loadingOverlayComponent:!0,suppressLoadingOverlay:!0,noRowsOverlayComponent:!0,paginationPageSizeSelector:!0,paginateChildRows:!0,pivotPanelShow:!0,pivotSuppressAutoColumn:!0,suppressExpandablePivotGroups:!0,aggFuncs:!0,allowShowChangeAfterFilter:!0,ensureDomOrder:!0,enableRtl:!0,suppressColumnVirtualisation:!0,suppressMaxRenderedRowRestriction:!0,suppressRowVirtualisation:!0,rowDragText:!0,groupLockGroupColumns:!0,suppressGroupRowsSticky:!0,rowModelType:!0,cacheOverflowSize:!0,infiniteInitialRowCount:!0,serverSideInitialRowCount:!0,maxBlocksInCache:!0,maxConcurrentDatasourceRequests:!0,blockLoadDebounceMillis:!0,serverSideOnlyRefreshFilteredGroups:!0,serverSidePivotResultFieldSeparator:!0,viewportRowModelPageSize:!0,viewportRowModelBufferSize:!0,debounceVerticalScrollbar:!0,suppressAnimationFrame:!0,suppressPreventDefaultOnMouseWheel:!0,scrollbarWidth:!0,icons:!0,suppressRowTransform:!0,gridId:!0,enableGroupEdit:!0,initialState:!0,processUnpinnedColumns:!0,createChartContainer:!0,getLocaleText:!0,getRowId:!0,reactiveCustomComponents:!0,renderingMode:!0,columnMenu:!0,suppressSetFilterByDefault:!0,getDataPath:!0,enableCellSpan:!0,enableFilterHandlers:!0,filterHandlers:!0},Di="clientSide",ai="serverSide",gu="infinite",nV={onGroupExpandedOrCollapsed:[Di],refreshClientSideRowModel:[Di],isRowDataEmpty:[Di],forEachLeafNode:[Di],forEachNodeAfterFilter:[Di],forEachNodeAfterFilterAndSort:[Di],resetRowHeights:[Di,ai],applyTransaction:[Di],applyTransactionAsync:[Di],flushAsyncTransactions:[Di],getBestCostNodeSelection:[Di],getServerSideSelectionState:[ai],setServerSideSelectionState:[ai],applyServerSideTransaction:[ai],applyServerSideTransactionAsync:[ai],applyServerSideRowData:[ai],retryServerSideLoads:[ai],flushServerSideAsyncTransactions:[ai],refreshServerSide:[ai],getServerSideGroupLevelState:[ai],refreshInfiniteCache:[gu],purgeInfiniteCache:[gu],getInfiniteRowCount:[gu],isLastRowIndexKnown:[gu,ai],expandAll:[Di,ai],collapseAll:[Di,ai],onRowHeightChanged:[Di,ai],setRowCount:[gu,ai],getCacheBlockState:[gu,ai]},iV={showLoadingOverlay:{version:"v32",message:'`showLoadingOverlay` is deprecated. Use the grid option "loading"=true instead or setGridOption("loading", true).'},clearRangeSelection:{version:"v32.2",message:"Use `clearCellSelection` instead."},getInfiniteRowCount:{version:"v32.2",old:"getInfiniteRowCount()",new:"getDisplayedRowCount()"},selectAllFiltered:{version:"v33",old:"selectAllFiltered()",new:'selectAll("filtered")'},deselectAllFiltered:{version:"v33",old:"deselectAllFiltered()",new:'deselectAll("filtered")'},selectAllOnCurrentPage:{version:"v33",old:"selectAllOnCurrentPage()",new:'selectAll("currentPage")'},deselectAllOnCurrentPage:{version:"v33",old:"deselectAllOnCurrentPage()",new:'deselectAll("currentPage")'}};function sV(e,t,r){const n=iV[e];if(n){const{version:s,new:o,old:a,message:l}=n,c=a??e;return(...u)=>{const h=o?`Please use ${o} instead. `:"";return Gh(`Since ${s} api.${c} is deprecated. ${h}${l??""}`),t.apply(t,u)}}const i=nV[e];return i?(...s)=>{const o=r.rowModel.getType();if(!i.includes(o)){Gu(`api.${e} can only be called when gridOptions.rowModelType is ${i.join(" or ")}`);return}return t.apply(t,s)}:t}var oV={detailCellRendererCtrl:"SharedMasterDetail",dndSourceComp:"DragAndDrop",fillHandle:"CellSelection",groupCellRendererCtrl:"GroupCellRenderer",headerFilterCellCtrl:"ColumnFilter",headerGroupCellCtrl:"ColumnGroup",rangeHandle:"CellSelection",tooltipFeature:"Tooltip",highlightTooltipFeature:"Tooltip",tooltipStateManager:"Tooltip",groupStrategy:"RowGrouping",treeGroupStrategy:"TreeData",rowNumberRowResizer:"RowNumbers",singleCell:"EditCore",fullRow:"EditCore",agSetColumnFilterHandler:"SetFilter",agMultiColumnFilterHandler:"MultiFilter",agGroupColumnFilterHandler:"GroupFilter",agNumberColumnFilterHandler:"NumberFilter",agDateColumnFilterHandler:"DateFilter",agTextColumnFilterHandler:"TextFilter"},aV={expanded:1,contracted:1,"tree-closed":1,"tree-open":1,"tree-indeterminate":1,pin:1,"eye-slash":1,arrows:1,left:1,right:1,group:1,aggregation:1,pivot:1,"not-allowed":1,chart:1,cross:1,cancel:1,tick:1,first:1,previous:1,next:1,last:1,linked:1,unlinked:1,"color-picker":1,loading:1,menu:1,"menu-alt":1,filter:1,"filter-add":1,columns:1,maximize:1,minimize:1,copy:1,cut:1,paste:1,grip:1,save:1,csv:1,excel:1,"small-down":1,"small-left":1,"small-right":1,"small-up":1,asc:1,desc:1,aasc:1,adesc:1,none:1,up:1,down:1,plus:1,minus:1,settings:1,"checkbox-checked":1,"checkbox-indeterminate":1,"checkbox-unchecked":1,"radio-button-on":1,"radio-button-off":1,eye:1,"column-arrow":1,"un-pin":1,"pinned-top":1,"pinned-bottom":1,"chevron-up":1,"chevron-down":1,"chevron-left":1,"chevron-right":1,edit:1},lV={chart:"MenuCore",cancel:"EnterpriseCore",first:"Pagination",previous:"Pagination",next:"Pagination",last:"Pagination",linked:"IntegratedCharts",loadingMenuItems:"MenuCore",unlinked:"IntegratedCharts",menu:"ColumnHeaderComp",legacyMenu:"ColumnMenu",filter:"ColumnFilter",filterActive:"ColumnFilter",filterAdd:"NewFiltersToolPanel",filterCardCollapse:"NewFiltersToolPanel",filterCardExpand:"NewFiltersToolPanel",filterCardEditing:"NewFiltersToolPanel",filterTab:"ColumnMenu",filtersToolPanel:"FiltersToolPanel",columns:["MenuCore"],columnsToolPanel:["ColumnsToolPanel"],maximize:"EnterpriseCore",minimize:"EnterpriseCore",save:"MenuCore",columnGroupOpened:"ColumnGroupHeaderComp",columnGroupClosed:"ColumnGroupHeaderComp",accordionOpen:"EnterpriseCore",accordionClosed:"EnterpriseCore",accordionIndeterminate:"EnterpriseCore",columnSelectClosed:["ColumnsToolPanel","ColumnMenu"],columnSelectOpen:["ColumnsToolPanel","ColumnMenu"],columnSelectIndeterminate:["ColumnsToolPanel","ColumnMenu"],columnMovePin:"SharedDragAndDrop",columnMoveHide:"SharedDragAndDrop",columnMoveMove:"SharedDragAndDrop",columnMoveLeft:"SharedDragAndDrop",columnMoveRight:"SharedDragAndDrop",columnMoveGroup:"SharedDragAndDrop",columnMoveValue:"SharedDragAndDrop",columnMovePivot:"SharedDragAndDrop",dropNotAllowed:"SharedDragAndDrop",ensureColumnVisible:["ColumnsToolPanel","ColumnMenu"],groupContracted:"GroupCellRenderer",groupExpanded:"GroupCellRenderer",setFilterGroupClosed:"SetFilter",setFilterGroupOpen:"SetFilter",setFilterGroupIndeterminate:"SetFilter",setFilterLoading:"SetFilter",close:"EnterpriseCore",check:"MenuItem",colorPicker:"CommunityCore",groupLoading:"LoadingCellRenderer",overlayLoading:"Overlay",overlayExporting:"Overlay",menuAlt:"ColumnHeaderComp",menuPin:"MenuCore",menuValue:"MenuCore",menuAddRowGroup:["MenuCore","ColumnsToolPanel"],menuRemoveRowGroup:["MenuCore","ColumnsToolPanel"],clipboardCopy:"MenuCore",clipboardCut:"MenuCore",clipboardPaste:"MenuCore",pivotPanel:["ColumnsToolPanel","RowGroupingPanel"],rowGroupPanel:["ColumnsToolPanel","RowGroupingPanel"],valuePanel:"ColumnsToolPanel",columnDrag:"EnterpriseCore",rowDrag:["RowDrag","DragAndDrop"],csvExport:"MenuCore",excelExport:"MenuCore",smallDown:"CommunityCore",selectOpen:"CommunityCore",richSelectOpen:"RichSelect",richSelectRemove:"RichSelect",richSelectLoading:"RichSelect",smallLeft:"CommunityCore",smallRight:"CommunityCore",subMenuOpen:"MenuItem",subMenuOpenRtl:"MenuItem",panelDelimiter:"RowGroupingPanel",panelDelimiterRtl:"RowGroupingPanel",smallUp:"CommunityCore",sortAscending:["MenuCore","Sort"],sortDescending:["MenuCore","Sort"],sortAbsoluteAscending:["MenuCore","Sort"],sortAbsoluteDescending:["MenuCore","Sort"],sortUnSort:["MenuCore","Sort"],advancedFilterBuilder:"AdvancedFilter",advancedFilterBuilderDrag:"AdvancedFilter",advancedFilterBuilderInvalid:"AdvancedFilter",advancedFilterBuilderMoveUp:"AdvancedFilter",advancedFilterBuilderMoveDown:"AdvancedFilter",advancedFilterBuilderAdd:"AdvancedFilter",advancedFilterBuilderRemove:"AdvancedFilter",advancedFilterBuilderSelectOpen:"AdvancedFilter",chartsMenu:"IntegratedCharts",chartsMenuEdit:"IntegratedCharts",chartsMenuAdvancedSettings:"IntegratedCharts",chartsMenuAdd:"IntegratedCharts",chartsColorPicker:"IntegratedCharts",chartsThemePrevious:"IntegratedCharts",chartsThemeNext:"IntegratedCharts",chartsDownload:"IntegratedCharts",checkboxChecked:"CommunityCore",checkboxIndeterminate:"CommunityCore",checkboxUnchecked:"CommunityCore",radioButtonOn:"CommunityCore",radioButtonOff:"CommunityCore",rowPin:"PinnedRow",rowUnpin:"PinnedRow",rowPinBottom:"PinnedRow",rowPinTop:"PinnedRow"},cV=new Set(["colorPicker","smallUp","checkboxChecked","checkboxIndeterminate","checkboxUnchecked","radioButtonOn","radioButtonOff","smallDown","smallLeft","smallRight"]),uV=class extends et{constructor(){super(...arguments),this.beanName="validation"}wireBeans(e){this.gridOptions=e.gridOptions,_D(zj)}warnOnInitialPropertyUpdate(e,t){e==="api"&&rV[t]&&at(22,{key:t})}processGridOptions(e){this.processOptions(e,KB())}validateApiFunction(e,t){return sV(e,t,this.beans)}missingUserComponent(e,t,r,n){const i=Ju[t];i?this.gos.assertModuleRegistered(i,`AG Grid '${e}' component: ${t}`):at(101,{propertyName:e,componentName:t,agGridDefaults:r,jsComps:n})}missingDynamicBean(e){const t=oV[e];return t?_o(200,{...this.gos.getModuleErrorParams(),moduleName:t,reasonOrId:e}):void 0}checkRowEvents(e){hV.has(e)&&at(10,{eventType:e})}validateIcon(e){if(cV.has(e)&&at(43,{iconName:e}),aV[e])return;const t=lV[e];if(t){Ar(200,{reasonOrId:`icon '${e}'`,moduleName:t,gridScoped:fy(),gridId:this.beans.context.getId(),rowModelType:this.gos.get("rowModelType"),additionalText:"Alternatively, use the CSS icon name directly."});return}at(134,{iconName:e})}isProvidedUserComp(e){return!!Ju[e]}validateColDef(e){this.processOptions(e,LB())}processOptions(e,t){const{validations:r,deprecations:n,allProperties:i,propertyExceptions:s,objectName:o,docsUrl:a}=t;i&&this.gridOptions.suppressPropertyNamesCheck!==!0&&this.checkProperties(e,[...s??[],...Object.keys(n)],i,o,a);const l=new Set;if(Object.keys(e).forEach(u=>{const h=n[u];if(h){const{message:y,version:C}=h;l.add(`As of v${C}, ${String(u)} is deprecated. ${y??""}`)}const d=e[u];if(d==null||d===!1)return;const f=r[u];if(!f)return;const{dependencies:m,validate:v,supportedRowModels:g,expectedType:w}=f;if(w){const y=typeof d;if(y!==w){l.add(`${String(u)} should be of type '${w}' but received '${y}' (${d}).`);return}}if(g){const y=this.gridOptions.rowModelType??"clientSide";if(!g.includes(y)){l.add(`${String(u)} is not supported with the '${y}' row model. It is only valid with: ${g.join(", ")}.`);return}}if(m){const y=this.checkForRequiredDependencies(u,m,e);if(y){l.add(y);return}}if(v){const y=v(e,this.gridOptions,this.beans);if(y){l.add(y);return}}}),l.size>0)for(const u of l)Gh(u)}checkForRequiredDependencies(e,t,r){const i=Object.entries(t).filter(([s,o])=>{const a=r[s];return!o.required.includes(a)});return i.length===0?null:i.map(([s,o])=>`'${String(e)}' requires '${s}' to be one of [${o.required.map(a=>a===null?"null":a===void 0?"undefined":a).join(", ")}]. ${o.reason??""}`).join(`
           `)}checkProperties(e,t,r,n,i){const s=["__ob__","__v_skip","__metadata__"],o=dV(Object.getOwnPropertyNames(e),[...s,...t,...r],r),a=Object.keys(o);for(const l of a){const c=o[l];let u=`invalid ${n} property '${l}' did you mean any of these: ${c.slice(0,8).join(", ")}.`;r.includes("context")&&(u+=`
If you are trying to annotate ${n} with application data, use the '${n}.context' property instead.`),Gh(u)}if(a.length>0&&i){const l=this.beans.frameworkOverrides.getDocLink(i);Gh(`to see all the valid ${n} properties please check: ${l}`)}}};function dV(e,t,r){const n={},i=e.filter(s=>!t.some(o=>o===s));if(i.length>0)for(const s of i)n[s]=uw({inputValue:s,allSuggestions:r}).values;return n}var hV=new Set(["firstChildChanged","lastChildChanged","childIndexChanged"]),fV={moduleName:"Validation",version:wt,beans:[uV]};function _w(e){const t=e.sibling;t&&(t.childrenAfterFilter=e.childrenAfterFilter)}var pV=class extends et{constructor(){super(...arguments),this.beanName="filterStage",this.step="filter",this.refreshProps=["excludeChildrenWhenTreeDataFiltering"]}wireBeans(e){this.filterManager=e.filterManager}execute(e){const t=!!this.filterManager?.isChildFilterPresent();this.beans.formula?.active?this.softFilter(t,e):this.filterNodes(t,e)}filterNodes(e,t){const r=(n,i)=>{n.hasChildren()&&e&&!i?n.childrenAfterFilter=n.childrenAfterGroup.filter(s=>{const o=s.childrenAfterFilter&&s.childrenAfterFilter.length>0,a=s.data&&this.filterManager.doesRowPassFilter({rowNode:s});return o||a}):n.childrenAfterFilter=n.childrenAfterGroup,_w(n)};if(this.doingTreeDataFiltering()){const n=(s,o)=>{if(s.childrenAfterGroup)for(let a=0;a<s.childrenAfterGroup.length;a++){const l=s.childrenAfterGroup[a],c=o||this.filterManager.doesRowPassFilter({rowNode:l});l.childrenAfterGroup?n(s.childrenAfterGroup[a],c):r(l,c)}r(s,o)},i=s=>n(s,!1);t.executeFromRootNode(i)}else{const n=i=>r(i,!1);t.forEachChangedNodeDepthFirst(n,!0)}}softFilter(e,t){const r=n=>{if(n.childrenAfterFilter=n.childrenAfterGroup,n.hasChildren())for(const i of n.childrenAfterGroup)i.softFiltered=e&&!(i.data&&this.filterManager.doesRowPassFilter({rowNode:i}));_w(n)};t.forEachChangedNodeDepthFirst(r,!0)}doingTreeDataFiltering(){const{gos:e}=this;return e.get("treeData")&&!e.get("excludeChildrenWhenTreeDataFiltering")}},gV=class extends Ly{constructor(){super(...arguments),this.iconCreated=!1}wireComp(e,t,r,n,i){this.comp=e;const s=Vf(this,this.beans.context,i);this.eButtonShowMainFilter=r,this.eFloatingFilterBody=n,this.setGui(t,s),this.setupActive(),this.refreshHeaderStyles(),this.setupWidth(s),this.setupLeft(s),this.setupHover(s),this.setupFocus(s),this.setupAria(),this.setupFilterButton(),this.setupUserComp(),this.setupSyncWithFilter(s),this.setupUi(),s.addManagedElementListeners(this.eButtonShowMainFilter,{click:this.showParentFilter.bind(this)}),this.setupFilterChangedListener(s);const o=()=>this.onColDefChanged(s);s.addManagedListeners(this.column,{colDefChanged:o}),s.addManagedEventListeners({filterSwitched:({column:a})=>{a===this.column&&o()}}),s.addDestroyFunc(()=>{this.eButtonShowMainFilter=null,this.eFloatingFilterBody=null,this.userCompDetails=null,this.clearComponent()})}resizeHeader(){}moveHeader(){}getHeaderClassParams(){const{column:e,beans:t}=this,r=e.colDef;return Dt(t.gos,{colDef:r,column:e,floatingFilter:!0})}setupActive(){const e=this.column.getColDef(),t=!!e.filter,r=!!e.floatingFilter;this.active=t&&r}setupUi(){if(this.comp.setButtonWrapperDisplayed(!this.suppressFilterButton&&this.active),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-full-body",this.suppressFilterButton),this.comp.addOrRemoveBodyCssClass("ag-floating-filter-body",!this.suppressFilterButton),!this.active||this.iconCreated)return;const e=Li("filter",this.beans,this.column);e&&(this.iconCreated=!0,this.eButtonShowMainFilter.appendChild(e))}setupFocus(e){e.createManagedBean(new zf(this.eGui,{shouldStopEventPropagation:this.shouldStopEventPropagation.bind(this),onTabKeyDown:this.onTabKeyDown.bind(this),handleKeyDown:this.handleKeyDown.bind(this),onFocusIn:this.onFocusIn.bind(this)}))}setupAria(){const e=this.getLocaleTextFunc();ad(this.eButtonShowMainFilter,e("ariaFilterMenuOpen","Open Filter Menu"))}onTabKeyDown(e){const{beans:t}=this;if(tn(t)===this.eGui)return;const i=Mc(t,this.eGui,null,e.shiftKey);if(i){t.headerNavigation?.scrollToColumn(this.column),e.preventDefault(),i.focus();return}const s=this.findNextColumnWithFloatingFilter(e.shiftKey);s&&t.focusSvc.focusHeaderPosition({headerPosition:{headerRowIndex:this.rowCtrl.rowIndex,column:s},event:e})&&e.preventDefault()}findNextColumnWithFloatingFilter(e){const t=this.beans.visibleCols;let r=this.column;do if(r=e?t.getColBefore(r):t.getColAfter(r),!r)break;while(!r.getColDef().filter||!r.getColDef().floatingFilter);return r}handleKeyDown(e){super.handleKeyDown(e);const t=this.getWrapperHasFocus();switch(e.key){case $e.UP:case $e.DOWN:case $e.LEFT:case $e.RIGHT:if(t)return;wc(e);case $e.ENTER:t&&bc(this.eGui)&&e.preventDefault();break;case $e.ESCAPE:t||this.eGui.focus()}}onFocusIn(e){if(this.eGui.contains(e.relatedTarget))return;const r=!!e.relatedTarget&&!e.relatedTarget.classList.contains("ag-floating-filter"),n=!!e.relatedTarget&&nc(e.relatedTarget,"ag-floating-filter");if(r&&n&&e.target===this.eGui){const i=this.lastFocusEvent,s=!!(i&&i.key===$e.TAB);if(i&&s){const o=i.shiftKey;bc(this.eGui,o)}}this.focusThis()}setupHover(e){this.beans.colHover?.addHeaderFilterColumnHoverListener(e,this.comp,this.column,this.eGui)}setupLeft(e){const t=new Ny(this.column,this.eGui,this.beans);e.createManagedBean(t)}setupFilterButton(){this.suppressFilterButton=!this.beans.menuSvc?.isFloatingFilterButtonEnabled(this.column),this.highlightFilterButtonWhenActive=!rs(this.gos)}setupUserComp(){if(!this.active)return;const e=this.beans.colFilter?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter());e&&this.setCompDetails(e)}setCompDetails(e){this.userCompDetails=e,this.comp.setCompDetails(e)}showParentFilter(){const e=this.suppressFilterButton?this.eFloatingFilterBody:this.eButtonShowMainFilter;this.beans.menuSvc?.showFilterMenu({column:this.column,buttonElement:e,containerType:"floatingFilter",positionBy:"button"})}setupSyncWithFilter(e){if(!this.active)return;const{beans:{colFilter:t},column:r,gos:n}=this,i=s=>{if(s?.source==="filterDestroyed"&&(!this.isAlive()||!t?.isAlive()))return;const o=this.comp.getFloatingFilterComp();o&&o.then(a=>{if(a){if(n.get("enableFilterHandlers")){const u=s;let h="filter";u?.afterFloatingFilter?h="ui":u?.afterDataChange?h="dataChanged":s?.source==="api"&&(h="api"),this.updateFloatingFilterParams(this.userCompDetails,h);return}const l=t?.getCurrentFloatingFilterParentModel(r),c=s?{...s,columns:s.columns??[],source:s.source==="api"?"api":"columnFilter"}:null;a.onParentModelChanged(l,c)}})};[this.destroySyncListener]=e.addManagedListeners(r,{filterChanged:i}),t?.isFilterActive(r)&&i(null)}setupWidth(e){const t=()=>{const r=`${this.column.getActualWidth()}px`;this.comp.setWidth(r)};e.addManagedListeners(this.column,{widthChanged:t}),t()}setupFilterChangedListener(e){this.active&&([this.destroyFilterChangedListener]=e.addManagedListeners(this.column,{filterChanged:this.updateFilterButton.bind(this)}),this.updateFilterButton())}updateFilterButton(){if(!this.suppressFilterButton&&this.comp){const e=!!this.beans.filterManager?.isFilterAllowed(this.column);this.comp.setButtonWrapperDisplayed(e),this.highlightFilterButtonWhenActive&&e&&this.eButtonShowMainFilter.classList.toggle("ag-filter-active",this.column.isFilterActive())}}onColDefChanged(e){const t=this.active;this.setupActive();const r=!t&&this.active;t&&!this.active&&(this.destroySyncListener(),this.destroyFilterChangedListener());const n=this.beans.colFilter,i=this.active?n?.getFloatingFilterCompDetails(this.column,()=>this.showParentFilter()):null,s=this.comp.getFloatingFilterComp();!s||!i?this.updateCompDetails(e,i,r):s.then(o=>{!o||n?.areFilterCompsDifferent(this.userCompDetails??null,i)?this.updateCompDetails(e,i,r):this.updateFloatingFilterParams(i,"colDef")})}updateCompDetails(e,t,r){this.isAlive()&&(this.setCompDetails(t),this.setupFilterButton(),this.setupUi(),r&&(this.setupSyncWithFilter(e),this.setupFilterChangedListener(e)))}updateFloatingFilterParams(e,t){if(!e)return;let r=e.params;this.comp.getFloatingFilterComp()?.then(n=>{typeof n?.refresh=="function"&&(this.gos.get("enableFilterHandlers")&&(r={...r,model:Hn(this.beans.colFilter?.model??{},this.column.getColId()),source:t}),n.refresh(r))})}addResizeAndMoveKeyboardListeners(){}destroy(){super.destroy(),this.destroySyncListener=null,this.destroyFilterChangedListener=null}};function mV(e,t){const r=e.colModel.getCol(t);if(!r){Ar(12,{colKey:t});return}e.menuSvc?.showColumnMenu({column:r,positionBy:"auto"})}function vV(e){e.menuSvc?.hidePopupMenu()}var bV={moduleName:"SharedMenu",version:wt,beans:[zI],apiFunctions:{showColumnMenu:mV,hidePopupMenu:vV}},wV=class extends v9{getDefaultPopupParent(){return this.beans.ctrlsSvc.get("gridCtrl").getGui()}callPostProcessPopup(e,t,r,n,i){const s=this.gos.getCallback("postProcessPopup");if(s){const{column:o,rowNode:a}=e??{};s({column:o,rowNode:a,ePopup:r,type:t,eventSource:n,mouseEvent:i})}}getActivePopups(){return this.popupList.map(e=>e.element)}hasAnchoredPopup(){return this.popupList.some(e=>e.isAnchored)}isStopPropagation(e){return na(e)}},hm={moduleName:"Popup",version:wt,beans:[wV]},yV=".ag-set-filter{--ag-indentation-level:0}.ag-set-filter-item{align-items:center;display:flex;height:100%}:where(.ag-ltr) .ag-set-filter-item{padding-left:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}:where(.ag-rtl) .ag-set-filter-item{padding-right:calc(var(--ag-widget-container-horizontal-padding) + var(--ag-indentation-level)*var(--ag-set-filter-indent-size))}.ag-set-filter-item-checkbox{display:flex;height:100%;width:100%}.ag-set-filter-group-icons{display:block;>*{cursor:pointer}}:where(.ag-ltr) .ag-set-filter-group-icons{margin-right:var(--ag-widget-container-horizontal-padding)}:where(.ag-rtl) .ag-set-filter-group-icons{margin-left:var(--ag-widget-container-horizontal-padding)}.ag-filter-body-wrapper{display:flex;flex-direction:column}:where(.ag-menu:not(.ag-tabs) .ag-filter) .ag-filter-body-wrapper,:where(.ag-menu:not(.ag-tabs) .ag-filter)>:not(.ag-filter-wrapper){min-width:180px}.ag-filter-filter{flex:1 1 0px}.ag-filter-condition{display:flex;justify-content:center}.ag-floating-filter-body{display:flex;flex:1 1 auto;height:100%;position:relative}.ag-floating-filter-full-body{align-items:center;display:flex;flex:1 1 auto;height:100%;overflow:hidden;width:100%}:where(.ag-floating-filter-full-body)>div{flex:1 1 auto}.ag-floating-filter-input{align-items:center;display:flex;width:100%;>*{flex:1 1 auto}:where(.ag-input-field-input[type=date]),:where(.ag-input-field-input[type=datetime-local]){width:1px}}.ag-floating-filter-button{display:flex;flex:none}.ag-date-floating-filter-wrapper{display:flex}.ag-set-floating-filter-input :where(input)[disabled]{pointer-events:none}.ag-floating-filter-button-button{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;height:var(--ag-icon-size);width:var(--ag-icon-size)}.ag-filter-loading{align-items:unset;background-color:var(--ag-chrome-background-color);height:100%;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;width:100%;z-index:1;:where(.ag-menu) &{background-color:var(--ag-menu-background-color)}}.ag-filter-separator{border-top:solid var(--ag-border-width) var(--menu-separator-color)}:where(.ag-filter-select) .ag-picker-field-wrapper{width:0}.ag-filter-condition-operator{height:17px}:where(.ag-ltr) .ag-filter-condition-operator-or{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-condition-operator-or{margin-right:calc(var(--ag-spacing)*2)}.ag-set-filter-select-all{padding-top:var(--ag-widget-container-vertical-padding)}.ag-filter-no-matches,.ag-set-filter-list{height:calc(var(--ag-list-item-height)*6)}.ag-filter-no-matches{padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}.ag-set-filter-tree-list{height:calc(var(--ag-list-item-height)*10)}.ag-set-filter-filter{margin-left:var(--ag-widget-container-horizontal-padding);margin-right:var(--ag-widget-container-horizontal-padding);margin-top:var(--ag-widget-container-vertical-padding)}.ag-filter-to{margin-top:var(--ag-widget-vertical-spacing)}.ag-mini-filter{margin:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}:where(.ag-ltr) .ag-set-filter-add-group-indent{margin-left:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-rtl) .ag-set-filter-add-group-indent{margin-right:calc(var(--ag-icon-size) + var(--ag-widget-container-horizontal-padding))}:where(.ag-filter-menu) .ag-set-filter-list{min-width:200px}.ag-filter-virtual-list-item:focus-visible{box-shadow:inset var(--ag-focus-shadow)}.ag-filter-apply-panel{display:flex;justify-content:flex-end;overflow:hidden;padding:var(--ag-widget-vertical-spacing) var(--ag-widget-container-horizontal-padding) var(--ag-widget-container-vertical-padding)}.ag-filter-apply-panel-button{line-height:1.5}:where(.ag-ltr) .ag-filter-apply-panel-button{margin-left:calc(var(--ag-spacing)*2)}:where(.ag-rtl) .ag-filter-apply-panel-button{margin-right:calc(var(--ag-spacing)*2)}.ag-simple-filter-body-wrapper{display:flex;flex-direction:column;min-height:calc(var(--ag-list-item-height) + var(--ag-widget-container-vertical-padding) + var(--ag-widget-vertical-spacing));overflow-y:auto;padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);padding-bottom:calc(var(--ag-widget-container-vertical-padding) - var(--ag-widget-vertical-spacing));&>*{margin-bottom:var(--ag-widget-vertical-spacing)}:where(.ag-resizer-wrapper){margin:0}}.ag-multi-filter-menu-item{margin:var(--ag-spacing) 0}.ag-multi-filter-group-title-bar{background-color:transparent;color:var(--ag-header-text-color);font-weight:500;padding:calc(var(--ag-spacing)*1.5) var(--ag-spacing)}.ag-group-filter-field-select-wrapper{display:flex;flex-direction:column;gap:var(--ag-widget-vertical-spacing);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding)}";function CV(e){const t=e.filterManager;return!!t?.isColumnFilterPresent()||!!t?.isAggregateFilterPresent()}function xV(e,t){return e.filterManager?.getColumnFilterInstance(t)??Promise.resolve(void 0)}function SV(e,t){const r=e.colModel.getColDefCol(t);if(r)return e.colFilter?.destroyFilter(r,"api")}function _V(e,t){e.frameworkOverrides.wrapIncoming(()=>e.filterManager?.setFilterModel(t))}function EV(e){return e.filterManager?.getFilterModel()??{}}function TV(e,t,r){const{gos:n,colModel:i,colFilter:s}=e;r&&!n.get("enableFilterHandlers")&&(at(288),r=!1);const o=i.getColDefCol(t);return o?s?.getModelForColumn(o,r)??null:null}function kV(e,t,r){return e.filterManager?.setColumnFilterModel(t,r)??Promise.resolve()}function RV(e,t){const r=e.colModel.getCol(t);if(!r){Ar(12,{colKey:t});return}e.menuSvc?.showFilterMenu({column:r,containerType:"columnFilter",positionBy:"auto"})}function AV(e){e.menuSvc?.hideFilterMenu()}function FV(e,t){const r=e.colModel.getCol(t);if(!r){Ar(12,{colKey:t});return}return e.colFilter?.getHandler(r,!0)}function MV(e,t){const{colModel:r,colFilter:n,gos:i}=e;if(!i.get("enableFilterHandlers")){at(287);return}const{colId:s,action:o}=t;if(s){const a=r.getColById(s);a&&n?.updateModel(a,o)}else n?.updateAllModels(o)}var DV={filterHandler:()=>({doesFilterPass:()=>!0})},PV=class extends et{constructor(){super(...arguments),this.beanName="colFilter",this.allColumnFilters=new Map,this.allColumnListeners=new Map,this.activeAggregateFilters=[],this.activeColumnFilters=[],this.processingFilterChange=!1,this.modelUpdates=[],this.columnModelUpdates=[],this.state=new Map,this.handlerMap={...zk},this.isGlobalButtons=!1,this.activeFilterComps=new Set}postConstruct(){this.addManagedEventListeners({gridColumnsChanged:this.onColumnsChanged.bind(this),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)});const e=this.gos,t={...e.get("initialState")?.filter?.filterModel??{}};this.initialModel=t,this.model={...t},e.get("enableFilterHandlers")||delete this.handlerMap.agMultiColumnFilter}refreshModel(){this.onNewRowsLoaded("rowDataUpdated")}setModel(e,t="api",r){const{colModel:n,dataTypeSvc:i,filterManager:s}=this.beans;if(i?.isPendingInference){this.modelUpdates.push({model:e,source:t});return}const o=[],a=this.getModel(!0);if(e){const l=new Set(Object.keys(e));this.allColumnFilters.forEach((c,u)=>{const h=e[u];o.push(this.setModelOnFilterWrapper(c,h)),l.delete(u)}),l.forEach(c=>{const u=n.getColDefCol(c)||n.getCol(c);if(!u){at(62,{colId:c});return}if(!u.isFilterAllowed()){at(63,{colId:c});return}const h=this.getOrCreateFilterWrapper(u,!0);if(!h){at(64,{colId:c});return}o.push(this.setModelOnFilterWrapper(h,e[c],!0))})}else this.model={},this.allColumnFilters.forEach(l=>{o.push(this.setModelOnFilterWrapper(l,null))});hr.all(o).then(()=>{const l=this.getModel(!0),c=[];this.allColumnFilters.forEach((u,h)=>{const d=a?a[h]:null,f=l?l[h]:null;of(d,f)||c.push(u.column)}),c.length>0?s?.onFilterChanged({columns:c,source:t}):r&&this.updateActive("filterChanged")})}getModel(e){const t={},{allColumnFilters:r,initialModel:n,beans:{colModel:i}}=this;if(r.forEach((s,o)=>{const a=this.getModelFromFilterWrapper(s);bt(a)&&(t[o]=a)}),!e)for(const s of Object.keys(n)){const o=n[s];bt(o)&&!r.has(s)&&i.getCol(s)?.isFilterAllowed()&&(t[s]=o)}return t}setState(e,t,r="api"){if(this.state.clear(),t)for(const n of Object.keys(t)){const i=t[n];this.state.set(n,{model:Hn(this.model,n),state:i})}this.setModel(e,r,!0)}getState(){const e=this.state;if(!e.size)return;const t={};let r=!1;return e.forEach((n,i)=>{const s=n.state;s!=null&&(r=!0,t[i]=s)}),r?t:void 0}getModelFromFilterWrapper(e){const r=e.column.getColId();if(e.isHandler)return Hn(this.model,r);const n=e.filter;return n?typeof n.getModel!="function"?(at(66),null):n.getModel():Hn(this.initialModel,r)}isFilterPresent(){return this.activeColumnFilters.length>0}isAggFilterPresent(){return!!this.activeAggregateFilters.length}disableFilters(){this.initialModel={};const{allColumnFilters:e}=this;return e.size?(e.forEach(t=>this.disposeFilterWrapper(t,"advancedFilterEnabled")),!0):!1}updateActiveFilters(){const e=c=>c?c.isFilterActive?c.isFilterActive():(at(67),!1):!1,{colModel:t,gos:r}=this.beans,n=!!rw(r),i=c=>{if(!c.isPrimary())return!0;const h=!t.isPivotActive();return!c.isValueActive()||!h?!1:t.isPivotMode()?!0:n},s=[],o=[],a=(c,u,h)=>{u&&(i(c)?s.push(h):o.push(h))},l=[];return this.allColumnFilters.forEach(c=>{const u=c.column,h=u.getColId();if(c.isHandler)l.push(hr.resolve().then(()=>{a(u,this.isHandlerActive(u),{colId:h,isHandler:!0,handler:c.handler,handlerParams:c.handlerParams})}));else{const d=qa(c);d&&l.push(d.then(f=>{a(u,e(f),{colId:h,isHandler:!1,comp:f})}))}}),hr.all(l).then(()=>{this.activeAggregateFilters=s,this.activeColumnFilters=o})}updateFilterFlagInColumns(e,t){const r=[];return this.allColumnFilters.forEach(n=>{const i=n.column;if(n.isHandler)r.push(hr.resolve().then(()=>{this.setColFilterActive(i,this.isHandlerActive(i),e,t)}));else{const s=qa(n);s&&r.push(s.then(o=>{this.setColFilterActive(i,o.isFilterActive(),e,t)}))}}),this.beans.groupFilter?.updateFilterFlags(e,t),hr.all(r)}doFiltersPass(e,t,r){const{data:n,aggData:i}=e,s=r?this.activeAggregateFilters:this.activeColumnFilters,o=r?i:n,a=this.model;for(let l=0;l<s.length;l++){const c=s[l],{colId:u,isHandler:h}=c;if(u!==t)if(h){const{handler:d,handlerParams:f}=c;if(!d.doesFilterPass({node:e,data:o,model:Hn(a,u),handlerParams:f}))return!1}else{const d=c.comp;if(typeof d.doesFilterPass!="function"){Ar(91);continue}if(!d.doesFilterPass({node:e,data:o}))return!1}}return!0}getHandlerParams(e){const t=this.allColumnFilters.get(e.getColId());return t?.isHandler?t.handlerParams:void 0}callOnFilterChangedOutsideRenderCycle(e){const{rowRenderer:t,filterManager:r}=this.beans,n=()=>{this.isAlive()&&r?.onFilterChanged(e)};t.isRefreshInProgress()?setTimeout(n,0):n()}updateBeforeFilterChanged(e={}){const{column:t,additionalEventAttributes:r}=e,n=t?.getColId();return this.updateActiveFilters().then(()=>this.updateFilterFlagInColumns("filterChanged",r).then(()=>{this.allColumnFilters.forEach(i=>{const{column:s,isHandler:o}=i;n!==s.getColId()&&(o&&i.handler.onAnyFilterChanged?.(),qa(i,o)?.then(a=>{typeof a?.onAnyFilterChanged=="function"&&a.onAnyFilterChanged()}))}),this.processingFilterChange=!0}))}updateAfterFilterChanged(){this.processingFilterChange=!1}isSuppressFlashingCellsBecauseFiltering(){return!(this.gos.get("allowShowChangeAfterFilter")??!1)&&this.processingFilterChange}onNewRowsLoaded(e){const t=[];this.allColumnFilters.forEach(r=>{const n=r.isHandler;n&&r.handler.onNewRowsLoaded?.();const i=qa(r,n);i&&t.push(i.then(s=>{s.onNewRowsLoaded?.()}))}),hr.all(t).then(()=>this.updateActive(e,{afterDataChange:!0}))}updateActive(e,t){this.updateFilterFlagInColumns(e,t).then(()=>this.updateActiveFilters())}createGetValue(e,t){const{filterValueSvc:r,colModel:n}=this.beans;return(i,s)=>{const o=s?n.getCol(s):e;return o?r.getValue(o,i,t):void 0}}isFilterActive(e){const t=this.cachedFilter(e);if(t?.isHandler)return this.isHandlerActive(e);const r=t?.filter;return r?r.isFilterActive():Hn(this.initialModel,e.getColId())!=null}isHandlerActive(e){const t=bt(Hn(this.model,e.getColId()));if(t)return t;const r=this.beans.groupFilter;return r?.isGroupFilter(e)?r.isFilterActive(e):!1}getOrCreateFilterUi(e){const t=this.getOrCreateFilterWrapper(e,!0);return t?qa(t):null}getFilterUiForDisplay(e){const t=this.getOrCreateFilterWrapper(e,!0);if(!t)return null;const r=qa(t);return r?r.then(n=>({comp:n,params:t.filterUi.filterParams,isHandler:t.isHandler})):null}getHandler(e,t){const r=this.getOrCreateFilterWrapper(e,t);return r?.isHandler?r.handler:void 0}getOrCreateFilterWrapper(e,t){if(!e.isFilterAllowed())return;let r=this.cachedFilter(e);return!r&&t&&(r=this.createFilterWrapper(e),this.setColumnFilterWrapper(e,r)),r}cachedFilter(e){return this.allColumnFilters.get(e.getColId())}getDefaultFilter(e,t=!1){return this.getDefaultFilterFromDataType(()=>this.beans.dataTypeSvc?.getBaseDataType(e),t)}getDefaultFilterFromDataType(e,t=!1){return VD(this.gos)?t?"agSetColumnFloatingFilter":"agSetColumnFilter":z9(e(),t)}getDefaultFloatingFilter(e){return this.getDefaultFilter(e,!0)}createFilterComp(e,t,r,n,i,s){const o=()=>{const c=this.createFilterCompParams(e,i,s),u=n(c,i);return KP(this.beans.userCompFactory,t,u,r)},a=o();return a?{compDetails:a,createFilterUi:c=>(c?o():a).newAgStackInstance()}:null}createFilterInstance(e,t,r,n){const i=this.beans.selectableFilter;i?.isSelectable(t)&&(t=i.getFilterDef(e,t));const{handler:s,handlerParams:o,handlerGenerator:a}=this.createHandler(e,t,r)??{},l=this.createFilterComp(e,t,r,n,!!s,"init");if(!l)return{compDetails:null,createFilterUi:null,handler:s,handlerGenerator:a,handlerParams:o};const{compDetails:c,createFilterUi:u}=l;return this.isGlobalButtons&&(c.params?.buttons?.length||at(281,{colId:e.getColId()})),{compDetails:c,handler:s,handlerGenerator:a,handlerParams:o,createFilterUi:u}}createBaseFilterParams(e,t){const{filterManager:r,rowModel:n}=this.beans;return Dt(this.gos,{column:e,colDef:e.getColDef(),getValue:this.createGetValue(e),doesRowPassOtherFilter:t?()=>!0:i=>r?.doesRowPassOtherFilters(e.getColId(),i)??!0,rowModel:n})}createFilterCompParams(e,t,r,n){const i=this.filterChangedCallbackFactory(e),s=this.createBaseFilterParams(e,n);if(s.filterChangedCallback=i,s.filterModifiedCallback=n?()=>{}:o=>this.filterModified(e,o),t){const o=s,a=e.getColId(),l=Hn(this.model,a);o.model=l,o.state=this.state.get(a)??{model:l},o.onModelChange=(c,u)=>{this.updateStoredModel(a,c),this.refreshHandlerAndUi(e,c,"ui",!1,u).then(()=>{i({...u,source:"columnFilter"})})},o.onStateChange=c=>{this.updateState(e,c),this.updateOrRefreshFilterUi(e)},o.onAction=(c,u,h)=>{this.updateModel(e,c,u),this.dispatchLocalEvent({type:"filterAction",column:e,action:c,event:h})},o.getHandler=()=>this.getHandler(e,!0),o.onUiChange=c=>this.filterUiChanged(e,c),o.source=r}return s}createFilterUiForHandler(e,t){return t?{created:!1,create:t,filterParams:e.params,compDetails:e}:null}createFilterUiLegacy(e,t,r){const n=t(),i={created:!0,create:t,filterParams:e.params,compDetails:e,promise:n};return n.then(r),i}createFilterWrapper(e){const{compDetails:t,handler:r,handlerGenerator:n,handlerParams:i,createFilterUi:s}=this.createFilterInstance(e,e.getColDef(),this.getDefaultFilter(e),a=>a),o=e.getColId();if(r)return delete this.initialModel[o],r.init?.({...i,source:"init",model:Hn(this.model,o)}),{column:e,isHandler:!0,handler:r,handlerGenerator:n,handlerParams:i,filterUi:this.createFilterUiForHandler(t,s)};if(s){const a={column:e,filterUi:null,isHandler:!1};return a.filterUi=this.createFilterUiLegacy(t,s,l=>{a.filter=l??void 0}),a}return{column:e,filterUi:null,isHandler:!1}}createHandlerFunc(e,t,r){const{gos:n,frameworkOverrides:i,registry:s}=this.beans;let o;const a=f=>{const m=f.filter;if(gk(m)){const v=m.handler;return v||(o=m.doesFilterPass,o?()=>({doesFilterPass:o}):void 0)}return typeof m=="string"?m:void 0},l=n.get("enableFilterHandlers"),c=l?a(t):void 0,u=f=>()=>this.createBean(s.createDynamicBean(f,!0));let h,d;if(typeof c=="string"){const f=n.get("filterHandlers")?.[c];f!=null?h=f:M9.has(c)&&(h=u(c),d=c)}else h=c;if(!h){let f;const{compName:m,jsComp:v,fwComp:g}=bk(i,t);m?f=m:v==null&&g==null&&t.filter===!0&&(f=r),d=this.handlerMap[f],d&&(h=u(d))}return h?{filterHandler:h,handlerNameOrCallback:o??d}:l?(rn(n)&&at(277,{colId:e.getColId()}),DV):void 0}createHandler(e,t,r){const n=this.createHandlerFunc(e,t,r);if(!n)return;const i=G1(this.beans.userCompFactory,t,this.createFilterCompParams(e,!0,"init")),{handlerNameOrCallback:s,filterHandler:o}=n,{handler:a,handlerParams:l}=this.createHandlerFromFunc(e,o,i);return{handler:a,handlerParams:l,handlerGenerator:s??o}}createHandlerFromFunc(e,t,r){const n=e.getColDef(),i=t(Dt(this.gos,{column:e,colDef:n})),s=this.createHandlerParams(e,r);return{handler:i,handlerParams:s}}createHandlerParams(e,t){const r=e.getColDef(),n=e.getColId(),i=this.filterChangedCallbackFactory(e);return Dt(this.gos,{colDef:r,column:e,getValue:this.createGetValue(e),doesRowPassOtherFilter:s=>this.beans.filterManager?.doesRowPassOtherFilters(n,s)??!0,onModelChange:(s,o)=>{this.updateStoredModel(n,s),this.refreshHandlerAndUi(e,s,"handler",!1,o).then(()=>{i({...o,source:"columnFilter"})})},filterParams:t})}onColumnsChanged(){const e=[],{colModel:t,filterManager:r,groupFilter:n}=this.beans;this.allColumnFilters.forEach((s,o)=>{let a;s.column.isPrimary()?a=t.getColDefCol(o):a=t.getCol(o),!(a&&a===s.column)&&(e.push(s.column),this.disposeFilterWrapper(s,"columnChanged"),this.disposeColumnListener(o))});const i=n&&e.every(s=>n.isGroupFilter(s));e.length>0&&!i&&r?.onFilterChanged({columns:e,source:"api"})}isFilterAllowed(e){if(!e.isFilterAllowed())return!1;const r=this.beans.groupFilter;return r?.isGroupFilter(e)?r.isFilterAllowed(e):!0}getFloatingFilterCompDetails(e,t){const{userCompFactory:r,frameworkOverrides:n,selectableFilter:i,gos:s}=this.beans,o=f=>{this.getOrCreateFilterUi(e)?.then(v=>{f(ff(v))})},a=e.getColDef(),l=i?.isSelectable(a)?i.getFilterDef(e,a):a,c=$9(n,l,()=>this.getDefaultFloatingFilter(e))??"agReadOnlyFloatingFilter",u=s.get("enableFilterHandlers"),h=G1(r,l,this.createFilterCompParams(e,u,"init",!0)),d=Dt(s,{column:e,filterParams:h,currentParentModel:()=>this.getCurrentFloatingFilterParentModel(e),parentFilterInstance:o,showParentFilter:t});if(u){const f=d,m=e.getColId(),v=this.filterChangedCallbackFactory(e);f.onUiChange=g=>this.floatingFilterUiChanged(e,g),f.model=Hn(this.model,m),f.onModelChange=(g,w)=>{this.updateStoredModel(m,g),this.refreshHandlerAndUi(e,g,"floating",!0,w).then(()=>{v({...w,source:"columnFilter"})})},f.getHandler=()=>this.getHandler(e,!0),f.source="init"}return ZP(r,a,d,c)}getCurrentFloatingFilterParentModel(e){return this.getModelFromFilterWrapper(this.cachedFilter(e)??{column:e})}destroyFilterUi(e,t,r,n){const i="paramsUpdated";if(e.isHandler){const s=t.getColId();delete this.initialModel[s],this.state.delete(s);const o=e.filterUi,a=this.createFilterUiForHandler(r,n);e.filterUi=a;const l=this.eventSvc;o?.created?o.promise.then(c=>{this.destroyBean(c),l.dispatchEvent({type:"filterDestroyed",source:i,column:t})}):l.dispatchEvent({type:"filterHandlerDestroyed",source:i,column:t})}else this.destroyFilter(t,i)}destroyFilter(e,t="api"){const r=e.getColId(),n=this.allColumnFilters.get(r);this.disposeColumnListener(r),delete this.initialModel[r],n&&this.disposeFilterWrapper(n,t).then(i=>{i&&this.isAlive()&&this.beans.filterManager?.onFilterChanged({columns:[e],source:"api"})})}disposeColumnListener(e){const t=this.allColumnListeners.get(e);t&&(this.allColumnListeners.delete(e),t())}disposeFilterWrapper(e,t){let r=!1;const{column:n,isHandler:i,filterUi:s}=e,o=n.getColId();i&&(r=this.isHandlerActive(n),this.destroyBean(e.handler),delete this.model[o],this.state.delete(o));const a=()=>{this.setColFilterActive(n,!1,"filterDestroyed"),this.allColumnFilters.delete(o),this.eventSvc.dispatchEvent({type:"filterDestroyed",source:t,column:n})};if(s){if(s.created)return s.promise.then(l=>(r=i?r:!!l?.isFilterActive(),this.destroyBean(l),a(),r));a()}return hr.resolve(r)}filterChangedCallbackFactory(e){return t=>{this.callOnFilterChangedOutsideRenderCycle({additionalEventAttributes:t,columns:[e],column:e,source:t?.source??"columnFilter"})}}filterParamsChanged(e,t="api"){const r=this.allColumnFilters.get(e);if(!r)return;const n=this.beans,i=r.column,s=i.getColDef(),o=i.isFilterAllowed(),a=this.getDefaultFilter(i),l=n.selectableFilter,c=l?.isSelectable(s)?l.getFilterDef(i,s):s,u=o?this.createHandlerFunc(i,c,this.getDefaultFilter(i)):void 0,h=!!u,d=r.isHandler;if(d!=h){this.destroyFilter(i,"paramsUpdated");return}const{compDetails:f,createFilterUi:m}=(o?this.createFilterComp(i,c,a,g=>g,h,"colDef"):null)??{compDetails:null,createFilterUi:null},v=f?.params??G1(n.userCompFactory,c,this.createFilterCompParams(i,h,"colDef"));if(d){const g=u?.handlerNameOrCallback??u?.filterHandler,w=Hn(this.model,e);if(r.handlerGenerator!=g){const y=r.handler,{handler:C,handlerParams:k}=this.createHandlerFromFunc(i,u.filterHandler,v);r.handler=C,r.handlerParams=k,r.handlerGenerator=g,delete this.model[e],C.init?.({...k,source:"init",model:null}),this.destroyBean(y),w!=null&&this.beans.filterManager?.onFilterChanged({columns:[i],source:t})}else{const y=this.createHandlerParams(i,f?.params);r.handlerParams=y,r.handler.refresh?.({...y,source:"colDef",model:w})}}if(this.areFilterCompsDifferent(r.filterUi?.compDetails??null,f)||!r.filterUi||!f){this.destroyFilterUi(r,i,f,m);return}r.filterUi.filterParams=v,qa(r,d)?.then(g=>{(g?.refresh?g.refresh(v):!0)===!1?this.destroyFilterUi(r,i,f,m):this.dispatchLocalEvent({type:"filterParamsChanged",column:i,params:v})})}refreshHandlerAndUi(e,t,r,n,i){const s=this.cachedFilter(e);if(!s)return n&&this.getOrCreateFilterWrapper(e,!0),hr.resolve();if(!s.isHandler)return hr.resolve();const{filterUi:o,handler:a,handlerParams:l}=s;return D9(()=>{if(o){const{created:c,filterParams:u}=o;if(c)return o.promise.then(h=>h?{filter:h,filterParams:u}:void 0);o.refreshed=!0}return hr.resolve(void 0)},a,l,t,this.state.get(e.getColId())??{model:t},r,i)}setColumnFilterWrapper(e,t){const r=e.getColId();this.allColumnFilters.set(r,t),this.allColumnListeners.set(r,this.addManagedListeners(e,{colDefChanged:()=>this.filterParamsChanged(r)})[0])}areFilterCompsDifferent(e,t){if(!t||!e)return!0;const{componentClass:r}=e,{componentClass:n}=t;return!(r===n||r?.render&&n?.render&&r.render===n.render)}hasFloatingFilters(){return this.beans.colModel.getCols().some(t=>t.getColDef().floatingFilter)}getFilterInstance(e){const t=this.beans.colModel.getColDefCol(e);if(!t)return Promise.resolve(void 0);const r=this.getOrCreateFilterUi(t);return r?new Promise(n=>{r.then(i=>{n(ff(i))})}):Promise.resolve(null)}processFilterModelUpdateQueue(){this.modelUpdates.forEach(({model:e,source:t})=>this.setModel(e,t)),this.modelUpdates=[],this.columnModelUpdates.forEach(({key:e,model:t,resolve:r})=>{this.setModelForColumn(e,t).then(()=>r())}),this.columnModelUpdates=[]}getModelForColumn(e,t){if(t){const{state:n,model:i}=this,s=e.getColId(),o=n.get(s);return o?o.model??null:Hn(i,s)}const r=this.cachedFilter(e);return r?this.getModelFromFilterWrapper(r):null}setModelForColumn(e,t){if(this.beans.dataTypeSvc?.isPendingInference){let r=()=>{};const n=new Promise(i=>{r=i});return this.columnModelUpdates.push({key:e,model:t,resolve:r}),n}return new Promise(r=>{this.setModelForColumnLegacy(e,t).then(n=>r(n))})}getStateForColumn(e){return this.state.get(e)??{model:Hn(this.model,e)}}setModelForColumnLegacy(e,t){const r=this.beans.colModel.getColDefCol(e),n=r?this.getOrCreateFilterWrapper(r,!0):null;return n?this.setModelOnFilterWrapper(n,t):hr.resolve()}setColDefPropsForDataType(e,t,r){const n=e.filter,i=n===!0?this.getDefaultFilterFromDataType(()=>t.baseDataType):n;if(typeof i!="string")return;let s,o;const a=this.beans,{filterParams:l,filterValueGetter:c}=e;i==="agMultiColumnFilter"?{filterParams:s,filterValueGetter:o}=a.multiFilter?.getParamsForDataType(l,c,t,r)??{}:{filterParams:s,filterValueGetter:o}=j9(i,l,c,t,r,a,this.getLocaleTextFunc()),e.filterParams=s,o&&(e.filterValueGetter=o)}setColFilterActive(e,t,r,n){e.filterActive!==t&&(e.filterActive=t,e.dispatchColEvent("filterActiveChanged",r)),e.dispatchColEvent("filterChanged",r,n)}setModelOnFilterWrapper(e,t,r){return new hr(n=>{if(e.isHandler){const s=e.column,o=s.getColId(),a=this.model[o];if(this.updateStoredModel(o,t),r&&t===a){n();return}this.refreshHandlerAndUi(s,t,"api").then(()=>n());return}const i=qa(e);if(i){i.then(s=>{if(typeof s?.setModel!="function"){at(65),n();return}(s.setModel(t)||hr.resolve()).then(()=>n())});return}n()})}updateStoredModel(e,t){bt(t)?this.model[e]=t:delete this.model[e];const r=this.state.get(e),n={model:t,state:r?.state};this.state.set(e,n)}filterModified(e,t){this.getOrCreateFilterUi(e)?.then(r=>{this.eventSvc.dispatchEvent({type:"filterModified",column:e,filterInstance:r,...t})})}filterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent({type:"filterUiChanged",column:e,...t})}floatingFilterUiChanged(e,t){this.gos.get("enableFilterHandlers")&&this.eventSvc.dispatchEvent({type:"floatingFilterUiChanged",column:e,...t})}updateModel(e,t,r){const n=e.getColId(),i=this.cachedFilter(e),s=()=>i?.filterUi;l4({action:t,filterParams:i?.filterUi?.filterParams,getFilterUi:s,getModel:()=>Hn(this.model,n),getState:()=>this.state.get(n),updateState:o=>this.updateState(e,o),updateModel:o=>s()?.filterParams?.onModelChange(o,{...r,fromAction:t}),processModelToApply:i?.isHandler?i.handler.processModelToApply?.bind(i.handler):void 0})}updateAllModels(e,t){const r=[];this.allColumnFilters.forEach((n,i)=>{const s=this.beans.colModel.getColDefCol(i);s&&l4({action:e,filterParams:n.filterUi?.filterParams,getFilterUi:()=>n.filterUi,getModel:()=>Hn(this.model,i),getState:()=>this.state.get(i),updateState:o=>this.updateState(s,o),updateModel:o=>{this.updateStoredModel(i,o),this.dispatchLocalEvent({type:"filterAction",column:s,action:e}),r.push(this.refreshHandlerAndUi(s,o,"ui"))},processModelToApply:n?.isHandler?n.handler.processModelToApply?.bind(n.handler):void 0})}),r.length&&hr.all(r).then(()=>{this.callOnFilterChangedOutsideRenderCycle({source:"columnFilter",additionalEventAttributes:t,columns:[]})})}updateOrRefreshFilterUi(e){const t=e.getColId();Wk(()=>this.cachedFilter(e)?.filterUi,()=>Hn(this.model,t),()=>this.state.get(t))}updateState(e,t){this.state.set(e.getColId(),t),this.dispatchLocalEvent({type:"filterStateChanged",column:e,state:t})}canApplyAll(){const{state:e,model:t,activeFilterComps:r}=this;for(const i of r)if(i.source==="COLUMN_MENU")return!1;let n=!1;for(const i of e.keys()){const s=e.get(i);if(s.valid===!1)return!1;(s.model??null)!==Hn(t,i)&&(n=!0)}return n}hasUnappliedModel(e){const{model:t,state:r}=this;return(r.get(e)?.model??null)!==Hn(t,e)}setGlobalButtons(e){this.isGlobalButtons=e,this.dispatchLocalEvent({type:"filterGlobalButtons",isGlobal:e})}shouldKeepStateOnDetach(e,t){if(t==="newFiltersToolPanel")return!0;const r=this.beans.filterPanelSvc;return r?.isActive?!!r.getState(e.getColId()):!1}destroy(){super.destroy(),this.allColumnFilters.forEach(e=>this.disposeFilterWrapper(e,"gridDestroyed")),this.allColumnListeners.clear(),this.state.clear(),this.activeFilterComps.clear()}};function IV(e){return!!e.filterManager?.isAnyFilterPresent()}function OV(e,t="api"){e.filterManager?.onFilterChanged({source:t})}var NV=class extends et{constructor(){super(...arguments),this.beanName="filterManager",this.advFilterModelUpdateQueue=[]}wireBeans(e){this.quickFilter=e.quickFilter,this.advancedFilter=e.advancedFilter,this.colFilter=e.colFilter}postConstruct(){const e=this.refreshFiltersForAggregations.bind(this),t=this.updateAdvFilterColumns.bind(this);this.addManagedEventListeners({columnValueChanged:e,columnPivotChanged:e,columnPivotModeChanged:e,newColumnsLoaded:t,columnVisible:t,advancedFilterEnabledChanged:({enabled:n})=>this.onAdvFilterEnabledChanged(n),dataTypesInferred:this.processFilterModelUpdateQueue.bind(this)}),this.externalFilterPresent=this.isExternalFilterPresentCallback(),this.addManagedPropertyListeners(["isExternalFilterPresent","doesExternalFilterPass"],()=>{this.onFilterChanged({source:"api"})}),this.updateAggFiltering(),this.addManagedPropertyListener("groupAggFiltering",()=>{this.updateAggFiltering(),this.onFilterChanged()}),this.quickFilter&&this.addManagedListeners(this.quickFilter,{quickFilterChanged:()=>this.onFilterChanged({source:"quickFilter"})});const{gos:r}=this;this.alwaysPassFilter=r.get("alwaysPassFilter"),this.addManagedPropertyListener("alwaysPassFilter",()=>{this.alwaysPassFilter=r.get("alwaysPassFilter"),this.onFilterChanged({source:"api"})})}isExternalFilterPresentCallback(){const e=this.gos.getCallback("isExternalFilterPresent");return typeof e=="function"&&e({})}doesExternalFilterPass(e){const t=this.gos.get("doesExternalFilterPass");return typeof t=="function"&&t(e)}setFilterState(e,t,r="api"){this.isAdvFilterEnabled()||this.colFilter?.setState(e,t,r)}setFilterModel(e,t="api",r){if(this.isAdvFilterEnabled()){r||this.warnAdvFilters();return}this.colFilter?.setModel(e,t)}getFilterModel(){return this.colFilter?.getModel()??{}}getFilterState(){return this.colFilter?.getState()}isColumnFilterPresent(){return!!this.colFilter?.isFilterPresent()}isAggregateFilterPresent(){return!!this.colFilter?.isAggFilterPresent()}isChildFilterPresent(){return this.isColumnFilterPresent()||this.isQuickFilterPresent()||this.externalFilterPresent||this.isAdvFilterPresent()}isAnyFilterPresent(){return this.isChildFilterPresent()||this.isAggregateFilterPresent()}isAdvFilterPresent(){return this.isAdvFilterEnabled()&&this.advancedFilter.isFilterPresent()}onAdvFilterEnabledChanged(e){e?this.colFilter?.disableFilters()&&this.onFilterChanged({source:"advancedFilter"}):this.advancedFilter?.isFilterPresent()&&(this.advancedFilter.setModel(null),this.onFilterChanged({source:"advancedFilter"}))}isAdvFilterEnabled(){return!!this.advancedFilter?.isEnabled()}isAdvFilterHeaderActive(){return this.isAdvFilterEnabled()&&this.advancedFilter.isHeaderActive()}refreshFiltersForAggregations(){rw(this.gos)&&this.isAnyFilterPresent()&&this.onFilterChanged()}onFilterChanged(e={}){const{source:t,additionalEventAttributes:r,columns:n=[]}=e;this.externalFilterPresent=this.isExternalFilterPresentCallback(),(this.colFilter?this.colFilter.updateBeforeFilterChanged(e):hr.resolve()).then(()=>{const i={source:t,type:"filterChanged",columns:n};r&&xi(i,r),this.eventSvc.dispatchEvent(i),this.colFilter?.updateAfterFilterChanged()})}isSuppressFlashingCellsBecauseFiltering(){return!!this.colFilter?.isSuppressFlashingCellsBecauseFiltering()}isQuickFilterPresent(){return!!this.quickFilter?.isFilterPresent()}updateAggFiltering(){this.aggFiltering=!!rw(this.gos)}isAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&this.shouldApplyQuickFilterAfterAgg()}isNonAggregateQuickFilterPresent(){return this.isQuickFilterPresent()&&!this.shouldApplyQuickFilterAfterAgg()}shouldApplyQuickFilterAfterAgg(){return(this.aggFiltering||this.beans.colModel.isPivotMode())&&!this.gos.get("applyQuickFilterBeforePivotOrAgg")}doesRowPassOtherFilters(e,t){return this.doesRowPassFilter({rowNode:t,colIdToSkip:e})}doesRowPassAggregateFilters(e){const{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.isAggregateFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip,!0))}doesRowPassFilter(e){const{rowNode:t}=e;return this.alwaysPassFilter?.(t)?!0:!(this.isNonAggregateQuickFilterPresent()&&!this.quickFilter.doesRowPass(t)||this.externalFilterPresent&&!this.doesExternalFilterPass(t)||this.isColumnFilterPresent()&&!this.colFilter.doFiltersPass(t,e.colIdToSkip)||this.isAdvFilterPresent()&&!this.advancedFilter.doesFilterPass(t))}isFilterAllowed(e){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.isFilterAllowed(e)}getAdvFilterModel(){return this.isAdvFilterEnabled()?this.advancedFilter.getModel():null}setAdvFilterModel(e,t="api"){if(this.isAdvFilterEnabled()){if(this.beans.dataTypeSvc?.isPendingInference){this.advFilterModelUpdateQueue.push(e);return}this.advancedFilter.setModel(e??null),this.onFilterChanged({source:t})}}toggleAdvFilterBuilder(e,t){this.isAdvFilterEnabled()&&this.advancedFilter.getCtrl().toggleFilterBuilder({source:t,force:e})}updateAdvFilterColumns(){this.isAdvFilterEnabled()&&this.advancedFilter.updateValidity()&&this.onFilterChanged({source:"advancedFilter"})}hasFloatingFilters(){return this.isAdvFilterEnabled()?!1:!!this.colFilter?.hasFloatingFilters()}getColumnFilterInstance(e){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve(void 0)):this.colFilter?.getFilterInstance(e)??Promise.resolve(void 0)}warnAdvFilters(){at(68)}setupAdvFilterHeaderComp(e){this.advancedFilter?.getCtrl().setupHeaderComp(e)}getHeaderRowCount(){return this.isAdvFilterHeaderActive()?1:0}getHeaderHeight(){return this.isAdvFilterHeaderActive()?this.advancedFilter.getCtrl().getHeaderHeight():0}processFilterModelUpdateQueue(){for(const e of this.advFilterModelUpdateQueue)this.setAdvFilterModel(e);this.advFilterModelUpdateQueue=[]}setColumnFilterModel(e,t){return this.isAdvFilterEnabled()?(this.warnAdvFilters(),Promise.resolve()):this.colFilter?.setModelForColumn(e,t)??Promise.resolve()}},LV=class extends et{constructor(){super(...arguments),this.beanName="filterMenuFactory"}wireBeans(e){this.popupSvc=e.popupSvc}hideActiveMenu(){this.hidePopup?.()}showMenuAfterMouseEvent(e,t,r,n){e&&!e.isColumn||this.showPopup(e,i=>{this.popupSvc?.positionPopupUnderMouseEvent({additionalParams:{column:e},type:r,mouseEvent:t,ePopup:i})},r,t.target,rs(this.gos),n)}showMenuAfterButtonClick(e,t,r,n){if(e&&!e.isColumn)return;let i=-1,s="left";const o=rs(this.gos);!o&&this.gos.get("enableRtl")&&(i=1,s="right");const a=o?void 0:4*i,l=o?void 0:4;this.showPopup(e,c=>{this.popupSvc?.positionPopupByComponent({type:r,eventSource:t,ePopup:c,nudgeX:a,nudgeY:l,alignSide:s,keepWithinBounds:!0,position:"under",additionalParams:{column:e}})},r,t,o,n)}showPopup(e,t,r,n,i,s){const o=e?this.createBean(new B9(e,"COLUMN_MENU")):void 0;if(this.activeMenu=o,!o?.hasFilter()||!e){Ar(57);return}const a=ks({tag:"div",cls:`ag-menu${i?"":" ag-filter-menu"}`,role:"presentation"});[this.tabListener]=this.addManagedElementListeners(a,{keydown:v=>this.trapFocusWithin(v,a)}),a.appendChild(o?.getGui());let l;const c=()=>o?.afterGuiDetached(),u=GD(this.gos)?n??this.beans.ctrlsSvc.getGridBodyCtrl().eGridBody:void 0,h=v=>{v4(e,!1,"contextMenu");const g=v instanceof KeyboardEvent;this.tabListener&&(this.tabListener=this.tabListener()),g&&n&&da(n)&&_k(n)?.focus({preventScroll:!0}),c(),this.destroyBean(this.activeMenu),this.dispatchVisibleChangedEvent(!1,r,e),s?.()},d=this.getLocaleTextFunc(),f=i&&r!=="columnFilter"?d("ariaLabelColumnMenu","Column Menu"):d("ariaLabelColumnFilter","Column Filter"),m=this.popupSvc?.addPopup({modal:!0,eChild:a,closeOnEsc:!0,closedCallback:h,positionCallback:()=>t(a),anchorToElement:u,ariaLabel:f});m&&(this.hidePopup=l=m.hideFunc),o.afterInit().then(()=>{t(a),o.afterGuiAttached({container:r,hidePopup:l})}),v4(e,!0,"contextMenu"),this.dispatchVisibleChangedEvent(!0,r,e)}trapFocusWithin(e,t){e.key!==$e.TAB||e.defaultPrevented||Mc(this.beans,t,!1,e.shiftKey)||(e.preventDefault(),bc(t,e.shiftKey))}dispatchVisibleChangedEvent(e,t,r){this.eventSvc.dispatchEvent({type:"columnMenuVisibleChanged",visible:e,switchingTab:!1,key:t,column:r??null,columnGroup:null})}isMenuEnabled(e){return e.isFilterAllowed()&&(e.getColDef().menuTabs??["filterMenuTab"]).includes("filterMenuTab")}showMenuAfterContextMenuEvent(){}destroy(){this.destroyBean(this.activeMenu),super.destroy()}},BV=class extends et{constructor(){super(...arguments),this.beanName="filterValueSvc"}getValue(e,t,r){if(!t)return;const n=e.getColDef(),{selectableFilter:i,valueSvc:s,formula:o}=this.beans,a=r??i?.getFilterValueGetter(e.getColId())??n.filterValueGetter;if(a)return this.executeFilterValueGetter(a,t.data,e,t,n);const l=s.getValue(e,t);return e.isAllowFormula()&&o?.isFormula(l)?o.resolveValue(e,t):l}executeFilterValueGetter(e,t,r,n,i){const{expressionSvc:s,valueSvc:o}=this.beans,a=Dt(this.gos,{data:t,node:n,column:r,colDef:i,getValue:o.getValueCallback.bind(o,n)});return typeof e=="function"?e(a):s?.evaluate(e,a)}},HV={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eFloatingFilterText"}]},jV=class extends pn{constructor(){super(HV,[sm]),this.eFloatingFilterText=xt}init(e){this.params=e;const t=this.beans.colNames.getDisplayNameForColumn(e.column,"header",!0);if(this.eFloatingFilterText.setDisabled(!0).setInputAriaLabel(`${t} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`),this.gos.get("enableFilterHandlers")){const r=e,n=r.getHandler();if(n.getModelAsString){const i=n.getModelAsString(r.model);this.eFloatingFilterText.setValue(i)}}}onParentModelChanged(e){if(e==null){this.eFloatingFilterText.setValue("");return}this.params.parentFilterInstance(t=>{if(t.getModelAsString){const r=t.getModelAsString(e);this.eFloatingFilterText.setValue(r)}})}refresh(e){this.init(e)}},zy=class{constructor(){this.customFilterOptions={}}init(e,t){this.filterOptions=e.filterOptions??t,this.mapCustomOptions(),this.defaultOption=this.getDefaultItem(e.defaultOption)}refresh(e,t){const r=e.filterOptions??t;this.filterOptions!==r&&(this.filterOptions=r,this.customFilterOptions={},this.mapCustomOptions()),this.defaultOption=this.getDefaultItem(e.defaultOption)}mapCustomOptions(){const{filterOptions:e}=this;if(e)for(const t of e){if(typeof t=="string")continue;const r=[["displayKey"],["displayName"],["predicate","test"]],n=i=>i.some(s=>t[s]!=null)?!0:(at(72,{keys:i}),!1);if(!r.every(n)){this.filterOptions=e.filter(i=>i===t)||[];continue}this.customFilterOptions[t.displayKey]=t}}getDefaultItem(e){const{filterOptions:t}=this;if(e)return e;if(t.length>=1){const r=t[0];if(typeof r=="string")return r;if(r.displayKey)return r.displayKey;at(73)}else at(74)}getCustomOption(e){return this.customFilterOptions[e]}};function qh(e,t,r){return r==null?e.splice(t):e.splice(t,r)}function D0(e){return e==null||typeof e=="string"&&e.trim().length===0}function VV(e){return e==="AND"||e==="OR"?e:"AND"}function GV(e,t,r){if(e==null)return;const{predicate:n}=e;if(n!=null&&!t.some(i=>i==null))return n(t,r)}function zV(e,t){let r=e.length;return r>t&&(e.splice(t),at(78),r=t),r}function bf(e,t){const r=t.getCustomOption(e);if(r){const{numberOfInputs:i}=r;return i??1}return e&&["empty","notBlank","blank"].indexOf(e)>=0?0:e==="inRange"?2:1}var Uy=class extends W9{constructor(e,t,r){super(e,"simple-filter"),this.mapValuesFromModel=t,this.defaultOptions=r,this.eTypes=[],this.eJoinPanels=[],this.eJoinAnds=[],this.eJoinOrs=[],this.eConditionBodies=[],this.listener=()=>this.onUiChanged(),this.lastUiCompletePosition=null,this.joinOperatorId=0}setParams(e){super.setParams(e);const t=new zy;this.optionsFactory=t,t.init(e,this.defaultOptions),this.commonUpdateSimpleParams(e),this.createOption(),this.createMissingConditionsAndOperators()}updateParams(e,t){this.optionsFactory.refresh(e,this.defaultOptions),super.updateParams(e,t),this.commonUpdateSimpleParams(e)}commonUpdateSimpleParams(e){this.setNumConditions(e),this.defaultJoinOperator=VV(e.defaultJoinOperator),this.filterPlaceholder=e.filterPlaceholder,this.createFilterListOptions(),Oi(this.getGui(),"tabindex",this.isReadOnly()?"-1":null)}onFloatingFilterChanged(e,t){this.setTypeFromFloatingFilter(e),this.setValueFromFloatingFilter(t),this.onUiChanged("immediately",!0)}setTypeFromFloatingFilter(e){this.eTypes.forEach((t,r)=>{const n=r===0?e:this.optionsFactory.defaultOption;t.setValue(n,!0)})}getModelFromUi(){const e=this.getUiCompleteConditions();return e.length===0?null:this.maxNumConditions>1&&e.length>1?{filterType:this.filterType,operator:this.getJoinOperator(),conditions:e}:e[0]}getConditionTypes(){return this.eTypes.map(e=>e.getValue())}getConditionType(e){return this.eTypes[e].getValue()}getJoinOperator(){const{eJoinOrs:e,defaultJoinOperator:t}=this;return e.length===0?t:e[0].getValue()===!0?"OR":"AND"}areNonNullModelsEqual(e,t){const r=!e.operator,n=!t.operator;if(!r&&n||r&&!n)return!1;let s;if(r){const o=e,a=t;s=this.areSimpleModelsEqual(o,a)}else{const o=e,a=t;s=o.operator===a.operator&&ml(o.conditions,a.conditions,(l,c)=>this.areSimpleModelsEqual(l,c))}return s}setModelIntoUi(e,t){if(e==null)return this.resetUiToDefaults(t),hr.resolve();if(e.operator){const n=e;let i=n.conditions;i==null&&(i=[],at(77));const s=zV(i,this.maxNumConditions),o=this.getNumConditions();if(s<o)this.removeConditionsAndOperators(s);else if(s>o)for(let l=o;l<s;l++)this.createJoinOperatorPanel(),this.createOption();const a=n.operator==="OR";this.eJoinAnds.forEach(l=>l.setValue(!a,!0)),this.eJoinOrs.forEach(l=>l.setValue(a,!0)),i.forEach((l,c)=>{this.eTypes[c].setValue(l.type,!0),this.setConditionIntoUi(l,c)})}else{const n=e;this.getNumConditions()>1&&this.removeConditionsAndOperators(1),this.eTypes[0].setValue(n.type,!0),this.setConditionIntoUi(n,0)}return this.lastUiCompletePosition=this.getNumConditions()-1,this.createMissingConditionsAndOperators(),this.updateUiVisibility(),t||this.params.onUiChange(this.getUiChangeEventParams()),hr.resolve()}setNumConditions(e){let t=e.maxNumConditions??2;t<1&&(at(79),t=1),this.maxNumConditions=t;let r=e.numAlwaysVisibleConditions??1;r<1&&(at(80),r=1),r>t&&(at(81),r=t),this.numAlwaysVisibleConditions=r}createOption(){const e=this.getGui(),t=this.createManagedBean(new Sy);this.eTypes.push(t),t.addCss("ag-filter-select"),e.appendChild(t.getGui());const r=this.createEValue();this.eConditionBodies.push(r),e.appendChild(r),this.putOptionsIntoDropdown(t),this.resetType(t);const n=this.getNumConditions()-1;this.forEachPositionInput(n,i=>this.resetInput(i)),this.addChangedListeners(t,n)}createJoinOperatorPanel(){const e=ks({tag:"div",cls:"ag-filter-condition"});this.eJoinPanels.push(e);const t=this.createJoinOperator(this.eJoinAnds,e,"and"),r=this.createJoinOperator(this.eJoinOrs,e,"or");this.getGui().appendChild(e);const n=this.eJoinPanels.length-1,i=this.joinOperatorId++;this.resetJoinOperatorAnd(t,n,i),this.resetJoinOperatorOr(r,n,i),this.isReadOnly()||(t.onValueChange(this.listener),r.onValueChange(this.listener))}createJoinOperator(e,t,r){const n=this.createManagedBean(new C7);e.push(n);const i="ag-filter-condition-operator";return n.addCss(i),n.addCss(`${i}-${r}`),t.appendChild(n.getGui()),n}createFilterListOptions(){this.filterListOptions=this.optionsFactory.filterOptions.map(e=>typeof e=="string"?this.createBoilerplateListOption(e):this.createCustomListOption(e))}putOptionsIntoDropdown(e){const{filterListOptions:t}=this;for(const r of t)e.addOption(r);e.setDisabled(t.length<=1)}createBoilerplateListOption(e){return{value:e,text:this.translate(e)}}createCustomListOption(e){const{displayKey:t}=e,r=this.optionsFactory.getCustomOption(e.displayKey);return{value:t,text:r?this.getLocaleTextFunc()(r.displayKey,r.displayName):this.translate(t)}}createBodyTemplate(){return null}getAgComponents(){return[]}updateUiVisibility(){const e=this.getJoinOperator();this.updateNumConditions(),this.updateConditionStatusesAndValues(this.lastUiCompletePosition,e)}updateNumConditions(){let e=-1,t=!0;for(let r=0;r<this.getNumConditions();r++)this.isConditionUiComplete(r)?e=r:t=!1;if(this.shouldAddNewConditionAtEnd(t))this.createJoinOperatorPanel(),this.createOption();else{const r=this.lastUiCompletePosition??this.getNumConditions()-2;if(e<r){this.removeConditionsAndOperators(r+1);const n=e+1,i=r-n;i>0&&this.removeConditionsAndOperators(n,i),this.createMissingConditionsAndOperators()}}this.lastUiCompletePosition=e}updateConditionStatusesAndValues(e,t){this.eTypes.forEach((n,i)=>{const s=this.isConditionDisabled(i,e);n.setDisabled(s||this.filterListOptions.length<=1),i===1&&(lf(this.eJoinPanels[0],s),this.eJoinAnds[0].setDisabled(s),this.eJoinOrs[0].setDisabled(s))}),this.eConditionBodies.forEach((n,i)=>{Gr(n,this.isConditionBodyVisible(i))});const r=(t??this.getJoinOperator())==="OR";for(const n of this.eJoinAnds)n.setValue(!r,!0);for(const n of this.eJoinOrs)n.setValue(r,!0);this.forEachInput((n,i,s,o)=>{this.setElementDisplayed(n,i<o),this.setElementDisabled(n,this.isConditionDisabled(s,e))}),this.resetPlaceholder()}shouldAddNewConditionAtEnd(e){return e&&this.getNumConditions()<this.maxNumConditions&&!this.isReadOnly()}removeConditionsAndOperators(e,t){if(e>=this.getNumConditions())return;const{eTypes:r,eConditionBodies:n,eJoinPanels:i,eJoinAnds:s,eJoinOrs:o}=this;this.removeComponents(r,e,t),this.removeElements(n,e,t),this.removeEValues(e,t);const a=Math.max(e-1,0);this.removeElements(i,a,t),this.removeComponents(s,a,t),this.removeComponents(o,a,t)}removeElements(e,t,r){const n=qh(e,t,r);for(const i of n)ol(i)}removeComponents(e,t,r){const n=qh(e,t,r);for(const i of n)ol(i.getGui()),this.destroyBean(i)}afterGuiAttached(e){if(super.afterGuiAttached(e),this.resetPlaceholder(),!e?.suppressFocus){let t;if(!this.isReadOnly()){const r=this.getInputs(0)[0];r instanceof ec&&this.isConditionBodyVisible(0)?t=r.getInputElement():t=this.eTypes[0]?.getFocusableElement()}(t??this.getGui()).focus({preventScroll:!0})}}shouldKeepInvalidInputState(){return!1}afterGuiDetached(){super.afterGuiDetached();const e=this.params;if(this.beans.colFilter?.shouldKeepStateOnDetach(e.column)||this.shouldKeepInvalidInputState())return;e.onStateChange({model:e.model});let t=-1,r=-1,n=!1;const i=this.getJoinOperator();for(let o=this.getNumConditions()-1;o>=0;o--)if(this.isConditionUiComplete(o))t===-1&&(t=o,r=o);else{const a=o>=this.numAlwaysVisibleConditions&&!this.isConditionUiComplete(o-1),l=o<t;(a||l)&&(this.removeConditionsAndOperators(o,1),n=!0,l&&r--)}let s=!1;this.getNumConditions()<this.numAlwaysVisibleConditions&&(this.createMissingConditionsAndOperators(),s=!0),this.shouldAddNewConditionAtEnd(r===this.getNumConditions()-1)&&(this.createJoinOperatorPanel(),this.createOption(),s=!0),s&&this.updateConditionStatusesAndValues(r,i),n&&this.updateJoinOperatorsDisabled(),this.lastUiCompletePosition=r}getModelAsString(e){return this.params.getHandler()?.getModelAsString?.(e)??""}resetPlaceholder(){const e=this.getLocaleTextFunc(),{filterPlaceholder:t,eTypes:r}=this;this.forEachInput((n,i,s,o)=>{if(!(n instanceof ec))return;const a=i===0&&o>1?"inRangeStart":i===0?"filterOoo":"inRangeEnd",l=i===0&&o>1?e("ariaFilterFromValue","Filter from value"):i===0?e("ariaFilterValue","Filter Value"):e("ariaFilterToValue","Filter to Value"),c=r[s].getValue(),u=$k(this,t,a,c);n.setInputPlaceholder(u),n.setInputAriaLabel(l)})}setElementValue(e,t,r){e instanceof ec&&e.setValue(t!=null?String(t):null,!0)}setElementDisplayed(e,t){X_(e)&&Gr(e.getGui(),t)}setElementDisabled(e,t){X_(e)&&lf(e.getGui(),t)}attachElementOnChange(e,t){e instanceof ec&&e.onValueChange(t)}forEachInput(e){this.getConditionTypes().forEach((t,r)=>{this.forEachPositionTypeInput(r,t,e)})}forEachPositionInput(e,t){const r=this.getConditionType(e);this.forEachPositionTypeInput(e,r,t)}forEachPositionTypeInput(e,t,r){const n=bf(t,this.optionsFactory),i=this.getInputs(e);for(let s=0;s<i.length;s++){const o=i[s];o!=null&&r(o,s,e,n)}}isConditionDisabled(e,t){return this.isReadOnly()?!0:e===0?!1:e>t+1}isConditionBodyVisible(e){const t=this.getConditionType(e);return bf(t,this.optionsFactory)>0}isConditionUiComplete(e){return!(e>=this.getNumConditions()||this.getConditionType(e)==="empty"||this.getValues(e).some(r=>r==null)||this.positionHasInvalidInputs(e))}getNumConditions(){return this.eTypes.length}getUiCompleteConditions(){const e=[];for(let t=0;t<this.getNumConditions();t++)this.isConditionUiComplete(t)&&e.push(this.createCondition(t));return e}createMissingConditionsAndOperators(){if(!this.isReadOnly())for(let e=this.getNumConditions();e<this.numAlwaysVisibleConditions;e++)this.createJoinOperatorPanel(),this.createOption()}resetUiToDefaults(e){this.removeConditionsAndOperators(this.isReadOnly()?1:this.numAlwaysVisibleConditions),this.eTypes.forEach(t=>this.resetType(t)),this.eJoinAnds.forEach((t,r)=>this.resetJoinOperatorAnd(t,r,this.joinOperatorId+r)),this.eJoinOrs.forEach((t,r)=>this.resetJoinOperatorOr(t,r,this.joinOperatorId+r)),this.joinOperatorId++,this.forEachInput(t=>this.resetInput(t)),this.resetPlaceholder(),this.createMissingConditionsAndOperators(),this.lastUiCompletePosition=null,this.updateUiVisibility(),e||this.params.onUiChange(this.getUiChangeEventParams())}resetType(e){const r=this.getLocaleTextFunc()("ariaFilteringOperator","Filtering operator");e.setValue(this.optionsFactory.defaultOption,!0).setAriaLabel(r).setDisabled(this.isReadOnly()||this.filterListOptions.length<=1)}resetJoinOperatorAnd(e,t,r){this.resetJoinOperator(e,t,this.defaultJoinOperator==="AND",this.translate("andCondition"),r)}resetJoinOperatorOr(e,t,r){this.resetJoinOperator(e,t,this.defaultJoinOperator==="OR",this.translate("orCondition"),r)}resetJoinOperator(e,t,r,n,i){this.updateJoinOperatorDisabled(e.setValue(r,!0).setName(`ag-simple-filter-and-or-${this.getCompId()}-${i}`).setLabel(n),t)}updateJoinOperatorsDisabled(){const e=(t,r)=>this.updateJoinOperatorDisabled(t,r);this.eJoinAnds.forEach(e),this.eJoinOrs.forEach(e)}updateJoinOperatorDisabled(e,t){e.setDisabled(this.isReadOnly()||t>0)}resetInput(e){this.setElementValue(e,null),this.setElementDisabled(e,this.isReadOnly())}setConditionIntoUi(e,t){const r=this.mapValuesFromModel(e,this.optionsFactory);this.forEachInput((n,i,s)=>{s===t&&this.setElementValue(n,r[i]!=null?r[i]:null)})}setValueFromFloatingFilter(e){this.forEachInput((t,r,n)=>{this.setElementValue(t,r===0&&n===0?e:null,!0)})}addChangedListeners(e,t){this.isReadOnly()||(e.onValueChange(this.listener),this.forEachPositionInput(t,r=>{this.attachElementOnChange(r,this.listener)}))}hasInvalidInputs(){return!1}positionHasInvalidInputs(e){return!1}isReadOnly(){return!!this.params.readOnly}},Y4=".ag-input-field-input",BR=class{constructor(e,t,r,n,i,s){this.context=e,this.eParent=i,this.alive=!0,this.debouncedReport=zn({isAlive:()=>this.alive},Z4,500),this.timeoutHandle=null,XP(t,r,n)?.newAgStackInstance().then(a=>{if(!this.alive){e.destroyBean(a);return}if(this.dateComp=a,!a)return;i.appendChild(a.getGui()),a?.afterGuiAttached?.();const{tempValue:l,disabled:c}=this;l&&a.setDate(l),c!=null&&a.setDisabled?.(c),s?.(this)})}destroy(){this.alive=!1,this.dateComp=this.context.destroyBean(this.dateComp)}getDate(){return this.dateComp?this.dateComp.getDate():this.tempValue}setDate(e){const t=this.dateComp;t?t.setDate(e):this.tempValue=e}setDisabled(e){const t=this.dateComp;t?t.setDisabled?.(e):this.disabled=e}setDisplayed(e){Gr(this.eParent,e)}setInputPlaceholder(e){this.dateComp?.setInputPlaceholder?.(e)}setInputAriaLabel(e){this.dateComp?.setInputAriaLabel?.(e)}afterGuiAttached(e){this.dateComp?.afterGuiAttached?.(e)}updateParams(e){this.dateComp?.refresh?.(e)}setCustomValidity(e,t=!1){const r=this.dateComp?.getGui().querySelector(Y4);if(r&&"setCustomValidity"in r){const n=e.length>0;r.setCustomValidity(e),n?t?this.timeoutHandle=this.debouncedReport(r):Z4(r):this.timeoutHandle&&window.clearTimeout(this.timeoutHandle),ny(r,n)}}getValidity(){return this.dateComp?.getGui().querySelector(Y4)?.validity}};function Z4(e){e.reportValidity()}var Wy=["equals","notEqual","lessThan","greaterThan","inRange","blank","notBlank"];function HR(e,t){const{dateFrom:r,dateTo:n,type:i}=e||{};return[r&&ji(r,void 0,!0)||null,n&&ji(n,void 0,!0)||null].slice(0,bf(i,t))}var J4=1e3,Q4=1/0,UV=class extends Uy{constructor(){super("dateFilter",HR,Wy),this.eConditionPanelsFrom=[],this.eConditionPanelsTo=[],this.dateConditionFromComps=[],this.dateConditionToComps=[],this.minValidYear=J4,this.maxValidYear=Q4,this.minValidDate=null,this.maxValidDate=null,this.filterType="date"}afterGuiAttached(e){super.afterGuiAttached(e),this.dateConditionFromComps[0].afterGuiAttached(e),this.refreshInputValidation()}shouldKeepInvalidInputState(){return!pf()&&this.hasInvalidInputs()&&this.getConditionTypes().includes("inRange")}commonUpdateSimpleParams(e){super.commonUpdateSimpleParams(e);const t=(l,c)=>{const u=e[l];if(u!=null)if(isNaN(u))at(82,{param:l});else return u==null?c:Number(u);return c},r=t("minValidYear",J4),n=t("maxValidYear",Q4);this.minValidYear=r,this.maxValidYear=n,r>n&&at(83);const{minValidDate:i,maxValidDate:s}=e,o=i instanceof Date?i:ji(i);this.minValidDate=o;const a=s instanceof Date?s:ji(s);this.maxValidDate=a,o&&a&&o>a&&at(84)}refreshInputValidation(){for(let e=0;e<this.dateConditionFromComps.length;e++)this.refreshInputPairValidation(e,!1,!0)}refreshInputPairValidation(e,t=!1,r=!1){const{dateConditionFromComps:n,dateConditionToComps:i,beans:s}=this,o=n[e],a=i[e],l=o.getDate(),c=a.getDate(),u=WV(l,c,t),h=u?this.translate(u,[String(t?c:l)]):"",d=!pf()&&!r;(t?o:a).setCustomValidity(h,d),(t?a:o).setCustomValidity("",d),h.length>0&&s.ariaAnnounce.announceValue(h,"dateFilter")}createDateCompWrapper(e,t,r){const{beans:{userCompFactory:n,context:i,gos:s},params:o}=this,a=r==="from",l=new BR(i,n,o.colDef,Dt(s,{onDateChanged:()=>{this.refreshInputPairValidation(t,a),this.onUiChanged()},onFocusIn:()=>this.refreshInputPairValidation(t,a),filterParams:o,location:"filter"}),e);return this.addDestroyFunc(()=>l.destroy()),l}getState(){return{isInvalid:this.hasInvalidInputs()}}areStatesEqual(e,t){return(e?.isInvalid??!1)===(t?.isInvalid??!1)}setElementValue(e,t){e.setDate(t),t||e.setCustomValidity("")}setElementDisplayed(e,t){e.setDisplayed(t)}setElementDisabled(e,t){e.setDisabled(t)}createEValue(){const e=ks({tag:"div",cls:"ag-filter-body"});return this.createFromToElement(e,this.eConditionPanelsFrom,this.dateConditionFromComps,"from"),this.createFromToElement(e,this.eConditionPanelsTo,this.dateConditionToComps,"to"),e}createFromToElement(e,t,r,n){const i=ks({tag:"div",cls:`ag-filter-${n} ag-filter-date-${n}`});t.push(i),e.appendChild(i),r.push(this.createDateCompWrapper(i,t.length-1,n))}removeEValues(e,t){this.removeDateComps(this.dateConditionFromComps,e,t),this.removeDateComps(this.dateConditionToComps,e,t),qh(this.eConditionPanelsFrom,e,t),qh(this.eConditionPanelsTo,e,t)}removeDateComps(e,t,r){const n=qh(e,t,r);for(const i of n)i.destroy()}isValidDateValue(e){if(e===null)return!1;const{minValidDate:t,maxValidDate:r,minValidYear:n,maxValidYear:i}=this;if(t){if(e<t)return!1}else if(e.getUTCFullYear()<n)return!1;if(r){if(e>r)return!1}else if(e.getUTCFullYear()>i)return!1;return!0}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>e||(e=t.getDate()!=null&&!(t.getValidity()?.valid??!0))),e}positionHasInvalidInputs(e){let t=!1;return this.forEachPositionInput(e,r=>t||(t=!(r.getValidity()?.valid??!0))),t}canApply(e){return!this.hasInvalidInputs()}isConditionUiComplete(e){if(!super.isConditionUiComplete(e))return!1;let t=!0;return this.forEachPositionInput(e,(r,n,i,s)=>{!t||n>=s||t&&(t=this.isValidDateValue(r.getDate()))}),t}areSimpleModelsEqual(e,t){return e.dateFrom===t.dateFrom&&e.dateTo===t.dateTo&&e.type===t.type}createCondition(e){const t=this.getConditionType(e),r={},n=this.getValues(e),i=this.params.useIsoSeparator?"T":" ";return n.length>0&&(r.dateFrom=ns(n[0],!0,i)),n.length>1&&(r.dateTo=ns(n[1],!0,i)),{dateFrom:null,dateTo:null,filterType:this.filterType,type:t,...r}}removeConditionsAndOperators(e,t){if(!this.hasInvalidInputs())return super.removeConditionsAndOperators(e,t)}resetPlaceholder(){const e=this.getLocaleTextFunc(),t=this.translate("dateFormatOoo"),r=e("ariaFilterValue","Filter Value");this.forEachInput(n=>{n.setInputPlaceholder(t),n.setInputAriaLabel(r)})}getInputs(e){const{dateConditionFromComps:t,dateConditionToComps:r}=this;return e>=t.length?[null,null]:[t[e],r[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(r,n,i,s)=>{n<s&&t.push(r.getDate())}),t}translate(e,t){let r=e;return e==="lessThan"?r="before":e==="greaterThan"&&(r="after"),super.translate(r,t)}};function WV(e,t,r){return e!=null&&t!=null&&e>=t?`${r?"max":"min"}DateValidation`:null}var jR=class extends et{constructor(e,t){super(),this.mapValuesFromModel=e,this.defaultOptions=t}init(e){const t=e.filterParams,r=new zy;this.optionsFactory=r,r.init(t,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(r,t)),this.updateParams(e),this.validateModel(e)}refresh(e){if(e.source==="colDef"){const t=e.filterParams,r=this.optionsFactory;r.refresh(t,this.defaultOptions),this.filterModelFormatter.updateParams({optionsFactory:r,filterParams:t}),this.updateParams(e)}this.validateModel(e)}updateParams(e){this.params=e}doesFilterPass(e){const t=e.model;if(t==null)return!0;const{operator:r}=t,n=[];if(r){const o=t;n.push(...o.conditions??[])}else n.push(t);const i=r&&r==="OR"?"some":"every",s=this.params.getValue(e.node);return n[i](o=>this.individualConditionPasses(e,o,s))}getModelAsString(e,t){return this.filterModelFormatter.getModelAsString(e,t)??""}validateModel(e){const{model:t,filterParams:{filterOptions:r,maxNumConditions:n}}=e;if(t==null)return;let s=Kk(t)?t.conditions:[t];const o=r?.map(u=>typeof u=="string"?u:u.displayKey)??this.defaultOptions;if(!(!s||s.every(u=>o.find(h=>h===u.type)!==void 0))){this.params={...e,model:null},e.onModelChange(null);return}let l=!1;const c=this.filterType;if((s&&!s.every(u=>u.filterType===c)||t.filterType!==c)&&(s=s.map(u=>({...u,filterType:c})),l=!0),typeof n=="number"&&s&&s.length>n&&(s=s.slice(0,n),l=!0),l){const u=s.length>1?{...t,filterType:c,conditions:s}:{...s[0],filterType:c};this.params={...e,model:u},e.onModelChange(u)}}individualConditionPasses(e,t,r){const n=this.optionsFactory,i=this.mapValuesFromModel(t,n),s=n.getCustomOption(t.type),o=GV(s,i,r);return o??(r==null?this.evaluateNullValue(t.type):this.evaluateNonNullValue(i,r,t,e))}},VR=class extends jR{evaluateNullValue(e){const{includeBlanksInEquals:t,includeBlanksInNotEqual:r,includeBlanksInGreaterThan:n,includeBlanksInLessThan:i,includeBlanksInRange:s}=this.params.filterParams;switch(e){case"equals":if(t)return!0;break;case"notEqual":if(r)return!0;break;case"greaterThan":case"greaterThanOrEqual":if(n)return!0;break;case"lessThan":case"lessThanOrEqual":if(i)return!0;break;case"inRange":if(s)return!0;break;case"blank":return!0;case"notBlank":return!1}return!1}evaluateNonNullValue(e,t,r){const n=r.type;if(!this.isValid(t))return n==="notEqual"||n==="notBlank";const i=this.comparator(),s=e[0]!=null?i(e[0],t):0;switch(n){case"equals":return s===0;case"notEqual":return s!==0;case"greaterThan":return s>0;case"greaterThanOrEqual":return s>=0;case"lessThan":return s<0;case"lessThanOrEqual":return s<=0;case"inRange":{const o=i(e[1],t);return this.params.filterParams.inRangeInclusive?s>=0&&o<=0:s>0&&o<0}case"blank":return D0(t);case"notBlank":return!D0(t);default:return at(76,{filterModelType:n}),!0}}},GR={equals:"Equals",notEqual:"NotEqual",greaterThan:"GreaterThan",greaterThanOrEqual:"GreaterThanOrEqual",lessThan:"LessThan",lessThanOrEqual:"LessThanOrEqual",inRange:"InRange"},$V={contains:"Contains",notContains:"NotContains",equals:"TextEquals",notEqual:"TextNotEqual",startsWith:"StartsWith",endsWith:"EndsWith",inRange:"InRange"},$y=class extends et{constructor(e,t,r){super(),this.optionsFactory=e,this.filterParams=t,this.valueFormatter=r}getModelAsString(e,t){const r=this.getLocaleTextFunc(),n=t==="filterToolPanel";if(!e)return n?go(this,"filterSummaryInactive"):null;if(e.operator!=null){const s=e,a=(s.conditions??[]).map(c=>this.getModelAsString(c,t)),l=s.operator==="AND"?"andCondition":"orCondition";return a.join(` ${go(this,l)} `)}else{if(e.type==="blank"||e.type==="notBlank")return n?go(this,e.type==="blank"?"filterSummaryBlank":"filterSummaryNotBlank"):r(e.type,e.type);{const s=e,o=this.optionsFactory.getCustomOption(s.type),{displayKey:a,displayName:l,numberOfInputs:c}=o||{};return a&&l&&c===0?r(a,l):this.conditionToString(s,n,s.type==="inRange"||c===2,a,l)}}}updateParams(e){const{optionsFactory:t,filterParams:r}=e;this.optionsFactory=t,this.filterParams=r}conditionForToolPanel(e,t,r,n,i,s){let o;const a=this.getTypeKey(e);return a&&(o=go(this,a)),i&&s&&(o=this.getLocaleTextFunc()(i,s)),o!=null?t?`${o} ${go(this,"filterSummaryInRangeValues",[r(),n()])}`:`${o} ${r()}`:null}getTypeKey(e){const t=this.filterTypeKeys[e];return t?`filterSummary${t}`:null}formatValue(e){const t=this.valueFormatter;return t?t(e??null)??"":String(e)}},zR=class extends $y{constructor(e,t){super(e,t,r=>{const{dataTypeSvc:n,valueSvc:i}=this.beans,s=t.column,o=n?.getDateFormatterFunction(s),a=o?o(r??void 0):r;return i.formatValue(s,null,a)}),this.filterTypeKeys=GR}conditionToString(e,t,r,n,i){const{type:s}=e,o=ji(e.dateFrom),a=ji(e.dateTo),l=this.filterParams.inRangeFloatingFilterDateFormat,c=t?this.formatValue.bind(this):d=>cw(d,l),u=()=>o!==null?c(o):"null",h=()=>a!==null?c(a):"null";if(t){const d=this.conditionForToolPanel(s,r,u,h,n,i);if(d!=null)return d}return r?`${u()}-${h()}`:o!=null?c(o):`${s}`}};function qV(e,t){const r=t;return r<e?-1:r>e?1:0}var KV=class extends VR{constructor(){super(HR,Wy),this.filterType="date",this.FilterModelFormatterClass=zR}comparator(){return this.params.filterParams.comparator??qV}isValid(e){const t=this.params.filterParams.isValidDate;return!t||t(e)}},UR=class extends pn{constructor(){super(...arguments),this.defaultDebounceMs=0}setLastTypeFromModel(e){if(!e){this.lastType=this.optionsFactory.defaultOption;return}const t=e.operator;let r;t?r=e.conditions[0]:r=e,this.lastType=r.type}canWeEditAfterModelFromParentFilter(e){if(!e)return this.isTypeEditable(this.lastType);if(e.operator)return!1;const r=e;return this.isTypeEditable(r.type)}init(e){this.params=e;const t=this.gos.get("enableFilterHandlers");if(this.reactive=t,this.setParams(e),t){const r=e;this.onModelUpdated(r.model)}}setParams(e){const t=new zy;this.optionsFactory=t,t.init(e.filterParams,this.defaultOptions),this.filterModelFormatter=this.createManagedBean(new this.FilterModelFormatterClass(t,e.filterParams)),this.setSimpleParams(e,!1)}setSimpleParams(e,t=!0){const r=this.optionsFactory.defaultOption;t||(this.lastType=r),this.readOnly=!!e.filterParams.readOnly;const n=this.isTypeEditable(r);this.setEditable(n)}refresh(e){this.params=e;const t=e,r=this.reactive;if((!r||t.source==="colDef")&&this.updateParams(e),r){const{source:n,model:i}=t;if(n==="dataChanged"||n==="ui")return;this.onModelUpdated(i)}}updateParams(e){const t=this.optionsFactory;t.refresh(e.filterParams,this.defaultOptions),this.setSimpleParams(e),this.filterModelFormatter.updateParams({optionsFactory:t,filterParams:e.filterParams})}onParentModelChanged(e,t){t?.afterFloatingFilter||t?.afterDataChange||this.onModelUpdated(e)}hasSingleInput(e){const t=this.optionsFactory.getCustomOption(e)?.numberOfInputs;return t==null||t==1}isTypeEditable(e){const t=["inRange","empty","blank","notBlank"];return!!e&&!this.readOnly&&this.hasSingleInput(e)&&t.indexOf(e)<0}getAriaLabel(e){return`${this.beans.colNames.getDisplayNameForColumn(e,"header",!0)} ${this.getLocaleTextFunc()("ariaFilterInput","Filter Input")}`}},XV={tag:"div",cls:"ag-floating-filter-input",role:"presentation",children:[{tag:"ag-input-text-field",ref:"eReadOnlyText"},{tag:"div",ref:"eDateWrapper",cls:"ag-date-floating-filter-wrapper"}]},YV=class extends UR{constructor(){super(XV,[sm]),this.eReadOnlyText=xt,this.eDateWrapper=xt,this.FilterModelFormatterClass=zR,this.filterType="date",this.defaultOptions=Wy}setParams(e){super.setParams(e),this.createDateComponent();const t=this.getLocaleTextFunc();this.eReadOnlyText.setDisabled(!0).setInputAriaLabel(t("ariaDateFilterInput","Date Filter Input"))}updateParams(e){super.updateParams(e),this.dateComp.updateParams(this.getDateComponentParams()),this.updateCompOnModelChange(e.currentParentModel())}updateCompOnModelChange(e){const t=!this.readOnly&&this.canWeEditAfterModelFromParentFilter(e);if(this.setEditable(t),t){const r=e?ji(e.dateFrom):null;this.dateComp.setDate(r),this.eReadOnlyText.setValue("")}else this.eReadOnlyText.setValue(this.filterModelFormatter.getModelAsString(e)),this.dateComp.setDate(null)}setEditable(e){Gr(this.eDateWrapper,e),Gr(this.eReadOnlyText.getGui(),!e)}onModelUpdated(e){super.setLastTypeFromModel(e),this.updateCompOnModelChange(e)}onDateChanged(){const e=this.dateComp.getDate();if(this.reactive){const t=this.params;t.onUiChange();const r=t.model,n=ns(e),i=n==null?null:{...r??{filterType:this.filterType,type:this.lastType??this.optionsFactory.defaultOption},dateFrom:n};t.onModelChange(i,{afterFloatingFilter:!0})}else this.params.parentFilterInstance(t=>{t?.onFloatingFilterChanged(this.lastType||null,e)})}getDateComponentParams(){const{filterParams:e}=this.params,t=Ry(e,this.defaultDebounceMs);return Dt(this.gos,{onDateChanged:zn(this,this.onDateChanged.bind(this),t),filterParams:e,location:"floatingFilter"})}createDateComponent(){const{beans:{context:e,userCompFactory:t},eDateWrapper:r,params:{column:n}}=this;this.dateComp=new BR(e,t,n.getColDef(),this.getDateComponentParams(),r,i=>{i.setInputAriaLabel(this.getAriaLabel(n))}),this.addDestroyFunc(()=>this.dateComp.destroy())}},ZV={tag:"div",cls:"ag-filter-filter",children:[{tag:"ag-input-text-field",ref:"eDateInput",cls:"ag-date-filter"}]},JV=class extends pn{constructor(){super(ZV,[sm]),this.eDateInput=xt,this.isApply=!1,this.applyOnFocusOut=!1}init(e){this.params=e,this.setParams(e);const t=this.eDateInput.getInputElement();this.addManagedListeners(t,{mouseDown:()=>{this.eDateInput.isDisabled()||this.usingSafariDatePicker||t.focus({preventScroll:!0})},input:this.handleInput.bind(this,!1),change:this.handleInput.bind(this,!0),focusout:this.handleFocusOut.bind(this),focusin:this.handleFocusIn.bind(this)})}handleInput(e){if(!this.eDateInput.isDisabled()){if(this.isApply){this.applyOnFocusOut=!e,e&&this.params.onDateChanged();return}e||this.params.onDateChanged()}}handleFocusOut(){this.applyOnFocusOut&&(this.applyOnFocusOut=!1,this.params.onDateChanged())}handleFocusIn(){this.params.onFocusIn?.()}setParams(e){const t=this.eDateInput.getInputElement(),r=this.shouldUseBrowserDatePicker(e);this.usingSafariDatePicker=r&&bl();const{minValidYear:n,maxValidYear:i,minValidDate:s,maxValidDate:o,buttons:a,includeTime:l,colDef:c}=e.filterParams||{},u=this.beans.dataTypeSvc,h=l??u?.getDateIncludesTimeFlag?.(c.cellDataType)??!1;if(r?h?(t.type="datetime-local",t.step="1"):t.type="date":t.type="text",s&&n&&at(85),o&&i&&at(86),s&&o){const[d,f]=[s,o].map(m=>m instanceof Date?m:ji(m));d&&f&&d.getTime()>f.getTime()&&at(87)}s?s instanceof Date?t.min=cw(s):t.min=s:n&&(t.min=`${n}-01-01`),o?o instanceof Date?t.max=cw(o):t.max=o:i&&(t.max=`${i}-12-31`),this.isApply=e.location==="floatingFilter"&&!!a?.includes("apply")}refresh(e){this.params=e,this.setParams(e)}getDate(){return ji(this.eDateInput.getValue())}setDate(e){const t=this.params.filterParams.colDef.cellDataType,r=this.beans.dataTypeSvc?.getDateIncludesTimeFlag(t)??!1;this.eDateInput.setValue(ns(e,r))}setInputPlaceholder(e){this.eDateInput.setInputPlaceholder(e)}setInputAriaLabel(e){this.eDateInput.setAriaLabel(e)}setDisabled(e){this.eDateInput.setDisabled(e)}afterGuiAttached(e){e?.suppressFocus||this.eDateInput.getInputElement().focus({preventScroll:!0})}shouldUseBrowserDatePicker(e){return e?.filterParams?.browserDatePicker??!0}},qy=["equals","notEqual","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","inRange","blank","notBlank"];function Ew(e){return e?.allowedCharPattern??null}function P0(e){return e==null||isNaN(e)?null:e}function WR(e,t){const{filter:r,filterTo:n,type:i}=e||{};return[P0(r),P0(n)].slice(0,bf(i,t))}var QV=class extends Uy{constructor(){super("numberFilter",WR,qy),this.eValuesFrom=[],this.eValuesTo=[],this.filterType="number",this.defaultDebounceMs=500}afterGuiAttached(e){super.afterGuiAttached(e),this.refreshInputValidation()}shouldKeepInvalidInputState(){return!pf()&&this.hasInvalidInputs()&&this.getConditionTypes().includes("inRange")}refreshInputValidation(){for(let e=0;e<this.eValuesFrom.length;e++){const t=this.eValuesFrom[e],r=this.eValuesTo[e];this.refreshInputPairValidation(t,r)}}refreshInputPairValidation(e,t,r=!1){const n=this.params.numberParser,i=e3(n,e),s=e3(n,t),o=eG(i,s,r),a=o?this.translate(o,[String(r?s:i)]):"";(r?e:t).setCustomValidity(a),(r?t:e).setCustomValidity(""),a.length>0&&this.beans.ariaAnnounce.announceValue(a,"dateFilter")}getState(){return{isInvalid:this.hasInvalidInputs()}}areStatesEqual(e,t){return(e?.isInvalid??!1)===(t?.isInvalid??!1)}refresh(e){const t=super.refresh(e),{state:r,additionalEventAttributes:n}=e,i=this.state,s=n?.fromAction;return(s&&s!="apply"||r.model!==i.model||!this.areStatesEqual(r.state,i.state))&&this.refreshInputValidation(),t}setElementValue(e,t,r){const{numberFormatter:n}=this.params,i=!r&&n?n(t??null):t;super.setElementValue(e,i),i===null&&e.setCustomValidity("")}createEValue(){const{params:e,eValuesFrom:t,eValuesTo:r}=this,n=Ew(e),i=ks({tag:"div",cls:"ag-filter-body",role:"presentation"}),s=this.createFromToElement(i,t,"from",n),o=this.createFromToElement(i,r,"to",n),a=(u,h,d)=>()=>this.refreshInputPairValidation(u,h,d),l=a(s,o,!0);s.onValueChange(l),s.addGuiEventListener("focusin",l);const c=a(s,o,!1);return o.onValueChange(c),o.addGuiEventListener("focusin",c),i}createFromToElement(e,t,r,n){const i=this.createManagedBean(n?new Dc({allowedCharPattern:n}):new xy);return i.addCss(`ag-filter-${r}`),i.addCss("ag-filter-filter"),t.push(i),e.appendChild(i.getGui()),i}removeEValues(e,t){const r=n=>this.removeComponents(n,e,t);r(this.eValuesFrom),r(this.eValuesTo)}getValues(e){const t=[];return this.forEachPositionInput(e,(r,n,i,s)=>{n<s&&t.push(P0($R(this.params.numberParser,r.getValue())))}),t}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}createCondition(e){const t=this.getConditionType(e),r={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(r.filter=n[0]),n.length>1&&(r.filterTo=n[1]),r}removeConditionsAndOperators(e,t){if(!this.hasInvalidInputs())return super.removeConditionsAndOperators(e,t)}getInputs(e){const{eValuesFrom:t,eValuesTo:r}=this;return e>=t.length?[null,null]:[t[e],r[e]]}hasInvalidInputs(){let e=!1;return this.forEachInput(t=>e||(e=!t.getInputElement().validity.valid)),e}positionHasInvalidInputs(e){let t=!1;return this.forEachPositionInput(e,r=>t||(t=!r.getInputElement().validity.valid)),t}canApply(e){return!this.hasInvalidInputs()}};function $R(e,t){if(typeof t=="number")return t;let r=ea(t);return r!=null&&r.trim()===""&&(r=null),e?e(r):r==null||r.trim()==="-"?null:Number.parseFloat(r)}function e3(e,t){return P0($R(e,t.getValue(!0)))}function eG(e,t,r){return e!=null&&t!=null&&e>=t?`strict${r?"Max":"Min"}ValueValidation`:null}var qR=class extends $y{constructor(e,t){super(e,t,t.numberFormatter),this.filterTypeKeys=GR}conditionToString(e,t,r,n,i){const{filter:s,filterTo:o,type:a}=e,l=this.formatValue.bind(this);if(t){const c=this.conditionForToolPanel(a,r,()=>l(s),()=>l(o),n,i);if(c!=null)return c}return r?`${l(s)}-${l(o)}`:s!=null?l(s):`${a}`}},tG=class extends VR{constructor(){super(WR,qy),this.filterType="number",this.FilterModelFormatterClass=qR}comparator(){return(e,t)=>e===t?0:e<t?1:-1}isValid(e){return!isNaN(e)}},KR=class extends et{constructor(e){super(),this.params=e,this.eInput=xt,this.onValueChanged=()=>{}}setupGui(e){this.eInput=this.createManagedBean(new Dc(this.params?.config));const t=this.eInput.getGui();e.appendChild(t);const r=n=>this.onValueChanged(n);this.addManagedListeners(t,{input:r,keydown:r})}setEditable(e){this.eInput.setDisabled(!e)}getValue(){return this.eInput.getValue()}setValue(e,t){this.eInput.setValue(e,t)}setValueChangedListener(e){this.onValueChanged=e}setParams({ariaLabel:e,autoComplete:t,placeholder:r}){const{eInput:n}=this;n.setInputAriaLabel(e),t!==void 0&&n.setAutoComplete(t),n.toggleCss("ag-floating-filter-search-icon",!!r),n.setInputPlaceholder(r)}};function Tw(e){const t=e?.trim();return t===""?e:t}function XR(e,t){const{filter:r,filterTo:n,type:i}=e||{};return[r||null,n||null].slice(0,bf(i,t))}var rG={tag:"div",ref:"eFloatingFilterInputContainer",cls:"ag-floating-filter-input",role:"presentation"},YR=class extends UR{constructor(){super(...arguments),this.eFloatingFilterInputContainer=xt,this.defaultDebounceMs=500}postConstruct(){this.setTemplate(rG)}onModelUpdated(e){this.setLastTypeFromModel(e),this.setEditable(this.canWeEditAfterModelFromParentFilter(e)),this.inputSvc.setValue(this.filterModelFormatter.getModelAsString(e))}setParams(e){this.setupFloatingFilterInputService(e),super.setParams(e),this.setTextInputParams(e)}setupFloatingFilterInputService(e){this.inputSvc=this.createFloatingFilterInputService(e),this.inputSvc.setupGui(this.eFloatingFilterInputContainer)}setTextInputParams(e){const{inputSvc:t,defaultDebounceMs:r,readOnly:n}=this,{filterPlaceholder:i,column:s,browserAutoComplete:o,filterParams:a}=e,l=this.lastType??this.optionsFactory.defaultOption,c=e.filterParams.filterPlaceholder,u=i===!0?$k(this,c,"filterOoo",l):i||void 0;if(t.setParams({ariaLabel:this.getAriaLabel(s),autoComplete:o??!1,placeholder:u}),this.applyActive=am(a),!n){const h=Ry(a,r);t.setValueChangedListener(zn(this,this.syncUpWithParentFilter.bind(this),h))}}updateParams(e){super.updateParams(e),this.setTextInputParams(e)}recreateFloatingFilterInputService(e){const{inputSvc:t}=this,r=t.getValue();Hi(this.eFloatingFilterInputContainer),this.destroyBean(t),this.setupFloatingFilterInputService(e),t.setValue(r,!0)}syncUpWithParentFilter(e){const t=e.key===$e.ENTER,r=this.reactive;if(r&&this.params.onUiChange(),this.applyActive&&!t)return;const{inputSvc:n,params:i,lastType:s}=this;let o=n.getValue();if(i.filterParams.trimInput&&(o=Tw(o),n.setValue(o,!0)),r){const a=i,l=a.model,c=this.convertValue(o),u=c==null?null:{...l??{filterType:this.filterType,type:s??this.optionsFactory.defaultOption},filter:c};a.onModelChange(u,{afterFloatingFilter:!0})}else i.parentFilterInstance(a=>{a?.onFloatingFilterChanged(s||null,o||null)})}convertValue(e){return e||null}setEditable(e){this.inputSvc.setEditable(e)}},nG=class extends et{constructor(){super(...arguments),this.onValueChanged=()=>{},this.numberInputActive=!0}setupGui(e){this.eNumberInput=this.createManagedBean(new xy),this.eTextInput=this.createManagedBean(new Dc),this.eTextInput.setDisabled(!0);const t=this.eNumberInput.getGui(),r=this.eTextInput.getGui();e.appendChild(t),e.appendChild(r),this.setupListeners(t,n=>this.onValueChanged(n)),this.setupListeners(r,n=>this.onValueChanged(n))}setEditable(e){this.numberInputActive=e,this.eNumberInput.setDisplayed(this.numberInputActive),this.eTextInput.setDisplayed(!this.numberInputActive)}setAutoComplete(e){this.eNumberInput.setAutoComplete(e),this.eTextInput.setAutoComplete(e)}getValue(){return this.getActiveInputElement().getValue()}setValue(e,t){this.getActiveInputElement().setValue(e,t)}getActiveInputElement(){return this.numberInputActive?this.eNumberInput:this.eTextInput}setValueChangedListener(e){this.onValueChanged=e}setupListeners(e,t){this.addManagedListeners(e,{input:t,keydown:t})}setParams({ariaLabel:e,autoComplete:t,placeholder:r}){this.setAriaLabel(e),t!==void 0&&this.setAutoComplete(t),this.setPlaceholder(this.eNumberInput,r),this.setPlaceholder(this.eTextInput,r)}setPlaceholder(e,t){e.toggleCss("ag-floating-filter-search-icon",!!t),e.setInputPlaceholder(t)}setAriaLabel(e){this.eNumberInput.setInputAriaLabel(e),this.eTextInput.setInputAriaLabel(e)}},iG=class extends YR{constructor(){super(...arguments),this.FilterModelFormatterClass=qR,this.filterType="number",this.defaultOptions=qy}updateParams(e){Ew(e.filterParams)!==this.allowedCharPattern&&this.recreateFloatingFilterInputService(e),super.updateParams(e)}createFloatingFilterInputService(e){return this.allowedCharPattern=Ew(e.filterParams),this.allowedCharPattern?this.createManagedBean(new KR({config:{allowedCharPattern:this.allowedCharPattern}})):this.createManagedBean(new nG)}convertValue(e){return e?Number(e):null}},Ky=["contains","notContains","equals","notEqual","startsWith","endsWith","blank","notBlank"],sG=class extends Uy{constructor(){super("textFilter",XR,Ky),this.filterType="text",this.eValuesFrom=[],this.eValuesTo=[],this.defaultDebounceMs=500}createCondition(e){const t=this.getConditionType(e),r={filterType:this.filterType,type:t},n=this.getValues(e);return n.length>0&&(r.filter=n[0]),n.length>1&&(r.filterTo=n[1]),r}areSimpleModelsEqual(e,t){return e.filter===t.filter&&e.filterTo===t.filterTo&&e.type===t.type}getInputs(e){const{eValuesFrom:t,eValuesTo:r}=this;return e>=t.length?[null,null]:[t[e],r[e]]}getValues(e){const t=[];return this.forEachPositionInput(e,(r,n,i,s)=>{n<s&&t.push(ea(r.getValue()))}),t}createEValue(){const e=ks({tag:"div",cls:"ag-filter-body",role:"presentation"}),{eValuesFrom:t,eValuesTo:r}=this;return this.createFromToElement(e,t,"from"),this.createFromToElement(e,r,"to"),e}createFromToElement(e,t,r){const n=this.createManagedBean(new Dc);n.addCss(`ag-filter-${r}`),n.addCss("ag-filter-filter"),t.push(n),e.appendChild(n.getGui())}removeEValues(e,t){const r=s=>this.removeComponents(s,e,t),{eValuesFrom:n,eValuesTo:i}=this;r(n),r(i)}},ZR=class extends $y{constructor(){super(...arguments),this.filterTypeKeys=$V}conditionToString(e,t,r,n,i){const{filter:s,filterTo:o,type:a}=e;if(t){const l=u=>()=>go(this,"filterSummaryTextQuote",[u]),c=this.conditionForToolPanel(a,r,l(s),l(o),n,i);if(c!=null)return c}return r?`${s}-${o}`:s!=null?`${s}`:`${a}`}},oG=({filterOption:e,value:t,filterText:r})=>{if(r==null)return!1;switch(e){case"contains":return t.includes(r);case"notContains":return!t.includes(r);case"equals":return t===r;case"notEqual":return t!=r;case"startsWith":return t.indexOf(r)===0;case"endsWith":{const n=t.lastIndexOf(r);return n>=0&&n===t.length-r.length}default:return!1}},aG=e=>e,lG=e=>e==null?null:e.toString().toLowerCase(),cG=class extends jR{constructor(){super(XR,Ky),this.filterType="text",this.FilterModelFormatterClass=ZR}updateParams(e){super.updateParams(e);const t=e.filterParams;this.matcher=t.textMatcher??oG,this.formatter=t.textFormatter??(t.caseSensitive?aG:lG)}evaluateNullValue(e){return e?["notEqual","notContains","blank"].indexOf(e)>=0:!1}evaluateNonNullValue(e,t,r,n){const i=e.map(d=>this.formatter(d))||[],s=this.formatter(t),{api:o,colDef:a,column:l,context:c,filterParams:{textFormatter:u}}=this.params;if(r.type==="blank")return D0(t);if(r.type==="notBlank")return!D0(t);const h={api:o,colDef:a,column:l,context:c,node:n.node,data:n.data,filterOption:r.type,value:s,textFormatter:u};return i.some(d=>this.matcher({...h,filterText:d}))}processModelToApply(e){if(e&&this.params.filterParams.trimInput){const t=r=>{const n={...r},{filter:i,filterTo:s}=r;return i&&(n.filter=Tw(i)??null),s&&(n.filterTo=Tw(s)??null),n};return Kk(e)?{...e,conditions:e.conditions.map(t)}:t(e)}return e}},uG=class extends YR{constructor(){super(...arguments),this.FilterModelFormatterClass=ZR,this.filterType="text",this.defaultOptions=Ky}createFloatingFilterInputService(){return this.createManagedBean(new KR)}};function dG(e){return!!e.quickFilter?.isFilterPresent()}function hG(e){return e.quickFilter?.getText()}function fG(e){e.quickFilter?.resetCache()}var pG=class extends et{constructor(){super(...arguments),this.beanName="quickFilter",this.quickFilter=null,this.quickFilterParts=null}postConstruct(){const e=this.resetCache.bind(this),t=this.gos;this.addManagedEventListeners({columnPivotModeChanged:e,newColumnsLoaded:e,columnRowGroupChanged:e,columnVisible:()=>{t.get("includeHiddenColumnsInQuickFilter")||this.resetCache()}}),this.addManagedPropertyListener("quickFilterText",r=>this.setFilter(r.currentValue)),this.addManagedPropertyListeners(["includeHiddenColumnsInQuickFilter","applyQuickFilterBeforePivotOrAgg"],()=>this.onColumnConfigChanged()),this.quickFilter=this.parseFilter(t.get("quickFilterText")),this.parser=t.get("quickFilterParser"),this.matcher=t.get("quickFilterMatcher"),this.setFilterParts(),this.addManagedPropertyListeners(["quickFilterMatcher","quickFilterParser"],()=>this.setParserAndMatcher())}refreshCols(){const{autoColSvc:e,colModel:t,gos:r,pivotResultCols:n}=this.beans,i=t.isPivotMode(),s=e?.getColumns(),o=t.getColDefCols();let a=(i&&!r.get("applyQuickFilterBeforePivotOrAgg")?n?.getPivotResultCols()?.list:o)??[];s&&(a=a.concat(s)),this.colsToUse=r.get("includeHiddenColumnsInQuickFilter")?a:a.filter(l=>l.isVisible()||l.isRowGroupActive())}isFilterPresent(){return this.quickFilter!==null}doesRowPass(e){const t=this.gos.get("cacheQuickFilter");return this.matcher?this.doesRowPassMatcher(t,e):this.quickFilterParts.every(r=>t?this.doesRowPassCache(e,r):this.doesRowPassNoCache(e,r))}resetCache(){this.beans.rowModel.forEachNode(e=>e.quickFilterAggregateText=null)}getText(){return this.gos.get("quickFilterText")}setFilterParts(){const{quickFilter:e,parser:t}=this;e?this.quickFilterParts=t?t(e):e.split(" "):this.quickFilterParts=null}parseFilter(e){return bt(e)?e.toUpperCase():null}setFilter(e){if(e!=null&&typeof e!="string"){at(70,{newFilter:e});return}const t=this.parseFilter(e);this.quickFilter!==t&&(this.quickFilter=t,this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}setParserAndMatcher(){const e=this.gos.get("quickFilterParser"),t=this.gos.get("quickFilterMatcher"),r=e!==this.parser||t!==this.matcher;this.parser=e,this.matcher=t,r&&(this.setFilterParts(),this.dispatchLocalEvent({type:"quickFilterChanged"}))}onColumnConfigChanged(){this.refreshCols(),this.resetCache(),this.isFilterPresent()&&this.dispatchLocalEvent({type:"quickFilterChanged"})}doesRowPassNoCache(e,t){return this.colsToUse.some(r=>{const n=this.getTextForColumn(r,e);return bt(n)&&n.includes(t)})}doesRowPassCache(e,t){return this.checkGenerateAggText(e),e.quickFilterAggregateText.includes(t)}doesRowPassMatcher(e,t){let r;e?(this.checkGenerateAggText(t),r=t.quickFilterAggregateText):r=this.getAggText(t);const{quickFilterParts:n,matcher:i}=this;return i(n,r)}checkGenerateAggText(e){e.quickFilterAggregateText||(e.quickFilterAggregateText=this.getAggText(e))}getTextForColumn(e,t){let r=this.beans.filterValueSvc.getValue(e,t);const n=e.getColDef();if(n.getQuickFilterText){const i=Dt(this.gos,{value:r,node:t,data:t.data,column:e,colDef:n});r=n.getQuickFilterText(i)}return bt(r)?r.toString().toUpperCase():null}getAggText(e){const t=[];for(const r of this.colsToUse){const n=this.getTextForColumn(r,e);bt(n)&&t.push(n)}return t.join(`
`)}},gG={moduleName:"ClientSideRowModelFilter",version:wt,rowModels:["clientSide"],beans:[pV]},Xy={moduleName:"FilterCore",version:wt,beans:[NV],apiFunctions:{isAnyFilterPresent:IV,onFilterChanged:OV},css:[yV],dependsOn:[gG]},JR={moduleName:"FilterValue",version:wt,beans:[BV]},fm={moduleName:"ColumnFilter",version:wt,beans:[PV,LV],dynamicBeans:{headerFilterCellCtrl:gV},icons:{filter:"filter",filterActive:"filter"},apiFunctions:{isColumnFilterPresent:CV,getColumnFilterInstance:xV,destroyFilter:SV,setFilterModel:_V,getFilterModel:EV,getColumnFilterModel:TV,setColumnFilterModel:kV,showColumnFilter:RV,hideColumnFilter:AV,getColumnFilterHandler:FV,doFilterAction:MV},dependsOn:[Xy,hm,JR,bV]},mG={moduleName:"CustomFilter",version:wt,userComponents:{agReadOnlyFloatingFilter:jV},dependsOn:[fm]},vG={moduleName:"TextFilter",version:wt,dependsOn:[fm],userComponents:{agTextColumnFilter:{classImp:sG,params:{useForm:!0}},agTextColumnFloatingFilter:uG},dynamicBeans:{agTextColumnFilterHandler:cG}},bG={moduleName:"NumberFilter",version:wt,dependsOn:[fm],userComponents:{agNumberColumnFilter:{classImp:QV,params:{useForm:!0}},agNumberColumnFloatingFilter:iG},dynamicBeans:{agNumberColumnFilterHandler:tG}},wG={moduleName:"DateFilter",version:wt,dependsOn:[fm],userComponents:{agDateColumnFilter:{classImp:UV,params:{useForm:!0}},agDateInput:JV,agDateColumnFloatingFilter:YV},dynamicBeans:{agDateColumnFilterHandler:KV}},yG={moduleName:"QuickFilterCore",version:wt,rowModels:["clientSide"],beans:[pG],dependsOn:[Xy,JR]},CG={moduleName:"QuickFilter",version:wt,apiFunctions:{isQuickFilterPresent:dG,getQuickFilter:hG,resetQuickFilter:fG},dependsOn:[yG]},xG={moduleName:"ExternalFilter",version:wt,dependsOn:[Xy]},SG=".ag-tooltip{background-color:var(--ag-tooltip-background-color);border:var(--ag-tooltip-border);border-radius:var(--ag-border-radius);color:var(--ag-tooltip-text-color);padding:var(--ag-widget-container-vertical-padding) var(--ag-widget-container-horizontal-padding);position:absolute;white-space:normal;z-index:99999;&:where(.ag-cell-editor-tooltip),&:where(.ag-cell-formula-tooltip){background-color:var(--ag-tooltip-error-background-color);border:var(--ag-tooltip-error-border);color:var(--ag-tooltip-error-text-color);font-weight:500}}.ag-tooltip-custom{position:absolute;z-index:99999}.ag-tooltip-custom:where(:not(.ag-tooltip-interactive)),.ag-tooltip:where(:not(.ag-tooltip-interactive)){pointer-events:none}.ag-tooltip-animate{transition:opacity 1s;&:where(.ag-tooltip-hiding){opacity:0}}",vb=(e,t,r)=>{const{editModelSvc:n}=e,i=n?.getCellValidationModel()?.getCellValidation(t)?.errorMessages,s=n?.getRowValidationModel().getRowValidation(t)?.errorMessages,o=i||s;return o?.length?o.join(r("tooltipValidationErrorSeparator",". ")):void 0},_G=class extends et{constructor(){super(...arguments),this.beanName="tooltipSvc"}setupHeaderTooltip(e,t,r,n){e&&t.destroyBean(e);const i=this.gos,s=mb(i),{column:o,eGui:a}=t,l=o.getColDef();!n&&s&&!l.headerComponent&&(n=Wg(()=>a.querySelector(".ag-header-cell-text")));const c="header",h=this.beans.colNames.getDisplayNameForColumn(o,"header",!0),d=r??h,f={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>r??l?.headerTooltipValueGetter?.(Dt(i,{location:c,colDef:l,column:o,value:d,valueFormatted:h}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>({column:o,colDef:o.getColDef()})};let m=this.createTooltipFeature(f);return m&&(m=t.createBean(m),t.setRefreshFunction("tooltip",()=>m.refreshTooltip())),m}setupHeaderGroupTooltip(e,t,r,n){e&&t.destroyBean(e);const i=this.gos,s=mb(i),{column:o,eGui:a}=t,l=o.getColGroupDef();!n&&s&&!l?.headerGroupComponent&&(n=Wg(()=>a.querySelector(".ag-header-group-text")));const c="headerGroup",h=this.beans.colNames.getDisplayNameForColumnGroup(o,"header"),d=r??h,f={getGui:()=>a,getLocation:()=>c,getTooltipValue:()=>r??l?.headerTooltipValueGetter?.(Dt(i,{location:c,colDef:l,column:o,value:d,valueFormatted:h}))??l?.headerTooltip,shouldDisplayTooltip:n,getAdditionalParams:()=>{const v={column:o};return l&&(v.colDef=l),v}},m=this.createTooltipFeature(f);return m&&t.createBean(m)}enableCellTooltipFeature(e,t,r){const{beans:n}=this,{gos:i,editSvc:s}=n,{column:o,rowNode:a}=e;let l="cell";const c=()=>{const f=!!!s?.isEditing(e)&&vb(n,e,this.getLocaleTextFunc());if(f)return l="cellEditor",f;l="cell";const m=o.getColDef(),v=a.data;if(m.tooltipField&&bt(v))return Wh(v,m.tooltipField,o.isTooltipFieldContainsDots());const g=m.tooltipValueGetter;return g?g(Dt(i,{location:"cell",colDef:o.getColDef(),column:o,rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,value:e.value,valueFormatted:e.valueFormatted})):null},u=mb(i);r||(u&&!e.isCellRenderer()?r=()=>{const d=!!s?.isEditing(e);if(!d&&vb(n,e,this.getLocaleTextFunc()))return!0;if(!o.isTooltipEnabled())return!1;const v=Wg(()=>{const g=e.eGui;return g.children.length===0?g:g.querySelector(".ag-cell-value")});return!d&&v()}:r=()=>!s?.isEditing(e));const h={getGui:()=>e.eGui,getLocation:()=>l,getTooltipValue:t!=null?()=>t:c,shouldDisplayTooltip:r,getAdditionalParams:()=>({column:o,colDef:o.getColDef(),rowIndex:e.cellPosition.rowIndex,node:a,data:a.data,valueFormatted:e.valueFormatted})};return this.createTooltipFeature(h,n)}setupFullWidthRowTooltip(e,t,r,n){const i={getGui:()=>t.getFullWidthElement(),getTooltipValue:()=>r,getLocation:()=>"fullWidthRow",shouldDisplayTooltip:n},s=this.beans,o=s.context;e&&t.destroyBean(e,o);const a=this.createTooltipFeature(i,s);if(a)return t.createBean(a,o)}setupFormulaTooltip(e){const{beans:t}=this,{context:r,formula:n}=t;if(!this.beans.formula?.active||!e.column.isAllowFormula())return;const i={getGui:()=>e.eGui,getTooltipValue:()=>{const o=n?.getFormulaError(e.column,e.rowNode);return o?o.message:void 0},getLocation:()=>"cellFormula",shouldDisplayTooltip:()=>!!n?.getFormulaError(e.column,e.rowNode)},s=this.createTooltipFeature(i,t);if(s)return e.createBean(s,r)}setupCellEditorTooltip(e,t){const{beans:r}=this,{context:n}=r,i=t.getValidationElement?.(!0)||!t.isPopup?.()&&e.eGui;if(!i)return;const s={getGui:()=>i,getTooltipValue:()=>vb(r,e,this.getLocaleTextFunc()),getLocation:()=>"cellEditor",shouldDisplayTooltip:()=>{const{editModelSvc:a}=r,l=a?.getRowValidationModel()?.getRowValidationMap(),c=a?.getCellValidationModel()?.getCellValidationMap(),u=!!l&&l.size>0,h=!!c&&c.size>0;return u||h}},o=this.createTooltipFeature(s,r);if(o)return e.createBean(o,n)}initCol(e){const{colDef:t}=e;e.tooltipEnabled=bt(t.tooltipField)||bt(t.tooltipValueGetter)||bt(t.tooltipComponent)}createTooltipFeature(e,t){return this.beans.registry.createDynamicBean("tooltipFeature",!1,e,t)}},EG=class extends p9{createTooltipComp(e,t){YP(this.beans.userCompFactory,e)?.newAgStackInstance().then(t)}setEventHandlers(e){[this.onColumnMovedEventCallback]=this.addManagedEventListeners({columnMoved:e})}clearEventHandlers(){this.onColumnMovedEventCallback?.(),this.onColumnMovedEventCallback=void 0}},QR={moduleName:"Tooltip",version:wt,beans:[_G],dynamicBeans:{tooltipFeature:Hk,highlightTooltipFeature:g9,tooltipStateManager:EG},userComponents:{agTooltipComponent:b9},dependsOn:[hm],css:[SG]},ku=class{constructor(e){this.cellValueChanges=e}},bb=class extends ku{constructor(e,t,r,n){super(e),this.initialRange=t,this.finalRange=r,this.ranges=n}},TG=10,t3=class{constructor(e){this.actionStack=[],this.maxStackSize=e||TG,this.actionStack=new Array(this.maxStackSize)}pop(){return this.actionStack.pop()}push(e){e.cellValueChanges&&e.cellValueChanges.length>0&&(this.actionStack.length===this.maxStackSize&&this.actionStack.shift(),this.actionStack.push(e))}clear(){this.actionStack=[]}getCurrentStackSize(){return this.actionStack.length}},kG=class extends et{constructor(){super(...arguments),this.beanName="undoRedo",this.cellValueChanges=[],this.activeCellEdit=null,this.activeRowEdit=null,this.isPasting=!1,this.isRangeInAction=!1,this.batchEditing=!1,this.bulkEditing=!1,this.onCellValueChanged=e=>{const t={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned},r=this.activeCellEdit!==null&&Py(this.activeCellEdit,t),n=this.activeRowEdit!==null&&TI(this.activeRowEdit,t);if(!(r||n||this.isPasting||this.isRangeInAction))return;const{rowPinned:s,rowIndex:o,column:a,oldValue:l,value:c}=e,u={rowPinned:s,rowIndex:o,columnId:a.getColId(),newValue:c,oldValue:l};this.cellValueChanges.push(u)},this.clearStacks=()=>{this.undoStack.clear(),this.redoStack.clear()}}postConstruct(){const{gos:e,ctrlsSvc:t}=this.beans;if(!e.get("undoRedoCellEditing"))return;const r=e.get("undoRedoCellEditingLimit");if(r<=0)return;this.undoStack=new t3(r),this.redoStack=new t3(r),this.addListeners();const n=this.clearStacks.bind(this);this.addManagedEventListeners({cellValueChanged:this.onCellValueChanged.bind(this),modelUpdated:i=>{i.keepUndoRedoStack||this.clearStacks()},columnPivotModeChanged:n,newColumnsLoaded:n,columnGroupOpened:n,columnRowGroupChanged:n,columnMoved:n,columnPinned:n,columnVisible:n,rowDragEnd:n}),t.whenReady(this,i=>{this.gridBodyCtrl=i.gridBodyCtrl})}getCurrentUndoStackSize(){return this.undoStack?.getCurrentStackSize()??0}getCurrentRedoStackSize(){return this.redoStack?.getCurrentStackSize()??0}undo(e){const{eventSvc:t,undoStack:r,redoStack:n}=this;t.dispatchEvent({type:"undoStarted",source:e});const i=this.undoRedo(r,n,"initialRange","oldValue","undo");t.dispatchEvent({type:"undoEnded",source:e,operationPerformed:i})}redo(e){const{eventSvc:t,undoStack:r,redoStack:n}=this;t.dispatchEvent({type:"redoStarted",source:e});const i=this.undoRedo(n,r,"finalRange","newValue","redo");t.dispatchEvent({type:"redoEnded",source:e,operationPerformed:i})}undoRedo(e,t,r,n,i){if(!e)return!1;const s=e.pop();return s?.cellValueChanges?(this.processAction(s,o=>o[n],i),s instanceof bb?this.processRange(s.ranges||[s[r]]):this.processCell(s.cellValueChanges),t.push(s),!0):!1}processAction(e,t,r){for(const n of e.cellValueChanges){const{rowIndex:i,rowPinned:s,columnId:o}=n,a={rowIndex:i,rowPinned:s},l=ca(this.beans,a);l.displayed&&l.setDataValue(o,t(n),r)}}processRange(e){let t;const r=this.beans.rangeSvc;r.removeAllCellRanges(!0),e.forEach((n,i)=>{if(!n)return;const s=n.startRow,o=n.endRow;i===e.length-1&&(t={rowPinned:s.rowPinned,rowIndex:s.rowIndex,columnId:n.startColumn.getColId()},this.setLastFocusedCell(t));const a={rowStartIndex:s.rowIndex,rowStartPinned:s.rowPinned,rowEndIndex:o.rowIndex,rowEndPinned:o.rowPinned,columnStart:n.startColumn,columns:n.columns};r.addCellRange(a)})}processCell(e){const t=e[0],{rowIndex:r,rowPinned:n}=t,i={rowIndex:r,rowPinned:n},s=ca(this.beans,i),o={rowPinned:t.rowPinned,rowIndex:s.rowIndex,columnId:t.columnId};this.setLastFocusedCell(o)}setLastFocusedCell(e){const{rowIndex:t,columnId:r,rowPinned:n}=e,{colModel:i,focusSvc:s,rangeSvc:o}=this.beans,a=i.getCol(r);if(!a)return;const{scrollFeature:l}=this.gridBodyCtrl;l.ensureIndexVisible(t),l.ensureColumnVisible(a);const c={rowIndex:t,column:a,rowPinned:n};s.setFocusedCell({...c,forceBrowserFocus:!0}),o?.setRangeToCell(c)}addListeners(){this.addManagedEventListeners({rowEditingStarted:e=>{this.activeRowEdit={rowIndex:e.rowIndex,rowPinned:e.rowPinned}},rowEditingStopped:()=>{const e=new ku(this.cellValueChanges);this.pushActionsToUndoStack(e),this.activeRowEdit=null},cellEditingStarted:e=>{this.activeCellEdit={column:e.column,rowIndex:e.rowIndex,rowPinned:e.rowPinned}},cellEditingStopped:e=>{if(this.activeCellEdit=null,e.valueChanged&&!this.activeRowEdit&&!this.isPasting&&!this.isRangeInAction){const r=new ku(this.cellValueChanges);this.pushActionsToUndoStack(r)}},pasteStart:()=>{this.isPasting=!0},pasteEnd:()=>{const e=new ku(this.cellValueChanges);this.pushActionsToUndoStack(e),this.isPasting=!1},fillStart:()=>{this.isRangeInAction=!0},fillEnd:e=>{const t=new bb(this.cellValueChanges,e.initialRange,e.finalRange);this.pushActionsToUndoStack(t),this.isRangeInAction=!1},keyShortcutChangedCellStart:()=>{this.isRangeInAction=!0},keyShortcutChangedCellEnd:()=>{let e;const{rangeSvc:t,gos:r}=this.beans;t&&ll(r)?e=new bb(this.cellValueChanges,void 0,void 0,[...t.getCellRanges()]):e=new ku(this.cellValueChanges),this.pushActionsToUndoStack(e),this.isRangeInAction=!1},batchEditingStarted:()=>this.startBigChange("batchEditing"),batchEditingStopped:({changes:e})=>this.stopBigChange("batchEditing",e),bulkEditingStarted:()=>this.startBigChange("bulkEditing"),bulkEditingStopped:({changes:e})=>this.stopBigChange("bulkEditing",e)})}startBigChange(e){this.updateBigChange(e,!0)}updateBigChange(e,t){e==="bulkEditing"?this.bulkEditing=t:this.batchEditing=t}stopBigChange(e,t){if(e==="bulkEditing"&&!this.bulkEditing||e==="batchEditing"&&!this.batchEditing||(this.updateBigChange(e,!1),t?.length===0))return;const r=new ku(t??[]);this.pushActionsToUndoStack(r),this.cellValueChanges=[]}pushActionsToUndoStack(e){this.undoStack.push(e),this.cellValueChanges=[],this.redoStack.clear()}},RG=".ag-cell-inline-editing{border:var(--ag-cell-editing-border)!important;border-radius:var(--ag-border-radius);box-shadow:var(--ag-cell-editing-shadow);padding:0;z-index:1;.ag-cell-edit-wrapper,.ag-cell-editor,.ag-cell-wrapper,:where(.ag-cell-editor) .ag-input-field-input,:where(.ag-cell-editor) .ag-wrapper{height:100%;line-height:normal;min-height:100%;width:100%}&.ag-cell-editing-error{border-color:var(--ag-invalid-color)!important}}:where(.ag-popup-editor) .ag-large-text{background-color:var(--ag-background-color);border-radius:var(--ag-border-radius);box-shadow:var(--ag-dropdown-shadow);padding:0}.ag-large-text-input{display:block;height:auto;padding:var(--ag-cell-horizontal-padding)}:where(.ag-rtl .ag-large-text-input) textarea{resize:none}:where(.ag-ltr) .ag-checkbox-edit{padding-left:var(--ag-cell-horizontal-padding)}:where(.ag-rtl) .ag-checkbox-edit{padding-right:var(--ag-cell-horizontal-padding)}:where(.ag-row.ag-row-editing-invalid .ag-cell-inline-editing){opacity:.8}.ag-popup-editor{position:absolute;-webkit-user-select:none;-moz-user-select:none;user-select:none}",AG={tag:"div",cls:"ag-cell-wrapper ag-cell-edit-wrapper ag-checkbox-edit",children:[{tag:"ag-checkbox",ref:"eEditor",role:"presentation"}]},FG=class extends cm{constructor(){super(AG,[Cy]),this.eEditor=xt}initialiseEditor(e){const t=e.value??void 0,r=this.eEditor;r.setValue(t),r.getInputElement().setAttribute("tabindex","-1"),this.setAriaLabel(t),this.addManagedListeners(r,{fieldValueChanged:i=>this.setAriaLabel(i.selected)})}getValue(){return this.eEditor.getValue()}focusIn(){this.eEditor.getFocusableElement().focus()}afterGuiAttached(){this.params.cellStartedEdit&&this.focusIn()}isPopup(){return!1}setAriaLabel(e){const t=this.getLocaleTextFunc(),r=tm(t,e),n=t("ariaToggleCellValue","Press SPACE to toggle cell value");this.eEditor.setInputAriaLabel(`${n} (${r})`)}getValidationElement(e){return e?this.params.eGridCell:this.eEditor.getInputElement()}getValidationErrors(){const{params:e}=this,{getValidationErrors:t}=e,r=this.getValue();return t?t({value:r,internalErrors:null,cellEditorParams:e}):null}},pm=class extends cm{constructor(e){super(),this.cellEditorInput=e,this.eEditor=xt}initialiseEditor(e){const{cellEditorInput:t}=this;this.setTemplate({tag:"div",cls:"ag-cell-edit-wrapper",children:[t.getTemplate()]},t.getAgComponents());const{eEditor:r}=this,{cellStartedEdit:n,eventKey:i,suppressPreventDefault:s}=e;r.getInputElement().setAttribute("title",""),t.init(r,e);let o,a=!0;n?(this.focusAfterAttached=!0,i===$e.BACKSPACE||i===$e.DELETE?o="":i&&i.length===1?s?a=!1:o=i:(o=t.getStartValue(),i!==$e.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,o=t.getStartValue()),a&&o!=null&&r.setStartValue(o),this.addGuiEventListener("keydown",l=>{const{key:c}=l;(c===$e.PAGE_UP||c===$e.PAGE_DOWN)&&l.preventDefault()})}afterGuiAttached(){const e=this.getLocaleTextFunc(),t=this.eEditor;if(t.setInputAriaLabel(e("ariaInputEditor","Input Editor")),!this.focusAfterAttached)return;bl()||t.getFocusableElement().focus();const r=t.getInputElement();this.highlightAllOnFocus?r.select():this.cellEditorInput.setCaret?.()}focusIn(){const{eEditor:e}=this,t=e.getFocusableElement(),r=e.getInputElement();t.focus(),r.select()}getValue(){return this.cellEditorInput.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){return this.cellEditorInput.getValidationErrors()}},MG={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},DG=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return MG}getAgComponents(){return[Fk]}init(e,t){this.eEditor=e,this.params=t;const{min:r,max:n,step:i,colDef:s}=t;r!=null&&e.setMin(r),n!=null&&e.setMax(n),i!=null&&e.setStep(i),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(s.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){const t=this.eEditor.getInputElement().valueAsDate,{params:r}=this,{min:n,max:i,getValidationErrors:s}=r;let o=[];const a=this.getLocaleTextFunc();if(t instanceof Date&&!isNaN(t.getTime())){if(n){const l=n instanceof Date?n:new Date(n);if(t<l){const c=l.toLocaleDateString();o.push(a("minDateValidation",`Date must be after ${c}`,[c]))}}if(i){const l=i instanceof Date?i:new Date(i);if(t>l){const c=l.toLocaleDateString();o.push(a("maxDateValidation",`Date must be before ${c}`,[c]))}}}return o.length||(o=null),s?s({value:t,cellEditorParams:r,internalErrors:o}):o}getValue(){const{eEditor:e,params:t}=this,r=e.getDate();return!bt(r)&&!bt(t.value)?t.value:r??null}getStartValue(){const{value:e}=this.params;if(e instanceof Date)return ns(e,this.includeTime??!1)}},PG=class extends pm{constructor(){super(new DG(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},IG={tag:"ag-input-date-field",ref:"eEditor",cls:"ag-cell-editor"},OG=class{constructor(e,t){this.getDataTypeService=e,this.getLocaleTextFunc=t}getTemplate(){return IG}getAgComponents(){return[Fk]}init(e,t){this.eEditor=e,this.params=t;const{min:r,max:n,step:i,colDef:s}=t;r!=null&&e.setMin(r),n!=null&&e.setMax(n),i!=null&&e.setStep(i),this.includeTime=t.includeTime??this.getDataTypeService()?.getDateIncludesTimeFlag?.(s.cellDataType),this.includeTime!=null&&e.setIncludeTime(this.includeTime)}getValidationErrors(){const{eEditor:e,params:t}=this,r=e.getInputElement().value,n=this.formatDate(this.parseDate(r??void 0)),{min:i,max:s,getValidationErrors:o}=t;let a=[];if(n){const l=new Date(n),c=this.getLocaleTextFunc();if(i){const u=new Date(i);if(l<u){const h=u.toLocaleDateString();a.push(c("minDateValidation",`Date must be after ${h}`,[h]))}}if(s){const u=new Date(s);if(l>u){const h=u.toLocaleDateString();a.push(c("maxDateValidation",`Date must be before ${h}`,[h]))}}}return a.length||(a=null),o?o({value:this.getValue(),cellEditorParams:t,internalErrors:a}):a}getValue(){const{params:e,eEditor:t}=this,r=this.formatDate(t.getDate());return!bt(r)&&!bt(e.value)?e.value:e.parseValue(r??"")}getStartValue(){return ns(this.parseDate(this.params.value??void 0)??null,this.includeTime??!1)}parseDate(e){const t=this.getDataTypeService();return t?t.getDateParserFunction(this.params.column)(e):ji(e)??void 0}formatDate(e){const t=this.getDataTypeService();return t?t.getDateFormatterFunction(this.params.column)(e):ns(e??null,this.includeTime??!1)??void 0}},NG=class extends pm{constructor(){super(new OG(()=>this.beans.dataTypeSvc,()=>this.getLocaleTextFunc()))}},LG={tag:"div",cls:"ag-large-text",children:[{tag:"ag-input-text-area",ref:"eEditor",cls:"ag-large-text-input"}]},BG=class extends cm{constructor(){super(LG,[S7]),this.eEditor=xt}initialiseEditor(e){const{eEditor:t}=this,{cellStartedEdit:r,eventKey:n,maxLength:i,cols:s,rows:o}=e;this.focusAfterAttached=r,t.getInputElement().setAttribute("title",""),t.setMaxLength(i||200).setCols(s||60).setRows(o||10);let a;r?(this.focusAfterAttached=!0,n===$e.BACKSPACE||n===$e.DELETE?a="":n&&n.length===1?a=n:(a=this.getStartValue(e),n!==$e.F2&&(this.highlightAllOnFocus=!0))):(this.focusAfterAttached=!1,a=this.getStartValue(e)),a!=null&&t.setValue(a,!0),this.addGuiEventListener("keydown",this.onKeyDown.bind(this)),this.activateTabIndex()}getStartValue(e){const{value:t}=e;return t?.toString()??t}onKeyDown(e){const t=e.key;(t===$e.LEFT||t===$e.UP||t===$e.RIGHT||t===$e.DOWN||e.shiftKey&&t===$e.ENTER)&&e.stopPropagation()}afterGuiAttached(){const{eEditor:e,focusAfterAttached:t,highlightAllOnFocus:r}=this,n=this.getLocaleTextFunc();e.setInputAriaLabel(n("ariaInputEditor","Input Editor")),t&&(e.getFocusableElement().focus(),r&&e.getInputElement().select())}getValue(){const{eEditor:e,params:t}=this,{value:r}=t,n=e.getValue();return!bt(n)&&!bt(r)?r:t.parseValue(n)}getValidationElement(){return this.eEditor.getInputElement()}getValidationErrors(){const{params:e}=this,{maxLength:t,getValidationErrors:r}=e,n=this.getLocaleTextFunc(),i=this.getValue();let s=[];return typeof i=="string"&&t!=null&&i.length>t&&s.push(n("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),s.length||(s=null),r?r({value:i,internalErrors:s,cellEditorParams:e}):s}},HG={tag:"ag-input-number-field",ref:"eEditor",cls:"ag-cell-editor"},jG=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return HG}getAgComponents(){return[_7]}init(e,t){this.eEditor=e,this.params=t;const{max:r,min:n,precision:i,step:s}=t;r!=null&&e.setMax(r),n!=null&&e.setMin(n),i!=null&&e.setPrecision(i),s!=null&&e.setStep(s);const o=e.getInputElement();t.preventStepping?e.addManagedElementListeners(o,{keydown:this.preventStepping}):t.showStepperButtons&&o.classList.add("ag-number-field-input-stepper")}getValidationErrors(){const{params:e}=this,{min:t,max:r,getValidationErrors:n}=e,s=this.eEditor.getInputElement().valueAsNumber,o=this.getLocaleTextFunc();let a=[];return typeof s=="number"&&(t!=null&&s<t&&a.push(o("minValueValidation",`Must be greater than or equal to ${t}.`,[String(t)])),r!=null&&s>r&&a.push(o("maxValueValidation",`Must be less than or equal to ${r}.`,[String(r)]))),a.length||(a=null),n?n({value:s,cellEditorParams:e,internalErrors:a}):a}preventStepping(e){(e.key===$e.UP||e.key===$e.DOWN)&&e.preventDefault()}getValue(){const{eEditor:e,params:t}=this,r=e.getValue();if(!bt(r)&&!bt(t.value))return t.value;let n=t.parseValue(r);if(n==null)return n;if(typeof n=="string"){if(n==="")return null;n=Number(n)}return isNaN(n)?null:n}getStartValue(){return this.params.value}setCaret(){bl()&&this.eEditor.getInputElement().focus({preventScroll:!0})}},VG=class extends pm{constructor(){super(new jG(()=>this.getLocaleTextFunc()))}},GG={tag:"div",cls:"ag-cell-edit-wrapper",children:[{tag:"ag-select",ref:"eEditor",cls:"ag-cell-editor"}]},zG=class extends cm{constructor(){super(GG,[O7]),this.eEditor=xt,this.startedByEnter=!1}wireBeans(e){this.valueSvc=e.valueSvc}initialiseEditor(e){this.focusAfterAttached=e.cellStartedEdit;const{eEditor:t,valueSvc:r,gos:n}=this,{values:i,value:s,eventKey:o}=e;if(Yr(i)){at(58);return}this.startedByEnter=o!=null?o===$e.ENTER:!1;let a=!1;i.forEach(h=>{const d={value:h},f=r.formatValue(e.column,null,h),m=f!=null;d.text=m?f:h,t.addOption(d),a=a||s===h}),a?t.setValue(e.value,!0):e.values.length&&t.setValue(e.values[0],!0);const{valueListGap:l,valueListMaxWidth:c,valueListMaxHeight:u}=e;l!=null&&t.setPickerGap(l),u!=null&&t.setPickerMaxHeight(u),c!=null&&t.setPickerMaxWidth(c),n.get("editType")!=="fullRow"&&this.addManagedListeners(this.eEditor,{selectedItem:()=>e.stopEditing()})}afterGuiAttached(){this.focusAfterAttached&&this.eEditor.getFocusableElement().focus(),this.startedByEnter&&setTimeout(()=>{this.isAlive()&&this.eEditor.showPicker()})}focusIn(){this.eEditor.getFocusableElement().focus()}getValue(){return this.eEditor.getValue()}isPopup(){return!1}getValidationElement(){return this.eEditor.getAriaElement()}getValidationErrors(){const{params:e}=this,{values:t,getValidationErrors:r}=e,n=this.getValue();let i=[];if(t&&!t.includes(n)){const s=this.getLocaleTextFunc();i.push(s("invalidSelectionValidation","Invalid selection."))}else i=null;return r?r({value:n,internalErrors:i,cellEditorParams:e}):i}},UG={tag:"ag-input-text-field",ref:"eEditor",cls:"ag-cell-editor"},WG=class{constructor(e){this.getLocaleTextFunc=e}getTemplate(){return UG}getAgComponents(){return[sm]}init(e,t){this.eEditor=e,this.params=t;const r=t.maxLength;r!=null&&e.setMaxLength(r)}getValidationErrors(){const{params:e}=this,{maxLength:t,getValidationErrors:r}=e,n=this.getValue(),i=this.getLocaleTextFunc();let s=[];return t!=null&&typeof n=="string"&&n.length>t&&s.push(i("maxLengthValidation",`Must be ${t} characters or fewer.`,[String(t)])),s.length||(s=null),r?r({value:n,cellEditorParams:e,internalErrors:s}):s}getValue(){const{eEditor:e,params:t}=this,r=e.getValue();return!bt(r)&&!bt(t.value)?t.value:t.parseValue(r)}getStartValue(){const e=this.params;return e.useFormatter||e.column.getColDef().refData?e.formatValue(e.value):e.value}setCaret(){bl()&&this.eEditor.getInputElement().focus({preventScroll:!0});const e=this.eEditor,t=e.getValue(),r=bt(t)&&t.length||0;r&&e.getInputElement().setSelectionRange(r,r)}},r3=class extends pm{constructor(){super(new WG(()=>this.getLocaleTextFunc()))}};function $G(e){return e.ctrlsSvc.getScrollFeature().getVScrollPosition()}function qG(e){return e.ctrlsSvc.getScrollFeature().getHScrollPosition()}function e6(e,t,r="auto"){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureColumnVisible(t,r),"ensureVisible")}function t6(e,t,r){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureIndexVisible(t,r),"ensureVisible")}function KG(e,t,r=null){e.frameworkOverrides.wrapIncoming(()=>e.ctrlsSvc.getScrollFeature().ensureNodeVisible(t,r),"ensureVisible")}function XG(e){e.undoRedo?.undo("api")}function YG(e){e.undoRedo?.redo("api")}function ZG(e,t){return e.editModelSvc?.getEditRowDataValue(t,{checkSiblings:!0})}function JG(e){const t=e.editModelSvc?.getEditMap(),r=[];return t?.forEach((n,i)=>{const{rowIndex:s,rowPinned:o}=i;n.forEach((a,l)=>{const{editorValue:c,pendingValue:u,sourceValue:h,state:d}=a,f=Co(a);let m=c??u;m===Rs&&(m=void 0);const v={newValue:m,oldValue:h,state:d,column:l,colId:l.getColId(),colKey:l.getColId(),rowIndex:s,rowPinned:o};(d==="editing"||d==="changed"&&f)&&r.push(v)})}),r}function QG(e,t=!1){const{editSvc:r}=e;if(r?.isBatchEditing()){if(t)for(const n of e.editModelSvc?.getEditPositions()??[])n.state==="editing"&&r.revertSingleCellEdit(n);else el(e,{persist:!0});Qu(e,void 0,{cancel:t})}else r?.stopEditing(void 0,{cancel:t,source:"edit",forceStop:!t,forceCancel:t})}function ez(e,t){const r=en(e,t);return e.editSvc?.isEditing(r)??!1}function tz(e,t){const{key:r,colKey:n,rowIndex:i,rowPinned:s}=t,{editSvc:o,colModel:a}=e,l=a.getCol(n);if(!l){at(12,{colKey:n});return}const u=ca(e,{rowIndex:i,rowPinned:s||null});if(!u){at(290,{rowIndex:i,rowPinned:s});return}if(!o?.isCellEditable({rowNode:u,column:l},"api"))return;s==null&&t6(e,i),e6(e,n),o?.startEditing({rowNode:u,column:l},{event:r?new KeyboardEvent("keydown",{key:r}):void 0,source:"api"})}function rz(e){return e.editSvc?.validateEdit()||null}function nz(e){return e.undoRedo?.getCurrentUndoStackSize()??0}function iz(e){return e.undoRedo?.getCurrentRedoStackSize()??0}var sz={tag:"div",cls:"ag-popup-editor",attrs:{tabindex:"-1"}},oz=class extends by{constructor(e){super(sz),this.params=e}postConstruct(){vc(this.gos,this.getGui(),"popupEditorWrapper",!0),this.addKeyDownListener()}addKeyDownListener(){const e=this.getGui(),t=this.params,r=n=>{gw(this.gos,n,t.node,t.column,!0)||t.onKeyDown(n)};this.addManagedElementListeners(e,{keydown:r})}};function az(e,{column:t},r,n,i="ui"){if(r instanceof KeyboardEvent&&(r.key===$e.TAB||r.key===$e.ENTER||r.key===$e.F2||r.key===$e.BACKSPACE&&n))return!0;if(r?.shiftKey&&e.rangeSvc?.getCellRanges().length!=0)return!1;const o=t?.getColDef(),a=lz(e.gos,o),l=r?.type;return l==="click"&&r?.detail===1&&a===1||l==="dblclick"&&r?.detail===2&&a===2?!0:i==="api"?n??!1:!1}function lz(e,t){return e.get("suppressClickEdit")===!0?0:e.get("singleClickEdit")===!0||t?.singleClickEdit?1:2}function kw(e,{rowNode:t,column:r},n="ui"){const i=r.getColDef().editable,s=e.editModelSvc;return r.isColumnFunc(t,i)||!!s&&s.hasEdits({rowNode:t,column:r},{withOpenEditor:!0})}function cz(e,t,r="ui"){const n=kw(e,t,r);return n===!0||r==="ui"?n:e.colModel.getCols().some(s=>kw(e,{rowNode:t.rowNode,column:s},r))}var I0=(e,t=!1)=>{if(e!==void 0)return Co(e)||t&&e.state==="editing"};function r6(e,t,r=!1){return I0(e.editModelSvc?.getEdit(t),r)}var n6=(e,t,r)=>{if(e)for(let n=0,i=e.length;n<i;++n){const s=e[n];if(s.data&&(I0(t?.getEdit({rowNode:s,column:r}))||I0(t?.getEdit({rowNode:s.pinnedSibling,column:r})))||n6(s.childrenAfterGroup,t,r))return!0}};function i6(e,t){const{column:r,rowNode:n}=t;return e.gos.get("groupTotalRow")&&!n?.footer?!1:n6(n?.childrenAfterGroup,e.editModelSvc,r)}function s6(e,{rowNode:t,column:r}){if(t=t.pinnedSibling,!!t)return I0(e.editModelSvc?.getEdit({rowNode:t,column:r}))}var uz=class extends et{constructor(e,t){super(),this.cellCtrl=e,this.beans=t,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}setComp(e){this.cellComp=e,this.applyCellStyles()}applyCellStyles(){const{cellCtrl:e,editSvc:t,beans:r}=this;if(t?.isBatchEditing()&&t.isEditing()){const i=r6(r,e)||i6(r,e)||s6(r,e);this.applyBatchingStyle(i)}else this.applyBatchingStyle(!1);const n=!!this.editModelSvc?.getCellValidationModel().hasCellValidation(this.cellCtrl);this.cellComp.toggleCss("ag-cell-editing-error",n)}applyBatchingStyle(e){this.cellComp.toggleCss("ag-cell-editing",e??!1),this.cellComp.toggleCss("ag-cell-batch-edit",(e&&this.editSvc?.isBatchEditing())??!1)}},dz=class extends et{constructor(e,t){super(),this.rowCtrl=e,this.beans=t,this.gos=t.gos,this.editSvc=t.editSvc,this.editModelSvc=t.editModelSvc}applyRowStyles(){const{rowCtrl:e,editModelSvc:t,beans:r}=this;let n=e.rowNode,i=t?.getEditRow(n);const s=this.editModelSvc?.getRowValidationModel().hasRowValidation({rowNode:n});if(!i&&n.pinnedSibling&&(n=n.pinnedSibling,i=t?.getEditRow(n)),i){const o=Array.from(i.keys()).some(a=>{const l={rowNode:n,column:a};return r6(r,l,!0)||i6(r,l)||s6(r,l)});this.applyStyle(s,o);return}this.applyStyle(s)}applyStyle(e=!1,t=!1){const r=this.editSvc?.isBatchEditing()??!1,n=this.gos.get("editType")==="fullRow";this.rowCtrl?.forEachGui(void 0,({rowComp:i})=>{i.toggleCss("ag-row-editing",n&&t),i.toggleCss("ag-row-batch-edit",n&&t&&r),i.toggleCss("ag-row-inline-editing",t),i.toggleCss("ag-row-not-inline-editing",!t),i.toggleCss("ag-row-editing-invalid",n&&t&&e)})}},hz=({rowModel:e,pinnedRowModel:t,editModelSvc:r},n)=>{const i=new Set;e.forEachNode(s=>n.has(s)&&i.add(s)),t?.forEachPinnedRow("top",s=>n.has(s)&&i.add(s)),t?.forEachPinnedRow("bottom",s=>n.has(s)&&i.add(s));for(const s of n)i.has(s)||r.removeEdits({rowNode:s});return i},fz=({editModelSvc:e},t,r)=>{for(const n of t)e?.getEditRow(n)?.forEach((i,s)=>!r.has(s)&&e.removeEdits({rowNode:n,column:s}))},pz=e=>()=>{const t=new Set(e.colModel.getCols()),r=e.editModelSvc.getEditMap(!0),n=new Set(r.keys());fz(e,hz(e,n),t)},gz=new Set(["undo","redo","paste","bulk","rangeSvc"]),mz=new Set(["ui","api"]),o6={paste:"api",rangeSvc:"api",fillHandle:"api",cellClear:"api",bulk:"api"},vz=new Set(Object.keys(o6)),bz=new Set(["paste","rangeSvc","cellClear","redo","undo"]),_g={cancel:!0,source:"api"},wz={cancel:!1,source:"api"},xh={checkSiblings:!0},Sh={force:!0,suppressFlash:!0},yz=class extends et{constructor(){super(...arguments),this.beanName="editSvc",this.batch=!1,this.stopping=!1,this.committing=!1}postConstruct(){const{beans:e}=this;this.model=e.editModelSvc,this.valueSvc=e.valueSvc,this.rangeSvc=e.rangeSvc,this.addManagedPropertyListener("editType",({currentValue:n})=>{this.stopEditing(void 0,_g),this.createStrategy(n)});const t=pz(e),r=()=>{const n=this.model.getCellValidationModel().getCellValidationMap().size>0,i=this.model.getRowValidationModel().getRowValidationMap().size>0;return n||i?this.stopEditing(void 0,_g):this.isEditing()&&(this.batch?Qu(e,this.model.getEditPositions()):this.stopEditing(void 0,wz)),!1};this.addManagedEventListeners({columnPinned:t,columnVisible:t,columnRowGroupChanged:t,rowExpansionStateChanged:t,pinnedRowsChanged:t,displayedRowsChanged:t,sortChanged:r,filterChanged:r,cellFocused:this.onCellFocused.bind(this)})}isBatchEditing(){return this.batch}setBatchEditing(e){e?(this.batch=!0,this.stopEditing(void 0,_g)):(this.stopEditing(void 0,_g),this.batch=!1)}createStrategy(e){const{beans:t,gos:r,strategy:n}=this,i=n3(r,e);if(n){if(n.beanName===i)return n;this.destroyStrategy()}return this.strategy=this.createOptionalManagedBean(t.registry.createDynamicBean(i,!0))}destroyStrategy(){this.strategy&&(this.strategy.destroy(),this.strategy=this.destroyBean(this.strategy))}shouldStartEditing(e,t,r,n="ui"){const i=az(this.beans,e,t,r,n);return i&&(this.strategy??(this.strategy=this.createStrategy())),i}shouldStopEditing(e,t,r="ui"){return this.strategy?.shouldStop(e,t,r)??null}shouldCancelEditing(e,t,r="ui"){return this.strategy?.shouldCancel(e,t,r)??null}validateEdit(){return EH(this.beans)}isEditing(e,t){return this.model.hasEdits(e,t??xh)}isRowEditing(e,t){return(e&&this.model.hasRowEdits(e,t))??!1}startEditing(e,t){const{startedEdit:r=!0,event:n=null,source:i="ui",ignoreEventKey:s=!1,silent:o}=t;if(this.strategy??(this.strategy=this.createStrategy()),!this.isCellEditable(e,"api"))return;const a=en(this.beans,e);if(a&&!a.comp){a.onCompAttachedFuncs.push(()=>this.startEditing(e,t));return}const l=this.shouldStartEditing(e,n,r,i);if(l===!1&&i!=="api"){this.isEditing(e)&&this.stopEditing();return}!this.batch&&this.shouldStopEditing(e,void 0,i)&&!t.continueEditing&&this.stopEditing(void 0,{source:i}),l&&this.batch&&this.dispatchBatchEvent("batchEditingStarted",new Map),this.strategy.start({position:e,event:n,source:i,ignoreEventKey:s,startedEdit:r,silent:o})}stopEditing(e,t){const r=this.prepareStopContext(e,t);if(!r)return!1;this.stopping=!0;let n=!1,{edits:i}=r;try{const s=this.processStopRequest(r);return n||(n=s.res),i=s.edits,this.finishStopEditing({...r,edits:i,params:t,position:e,res:n}),n}finally{this.stopping=!1}}prepareStopContext(e,t){const{event:r,cancel:n,source:i="ui",forceCancel:s,forceStop:o}=t||{};if(vz.has(i)&&this.batch)return this.bulkRefresh(e),null;const a=this.committing?o6[i]:i;if(!(this.committing||this.isEditing(e)||this.batch&&this.model.hasEdits(e,xh))||!this.strategy||this.stopping)return null;const c=en(this.beans,e);c&&(c.onEditorAttachedFuncs=[]);const u=!n&&(!!this.shouldStopEditing(e,r,a)||(this.committing||i==="paste")&&!this.batch)||(o??!1),h=n&&!!this.shouldCancelEditing(e,r,a)||(s??!1);return{cancel:n,cellCtrl:c??void 0,edits:this.model.getEditMap(!0),event:r,forceCancel:s,forceStop:o,position:e,source:i,treatAsSource:a,willCancel:h,willStop:u}}processStopRequest(e){const{event:t,position:r,willCancel:n,willStop:i}=e;return i||n?this.handleStopOrCancel(e):this.shouldHandleMidBatchKey(t,r)?{res:!1,edits:this.handleMidBatchKey(t,r,e)}:(el(this.beans,{persist:!0}),this.batch&&this.strategy?.cleanupEditors(r),{res:!1,edits:this.model.getEditMap()})}handleStopOrCancel(e){const{beans:t,model:r}=this,{cancel:n,edits:i,event:s,source:o,willCancel:a,willStop:l}=e;el(t,{persist:!0,isCancelling:a||n,isStopping:l});const c=r.getEditMap(),u=this.processEdits(c,n,o);this.strategy?.stop(n,s),this.clearValidationIfNoOpenEditors();for(const h of u)r.clearEditValue(h);this.bulkRefresh(void 0,i);for(const h of r.getEditPositions(c)){const d=en(t,h),f=Co(h);d?.refreshCell({force:!0,suppressFlash:!f})}return{res:l,edits:c}}shouldHandleMidBatchKey(e,t){return e instanceof KeyboardEvent&&this.batch&&!!this.strategy?.midBatchInputsAllowed(t)&&this.isEditing(t,{withOpenEditor:!0})}handleMidBatchKey(e,t,r){const{beans:n,model:i}=this,{cellCtrl:s,edits:o}=r,{key:a}=e,l=a===$e.ENTER,c=a===$e.ESCAPE,u=a===$e.TAB;return l||u||c?(l||u?el(n,{persist:!0}):c&&this.revertSingleCellEdit(s),this.batch?this.strategy?.cleanupEditors():Qu(n,i.getEditPositions(),{event:e,cancel:c}),e.preventDefault(),this.bulkRefresh(t,o,{suppressFlash:!0}),i.getEditMap()):o}finishStopEditing({cellCtrl:e,edits:t,params:r,position:n,res:i,willCancel:s,willStop:o}){const a=this.beans;i&&n&&this.model.removeEdits(n),this.navigateAfterEdit(r,e?.cellPosition),s0(a),this.clearValidationIfNoOpenEditors(),this.bulkRefresh();const{rowRenderer:l,formula:c}=a;s&&l.refreshRows({rowNodes:Array.from(t.keys())}),this.batch&&(c?c.refreshFormulas(!0):l.refreshRows({suppressFlash:!0,force:!0}),i&&o&&this.dispatchBatchEvent("batchEditingStopped",t))}clearValidationIfNoOpenEditors(){this.model.hasEdits(void 0,{withOpenEditor:!0})||(this.model.getCellValidationModel().clearCellValidationMap(),this.model.getRowValidationModel().clearRowValidationMap())}navigateAfterEdit(e,t){if(!e||!t)return;const{event:r,suppressNavigateAfterEdit:n}=e;if(!(r instanceof KeyboardEvent)||n)return;const{key:s,shiftKey:o}=r,a=this.gos.get("enterNavigatesVerticallyAfterEdit");if(s!==$e.ENTER||!a)return;const l=o?$e.UP:$e.DOWN;this.beans.navigation?.navigateToNextCell(null,l,t,!1)}processEdits(e,t=!1,r){const n=Array.from(e.keys()),i=this.model.getCellValidationModel().getCellValidationMap().size>0||this.model.getRowValidationModel().getRowValidationMap().size>0,s=[];for(const o of n){const a=e.get(o);for(const l of a.keys()){const c=a.get(l),u={rowNode:o,column:l},h=Co(c);!t&&h&&!i&&(this.setNodeDataValue(o,l,c.pendingValue,void 0,r)||s.push(u))}}return s}setNodeDataValue(e,t,r,n,i="edit"){const{beans:s}=this,o=en(s,{rowNode:e,column:t}),a=mz.has(i)?"edit":i;o&&(o.suppressRefreshCell=!0),this.committing=!0;const l=e.setDataValue(t,r,a);return this.committing=!1,o&&(o.suppressRefreshCell=!1),n&&o?.refreshCell(Sh),l}setEditMap(e,t){this.strategy??(this.strategy=this.createStrategy()),this.strategy?.setEditMap(e,t),this.bulkRefresh();let r=Sh;t?.forceRefreshOfEditCellsOnly&&(r={...Cz(e),...Sh}),this.beans.rowRenderer.refreshCells(r)}dispatchEditValuesChanged({rowNode:e,column:t},r={}){if(!e||!t||!r)return;const{pendingValue:n,sourceValue:i}=r,{rowIndex:s,rowPinned:o,data:a}=e;this.beans.eventSvc.dispatchEvent({type:"cellEditValuesChanged",node:e,rowIndex:s,rowPinned:o,column:t,source:"api",data:a,newValue:n,oldValue:i,value:n,colDef:t.getColDef()})}bulkRefresh(e={},t,r={}){const{beans:n,gos:i}=this,{editModelSvc:s,rowModel:o}=n;rn(i)&&(e.rowNode&&e.column?this.refCell(e,this.model.getEdit(e),r):t&&s?.getEditMap(!1)?.forEach((a,l)=>{for(const c of a.keys())this.refCell({rowNode:l,column:c},a.get(c),r)}))}refCell({rowNode:e,column:t},r,n={}){const{beans:i,gos:s}=this,o=new Set([e]),a=new Set,l=e.pinnedSibling;l&&o.add(l);const c=e.sibling;c&&a.add(c);let u=e.parent;for(;u;)u.sibling?.footer&&s.get("groupTotalRow")||!u.parent&&u.sibling&&s.get("grandTotalRow")?a.add(u.sibling):a.add(u),u=u.parent;for(const h of o)this.dispatchEditValuesChanged({rowNode:h,column:t},r);for(const h of o)en(i,{rowNode:h,column:t})?.refreshCell(n);for(const h of a)en(i,{rowNode:h,column:t})?.refreshCell(n)}stopAllEditing(e=!1,t="ui"){this.isEditing()&&this.stopEditing(void 0,{cancel:e,source:t})}isCellEditable(e,t="ui"){const{rowNode:r}=e,{gos:n,beans:i}=this;if(r.group){if(n.get("treeData")){if(!r.data&&!n.get("enableGroupEdit"))return!1}else if(!n.get("enableGroupEdit"))return!1}const s=n3(n)==="fullRow"?cz(i,e,t):kw(i,e,t);return s&&(this.strategy??(this.strategy=this.createStrategy())),s}cellEditingInvalidCommitBlocks(){return this.gos.get("invalidEditValueMode")==="block"}checkNavWithValidation(e,t,r=!0){if(this.hasValidationErrors(e)){const n=en(this.beans,e);return this.cellEditingInvalidCommitBlocks()?(t?.preventDefault?.(),r&&(!n?.hasBrowserFocus()&&n?.focusCell(),n?.comp?.getCellEditor()?.focusIn?.()),"block-stop"):(n&&this.revertSingleCellEdit(n),"revert-continue")}return"continue"}revertSingleCellEdit(e,t=!1){const r=en(this.beans,e);r?.comp?.getCellEditor()&&(Qu(this.beans,[e],{silent:!0}),this.model.clearEditValue(e),hd(this.beans,e,{silent:!0}),yc(this.beans),r?.refreshCell(Sh),t&&(r?.focusCell(),r?.comp?.getCellEditor()?.focusIn?.()))}hasValidationErrors(e){yc(this.beans);const t=en(this.beans,e);t&&(t.refreshCell(Sh),t.rowCtrl.rowEditStyleFeature?.applyRowStyles());let r=!1;return e?.rowNode?(r||(r=this.model.getRowValidationModel().hasRowValidation({rowNode:e.rowNode})),e.column&&(r||(r=this.model.getCellValidationModel().hasCellValidation({rowNode:e.rowNode,column:e.column})))):(r||(r=this.model.getCellValidationModel().getCellValidationMap().size>0),r||(r=this.model.getRowValidationModel().getRowValidationMap().size>0)),r}moveToNextCell(e,t,r,n="ui"){let i;const s=this.isEditing(),o=s&&this.checkNavWithValidation(void 0,r)==="block-stop";return e instanceof ed&&s&&(i=this.strategy?.moveToNextEditingCell(e,t,r,n,o)),i===null||(i=i||!!this.beans.focusSvc.focusedHeader,i===!1&&!o&&this.stopEditing()),i}getCellDataValue({rowNode:e,column:t},r=!0){if(!e||!t)return;let n=this.model.getEdit({rowNode:e,column:t});const i=e.pinnedSibling;if(i){const o=this.model.getEdit({rowNode:i,column:t});o&&(n=o)}const s=r?n?.editorValue??n?.pendingValue:n?.pendingValue;return s===Rs||!n?n?.sourceValue??this.valueSvc.getValue(t,e,!1,"api"):s}addStopEditingWhenGridLosesFocus(e){wH(this,this.beans,e)}createPopupEditorWrapper(e){return new oz(e)}setDataValue(e,t,r){try{if((!this.isEditing()||this.committing)&&!bz.has(r))return;const{beans:n}=this;this.strategy??(this.strategy=this.createStrategy());const i=this.batch?"ui":this.committing?r??"api":"api";if(!r||gz.has(r))return o0(n,e,t,r,void 0,{persist:!0}),this.batch?(this.cleanupEditors(),s0(n),this.bulkRefresh(),!0):this.setNodeDataValue(e.rowNode,e.column,t,!0,r);const s=this.model.getEdit(e);if(s){if(s.pendingValue===t)return!1;if(s.sourceValue!==t)return o0(n,e,t,r,void 0,{persist:!0}),this.stopEditing(e,{source:i,suppressNavigateAfterEdit:!0}),!0;if(s.sourceValue===t)return n.editModelSvc?.removeEdits(e),this.dispatchEditValuesChanged(e,{...s,pendingValue:t}),!0}return o0(n,e,t,r,void 0,{persist:!0}),this.stopEditing(e,{source:i,suppressNavigateAfterEdit:!0}),!0}finally{this.committing=!1}}handleColDefChanged(e){xH(this.beans,e)}destroy(){this.model.clear(),this.destroyStrategy(),super.destroy()}prepDetailsDuringBatch(e,t){const{model:r}=this;if(!this.batch||!r.hasRowEdits(e.rowNode,xh))return;const{rowNode:i}=e,{compDetails:s,valueToDisplay:o}=t;if(s){const{params:a}=s;return a.data=r.getEditRowDataValue(i,xh),{compDetails:s}}return{valueToDisplay:o}}cleanupEditors(){this.strategy?.cleanupEditors()}dispatchCellEvent(e,t,r,n){this.strategy?.dispatchCellEvent(e,t,r,n)}dispatchBatchEvent(e,t){this.eventSvc.dispatchEvent(this.createBatchEditEvent(e,t))}createBatchEditEvent(e,t){return Dt(this.gos,{type:e,...e==="batchEditingStopped"?{changes:this.toEventChangeList(t)}:{}})}toEventChangeList(e){return this.model.getEditPositions(e).map(t=>({rowIndex:t.rowNode.rowIndex,rowPinned:t.rowNode.rowPinned,columnId:t.column.getColId(),newValue:t.pendingValue,oldValue:t.sourceValue}))}applyBulkEdit({rowNode:e,column:t},r){if(!r||r.length===0)return;const{beans:n,rangeSvc:i,valueSvc:s}=this,{formula:o}=n;el(n,{persist:!0});const a=this.model.getEditMap(!0);let l=a.get(e)?.get(t)?.pendingValue;this.batch||this.eventSvc.dispatchEvent({type:"bulkEditingStarted"});const c=o?.isFormula(l)??!1;r.forEach(h=>{const d=h.columns.some(f=>f?.isAllowFormula());if(i?.forEachRowInRange(h,f=>{const m=ca(n,f);if(m===void 0)return;const v=a.get(m)??new Map;let g=l;for(const w of h.columns){if(!w)continue;const y=!!c&&w.isAllowFormula();if(this.isCellEditable({rowNode:m,column:w},"api")){const C=s.getValue(w,m,!0,"api");let k=s.parseValue(w,m??null,g,C);Number.isNaN(k)&&(k=null),v.set(w,{editorValue:void 0,pendingValue:k,sourceValue:C,state:"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}y&&(g=o?.updateFormulaByOffset({value:g,columnDelta:1}))}v.size>0&&a.set(m,v),c&&d&&(l=o?.updateFormulaByOffset({value:l,rowDelta:1}))}),this.setEditMap(a),this.batch){this.cleanupEditors(),s0(n),this.bulkRefresh();return}this.committing=!0,this.stopEditing(void 0,{source:"bulk"}),this.committing=!1,this.eventSvc.dispatchEvent({type:"bulkEditingStopped",changes:this.toEventChangeList(a)})}),this.bulkRefresh();const u=en(n,{rowNode:e,column:t});u&&u.focusCell(!0)}createCellStyleFeature(e){return new uz(e,this.beans)}createRowStyleFeature(e){return new dz(e,this.beans)}setEditingCells(e,t){const{beans:r}=this,{colModel:n,valueSvc:i}=r,s=new Map;for(let{colId:o,column:a,colKey:l,rowIndex:c,rowPinned:u,newValue:h,state:d}of e){const f=o?n.getCol(o):l?n.getCol(l):a;if(!f)continue;const m=ca(r,{rowIndex:c,rowPinned:u});if(!m)continue;const v=i.getValue(f,m,!0,"api");if(!t?.forceRefreshOfEditCellsOnly&&!Co({pendingValue:h,sourceValue:v})&&d!=="editing")continue;let g=s.get(m);g||(g=new Map,s.set(m,g)),h===void 0&&(h=Rs),g.set(f,{editorValue:void 0,pendingValue:h,sourceValue:v,state:d??"changed",editorState:{isCancelAfterEnd:void 0,isCancelBeforeStart:void 0}})}this.setEditMap(s,t)}onCellFocused(e){const t=en(this.beans,e);if(!t||!this.isEditing(t,xh))return;const r=this.model.getEdit(t);if(!r||!Co(r))return;const i=this.getLocaleTextFunc()("ariaPendingChange","Pending Change");this.beans.ariaAnnounce?.announceValue(i,"pendingChange")}allowedFocusTargetOnValidation(e){return en(this.beans,e)}};function Cz(e){return{rowNodes:e?Array.from(e.keys()):void 0,columns:e?[...new Set(Array.from(e.values()).flatMap(t=>Array.from(t.keys())))]:void 0}}function n3(e,t){return t??e.get("editType")??"singleCell"}var a6=class extends et{postConstruct(){this.model=this.beans.editModelSvc,this.editSvc=this.beans.editSvc,this.addManagedEventListeners({cellFocused:this.onCellFocusChanged?.bind(this),cellFocusCleared:this.onCellFocusChanged?.bind(this)})}clearEdits(e){this.model.clearEditValue(e)}onCellFocusChanged(e){let t;const r=e.previousParams,{editSvc:n,beans:i}=this,s=e.type==="cellFocused"?e.sourceEvent:null;r&&(t=en(i,r));const{gos:o,editModelSvc:a}=i,l=e.type==="cellFocusCleared";if(n.isEditing(void 0,{withOpenEditor:!0})){const{column:c,rowIndex:u,rowPinned:h}=e,d={column:c,rowNode:ca(i,{rowIndex:u,rowPinned:h})},f=o.get("invalidEditValueMode")==="block";if(f)return;const m=!f,v=!!a?.getCellValidationModel().hasCellValidation(d),g=m&&v;!(r||l)||n.stopEditing(void 0,{cancel:g,source:l&&m?"api":void 0,event:s})||(n.isBatchEditing()?n.cleanupEditors():n.stopEditing(void 0,{source:"api"}))}t?.refreshCell({suppressFlash:!0,force:!0})}stop(e,t){const r=this.model.getEditPositions(),n={all:[],pass:[],fail:[]};for(const i of r){if(n.all.push(i),(this.model.getCellValidationModel().getCellValidation(i)?.errorMessages?.length??0)>0){n.fail.push(i);continue}n.pass.push(i)}if(e)for(const i of r)vf(this.beans,i,{cancel:e}),this.model.stop(i);else{const i=this.processValidationResults(n);if(i.destroy.length>0)for(const s of i.destroy)vf(this.beans,s,{event:t,cancel:e}),this.model.stop(s);if(i.keep.length>0)for(const s of i.keep){const o=en(this.beans,s);this.editSvc?.cellEditingInvalidCommitBlocks()||o&&this.editSvc.revertSingleCellEdit(o)}}return!0}cleanupEditors({rowNode:e}={},t){el(this.beans,{persist:!1});const r=this.model.getEditPositions(),n=[];if(e)for(const i of r)i.rowNode!==e&&n.push(i);else for(const i of r)n.push(i);Qu(this.beans,n),s0(this.beans,t)}setFocusOutOnEditor(e){e.comp?.getCellEditor()?.focusOut?.()}setFocusInOnEditor(e){const t=e.comp,r=t?.getCellEditor();if(r?.focusIn)r.focusIn();else{const n=this.beans.gos.get("editType")==="fullRow";e.focusCell(n),e.onEditorAttachedFuncs.push(()=>t?.getCellEditor()?.focusIn?.())}}setupEditors(e){const{event:t,ignoreEventKey:r=!1,startedEdit:n,position:i,cells:s=this.model.getEditPositions()}=e,o=t instanceof KeyboardEvent&&!r&&t.key||void 0;CH(this.beans,s,i,o,t,n)}dispatchCellEvent(e,t,r,n){const i=en(this.beans,e);i&&this.eventSvc.dispatchEvent({...i.createEvent(t??null,r),...n})}dispatchRowEvent(e,t,r){if(r)return;const n=A0(this.beans,e);n&&this.eventSvc.dispatchEvent(n.createRowEvent(t))}shouldStop(e,t,r="ui"){const n=this.editSvc.isBatchEditing();return n&&r==="api"?!0:n&&(r==="ui"||r==="edit")?!1:r==="api"?!0:t instanceof KeyboardEvent&&!n?t.key===$e.ENTER:null}shouldCancel(e,t,r="ui"){const n=this.editSvc.isBatchEditing();return!!(t instanceof KeyboardEvent&&!n&&t.key===$e.ESCAPE||n&&r==="api"||r==="api")}setEditMap(e,t){t?.update||this.editSvc.stopEditing(void 0,{cancel:!0,source:"api"});const r=[];if(e.forEach((n,i)=>{n.forEach((s,o)=>{s.state==="editing"&&r.push({...s,rowNode:i,column:o})})}),t?.update&&(e=new Map([...this.model.getEditMap(),...e])),this.model?.setEditMap(e),r.length>0){const n=r.at(-1),i=n.pendingValue===Rs?void 0:n.pendingValue;this.start({position:n,event:new KeyboardEvent("keydown",{key:i}),source:"api"});const s=en(this.beans,n);s&&this.setFocusInOnEditor(s)}}destroy(){this.cleanupEditors(),super.destroy()}},xz=class extends a6{constructor(){super(...arguments),this.beanName="fullRow",this.startedRows=[]}shouldStop(e,t,r="ui"){const{rowNode:n}=e||{};if(!A0(this.beans,{rowNode:this.rowNode}))return!0;const s=super.shouldStop({rowNode:this.rowNode},t,r);return s!==null?s:this.rowNode?n!==this.rowNode:!1}midBatchInputsAllowed({rowNode:e}){return e?this.model.hasEdits({rowNode:e}):!1}clearEdits(e){this.model.clearEditValue(e)}start(e){const{position:t,silent:r,startedEdit:n,event:i,ignoreEventKey:s}=e,{rowNode:o}=t;this.rowNode!==o&&super.cleanupEditors(t);const a=this.beans.visibleCols.allCols,l=[],c=[];for(const u of a)u.isCellEditable(o)&&c.push(u);if(c.length!=0){this.dispatchRowEvent({rowNode:o},"rowEditingStarted",r),this.startedRows.push(o);for(const u of c){const h={rowNode:o,column:u};l.push(h),this.model.hasEdits(h)||this.model.start(h)}this.rowNode=o,this.setupEditors({cells:l,position:t,startedEdit:n,event:i,ignoreEventKey:s})}}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){const{rowNode:r}=this;if(r&&!this.model.hasRowEdits(r))return!1;const n=[];if(e||this.model.getEditMap().forEach((i,s)=>{if(!(!i||i.size===0)){for(const o of i.values())if(Co(o)){n.push(s);break}}}),yc(this.beans),!e&&this.editSvc?.checkNavWithValidation({rowNode:r})==="block-stop")return!1;super.stop(e,t);for(const i of n)this.dispatchRowEvent({rowNode:i},"rowValueChanged");return this.cleanupEditors({rowNode:r},!0),this.rowNode=void 0,!0}onCellFocusChanged(e){const{rowIndex:t}=e,r=e.previousParams;if(r?.rowIndex===t||e.sourceEvent instanceof KeyboardEvent)return;const n=en(this.beans,r);this.gos.get("invalidEditValueMode")==="block"&&n&&(this.model.getCellValidationModel().getCellValidation(n)||this.model.getRowValidationModel().getRowValidation(n))||super.onCellFocusChanged(e)}cleanupEditors(e={},t){super.cleanupEditors(e,t);for(const r of this.startedRows)this.dispatchRowEvent({rowNode:r},"rowEditingStopped"),this.destroyEditorsForRow(r);this.startedRows.length=0}destroyEditorsForRow(e){const t=A0(this.beans,{rowNode:e});if(t)for(const r of t.getAllCellCtrls())r.comp?.getCellEditor()&&vf(this.beans,r,void 0,r)}moveToNextEditingCell(e,t,r,n="ui",i=!1){const s=e.cellPosition;let o;this.model.suspend(!0);try{o=this.beans.navigation?.findNextCellToFocusOn(s,{backwards:t,startEditing:!0,skipToNextEditableCell:!1})}finally{this.model.suspend(!1)}if(o===!1)return null;if(o==null)return!1;const a=o.cellPosition,l=e.isCellEditable(),c=o.isCellEditable(),u=a&&s.rowIndex===a.rowIndex&&s.rowPinned===a.rowPinned;l&&this.setFocusOutOnEditor(e),this.restoreEditors();const h=this.gos.get("suppressStartEditOnTab");return c&&!i?h?o.focusCell(!0,r):(o.comp?.getCellEditor()||hd(this.beans,o,{event:r,cellStartedEdit:!0}),this.setFocusInOnEditor(o),o.focusCell(!1,r)):(c&&i&&this.setFocusInOnEditor(o),o.focusCell(!0,r)),!u&&!i&&(this.editSvc?.stopEditing({rowNode:e.rowNode},{event:r}),this.cleanupEditors(o,!0),h?o.focusCell(!0,r):this.editSvc.startEditing(o,{startedEdit:!0,event:r,source:n,ignoreEventKey:!0})),e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}restoreEditors(){this.model.getEditMap().forEach((e,t)=>e.forEach(({state:r},n)=>{if(r!=="editing")return;const i=en(this.beans,{rowNode:t,column:n});i&&!i.comp?.getCellEditor()&&hd(this.beans,i,{silent:!0})}))}destroy(){super.destroy(),this.rowNode=void 0,this.startedRows.length=0}},Sz=class extends a6{constructor(){super(...arguments),this.beanName="singleCell"}shouldStop(e,t,r="ui"){const n=super.shouldStop(e,t,r);if(n!==null)return n;const{rowNode:i,column:s}=e||{};return(!this.rowNode||!this.column)&&i&&s?null:this.rowNode!==i||this.column!==s}midBatchInputsAllowed(e){return this.model.hasEdits(e)}start(e){const{position:t,startedEdit:r,event:n,ignoreEventKey:i}=e;(this.rowNode!==t.rowNode||this.column!==t.column)&&super.cleanupEditors(),this.rowNode=t.rowNode,this.column=t.column,this.model.start(t),this.setupEditors({cells:[t],position:t,startedEdit:r,event:n,ignoreEventKey:i})}dispatchRowEvent(e,t,r){}processValidationResults(e){return e.fail.length>0&&this.editSvc.cellEditingInvalidCommitBlocks()?{destroy:[],keep:e.all}:{destroy:e.all,keep:[]}}stop(e,t){return super.stop(e,t),this.rowNode=void 0,this.column=void 0,!0}onCellFocusChanged(e){const{colModel:t,editSvc:r}=this.beans,{rowIndex:n,column:i,rowPinned:s}=e,o=ca(this.beans,{rowIndex:n,rowPinned:s}),a=Cw(i),l=t.getCol(a),c=e.previousParams;if(c){const u=Cw(c.column);if(c?.rowIndex===n&&u===a&&c?.rowPinned===s)return}r?.isEditing({rowNode:o,column:l},{withOpenEditor:!0})&&e.type==="cellFocused"||super.onCellFocusChanged(e)}moveToNextEditingCell(e,t,r,n="ui",i=!1){const s=this.beans.focusSvc.getFocusedCell();s&&(e=Lu(this.beans,s)??e);const o=e.cellPosition;let a;const l=this.beans.gos.get("editType")==="fullRow";l&&this.model.suspend(!0),i||(e.eGui.focus(),this.editSvc?.stopEditing(e,{source:this.editSvc?.isBatchEditing()?"ui":"api",event:r}));try{a=this.beans.navigation?.findNextCellToFocusOn(o,{backwards:t,startEditing:!0})}finally{l&&this.model.suspend(!1)}if(a===!1)return null;if(a==null)return!1;const c=a.cellPosition,u=e.isCellEditable(),h=a.isCellEditable(),d=c&&o.rowIndex===c.rowIndex&&o.rowPinned===c.rowPinned;u&&!i&&this.setFocusOutOnEditor(e);const f=this.gos.get("suppressStartEditOnTab");if(!d&&!i&&(super.cleanupEditors(a,!0),f?a.focusCell(!0,r):this.editSvc.startEditing(a,{startedEdit:!0,event:r,source:n,ignoreEventKey:!0})),h&&!i){if(a.focusCell(!1,r),f)a.focusCell(!0,r);else if(!a.comp?.getCellEditor()){const m=this.editSvc?.isEditing(a,{withOpenEditor:!0});hd(this.beans,a,{event:r,cellStartedEdit:!0,silent:m}),this.setFocusInOnEditor(a),this.cleanupEditors(a)}}else h&&i&&this.setFocusInOnEditor(a),a.focusCell(!0,r);return e.rowCtrl?.refreshRow({suppressFlash:!0,force:!0}),!0}destroy(){super.destroy(),this.rowNode=void 0,this.column=void 0}},yl={moduleName:"EditCore",version:wt,beans:[bH,yz],apiFunctions:{getEditingCells:JG,getEditRowValues:ZG,getCellEditorInstances:yH,startEditingCell:tz,stopEditing:QG,isEditing:ez,validateEdit:rz},dynamicBeans:{singleCell:Sz,fullRow:xz},dependsOn:[hm,QR],css:[RG]},_z={moduleName:"UndoRedoEdit",version:wt,beans:[kG],apiFunctions:{undoCellEditing:XG,redoCellEditing:YG,getCurrentUndoSize:nz,getCurrentRedoSize:iz},dependsOn:[yl]},Ez={moduleName:"TextEditor",version:wt,userComponents:{agCellEditor:r3,agTextCellEditor:r3},dependsOn:[yl]},Tz={moduleName:"NumberEditor",version:wt,userComponents:{agNumberCellEditor:{classImp:VG}},dependsOn:[yl]},kz={moduleName:"DateEditor",version:wt,userComponents:{agDateCellEditor:PG,agDateStringCellEditor:NG},dependsOn:[yl]},Rz={moduleName:"CheckboxEditor",version:wt,userComponents:{agCheckboxCellEditor:FG},dependsOn:[yl]},Az={moduleName:"SelectEditor",version:wt,userComponents:{agSelectCellEditor:zG},dependsOn:[yl]},Fz={moduleName:"LargeTextEditor",version:wt,userComponents:{agLargeTextCellEditor:BG},dependsOn:[yl]},Mz={moduleName:"CustomEditor",version:wt,dependsOn:[yl]},Dz=class extends et{constructor(){super(...arguments),this.beanName="selectionColSvc"}postConstruct(){this.addManagedPropertyListener("rowSelection",e=>{this.onSelectionOptionsChanged(e.currentValue,e.previousValue,Ku(e.source))}),this.addManagedPropertyListener("selectionColumnDef",this.updateColumns.bind(this))}addColumns(e){const t=this.columns;t!=null&&(e.list=t.list.concat(e.list),e.tree=t.tree.concat(e.tree),tP(e))}createColumns(e,t){const r=()=>{w0(this.beans,this.columns?.tree),this.columns=null},n=e.treeDepth,s=(this.columns?.treeDepth??-1)==n,o=this.generateSelectionCols();if(eP(o,this.columns?.list??[])&&s)return;r();const{colGroupSvc:l}=this.beans,c=l?.findDepth(e.tree)??0,u=l?.balanceTreeForAutoCols(o,c)??[];this.columns={list:o,tree:u,treeDepth:c,map:{}},t(d=>{if(!d)return null;const f=d.filter(m=>!vl(m));return[...o,...f]})}updateColumns(e){const t=Ku(e.source),{beans:r}=this;for(const n of this.columns?.list??[]){const i=this.createSelectionColDef(e.currentValue);n.setColDef(i,null,t),Ws(r,{state:[nP(i,n.colId)]},t)}}getColumn(e){return this.columns?.list.find(t=>zh(t,e))??null}getColumns(){return this.columns?.list??null}isSelectionColumnEnabled(){const{gos:e,beans:t}=this,r=e.get("rowSelection");if(typeof r!="object"||!sc(e))return!1;const n=(t.autoColSvc?.getColumns()?.length??0)>0;if(r.checkboxLocation==="autoGroupColumn"&&n)return!1;const i=!!Wu(r),s=Xg(r);return i||s}createSelectionColDef(e){const{gos:t}=this,r=e??t.get("selectionColumnDef"),n=t.get("enableRtl"),{rowSpan:i,spanRows:s,...o}=r??{};return{width:50,resizable:!1,suppressHeaderMenuButton:!0,sortable:!1,suppressMovable:!0,lockPosition:n?"right":"left",comparator(a,l,c,u){const h=c.isSelected(),d=u.isSelected();return h===d?0:h?1:-1},editable:!1,suppressFillHandle:!0,suppressAutoSize:!0,pinned:null,...o,colId:rk,chartDataType:"excluded"}}generateSelectionCols(){if(!this.isSelectionColumnEnabled())return[];const e=this.createSelectionColDef(),t=e.colId;this.gos.validateColDef(e,t,!0);const r=new Fc(e,null,t,!1);return this.createBean(r),[r]}onSelectionOptionsChanged(e,t,r){const n=t&&typeof t!="string"?Wu(t):void 0,i=e&&typeof e!="string"?Wu(e):void 0,s=n!==i,o=t&&typeof t!="string"?Xg(t):void 0,a=e&&typeof e!="string"?Xg(e):void 0,l=o!==a,c=g0(e),u=g0(t);(s||l||c!==u)&&this.beans.colModel.refreshAll(r)}destroy(){w0(this.beans,this.columns?.tree),super.destroy()}refreshVisibility(e,t,r){if(!this.columns?.list.length)return;const n=e.length+t.length+r.length;if(n===0)return;const i=this.columns.list[0];if(!i.isVisible())return;const s=()=>{let l;switch(i.pinned){case"left":case!0:l=e;break;case"right":l=r;break;default:l=t}l&&Eo(l,i)};(this.beans.rowNumbersSvc?.getColumn(nk)?2:1)===n&&s()}},Pz=':where(.ag-selection-checkbox) .ag-checkbox-input-wrapper{&:before{content:"";cursor:pointer;inset:-8px;position:absolute}}';function Iz(e,t){if(!t.nodes.every(o=>o.rowPinned&&!$f(o)?(at(59),!1):o.id===void 0?(at(60),!1):!0))return;const{nodes:n,source:i,newValue:s}=t;e.selectionSvc?.setNodesSelected({nodes:n,source:i??"api",newValue:s})}function Oz(e,t,r="apiSelectAll"){e.selectionSvc?.selectAllRowNodes({source:r,selectAll:t})}function Nz(e,t,r="apiSelectAll"){e.selectionSvc?.deselectAllRowNodes({source:r,selectAll:t})}function Lz(e,t="apiSelectAllFiltered"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"filtered"})}function Bz(e,t="apiSelectAllFiltered"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"filtered"})}function Hz(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.selectAllRowNodes({source:t,selectAll:"currentPage"})}function jz(e,t="apiSelectAllCurrentPage"){e.selectionSvc?.deselectAllRowNodes({source:t,selectAll:"currentPage"})}function Vz(e){return e.selectionSvc?.getSelectedNodes()??[]}function Gz(e){return e.selectionSvc?.getSelectedRows()??[]}var zz=class extends bO{constructor(){super(...arguments),this.beanName="selectionSvc",this.selectedNodes=new Map,this.detailSelection=new Map,this.masterSelectsDetail=!1}postConstruct(){super.postConstruct();const{gos:e}=this;this.mode=m0(e),this.groupSelectsDescendants=hf(e),this.groupSelectsFiltered=b0(e)==="filteredDescendants",this.masterSelectsDetail=W_(e)==="detail",this.addManagedPropertyListeners(["groupSelectsChildren","groupSelectsFiltered","rowSelection"],()=>{const t=hf(e),r=m0(e),n=b0(e)==="filteredDescendants";this.masterSelectsDetail=W_(e)==="detail",(t!==this.groupSelectsDescendants||n!==this.groupSelectsFiltered||r!==this.mode)&&(this.deselectAllRowNodes({source:"api"}),this.groupSelectsDescendants=t,this.groupSelectsFiltered=n,this.mode=r)}),this.addManagedEventListeners({rowSelected:this.onRowSelected.bind(this)})}destroy(){super.destroy(),this.resetNodes()}handleSelectionEvent(e,t,r){if(this.isRowSelectionBlocked(t))return 0;const n=this.inferNodeSelections(t,e.shiftKey,e.metaKey||e.ctrlKey,r);if(n==null)return 0;if(this.selectionCtx.selectAll=!1,"select"in n)return n.reset?this.resetNodes():this.selectRange(n.deselect,!1,r),this.selectRange(n.select,!0,r);{const i=n.checkFilteredNodes?c6(n.node):n.newValue;return this.setNodesSelected({nodes:[n.node],newValue:i,clearSelection:n.clearSelection,keepDescendants:n.keepDescendants,event:e,source:r})}}setNodesSelected({newValue:e,clearSelection:t,suppressFinishActions:r,nodes:n,event:i,source:s,keepDescendants:o=!1}){if(n.length===0)return 0;const{gos:a}=this;if(!sc(a)&&e)return at(132),0;if(n.length>1&&!this.isMultiSelect())return at(130),0;let l=0;for(let c=0;c<n.length;c++){const u=n[c],h=mu(u);if(h.rowPinned&&!$f(h)){at(59);continue}if(h.id===void 0){at(60);continue}if(e&&u.destroyed)continue;this.groupSelectsFiltered&&h.group&&!a.get("treeData")||this.selectRowNode(h,e,i,s)&&(this.detailSelection.delete(h.id),l++),this.groupSelectsDescendants&&h.childrenAfterGroup?.length&&(l+=this.selectChildren(h,e,s))}return r||(n.length===1&&s==="api"&&this.selectionCtx.setRoot(mu(n[0])),e&&(t||!this.isMultiSelect())&&(l+=this.clearOtherNodes(mu(n[0]),o,s)),l>0&&(this.updateGroupsFromChildrenSelections(s),this.dispatchSelectionChanged(s))),l}selectRange(e,t,r){let n=0;return e.forEach(i=>{const s=mu(i);if(s.group&&this.groupSelectsDescendants)return;this.selectRowNode(s,t,void 0,r)&&n++}),n>0&&(this.updateGroupsFromChildrenSelections(r),this.dispatchSelectionChanged(r)),n}selectChildren(e,t,r){const n=this.groupSelectsFiltered?e.childrenAfterAggFilter:e.childrenAfterGroup;return n?this.setNodesSelected({newValue:t,clearSelection:!1,suppressFinishActions:!0,source:r,nodes:n}):0}getSelectedNodes(){return Array.from(this.selectedNodes.values())}getSelectedRows(){const e=[];return this.selectedNodes.forEach(t=>t.data&&e.push(t.data)),e}getSelectionCount(){return this.selectedNodes.size}filterFromSelection(e){const t=new Map;this.selectedNodes.forEach((r,n)=>{e(r)&&t.set(n,r)}),this.selectedNodes=t}updateGroupsFromChildrenSelections(e,t){if(!this.groupSelectsDescendants)return!1;const{gos:r,rowModel:n}=this.beans;if(!rn(r))return!1;const i=n.rootNode;if(!i)return!1;t||(t=new mf(!0,i),t.active=!1);let s=!1;return t.forEachChangedNodeDepthFirst(o=>{if(o!==i){const a=this.calculateSelectedFromChildren(o);s=this.selectRowNode(o,a===null?!1:a,void 0,e)||s}}),s}clearOtherNodes(e,t,r){const n=new Map;let i=0;return this.selectedNodes.forEach(s=>{const o=s.id==e.id;if((t?!Wz(e,s):!0)&&!o){const l=this.selectedNodes.get(s.id);i+=this.setNodesSelected({nodes:[l],newValue:!1,clearSelection:!1,suppressFinishActions:!0,source:r}),this.groupSelectsDescendants&&s.parent&&n.set(s.parent.id,s.parent)}}),n.forEach(s=>{const o=this.calculateSelectedFromChildren(s);this.selectRowNode(s,o===null?!1:o,void 0,r)}),i}onRowSelected(e){const t=e.node;this.groupSelectsDescendants&&t.group||(t.isSelected()?this.selectedNodes.set(t.id,t):this.selectedNodes.delete(t.id))}syncInRowNode(e,t){this.syncInOldRowNode(e,t),this.syncInNewRowNode(e)}createDaemonNode(e){if(!e.id)return;const t=new ul(this.beans);return t.id=e.id,t.data=e.data,t.__selected=e.__selected,t.level=e.level,t}syncInOldRowNode(e,t){t&&e.id!==t.id&&this.selectedNodes.get(t.id)==e&&this.selectedNodes.set(t.id,t)}syncInNewRowNode(e){this.selectedNodes.has(e.id)?(e.__selected=!0,this.selectedNodes.set(e.id,e)):e.__selected=!1}reset(e){const t=this.getSelectionCount();this.resetNodes(),t&&this.dispatchSelectionChanged(e)}resetNodes(){this.selectedNodes.forEach(e=>{this.selectRowNode(e,!1)}),this.selectedNodes.clear()}getBestCostNodeSelection(){const{gos:e,rowModel:t}=this.beans;if(!rn(e))return;const r=t.getTopLevelNodes();if(r===null)return;const n=[];function i(s){for(let o=0,a=s.length;o<a;o++){const l=s[o];l.isSelected()?n.push(l):l.group&&l.childrenAfterGroup&&i(l.childrenAfterGroup)}}return i(r),n}isEmpty(){return this.getSelectionCount()===0}deselectAllRowNodes({source:e,selectAll:t}){const r=rn(this.gos);let n=!1;const i=s=>{const o=this.selectRowNode(mu(s),!1,void 0,e);n||(n=o)};if(t==="currentPage"||t==="filtered"){if(!r){Ar(102);return}this.getNodesToSelect(t).forEach(i)}else this.selectedNodes.forEach(i),this.reset(e);if(this.selectionCtx.selectAll=!1,r&&this.groupSelectsDescendants){const s=this.updateGroupsFromChildrenSelections(e);n||(n=s)}n&&this.dispatchSelectionChanged(e)}getSelectedCounts(e){let t=0,r=0;return this.getNodesToSelect(e).forEach(n=>{this.groupSelectsDescendants&&n.group||(n.isSelected()?t++:n.selectable&&r++)}),{selectedCount:t,notSelectedCount:r}}getSelectAllState(e){const{selectedCount:t,notSelectedCount:r}=this.getSelectedCounts(e);return l6(t,r)??null}hasNodesToSelect(e){return this.getNodesToSelect(e).filter(t=>t.selectable).length>0}getNodesToSelect(e){if(!this.canSelectAll())return[];const t=[],r=i=>t.push(i);if(e==="currentPage")return this.forEachNodeOnPage(i=>{if(!i.group){r(i);return}if(!i.expanded&&!i.footer){const s=o=>{r(o),o.childrenAfterFilter?.forEach(s)};s(i);return}this.groupSelectsDescendants||r(i)}),t;const n=this.beans.rowModel;return e==="filtered"?(n.forEachNodeAfterFilter(r),t):(n.forEachNode(r),t)}forEachNodeOnPage(e){const{pageBounds:t,rowModel:r}=this.beans,n=t.getFirstRow(),i=t.getLastRow();for(let s=n;s<=i;s++){const o=r.getRow(s);o&&e(o)}}selectAllRowNodes(e){const{gos:t,selectionCtx:r}=this;if(!sc(t)){at(132);return}if(ND(t)&&!v0(t)){at(130);return}if(!this.canSelectAll())return;const{source:n,selectAll:i}=e;let s=!1;if(this.getNodesToSelect(i).forEach(o=>{const a=this.selectRowNode(mu(o),!0,void 0,n);s||(s=a)}),r.selectAll=!0,rn(t)&&this.groupSelectsDescendants){const o=this.updateGroupsFromChildrenSelections(n);s||(s=o)}s&&this.dispatchSelectionChanged(n)}getSelectionState(){return this.isEmpty()?null:Array.from(this.selectedNodes.keys())}setSelectionState(e,t,r){if(e||(e=[]),!Array.isArray(e)){Ar(103);return}const n=new Set(e),i=[];this.beans.rowModel.forEachNode(s=>{n.has(s.id)&&i.push(s)}),r&&this.resetNodes(),this.setNodesSelected({newValue:!0,nodes:i,source:t})}canSelectAll(){return rn(this.beans.gos)}updateSelectable(e){const{gos:t,rowModel:r}=this.beans;if(!sc(t))return;const n="selectableChanged",i=e!==void 0,s=rn(t)&&this.groupSelectsDescendants,o=[],a=l=>{if(i&&!l.group)return;if(s&&l.group){const u=l.childrenAfterGroup?.some(h=>h.selectable)??!1;this.setRowSelectable(l,u,!0);return}!this.updateRowSelectable(l,!0)&&l.isSelected()&&o.push(l)};if(s){if(e===void 0){const l=r.rootNode;e=l?new mf(!1,l):void 0}e?.forEachChangedNodeDepthFirst(a,!i,!i)}else r.forEachNode(a);o.length&&this.setNodesSelected({nodes:o,newValue:!1,source:n}),!i&&s&&this.updateGroupsFromChildrenSelections?.(n)}updateSelectableAfterGrouping(e){this.updateSelectable(e),this.groupSelectsDescendants&&this.updateGroupsFromChildrenSelections?.("rowGroupChanged",e)&&this.dispatchSelectionChanged("rowGroupChanged")}refreshMasterNodeState(e,t){if(!this.masterSelectsDetail)return;const r=e.detailNode?.detailGridInfo?.api;if(!r)return;const n=Uz(r);if(e.isSelected()!==n&&this.selectRowNode(e,n,t,"masterDetail")&&this.dispatchSelectionChanged("masterDetail"),!n){const s=this.detailSelection.get(e.id)??new Set;for(const o of r.getSelectedNodes())s.add(o.id);this.detailSelection.set(e.id,s)}}setDetailSelectionState(e,t,r){if(this.masterSelectsDetail){if(!v0(t)){at(269);return}switch(e.isSelected()){case!0:{r.selectAll();break}case!1:{r.deselectAll();break}case void 0:{const n=this.detailSelection.get(e.id);if(n){const i=[];for(const s of n){const o=r.getRowNode(s);o&&i.push(o)}r.setNodesSelected({nodes:i,newValue:!0,source:"masterDetail"})}break}}}}dispatchSelectionChanged(e){this.eventSvc.dispatchEvent({type:"selectionChanged",source:e,selectedNodes:this.getSelectedNodes(),serverSideState:null})}};function mu(e){return $f(e)?e.pinnedSibling:e.footer?e.sibling:e}function Uz(e){let t=0,r=0;return e.forEachNode(n=>{n.isSelected()?t++:n.selectable&&r++}),l6(t,r)}function l6(e,t){if(e===0&&t===0)return!1;if(!(e>0&&t>0))return e>0}function Wz(e,t){let r=t.parent;for(;r;){if(r===e)return!0;r=r.parent}return!1}function c6(e){const t=e.isSelected()===!1,r=e.childrenAfterFilter?.some(c6)??!1;return t||r}var $z={moduleName:"SharedRowSelection",version:wt,beans:[Dz],css:[Pz],apiFunctions:{setNodesSelected:Iz,selectAll:Oz,deselectAll:Nz,selectAllFiltered:Lz,deselectAllFiltered:Bz,selectAllOnCurrentPage:Hz,deselectAllOnCurrentPage:jz,getSelectedNodes:Vz,getSelectedRows:Gz}},qz={moduleName:"RowSelection",version:wt,rowModels:["clientSide","infinite","viewport"],beans:[zz],dependsOn:[$z]};function Kz(e){e.expansionSvc?.expandAll(!0)}function Xz(e){e.expansionSvc?.expandAll(!1)}function u6(e){e.rowModel?.onRowHeightChanged()}function d6(e){if(e.rowAutoHeight?.active){at(3);return}e.rowModel?.resetRowHeights()}function Yz(e,t,r){const n=qj(e);if(n){if(e.rowGroupColsSvc?.columns.length===0){if(t<0){Ar(238);return}n.setRowCount(t,r);return}Ar(28);return}dm(e)?.setRowCount(t,r)}function Zz(e){return Cd(e.gos)?e.rowModel.getBlockStates():e.rowNodeBlockLoader?.getBlockState()??{}}function Jz(e){return e.rowModel.isLastRowIndexKnown()}var Qz={moduleName:"CsrmSsrmSharedApi",version:wt,apiFunctions:{expandAll:Kz,collapseAll:Xz}},eU={moduleName:"RowModelSharedApi",version:wt,apiFunctions:{onRowHeightChanged:u6,resetRowHeights:d6}},tU={moduleName:"SsrmInfiniteSharedApi",version:wt,apiFunctions:{setRowCount:Yz,getCacheBlockState:Zz,isLastRowIndexKnown:Jz}},rU=class extends et{constructor(){super(...arguments),this.beanName="alignedGridsSvc",this.consuming=!1}getAlignedGridApis(){let e=this.gos.get("alignedGrids")??[];const t=typeof e=="function";return typeof e=="function"&&(e=e()),e.map(n=>{if(!n){Ar(18),t||Ar(20);return}if(this.isGridApi(n))return n;const i=n;return"current"in i?i.current?.api:(i.api||Ar(19),i.api)}).filter(n=>!!n&&!n.isDestroyed())}isGridApi(e){return!!e&&!!e.dispatchEvent}postConstruct(){const e=this.fireColumnEvent.bind(this);this.addManagedEventListeners({columnMoved:e,columnVisible:e,columnPinned:e,columnGroupOpened:e,columnResized:e,bodyScroll:this.fireScrollEvent.bind(this),alignedGridColumn:({event:t})=>this.onColumnEvent(t),alignedGridScroll:({event:t})=>this.onScrollEvent(t)})}fireEvent(e){if(!this.consuming)for(const t of this.getAlignedGridApis())t.isDestroyed()||t.dispatchEvent(e)}onEvent(e){this.consuming=!0,e(),this.consuming=!1}fireColumnEvent(e){this.fireEvent({type:"alignedGridColumn",event:e})}fireScrollEvent(e){e.direction==="horizontal"&&this.fireEvent({type:"alignedGridScroll",event:e})}onScrollEvent(e){this.onEvent(()=>{this.beans.ctrlsSvc.getScrollFeature().setHorizontalScrollPosition(e.left,!0)})}extractDataFromEvent(e,t){const r=[];return e.columns?e.columns.forEach(n=>{r.push(t(n))}):e.column&&r.push(t(e.column)),r}getMasterColumns(e){return this.extractDataFromEvent(e,t=>t)}getColumnIds(e){return this.extractDataFromEvent(e,t=>t.getColId())}onColumnEvent(e){this.onEvent(()=>{switch(e.type){case"columnMoved":case"columnVisible":case"columnPinned":case"columnResized":{this.processColumnEvent(e);break}case"columnGroupOpened":{this.processGroupOpenedEvent(e);break}case"columnPivotChanged":at(21);break}})}processGroupOpenedEvent(e){const{colGroupSvc:t}=this.beans;if(t)for(const r of e.columnGroups){let n=null;r&&(n=t.getProvidedColGroup(r.getGroupId())),!(r&&!n)&&t.setColumnGroupOpened(n,r.isExpanded(),"alignedGridChanged")}}processColumnEvent(e){const t=e.column;let r=null;const n=this.beans,{colResize:i,ctrlsSvc:s,colModel:o}=n;if(t&&(r=o.getColDefCol(t.getColId())),t&&!r)return;const a=this.getMasterColumns(e);switch(e.type){case"columnMoved":{const h=e.api.getColumnState().map(d=>({colId:d.colId}));Ws(n,{state:h,applyOrder:!0},"alignedGridChanged")}break;case"columnVisible":{const h=e.api.getColumnState().map(d=>({colId:d.colId,hide:d.hide}));Ws(n,{state:h},"alignedGridChanged")}break;case"columnPinned":{const h=e.api.getColumnState().map(d=>({colId:d.colId,pinned:d.pinned}));Ws(n,{state:h},"alignedGridChanged")}break;case"columnResized":{const u=e,h={};for(const d of a)h[d.getId()]={key:d.getColId(),newWidth:d.getActualWidth()};for(const d of u.flexColumns??[])h[d.getId()]&&delete h[d.getId()];i?.setColumnWidths(Object.values(h),!1,u.finished,"alignedGridChanged");break}}const c=s.getGridBodyCtrl().isVerticalScrollShowing();for(const u of this.getAlignedGridApis())u.setGridOption("alwaysShowVerticalScroll",c)}},nU={moduleName:"AlignedGrids",version:wt,beans:[rU],dependsOn:[bR]},iU=class extends et{constructor(e){super(),this.rootNode=e,this.nextId=0,this.allNodesMap={},i3(e)}getRowNode(e){return this.allNodesMap[e]}setNewRowData(e){this.dispatchRowDataUpdateStarted(e),this.destroyAllNodes();const t=i3(this.rootNode),r=new Array(e.length);t._leafs=r;let n=0;const i=this.beans.groupStage?.getNestedDataGetter(),s=i?new Set:null,o=(a,l)=>{const c=a.level+1;for(let u=0,h=l.length;u<h;++u){const d=l[u];if(!d)continue;const f=this.createRowNode(d,c);if(f.sourceRowIndex=n,r[n++]=f,s&&!s.has(d)){s.add(d),f.treeParent=a;const m=i(d);m&&o(f,m)}}};o(t,e),r.length=n}destroyAllNodes(){const{selectionSvc:e,pinnedRowModel:t,groupStage:r}=this.beans;e?.reset("rowDataChanged"),t?.isManual()&&t.reset(),r?.clearNonLeafs();const n=this.rootNode._leafs;if(n)for(let i=0,s=n.length;i<s;++i)n[i]._destroy(!1);this.allNodesMap=Object.create(null),this.nextId=0}setImmutableRowData(e,t){const{rootNode:r,gos:n}=this;this.dispatchRowDataUpdateStarted(t);const i=ld(n),s=e.changedRowNodes,{adds:o,updates:a}=s,l=new Set,c=[],u=this.beans.groupStage?.getNestedDataGetter();let h=n.get("suppressMaintainUnsortedOrder")?void 0:!1,d=-1,f=!1;const m=(w,y)=>{if(!h&&h!==void 0){const C=w.sourceRowIndex;h=C<=d,d=C}w.data!==y&&(w.updateData(y),o.has(w)||a.add(w),!w.selectable&&w.isSelected()&&c.push(w))},v=(w,y,C)=>{for(let k=0,F=y.length;k<F;++k){const I=y[k];if(!I)continue;let N=this.getRowNode(i({data:I,level:C}));if(N?(m(N,I),f||(f=!!u&&N.treeParent!==w)):(N=this.createRowNode(I,C),o.add(N)),!u||l.has(N)){l.add(N);continue}l.add(N),N.treeParent=w;const j=u(I);j&&v(N,j,C+1)}};v(r,t,0);const g=this.deleteUnusedNodes(l,s,c,!!e.animate)||h||o.size>0;if(g){const w=r._leafs??(r._leafs=[]);h===void 0?cU(w,l,s):lU(w,l)&&(s.reordered=!0)}(g||f||a.size)&&(e.rowDataUpdated=!0,this.deselect(c))}deleteUnusedNodes(e,{removals:t},r,n){const i=this.rootNode._leafs;for(let s=0,o=i.length;s<o;s++){const a=i[s];e.has(a)||this.destroyNode(a,n)&&(t.push(a),a.isSelected()&&r.push(a))}return t.length>0}updateRowData(e,t,r){if(this.dispatchRowDataUpdateStarted(e.add),this.beans.groupStage?.getNestedDataGetter())return at(268),{remove:[],update:[],add:[]};const n=[],i=ld(this.gos),s=this.executeRemove(i,e,t,n,r),o=this.executeUpdate(i,e,t,n),a=this.executeAdd(e,t);return this.deselect(n),{remove:s,update:o,add:a}}executeRemove(e,{remove:t},{adds:r,updates:n,removals:i},s,o){const a=this.rootNode._leafs,l=a?.length,c=t?.length;if(!c||!l)return[];let u=0,h=l,d=0;const f=new Array(c);for(let m=0;m<c;++m){const v=this.lookupNode(e,t[m]);if(!v)continue;const g=v.sourceRowIndex;g<h&&(h=g),g>d&&(d=g),f[u++]=v,this.destroyNode(v,o)&&(v.isSelected()&&s.push(v),r.delete(v)||(n.delete(v),i.push(v)))}return f.length=u,u&&aU(a,h,d),f}executeUpdate(e,{update:t},{adds:r,updates:n},i){const s=t?.length;if(!s)return[];const o=new Array(s);let a=0;for(let l=0;l<s;l++){const c=t[l],u=this.lookupNode(e,c);u&&(u.updateData(c),!u.selectable&&u.isSelected()&&i.push(u),o[a++]=u,r.has(u)||n.add(u))}return o.length=a,o}executeAdd(e,t){var r;const n=(r=this.rootNode)._leafs??(r._leafs=[]),i=n.length,s=e.add,o=s?.length;if(!o)return[];const a=i+o;let l=this.sanitizeAddIndex(n,e.addIndex);if(l<i){for(let h=i-1,d=a-1;h>=l;--h){const f=n[h];f.sourceRowIndex=d,n[d--]=f}t.reordered=!0}n.length=a;const c=new Array(o),u=t.adds;for(let h=0;h<o;h++){const d=this.createRowNode(s[h],0);u.add(d),d.sourceRowIndex=l,n[l]=d,c[h]=d,l++}return c}dispatchRowDataUpdateStarted(e){this.eventSvc.dispatchEvent({type:"rowDataUpdateStarted",firstRowData:e?.length?e[0]:null})}deselect(e){const t="rowDataChanged",r=this.beans.selectionSvc;e.length&&r?.setNodesSelected({newValue:!1,nodes:e,suppressFinishActions:!0,source:t}),r?.updateGroupsFromChildrenSelections?.(t),e.length&&this.eventSvc.dispatchEvent({type:"selectionChanged",source:t,selectedNodes:r?.getSelectedNodes()??null,serverSideState:null})}createRowNode(e,t){const r=new ul(this.beans);r.parent=this.rootNode,r.level=t,r.group=!1,r.expanded=!1,r.setDataAndId(e,String(this.nextId++));const n=r.id,i=this.allNodesMap;return i[n]&&at(2,{nodeId:n}),i[n]=r,r}destroyNode(e,t){if(!e._destroy(t))return!1;const r=e.id,n=this.allNodesMap;n[r]===e&&delete n[r];const i=e.pinnedSibling;return i&&this.beans.pinnedRowModel?.pinRow(i,null),!0}lookupNode(e,t){if(!e)return oU(this.rootNode._leafs,t);const r=e({data:t,level:0}),n=this.allNodesMap[r];return n||(Ar(4,{id:r}),null)}sanitizeAddIndex(e,t){const r=e.length;if(typeof t!="number"||t<0||t>=r||Number.isNaN(t))return r;t=Math.ceil(t);const n=this.gos;return t>0&&n.get("treeData")&&n.get("getDataPath")&&(t=sU(e,t)),t}},sU=(e,t)=>{for(let r=0,n=e.length;r<n;r++)if(e[r]?.rowIndex==t-1)return r+1;return t},i3=e=>{e.group=!0,e.level=-1,e.id="ROOT_NODE_ID",e._leafs?.length!==0&&(e._leafs=[]);const t=[],r=[],n=[],i=[];e.childrenAfterGroup=t,e.childrenAfterSort=r,e.childrenAfterAggFilter=n,e.childrenAfterFilter=i;const s=e.sibling;return s&&(s.childrenAfterGroup=t,s.childrenAfterSort=r,s.childrenAfterAggFilter=n,s.childrenAfterFilter=i,s.childrenMapped=e.childrenMapped),e.updateHasChildren(),e},oU=(e,t)=>{if(e)for(let r=0,n=e.length;r<n;r++){const i=e[r];if(i.data===t)return i}return Ar(5,{data:t}),null},aU=(e,t,r)=>{t=Math.max(0,t);for(let n=t,i=e.length;n<i;++n){const s=e[n];n<=r&&s.destroyed||(s.sourceRowIndex=t,e[t++]=s)}e.length=t},lU=(e,t)=>{const r=t.size;e.length=r;let n=0,i=!1,s=!1;for(const o of t){const a=o.sourceRowIndex;a===n?s||(s=i):(a>=0?s=!0:i=!0,o.sourceRowIndex=n,e[n]=o),++n}return s},cU=(e,t,{adds:r})=>{const n=e.length,i=t.size;i>n&&(e.length=i);let s=0;for(let o=0;o<n;++o){const a=e[o];a.destroyed||(s!==o&&(a.sourceRowIndex=s,e[s]=a),++s)}for(const o of r)o.sourceRowIndex<0&&(o.sourceRowIndex=s,e[s++]=o);e.length=s},uU=4,dU=(e,t,r,n,i)=>{const s=t.childrenAfterSort,o=t.childrenAfterAggFilter;if(!o)return s&&s.length>0?s:[];const a=o.length;if(a<=1)return s?.length===a&&(a===0||s[0]===o[0])?s:o.slice();if(!s||a<=uU)return e.doFullSortInPlace(o.slice(),i);const l=new Map,{updates:c,adds:u}=r,h=[];for(let f=0;f<a;++f){const m=o[f];c.has(m)||u.has(m)||!n.canSkip(m)?(l.set(m,~f),h.push(m)):l.set(m,f)}const d=h.length;return d===0?a===s.length?s:fU(s,l,h):(h.sort((f,m)=>e.compareRowNodes(i,f,m)||~l.get(f)-~l.get(m)),d===a?h:hU(e,i,h,s,l,a))},hU=(e,t,r,n,i,s)=>{const o=new Array(s);let a=0,l=r[a],c,u=-1,h=0,d=0;const f=r.length,m=n.length;for(;;){if(u<0){if(h>=m)break;if(c=n[h++],u=i.get(c)??-1,u<0)continue}if((e.compareRowNodes(t,l,c)||~i.get(l)-u)<0){if(o[d++]=l,++a>=f)break;l=r[a]}else o[d++]=c,u=-1}for(;a<f;)o[d++]=r[a++];if(u<0)return o;for(o[d++]=c;h<m;){const v=n[h++];i.get(v)>=0&&(o[d++]=v)}return o},fU=(e,t,r)=>{let n=0;r.length=t.size;for(let i=0,s=e.length;i<s;++i){const o=e[i];t.has(o)&&(r[n++]=o)}return r.length=n,r},h6=e=>{const t=e.childrenAfterSort,r=e.sibling;if(r&&(r.childrenAfterSort=t),!!t)for(let n=0,i=t.length-1;n<=i;n++){const s=t[n],o=n===0,a=n===i;s.firstChild!==o&&(s.firstChild=o,s.dispatchRowEvent("firstChildChanged")),s.lastChild!==a&&(s.lastChild=a,s.dispatchRowEvent("lastChildChanged")),s.childIndex!==n&&(s.childIndex=n,s.dispatchRowEvent("childIndexChanged"))}},pU=class extends et{constructor(){super(...arguments),this.beanName="sortStage",this.step="sort",this.refreshProps=["postSortRows","groupDisplayType","accentedSort"]}execute(e,t){const r=this.beans.sortSvc.getSortOptions(),n=r.length>0&&!!t&&this.gos.get("deltaSort"),{gos:i,colModel:s,rowGroupColsSvc:o,rowNodeSorter:a,rowRenderer:l,showRowGroupCols:c}=this.beans,u=i.get("groupMaintainOrder"),h=s.getCols().some(y=>y.isRowGroupActive()),d=o?.columns,f=s.isPivotMode(),m=i.getCallback("postSortRows");let v=!1,g;const w=y=>{const C=f&&y.leafGroup;let k=u&&h&&!y.leafGroup;k&&(g??(g=this.shouldSortContainsGroupCols(r)),k&&(k=!g));let F=null;if(k){let I=!1;if(d){const N=y.level+1;N<d.length&&(I=d[N].wasSortExplicitlyRemoved)}I||(F=gU(y))}else!r.length||C||(n&&t?F=dU(a,y,t,e,r):F=a.doFullSortInPlace(y.childrenAfterAggFilter.slice(),r));if(F||(F=y.childrenAfterAggFilter?.slice()??[]),v||(v=y.childrenAfterSort?.[0]!==F[0]),y.childrenAfterSort=F,h6(y),m){const I={nodes:y.childrenAfterSort};m(I)}};if(e?.forEachChangedNodeDepthFirst(w),v&&i.get("groupHideOpenParents")){const y=c?.columns;y?.length&&l.refreshCells({columns:y,force:!0})}}shouldSortContainsGroupCols(e){const t=e.length;if(!t)return!1;if(Zo(this.gos)){for(let r=0;r<t;++r){const n=e[r].column;if(n.isPrimary()&&n.isRowGroupActive())return!0}return!1}for(let r=0;r<t;++r)if(e[r].column.getColDef().showRowGroup)return!0;return!1}},gU=e=>{const t=e.childrenAfterSort,r=e.childrenAfterAggFilter,n=t?.length,i=r?.length;if(!n||!i)return null;const s=new Array(i),o=new Set;for(let l=0;l<i;++l)o.add(r[l]);let a=0;for(let l=0;l<n;++l){const c=t[l];o.delete(c)&&(s[a++]=c)}if(o.size===0&&a===n)return t;for(const l of o)s[a++]=l;return s.length=a,s},mU=class extends et{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null,this.rowCountReady=!1,this.nodeManager=void 0,this.rowsToDisplay=[],this.formulaRows=[],this.rowDataUpdatedPending=!1,this.asyncTransactions=null,this.asyncTransactionsTimer=0,this.started=!1,this.refreshingModel=!1,this.rowNodesCountReady=!1,this.stages=null,this.stagesRefreshProps=new Map,this.onRowHeightChanged_debounced=zn(this,this.onRowHeightChanged.bind(this),100)}postConstruct(){const e=this.beans,t=new ul(e);this.rootNode=t,this.nodeManager=this.createBean(new iU(t));const r=()=>{this.beans.groupStage?.invalidateGroupCols(),this.refreshModel({step:"group",afterColumnsChanged:!0,keepRenderedRows:!0,animate:!this.gos.get("suppressAnimationFrame")})};this.addManagedEventListeners({newColumnsLoaded:r,columnRowGroupChanged:r,columnValueChanged:this.onValueChanged.bind(this),columnPivotChanged:()=>this.refreshModel({step:"pivot"}),columnPivotModeChanged:()=>this.refreshModel({step:"group"}),filterChanged:this.onFilterChanged.bind(this),sortChanged:this.onSortChanged.bind(this),stylesChanged:this.onGridStylesChanges.bind(this),gridReady:this.onGridReady.bind(this),rowExpansionStateChanged:this.onRowGroupOpened.bind(this)}),this.addPropertyListeners()}addPropertyListeners(){const{beans:e,stagesRefreshProps:t}=this,r=[e.groupStage,e.filterStage,e.pivotStage,e.aggStage,e.sortStage,e.filterAggStage,e.flattenStage].filter(n=>!!n);this.stages=r;for(let n=r.length-1;n>=0;--n){const i=r[n];for(const s of i.refreshProps)t.set(s,n)}this.addManagedPropertyListeners([...t.keys(),"rowData"],n=>{const i=n.changeSet?.properties;i&&this.onPropChange(i)}),this.addManagedPropertyListener("rowHeight",()=>this.resetRowHeights())}start(){this.started=!0,this.rowNodesCountReady?this.refreshModel({step:"group",rowDataUpdated:!0,newData:!0}):this.setInitialData()}setInitialData(){this.gos.get("rowData")&&this.onPropChange(["rowData"])}ensureRowHeightsValid(e,t,r,n){let i,s=!1;do{i=!1;const o=this.getRowIndexAtPixel(e),a=this.getRowIndexAtPixel(t),l=Math.max(o,r),c=Math.min(a,n);for(let u=l;u<=c;u++){const h=this.getRow(u);if(h.rowHeightEstimated){const d=al(this.beans,h);h.setRowHeight(d.height),i=!0,s=!0}}i&&this.setRowTopAndRowIndex()}while(i);return s}onPropChange(e){const{nodeManager:t,gos:r,beans:n}=this,i=n.groupStage;if(!t)return;const s=new Set(e),o=i?.onPropChange(s);let a;s.has("rowData")?a=r.get("rowData"):o&&(a=i?.extractData()),a&&!Array.isArray(a)&&(a=null,at(1));const l={step:"nothing",changedProps:s};a&&(!o&&!this.isEmpty()&&a.length>0&&r.exists("getRowId")&&!r.get("resetRowDataOnUpdate")?(l.keepRenderedRows=!0,l.animate=!r.get("suppressAnimationFrame"),l.changedRowNodes=new n0,t.setImmutableRowData(l,a)):(l.rowDataUpdated=!0,l.newData=!0,t.setNewRowData(a),this.rowNodesCountReady=!0));const c=l.rowDataUpdated?"group":this.getRefreshedStage(e);c&&(l.step=c,this.refreshModel(l))}getRefreshedStage(e){const{stages:t,stagesRefreshProps:r}=this;if(!t)return null;const n=t.length;let i=n;for(let s=0,o=e.length;s<o&&i;++s)i=Math.min(i,r.get(e[s])??i);return i<n?t[i].step:null}setRowTopAndRowIndex(e){const{beans:t,rowsToDisplay:r}=this,n=t.environment.getDefaultRowHeight();let i=0;const s=ni(this.gos,"normal");for(let o=0,a=r.length;o<a;++o){const l=r[o],c=l.id;if(c!=null&&e?.add(c),l.rowHeight==null){const u=al(t,l,s,n);l.setRowHeight(u.height,u.estimated)}l.setRowTop(i),l.setRowIndex(o),i+=l.rowHeight}if(this.beans.formula?.active){const o=this.formulaRows;for(let a=0,l=o.length;a<l;++a){const c=o[a];c.formulaRowIndex=a}}}clearRowTopAndRowIndex(e,t){const r=e.active,n=o=>{o?.id!=null&&!t.has(o.id)&&o.clearRowTopAndRowIndex()},i=o=>{n(o),n(o.detailNode),n(o.sibling);const a=o.childrenAfterGroup;if(!o.hasChildren()||!a)return;const l=o.level==-1;if(!(r&&!l&&!o.expanded))for(let u=0,h=a.length;u<h;++u)i(a[u])},s=this.rootNode;s&&i(s)}isLastRowIndexKnown(){return!0}getRowCount(){return this.rowsToDisplay.length}getTopLevelRowCount(){const{rootNode:e,rowsToDisplay:t}=this;if(!e||!t.length)return 0;if(t[0]===e)return 1;const n=e.sibling?.displayed?1:0;return(e.childrenAfterSort?.length??0)+n}getTopLevelRowDisplayedIndex(e){const{beans:t,rootNode:r,rowsToDisplay:n}=this;if(!r||!n.length||n[0]===r)return e;const s=r.childrenAfterSort,o=l=>{let c=s[l];if(this.gos.get("groupHideOpenParents"))for(;c.expanded&&c.childrenAfterSort&&c.childrenAfterSort.length>0;)c=c.childrenAfterSort[0];return c.rowIndex},a=t.footerSvc;return a?a?.getTopDisplayIndex(n,e,s,o):o(e)}getTopLevelIndexFromDisplayedIndex(e){const{rootNode:t,rowsToDisplay:r}=this;if(!t||!r.length||r[0]===t)return e;let i=this.getRow(e);i.footer&&(i=i.sibling);let s=i.parent;for(;s&&s!==t;)i=s,s=i.parent;const o=t.childrenAfterSort?.indexOf(i)??-1;return o>=0?o:e}getRowBounds(e){const t=this.rowsToDisplay[e];return t?{rowTop:t.rowTop,rowHeight:t.rowHeight}:null}onRowGroupOpened(){this.refreshModel({step:"map",keepRenderedRows:!0,animate:Uu(this.gos)})}onFilterChanged({afterDataChange:e,columns:t}){if(!e){const n=t.length===0||t.some(i=>i.isPrimary())?"filter":"filter_aggregates";this.refreshModel({step:n,keepRenderedRows:!0,animate:Uu(this.gos)})}}onSortChanged(){this.refreshModel({step:"sort",keepRenderedRows:!0,animate:Uu(this.gos)})}getType(){return"clientSide"}onValueChanged(){this.refreshModel({step:this.beans.colModel.isPivotActive()?"pivot":"aggregate"})}createChangePath(e){const t=new mf(!1,this.rootNode);return t.active=e,t}isSuppressModelUpdateAfterUpdateTransaction(e){if(!this.gos.get("suppressModelUpdateAfterUpdateTransaction"))return!1;const{changedRowNodes:t,newData:r,rowDataUpdated:n}=e;return!(!t||r||!n||t.removals.length||t.adds.size)}refreshModel(e){const{nodeManager:t,beans:r,eventSvc:n,started:i,refreshingModel:s}=this;if(!t)return;const o=!!e.rowDataUpdated,a=e.changedPath??(e.changedPath=this.createChangePath(!e.newData&&o));if(i&&o&&n.dispatchEvent({type:"rowDataUpdated"}),!i||s||r.colModel.changeEventsDispatching||this.isSuppressModelUpdateAfterUpdateTransaction(e)){this.rowDataUpdatedPending||(this.rowDataUpdatedPending=o);return}switch(this.rowDataUpdatedPending&&(this.rowDataUpdatedPending=!1,e.step="group"),this.refreshingModel=!0,r.masterDetailSvc?.refreshModel(e),o&&e.step!=="group"&&r.colFilter?.refreshModel(),e.step){case"group":this.doGrouping(e);case"filter":this.doFilter(a);case"pivot":this.doPivot(a);case"aggregate":this.doAggregate(a);case"filter_aggregates":this.doFilterAggregates(a);case"sort":this.doSort(a,e.changedRowNodes);case"map":this.doRowsToDisplay()}const l=new Set;this.setRowTopAndRowIndex(l),this.clearRowTopAndRowIndex(a,l),this.refreshingModel=!1,n.dispatchEvent({type:"modelUpdated",animate:e.animate,keepRenderedRows:e.keepRenderedRows,newData:e.newData,newPage:!1,keepUndoRedoStack:e.keepUndoRedoStack})}isEmpty(){return!this.rootNode?._leafs?.length||!this.beans.colModel?.ready}isRowsToRender(){return this.rowsToDisplay.length>0}getOverlayType(){return this.isEmpty()?"noRows":this.beans.filterManager?.isAnyFilterPresent()&&this.getRowCount()===0?"noMatchingRows":null}getNodesInRangeForSelection(e,t){let r=!1,n=!1;const i=[],s=hf(this.gos);return this.forEachNodeAfterFilterAndSort(o=>{if(n)return;if(r&&(o===t||o===e)&&(n=!0,s&&o.group)){f6(i,o);return}if(!r){if(o!==t&&o!==e)return;r=!0,t===e&&(n=!0)}(!o.group||!s)&&i.push(o)}),i}getTopLevelNodes(){return this.rootNode?.childrenAfterGroup??null}getRow(e){return this.rowsToDisplay[e]}getFormulaRow(e){return this.formulaRows[e]}isRowPresent(e){return this.rowsToDisplay.indexOf(e)>=0}getRowIndexAtPixel(e){const t=this.rowsToDisplay,r=t.length;if(this.isEmpty()||r===0)return-1;let n=0,i=r-1;if(e<=0)return 0;if(t[i].rowTop<=e)return i;let o=-1,a=-1;for(;;){const l=Math.floor((n+i)/2),c=t[l];if(this.isRowInPixel(c,e)||(c.rowTop<e?n=l+1:c.rowTop>e&&(i=l-1),o===n&&a===i))return l;o=n,a=i}}isRowInPixel(e,t){const r=e.rowTop,n=r+e.rowHeight;return r<=t&&n>t}forEachLeafNode(e){const t=this.rootNode?._leafs;if(t)for(let r=0,n=t.length;r<n;++r)e(t[r],r)}forEachNode(e,t=!1){this.depthFirstSearchRowNodes(e,t)}forEachDisplayedNode(e){const t=this.rowsToDisplay;for(let r=0,n=t.length;r<n;++r)e(t[r],r)}forEachNodeAfterFilter(e,t=!1){this.depthFirstSearchRowNodes(e,t,r=>r.childrenAfterAggFilter)}forEachNodeAfterFilterAndSort(e,t=!1){this.depthFirstSearchRowNodes(e,t,r=>r.childrenAfterSort)}forEachPivotNode(e,t,r){const{colModel:n,rowGroupColsSvc:i}=this.beans;if(!n.isPivotMode())return;if(!i?.columns.length){e(this.rootNode,0);return}const s=r?"childrenAfterSort":"childrenAfterGroup";this.depthFirstSearchRowNodes(e,t,o=>o.leafGroup?null:o[s])}depthFirstSearchRowNodes(e,t=!1,r=s=>s.childrenAfterGroup,n=this.rootNode,i=0){let s=i;if(!n)return s;const o=n===this.rootNode;if(o||e(n,s++),n.hasChildren()&&!n.footer){const a=r(n);if(a){const l=this.beans.footerSvc;s=l?.addTotalRows(s,n,e,t,o,"top")??s;for(const c of a)s=this.depthFirstSearchRowNodes(e,t,r,c,s);return l?.addTotalRows(s,n,e,t,o,"bottom")??s}}return s}doAggregate(e){this.rootNode&&this.beans.aggStage?.execute(e)}doFilterAggregates(e){const t=this.rootNode,r=this.beans.filterAggStage;if(r){r.execute(e);return}t.childrenAfterAggFilter=t.childrenAfterFilter}doSort(e,t){const r=this.beans.sortStage;if(r){r.execute(e,t);return}e.forEachChangedNodeDepthFirst(n=>{n.childrenAfterSort=n.childrenAfterAggFilter.slice(0),h6(n)})}doGrouping(e){const t=this.rootNode;if(!t)return;const n=this.beans.groupStage?.execute(e);if(n===void 0){const i=t._leafs;t.childrenAfterGroup=i,t.updateHasChildren();const s=t.sibling;s&&(s.childrenAfterGroup=i)}(n||e.rowDataUpdated)&&this.beans.colFilter?.refreshModel(),!this.rowCountReady&&this.rowNodesCountReady&&(this.rowCountReady=!0,this.eventSvc.dispatchEventOnce({type:"rowCountReady"}))}doFilter(e){const t=this.beans.filterStage;if(t){t.execute(e);return}e.forEachChangedNodeDepthFirst(r=>{r.childrenAfterFilter=r.childrenAfterGroup,_w(r)},!0)}doPivot(e){this.beans.pivotStage?.execute(e)}getRowNode(e){const t=this.nodeManager?.getRowNode(e);return typeof t=="object"?t:this.beans.groupStage?.getNonLeaf(e)}batchUpdateRowData(e,t){if(!this.asyncTransactionsTimer){this.asyncTransactions=[];const r=this.gos.get("asyncTransactionWaitMillis");this.asyncTransactionsTimer=setTimeout(()=>this.executeBatchUpdateRowData(),r)}this.asyncTransactions.push({rowDataTransaction:e,callback:t})}flushAsyncTransactions(){const e=this.asyncTransactionsTimer;e&&(clearTimeout(e),this.executeBatchUpdateRowData())}executeBatchUpdateRowData(){const{nodeManager:e,beans:t,eventSvc:r,asyncTransactions:n}=this;if(!e)return;t.valueCache?.onDataChanged();const i=[],s=[],o=new n0,a=!this.gos.get("suppressAnimationFrame");for(const{rowDataTransaction:l,callback:c}of n??[]){this.rowNodesCountReady=!0;const u=e.updateRowData(l,o,a);i.push(u),c&&s.push(c.bind(null,u))}this.commitTransactions(o,a),s.length>0&&setTimeout(()=>{for(let l=0,c=s.length;l<c;l++)s[l]()},0),i.length>0&&r.dispatchEvent({type:"asyncTransactionsFlushed",results:i}),this.asyncTransactionsTimer=0,this.asyncTransactions=null}updateRowData(e){const t=this.nodeManager;if(!t)return null;this.beans.valueCache?.onDataChanged(),this.rowNodesCountReady=!0;const r=new n0,n=!this.gos.get("suppressAnimationFrame"),i=t.updateRowData(e,r,n);return this.commitTransactions(r,n),i}commitTransactions(e,t){this.refreshModel({step:"group",rowDataUpdated:!0,keepRenderedRows:!0,animate:t,changedRowNodes:e,changedPath:this.createChangePath(!0)})}doRowsToDisplay(){const{rootNode:e,beans:t}=this;if(t.formula?.active){const i=e?.childrenAfterSort??[];this.formulaRows=i,this.rowsToDisplay=i.filter(s=>!s.softFiltered);for(const s of this.rowsToDisplay)s.setUiLevel(0);return}const r=t.flattenStage;if(r){this.rowsToDisplay=r.execute();return}const n=this.rootNode.childrenAfterSort??[];for(const i of n)i.setUiLevel(0);this.rowsToDisplay=n}onRowHeightChanged(){this.refreshModel({step:"map",keepRenderedRows:!0,keepUndoRedoStack:!0})}resetRowHeights(){const e=this.rootNode;if(!e)return;const t=this.resetRowHeightsForAllRowNodes();e.setRowHeight(e.rowHeight,!0);const r=e.sibling;r?.setRowHeight(r.rowHeight,!0),t&&this.onRowHeightChanged()}resetRowHeightsForAllRowNodes(){let e=!1;return this.forEachNode(t=>{t.setRowHeight(t.rowHeight,!0);const r=t.detailNode;r?.setRowHeight(r.rowHeight,!0);const n=t.sibling;n?.setRowHeight(n.rowHeight,!0),e=!0}),e}onGridStylesChanges(e){e.rowHeightChanged&&!this.beans.rowAutoHeight?.active&&this.resetRowHeights()}onGridReady(){this.started||this.setInitialData()}destroy(){super.destroy(),this.nodeManager=this.destroyBean(this.nodeManager),this.started=!1,this.rootNode=null,this.rowsToDisplay=[],this.asyncTransactions=null,this.stages=null,this.stagesRefreshProps.clear(),clearTimeout(this.asyncTransactionsTimer)}onRowHeightChangedDebounced(){this.onRowHeightChanged_debounced()}},f6=(e,t)=>{const r=t.childrenAfterGroup;if(r)for(let n=0,i=r.length;n<i;++n){const s=r[n];s.data&&e.push(s),s.group&&f6(e,s)}};function vU(e){e.expansionSvc?.onGroupExpandedOrCollapsed()}function bU(e,t){const r=wl(e);r&&((!t||t==="everything")&&(t="group"),r.refreshModel({step:t,keepRenderedRows:!0,animate:!e.gos.get("suppressAnimationFrame")}))}function wU(e){return wl(e)?.isEmpty()??!0}function yU(e,t){wl(e)?.forEachLeafNode(t)}function CU(e,t){wl(e)?.forEachNodeAfterFilter(t)}function xU(e,t){wl(e)?.forEachNodeAfterFilterAndSort(t)}function SU(e,t){return e.frameworkOverrides.wrapIncoming(()=>wl(e)?.updateRowData(t))}function _U(e,t,r){e.frameworkOverrides.wrapIncoming(()=>wl(e)?.batchUpdateRowData(t,r))}function EU(e){e.frameworkOverrides.wrapIncoming(()=>wl(e)?.flushAsyncTransactions())}function TU(e){return e.selectionSvc?.getBestCostNodeSelection()}var kU={moduleName:"ClientSideRowModel",version:wt,rowModels:["clientSide"],beans:[mU,pU],dependsOn:[IR]},RU={moduleName:"ClientSideRowModelApi",version:wt,apiFunctions:{onGroupExpandedOrCollapsed:vU,refreshClientSideRowModel:bU,isRowDataEmpty:wU,forEachLeafNode:yU,forEachNodeAfterFilter:CU,forEachNodeAfterFilterAndSort:xU,applyTransaction:SU,applyTransactionAsync:_U,flushAsyncTransactions:EU,getBestCostNodeSelection:TU,resetRowHeights:d6,onRowHeightChanged:u6},dependsOn:[Qz,eU]},AU=class extends et{constructor(){super(...arguments),this.beanName="gridSerializer"}wireBeans(e){this.visibleCols=e.visibleCols,this.colModel=e.colModel,this.rowModel=e.rowModel,this.pinnedRowModel=e.pinnedRowModel}serialize(e,t={}){const{allColumns:r,columnKeys:n,skipRowGroups:i,exportRowNumbers:s}=t,o=this.getColumnsToExport({allColumns:r,skipRowGroups:i,columnKeys:n,exportRowNumbers:s});return[this.prepareSession(o),this.prependContent(t),this.exportColumnGroups(t,o),this.exportHeaders(t,o),this.processPinnedTopRows(t,o),this.processRows(t,o),this.processPinnedBottomRows(t,o),this.appendContent(t)].reduce((a,l)=>l(a),e).parse()}processRow(e,t,r,n){const i=t.shouldRowBeSkipped||(()=>!1),o=t.rowPositions!=null||!!t.onlySelected,a=this.gos.get("groupHideOpenParents")&&!o,l=this.colModel.isPivotMode()?n.leafGroup:!n.group,c=!!n.footer,u=n.allChildrenCount===1&&n.childrenAfterGroup?.length===1&&ID(this.gos,n);if(!l&&!c&&(t.skipRowGroups||u||a)||t.onlySelected&&!n.isSelected()||t.skipPinnedTop&&n.rowPinned==="top"||t.skipPinnedBottom&&n.rowPinned==="bottom"||n.stub||n.level===-1&&!l&&!c||i(Dt(this.gos,{node:n})))return;const f=e.onNewBodyRow(n);if(r.forEach((m,v)=>{f.onColumn(m,v,n)}),t.getCustomContentBelowRow){const m=t.getCustomContentBelowRow(Dt(this.gos,{node:n}));m&&e.addCustomContent(m)}}appendContent(e){return t=>{const r=e.appendContent;return r&&t.addCustomContent(r),t}}prependContent(e){return t=>{const r=e.prependContent;return r&&t.addCustomContent(r),t}}prepareSession(e){return t=>(t.prepare(e),t)}exportColumnGroups(e,t){return r=>{if(!e.skipColumnGroupHeaders){const n=new pk,{colGroupSvc:i}=this.beans,s=i?i.createColumnGroups({columns:t,idCreator:n,pinned:null,isStandaloneStructure:!0}):t;this.recursivelyAddHeaderGroups(s,r,e.processGroupHeaderCallback)}return r}}exportHeaders(e,t){return r=>{if(!e.skipColumnHeaders){const n=r.onNewHeaderRow();t.forEach((i,s)=>{n.onColumn(i,s,void 0)})}return r}}processPinnedTopRows(e,t){return r=>{const n=this.processRow.bind(this,r,e,t);return e.rowPositions?e.rowPositions.filter(i=>i.rowPinned==="top").sort((i,s)=>i.rowIndex-s.rowIndex).map(i=>this.pinnedRowModel?.getPinnedTopRow(i.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("top",n),r}}processRows(e,t){return r=>{const n=this.rowModel,i=rn(this.gos),s=Cd(this.gos),o=!i&&e.onlySelected,a=this.processRow.bind(this,r,e,t),{exportedRows:l="filteredAndSorted"}=e;if(e.rowPositions)e.rowPositions.filter(c=>c.rowPinned==null).sort((c,u)=>c.rowIndex-u.rowIndex).map(c=>n.getRow(c.rowIndex)).forEach(a);else if(this.colModel.isPivotMode())i?n.forEachPivotNode(a,!0,l==="filteredAndSorted"):s?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);else if(e.onlySelectedAllPages||o){const c=this.beans.selectionSvc?.getSelectedNodes()??[];this.replicateSortedOrder(c),c.forEach(a)}else l==="all"?n.forEachNode(a):i||s?n.forEachNodeAfterFilterAndSort(a,!0):n.forEachNode(a);return r}}replicateSortedOrder(e){const{sortSvc:t,rowNodeSorter:r}=this.beans;if(!t||!r)return;const n=t.getSortOptions(),i=(s,o)=>s.rowIndex!=null&&o.rowIndex!=null?s.rowIndex-o.rowIndex:s.level===o.level?s.parent?.id===o.parent?.id?r.compareRowNodes(n,s,o)||(s.rowIndex??-1)-(o.rowIndex??-1):i(s.parent,o.parent):s.level>o.level?i(s.parent,o):i(s,o.parent);e.sort(i)}processPinnedBottomRows(e,t){return r=>{const n=this.processRow.bind(this,r,e,t);return e.rowPositions?e.rowPositions.filter(i=>i.rowPinned==="bottom").sort((i,s)=>i.rowIndex-s.rowIndex).map(i=>this.pinnedRowModel?.getPinnedBottomRow(i.rowIndex)).forEach(n):this.pinnedRowModel?.isManual()||this.pinnedRowModel?.forEachPinnedRow("bottom",n),r}}getColumnsToExport(e){const{allColumns:t=!1,skipRowGroups:r=!1,exportRowNumbers:n=!1,columnKeys:i}=e,{colModel:s,gos:o,visibleCols:a}=this,l=s.isPivotMode(),c=d=>vl(d)?!1:!ta(d)||n;if(i?.length)return s.getColsForKeys(i).filter(c);const u=o.get("treeData");let h=[];return t&&!l?h=s.getCols():h=a.allCols,h=h.filter(d=>c(d)&&(r&&!u?!my(d):!0)),h}recursivelyAddHeaderGroups(e,t,r){const n=[];for(const i of e){const s=i;if(s.getChildren)for(const o of s.getChildren()??[])n.push(o)}e.length>0&&yn(e[0])&&this.doAddHeaderHeader(t,e,r),n&&n.length>0&&this.recursivelyAddHeaderGroups(n,t,r)}doAddHeaderHeader(e,t,r){const n=e.onNewHeaderGroupingRow();let i=0;for(const s of t){const o=s;let a;r?a=r(Dt(this.gos,{columnGroup:o})):a=this.beans.colNames.getDisplayNameForColumnGroup(o,"header");const c=(o.isExpandable()?o.getLeafColumns():[]).reduce((u,h,d,f)=>{let m=zr(u);return h.getColumnGroupShow()==="open"?(!m||m[1]!=null)&&(m=[d],u.push(m)):m&&m[1]==null&&(m[1]=d-1),d===f.length-1&&m&&m[1]==null&&(m[1]=d),u},[]);n.onColumn(o,a||"",i++,o.getLeafColumns().length-1,c)}}},FU={moduleName:"SharedExport",version:wt,beans:[AU]},s3=`\r
`,MU=class extends eV{constructor(e){super(e),this.config=e,this.isFirstLine=!0,this.result="";const{suppressQuotes:t,columnSeparator:r}=e;this.suppressQuotes=t,this.columnSeparator=r}addCustomContent(e){e&&(typeof e=="string"?(/^\s*\n/.test(e)||this.beginNewLine(),e=e.replace(/\r?\n/g,s3),this.result+=e):e.forEach(t=>{this.beginNewLine(),t.forEach((r,n)=>{n!==0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(r.data.value||""),r.mergeAcross&&this.appendEmptyCells(r.mergeAcross)})}))}onNewHeaderGroupingRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderGroupingRowColumn.bind(this)}}onNewHeaderGroupingRowColumn(e,t,r,n){r!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(t),this.appendEmptyCells(n)}appendEmptyCells(e){for(let t=1;t<=e;t++)this.result+=this.columnSeparator+this.putInQuotes("")}onNewHeaderRow(){return this.beginNewLine(),{onColumn:this.onNewHeaderRowColumn.bind(this)}}onNewHeaderRowColumn(e,t){t!=0&&(this.result+=this.columnSeparator),this.result+=this.putInQuotes(this.extractHeaderValue(e))}onNewBodyRow(){return this.beginNewLine(),{onColumn:this.onNewBodyRowColumn.bind(this)}}onNewBodyRowColumn(e,t,r){t!=0&&(this.result+=this.columnSeparator);const n=this.extractRowCellValue({column:e,node:r,currentColumnIndex:t,accumulatedRowIndex:t,type:"csv",useRawFormula:!1});this.result+=this.putInQuotes(n.valueFormatted??n.value)}putInQuotes(e){if(this.suppressQuotes)return e;if(e==null)return'""';let t;return typeof e=="string"?t=e:typeof e.toString=="function"?t=e.toString():(at(53),t=""),'"'+t.replace(/"/g,'""')+'"'}parse(){return this.result}beginNewLine(){this.isFirstLine||(this.result+=s3),this.isFirstLine=!1}},DU=class extends Qj{constructor(){super(...arguments),this.beanName="csvCreator"}getMergedParams(e){const t=this.gos.get("defaultCsvExportParams");return Object.assign({},t,e)}export(e){if(this.isExportSuppressed()){at(51);return}const t=()=>{const n=this.getMergedParams(e),i=this.getData(n),s=new Blob(["\uFEFF",i],{type:"text/plain"}),o=n.fileName,a=typeof o=="function"?o(Dt(this.gos,{})):o;tV(this.getFileName(a),s)},{overlays:r}=this.beans;r?r.showExportOverlay(t):t()}exportDataAsCsv(e){this.export(e)}getDataAsCsv(e,t=!1){const r=t?Object.assign({},e):this.getMergedParams(e);return this.getData(r)}getDefaultFileExtension(){return"csv"}createSerializingSession(e){const{colModel:t,colNames:r,rowGroupColsSvc:n,valueSvc:i,gos:s}=this.beans,{processCellCallback:o,processHeaderCallback:a,processGroupHeaderCallback:l,processRowGroupCallback:c,suppressQuotes:u,columnSeparator:h}=e;return new MU({colModel:t,colNames:r,valueSvc:i,gos:s,processCellCallback:o||void 0,processHeaderCallback:a||void 0,processGroupHeaderCallback:l||void 0,processRowGroupCallback:c||void 0,suppressQuotes:u||!1,columnSeparator:h||",",rowGroupColsSvc:n})}isExportSuppressed(){return this.gos.get("suppressCsvExport")}};function PU(e,t){return e.csvCreator?.getDataAsCsv(t)}function IU(e,t){e.csvCreator?.exportDataAsCsv(t)}var OU={moduleName:"CsvExport",version:wt,beans:[DU],apiFunctions:{getDataAsCsv:PU,exportDataAsCsv:IU},dependsOn:[FU]},NU=class extends et{constructor(e,t,r){super(),this.id=e,this.parentCache=t,this.params=r,this.state="needsLoading",this.version=0,this.startRow=e*r.blockSize,this.endRow=this.startRow+r.blockSize}load(){this.state="loading",this.loadFromDatasource()}setStateWaitingToLoad(){this.version++,this.state="needsLoading"}pageLoadFailed(e){this.isRequestMostRecentAndLive(e)&&(this.state="failed"),this.dispatchLocalEvent({type:"loadComplete"})}pageLoaded(e,t,r){this.successCommon(e,{rowData:t,rowCount:r})}isRequestMostRecentAndLive(e){const t=e===this.version,r=this.isAlive();return t&&r}successCommon(e,t){this.dispatchLocalEvent({type:"loadComplete"}),this.isRequestMostRecentAndLive(e)&&(this.state="loaded",this.processServerResult(t))}postConstruct(){this.rowNodes=[];const{params:{blockSize:e,rowHeight:t},startRow:r,beans:n,rowNodes:i}=this;for(let s=0;s<e;s++){const o=r+s,a=new ul(n);a.setRowHeight(t),a.uiLevel=0,a.setRowIndex(o),a.setRowTop(t*o),i.push(a)}}getBlockStateJson(){const{id:e,startRow:t,endRow:r,state:n}=this;return{id:""+e,state:{blockNumber:e,startRow:t,endRow:r,pageStatus:n}}}setDataAndId(e,t,r){bt(t)?e.setDataAndId(t,r.toString()):e.setDataAndId(void 0,void 0)}loadFromDatasource(){const e=this.createLoadParams();if(Yr(this.params.datasource.getRows)){at(90);return}window.setTimeout(()=>{this.params.datasource.getRows(e)},0)}createLoadParams(){const{startRow:e,endRow:t,version:r,params:{sortModel:n,filterModel:i},gos:s}=this;return Dt(s,{startRow:e,endRow:t,successCallback:this.pageLoaded.bind(this,r),failCallback:this.pageLoadFailed.bind(this,r),sortModel:n,filterModel:i})}forEachNode(e,t,r){this.rowNodes.forEach((n,i)=>{this.startRow+i<r&&e(n,t.value++)})}getRow(e,t=!1){t||(this.lastAccessed=this.params.lastAccessedSequence.value++);const r=e-this.startRow;return this.rowNodes[r]}processServerResult(e){const{rowNodes:t,beans:r}=this;t.forEach((i,s)=>{const o=e.rowData?e.rowData[s]:void 0;!i.id&&i.alreadyRendered&&o&&(t[s]=new ul(r),t[s].setRowIndex(i.rowIndex),t[s].setRowTop(i.rowTop),t[s].setRowHeight(i.rowHeight),i._destroy(!0)),this.setDataAndId(t[s],o,this.startRow+s)});const n=e.rowCount!=null&&e.rowCount>=0?e.rowCount:void 0;this.parentCache.pageLoaded(this,n)}destroy(){const e=this.rowNodes;for(let t=0,r=e.length;t<r;t++)e[t]._destroy(!1);e.length=0,super.destroy()}},LU=2,BU=class extends et{constructor(e){super(),this.params=e,this.lastRowIndexKnown=!1,this.blocks={},this.blockCount=0,this.rowCount=e.initialRowCount}getRow(e,t=!1){const r=Math.floor(e/this.params.blockSize);let n=this.blocks[r];if(!n){if(t)return;n=this.createBlock(r)}return n.getRow(e)}createBlock(e){const t=this.params,r=this.createBean(new NU(e,this,t));return this.blocks[r.id]=r,this.blockCount++,this.purgeBlocksIfNeeded(r),t.rowNodeBlockLoader.addBlock(r),r}refreshCache(){if(this.blockCount==0){this.purgeCache();return}for(const t of this.getBlocksInOrder())t.setStateWaitingToLoad();this.params.rowNodeBlockLoader.checkBlockToLoad()}destroy(){for(const e of this.getBlocksInOrder())this.destroyBlock(e);super.destroy()}getRowCount(){return this.rowCount}isLastRowIndexKnown(){return this.lastRowIndexKnown}pageLoaded(e,t){this.isAlive()&&(mc(this.gos,`InfiniteCache - onPageLoaded: page = ${e.id}, lastRow = ${t}`),this.checkRowCount(e,t),this.onCacheUpdated())}purgeBlocksIfNeeded(e){const t=this.getBlocksInOrder().filter(o=>o!=e),r=(o,a)=>a.lastAccessed-o.lastAccessed;t.sort(r);const n=this.params.maxBlocksInCache>0,i=n?this.params.maxBlocksInCache-1:null,s=LU-1;t.forEach((o,a)=>{const l=o.state==="needsLoading"&&a>=s,c=n?a>=i:!1;if(l||c){if(this.isBlockCurrentlyDisplayed(o)||this.isBlockFocused(o))return;this.removeBlockFromCache(o)}})}isBlockFocused(e){const t=this.beans.focusSvc.getFocusCellToUseAfterRefresh();if(!t||t.rowPinned!=null)return!1;const{startRow:r,endRow:n}=e;return t.rowIndex>=r&&t.rowIndex<n}isBlockCurrentlyDisplayed(e){const{startRow:t,endRow:r}=e;return this.beans.rowRenderer.isRangeInRenderedViewport(t,r-1)}removeBlockFromCache(e){e&&this.destroyBlock(e)}checkRowCount(e,t){if(typeof t=="number"&&t>=0)this.rowCount=t,this.lastRowIndexKnown=!0;else if(!this.lastRowIndexKnown){const{blockSize:r,overflowSize:n}=this.params,s=(e.id+1)*r+n;this.rowCount<s&&(this.rowCount=s)}}setRowCount(e,t){this.rowCount=e,bt(t)&&(this.lastRowIndexKnown=t),this.lastRowIndexKnown||this.rowCount%this.params.blockSize===0&&this.rowCount++,this.onCacheUpdated()}forEachNodeDeep(e){const t={value:0};for(const r of this.getBlocksInOrder())r.forEachNode(e,t,this.rowCount)}getBlocksInOrder(){const e=(r,n)=>r.id-n.id;return Object.values(this.blocks).sort(e)}destroyBlock(e){delete this.blocks[e.id],this.destroyBean(e),this.blockCount--,this.params.rowNodeBlockLoader.removeBlock(e)}onCacheUpdated(){this.isAlive()&&(this.destroyAllBlocksPastVirtualRowCount(),this.eventSvc.dispatchEvent({type:"storeUpdated"}))}destroyAllBlocksPastVirtualRowCount(){const e=[];for(const t of this.getBlocksInOrder())t.id*this.params.blockSize>=this.rowCount&&e.push(t);if(e.length>0)for(const t of e)this.destroyBlock(t)}purgeCache(){for(const e of this.getBlocksInOrder())this.removeBlockFromCache(e);this.lastRowIndexKnown=!1,this.rowCount===0&&(this.rowCount=this.params.initialRowCount),this.onCacheUpdated()}getRowNodesInRange(e,t){const r=[];let n=-1,i=!1;const s={value:0};let o=!1;for(const l of this.getBlocksInOrder())if(!o){if(i&&n+1!==l.id){o=!0;continue}n=l.id,l.forEachNode(c=>{const u=c===e||c===t;(i||u)&&r.push(c),u&&(i=!i)},s,this.rowCount)}return o||i?[]:r}},HU=class extends et{constructor(){super(...arguments),this.beanName="rowModel",this.rootNode=null}getRowBounds(e){return{rowHeight:this.rowHeight,rowTop:this.rowHeight*e}}ensureRowHeightsValid(){return!1}postConstruct(){if(this.gos.get("rowModelType")!=="infinite")return;const e=this.beans,t=new ul(e);this.rootNode=t,t.level=-1,this.rowHeight=oc(e),this.addEventListeners(),this.addDestroyFunc(()=>this.destroyCache())}start(){this.setDatasource(this.gos.get("datasource"))}destroy(){this.destroyDatasource(),super.destroy(),this.rootNode=null}destroyDatasource(){this.datasource&&(this.destroyBean(this.datasource),this.beans.rowRenderer.datasourceChanged(),this.datasource=null)}addEventListeners(){this.addManagedEventListeners({filterChanged:this.reset.bind(this),sortChanged:this.reset.bind(this),newColumnsLoaded:this.onColumnEverything.bind(this),storeUpdated:this.dispatchModelUpdatedEvent.bind(this)}),this.addManagedPropertyListener("datasource",()=>this.setDatasource(this.gos.get("datasource"))),this.addManagedPropertyListener("cacheBlockSize",()=>this.resetCache()),this.addManagedPropertyListener("rowHeight",()=>{this.rowHeight=oc(this.beans),this.cacheParams.rowHeight=this.rowHeight,this.updateRowHeights()})}onColumnEverything(){let e;this.cacheParams?e=!of(this.cacheParams.sortModel,this.beans.sortSvc?.getSortModel()??[]):e=!0,e&&this.reset()}getType(){return"infinite"}setDatasource(e){this.destroyDatasource(),this.datasource=e,e&&this.reset()}isEmpty(){return!this.infiniteCache}isRowsToRender(){return!!this.infiniteCache}getOverlayType(){return this.infiniteCache?.getRowCount()===0?this.beans.filterManager?.isAnyFilterPresent()?"noMatchingRows":"noRows":null}getNodesInRangeForSelection(e,t){return this.infiniteCache?.getRowNodesInRange(e,t)??[]}reset(){if(!this.datasource)return;ld(this.gos)!=null||this.beans.selectionSvc?.reset("rowDataChanged"),this.resetCache()}dispatchModelUpdatedEvent(){this.eventSvc.dispatchEvent({type:"modelUpdated",newPage:!1,newPageSize:!1,newData:!1,keepRenderedRows:!0,animate:!1})}resetCache(){this.destroyCache();const e=this.beans,{filterManager:t,sortSvc:r,rowNodeBlockLoader:n,eventSvc:i,gos:s}=e;this.cacheParams={datasource:this.datasource,filterModel:t?.getFilterModel()??{},sortModel:r?.getSortModel()??[],rowNodeBlockLoader:n,initialRowCount:s.get("infiniteInitialRowCount"),maxBlocksInCache:s.get("maxBlocksInCache"),rowHeight:oc(e),overflowSize:s.get("cacheOverflowSize"),blockSize:s.get("cacheBlockSize"),lastAccessedSequence:{value:0}},this.infiniteCache=this.createBean(new BU(this.cacheParams)),i.dispatchEventOnce({type:"rowCountReady"}),this.dispatchModelUpdatedEvent()}updateRowHeights(){this.forEachNode(e=>{e.setRowHeight(this.rowHeight),e.setRowTop(this.rowHeight*e.rowIndex)}),this.dispatchModelUpdatedEvent()}destroyCache(){this.infiniteCache=this.destroyBean(this.infiniteCache)}getRow(e){const t=this.infiniteCache;if(t&&!(e>=t.getRowCount()))return t.getRow(e)}getRowNode(e){let t;return this.forEachNode(r=>{r.id===e&&(t=r)}),t}forEachNode(e){this.infiniteCache?.forEachNodeDeep(e)}getTopLevelRowCount(){return this.getRowCount()}getTopLevelRowDisplayedIndex(e){return e}getRowIndexAtPixel(e){if(this.rowHeight!==0){const t=Math.floor(e/this.rowHeight),r=this.getRowCount()-1;return t>r?r:t}return 0}getRowCount(){return this.infiniteCache?this.infiniteCache.getRowCount():0}isRowPresent(e){return!!this.getRowNode(e.id)}refreshCache(){this.infiniteCache?.refreshCache()}purgeCache(){this.infiniteCache?.purgeCache()}isLastRowIndexKnown(){return this.infiniteCache?.isLastRowIndexKnown()??!1}setRowCount(e,t){this.infiniteCache?.setRowCount(e,t)}resetRowHeights(){}onRowHeightChanged(){}};function jU(e){dm(e)?.refreshCache()}function VU(e){dm(e)?.purgeCache()}function GU(e){return dm(e)?.getRowCount()}var zU=class extends et{constructor(){super(...arguments),this.beanName="rowNodeBlockLoader",this.activeBlockLoadsCount=0,this.blocks=[],this.active=!0}postConstruct(){this.maxConcurrentRequests=OD(this.gos);const e=this.gos.get("blockLoadDebounceMillis");e&&e>0&&(this.checkBlockToLoadDebounce=zn(this,this.performCheckBlocksToLoad.bind(this),e))}addBlock(e){this.blocks.push(e),e.addEventListener("loadComplete",this.loadComplete.bind(this)),this.checkBlockToLoad()}removeBlock(e){Eo(this.blocks,e)}destroy(){super.destroy(),this.active=!1}loadComplete(){this.activeBlockLoadsCount--,this.checkBlockToLoad()}checkBlockToLoad(){this.checkBlockToLoadDebounce?this.checkBlockToLoadDebounce():this.performCheckBlocksToLoad()}performCheckBlocksToLoad(){if(!this.active)return;if(this.printCacheStatus(),this.maxConcurrentRequests!=null&&this.activeBlockLoadsCount>=this.maxConcurrentRequests){mc(this.gos,"RowNodeBlockLoader - checkBlockToLoad: max loads exceeded");return}const e=this.maxConcurrentRequests!=null?this.maxConcurrentRequests-this.activeBlockLoadsCount:1,t=this.blocks.filter(r=>r.state==="needsLoading").slice(0,e);this.activeBlockLoadsCount+=t.length;for(const r of t)r.load();this.printCacheStatus()}getBlockState(){const e={};return this.blocks.forEach(t=>{const{id:r,state:n}=t.getBlockStateJson();e[r]=n}),e}printCacheStatus(){mc(this.gos,`RowNodeBlockLoader - printCacheStatus: activePageLoadsCount = ${this.activeBlockLoadsCount}, blocks = ${JSON.stringify(this.getBlockState())}`)}},UU={moduleName:"InfiniteRowModelCore",version:wt,rowModels:["infinite"],beans:[HU,zU]},WU={moduleName:"InfiniteRowModel",version:wt,apiFunctions:{refreshInfiniteCache:jU,purgeInfiniteCache:VU,getInfiniteRowCount:GU},dependsOn:[UU,tU]},$U="",qU="",KU={tag:"span",children:[{tag:"span",ref:"eDelta",cls:"ag-value-change-delta"},{tag:"span",ref:"eValue",cls:"ag-value-change-value"}]},XU=class extends pn{constructor(){super(KU),this.eValue=xt,this.eDelta=xt,this.refreshCount=0}init(e){this.refresh(e,!0)}showDelta(e,t){const r=Math.abs(t),n=e.formatValue(r),i=bt(n)?n:r,s=t>=0,o=this.eDelta;s?o.textContent=$U+i:o.textContent=qU+i,o.classList.toggle("ag-value-change-delta-up",s),o.classList.toggle("ag-value-change-delta-down",!s)}setTimerToRemoveDelta(){this.refreshCount++;const e=this.refreshCount;this.beans.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.hideDeltaValue()},2e3)})}hideDeltaValue(){this.eValue.classList.remove("ag-value-change-value-highlight"),Hi(this.eDelta)}refresh(e,t=!1){const{value:r,valueFormatted:n}=e,{eValue:i,lastValue:s,beans:o}=this;if(r===s||(bt(n)?i.textContent=n:bt(r)?i.textContent=r:Hi(i),o.filterManager?.isSuppressFlashingCellsBecauseFiltering()))return!1;const a=r&&typeof r=="object"&&"toNumber"in r?r.toNumber():r,l=s&&typeof s=="object"&&"toNumber"in s?s.toNumber():s;if(a===l)return!1;if(typeof a=="number"&&typeof l=="number"){const c=a-l;this.showDelta(e,c)}return s&&i.classList.add("ag-value-change-value-highlight"),t||this.setTimerToRemoveDelta(),this.lastValue=r,!0}},YU=".ag-value-slide-out{opacity:1}:where(.ag-ltr) .ag-value-slide-out{margin-right:5px;transition:opacity 3s,margin-right 3s}:where(.ag-rtl) .ag-value-slide-out{margin-left:5px;transition:opacity 3s,margin-left 3s}:where(.ag-ltr,.ag-rtl) .ag-value-slide-out{transition-timing-function:linear}.ag-value-slide-out-end{opacity:0}:where(.ag-ltr) .ag-value-slide-out-end{margin-right:10px}:where(.ag-rtl) .ag-value-slide-out-end{margin-left:10px}",ZU={tag:"span",children:[{tag:"span",ref:"eCurrent",cls:"ag-value-slide-current"}]},JU=class extends pn{constructor(){super(ZU),this.eCurrent=xt,this.refreshCount=0,this.registerCSS(YU)}init(e){this.refresh(e,!0)}addSlideAnimation(){this.refreshCount++;const e=this.refreshCount;this.ePrevious?.remove();const{beans:t,eCurrent:r}=this,n=ks({tag:"span",cls:"ag-value-slide-previous ag-value-slide-out"});this.ePrevious=n,n.textContent=r.textContent,this.getGui().insertBefore(n,r),t.frameworkOverrides.wrapIncoming(()=>{window.setTimeout(()=>{e===this.refreshCount&&this.ePrevious.classList.add("ag-value-slide-out-end")},50),window.setTimeout(()=>{e===this.refreshCount&&(this.ePrevious?.remove(),this.ePrevious=null)},3e3)})}refresh(e,t=!1){let r=e.value;if(Yr(r)&&(r=""),r===this.lastValue||this.beans.filterManager?.isSuppressFlashingCellsBecauseFiltering())return!1;t||this.addSlideAnimation(),this.lastValue=r;const n=this.eCurrent;return bt(e.valueFormatted)?n.textContent=e.valueFormatted:bt(e.value)?n.textContent=r:Hi(n),!0}},QU=class extends et{constructor(){super(...arguments),this.beanName="cellFlashSvc",this.nextAnimationTime=null,this.nextAnimationCycle=null,this.animations={highlight:new Map,"data-changed":new Map}}animateCell(e,t,r=this.beans.gos.get("cellFlashDuration"),n=this.beans.gos.get("cellFadeDuration")){const i=this.animations[t];i.delete(e);const s=Date.now(),o=s+r,a=s+r+n,l={phase:"flash",flashEndTime:o,fadeEndTime:a};i.set(e,l);const c=`ag-cell-${t}`,u=`${c}-animation`,{comp:h,eGui:{style:d}}=e;h.toggleCss(c,!0),h.toggleCss(u,!1),d.removeProperty("transition"),d.removeProperty("transition-delay"),this.nextAnimationTime&&o+15<this.nextAnimationTime&&(clearTimeout(this.nextAnimationCycle),this.nextAnimationCycle=null,this.nextAnimationTime=null),this.nextAnimationCycle||(this.beans.frameworkOverrides.wrapIncoming(()=>{this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),r)}),this.nextAnimationTime=o)}advanceAnimations(){const e=Date.now();let t=null;for(const r of Object.keys(this.animations)){const n=this.animations[r],i=`ag-cell-${r}`,s=`${i}-animation`;for(const[o,a]of n){if(!o.isAlive()||!o.comp){n.delete(o);continue}const{phase:l,flashEndTime:c,fadeEndTime:u}=a,h=l==="flash"?c:u;if(!(e+15>=h)){t=Math.min(h,t??1/0);continue}const{comp:f,eGui:{style:m}}=o;switch(l){case"flash":f.toggleCss(i,!1),f.toggleCss(s,!0),m.transition=`background-color ${u-c}ms`,m.transitionDelay=`${c-e}ms`,t=Math.min(u,t??1/0),a.phase="fade";break;case"fade":f.toggleCss(i,!1),f.toggleCss(s,!1),m.removeProperty("transition"),m.removeProperty("transition-delay"),n.delete(o);break}}}t==null?(this.nextAnimationTime=null,this.nextAnimationCycle=null):t&&(this.nextAnimationCycle=setTimeout(this.advanceAnimations.bind(this),t-e),this.nextAnimationTime=t)}onFlashCells(e,t){if(!e.comp)return;const r=_I(e.cellPosition);t.cells[r]&&this.animateCell(e,"highlight")}flashCell(e,t){this.animateCell(e,"data-changed",t?.flashDuration,t?.fadeDuration)}destroy(){for(const e of Object.keys(this.animations))this.animations[e].clear()}};function eW(e,t={}){const{cellFlashSvc:r}=e;r&&e.frameworkOverrides.wrapIncoming(()=>{for(const n of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns))r.flashCell(n,t)})}var tW={moduleName:"HighlightChanges",version:wt,beans:[QU],userComponents:{agAnimateShowChangeCellRenderer:XU,agAnimateSlideCellRenderer:JU},apiFunctions:{flashCells:eW}};function rW(e){return e.stateSvc?.getState()??{}}function nW(e,t,r){return e.stateSvc?.setState(t,r)}function o3(e){return e={...e},e.version||(e.version="32.1.0"),e.version==="32.1.0"&&(e=iW(e)),e.version=wt,e}function iW(e){return e.cellSelection=sW(e,"rangeSelection"),e}function sW(e,t){if(e&&typeof e=="object")return e[t]}var oW=class extends et{constructor(){super(...arguments),this.beanName="stateSvc",this.updateRowGroupExpansionStateTimer=0,this.suppressEvents=!0,this.queuedUpdateSources=new Set,this.dispatchStateUpdateEventDebounced=zn(this,()=>this.dispatchQueuedStateUpdateEvents(),0),this.onRowGroupOpenedDebounced=zn(this,()=>{this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(this.updateCachedState("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("rowGroupExpansion",void 0)):(this.updateCachedState("rowGroupExpansion",this.getRowGroupExpansionState()),this.updateCachedState("ssrmRowGroupExpansion",void 0))},0),this.onRowSelectedDebounced=zn(this,()=>{this.staleStateKeys.delete("rowSelection"),this.updateCachedState("rowSelection",this.getRowSelectionState())},0),this.staleStateKeys=new Set}postConstruct(){const{gos:e,ctrlsSvc:t,colDelayRenderSvc:r}=this.beans;this.isClientSideRowModel=rn(e);const n=o3(e.get("initialState")??{}),i=n.partialColumnState;delete n.partialColumnState,this.cachedState=n;const s=this.suppressEventsAndDispatchInitEvent.bind(this);t.whenReady(this,()=>s(()=>this.setupStateOnGridReady(n))),(n.columnOrder||n.columnVisibility||n.columnSizing||n.columnPinning||n.columnGroup)&&r?.hideColumns("columnState");const[o,a,l]=this.addManagedEventListeners({newColumnsLoaded:({source:c})=>{c==="gridInitializing"&&(o(),s(()=>{this.setupStateOnColumnsInitialised(n,!!i),r?.revealColumns("columnState")}))},rowCountReady:()=>{a?.(),s(()=>this.setupStateOnRowCountReady(n))},firstDataRendered:()=>{l?.(),s(()=>this.setupStateOnFirstDataRendered(n))}})}destroy(){super.destroy(),clearTimeout(this.updateRowGroupExpansionStateTimer),this.queuedUpdateSources.clear()}getState(){return this.staleStateKeys.size&&this.refreshStaleState(),this.cachedState}setState(e,t){const r=o3(e);delete r.partialColumnState,this.cachedState=r,this.startSuppressEvents();const n="api",i=t?new Set(t):void 0;this.setGridReadyState(r,n,i),this.setColumnsInitialisedState(r,n,!!i,i),this.setRowCountState(r,n,i),setTimeout(()=>{this.isAlive()&&this.setFirstDataRenderedState(r,n,i),this.stopSuppressEvents(n)})}setGridReadyState(e,t,r){t==="api"&&!r?.has("sideBar")&&this.beans.sideBar?.comp?.setState(e.sideBar),this.updateCachedState("sideBar",this.getSideBarState())}setupStateOnGridReady(e){this.setGridReadyState(e,"gridInitializing");const t=()=>this.updateCachedState("sideBar",this.getSideBarState());this.addManagedEventListeners({toolPanelVisibleChanged:t,sideBarUpdated:t})}updateColumnAndGroupState(){this.updateColumnState(["aggregation","columnOrder","columnPinning","columnSizing","columnVisibility","pivot","rowGroup","sort"]),this.updateCachedState("columnGroup",this.getColumnGroupState())}setColumnsInitialisedState(e,t,r,n){this.setColumnState(e,t,r,n),this.setColumnGroupState(e,t,n),this.updateColumnAndGroupState()}setupStateOnColumnsInitialised(e,t){this.setColumnsInitialisedState(e,"gridInitializing",t);const r=n=>()=>this.updateColumnState([n]);this.addManagedEventListeners({columnValueChanged:r("aggregation"),columnMoved:r("columnOrder"),columnPinned:r("columnPinning"),columnResized:r("columnSizing"),columnVisible:r("columnVisibility"),columnPivotChanged:r("pivot"),columnPivotModeChanged:r("pivot"),columnRowGroupChanged:r("rowGroup"),sortChanged:r("sort"),newColumnsLoaded:this.updateColumnAndGroupState.bind(this),columnGroupOpened:()=>this.updateCachedState("columnGroup",this.getColumnGroupState())})}setRowCountState(e,t,r){const{filter:n,rowGroupExpansion:i,ssrmRowGroupExpansion:s,rowSelection:o,pagination:a,rowPinning:l}=e,c=(h,d)=>!r?.has(h)&&(d||t==="api");c("filter",n)&&this.setFilterState(n),c("rowGroupExpansion",i)&&this.setRowGroupExpansionState(s,i,t),c("rowSelection",o)&&this.setRowSelectionState(o,t),c("pagination",a)&&this.setPaginationState(a,t),c("rowPinning",l)&&this.setRowPinningState(l);const u=this.updateCachedState.bind(this);u("filter",this.getFilterState()),this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(u("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),u("rowGroupExpansion",void 0)):(u("rowGroupExpansion",this.getRowGroupExpansionState()),u("ssrmRowGroupExpansion",void 0)),u("rowSelection",this.getRowSelectionState()),u("pagination",this.getPaginationState())}setupStateOnRowCountReady(e){this.setRowCountState(e,"gridInitializing");const t=this.updateCachedState.bind(this),r=()=>{this.updateRowGroupExpansionStateTimer=0,this.beans.gos.get("ssrmExpandAllAffectsAllRows")?(t("ssrmRowGroupExpansion",this.getRowGroupExpansionState()),t("rowGroupExpansion",void 0)):(t("rowGroupExpansion",this.getRowGroupExpansionState()),t("ssrmRowGroupExpansion",void 0))},n=()=>t("filter",this.getFilterState()),{gos:i,colFilter:s,selectableFilter:o}=this.beans;this.addManagedEventListeners({filterChanged:n,rowExpansionStateChanged:this.onRowGroupOpenedDebounced,expandOrCollapseAll:r,columnRowGroupChanged:r,rowDataUpdated:()=>{(i.get("groupDefaultExpanded")!==0||i.get("isGroupOpenByDefault"))&&(this.updateRowGroupExpansionStateTimer||(this.updateRowGroupExpansionStateTimer=setTimeout(r)))},selectionChanged:()=>{this.staleStateKeys.add("rowSelection"),this.onRowSelectedDebounced()},paginationChanged:a=>{(a.newPage||a.newPageSize)&&t("pagination",this.getPaginationState())},pinnedRowsChanged:()=>t("rowPinning",this.getRowPinningState())}),s&&this.addManagedListeners(s,{filterStateChanged:n}),o&&this.addManagedListeners(o,{selectedFilterChanged:n})}setFirstDataRenderedState(e,t,r){const{scroll:n,cellSelection:i,focusedCell:s,columnOrder:o}=e,a=(u,h)=>!r?.has(u)&&(h||t==="api");a("focusedCell",s)&&this.setFocusedCellState(s),a("cellSelection",i)&&this.setCellSelectionState(i),a("scroll",n)&&this.setScrollState(n),this.setColumnPivotState(!!o?.orderedColIds,t);const l=this.updateCachedState.bind(this);l("sideBar",this.getSideBarState()),l("focusedCell",this.getFocusedCellState());const c=this.getRangeSelectionState();l("rangeSelection",c),l("cellSelection",c),l("scroll",this.getScrollState())}setupStateOnFirstDataRendered(e){this.setFirstDataRenderedState(e,"gridInitializing");const t=this.updateCachedState.bind(this),r=()=>t("focusedCell",this.getFocusedCellState());this.addManagedEventListeners({cellFocused:r,cellFocusCleared:r,cellSelectionChanged:n=>{if(n.finished){const i=this.getRangeSelectionState();t("rangeSelection",i),t("cellSelection",i)}},bodyScrollEnd:()=>t("scroll",this.getScrollState())})}getColumnState(){const e=this.beans;return Xj(C0(e),e.colModel.isPivotMode())}setColumnState(e,t,r,n){const{sort:i,rowGroup:s,aggregation:o,pivot:a,columnPinning:l,columnVisibility:c,columnSizing:u,columnOrder:h}=e;let d=!1;const f=(K,z)=>{const M=!n?.has(K)&&!!(z||t==="api");return d||(d=M),M},m={},v=K=>{let z=m[K];return z||(z={colId:K},m[K]=z,z)},g={},w=f("sort",i);w&&i?.sortModel.forEach(({colId:K,sort:z},M)=>{const B=v(K);B.sort=z,B.sortIndex=M}),(w||!r)&&(g.sort=null,g.sortIndex=null);const y=f("rowGroup",s);y&&s?.groupColIds.forEach((K,z)=>{const M=v(K);M.rowGroup=!0,M.rowGroupIndex=z}),(y||!r)&&(g.rowGroup=null,g.rowGroupIndex=null);const C=f("aggregation",o);C&&o?.aggregationModel.forEach(({colId:K,aggFunc:z})=>{v(K).aggFunc=z}),(C||!r)&&(g.aggFunc=null);const k=f("pivot",a);k&&(a?.pivotColIds.forEach((K,z)=>{const M=v(K);M.pivot=!0,M.pivotIndex=z}),this.gos.updateGridOptions({options:{pivotMode:!!a?.pivotMode},source:t})),(k||!r)&&(g.pivot=null,g.pivotIndex=null);const F=f("columnPinning",l);if(F){for(const K of l?.leftColIds??[])v(K).pinned="left";for(const K of l?.rightColIds??[])v(K).pinned="right"}(F||!r)&&(g.pinned=null);const I=f("columnVisibility",c);if(I)for(const K of c?.hiddenColIds??[])v(K).hide=!0;(I||!r)&&(g.hide=null);const N=f("columnSizing",u);if(N)for(const{colId:K,flex:z,width:M}of u?.columnSizingModel??[]){const B=v(K);B.flex=z??null,B.width=M}(N||!r)&&(g.flex=null);const j=h?.orderedColIds,L=!!j?.length&&!n?.has("columnOrder"),W=L?j.map(K=>v(K)):Object.values(m);(W.length||d)&&(this.columnStates=W,Ws(this.beans,{state:W,applyOrder:L,defaultState:g},t))}setColumnPivotState(e,t){const r=this.columnStates;this.columnStates=void 0;const n=this.columnGroupStates;this.columnGroupStates=void 0;const i=this.beans,{pivotResultCols:s,colGroupSvc:o}=i;if(s?.isPivotResultColsPresent()){if(r){const a=[];for(const l of r)s.getPivotResultCol(l.colId)&&a.push(l);Ws(i,{state:a,applyOrder:e},t)}n&&o?.setColumnGroupState(n,t)}}getColumnGroupState(){const e=this.beans.colGroupSvc;if(!e)return;const t=e.getColumnGroupState();return Yj(t)}setColumnGroupState(e,t,r){const n=this.beans.colGroupSvc;if(!n||r?.has("columnGroup")||t!=="api"&&!Object.prototype.hasOwnProperty.call(e,"columnGroup"))return;const i=new Set(e.columnGroup?.openColumnGroupIds),o=n.getColumnGroupState().map(({groupId:a})=>{const l=i.has(a);return l&&i.delete(a),{groupId:a,open:l}});for(const a of i)o.push({groupId:a,open:!0});o.length&&(this.columnGroupStates=o),n.setColumnGroupState(o,t)}getFilterState(){const{filterManager:e,selectableFilter:t}=this.beans;let r=e?.getFilterModel();r&&Object.keys(r).length===0&&(r=void 0);const n=e?.getFilterState(),i=e?.getAdvFilterModel()??void 0,s=t?.getState();return r||i||n||s?{filterModel:r,columnFilterState:n,advancedFilterModel:i,selectableFilters:s}:void 0}setFilterState(e){const{filterManager:t,selectableFilter:r}=this.beans,{filterModel:n,columnFilterState:i,advancedFilterModel:s,selectableFilters:o}=e??{filterModel:null,columnFilterState:null,advancedFilterModel:null};o!==void 0&&r?.setState(o??{}),(n!==void 0||i!==void 0)&&t?.setFilterState(n??null,i??null,"columnFilter"),s!==void 0&&t?.setAdvFilterModel(s??null,"advancedFilter")}getRangeSelectionState(){const e=this.beans.rangeSvc?.getCellRanges().map(t=>{const{id:r,type:n,startRow:i,endRow:s,columns:o,startColumn:a}=t;return{id:r,type:n,startRow:i,endRow:s,colIds:o.map(l=>l.getColId()),startColId:a.getColId()}});return e?.length?{cellRanges:e}:void 0}setCellSelectionState(e){const{gos:t,rangeSvc:r,colModel:n,visibleCols:i}=this.beans;if(!ll(t)||!r)return;const s=[];for(const o of e?.cellRanges??[]){const a=[];for(const c of o.colIds){const u=n.getCol(c);u&&a.push(u)}if(!a.length)continue;let l=n.getCol(o.startColId);if(!l){const c=i.allCols,u=new Set(a);l=c.find(h=>u.has(h))}s.push({...o,columns:a,startColumn:l})}r.setCellRanges(s)}getScrollState(){if(!this.isClientSideRowModel)return;const e=this.beans.ctrlsSvc.getScrollFeature(),{left:t}=e?.getHScrollPosition()??{left:0},{top:r}=e?.getVScrollPosition()??{top:0};return r||t?{top:r,left:t}:void 0}setScrollState(e){if(!this.isClientSideRowModel)return;const{top:t,left:r}=e??{top:0,left:0},{frameworkOverrides:n,rowRenderer:i,animationFrameSvc:s,ctrlsSvc:o}=this.beans;n.wrapIncoming(()=>{o.get("center").setCenterViewportScrollLeft(r),o.getScrollFeature()?.setVerticalScrollPosition(t),i.redraw({afterScroll:!0}),s?.flushAllFrames()})}getSideBarState(){return this.beans.sideBar?.comp?.getState()}getFocusedCellState(){if(!this.isClientSideRowModel)return;const e=this.beans.focusSvc.getFocusedCell();if(e){const{column:t,rowIndex:r,rowPinned:n}=e;return{colId:t.getColId(),rowIndex:r,rowPinned:n}}}setFocusedCellState(e){if(!this.isClientSideRowModel)return;const{focusSvc:t,colModel:r}=this.beans;if(!e){t.clearFocusedCell();return}const{colId:n,rowIndex:i,rowPinned:s}=e;t.setFocusedCell({column:r.getCol(n),rowIndex:i,rowPinned:s,forceBrowserFocus:!0,preventScrollOnBrowserFocus:!0})}getPaginationState(){const{pagination:e,gos:t}=this.beans;if(!e)return;const r=e.getCurrentPage(),n=t.get("paginationAutoPageSize")?void 0:e.getPageSize();if(!(!r&&!n))return{page:r,pageSize:n}}setPaginationState(e,t){const{pagination:r,gos:n}=this.beans;if(!r)return;const{pageSize:i,page:s}=e??{page:0,pageSize:n.get("paginationPageSize")},o=t==="gridInitializing";i&&!n.get("paginationAutoPageSize")&&r.setPageSize(i,o?"initialState":"pageSizeSelector"),typeof s=="number"&&(o?r.setPage(s):r.goToPage(s))}getRowSelectionState(){const e=this.beans.selectionSvc;if(!e)return;const t=e.getSelectionState();return!t||!Array.isArray(t)&&(t.selectAll===!1||t.selectAllChildren===!1)&&!t?.toggledNodes?.length?void 0:t}setRowSelectionState(e,t){this.beans.selectionSvc?.setSelectionState(e,t,t==="api")}getRowGroupExpansionState(){const{expansionSvc:e}=this.beans;if(e)return e.getExpansionState()}getRowPinningState(){return this.beans.pinnedRowModel?.getPinnedState()}setRowPinningState(e){const t=this.beans.pinnedRowModel;e?t?.setPinnedState(e):t?.reset()}setRowGroupExpansionState(e,t,r){const n=this.beans.expansionSvc;if(!n)return;const i=t??{expandedRowGroupIds:[],collapsedRowGroupIds:[]};n.setExpansionState(i,r)}updateColumnState(e){const t=this.getColumnState();let r=!1;const n=this.cachedState;for(const i of Object.keys(t)){const s=t[i];of(s,n[i])||(r=!0)}this.cachedState={...n,...t},r&&this.dispatchStateUpdateEvent(e)}updateCachedState(e,t){const r=this.cachedState[e];this.setCachedStateValue(e,t),of(t,r)||this.dispatchStateUpdateEvent([e])}setCachedStateValue(e,t){this.cachedState={...this.cachedState,[e]:t}}refreshStaleState(){const e=this.staleStateKeys;for(const t of e)t==="rowSelection"&&this.setCachedStateValue(t,this.getRowSelectionState());e.clear()}dispatchStateUpdateEvent(e){if(!this.suppressEvents){for(const t of e)this.queuedUpdateSources.add(t);this.dispatchStateUpdateEventDebounced()}}dispatchQueuedStateUpdateEvents(){const e=this.queuedUpdateSources,t=Array.from(e);e.clear(),this.eventSvc.dispatchEvent({type:"stateUpdated",sources:t,state:this.cachedState})}startSuppressEvents(){this.suppressEvents=!0,this.beans.colAnimation?.setSuppressAnimation(!0)}stopSuppressEvents(e){setTimeout(()=>{this.suppressEvents=!1,this.queuedUpdateSources.clear(),this.isAlive()&&(this.beans.colAnimation?.setSuppressAnimation(!1),this.dispatchStateUpdateEvent([e]))})}suppressEventsAndDispatchInitEvent(e){this.startSuppressEvents(),e(),this.stopSuppressEvents("gridInitializing")}},aW={moduleName:"GridState",version:wt,beans:[oW],apiFunctions:{getState:rW,setState:nW}};function lW(e){return e.rowModel.isLastRowIndexKnown()}function cW(e){return e.pagination?.getPageSize()??100}function uW(e){return e.pagination?.getCurrentPage()??0}function dW(e){return e.pagination?.getTotalPages()??1}function hW(e){return e.pagination?e.pagination.getMasterRowCount():e.rowModel.getRowCount()}function fW(e){e.pagination?.goToNextPage()}function pW(e){e.pagination?.goToPreviousPage()}function gW(e){e.pagination?.goToFirstPage()}function mW(e){e.pagination?.goToLastPage()}function vW(e,t){e.pagination?.goToPage(t)}var bW=class extends et{constructor(){super(...arguments),this.beanName="paginationAutoPageSizeSvc"}postConstruct(){this.beans.ctrlsSvc.whenReady(this,e=>{this.centerRowsCtrl=e.center;const t=this.checkPageSize.bind(this);this.addManagedEventListeners({bodyHeightChanged:t,scrollVisibilityChanged:t}),this.addManagedPropertyListener("paginationAutoPageSize",this.onPaginationAutoSizeChanged.bind(this)),this.checkPageSize()})}notActive(){return!this.gos.get("paginationAutoPageSize")||this.centerRowsCtrl==null}onPaginationAutoSizeChanged(){this.notActive()?this.beans.pagination.unsetAutoCalculatedPageSize():this.checkPageSize()}checkPageSize(){if(this.notActive())return;const e=this.centerRowsCtrl.viewportSizeFeature.getBodyHeight();if(e>0){const t=this.beans,r=()=>{const n=Math.max(oc(t),1),i=Math.floor(e/n);t.pagination.setPageSize(i,"autoCalculated")};this.isBodyRendered?zn(this,r,50)():(r(),this.isBodyRendered=!0)}else this.isBodyRendered=!1}},_h="paginationPageSizeSelector",wW={tag:"span",cls:"ag-paging-page-size"},yW=class extends pn{constructor(){super(wW),this.hasEmptyOption=!1,this.handlePageSizeItemSelected=()=>{if(!this.selectPageSizeComp)return;const e=this.selectPageSizeComp.getValue();if(!e)return;const t=Number(e);isNaN(t)||t<1||t===this.pagination.getPageSize()||(this.pagination.setPageSize(t,"pageSizeSelector"),this.hasEmptyOption&&this.toggleSelectDisplay(!0),this.selectPageSizeComp.getFocusableElement().focus())}}wireBeans(e){this.pagination=e.pagination}postConstruct(){this.addManagedPropertyListener(_h,()=>{this.onPageSizeSelectorValuesChange()}),this.addManagedEventListeners({paginationChanged:e=>this.handlePaginationChanged(e)})}handlePaginationChanged(e){if(!this.selectPageSizeComp||!e?.newPageSize)return;const t=this.pagination.getPageSize();this.getPageSizeSelectorValues().includes(t)?this.selectPageSizeComp.setValue(t.toString()):this.hasEmptyOption?this.selectPageSizeComp.setValue(""):this.toggleSelectDisplay(!0)}toggleSelectDisplay(e){this.selectPageSizeComp&&!e&&this.reset(),e&&(this.reloadPageSizesSelector(),this.selectPageSizeComp)}reset(){Hi(this.getGui()),this.selectPageSizeComp&&(this.selectPageSizeComp=this.destroyBean(this.selectPageSizeComp))}onPageSizeSelectorValuesChange(){this.selectPageSizeComp&&this.shouldShowPageSizeSelector()&&this.reloadPageSizesSelector()}shouldShowPageSizeSelector(){return this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel")&&!this.gos.get("paginationAutoPageSize")&&this.gos.get(_h)!==!1}reloadPageSizesSelector(){const e=this.getPageSizeSelectorValues(),t=this.pagination.getPageSize(),r=!t||!e.includes(t);if(r){const i=this.gos.exists("paginationPageSize"),s=this.gos.get(_h)!==!0;at(94,{pageSizeSet:i,pageSizesSet:s,pageSizeOptions:e,paginationPageSizeOption:t}),s||at(95,{paginationPageSizeOption:t,paginationPageSizeSelector:_h}),e.unshift("")}const n=String(r?"":t);this.selectPageSizeComp?(ml(this.pageSizeOptions,e)||(this.selectPageSizeComp.clearOptions().addOptions(this.createPageSizeSelectOptions(e)),this.pageSizeOptions=e),this.selectPageSizeComp.setValue(n,!0)):this.createPageSizeSelectorComp(e,n),this.hasEmptyOption=r}createPageSizeSelectOptions(e){return e.map(t=>({value:String(t)}))}createPageSizeSelectorComp(e,t){const r=this.getLocaleTextFunc(),n=r("pageSizeSelectorLabel","Page Size:"),i=r("ariaPageSizeSelectorLabel","Page Size");this.selectPageSizeComp=this.createManagedBean(new Sy).addOptions(this.createPageSizeSelectOptions(e)).setValue(t).setAriaLabel(i).setLabel(n).onValueChange(()=>this.handlePageSizeItemSelected()),this.appendChild(this.selectPageSizeComp)}getPageSizeSelectorValues(){const e=[20,50,100],t=this.gos.get(_h);return!Array.isArray(t)||!t?.length?e:[...t].sort((r,n)=>r-n)}destroy(){this.toggleSelectDisplay(!1),super.destroy()}},CW={selector:"AG-PAGE-SIZE-SELECTOR",component:yW},xW=".ag-paging-panel{align-items:center;border-top:var(--ag-footer-row-border);display:flex;gap:calc(var(--ag-spacing)*4);height:var(--ag-pagination-panel-height);justify-content:flex-end;padding:0 var(--ag-cell-horizontal-padding)}:where(.ag-paging-page-size) .ag-wrapper{min-width:50px}.ag-paging-page-summary-panel{align-items:center;display:flex;gap:var(--ag-cell-widget-spacing);.ag-disabled &{pointer-events:none}}.ag-paging-button{cursor:pointer;position:relative;&.ag-disabled{cursor:default;opacity:.5}}.ag-paging-number,.ag-paging-row-summary-panel-number{font-weight:500}",SW=class extends wO{constructor(){super(),this.btFirst=xt,this.btPrevious=xt,this.btNext=xt,this.btLast=xt,this.lbRecordCount=xt,this.lbFirstRowOnPage=xt,this.lbLastRowOnPage=xt,this.lbCurrent=xt,this.lbTotal=xt,this.pageSizeComp=xt,this.previousAndFirstButtonsDisabled=!1,this.nextButtonDisabled=!1,this.lastButtonDisabled=!1,this.areListenersSetup=!1,this.allowFocusInnerElement=!1,this.registerCSS(xW)}wireBeans(e){this.rowModel=e.rowModel,this.pagination=e.pagination,this.ariaAnnounce=e.ariaAnnounce}postConstruct(){const e=this.gos.get("enableRtl");this.setTemplate(this.getTemplate(),[CW]);const{btFirst:t,btPrevious:r,btNext:n,btLast:i}=this;this.activateTabIndex([t,r,n,i]),t.insertAdjacentElement("afterbegin",Li(e?"last":"first",this.beans)),r.insertAdjacentElement("afterbegin",Li(e?"next":"previous",this.beans)),n.insertAdjacentElement("afterbegin",Li(e?"previous":"next",this.beans)),i.insertAdjacentElement("afterbegin",Li(e?"first":"last",this.beans)),this.addManagedPropertyListener("pagination",this.onPaginationChanged.bind(this)),this.addManagedPropertyListener("suppressPaginationPanel",this.onPaginationChanged.bind(this)),this.addManagedPropertyListeners(["paginationPageSizeSelector","paginationAutoPageSize","suppressPaginationPanel"],()=>this.onPageSizeRelatedOptionsChange()),this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector()),this.initialiseTabGuard({onTabKeyDown:()=>{},focusInnerElement:s=>this.allowFocusInnerElement?this.tabGuardFeature.getTabGuardCtrl().focusInnerElement(s):DI(this.beans,s),forceFocusOutWhenTabGuardsAreEmpty:!0}),this.onPaginationChanged()}setAllowFocus(e){this.allowFocusInnerElement=e}onPaginationChanged(){const t=this.gos.get("pagination")&&!this.gos.get("suppressPaginationPanel");this.setDisplayed(t),t&&(this.setupListeners(),this.enableOrDisableButtons(),this.updateLabels(),this.onPageSizeRelatedOptionsChange())}onPageSizeRelatedOptionsChange(){this.pageSizeComp.toggleSelectDisplay(this.pageSizeComp.shouldShowPageSizeSelector())}setupListeners(){if(!this.areListenersSetup){this.addManagedEventListeners({paginationChanged:this.onPaginationChanged.bind(this)});for(const e of[{el:this.btFirst,fn:this.onBtFirst.bind(this)},{el:this.btPrevious,fn:this.onBtPrevious.bind(this)},{el:this.btNext,fn:this.onBtNext.bind(this)},{el:this.btLast,fn:this.onBtLast.bind(this)}]){const{el:t,fn:r}=e;this.addManagedListeners(t,{click:r,keydown:n=>{(n.key===$e.ENTER||n.key===$e.SPACE)&&(n.preventDefault(),r())}})}MI(this.beans,this,this.getGui()),this.areListenersSetup=!0}}onBtFirst(){this.previousAndFirstButtonsDisabled||this.pagination.goToFirstPage()}formatNumber(e){const t=this.gos.getCallback("paginationNumberFormatter");return t?t({value:e}):Jj(e,this.getLocaleTextFunc.bind(this))}getTemplate(){const e=this.getLocaleTextFunc(),t=`ag-${this.getCompId()}`;return{tag:"div",cls:"ag-paging-panel ag-unselectable",attrs:{id:`${t}`},children:[{tag:"ag-page-size-selector",ref:"pageSizeComp"},{tag:"span",cls:"ag-paging-row-summary-panel",children:[{tag:"span",ref:"lbFirstRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-first-row`}},{tag:"span",attrs:{id:`${t}-to`},children:e("to","to")},{tag:"span",ref:"lbLastRowOnPage",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-last-row`}},{tag:"span",attrs:{id:`${t}-of`},children:e("of","of")},{tag:"span",ref:"lbRecordCount",cls:"ag-paging-row-summary-panel-number",attrs:{id:`${t}-row-count`}}]},{tag:"span",cls:"ag-paging-page-summary-panel",role:"presentation",children:[{tag:"div",ref:"btFirst",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("firstPage","First Page")}},{tag:"div",ref:"btPrevious",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("previousPage","Previous Page")}},{tag:"span",cls:"ag-paging-description",children:[{tag:"span",attrs:{id:`${t}-start-page`},children:e("page","Page")},{tag:"span",ref:"lbCurrent",cls:"ag-paging-number",attrs:{id:`${t}-start-page-number`}},{tag:"span",attrs:{id:`${t}-of-page`},children:e("of","of")},{tag:"span",ref:"lbTotal",cls:"ag-paging-number",attrs:{id:`${t}-of-page-number`}}]},{tag:"div",ref:"btNext",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("nextPage","Next Page")}},{tag:"div",ref:"btLast",cls:"ag-button ag-paging-button",role:"button",attrs:{"aria-label":e("lastPage","Last Page")}}]}]}}onBtNext(){this.nextButtonDisabled||this.pagination.goToNextPage()}onBtPrevious(){this.previousAndFirstButtonsDisabled||this.pagination.goToPreviousPage()}onBtLast(){this.lastButtonDisabled||this.pagination.goToLastPage()}enableOrDisableButtons(){const e=this.pagination.getCurrentPage(),t=this.rowModel.isLastRowIndexKnown(),r=this.pagination.getTotalPages();this.previousAndFirstButtonsDisabled=e===0,this.toggleButtonDisabled(this.btFirst,this.previousAndFirstButtonsDisabled),this.toggleButtonDisabled(this.btPrevious,this.previousAndFirstButtonsDisabled);const n=this.isZeroPagesToDisplay(),i=e===r-1;this.nextButtonDisabled=i||n,this.lastButtonDisabled=!t||n||e===r-1,this.toggleButtonDisabled(this.btNext,this.nextButtonDisabled),this.toggleButtonDisabled(this.btLast,this.lastButtonDisabled)}toggleButtonDisabled(e,t){BM(e,t),e.classList.toggle("ag-disabled",t)}isZeroPagesToDisplay(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages();return e&&t===0}updateLabels(){const e=this.rowModel.isLastRowIndexKnown(),t=this.pagination.getTotalPages(),r=this.pagination.getMasterRowCount(),n=e?r:null,i=this.pagination.getCurrentPage(),s=this.pagination.getPageSize();let o,a;this.isZeroPagesToDisplay()?o=a=0:(o=s*i+1,a=o+s-1,e&&a>n&&(a=n));const l=o+s-1,c=!e&&r<l,u=this.formatNumber(o);this.lbFirstRowOnPage.textContent=u;let h;const d=this.getLocaleTextFunc();c?h=d("pageLastRowUnknown","?"):h=this.formatNumber(a),this.lbLastRowOnPage.textContent=h;const m=t>0?i+1:0,v=this.formatNumber(m);this.lbCurrent.textContent=v;let g,w;if(e)g=this.formatNumber(t),w=this.formatNumber(n);else{const y=d("more","more");g=y,w=y}this.lbTotal.textContent=g,this.lbRecordCount.textContent=w,this.announceAriaStatus(u,h,w,v,g)}announceAriaStatus(e,t,r,n,i){const s=this.getLocaleTextFunc(),o=s("page","Page"),a=s("to","to"),l=s("of","of"),c=`${e} ${a} ${t} ${l} ${r}`,u=`${o} ${n} ${l} ${i}`;c!==this.ariaRowStatus&&(this.ariaRowStatus=c,this.ariaAnnounce?.announceValue(c,"paginationRow")),u!==this.ariaPageStatus&&(this.ariaPageStatus=u,this.ariaAnnounce?.announceValue(u,"paginationPage"))}},_W={selector:"AG-PAGINATION",component:SW},EW=class extends et{constructor(){super(...arguments),this.beanName="pagination",this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=0,this.masterRowCount=0}postConstruct(){const e=this.gos;this.active=e.get("pagination"),this.pageSizeFromGridOptions=e.get("paginationPageSize"),this.paginateChildRows=this.isPaginateChildRows(),this.addManagedPropertyListener("pagination",this.onPaginationGridOptionChanged.bind(this)),this.addManagedPropertyListener("paginationPageSize",this.onPageSizeGridOptionChanged.bind(this))}getPaginationSelector(){return _W}isPaginateChildRows(){const e=this.gos;return e.get("groupHideParentOfSingleChild")||e.get("groupRemoveSingleChildren")||e.get("groupRemoveLowestSingleChildren")?!0:e.get("paginateChildRows")}onPaginationGridOptionChanged(){this.active=this.gos.get("pagination"),this.calculatePages(),this.dispatchPaginationChangedEvent({keepRenderedRows:!0})}onPageSizeGridOptionChanged(){this.setPageSize(this.gos.get("paginationPageSize"),"gridOptions")}goToPage(e){const t=this.currentPage;if(!this.active||t===e||typeof t!="number")return;const{editSvc:r}=this.beans;r?.isEditing()&&(r.isBatchEditing()?r.cleanupEditors():r.stopEditing(void 0,{source:"api"})),this.currentPage=e,this.calculatePages(),this.dispatchPaginationChangedEvent({newPage:!0})}goToPageWithIndex(e){if(!this.active)return;let t=e;this.paginateChildRows||(t=this.beans.rowModel.getTopLevelIndexFromDisplayedIndex?.(e)??e),this.goToPage(Math.floor(t/this.pageSize))}isRowInPage(e){return this.active?e>=this.topDisplayedRowIndex&&e<=this.bottomDisplayedRowIndex:!0}getCurrentPage(){return this.currentPage}goToNextPage(){this.goToPage(this.currentPage+1)}goToPreviousPage(){this.goToPage(this.currentPage-1)}goToFirstPage(){this.goToPage(0)}goToLastPage(){const e=this.beans.rowModel.getRowCount(),t=Math.floor(e/this.pageSize);this.goToPage(t)}getPageSize(){return this.pageSize}getTotalPages(){return this.totalPages}setPage(e){this.currentPage=e}get pageSize(){return bt(this.pageSizeAutoCalculated)&&this.gos.get("paginationAutoPageSize")?this.pageSizeAutoCalculated:bt(this.pageSizeFromPageSizeSelector)?this.pageSizeFromPageSizeSelector:bt(this.pageSizeFromInitialState)?this.pageSizeFromInitialState:bt(this.pageSizeFromGridOptions)?this.pageSizeFromGridOptions:this.defaultPageSize}calculatePages(){this.active?this.paginateChildRows?this.calculatePagesAllRows():this.calculatePagesMasterRowsOnly():this.calculatedPagesNotActive(),this.beans.pageBounds.calculateBounds(this.topDisplayedRowIndex,this.bottomDisplayedRowIndex)}unsetAutoCalculatedPageSize(){if(this.pageSizeAutoCalculated===void 0)return;const e=this.pageSizeAutoCalculated;this.pageSizeAutoCalculated=void 0,this.pageSize!==e&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0}))}setPageSize(e,t){const r=this.pageSize;switch(t){case"autoCalculated":this.pageSizeAutoCalculated=e;break;case"pageSizeSelector":this.pageSizeFromPageSizeSelector=e,this.currentPage!==0&&this.goToFirstPage();break;case"initialState":this.pageSizeFromInitialState=e;break;case"gridOptions":this.pageSizeFromGridOptions=e,this.pageSizeFromInitialState=void 0,this.pageSizeFromPageSizeSelector=void 0,this.currentPage!==0&&this.goToFirstPage();break}r!==this.pageSize&&(this.calculatePages(),this.dispatchPaginationChangedEvent({newPageSize:!0,keepRenderedRows:!0}))}setZeroRows(){this.masterRowCount=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=-1,this.currentPage=0,this.totalPages=0}adjustCurrentPageIfInvalid(){const e=this.totalPages;this.currentPage>=e&&(this.currentPage=e-1);const t=this.currentPage;(!isFinite(t)||isNaN(t)||t<0)&&(this.currentPage=0)}calculatePagesMasterRowsOnly(){const e=this.beans.rowModel,t=e.getTopLevelRowCount();if(this.masterRowCount=t,t<=0){this.setZeroRows();return}const r=this.pageSize,n=t-1;this.totalPages=Math.floor(n/r)+1,this.adjustCurrentPageIfInvalid();const i=this.currentPage,s=r*i;let o=r*(i+1)-1;if(o>n&&(o=n),this.topDisplayedRowIndex=e.getTopLevelRowDisplayedIndex(s),o===n)this.bottomDisplayedRowIndex=e.getRowCount()-1;else{const a=e.getTopLevelRowDisplayedIndex(o+1);this.bottomDisplayedRowIndex=a-1}}getMasterRowCount(){return this.masterRowCount}calculatePagesAllRows(){const e=this.beans.rowModel.getRowCount();if(this.masterRowCount=e,e===0){this.setZeroRows();return}const{pageSize:t,currentPage:r}=this,n=e-1;this.totalPages=Math.floor(n/t)+1,this.adjustCurrentPageIfInvalid(),this.topDisplayedRowIndex=t*r,this.bottomDisplayedRowIndex=t*(r+1)-1,this.bottomDisplayedRowIndex>n&&(this.bottomDisplayedRowIndex=n)}calculatedPagesNotActive(){this.setPageSize(void 0,"autoCalculated"),this.totalPages=1,this.currentPage=0,this.topDisplayedRowIndex=0,this.bottomDisplayedRowIndex=this.beans.rowModel.getRowCount()-1}dispatchPaginationChangedEvent(e){const{keepRenderedRows:t=!1,newPage:r=!1,newPageSize:n=!1}=e;this.eventSvc.dispatchEvent({type:"paginationChanged",animate:!1,newData:!1,newPage:r,newPageSize:n,keepRenderedRows:t})}},TW={moduleName:"Pagination",version:wt,beans:[EW,bW],icons:{first:"first",previous:"previous",next:"next",last:"last"},apiFunctions:{paginationIsLastPageFound:lW,paginationGetPageSize:cW,paginationGetCurrentPage:uW,paginationGetTotalPages:dW,paginationGetRowCount:hW,paginationGoToNextPage:fW,paginationGoToPreviousPage:pW,paginationGoToFirstPage:gW,paginationGoToLastPage:mW,paginationGoToPage:vW},dependsOn:[hm]};function kW(e,t={}){const r=t?t.rowNodes:void 0;e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.redrawRows(r))}function p6(e,t,r,n,i){t&&(n&&t.parent&&t.parent.level!==-1&&p6(e,t.parent,r,n,i),t.setExpanded(r,void 0,i))}function RW(e,t){return e.rowModel.getRowNode(t)}function AW(e,t,r,n){e.rowRenderer.addRenderedRowListener(t,r,n)}function FW(e){return e.rowRenderer.getRenderedNodes()}function MW(e,t,r){e.rowModel.forEachNode(t,r)}function DW(e){return e.rowRenderer.firstRenderedRow}function PW(e){return e.rowRenderer.lastRenderedRow}function IW(e,t){return e.rowModel.getRow(t)}function OW(e){return e.rowModel.getRowCount()}var NW={moduleName:"RowApi",version:wt,apiFunctions:{redrawRows:kW,setRowNodeExpanded:p6,getRowNode:RW,addRenderedRowListener:AW,getRenderedNodes:FW,forEachNode:MW,getFirstDisplayedRowIndex:DW,getLastDisplayedRowIndex:PW,getDisplayedRowAtIndex:IW,getDisplayedRowCount:OW}},LW={moduleName:"ScrollApi",version:wt,apiFunctions:{getVerticalPixelRange:$G,getHorizontalPixelRange:qG,ensureColumnVisible:e6,ensureIndexVisible:t6,ensureNodeVisible:KG}};function BW(e,t,r){if(!t)return;const n=e.ctrlsSvc.getGridBodyCtrl().eGridBody,i=`aria-${t}`;r===null?n.removeAttribute(i):n.setAttribute(i,r)}function HW(e,t={}){e.frameworkOverrides.wrapIncoming(()=>e.rowRenderer.refreshCells(t))}function jW(e){e.frameworkOverrides.wrapIncoming(()=>{for(const t of e.ctrlsSvc.getHeaderRowContainerCtrls())t.refresh()})}function VW(e){return e.animationFrameSvc?.isQueueEmpty()??!0}function GW(e){e.animationFrameSvc?.flushAllFrames()}function zW(e){return{rowHeight:oc(e),headerHeight:Wf(e)}}function UW(e,t={}){const r=[];for(const s of e.rowRenderer.getCellCtrls(t.rowNodes,t.columns)){const o=s.getCellRenderer();o!=null&&r.push(ff(o))}if(t.columns?.length)return r;const n=[],i=xw(t.rowNodes);for(const s of e.rowRenderer.getAllRowCtrls()){if(i&&!Sw(s.rowNode,i)||!s.isFullWidth())continue;const o=s.getFullWidthCellRenderers();for(let a=0;a<o.length;a++){const l=o[a];l!=null&&n.push(ff(l))}}return[...n,...r]}var WW={moduleName:"RenderApi",version:wt,apiFunctions:{setGridAriaProperty:BW,refreshCells:HW,refreshHeader:jW,isAnimationFrameQueueEmpty:VW,flushAllAnimationFrames:GW,getSizesForCurrentTheme:zW,getCellRendererInstances:UW}},$W=":where(.ag-ltr) :where(.ag-animate-autosize){.ag-cell,.ag-header-cell,.ag-header-group-cell{transition:width .2s ease-in-out,left .2s ease-in-out}}:where(.ag-rtl) :where(.ag-animate-autosize){.ag-cell,.ag-header-cell,.ag-header-group-cell{transition:width .2s ease-in-out,right .2s ease-in-out}}";function qW(e,t){typeof t=="number"?e.colAutosize?.sizeColumnsToFit(t,"api"):e.colAutosize?.sizeColumnsToFitGridBody(t)}function g6({colAutosize:e,visibleCols:t},r,n){Array.isArray(r)?e?.autoSizeCols({colKeys:r,skipHeader:n,source:"api"}):e?.autoSizeCols({...r,colKeys:r.colIds??t.allCols,source:"api"})}function KW(e,t){t&&typeof t=="object"?g6(e,t):e.colAutosize?.autoSizeAllColumns({source:"api",skipHeader:t})}var XW=class extends et{constructor(){super(...arguments),this.beanName="colAutosize",this.timesDelayed=0,this.shouldQueueResizeOperations=!1,this.resizeOperationQueue=[]}postConstruct(){const{gos:e}=this,t=e.get("autoSizeStrategy");if(t){let r=!1;const n=t.type;if(n==="fitGridWidth"||n==="fitProvidedWidth")r=!0;else if(n==="fitCellContents"){this.addManagedEventListeners({firstDataRendered:()=>this.onFirstDataRendered(t)});const i=e.get("rowData");r=i!=null&&i.length>0&&rn(e)}r&&this.beans.colDelayRenderSvc?.hideColumns(n)}}autoSizeCols(e){const{eventSvc:t,visibleCols:r,colModel:n}=this.beans;Eh(this.beans,!0),this.innerAutoSizeCols(e).then(i=>{const s=u=>cd(t,Array.from(u),!0,"autosizeColumns");if(!e.scaleUpToFitGridWidth)return Eh(this.beans,!1),s(i);const o=a3(this.beans),a=u=>r.leftCols.some(h=>zh(h,u)),l=u=>r.rightCols.some(h=>zh(h,u)),c=e.colKeys.filter(u=>!n.getCol(u)?.getColDef().suppressAutoSize&&!ta(u)&&!a(u)&&!l(u));this.sizeColumnsToFit(o,e.source,!0,{defaultMaxWidth:e.defaultMaxWidth,defaultMinWidth:e.defaultMinWidth,columnLimits:e.columnLimits?.map(u=>({...u,key:u.colId})),colKeys:c,onlyScaleUp:!0,animate:!1}),Eh(this.beans,!1),s(i)})}innerAutoSizeCols(e){return new Promise((t,r)=>{if(this.shouldQueueResizeOperations)return this.pushResizeOperation(()=>this.innerAutoSizeCols(e).then(t,r));const{colKeys:n,skipHeader:i,skipHeaderGroups:s,stopAtGroup:o,defaultMaxWidth:a,defaultMinWidth:l,columnLimits:c=[],source:u="api"}=e,{animationFrameSvc:h,renderStatus:d,colModel:f,autoWidthCalc:m,visibleCols:v}=this.beans;if(h?.flushAllFrames(),this.timesDelayed<5&&d&&(!d.areHeaderCellsRendered()||!d.areCellsRendered())){this.timesDelayed++,setTimeout(()=>{this.isAlive()&&this.innerAutoSizeCols(e).then(t,r)});return}this.timesDelayed=0;const g=new Set;let w=-1;const y=Object.fromEntries(c.map(({colId:F,...I})=>[F,I])),C=i??this.gos.get("skipHeaderOnAutoSize"),k=s??C;for(;w!==0;){w=0;const F=[];for(const I of n){if(!I||QD(I))continue;const N=f.getCol(I);if(!N||g.has(N)||N.getColDef().suppressAutoSize)continue;const j=m.getPreferredWidthForColumn(N,C);if(j>0){const L=y[N.colId]??{};L.minWidth??(L.minWidth=l),L.maxWidth??(L.maxWidth=a);const W=YW(N,j,L);N.setActualWidth(W,u),g.add(N),w++}F.push(N)}F.length&&v.refresh(u)}k||this.autoSizeColumnGroupsByColumns(n,u,o),t(g)})}autoSizeColumn(e,t,r){this.autoSizeCols({colKeys:[e],skipHeader:r,skipHeaderGroups:!0,source:t})}autoSizeColumnGroupsByColumns(e,t,r){const{colModel:n,ctrlsSvc:i}=this.beans,s=new Set,o=n.getColsForKeys(e);for(const l of o){let c=l.getParent();for(;c&&c!=r;)c.isPadding()||s.add(c),c=c.getParent()}let a;for(const l of s){for(const c of i.getHeaderRowContainerCtrls())if(a=c.getHeaderCtrlForColumn(l),a)break;a?.resizeLeafColumnsToFit(t)}}autoSizeAllColumns(e){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.autoSizeAllColumns(e));return}this.autoSizeCols({colKeys:this.beans.visibleCols.allCols,...e})}addColumnAutosizeListeners(e,t){const r=this.gos.get("skipHeaderOnAutoSize"),n=()=>{this.autoSizeColumn(t,"uiColumnResized",r)};e.addEventListener("dblclick",n);const i=new $l(e);return i.addEventListener("doubleTap",n),()=>{e.removeEventListener("dblclick",n),i.destroy()}}addColumnGroupResize(e,t,r){const n=this.gos.get("skipHeaderOnAutoSize"),i=()=>{const s=[],o=t.getDisplayedLeafColumns();for(const a of o)a.getColDef().suppressAutoSize||s.push(a.getColId());s.length>0&&this.autoSizeCols({colKeys:s,skipHeader:n,stopAtGroup:t,source:"uiColumnResized"}),r()};return e.addEventListener("dblclick",i),()=>e.removeEventListener("dblclick",i)}sizeColumnsToFitGridBody(e,t){if(!this.isAlive())return;const r=a3(this.beans);if(r>0){this.sizeColumnsToFit(r,"sizeColumnsToFit",!1,e);return}t===void 0?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,100)},0):t===100?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,500)},100):t===500?window.setTimeout(()=>{this.sizeColumnsToFitGridBody(e,-1)},500):at(29)}sizeColumnsToFit(e,t="sizeColumnsToFit",r,n){if(this.shouldQueueResizeOperations){this.pushResizeOperation(()=>this.sizeColumnsToFit(e,t,r,n));return}const{beans:i}=this,s=n?.animate??!0;s&&Eh(i,!0);const o={};for(const{key:g,...w}of n?.columnLimits??[])o[typeof g=="string"?g:g.getColId()]=w;const a=i.visibleCols.allCols;if(e<=0||!a.length)return;const l=Yo(a);if(n?.onlyScaleUp&&l>e||e===l&&a.every(w=>{if(w.colDef.suppressSizeToFit)return!0;const y=o?.[w.getId()],C=y?.minWidth??n?.defaultMinWidth,k=y?.maxWidth??n?.defaultMaxWidth,F=w.getActualWidth();return(C==null||F>=C)&&(k==null||F<=k)}))return;const u=[],h=[];for(const g of a){const w=n?.colKeys?.some(y=>zh(g,y))??!0;g.getColDef().suppressSizeToFit||!w?h.push(g):u.push(g)}const d=u.slice(0);let f=!1;const m=g=>{Eo(u,g),h.push(g)};for(const g of u){g.resetActualWidth(t);const w=o?.[g.getId()],y=w?.minWidth??n?.defaultMinWidth,C=w?.maxWidth??n?.defaultMaxWidth,k=g.getActualWidth();typeof y=="number"&&k<y?g.setActualWidth(y,t,!0):typeof C=="number"&&k>C&&g.setActualWidth(C,t,!0)}for(;!f;){f=!0;const g=e-Yo(h);if(g<=0)for(const w of u){const y=o?.[w.getId()]?.minWidth??n?.defaultMinWidth??w.minWidth;w.setActualWidth(y,t,!0)}else{const w=g/Yo(u);let y=g;for(let C=u.length-1;C>=0;C--){const k=u[C],F=o?.[k.getId()],I=F?.minWidth??n?.defaultMinWidth,N=F?.maxWidth??n?.defaultMaxWidth,j=k.getMinWidth(),L=k.getMaxWidth(),W=typeof I=="number"&&I>j?I:j,K=typeof N=="number"&&N<L?N:L;let z=Math.round(k.getActualWidth()*w);z<W?(z=W,m(k),f=!1):z>K?(z=K,m(k),f=!1):C===0&&(z=y),k.setActualWidth(z,t,!0),y-=z}}}for(const g of d)g.fireColumnWidthChangedEvent(t);const v=i.visibleCols;v.setLeftValues(t),v.updateBodyWidths(),!r&&(cd(this.eventSvc,d,!0,t),s&&Eh(i,!1))}applyAutosizeStrategy(){const{gos:e,colDelayRenderSvc:t}=this.beans,r=e.get("autoSizeStrategy");r?.type!=="fitGridWidth"&&r?.type!=="fitProvidedWidth"||setTimeout(()=>{if(!this.isAlive())return;const n=r.type;if(n==="fitGridWidth"){const{columnLimits:i,defaultMinWidth:s,defaultMaxWidth:o}=r,a=i?.map(({colId:l,minWidth:c,maxWidth:u})=>({key:l,minWidth:c,maxWidth:u}));this.sizeColumnsToFitGridBody({defaultMinWidth:s,defaultMaxWidth:o,columnLimits:a})}else n==="fitProvidedWidth"&&this.sizeColumnsToFit(r.width,"sizeColumnsToFit");t?.revealColumns(n)})}onFirstDataRendered({colIds:e,...t}){setTimeout(()=>{if(!this.isAlive())return;const r="autosizeColumns";e?this.autoSizeCols({...t,source:r,colKeys:e}):this.autoSizeAllColumns({...t,source:r}),this.beans.colDelayRenderSvc?.revealColumns(t.type)})}processResizeOperations(){this.shouldQueueResizeOperations=!1;for(const e of this.resizeOperationQueue)e();this.resizeOperationQueue=[]}pushResizeOperation(e){this.resizeOperationQueue.push(e)}destroy(){this.resizeOperationQueue.length=0,super.destroy()}};function YW(e,t,r={}){const n=r.minWidth??e.getMinWidth();t<n&&(t=n);const i=r.maxWidth??e.getMaxWidth();return t>i&&(t=i),t}function a3({ctrlsSvc:e,scrollVisibleSvc:t}){const r=e.getGridBodyCtrl(),i=r.isVerticalScrollShowing()?t.getScrollbarWidth():0;return cf(r.eGridBody)-i}var l3="ag-animate-autosize";function Eh({ctrlsSvc:e,gos:t},r){if(!t.get("animateColumnResizing")||t.get("enableRtl")||!e.isAlive())return;const n=e.getGridBodyCtrl().eGridBody.classList;r?n.add(l3):n.remove(l3)}var ZW={moduleName:"ColumnAutoSize",version:wt,beans:[XW],apiFunctions:{sizeColumnsToFit:qW,autoSizeColumns:g6,autoSizeAllColumns:KW},dependsOn:[vR],css:[$W]},JW=".ag-row-pinned-source{background-color:var(--ag-pinned-source-row-background-color);color:var(--ag-pinned-source-row-text-color);font-weight:var(--ag-pinned-source-row-font-weight)}.ag-row-pinned-manual{background-color:var(--ag-pinned-row-background-color);color:var(--ag-pinned-row-text-color);font-weight:var(--ag-pinned-row-font-weight)}";function QW(e){return e.pinnedRowModel?.getPinnedTopRowCount()??0}function e$(e){return e.pinnedRowModel?.getPinnedBottomRowCount()??0}function t$(e,t){return e.pinnedRowModel?.getPinnedTopRow(t)}function r$(e,t){return e.pinnedRowModel?.getPinnedBottomRow(t)}function n$(e,t,r){return e.pinnedRowModel?.forEachPinnedRow(t,r)}var i$={moduleName:"PinnedRow",version:wt,beans:[hO],css:[JW],apiFunctions:{getPinnedTopRowCount:QW,getPinnedBottomRowCount:e$,getPinnedTopRow:t$,getPinnedBottomRow:r$,forEachPinnedRow:n$},icons:{rowPin:"pin",rowPinTop:"pinned-top",rowPinBottom:"pinned-bottom",rowUnpin:"un-pin"}},s$=class{constructor(e,t){this.col=e,this.firstNode=t,this.cellSpan=!0,this.spannedNodes=new Set,this.addSpannedNode(t)}reset(){this.spannedNodes.clear(),this.addSpannedNode(this.firstNode)}addSpannedNode(e){this.spannedNodes.add(e),this.lastNode=e}getLastNode(){return this.lastNode}getCellHeight(){return this.lastNode.rowTop+this.lastNode.rowHeight-this.firstNode.rowTop-1}doesSpanContain(e){return e.column!==this.col||e.rowPinned!=this.firstNode.rowPinned?!1:this.firstNode.rowIndex<=e.rowIndex&&e.rowIndex<=this.lastNode.rowIndex}getLastNodeAutoHeight(){const e=this.firstNode.__autoHeights?.[this.col.getColId()];if(e==null)return;let t=0;for(const r of this.spannedNodes)r!==this.lastNode&&(t+=r.rowHeight);return e-t}},o$=class extends et{constructor(e){super(),this.column=e}buildCache(e){const{column:t,beans:{gos:r,pinnedRowModel:n,rowModel:i,valueSvc:s,pagination:o}}=this,{colDef:a}=t,l=this.getNodeMap(e),c=new Map,u=r.getCallback("isFullWidthRow"),h=a.equals,d=a.spanRows,f=typeof d=="function";let m=null,v=null,g;const w=(C,k)=>{m=C,v=null,g=k},y=C=>{const k=!C.isExpandable()&&!C.group&&!C.detail&&(u?!u({rowNode:C}):!0);if(C.rowIndex==null||!k){w(null,null);return}if(m==null||C.level!==m.level||C.footer||v&&C.rowIndex-1!==v?.getLastNode().rowIndex){w(C,s.getValue(t,C));return}const F=s.getValue(t,C);if(f){const I=Dt(r,{valueA:g,nodeA:m,valueB:F,nodeB:C,column:t,colDef:a});if(!d(I)){w(C,F);return}}else if(h?!h(g,F):g!==F){w(C,F);return}if(!v){const I=l?.get(m);I?.firstNode===m?(I.reset(),v=I):v=new s$(t,m),c.set(m,v)}v.addSpannedNode(C),c.set(C,v)};switch(e){case"center":i.forEachDisplayedNode?.(C=>{(!o||o.isRowInPage(C.rowIndex))&&y(C)}),this.centerValueNodeMap=c;break;case"top":n?.forEachPinnedRow("top",y),this.topValueNodeMap=c;break;case"bottom":n?.forEachPinnedRow("bottom",y),this.bottomValueNodeMap=c;break}}isCellSpanning(e){return!!this.getCellSpan(e)}getCellSpan(e){return this.getNodeMap(e.rowPinned).get(e)}getNodeMap(e){switch(e){case"top":return this.topValueNodeMap;case"bottom":return this.bottomValueNodeMap;default:return this.centerValueNodeMap}}},a$=class extends et{constructor(){super(...arguments),this.beanName="rowSpanSvc",this.spanningColumns=new Map,this.debouncePinnedEvent=zn(this,this.dispatchCellsUpdatedEvent.bind(this,!0),0),this.debounceModelEvent=zn(this,this.dispatchCellsUpdatedEvent.bind(this,!1),0),this.pinnedTimeout=null,this.modelTimeout=null}postConstruct(){const e=this.onRowDataUpdated.bind(this),t=this.buildPinnedCaches.bind(this);this.addManagedEventListeners({paginationChanged:this.buildModelCaches.bind(this),pinnedRowDataChanged:t,pinnedRowsChanged:t,rowNodeDataChanged:e,cellValueChanged:e})}register(e){const{gos:t}=this.beans;if(!t.get("enableCellSpan")||this.spanningColumns.has(e))return;const r=this.createManagedBean(new o$(e));this.spanningColumns.set(e,r),r.buildCache("top"),r.buildCache("bottom"),r.buildCache("center"),this.debouncePinnedEvent(),this.debounceModelEvent()}dispatchCellsUpdatedEvent(e){this.dispatchLocalEvent({type:"spannedCellsUpdated",pinned:e})}deregister(e){this.spanningColumns.delete(e)}onRowDataUpdated({node:e}){const{spannedRowRenderer:t}=this.beans;if(e.rowPinned){if(this.pinnedTimeout!=null)return;this.pinnedTimeout=window.setTimeout(()=>{this.pinnedTimeout=null,this.buildPinnedCaches(),t?.createCtrls("top"),t?.createCtrls("bottom")},0);return}this.modelTimeout==null&&(this.modelTimeout=window.setTimeout(()=>{this.modelTimeout=null,this.buildModelCaches(),t?.createCtrls("center")},0))}buildModelCaches(){this.modelTimeout!=null&&clearTimeout(this.modelTimeout),this.spanningColumns.forEach(e=>e.buildCache("center")),this.debounceModelEvent()}buildPinnedCaches(){this.pinnedTimeout!=null&&clearTimeout(this.pinnedTimeout),this.spanningColumns.forEach(e=>{e.buildCache("top"),e.buildCache("bottom")}),this.debouncePinnedEvent()}isCellSpanning(e,t){const r=this.spanningColumns.get(e);return r?r.isCellSpanning(t):!1}getCellSpanByPosition(e){const{pinnedRowModel:t,rowModel:r}=this.beans,n=e.column,i=e.rowIndex,s=this.spanningColumns.get(n);if(!s)return;let o;switch(e.rowPinned){case"top":o=t?.getPinnedTopRow(i);break;case"bottom":o=t?.getPinnedBottomRow(i);break;default:o=r.getRow(i)}if(o)return s.getCellSpan(o)}getCellStart(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.firstNode.rowIndex}:e}getCellEnd(e){const t=this.getCellSpanByPosition(e);return t?{...e,rowIndex:t.getLastNode().rowIndex}:e}getCellSpan(e,t){const r=this.spanningColumns.get(e);if(r)return r.getCellSpan(t)}forEachSpannedColumn(e,t){for(const[r,n]of this.spanningColumns)if(n.isCellSpanning(e)){const i=n.getCellSpan(e);t(r,i)}}destroy(){super.destroy(),this.spanningColumns.clear()}},l$=class extends ed{constructor(e,t,r){super(e.col,e.firstNode,r,t),this.cellSpan=e,this.SPANNED_CELL_CSS_CLASS="ag-spanned-cell"}setComp(e,t,r,n,i,s,o){this.eWrapper=r,super.setComp(e,t,r,n,i,s,o),this.setAriaRowSpan(),this.refreshAriaRowIndex()}isCellSpanning(){return!0}getCellSpan(){return this.cellSpan}refreshAriaRowIndex(){const{eGui:e,rowNode:t}=this;!e||t.rowIndex==null||ST(e,t.rowIndex)}setAriaRowSpan(){GM(this.eGui,this.cellSpan.spannedNodes.size)}setFocusedCellPosition(e){this.focusedCellPosition=e}getFocusedCellPosition(){return this.focusedCellPosition??this.cellPosition}checkCellFocused(){const e=this.beans.focusSvc.getFocusedCell();return!!e&&this.cellSpan.doesSpanContain(e)}applyStaticCssClasses(){super.applyStaticCssClasses(),this.comp.toggleCss(this.SPANNED_CELL_CSS_CLASS,!0)}onCellFocused(e){const{beans:t}=this;if(lm(t)){this.focusedCellPosition=void 0;return}const r=this.isCellFocused();r||(this.focusedCellPosition=void 0),e&&r&&(this.focusedCellPosition={rowIndex:e.rowIndex,rowPinned:e.rowPinned,column:e.column}),super.onCellFocused(e)}getRootElement(){return this.eWrapper}},c$=class extends F0{onRowIndexChanged(){super.onRowIndexChanged();for(const e of this.getAllCellCtrls())e.refreshAriaRowIndex()}getInitialRowClasses(e){return["ag-spanned-row"]}getNewCellCtrl(e){const t=this.beans.rowSpanSvc?.getCellSpan(e,this.rowNode);if(!(!t||t.firstNode!==this.rowNode))return new l$(t,this,this.beans)}isCorrectCtrlForSpan(e){const t=this.beans.rowSpanSvc?.getCellSpan(e.column,this.rowNode);return!t||t.firstNode!==this.rowNode?!1:e.getCellSpan()===t}onRowHeightChanged(){}refreshFirstAndLastRowStyles(){}addHoverFunctionality(){}resetHoveredStatus(){}},u$=class extends et{constructor(){super(...arguments),this.beanName="spannedRowRenderer",this.topCtrls=new Map,this.bottomCtrls=new Map,this.centerCtrls=new Map}postConstruct(){this.addManagedEventListeners({displayedRowsChanged:this.createAllCtrls.bind(this)})}createAllCtrls(){this.createCtrls("top"),this.createCtrls("bottom"),this.createCtrls("center")}createCtrls(e){const{rowSpanSvc:t}=this.beans,r=this.getCtrlsMap(e),n=r.size,i=this.getAllRelevantRowControls(e),s=new Map;let o=!1;for(const l of i)l.isAlive()&&t?.forEachSpannedColumn(l.rowNode,(c,u)=>{if(s.has(u.firstNode))return;const h=r.get(u.firstNode);if(h){s.set(u.firstNode,h),r.delete(u.firstNode);return}o=!0;const d=new c$(u.firstNode,this.beans,!1,!1,!1);s.set(u.firstNode,d)});this.setCtrlsMap(e,s);const a=s.size===n;if(!(!o&&a)){for(const l of r.values())l.destroyFirstPass(!0),l.destroySecondPass();this.dispatchLocalEvent({type:"spannedRowsUpdated",ctrlsKey:e})}}getAllRelevantRowControls(e){const{rowRenderer:t}=this.beans;switch(e){case"top":return t.topRowCtrls;case"bottom":return t.bottomRowCtrls;case"center":return t.allRowCtrls}}getCellByPosition(e){const{rowSpanSvc:t}=this.beans,r=t?.getCellSpanByPosition(e);if(!r)return;const n=this.getCtrlsMap(e.rowPinned).get(r.firstNode);if(n)return n.getAllCellCtrls().find(i=>i.column===e.column)}getCtrls(e){return[...this.getCtrlsMap(e).values()]}destroyRowCtrls(e){for(const t of this.getCtrlsMap(e).values())t.destroyFirstPass(!0),t.destroySecondPass();this.setCtrlsMap(e,new Map)}getCtrlsMap(e){switch(e){case"top":return this.topCtrls;case"bottom":return this.bottomCtrls;default:return this.centerCtrls}}setCtrlsMap(e,t){switch(e){case"top":this.topCtrls=t;break;case"bottom":this.bottomCtrls=t;break;default:this.centerCtrls=t;break}}destroy(){super.destroy(),this.destroyRowCtrls("top"),this.destroyRowCtrls("bottom"),this.destroyRowCtrls("center")}},d$={moduleName:"CellSpan",version:wt,beans:[a$,u$]},h$=class extends et{constructor(e,t){super(),this.cellCtrl=e,this.staticClasses=[],this.beans=t,this.column=e.column}setComp(e){this.cellComp=e,this.applyUserStyles(),this.applyCellClassRules(),this.applyClassesFromColDef()}applyCellClassRules(){const{column:e,cellComp:t}=this,r=e.colDef,n=r.cellClassRules,i=this.getCellClassParams(e,r);jy(this.beans.expressionSvc,n===this.cellClassRules?void 0:this.cellClassRules,n,i,s=>t.toggleCss(s,!0),s=>t.toggleCss(s,!1)),this.cellClassRules=n}applyUserStyles(){const e=this.column,t=e.colDef,r=t.cellStyle;if(!r)return;let n;if(typeof r=="function"){const i=this.getCellClassParams(e,t);n=r(i)}else n=r;n&&this.cellComp.setUserStyles(n)}applyClassesFromColDef(){const{column:e,cellComp:t}=this,r=e.colDef,n=this.getCellClassParams(e,r);for(const s of this.staticClasses)t.toggleCss(s,!1);const i=this.beans.cellStyles.getStaticCellClasses(r,n);this.staticClasses=i;for(const s of i)t.toggleCss(s,!0)}getCellClassParams(e,t){const{value:r,rowNode:n}=this.cellCtrl;return Dt(this.beans.gos,{value:r,data:n.data,node:n,colDef:t,column:e,rowIndex:n.rowIndex})}},f$=class extends et{constructor(){super(...arguments),this.beanName="cellStyles"}processAllCellClasses(e,t,r,n){jy(this.beans.expressionSvc,void 0,e.cellClassRules,t,r,n),this.processStaticCellClasses(e,t,r)}getStaticCellClasses(e,t){const{cellClass:r}=e;if(!r)return[];let n;return typeof r=="function"?n=r(t):n=r,typeof n=="string"&&(n=[n]),n||[]}createCellCustomStyleFeature(e){return new h$(e,this.beans)}processStaticCellClasses(e,t,r){this.getStaticCellClasses(e,t).forEach(i=>{r(i)})}},p$={moduleName:"CellStyle",version:wt,beans:[f$]},g$={moduleName:"RowStyle",version:wt,beans:[jH]};function m$(e,t){return!!e.colHover?.isHovered(t)}var v$=class extends et{constructor(e,t){super(),this.columns=e,this.element=t,this.destroyManagedListeners=[],this.enableFeature=r=>{const{beans:n,gos:i,element:s,columns:o}=this,a=n.colHover;if(r??!!i.get("columnHoverHighlight"))this.destroyManagedListeners=this.addManagedElementListeners(s,{mouseover:a.setMouseOver.bind(a,o),mouseout:a.clearMouseOver.bind(a)});else{for(const c of this.destroyManagedListeners)c();this.destroyManagedListeners=[]}}}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{this.enableFeature(e)}),this.enableFeature()}destroy(){super.destroy(),this.destroyManagedListeners=null}},b$="ag-column-hover",w$=class extends et{constructor(){super(...arguments),this.beanName="colHover"}postConstruct(){this.addManagedPropertyListener("columnHoverHighlight",({currentValue:e})=>{e||this.clearMouseOver()})}setMouseOver(e){this.updateState(e)}clearMouseOver(){this.updateState(null)}isHovered(e){if(!this.gos.get("columnHoverHighlight"))return!1;const t=this.selectedColumns;return!!t&&t.indexOf(e)>=0}addHeaderColumnHoverListener(e,t,r){const n=()=>{const i=this.isHovered(r);t.toggleCss("ag-column-hover",i)};e.addManagedEventListeners({columnHoverChanged:n}),n()}onCellColumnHover(e,t){if(!t)return;const r=this.isHovered(e);t.toggleCss(b$,r)}addHeaderFilterColumnHoverListener(e,t,r,n){this.createHoverFeature(e,[r],n);const i=()=>{const s=this.isHovered(r);t.toggleCss("ag-column-hover",s)};e.addManagedEventListeners({columnHoverChanged:i}),i()}createHoverFeature(e,t,r){e.createManagedBean(new v$(t,r))}updateState(e){this.selectedColumns=e,this.eventSvc.dispatchEvent({type:"columnHoverChanged"})}},y$={moduleName:"ColumnHover",version:wt,beans:[w$],apiFunctions:{isColumnHovered:m$}},C$=class extends et{constructor(){super(...arguments),this.beanName="apiEventSvc",this.syncListeners=new Map,this.asyncListeners=new Map,this.syncGlobalListeners=new Set,this.globalListenerPairs=new Map}postConstruct(){this.wrapSvc=this.beans.frameworkOverrides.createGlobalEventListenerWrapper?.()}addListener(e,t){const r=this.wrapSvc?.wrap(e,t)??t,n=!i0.has(e),i=n?this.asyncListeners:this.syncListeners;i.has(e)||i.set(e,new Set),i.get(e).add(r),this.eventSvc.addListener(e,r,n)}removeListener(e,t){const r=this.wrapSvc?.unwrap(e,t)??t,i=!!this.asyncListeners.get(e)?.delete(r);i||this.syncListeners.get(e)?.delete(r),this.eventSvc.removeListener(e,r,i)}addGlobalListener(e){const t=this.wrapSvc?.wrapGlobal(e)??e,r=(s,o)=>{i0.has(s)&&t(s,o)},n=(s,o)=>{i0.has(s)||t(s,o)};this.globalListenerPairs.set(e,{syncListener:r,asyncListener:n});const i=this.eventSvc;i.addGlobalListener(r,!1),i.addGlobalListener(n,!0)}removeGlobalListener(e){const{eventSvc:t,wrapSvc:r,globalListenerPairs:n}=this,i=r?.unwrapGlobal(e)??e;if(n.has(i)){const{syncListener:o,asyncListener:a}=n.get(i);t.removeGlobalListener(o,!1),t.removeGlobalListener(a,!0),n.delete(e)}else this.syncGlobalListeners.delete(i),t.removeGlobalListener(i,!1)}destroyEventListeners(e,t){e.forEach((r,n)=>{r.forEach(i=>this.eventSvc.removeListener(n,i,t)),r.clear()}),e.clear()}destroyGlobalListeners(e,t){for(const r of e)this.eventSvc.removeGlobalListener(r,t);e.clear()}destroy(){super.destroy(),this.destroyEventListeners(this.syncListeners,!1),this.destroyEventListeners(this.asyncListeners,!0),this.destroyGlobalListeners(this.syncGlobalListeners,!1);const{globalListenerPairs:e,eventSvc:t}=this;e.forEach(({syncListener:r,asyncListener:n})=>{t.removeGlobalListener(r,!1),t.removeGlobalListener(n,!0)}),e.clear()}};function x$(e,t,r){e.apiEventSvc?.addListener(t,r)}function S$(e,t,r){e.apiEventSvc?.removeListener(t,r)}function _$(e,t){e.apiEventSvc?.addGlobalListener(t)}function E$(e,t){e.apiEventSvc?.removeGlobalListener(t)}var T$={moduleName:"EventApi",version:wt,apiFunctions:{addEventListener:x$,addGlobalListener:_$,removeEventListener:S$,removeGlobalListener:E$},beans:[C$]},k$={moduleName:"Locale",version:wt,beans:[Kj]},R$=class extends et{constructor(){super(...arguments),this.beanName="rowAutoHeight",this.wasEverActive=!1,this._debouncedCalculateRowHeights=zn(this,this.calculateRowHeights.bind(this),1)}requestCheckAutoHeight(){this.wasEverActive&&this._debouncedCalculateRowHeights()}calculateRowHeights(){const{visibleCols:e,rowModel:t,rowSpanSvc:r,pinnedRowModel:n}=this.beans,i=e.autoHeightCols;let s=!1;const o=a=>{const l=a.__autoHeights;let c=al(this.beans,a).height;for(const u of i){let h=l?.[u.getColId()];const d=r?.getCellSpan(u,a);if(d){if(d.getLastNode()!==a)continue;if(h=r?.getCellSpan(u,a)?.getLastNodeAutoHeight(),!h)return}if(h==null){if(this.colSpanSkipCell(u,a))continue;return}c=Math.max(h,c)}c!==a.rowHeight&&(a.setRowHeight(c),s=!0)};n?.forEachPinnedRow?.("top",o),n?.forEachPinnedRow?.("bottom",o),t.forEachDisplayedNode?.(o),s&&t.onRowHeightChanged?.()}setRowAutoHeight(e,t,r){if(e.__autoHeights??(e.__autoHeights={}),t==null){delete e.__autoHeights[r.getId()];return}const n=e.__autoHeights[r.getId()];e.__autoHeights[r.getId()]=t,n!==t&&this.requestCheckAutoHeight()}colSpanSkipCell(e,t){const{colModel:r,colViewport:n,visibleCols:i}=this.beans;if(!r.colSpanActive)return!1;let s=[];switch(e.getPinned()){case"left":s=i.getLeftColsForRow(t);break;case"right":s=i.getRightColsForRow(t);break;case null:s=n.getColsWithinViewport(t);break}return!s.includes(e)}setupCellAutoHeight(e,t,r){if(!e.column.isAutoHeight()||!t)return!1;this.wasEverActive=!0;const n=t.parentElement,{rowNode:i,column:s}=e,o=this.beans,a=u=>{if(this.beans.editSvc?.isEditing(e)||!e.isAlive()||!r.isAlive())return;const{paddingTop:h,paddingBottom:d,borderBottomWidth:f,borderTopWidth:m}=Ac(n),v=h+d+f+m,w=t.offsetHeight+v;if(u<5){const C=!Gn(o)?.contains(t),k=w==0;if(C||k){window.setTimeout(()=>a(u+1),0);return}}this.setRowAutoHeight(i,w,s)},l=()=>a(0);l();const c=ha(o,t,l);return r.addDestroyFunc(()=>{c(),this.setRowAutoHeight(i,void 0,s)}),!0}setAutoHeightActive(e){this.active=e.list.some(t=>t.isVisible()&&t.isAutoHeight())}areRowsMeasured(){if(!this.active)return!0;const e=this.beans.rowRenderer.getAllRowCtrls();let t=null;for(const{rowNode:r}of e)if((!t||this.beans.colModel.colSpanActive)&&(t=this.beans.colViewport.getColsWithinViewport(r).filter(i=>i.isAutoHeight())),t.length!==0){if(!r.__autoHeights)return!1;for(const n of t){const i=r.__autoHeights[n.getColId()];if(!i||r.rowHeight<i)return!1}}return!0}},A$={moduleName:"RowAutoHeight",version:wt,beans:[R$]},F$={moduleName:"AllCommunity",version:wt,dependsOn:[kU,OU,WU,fV,Ez,Tz,kz,Rz,Az,Fz,Mz,_z,vG,bG,wG,mG,CG,xG,aW,nU,TW,bR,NW,LW,WW,ZW,rN,i$,qz,Fj,p$,y$,g$,T$,Pj,tW,QR,k$,A$,tN,RU,d$]},Yy=vT();const M$=Qw(Yy);var mi=st.createContext({}),m6=st.createContext("default"),Kf=(e,t,r,n)=>{if(!e||e.componentFromFramework||t.isDestroyed())return;const s=e.newAgStackInstance();let o,a,l=!1;return s.then(c=>{if(l){t.destroyBean(c);return}o=c,a=o.getGui(),r.appendChild(a),c3(n,o)}),()=>{l=!0,o&&(a?.remove(),t.destroyBean(o),n&&c3(n,void 0))}},c3=(e,t)=>{if(e)if(e instanceof Function)e(t);else{const r=e;r.current=t}},xs=(...e)=>e.filter(r=>r!=null&&r!=="").join(" "),Es=class v6{constructor(...t){this.classesMap={};for(const r of t)this.classesMap[r]=!0}setClass(t,r){if(!!this.classesMap[t]==r)return this;const i=new v6;return i.classesMap={...this.classesMap},i.classesMap[t]=r,i}toString(){return Object.keys(this.classesMap).filter(r=>this.classesMap[r]).join(" ")}},_d=e=>{const t=()=>typeof Symbol=="function"&&Symbol.for,r=()=>t()?Symbol.for("react.memo"):60115;return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===r()},Rw=st.version?.split(".")[0],b6=Rw==="16"||Rw==="17";function D$(){return Rw==="19"}var l0=!1;function P$(e){return l0||setTimeout(()=>l0=!1,0),l0=!0,e()}var wf=(e,t)=>{!b6&&e&&!l0?M$.flushSync(t):t()},I$=e=>{b6?e():st.startTransition(e)};function O$(e,t,r){return st.useSyncExternalStore?st.useSyncExternalStore(e,t):r}function O0(e,t,r){if(t==null||e==null)return t;if(e===t||t.length===0&&e.length===0)return e;if(r||e.length===0&&t.length>0||e.length>0&&t.length===0)return t;const n=[],i=[],s=new Map,o=new Map;for(let a=0;a<t.length;a++){const l=t[a];o.set(l.instanceId,l)}for(let a=0;a<e.length;a++){const l=e[a];s.set(l.instanceId,l),o.has(l.instanceId)&&n.push(l)}for(let a=0;a<t.length;a++){const l=t[a],c=l.instanceId;s.has(c)||i.push(l)}return n.length===e.length&&i.length===0?e:n.length===0&&i.length===t.length?t:n.length===0?i:i.length===0?n:[...n,...i]}var w6=ae.forwardRef((e,t)=>{const{registry:r,context:n}=ae.useContext(mi),i=ae.useRef(null),s=ae.useRef(null),o=ae.useRef(null),a=ae.useRef(null),l=ae.useRef(null),c=ae.useRef(),[u,h]=ae.useState(),[d,f]=ae.useState(),[m,v]=ae.useState(),[g,w]=ae.useState(()=>new Es),[y,C]=ae.useState(()=>new Es("ag-hidden")),[k,F]=ae.useState(()=>new Es("ag-hidden")),[I,N]=ae.useState(()=>new Es("ag-invisible"));ae.useImperativeHandle(t,()=>({refresh(){return!1}})),ae.useLayoutEffect(()=>Kf(u,n,s.current),[u]);const j=ae.useCallback(_=>{if(i.current=_,!_||n.isDestroyed()){c.current=n.destroyBean(c.current);return}const T={setInnerRenderer:(D,O)=>{h(D),v(O)},setChildCount:D=>f(D),toggleCss:(D,O)=>w(P=>P.setClass(D,O)),setContractedDisplayed:D=>F(O=>O.setClass("ag-hidden",!D)),setExpandedDisplayed:D=>C(O=>O.setClass("ag-hidden",!D)),setCheckboxVisible:D=>N(O=>O.setClass("ag-invisible",!D)),setCheckboxSpacing:D=>N(O=>O.setClass("ag-group-checkbox-spacing",D))},E=r.createDynamicBean("groupCellRendererCtrl",!0);E&&(c.current=n.createBean(E),c.current.init(T,_,o.current,a.current,l.current,w6,e))},[]),L=ae.useMemo(()=>`ag-cell-wrapper ${g.toString()}`,[g]),W=ae.useMemo(()=>`ag-group-expanded ${y.toString()}`,[y]),K=ae.useMemo(()=>`ag-group-contracted ${k.toString()}`,[k]),z=ae.useMemo(()=>`ag-group-checkbox ${I.toString()}`,[I]),M=u?.componentFromFramework,B=M?u.componentClass:void 0,R=u==null&&m!=null,S=yd(m);return st.createElement("span",{className:L,ref:j,...e.colDef?{}:{role:c.current?.getCellAriaRole()}},st.createElement("span",{className:W,ref:a}),st.createElement("span",{className:K,ref:l}),st.createElement("span",{className:z,ref:o}),st.createElement("span",{className:"ag-group-value",ref:s},R?S:M?st.createElement(B,{...u.params}):null),st.createElement("span",{className:"ag-group-child-count"},d))}),u3=w6,Zy=ae.createContext({setMethods:()=>{}}),N$=e=>{const{initialProps:t,addUpdateCallback:r,CustomComponentClass:n,setMethods:i}=e,[{key:s,...o},a]=ae.useState(t);return ae.useEffect(()=>{r(l=>a(l))},[]),st.createElement(Zy.Provider,{value:{setMethods:i}},st.createElement(n,{key:s,...o}))},L$=ae.memo(N$),B$=0;function d3(){return`agPortalKey_${++B$}`}var y6=class{constructor(e,t,r,n){this.portal=null,this.oldPortal=null,this.reactComponent=e,this.portalManager=t,this.componentType=r,this.suppressFallbackMethods=!!n,this.statelessComponent=this.isStateless(this.reactComponent),this.key=d3(),this.portalKey=d3(),this.instanceCreated=this.isStatelessComponent()?hr.resolve(!1):new hr(i=>{this.resolveInstanceCreated=i})}getGui(){return this.eParentElement}getRootElement(){return this.eParentElement.firstChild}destroy(){this.componentInstance&&typeof this.componentInstance.destroy=="function"&&this.componentInstance.destroy();const e=this.portal;e&&this.portalManager.destroyPortal(e)}createParentElement(e){const t=this.portalManager.getComponentWrappingElement(),r=document.createElement(t||"div");return r.classList.add("ag-react-container"),e.reactContainer=r,r}statelessComponentRendered(){return this.eParentElement.childElementCount>0||this.eParentElement.childNodes.length>0}getFrameworkComponentInstance(){return this.componentInstance}isStatelessComponent(){return this.statelessComponent}getReactComponentName(){return this.reactComponent.name}getMemoType(){return this.hasSymbol()?Symbol.for("react.memo"):60115}hasSymbol(){return typeof Symbol=="function"&&Symbol.for}isStateless(e){return typeof e=="function"&&!(e.prototype&&e.prototype.isReactComponent)||typeof e=="object"&&e.$$typeof===this.getMemoType()}hasMethod(e){const t=this.getFrameworkComponentInstance();return!!t&&t[e]!=null||this.fallbackMethodAvailable(e)}callMethod(e,t){const r=this.getFrameworkComponentInstance();if(this.isStatelessComponent())return this.fallbackMethod(e,t&&t[0]?t[0]:{});if(!r){setTimeout(()=>this.callMethod(e,t));return}const n=r[e];if(n)return n.apply(r,t);if(this.fallbackMethodAvailable(e))return this.fallbackMethod(e,t&&t[0]?t[0]:{})}addMethod(e,t){this[e]=t}init(e){return this.eParentElement=this.createParentElement(e),this.createOrUpdatePortal(e),new hr(t=>this.createReactComponent(t))}createOrUpdatePortal(e){this.isStatelessComponent()||(this.ref=t=>{this.componentInstance=t,this.resolveInstanceCreated?.(!0),this.resolveInstanceCreated=void 0},e.ref=this.ref),this.reactElement=this.createElement(this.reactComponent,{...e,key:this.key}),this.portal=Yy.createPortal(this.reactElement,this.eParentElement,this.portalKey)}createElement(e,t){return ae.createElement(e,t)}createReactComponent(e){this.portalManager.mountReactPortal(this.portal,this,e)}rendered(){return this.isStatelessComponent()&&this.statelessComponentRendered()||!!(!this.isStatelessComponent()&&this.getFrameworkComponentInstance())}refreshComponent(e){this.oldPortal=this.portal,this.createOrUpdatePortal(e),this.portalManager.updateReactPortal(this.oldPortal,this.portal)}fallbackMethod(e,t){const r=this[`${e}Component`];if(!this.suppressFallbackMethods&&r)return r.bind(this)(t)}fallbackMethodAvailable(e){return this.suppressFallbackMethods?!1:!!this[`${e}Component`]}};function gm(e,t,r){for(const n of e){const i=t[n];i&&(r[n]=i)}}var Fs=class extends y6{constructor(){super(...arguments),this.awaitUpdateCallback=new hr(e=>{this.resolveUpdateCallback=e}),this.wrapperComponent=L$}init(e){return this.sourceParams=e,super.init(this.getProps())}addMethod(){}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}getFrameworkComponentInstance(){return this}createElement(e,t){return super.createElement(this.wrapperComponent,{initialProps:t,CustomComponentClass:e,setMethods:r=>this.setMethods(r),addUpdateCallback:r=>{this.updateCallback=()=>(r(this.getProps()),new hr(n=>{setTimeout(()=>{n()})})),this.resolveUpdateCallback()}})}setMethods(e){this.providedMethods=e,gm(this.getOptionalMethods(),this.providedMethods,this)}getOptionalMethods(){return[]}getProps(){return{...this.sourceParams,key:this.key,ref:this.ref}}refreshProps(){return this.updateCallback?this.updateCallback():new hr(e=>this.awaitUpdateCallback.then(()=>{this.updateCallback().then(()=>e())}))}},H$=class extends Fs{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},j$=class extends Fs{refresh(e){this.sourceParams=e,this.refreshProps()}},V$=class extends Fs{constructor(){super(...arguments),this.date=null,this.onDateChange=e=>this.updateDate(e)}getDate(){return this.date}setDate(e){this.date=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached","setInputPlaceholder","setInputAriaLabel","setDisabled"]}updateDate(e){this.setDate(e),this.sourceParams.onDateChanged()}getProps(){const e=super.getProps();return e.date=this.date,e.onDateChange=this.onDateChange,delete e.onDateChanged,e}},G$=class extends Fs{constructor(){super(...arguments),this.label="",this.icon=null,this.shake=!1}setIcon(e,t){this.icon=e,this.shake=t,this.refreshProps()}setLabel(e){this.label=e,this.refreshProps()}getProps(){const e=super.getProps(),{label:t,icon:r,shake:n}=this;return e.label=t,e.icon=r,e.shake=n,e}},z$=class extends Fs{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e),this.onUiChange=()=>this.sourceParams.filterModifiedCallback(),this.expectingNewMethods=!0,this.hasBeenActive=!1,this.awaitSetMethodsCallback=new hr(e=>{this.resolveSetMethodsCallback=e})}isFilterActive(){return this.model!=null}doesFilterPass(e){return this.providedMethods.doesFilterPass(e)}getModel(){return this.model}setModel(e){return this.expectingNewMethods=!0,this.model=e,this.hasBeenActive||(this.hasBeenActive=this.isFilterActive()),this.refreshProps()}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){const t=this.providedMethods;t?t.afterGuiAttached?.(e):this.awaitSetMethodsCallback.then(()=>this.providedMethods?.afterGuiAttached?.(e))}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","getModelAsString","onAnyFilterChanged"]}setMethods(e){this.expectingNewMethods===!1&&this.hasBeenActive&&this.providedMethods?.doesFilterPass!==e?.doesFilterPass&&setTimeout(()=>{this.sourceParams.filterChangedCallback()}),this.expectingNewMethods=!1,super.setMethods(e),this.resolveSetMethodsCallback(),this.resolveFilterPassCallback?.(),this.resolveFilterPassCallback=void 0}updateModel(e){this.resolveFilterPassCallback?.();const t=new hr(r=>{this.resolveFilterPassCallback=r});this.setModel(e).then(()=>{t.then(()=>{this.sourceParams.filterChangedCallback()})})}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e.onUiChange=this.onUiChange,delete e.filterChangedCallback,e}},U$=class extends Fs{constructor(){super(...arguments),this.awaitSetMethodsCallback=new hr(e=>{this.resolveSetMethodsCallback=e})}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}afterGuiAttached(e){const t=this.providedMethods;t?t.afterGuiAttached?.(e):this.awaitSetMethodsCallback.then(()=>this.providedMethods?.afterGuiAttached?.(e))}getOptionalMethods(){return["afterGuiDetached","onNewRowsLoaded","onAnyFilterChanged"]}setMethods(e){super.setMethods(e),this.resolveSetMethodsCallback()}};function C6(e,t){e.parentFilterInstance(r=>{(r.setModel(t)||hr.resolve()).then(()=>{e.filterParams.filterChangedCallback()})})}var W$=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t,this.model=null,this.onModelChange=r=>this.updateModel(r)}getProps(){return{...this.floatingFilterParams,model:this.model,onModelChange:this.onModelChange}}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){gm(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),C6(this.floatingFilterParams,e)}},$$=class extends Fs{constructor(){super(...arguments),this.model=null,this.onModelChange=e=>this.updateModel(e)}onParentModelChanged(e){this.model=e,this.refreshProps()}refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}updateModel(e){this.model=e,this.refreshProps(),C6(this.sourceParams,e)}getProps(){const e=super.getProps();return e.model=this.model,e.onModelChange=this.onModelChange,e}},q$=class extends Fs{refresh(e){this.sourceParams=e,this.refreshProps()}getOptionalMethods(){return["afterGuiAttached"]}},K$=class extends Fs{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},X$=class extends Fs{constructor(){super(...arguments),this.active=!1,this.expanded=!1,this.onActiveChange=e=>this.updateActive(e)}setActive(e){this.awaitSetActive(e)}setExpanded(e){this.expanded=e,this.refreshProps()}getOptionalMethods(){return["select","configureDefaults"]}awaitSetActive(e){return this.active=e,this.refreshProps()}updateActive(e){const t=this.awaitSetActive(e);e&&t.then(()=>this.sourceParams.onItemActivated())}getProps(){const e=super.getProps();return e.active=this.active,e.expanded=this.expanded,e.onActiveChange=this.onActiveChange,delete e.onItemActivated,e}},Y$=class extends Fs{refresh(e){return this.sourceParams=e,this.refreshProps(),!0}},Z$=class extends Fs{constructor(){super(...arguments),this.onStateChange=e=>this.updateState(e)}refresh(e){return this.sourceParams=e,this.refreshProps(),!0}getState(){return this.state}updateState(e){this.state=e,this.refreshProps(),this.sourceParams.onStateUpdated()}getProps(){const e=super.getProps();return e.state=this.state,e.onStateChange=this.onStateChange,e}};function Jy(){at(231)}var J$=1e3,Q$=class{constructor(e,t,r){this.destroyed=!1,this.portals=[],this.hasPendingPortalUpdate=!1,this.wrappingElement=t||"div",this.refresher=e,this.maxComponentCreationTimeMs=r||J$}getPortals(){return this.portals}destroy(){this.destroyed=!0}destroyPortal(e){this.portals=this.portals.filter(t=>t!==e),this.batchUpdate()}getComponentWrappingElement(){return this.wrappingElement}mountReactPortal(e,t,r){this.portals=[...this.portals,e],this.waitForInstance(t,r),this.batchUpdate()}updateReactPortal(e,t){this.portals[this.portals.indexOf(e)]=t,this.batchUpdate()}batchUpdate(){this.hasPendingPortalUpdate||(setTimeout(()=>{this.destroyed||(this.refresher(),this.hasPendingPortalUpdate=!1)}),this.hasPendingPortalUpdate=!0)}waitForInstance(e,t,r=Date.now()){if(this.destroyed){t(null);return}if(e.rendered())t(e);else{if(Date.now()-r>=this.maxComponentCreationTimeMs&&!this.hasPendingPortalUpdate){wf(!0,()=>this.refresher()),e.rendered()&&t(e);return}window.setTimeout(()=>{this.waitForInstance(e,t,r)})}}},eq=({ctrl:e})=>{const t=e.isAlive(),{context:r}=ae.useContext(mi),[n,i]=ae.useState(),[s,o]=ae.useState(),a=ae.useRef(),l=ae.useRef(null),c=ae.useRef(null),u=ae.useRef(null),h=ae.useRef(),d=ae.useRef();t&&!d.current&&(d.current=new Gf(()=>l.current));const f=ae.useCallback(w=>{if(l.current=w,!w||!e.isAlive()||r.isDestroyed()){a.current=r.destroyBean(a.current);return}a.current=r.createBean(new xd);const y=()=>{const k=e.getSelectAllGui();k&&(c.current?.insertAdjacentElement("afterend",k),a.current.addDestroyFunc(()=>k.remove()))},C={setWidth:k=>{l.current&&(l.current.style.width=k)},toggleCss:(k,F)=>d.current.toggleCss(k,F),setUserStyles:k=>o(k),setAriaSort:k=>{l.current&&(k?WM(l.current,k):$M(l.current))},setUserCompDetails:k=>i(k),getUserCompInstance:()=>h.current||void 0,refreshSelectAllGui:y,removeSelectAllGui:()=>e.getSelectAllGui()?.remove()};e.setComp(C,w,c.current,u.current,a.current),y()},[]);ae.useLayoutEffect(()=>Kf(n,r,u.current,h),[n]),ae.useEffect(()=>{e.setDragSource(l.current)},[n]);const m=ae.useMemo(()=>!!(n?.componentFromFramework&&_d(n.componentClass)),[n]),v=n?.componentFromFramework,g=n?.componentClass;return st.createElement("div",{ref:f,style:s,className:"ag-header-cell",role:"columnheader"},st.createElement("div",{ref:c,className:"ag-header-cell-resize",role:"presentation"}),st.createElement("div",{ref:u,className:"ag-header-cell-comp-wrapper",role:"presentation"},v?m?st.createElement(g,{...n.params}):st.createElement(g,{...n.params,ref:h}):null))},tq=ae.memo(eq),rq=class{constructor(e,t){this.floatingFilterParams=e,this.refreshProps=t}getProps(){return this.floatingFilterParams}refresh(e){this.floatingFilterParams=e,this.refreshProps()}setMethods(e){gm(this.getOptionalMethods(),e,this)}getOptionalMethods(){return["afterGuiAttached"]}},nq=({ctrl:e})=>{const{context:t,gos:r}=ae.useContext(mi),[n,i]=ae.useState(),[s,o]=ae.useState(()=>new Es("ag-header-cell","ag-floating-filter")),[a,l]=ae.useState(()=>new Es),[c,u]=ae.useState(()=>new Es("ag-floating-filter-button","ag-hidden")),[h,d]=ae.useState("false"),[f,m]=ae.useState(),[,v]=ae.useState(1),g=ae.useRef(),w=ae.useRef(null),y=ae.useRef(null),C=ae.useRef(null),k=ae.useRef(null),F=ae.useRef(),I=ae.useRef(),N=D=>{D!=null&&F.current&&F.current(D)},j=ae.useCallback(D=>{if(w.current=D,!D||!e.isAlive()||t.isDestroyed()){g.current=t.destroyBean(g.current);return}g.current=t.createBean(new xd),I.current=new hr(P=>{F.current=P});const O={toggleCss:(P,q)=>o(X=>X.setClass(P,q)),setUserStyles:P=>i(P),addOrRemoveBodyCssClass:(P,q)=>l(X=>X.setClass(P,q)),setButtonWrapperDisplayed:P=>{u(q=>q.setClass("ag-hidden",!P)),d(P?"false":"true")},setWidth:P=>{w.current&&(w.current.style.width=P)},setCompDetails:P=>m(P),getFloatingFilterComp:()=>I.current?I.current:null,setMenuIcon:P=>k.current?.appendChild(P)};e.setComp(O,D,k.current,y.current,g.current)},[]);ae.useLayoutEffect(()=>Kf(f,t,y.current,N),[f]);const L=ae.useMemo(()=>s.toString(),[s]),W=ae.useMemo(()=>a.toString(),[a]),K=ae.useMemo(()=>c.toString(),[c]),z=ae.useMemo(()=>!!(f&&f.componentFromFramework&&_d(f.componentClass)),[f]),M=ae.useMemo(()=>r.get("reactiveCustomComponents"),[]),B=ae.useMemo(()=>r.get("enableFilterHandlers"),[]),[R,S]=ae.useState();ae.useEffect(()=>{if(f?.componentFromFramework)if(M){const D=B?rq:W$,O=new D(f.params,()=>v(P=>P+1));N(O),S(O)}else Jy()},[f]);const _=R?.getProps(),T=f?.componentFromFramework,E=f?.componentClass;return st.createElement("div",{ref:j,style:n,className:L,role:"gridcell"},st.createElement("div",{ref:y,className:W,role:"presentation"},T?M?_&&st.createElement(Zy.Provider,{value:{setMethods:D=>R.setMethods(D)}},st.createElement(E,{..._})):st.createElement(E,{...f.params,ref:z?()=>{}:N}):null),st.createElement("div",{ref:C,"aria-hidden":h,className:K,role:"presentation"},st.createElement("button",{ref:k,type:"button",className:"ag-button ag-floating-filter-button-button",tabIndex:-1})))},iq=ae.memo(nq),sq=({ctrl:e})=>{const{context:t}=ae.useContext(mi),[r,n]=ae.useState(),[i,s]=ae.useState(()=>new Es),[o,a]=ae.useState(()=>new Es),[l,c]=ae.useState("false"),[u,h]=ae.useState(),[d,f]=ae.useState(),m=ae.useRef(),v=ae.useRef(null),g=ae.useRef(null),w=ae.useRef(null),y=ae.useRef(),C=ae.useCallback(L=>{if(v.current=L,!L||!e.isAlive()||t.isDestroyed()){m.current=t.destroyBean(m.current);return}m.current=t.createBean(new xd);const W={setWidth:K=>{v.current&&(v.current.style.width=K)},toggleCss:(K,z)=>s(M=>M.setClass(K,z)),setUserStyles:K=>n(K),setHeaderWrapperHidden:K=>{const z=w.current;z&&(K?z.style.setProperty("display","none"):z.style.removeProperty("display"))},setHeaderWrapperMaxHeight:K=>{const z=w.current;z&&(K!=null?z.style.setProperty("max-height",`${K}px`):z.style.removeProperty("max-height"),z.classList.toggle("ag-header-cell-comp-wrapper-limited-height",K!=null))},setUserCompDetails:K=>f(K),setResizableDisplayed:K=>{a(z=>z.setClass("ag-hidden",!K)),c(K?"false":"true")},setAriaExpanded:K=>h(K),getUserCompInstance:()=>y.current||void 0};e.setComp(W,L,g.current,w.current,m.current)},[]);ae.useLayoutEffect(()=>Kf(d,t,w.current),[d]),ae.useEffect(()=>{v.current&&e.setDragSource(v.current)},[d]);const k=ae.useMemo(()=>!!(d?.componentFromFramework&&_d(d.componentClass)),[d]),F=ae.useMemo(()=>"ag-header-group-cell "+i.toString(),[i]),I=ae.useMemo(()=>"ag-header-cell-resize "+o.toString(),[o]),N=d?.componentFromFramework,j=d?.componentClass;return st.createElement("div",{ref:C,style:r,className:F,role:"columnheader","aria-expanded":u},st.createElement("div",{ref:w,className:"ag-header-cell-comp-wrapper",role:"presentation"},N?k?st.createElement(j,{...d.params}):st.createElement(j,{...d.params,ref:y}):null),st.createElement("div",{ref:g,"aria-hidden":l,className:I}))},oq=ae.memo(sq),aq=({ctrl:e})=>{const{gos:t,context:r}=ae.useContext(mi),{topOffset:n,rowHeight:i}=ae.useMemo(()=>e.getTopAndHeight(),[]),s=ae.useMemo(()=>t.get("tabIndex"),[]),[o,a]=ae.useState(()=>e.getAriaRowIndex()),l=e.headerRowClass,[c,u]=ae.useState(()=>i+"px"),[h,d]=ae.useState(()=>n+"px"),f=ae.useRef(null),[m,v]=ae.useState(()=>e.getUpdatedHeaderCtrls()),g=ae.useRef(),w=ae.useRef(null),y=ae.useCallback(F=>{if(w.current=F,!F||!e.isAlive()||r.isDestroyed()){g.current=r.destroyBean(g.current);return}g.current=r.createBean(new xd);const I={setHeight:N=>u(N),setTop:N=>d(N),setHeaderCtrls:(N,j,L)=>{const W=f.current,K=O0(W,N,j);K!==W&&(f.current=K,wf(L,()=>v(K)))},setWidth:N=>{w.current&&(w.current.style.width=N)},setRowIndex:N=>{a(N)}};e.setComp(I,g.current,!1)},[]),C=ae.useMemo(()=>({height:c,top:h}),[c,h]),k=ae.useCallback(F=>{switch(e.type){case"group":return st.createElement(oq,{ctrl:F,key:F.instanceId});case"filter":return st.createElement(iq,{ctrl:F,key:F.instanceId});default:return st.createElement(tq,{ctrl:F,key:F.instanceId})}},[]);return st.createElement("div",{ref:y,className:l,role:"row",style:C,tabIndex:s,"aria-rowindex":o},m.map(k))},lq=ae.memo(aq),cq=({pinned:e})=>{const[t,r]=ae.useState(!0),[n,i]=ae.useState([]),{context:s}=ae.useContext(mi),o=ae.useRef(null),a=ae.useRef(null),l=ae.useRef(),c=e==="left",u=e==="right",h=!c&&!u,d=ae.useCallback(v=>{if(o.current=v,!v||s.isDestroyed()){l.current=s.destroyBean(l.current);return}l.current=s.createBean(new GI(e));const g={setDisplayed:r,setCtrls:w=>i(w),setCenterWidth:w=>{a.current&&(a.current.style.width=w)},setViewportScrollLeft:w=>{o.current&&(o.current.scrollLeft=w)},setPinnedContainerWidth:w=>{o.current&&(o.current.style.width=w,o.current.style.minWidth=w,o.current.style.maxWidth=w)}};l.current.setComp(g,o.current)},[]),f=t?"":"ag-hidden",m=()=>n.map(v=>st.createElement(lq,{ctrl:v,key:v.instanceId}));return c?st.createElement("div",{ref:d,className:"ag-pinned-left-header "+f,"aria-hidden":!t,role:"rowgroup"},m()):u?st.createElement("div",{ref:d,className:"ag-pinned-right-header "+f,"aria-hidden":!t,role:"rowgroup"},m()):h?st.createElement("div",{ref:d,className:"ag-header-viewport "+f,role:"rowgroup",tabIndex:-1},st.createElement("div",{ref:a,className:"ag-header-container",role:"presentation"},m())):null},wb=ae.memo(cq),uq=()=>{const[e,t]=ae.useState(()=>new Es),[r,n]=ae.useState(),{context:i}=ae.useContext(mi),s=ae.useRef(null),o=ae.useRef(),a=ae.useCallback(u=>{if(s.current=u,!u||i.isDestroyed()){o.current=i.destroyBean(o.current);return}o.current=i.createBean(new BI);const h={toggleCss:(d,f)=>t(m=>m.setClass(d,f)),setHeightAndMinHeight:d=>n(d)};o.current.setComp(h,u,u)},[]),l=ae.useMemo(()=>"ag-header "+e.toString(),[e]),c=ae.useMemo(()=>({height:r,minHeight:r}),[r]);return st.createElement("div",{ref:a,className:l,style:c,role:"presentation"},st.createElement(wb,{pinned:"left"}),st.createElement(wb,{pinned:null}),st.createElement(wb,{pinned:"right"}))},dq=ae.memo(uq),hq=(e,t)=>{ae.useEffect(()=>{const r=t.current;if(r){const n=r.parentElement;if(n){const i=document.createComment(e);return n.insertBefore(i,r),()=>{i.remove()}}}},[e])},Yl=hq,fq=class{constructor(e,t){this.cellEditorParams=e,this.refreshProps=t,this.instanceCreated=new hr(r=>{this.resolveInstanceCreated=r}),this.onValueChange=r=>this.updateValue(r),this.value=e.value}getProps(){return{...this.cellEditorParams,initialValue:this.cellEditorParams.value,value:this.value,onValueChange:this.onValueChange}}getValue(){return this.value}refresh(e){this.cellEditorParams=e,this.refreshProps()}setMethods(e){gm(this.getOptionalMethods(),e,this)}getInstance(){return this.instanceCreated.then(()=>this.componentInstance)}setRef(e){this.componentInstance=e,this.resolveInstanceCreated?.(),this.resolveInstanceCreated=void 0}getOptionalMethods(){return["isCancelBeforeStart","isCancelAfterEnd","focusIn","focusOut","afterGuiAttached","getValidationErrors","getValidationElement"]}updateValue(e){this.value=e,this.refreshProps()}},pq=e=>{const t=ae.useRef(e),r=ae.useRef(),n=ae.useRef(!1),i=ae.useRef(!1),[,s]=ae.useState(0);n.current&&(i.current=!0),ae.useEffect(()=>(n.current||(r.current=t.current(),n.current=!0),s(o=>o+1),()=>{i.current&&r.current?.()}),[])},gq=e=>{const[t,r]=ae.useState(),n=ae.useContext(mi),{context:i,popupSvc:s,gos:o,editSvc:a}=n,{editDetails:l,cellCtrl:c,eParentCell:u}=e;return pq(()=>{const{compDetails:h}=l,d=o.get("stopEditingWhenCellsLoseFocus");let f,m;if(!i.isDestroyed()){m=i.createBean(a.createPopupEditorWrapper(h.params));const v=m.getGui();if(e.jsChildComp){const F=e.jsChildComp.getGui();F&&v.appendChild(F)}const{column:g,rowNode:w}=c,y={column:g,rowNode:w,type:"popupCellEditor",eventSource:u,ePopup:v,position:l.popupPosition,keepWithinBounds:!0},C=s?.positionPopupByComponent.bind(s,y),k=s?.addPopup({modal:d,eChild:v,closeOnEsc:!0,closedCallback:()=>{c.onPopupEditorClosed()},anchorToElement:u,positionCallback:C,ariaOwns:u});f=k?k.hideFunc:void 0,r(m),e.jsChildComp?.afterGuiAttached?.()}return()=>{f?.(),i.destroyBean(m)}}),ae.useLayoutEffect(()=>()=>{c.isCellFocused()&&t?.getGui().contains(tn(n))&&u.focus({preventScroll:!0})},[t]),t&&e.wrappedContent?Yy.createPortal(e.wrappedContent,t.getGui()):null},h3=ae.memo(gq),mq=(e,t,r)=>{const{compProxy:n}=e;r(n);const i=n.getProps(),s=_d(t);return st.createElement(Zy.Provider,{value:{setMethods:o=>n.setMethods(o)}},s?st.createElement(t,{...i}):st.createElement(t,{...i,ref:o=>n.setRef(o)}))},f3=(e,t,r)=>e.compProxy?mq(e,t,r):st.createElement(t,{...e.compDetails.params,ref:r}),vq=(e,t,r,n,i)=>{const s=e.compDetails,o=s.componentClass,a=s.componentFromFramework&&!e.popup,l=s.componentFromFramework&&e.popup,c=!s.componentFromFramework&&e.popup;return a?f3(e,o,t):l?st.createElement(h3,{editDetails:e,cellCtrl:n,eParentCell:r,wrappedContent:f3(e,o,t)}):c&&i?st.createElement(h3,{editDetails:e,cellCtrl:n,eParentCell:r,jsChildComp:i}):null},bq=(e,t,r,n,i,s,o=!1)=>{const{context:a}=ae.useContext(mi),l=ae.useCallback(()=>{const c=i.current;if(!c)return;const u=c.getGui();u&&u.parentElement&&u.remove(),a.destroyBean(c),i.current=void 0},[]);ae.useEffect(()=>{const c=e!=null&&!o,u=e?.compDetails&&!e.compDetails.componentFromFramework,h=t&&r==null;if(!(c&&u&&!h)){l();return}const f=e.compDetails;if(i.current){const v=i.current,w=v.refresh!=null&&e.force==!1?v.refresh(f.params):!1;if(w===!0||w===void 0)return;l()}f.newAgStackInstance().then(v=>{if(!v)return;const g=v.getGui();if(!g)return;(t?r:s.current).appendChild(g),i.current=v})},[e,t,n,o]),ae.useEffect(()=>l,[])},x6=bq,wq=({cellCtrl:e,parent:t})=>{const r=ae.useRef(),n=ae.useMemo(()=>{const{loadingComp:i}=e.getDeferLoadingCellRenderer();return i?{value:void 0,compDetails:i,force:!1}:void 0},[e]);if(x6(n,!1,void 0,1,r,t),n?.compDetails?.componentFromFramework){const i=n.compDetails.componentClass;return st.createElement(i,{...n.compDetails.params})}return st.createElement(st.Fragment,null)},yq=({cellCtrl:e,printLayout:t,editingCell:r})=>{const n=ae.useContext(mi),{context:i}=n,{column:{colIdSanitised:s},instanceId:o}=e,a=ae.useRef(),[l,c]=ae.useState(()=>e.isCellRenderer()?void 0:{compDetails:void 0,value:e.getValueToDisplay(),force:!1}),[u,h]=ae.useState(),[d,f]=ae.useState(1),[m,v]=ae.useState(),[g,w]=ae.useState(!1),[y,C]=ae.useState(!1),[k,F]=ae.useState(!1),[I,N]=ae.useState(),j=ae.useMemo(()=>e.isForceWrapper(),[e]),L=ae.useMemo(()=>e.getCellAriaRole(),[e]),W=ae.useRef(null),K=ae.useRef(null),z=ae.useRef(null),M=ae.useRef(),B=ae.useRef(),R=ae.useRef(),S=ae.useRef([]),_=ae.useRef(),T=ae.useRef(),[E,D]=ae.useState(0),O=ae.useCallback(ne=>{T.current=ne,D(me=>me+1)},[]),P=l!=null&&(g||k||y)&&(u==null||!!u.popup),q=j||P,X=ae.useMemo(()=>e.getCellValueClass(),[e]),Q=ae.useCallback(ne=>{if(B.current=ne,ne){const me=ne.isCancelBeforeStart&&ne.isCancelBeforeStart();setTimeout(()=>{me?(e.stopEditing(!0),e.focusCell(!0)):(e.cellEditorAttached(),e.enableEditorTooltipFeature(ne))})}},[e]),G=ae.useRef();G.current||(G.current=new Gf(()=>W.current));const ee=!!u&&!u.popup;x6(l,q,T.current,E,M,W,ee);const V=ae.useRef();ae.useLayoutEffect(()=>{const ne=V.current,me=l;if(V.current=l,ne==null||ne.compDetails==null||me==null||me.compDetails==null)return;_.current?.refreshVisibility();const ve=ne.compDetails,Te=me.compDetails;if(ve.componentClass!=Te.componentClass||z.current?.refresh==null)return;z.current.refresh(Te.params)!=!0&&f(Fe=>Fe+1)},[l]),ae.useLayoutEffect(()=>{if(!(u&&!u.compDetails.componentFromFramework)||i.isDestroyed())return;const me=u.compDetails,ve=u.popup===!0,Te=me.newAgStackInstance();return Te.then(xe=>{if(!xe)return;const Fe=xe.getGui();Q(xe),ve||((j?R:W).current?.appendChild(Fe),xe.afterGuiAttached?.()),N(xe)}),()=>{Te.then(xe=>{const Fe=xe.getGui();e.disableEditorTooltipFeature(),i.destroyBean(xe),Q(void 0),N(void 0),Fe?.remove()})}},[u]);const H=ae.useCallback(ne=>{if(R.current=ne,!ne||i.isDestroyed()||!e.isAlive()){const Te=S.current;S.current=[];for(const xe of Te)xe();return}let me;const ve=Te=>{Te&&(ne.insertAdjacentElement("afterbegin",Te.getGui()),S.current.push(()=>{ol(Te.getGui()),i.destroyBean(Te),_.current===me&&(_.current=void 0)}))};g&&ve(e.createSelectionCheckbox()),k&&ve(e.createDndSource()),y&&(me=e.createRowDragComp(),_.current=me,me&&(ve(me),me.refreshVisibility()))},[e,i,k,y,g]),Z=ae.useCallback(()=>{const ne=!e.isCellSpanning()||K.current,me=W.current;if(!me||!ne||!e||!e.isAlive()||i.isDestroyed()){a.current=i.destroyBean(a.current);return}a.current=i.createBean(new xd);const ve={toggleCss:(xe,Fe)=>G.current.toggleCss(xe,Fe),setUserStyles:xe=>v(xe),getFocusableElement:()=>W.current,setIncludeSelection:xe=>w(xe),setIncludeRowDrag:xe=>C(xe),setIncludeDndSource:xe=>F(xe),getCellEditor:()=>B.current??null,getCellRenderer:()=>z.current??M.current,getParentOfValue:()=>T.current??R.current??W.current,setRenderDetails:(xe,Fe,Ge)=>{const Ve=()=>{c(Ye=>Ye?.compDetails!==xe||Ye?.value!==Fe||Ye?.force!==Ge?{value:Fe,compDetails:xe,force:Ge}:Ye)};if(xe?.params?.deferRender&&!e.rowNode.group){const{loadingComp:Ye,onReady:ut}=e.getDeferLoadingCellRenderer();if(Ye){c({value:void 0,compDetails:Ye,force:!1}),ut.then(()=>I$(Ve));return}}Ve()},setEditDetails:(xe,Fe,Ge,Ve)=>{if(xe){let Ye;xe.componentFromFramework&&(Ve?Ye=new fq(xe.params,()=>f(ut=>ut+1)):Jy()),h({compDetails:xe,popup:Fe,popupPosition:Ge,compProxy:Ye}),Fe||c(void 0)}else e.hasBrowserFocus()&&ve.getFocusableElement().focus({preventScroll:!0}),B.current=void 0,h(void 0)},refreshEditStyles:(xe,Fe)=>{if(!W.current)return;const{current:Ge}=G;Ge.toggleCss("ag-cell-value",!q),Ge.toggleCss("ag-cell-inline-editing",!!xe&&!Fe),Ge.toggleCss("ag-cell-popup-editing",!!xe&&!!Fe),Ge.toggleCss("ag-cell-not-inline-editing",!xe||!!Fe)}},Te=R.current||void 0;e.setComp(ve,me,K.current??void 0,Te,t,r,a.current)},[]),ie=ae.useCallback(ne=>{W.current=ne,Z()},[]),te=ae.useCallback(ne=>{K.current=ne,Z()},[]),oe=ae.useMemo(()=>!!(l?.compDetails?.componentFromFramework&&_d(l.compDetails.componentClass)),[l]);ae.useLayoutEffect(()=>{if(!W.current)return;const{current:ne}=G;ne.toggleCss("ag-cell-value",!q),ne.toggleCss("ag-cell-inline-editing",!!u&&!u.popup),ne.toggleCss("ag-cell-popup-editing",!!u&&!!u.popup),ne.toggleCss("ag-cell-not-inline-editing",!u||!!u.popup)});const ue=()=>{const{compDetails:ne,value:me}=l;if(!ne)return me?.toString?.()??me;if(ne.componentFromFramework){const ve=ne.componentClass;return st.createElement(ae.Suspense,{fallback:st.createElement(wq,{cellCtrl:e,parent:W})},oe?st.createElement(ve,{...ne.params,key:d}):st.createElement(ve,{...ne.params,key:d,ref:z}))}},Ce=()=>{const ne=()=>l==null?null:q?st.createElement("span",{role:"presentation",id:`cell-${o}`,className:X,ref:O},ue()):ue(),me=ve=>vq(ve,Q,W.current,e,I);return u!=null?u.popup?st.createElement(st.Fragment,null,ne(),me(u)):me(u):ne()},ye=()=>st.createElement("div",{ref:ie,style:m,role:L,"col-id":s},q?st.createElement("div",{className:"ag-cell-wrapper",role:"presentation",ref:H},Ce()):Ce());return e.isCellSpanning()?st.createElement("div",{ref:te,className:"ag-spanned-cell-wrapper",role:"presentation"},ye()):ye()},Cq=ae.memo(yq),xq=({rowCtrl:e,containerType:t})=>{const{context:r,gos:n,editSvc:i}=ae.useContext(mi),s=ae.useContext(m6)==="default",o=ae.useRef(),a=ae.useRef(e.getDomOrder()),l=e.isFullWidth(),c=e.rowNode.displayed,[u,h]=ae.useState(()=>c?e.rowNode.getRowIndexString():null),[d,f]=ae.useState(()=>e.rowId),[m,v]=ae.useState(()=>e.businessKey),[g,w]=ae.useState(()=>e.rowStyles),y=ae.useRef(null),[C,k]=ae.useState(()=>null),[F,I]=ae.useState(),[N,j]=ae.useState(()=>c?e.getInitialRowTop(t):void 0),[L,W]=ae.useState(()=>c?e.getInitialTransform(t):void 0),K=ae.useRef(null),z=ae.useRef(),M=ae.useRef(),B=ae.useRef(!1),[R,S]=ae.useState(0);ae.useEffect(()=>{if(B.current||!F||R>10)return;const Z=K.current?.firstChild;Z?(e.setupDetailRowAutoHeight(Z),B.current=!0):S(ie=>ie+1)},[F,R]);const _=ae.useRef();_.current||(_.current=new Gf(()=>K.current));const T=ae.useRef(()=>{}),E=ae.useCallback(Z=>(T.current=Z,()=>{T.current=()=>{}}),[]),D=O$(E,()=>y.current,[]),O=s?D:C,P=ae.useCallback(Z=>{if(K.current=Z,o.current=Z?r.createBean(new xd):r.destroyBean(o.current),!Z){e.unsetComp(t);return}if(!e.isAlive()||r.isDestroyed())return;const ie={setTop:j,setTransform:W,toggleCss:(te,oe)=>_.current.toggleCss(te,oe),setDomOrder:te=>a.current=te,setRowIndex:h,setRowId:f,setRowBusinessKey:v,setUserStyles:w,setCellCtrls:(te,oe)=>{const ue=y.current,Ce=O0(ue,te,a.current);Ce!==ue&&(y.current=Ce,s?T.current():wf(oe,()=>k(Ce)))},showFullWidth:te=>{M.current=te.params,I(te)},getFullWidthCellRenderer:()=>z.current,getFullWidthCellRendererParams:()=>M.current,refreshFullWidth:te=>{const oe=te();return M.current=oe,ee.current?(I(ue=>({...ue,params:oe})),!0):!z.current||!z.current.refresh?!1:z.current.refresh(oe)}};e.setComp(ie,Z,t,o.current)},[]);ae.useLayoutEffect(()=>Kf(F,r,K.current,z),[F]);const q=ae.useMemo(()=>{const Z={top:N,transform:L};return Object.assign(Z,g),Z},[N,L,g]),X=l&&F?.componentFromFramework,Q=!l&&O!=null,G=ae.useMemo(()=>!!(F?.componentFromFramework&&_d(F.componentClass)),[F]),ee=ae.useRef(!1);ae.useEffect(()=>{ee.current=G&&!!F&&!!n.get("reactiveCustomComponents")},[G,F]);const V=()=>O?.map(Z=>st.createElement(Cq,{cellCtrl:Z,editingCell:i?.isEditing(Z,{withOpenEditor:!0})??!1,printLayout:e.printLayout,key:Z.instanceId})),H=()=>{const Z=F.componentClass;return G?st.createElement(Z,{...F.params}):st.createElement(Z,{...F.params,ref:z})};return st.createElement("div",{ref:P,role:"row",style:q,"row-index":u,"row-id":d,"row-business-key":m},Q?V():X?H():null)},p3=ae.memo(xq),Sq=({name:e})=>{const{context:t,gos:r}=ae.useContext(mi),n=ae.useMemo(()=>Uf(e),[e]),i=ae.useRef(null),s=ae.useRef(null),o=ae.useRef(null),a=ae.useRef([]),l=ae.useRef([]),[c,u]=ae.useState(()=>[]),h=!!r.get("enableCellSpan")&&!!n.getSpannedRowCtrls,d=ae.useRef([]),f=ae.useRef([]),[m,v]=ae.useState(()=>[]),g=ae.useRef(!1),w=ae.useRef(),y=ae.useMemo(()=>xs("ag-viewport",Jk(e)),[e]),C=ae.useMemo(()=>xs(r0(e)),[e]),k=ae.useMemo(()=>xs("ag-spanning-container",eI(e)),[e]),F=n.type==="center"||h,I=F?i:s;Yl(" AG Row Container "+e+" ",I);const N=ae.useCallback(()=>{const R=!F||i.current!=null,S=s.current!=null,_=!h||o.current!=null;return R&&S&&_},[]),j=ae.useCallback(()=>i.current==null&&s.current==null&&o.current==null,[]),L=ae.useCallback(()=>{if(j()&&(w.current=t.destroyBean(w.current)),!t.isDestroyed()&&N()){const R=T=>{const E=O0(l.current,a.current,g.current);E!==l.current&&(l.current=E,wf(T,()=>u(E)))},S=T=>{const E=O0(f.current,d.current,g.current);E!==f.current&&(f.current=E,wf(T,()=>v(E)))},_={setHorizontalScroll:T=>{i.current&&(i.current.scrollLeft=T)},setViewportHeight:T=>{i.current&&(i.current.style.height=T)},setRowCtrls:({rowCtrls:T,useFlushSync:E})=>{const D=!!E&&a.current.length>0&&T.length>0;a.current=T,R(D)},setSpannedRowCtrls:(T,E)=>{const D=!!E&&d.current.length>0&&T.length>0;d.current=T,S(D)},setDomOrder:T=>{g.current!=T&&(g.current=T,R(!1))},setContainerWidth:T=>{s.current&&(s.current.style.width=T)},setOffsetTop:T=>{s.current&&(s.current.style.transform=`translateY(${T})`)}};w.current=t.createBean(new uI(e)),w.current.setComp(_,s.current,o.current??void 0,i.current)}},[N,j]),W=ae.useCallback(R=>{s.current=R,L()},[L]),K=ae.useCallback(R=>{o.current=R,L()},[L]),z=ae.useCallback(R=>{i.current=R,L()},[L]),M=()=>st.createElement("div",{className:C,ref:W,role:F?"presentation":"rowgroup"},c.map(R=>st.createElement(p3,{rowCtrl:R,containerType:n.type,key:R.instanceId})));if(!F)return M();const B=()=>st.createElement("div",{className:k,ref:K,role:"presentation"},m.map(R=>st.createElement(p3,{rowCtrl:R,containerType:n.type,key:R.instanceId})));return st.createElement("div",{className:y,ref:z,role:"rowgroup"},M(),h?B():null)},_q=ae.memo(Sq),Eq=()=>{const e=ae.useContext(mi),{context:t,overlays:r}=e,[n,i]=ae.useState(""),[s,o]=ae.useState(0),[a,l]=ae.useState(0),[c,u]=ae.useState("0px"),[h,d]=ae.useState("0px"),[f,m]=ae.useState("100%"),[v,g]=ae.useState("0px"),[w,y]=ae.useState("0px"),[C,k]=ae.useState("100%"),[F,I]=ae.useState(!0),[N,j]=ae.useState(!0),[L,W]=ae.useState(null),[K,z]=ae.useState(""),[M,B]=ae.useState(null),[R,S]=ae.useState("ag-layout-normal"),_=ae.useRef();_.current||(_.current=new Gf(()=>T.current));const T=ae.useRef(null),E=ae.useRef(null),D=ae.useRef(null),O=ae.useRef(null),P=ae.useRef(null),q=ae.useRef(null),X=ae.useRef(null),Q=ae.useRef([]),G=ae.useRef([]);Yl(" AG Grid Body ",T),Yl(" AG Pinned Top ",E),Yl(" AG Sticky Top ",D),Yl(" AG Middle ",q),Yl(" AG Pinned Bottom ",X);const ee=ae.useCallback(xe=>{if(T.current=xe,!xe||t.isDestroyed()){Q.current=t.destroyBeans(Q.current);for(const be of G.current)be();G.current=[];return}const Fe=(be,ze)=>{be.appendChild(ze),G.current.push(()=>ze.remove())},Ge=be=>{const ze=t.createBean(new be);return Q.current.push(ze),ze},Ve=(be,ze,we)=>{Fe(be,document.createComment(we)),Fe(be,Ge(ze).getGui())};Ve(xe,vI," AG Fake Horizontal Scroll ");const Ye=r?.getOverlayWrapperCompClass();Ye&&Ve(xe,Ye," AG Overlay Wrapper "),P.current&&Ve(P.current,wI," AG Fake Vertical Scroll ");const ut={setRowAnimationCssOnBodyViewport:i,setColumnCount:be=>{T.current&&zM(T.current,be)},setRowCount:be=>{T.current&&VM(T.current,be)},setTopHeight:o,setBottomHeight:l,setStickyTopHeight:u,setStickyTopTop:d,setStickyTopWidth:m,setTopInvisible:I,setBottomInvisible:j,setColumnMovingCss:(be,ze)=>_.current.toggleCss(be,ze),updateLayoutClasses:S,setAlwaysVerticalScrollClass:W,setPinnedTopBottomOverflowY:z,setCellSelectableCss:(be,ze)=>B(ze?be:null),setBodyViewportWidth:be=>{q.current&&(q.current.style.width=be)},registerBodyViewportResizeListener:be=>{if(q.current){const ze=ha(e,q.current,be);G.current.push(()=>ze())}},setStickyBottomHeight:g,setStickyBottomBottom:y,setStickyBottomWidth:k,setGridRootRole:be=>xe.setAttribute("role",be)},ht=t.createBean(new pI);Q.current.push(ht),ht.setComp(ut,xe,q.current,E.current,X.current,D.current,O.current)},[]),V=ae.useMemo(()=>xs("ag-root","ag-unselectable",R),[R]),H=ae.useMemo(()=>xs("ag-body-viewport",n,R,L,M),[n,R,L,M]),Z=ae.useMemo(()=>xs("ag-body",R),[R]),ie=ae.useMemo(()=>xs("ag-floating-top",F?"ag-invisible":null,M),[M,F]),te=ae.useMemo(()=>xs("ag-sticky-top",M),[M]),oe=ae.useMemo(()=>xs("ag-sticky-bottom",v==="0px"?"ag-invisible":null,M),[M,v]),ue=ae.useMemo(()=>xs("ag-floating-bottom",N?"ag-invisible":null,M),[M,N]),Ce=ae.useMemo(()=>({height:s,minHeight:s,overflowY:K}),[s,K]),ye=ae.useMemo(()=>({height:c,top:h,width:f}),[c,h,f]),ne=ae.useMemo(()=>({height:v,bottom:w,width:C}),[v,w,C]),me=ae.useMemo(()=>({height:a,minHeight:a,overflowY:K}),[a,K]),ve=xe=>st.createElement(_q,{name:xe,key:`${xe}-container`}),Te=({section:xe,children:Fe,className:Ge,style:Ve})=>st.createElement("div",{ref:xe,className:Ge,role:"presentation",style:Ve},Fe.map(ve));return st.createElement("div",{ref:ee,className:V},st.createElement(dq,null),Te({section:E,className:ie,style:Ce,children:["topLeft","topCenter","topRight","topFullWidth"]}),st.createElement("div",{className:Z,ref:P,role:"presentation"},Te({section:q,className:H,children:["left","center","right","fullWidth"]})),Te({section:D,className:te,style:ye,children:["stickyTopLeft","stickyTopCenter","stickyTopRight","stickyTopFullWidth"]}),Te({section:O,className:oe,style:ne,children:["stickyBottomLeft","stickyBottomCenter","stickyBottomRight","stickyBottomFullWidth"]}),Te({section:X,className:ue,style:me,children:["bottomLeft","bottomCenter","bottomRight","bottomFullWidth"]}))},Tq=ae.memo(Eq),kq=(e,t)=>{const{children:r,eFocusableElement:n,onTabKeyDown:i,gridCtrl:s,forceFocusOutWhenTabGuardsAreEmpty:o,isEmpty:a}=e,{context:l}=ae.useContext(mi),c=ae.useRef(null),u=ae.useRef(null),h=ae.useRef(),d=w=>{const y=w==null?void 0:parseInt(w,10).toString();for(const C of[c,u])y===void 0?C.current?.removeAttribute("tabindex"):C.current?.setAttribute("tabindex",y)};ae.useImperativeHandle(t,()=>({forceFocusOutOfContainer(w){h.current?.forceFocusOutOfContainer(w)}}));const f=ae.useCallback(()=>{const w=c.current,y=u.current;if(!w&&!y||l.isDestroyed()){h.current=l.destroyBean(h.current);return}if(w&&y){const C={setTabIndex:d};h.current=l.createBean(new yO({comp:C,eTopGuard:w,eBottomGuard:y,eFocusableElement:n,onTabKeyDown:i,forceFocusOutWhenTabGuardsAreEmpty:o,focusInnerElement:k=>s.focusInnerElement(k),isEmpty:a}))}},[]),m=ae.useCallback(w=>{c.current=w,f()},[f]),v=ae.useCallback(w=>{u.current=w,f()},[f]),g=w=>{const y=w==="top"?Yu.TAB_GUARD_TOP:Yu.TAB_GUARD_BOTTOM;return st.createElement("div",{className:`${Yu.TAB_GUARD} ${y}`,role:"presentation",ref:w==="top"?m:v})};return st.createElement(st.Fragment,null,g("top"),r,g("bottom"))},Rq=ae.forwardRef(kq),Aq=ae.memo(Rq),Fq=({context:e})=>{const[t,r]=ae.useState(""),[n,i]=ae.useState(""),[s,o]=ae.useState(null),[a,l]=ae.useState(null),[c,u]=ae.useState(!1),[h,d]=ae.useState(),f=ae.useRef(),m=ae.useRef(null),v=ae.useRef(),[g,w]=ae.useState(null),y=ae.useRef(()=>{}),C=ae.useRef(),k=ae.useRef([]),F=ae.useCallback(()=>{},[]);Yl(" AG Grid ",m);const I=ae.useCallback(z=>{if(m.current=z,f.current=z?e.createBean(new RO):e.destroyBean(f.current),!z||e.isDestroyed())return;const M=f.current;y.current=M.focusInnerElement.bind(M);const B={destroyGridUi:()=>{},setRtlClass:r,forceFocusOutOfContainer:R=>{if(!R&&C.current?.isDisplayed()){C.current.forceFocusOutOfContainer(R);return}v.current?.forceFocusOutOfContainer(R)},updateLayoutClasses:i,getFocusableContainers:()=>{const R=[],S=m.current?.querySelector(".ag-root");S&&R.push({getGui:()=>S});for(const _ of k.current)_.isDisplayed()&&R.push(_);return R},setCursor:o,setUserSelect:l};M.setComp(B,z,z),u(!0)},[]);ae.useEffect(()=>{const z=f.current,M=m.current;if(!h||!z||!g||!M||e.isDestroyed())return;const B=[],{watermarkSelector:R,paginationSelector:S,sideBarSelector:_,statusBarSelector:T,gridHeaderDropZonesSelector:E}=z.getOptionalSelectors(),D=[];if(E){const P=e.createBean(new E.component),q=P.getGui();M.insertAdjacentElement("afterbegin",q),D.push(q),B.push(P)}if(_){const P=e.createBean(new _.component),q=P.getGui(),X=g.querySelector(".ag-tab-guard-bottom");X&&(X.insertAdjacentElement("beforebegin",q),D.push(q)),B.push(P),k.current.push(P)}const O=P=>{const q=e.createBean(new P),X=q.getGui();return M.insertAdjacentElement("beforeend",X),D.push(X),B.push(q),q};if(T&&O(T.component),S){const P=O(S.component);C.current=P,k.current.push(P)}return R&&O(R.component),()=>{e.destroyBeans(B);for(const P of D)P.remove()}},[h,g,e]);const N=ae.useMemo(()=>xs("ag-root-wrapper",t,n),[t,n]),j=ae.useMemo(()=>xs("ag-root-wrapper-body","ag-focus-managed",n),[n]),L=ae.useMemo(()=>({userSelect:a??"",WebkitUserSelect:a??"",cursor:s??""}),[a,s]),W=ae.useCallback(z=>{v.current=z,d(z!==null)},[]),K=ae.useCallback(()=>!f.current?.isFocusable(),[]);return st.createElement("div",{ref:I,className:N,style:L,role:"presentation"},st.createElement("div",{className:j,ref:w,role:"presentation"},c&&g&&!e.isDestroyed()&&st.createElement(mi.Provider,{value:e.getBeans()},st.createElement(Aq,{ref:W,eFocusableElement:g,onTabKeyDown:F,gridCtrl:f.current,forceFocusOutWhenTabGuardsAreEmpty:!0,isEmpty:K},st.createElement(Tq,null)))))},Mq=ae.memo(Fq),Dq=class extends et{postConstruct(){if(this.beans.colAutosize){const e=this.queueResizeOperationsForTick.bind(this);this.addManagedEventListeners({rowExpansionStateChanged:e,expandOrCollapseAll:e,cellValueChanged:e,rowNodeDataChanged:e,rowDataUpdated:e})}}queueResizeOperationsForTick(){const e=this.beans.colAutosize;e.shouldQueueResizeOperations=!0,setTimeout(()=>{e.processResizeOperations()},0)}areHeaderCellsRendered(){return this.beans.ctrlsSvc.getHeaderRowContainerCtrls().every(e=>e.getAllCtrls().every(t=>t.areCellsRendered()))}areCellsRendered(){return this.beans.rowRenderer.getAllRowCtrls().every(e=>e.isRowRendered()&&e.getAllCellCtrls().every(t=>!!t.eGui))}},S6={setGridApi:void 0,maxComponentCreationTimeMs:void 0,children:void 0},Pq={gridOptions:void 0,modules:void 0,containerStyle:void 0,className:void 0,passGridApi:void 0,componentWrappingElement:void 0,...S6},_6=new Set(Object.keys(Pq)),Iq=new Set(Object.keys(S6)),E6=e=>{const t=ae.useRef(),r=ae.useRef(null),n=ae.useRef(null),i=ae.useRef([]),s=ae.useRef([]),o=ae.useRef(e),a=ae.useRef(),l=ae.useRef(),c=ae.useRef(!1),[u,h]=ae.useState(void 0),[,d]=ae.useState(0),f=ae.useRef(),m=C=>{const k=r.current?.classList,F=(I="")=>I.trim().split(/\s+/g).filter(Boolean);if(f.current!==C){for(const I of F(f.current))k?.contains(I)&&k.remove(I);for(const I of F(C))k?.contains(I)||k?.add(I);f.current=C}};ae.useLayoutEffect(()=>{m(e.className)},[e.className]);const v=ae.useCallback(C=>{if(r.current=C,m(e.className),!C){for(const M of i.current)M();i.current.length=0;return}const k=e.modules||[];n.current||(n.current=new Q$(()=>d(M=>M+1),e.componentWrappingElement,e.maxComponentCreationTimeMs),i.current.push(()=>{n.current?.destroy(),n.current=null}));const F=UD(e.gridOptions,e,Object.keys(e).filter(M=>!_6.has(M))),I=()=>{if(c.current){const M=()=>a.current?.shouldQueueUpdates()?void 0:s.current.shift();let B=M();for(;B;)B(),B=M()}},N=new Bq(I);a.current=N;const j=new Dq,L={providedBeanInstances:{frameworkCompWrapper:new Nq(n.current,F),renderStatus:j},modules:k,frameworkOverrides:N,setThemeOnGridDiv:!0},W=M=>{h(M),M.createBean(j),i.current.push(()=>{M.destroy()}),M.getBean("ctrlsSvc").whenReady({addDestroyFunc:B=>{i.current.push(B)}},()=>{if(M.isDestroyed())return;const B=t.current;B&&e.passGridApi?.(B)})},K=M=>{M.getBean("ctrlsSvc").whenReady({addDestroyFunc:B=>{i.current.push(B)}},()=>{for(const B of s.current)B();s.current.length=0,c.current=!0})},z=new $j;F.gridId??(F.gridId=l.current),t.current=z.create(C,F,W,K,L),i.current.push(()=>{t.current=void 0}),t.current&&(l.current=t.current.getGridId())},[]),g=ae.useMemo(()=>({height:"100%",...e.containerStyle||{}}),[e.containerStyle]),w=ae.useCallback(C=>{c.current&&!a.current?.shouldQueueUpdates()?C():s.current.push(C)},[]);ae.useEffect(()=>{const C=Oq(o.current,e);o.current=e,w(()=>{t.current&&WD(C,t.current)})},[e]);const y=!st.useSyncExternalStore||Yg(e,"renderingMode")==="legacy"?"legacy":"default";return st.createElement("div",{style:g,ref:v},st.createElement(m6.Provider,{value:y},u&&!u.isDestroyed()?st.createElement(Mq,{key:u.instanceId,context:u}):null,n.current?.getPortals()??null))};function Oq(e,t){const r={};for(const n of Object.keys(t)){if(_6.has(n)){Iq.has(n)&&at(274,{prop:n});continue}const i=t[n];e[n]!==i&&(r[n]=i)}return r}var Nq=class extends Zj{constructor(e,t){super(),this.parent=e,this.gridOptions=t}createWrapper(e,t){const r=this.gridOptions;if(Yg(r,"reactiveCustomComponents")){const o=(a=>{switch(a){case"filter":return Yg(r,"enableFilterHandlers")?U$:z$;case"floatingFilterComponent":return Yg(r,"enableFilterHandlers")?q$:$$;case"dateComponent":return V$;case"dragAndDropImageComponent":return G$;case"loadingOverlayComponent":case"noRowsOverlayComponent":case"activeOverlay":return j$;case"statusPanel":return Y$;case"toolPanel":return Z$;case"menuItem":return X$;case"cellRenderer":return H$;case"innerHeaderComponent":return K$}})(t.name);if(o)return new o(e,this.parent,t)}else switch(t.name){case"filter":case"floatingFilterComponent":case"dateComponent":case"dragAndDropImageComponent":case"loadingOverlayComponent":case"noRowsOverlayComponent":case"activeOverlay":case"statusPanel":case"toolPanel":case"menuItem":case"cellRenderer":Jy();break}const i=!t.cellRenderer&&t.name!=="toolPanel";return new y6(e,this.parent,t,i)}},Lq=ae.forwardRef((e,t)=>{const r=ae.useContext(mi),{registry:n,context:i,gos:s,rowModel:o}=r,[a,l]=ae.useState(()=>new Es),[c,u]=ae.useState(()=>new Es),[h,d]=ae.useState(),[f,m]=ae.useState(),v=ae.useRef(),g=ae.useRef(null),w=ae.useRef(),y=ae.useMemo(()=>CD(e.api.getGridId(),h?.rowModelType??"clientSide"),[e]),C=ae.useMemo(()=>a.toString()+" ag-details-row",[a]),k=ae.useMemo(()=>c.toString()+" ag-details-grid",[c]);t&&ae.useImperativeHandle(t,()=>({refresh(){return v.current?.refresh()??!1}})),e.template&&at(230);const F=ae.useCallback(N=>{if(g.current=N,!N||i.isDestroyed()){v.current=i.destroyBean(v.current),w.current?.();return}const j={toggleCss:(W,K)=>l(z=>z.setClass(W,K)),toggleDetailGridCss:(W,K)=>u(z=>z.setClass(W,K)),setDetailGrid:W=>d(W),setRowData:W=>m(W),getGui:()=>g.current},L=n.createDynamicBean("detailCellRendererCtrl",!0);if(L&&(i.createBean(L),L.init(j,e),v.current=L,s.get("detailRowAutoHeight"))){const W=()=>{if(g.current==null)return;const K=g.current.clientHeight;K!=null&&K>0&&setTimeout(()=>{e.node.setRowHeight(K),(rn(s)||Cd(s))&&o.onRowHeightChanged()},0)};w.current=ha(r,N,W),W()}},[]),I=ae.useCallback(N=>{v.current?.registerDetailWithMaster(N)},[]);return st.createElement("div",{className:C,ref:F},h&&st.createElement(E6,{className:k,...h,modules:y,rowData:f,passGridApi:I}))}),Bq=class extends uR{constructor(e){super("react"),this.processQueuedUpdates=e,this.queueUpdates=!1,this.renderingEngine="react",this.frameworkComponents={agGroupCellRenderer:u3,agGroupRowRenderer:u3,agDetailCellRenderer:Lq},this.wrapIncoming=(t,r)=>r==="ensureVisible"?P$(t):t()}frameworkComponent(e){return this.frameworkComponents[e]}isFrameworkComponent(e){if(!e)return!1;const t=e.prototype;return!(t&&"getGui"in t)}getLockOnRefresh(){this.queueUpdates=!0}releaseLockOnRefresh(){this.queueUpdates=!1,this.processQueuedUpdates()}shouldQueueUpdates(){return this.queueUpdates}runWhenReadyAsync(){return D$()}},Qy=class extends ae.Component{constructor(){super(...arguments),this.apiListeners=[],this.setGridApi=e=>{this.api=e;for(const t of this.apiListeners)t(e)}}registerApiListener(e){this.apiListeners.push(e)}componentWillUnmount(){this.apiListeners.length=0}render(){return st.createElement(E6,{...this.props,passGridApi:this.setGridApi})}};var N0={};N0.version="0.18.5";var T6=1252,Hq=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],eC={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},tC=function(e){Hq.indexOf(e)!=-1&&(T6=eC[0]=e)};function jq(){tC(1252)}var zs=function(e){tC(e)};function rC(){zs(1200),jq()}function g3(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function Vq(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function k6(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Dh=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?Vq(e.slice(2)):t==254&&r==255?k6(e.slice(2)):t==65279?e.slice(1):e},Eg=function(t){return String.fromCharCode(t)},m3=function(t){return String.fromCharCode(t)},yf,tl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Cf(e){for(var t="",r=0,n=0,i=0,s=0,o=0,a=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),o=(r&3)<<4|n>>4,i=e.charCodeAt(c++),a=(n&15)<<2|i>>6,l=i&63,isNaN(n)?a=l=64:isNaN(i)&&(l=64),t+=tl.charAt(s)+tl.charAt(o)+tl.charAt(a)+tl.charAt(l);return t}function is(e){var t="",r=0,n=0,i=0,s=0,o=0,a=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=tl.indexOf(e.charAt(c++)),o=tl.indexOf(e.charAt(c++)),r=s<<2|o>>4,t+=String.fromCharCode(r),a=tl.indexOf(e.charAt(c++)),n=(o&15)<<4|a>>2,a!==64&&(t+=String.fromCharCode(n)),l=tl.indexOf(e.charAt(c++)),i=(a&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var ar=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),pa=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function dl(e){return ar?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function v3(e){return ar?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Qi=function(t){return ar?pa(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function mm(e){if(typeof ArrayBuffer>"u")return Qi(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Cl(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Gq(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function nC(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return nC(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Vn=ar?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:pa(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function zq(e){for(var t=[],r=0,n=e.length+250,i=dl(e.length+255),s=0;s<e.length;++s){var o=e.charCodeAt(s);if(o<128)i[r++]=o;else if(o<2048)i[r++]=192|o>>6&31,i[r++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var a=e.charCodeAt(++s)&1023;i[r++]=240|o>>8&7,i[r++]=128|o>>2&63,i[r++]=128|a>>6&15|(o&3)<<4,i[r++]=128|a&63}else i[r++]=224|o>>12&15,i[r++]=128|o>>6&63,i[r++]=128|o&63;r>n&&(t.push(i.slice(0,r)),r=0,i=dl(65535),n=65530)}return t.push(i.slice(0,r)),Vn(t)}var Si=/\u0000/g,Ph=/[\u0001-\u0006]/g;function td(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Us(e,t){var r=""+e;return r.length>=t?r:un("0",t-r.length)+r}function iC(e,t){var r=""+e;return r.length>=t?r:un(" ",t-r.length)+r}function L0(e,t){var r=""+e;return r.length>=t?r:r+un(" ",t-r.length)}function Uq(e,t){var r=""+Math.round(e);return r.length>=t?r:un("0",t-r.length)+r}function Wq(e,t){var r=""+e;return r.length>=t?r:un("0",t-r.length)+r}var b3=Math.pow(2,32);function vu(e,t){if(e>b3||e<-b3)return Uq(e,t);var r=Math.round(e);return Wq(r,t)}function B0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var w3=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],yb=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function $q(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var Gt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},y3={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},qq={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function H0(e,t,r){for(var n=e<0?-1:1,i=e*n,s=0,o=1,a=0,l=1,c=0,u=0,h=Math.floor(i);c<t&&(h=Math.floor(i),a=h*o+s,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),s=o,o=a,l=c,c=u;if(u>t&&(c>t?(u=l,a=s):(u=c,a=o)),!r)return[0,n*a,u];var d=Math.floor(n*a/u);return[d,n*a-d*u,u]}function tc(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),s=0,o=[],a={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(a.u)<1e-6&&(a.u=0),t&&t.date1904&&(n+=1462),a.u>.9999&&(a.u=0,++i==86400&&(a.T=i=0,++n,++a.D)),n===60)o=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)o=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),o=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=Qq(l,o))}return a.y=o[0],a.m=o[1],a.d=o[2],a.S=i%60,i=Math.floor(i/60),a.M=i%60,i=Math.floor(i/60),a.H=i,a.q=s,a}var R6=new Date(1899,11,31,0,0,0),Kq=R6.getTime(),Xq=new Date(1900,2,1,0,0,0);function A6(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=Xq&&(r+=1440*60*1e3),(r-(Kq+(e.getTimezoneOffset()-R6.getTimezoneOffset())*6e4))/(1440*60*1e3)}function sC(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Yq(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Zq(e){var t=e<0?12:11,r=sC(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function Jq(e){var t=sC(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function xf(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=Zq(e):t===10?r=e.toFixed(10).substr(0,12):r=Jq(e),sC(Yq(r.toUpperCase()))}function Cc(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):xf(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return As(14,A6(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function Qq(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function eK(e,t,r,n){var i="",s=0,o=0,a=r.y,l,c=0;switch(e){case 98:a=r.y+543;case 121:switch(t.length){case 1:case 2:l=a%100,c=2;break;default:l=a%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return yb[r.m-1][1];case 5:return yb[r.m-1][0];default:return yb[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return w3[r.q][0];default:return w3[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Us(r.S,t.length):(n>=2?o=n===3?1e3:100:o=n===1?10:1,s=Math.round(o*(r.S+r.u)),s>=60*o&&(s=0),t==="s"?s===0?"0":""+s/o:(i=Us(s,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=a,c=1;break}var u=c>0?Us(l,c):"";return u}function rl(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var F6=/%/g;function tK(e,t,r){var n=t.replace(F6,""),i=t.length-n.length;return ia(e,n,r*Math.pow(10,2*i))+un("%",i)}function rK(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ia(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function M6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+M6(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),r.indexOf("e")===-1){var o=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var D6=/# (\?+)( ?)\/( ?)(\d+)/;function nK(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),s=Math.floor(i/n),o=i-s*n,a=n;return r+(s===0?"":""+s)+" "+(o===0?un(" ",e[1].length+1+e[4].length):iC(o,e[1].length)+e[2]+"/"+e[3]+Us(a,e[4].length))}function iK(e,t,r){return r+(t===0?"":""+t)+un(" ",e[1].length+2+e[4].length)}var P6=/^#*0*\.([0#]+)/,I6=/\).*[0#]/,O6=/\(###\) ###\\?-####/;function yi(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function C3(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function x3(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function sK(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function oK(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function gs(e,t,r){if(e.charCodeAt(0)===40&&!t.match(I6)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?gs("n",n,r):"("+gs("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return rK(e,t,r);if(t.indexOf("%")!==-1)return tK(e,t,r);if(t.indexOf("E")!==-1)return M6(t,r);if(t.charCodeAt(0)===36)return"$"+gs(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+vu(l,t.length);if(t.match(/^[#?]+$/))return i=vu(r,0),i==="0"&&(i=""),i.length>t.length?i:yi(t.substr(0,t.length-i.length))+i;if(s=t.match(D6))return nK(s,l,c);if(t.match(/^#+0+$/))return c+vu(l,t.length-t.indexOf("0"));if(s=t.match(P6))return i=C3(r,s[1].length).replace(/^([^\.]+)$/,"$1."+yi(s[1])).replace(/\.$/,"."+yi(s[1])).replace(/\.(\d*)$/,function(m,v){return"."+v+un("0",yi(s[1]).length-v.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+C3(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+rl(vu(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+gs(e,t,-r):rl(""+(Math.floor(r)+sK(r,s[1].length)))+"."+Us(x3(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return gs(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=td(gs(e,t.replace(/[\\-]/g,""),r)),o=0,td(td(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(O6))return i=gs(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=H0(l,Math.pow(10,o)-1,!1),i=""+c,u=ia("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=L0(a[2],o),u.length<s[4].length&&(u=yi(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=H0(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?iC(a[1],o)+s[2]+"/"+s[3]+L0(a[2],o):un(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=vu(r,0),t.length<=i.length?i:yi(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=t.indexOf(".")-o,d=t.length-i.length-h;return yi(t.substr(0,h)+i+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return o=x3(r,s[1].length),r<0?"-"+gs(e,t,-r):rl(oK(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Us(0,3-m.length):"")+m})+"."+Us(o,s[1].length);switch(t){case"###,##0.00":return gs(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var f=rl(vu(l,0));return f!=="0"?c+f:"";case"###,###.00":return gs(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return gs(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function aK(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return ia(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function lK(e,t,r){var n=t.replace(F6,""),i=t.length-n.length;return ia(e,n,r*Math.pow(10,2*i))+un("%",i)}function N6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+N6(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),r=(t/Math.pow(10,s)).toPrecision(n+1+(i+s)%i),!r.match(/[Ee]/)){var o=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(o-r.length+s):r+="E+"+(o-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(a,l,c,u){return l+c+u.substr(0,(i+s)%i)+"."+u.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function co(e,t,r){if(e.charCodeAt(0)===40&&!t.match(I6)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?co("n",n,r):"("+co("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return aK(e,t,r);if(t.indexOf("%")!==-1)return lK(e,t,r);if(t.indexOf("E")!==-1)return N6(t,r);if(t.charCodeAt(0)===36)return"$"+co(e,t.substr(t.charAt(1)==" "?2:1),r);var i,s,o,a,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Us(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:yi(t.substr(0,t.length-i.length))+i;if(s=t.match(D6))return iK(s,l,c);if(t.match(/^#+0+$/))return c+Us(l,t.length-t.indexOf("0"));if(s=t.match(P6))return i=(""+r).replace(/^([^\.]+)$/,"$1."+yi(s[1])).replace(/\.$/,"."+yi(s[1])),i=i.replace(/\.(\d*)$/,function(m,v){return"."+v+un("0",yi(s[1]).length-v.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+rl(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+co(e,t,-r):rl(""+r)+"."+un("0",s[1].length);if(s=t.match(/^#,#*,#0/))return co(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=td(co(e,t.replace(/[\\-]/g,""),r)),o=0,td(td(t.replace(/\\/g,"")).replace(/[0#]/g,function(m){return o<i.length?i.charAt(o++):m==="0"?"0":""}));if(t.match(O6))return i=co(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(s[4].length,7),a=H0(l,Math.pow(10,o)-1,!1),i=""+c,u=ia("n",s[1],a[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+s[2]+"/"+s[3],u=L0(a[2],o),u.length<s[4].length&&(u=yi(s[4].substr(s[4].length-u.length))+u),i+=u,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(s[1].length,s[4].length),7),a=H0(l,Math.pow(10,o)-1,!0),c+(a[0]||(a[1]?"":"0"))+" "+(a[1]?iC(a[1],o)+s[2]+"/"+s[3]+L0(a[2],o):un(" ",2*o+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:yi(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),o=i.indexOf(".");var h=t.indexOf(".")-o,d=t.length-i.length-h;return yi(t.substr(0,h)+i+t.substr(t.length-d))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+co(e,t,-r):rl(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(m){return"00,"+(m.length<3?Us(0,3-m.length):"")+m})+"."+Us(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var f=rl(""+l);return f!=="0"?c+f:"";default:if(t.match(/\.[0#?]*$/))return co(e,t.slice(0,t.lastIndexOf(".")),r)+yi(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function ia(e,t,r){return(r|0)===r?co(e,t,r):gs(e,t,r)}function cK(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var L6=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ed(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":B0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(L6))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function uK(e,t,r,n){for(var i=[],s="",o=0,a="",l="t",c,u,h,d="H";o<e.length;)switch(a=e.charAt(o)){case"G":if(!B0(e,o))throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"G",v:"General"},o+=7;break;case'"':for(s="";(h=e.charCodeAt(++o))!==34&&o<e.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++o;break;case"\\":var f=e.charAt(++o),m=f==="("||f===")"?f:"t";i[i.length]={t:m,v:f},++o;break;case"_":i[i.length]={t:"t",v:" "},o+=2;break;case"@":i[i.length]={t:"T",v:t},++o;break;case"B":case"b":if(e.charAt(o+1)==="1"||e.charAt(o+1)==="2"){if(c==null&&(c=tc(t,r,e.charAt(o+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(o,2)},l=a,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":a=a.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=tc(t,r),c==null))return"";for(s=a;++o<e.length&&e.charAt(o).toLowerCase()===a;)s+=a;a==="m"&&l.toLowerCase()==="h"&&(a="M"),a==="h"&&(a=d),i[i.length]={t:a,v:s},l=a;break;case"A":case"a":case"":var v={t:a,v:a};if(c==null&&(c=tc(t,r)),e.substr(o,3).toUpperCase()==="A/P"?(c!=null&&(v.v=c.H>=12?"P":"A"),v.t="T",d="h",o+=3):e.substr(o,5).toUpperCase()==="AM/PM"?(c!=null&&(v.v=c.H>=12?"PM":"AM"),v.t="T",o+=5,d="h"):e.substr(o,5).toUpperCase()==="/"?(c!=null&&(v.v=c.H>=12?"":""),v.t="T",o+=5,d="h"):(v.t="t",++o),c==null&&v.t==="T")return"";i[i.length]=v,l=a;break;case"[":for(s=a;e.charAt(o++)!=="]"&&o<e.length;)s+=e.charAt(o);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(L6)){if(c==null&&(c=tc(t,r),c==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ed(e)||(i[i.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=a;++o<e.length&&(a=e.charAt(o))==="0";)s+=a;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=a;++o<e.length&&"0#?.,E+-%".indexOf(a=e.charAt(o))>-1;)s+=a;i[i.length]={t:"n",v:s};break;case"?":for(s=a;e.charAt(++o)===a;)s+=a;i[i.length]={t:a,v:s},l=a;break;case"*":++o,(e.charAt(o)==" "||e.charAt(o)=="*")&&++o;break;case"(":case")":i[i.length]={t:n===1?"t":a,v:a},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=a;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)s+=e.charAt(o);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:a,v:a},++o;break;case"$":i[i.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(a)===-1)throw new Error("unrecognized character "+a+" in "+e);i[i.length]={t:"t",v:a},++o;break}var g=0,w=0,y;for(o=i.length-1,l="t";o>=0;--o)switch(i[o].t){case"h":case"H":i[o].t=d,l="h",g<1&&(g=1);break;case"s":(y=i[o].v.match(/\.0+$/))&&(w=Math.max(w,y[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":l=i[o].t;break;case"m":l==="s"&&(i[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&i[o].v.match(/[Hh]/)&&(g=1),g<2&&i[o].v.match(/[Mm]/)&&(g=2),g<3&&i[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var C="",k;for(o=0;o<i.length;++o)switch(i[o].t){case"t":case"T":case" ":case"D":break;case"X":i[o].v="",i[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[o].v=eK(i[o].t.charCodeAt(0),i[o].v,c,w),i[o].t="t";break;case"n":case"?":for(k=o+1;i[k]!=null&&((a=i[k].t)==="?"||a==="D"||(a===" "||a==="t")&&i[k+1]!=null&&(i[k+1].t==="?"||i[k+1].t==="t"&&i[k+1].v==="/")||i[o].t==="("&&(a===" "||a==="n"||a===")")||a==="t"&&(i[k].v==="/"||i[k].v===" "&&i[k+1]!=null&&i[k+1].t=="?"));)i[o].v+=i[k].v,i[k]={v:"",t:";"},++k;C+=i[o].v,o=k-1;break;case"G":i[o].t="t",i[o].v=Cc(t,r);break}var F="",I,N;if(C.length>0){C.charCodeAt(0)==40?(I=t<0&&C.charCodeAt(0)===45?-t:t,N=ia("n",C,I)):(I=t<0&&n>1?-t:t,N=ia("n",C,I),I<0&&i[0]&&i[0].t=="t"&&(N=N.substr(1),i[0].v="-"+i[0].v)),k=N.length-1;var j=i.length;for(o=0;o<i.length;++o)if(i[o]!=null&&i[o].t!="t"&&i[o].v.indexOf(".")>-1){j=o;break}var L=i.length;if(j===i.length&&N.indexOf("E")===-1){for(o=i.length-1;o>=0;--o)i[o]==null||"n?".indexOf(i[o].t)===-1||(k>=i[o].v.length-1?(k-=i[o].v.length,i[o].v=N.substr(k+1,i[o].v.length)):k<0?i[o].v="":(i[o].v=N.substr(0,k+1),k=-1),i[o].t="t",L=o);k>=0&&L<i.length&&(i[L].v=N.substr(0,k+1)+i[L].v)}else if(j!==i.length&&N.indexOf("E")===-1){for(k=N.indexOf(".")-1,o=j;o>=0;--o)if(!(i[o]==null||"n?".indexOf(i[o].t)===-1)){for(u=i[o].v.indexOf(".")>-1&&o===j?i[o].v.indexOf(".")-1:i[o].v.length-1,F=i[o].v.substr(u+1);u>=0;--u)k>=0&&(i[o].v.charAt(u)==="0"||i[o].v.charAt(u)==="#")&&(F=N.charAt(k--)+F);i[o].v=F,i[o].t="t",L=o}for(k>=0&&L<i.length&&(i[L].v=N.substr(0,k+1)+i[L].v),k=N.indexOf(".")+1,o=j;o<i.length;++o)if(!(i[o]==null||"n?(".indexOf(i[o].t)===-1&&o!==j)){for(u=i[o].v.indexOf(".")>-1&&o===j?i[o].v.indexOf(".")+1:0,F=i[o].v.substr(0,u);u<i[o].v.length;++u)k<N.length&&(F+=N.charAt(k++));i[o].v=F,i[o].t="t",L=o}}}for(o=0;o<i.length;++o)i[o]!=null&&"n?".indexOf(i[o].t)>-1&&(I=n>1&&t<0&&o>0&&i[o-1].v==="-"?-t:t,i[o].v=ia(i[o].t,i[o].v,I),i[o].t="t");var W="";for(o=0;o!==i.length;++o)i[o]!=null&&(W+=i[o].v);return W}var S3=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function _3(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function dK(e,t){var r=cK(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var o=r[0].match(S3),a=r[1].match(S3);return _3(t,o)?[n,r[0]]:_3(t,a)?[n,r[1]]:[n,r[o!=null&&a!=null?2:1]]}return[n,s]}function As(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Gt)[e],n==null&&(n=r.table&&r.table[y3[e]]||Gt[y3[e]]),n==null&&(n=qq[e]||"General");break}if(B0(n,0))return Cc(t,r);t instanceof Date&&(t=A6(t,r.date1904));var i=dK(n,t);if(B0(i[1]))return Cc(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return uK(i[1],t,r,i[0])}function sa(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Gt[r]==null){t<0&&(t=r);continue}if(Gt[r]==e){t=r;break}}t<0&&(t=391)}return Gt[t]=e,t}function vm(e){for(var t=0;t!=392;++t)e[t]!==void 0&&sa(e[t],t)}function Td(){Gt=$q()}var hK={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},B6=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function fK(e){var t=typeof e=="number"?Gt[e]:e;return t=t.replace(B6,"(\\d+)"),new RegExp("^"+t+"$")}function pK(e,t,r){var n=-1,i=-1,s=-1,o=-1,a=-1,l=-1;(t.match(B6)||[]).forEach(function(h,d){var f=parseInt(r[d+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=f;break;case"d":s=f;break;case"h":o=f;break;case"s":l=f;break;case"m":o>=0?a=f:i=f;break}}),l>=0&&a==-1&&i>=0&&(a=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return o==-1&&a==-1&&l==-1?c:n==-1&&i==-1&&s==-1?u:c+"T"+u}var gK=(function(){var e={};e.version="1.2.0";function t(){for(var N=0,j=new Array(256),L=0;L!=256;++L)N=L,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,j[L]=N;return typeof Int32Array<"u"?new Int32Array(j):j}var r=t();function n(N){var j=0,L=0,W=0,K=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)K[W]=N[W];for(W=0;W!=256;++W)for(L=N[W],j=256+W;j<4096;j+=256)L=K[j]=L>>>8^N[L&255];var z=[];for(W=1;W!=16;++W)z[W-1]=typeof Int32Array<"u"?K.subarray(W*256,W*256+256):K.slice(W*256,W*256+256);return z}var i=n(r),s=i[0],o=i[1],a=i[2],l=i[3],c=i[4],u=i[5],h=i[6],d=i[7],f=i[8],m=i[9],v=i[10],g=i[11],w=i[12],y=i[13],C=i[14];function k(N,j){for(var L=j^-1,W=0,K=N.length;W<K;)L=L>>>8^r[(L^N.charCodeAt(W++))&255];return~L}function F(N,j){for(var L=j^-1,W=N.length-15,K=0;K<W;)L=C[N[K++]^L&255]^y[N[K++]^L>>8&255]^w[N[K++]^L>>16&255]^g[N[K++]^L>>>24]^v[N[K++]]^m[N[K++]]^f[N[K++]]^d[N[K++]]^h[N[K++]]^u[N[K++]]^c[N[K++]]^l[N[K++]]^a[N[K++]]^o[N[K++]]^s[N[K++]]^r[N[K++]];for(W+=15;K<W;)L=L>>>8^r[(L^N[K++])&255];return~L}function I(N,j){for(var L=j^-1,W=0,K=N.length,z=0,M=0;W<K;)z=N.charCodeAt(W++),z<128?L=L>>>8^r[(L^z)&255]:z<2048?(L=L>>>8^r[(L^(192|z>>6&31))&255],L=L>>>8^r[(L^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,M=N.charCodeAt(W++)&1023,L=L>>>8^r[(L^(240|z>>8&7))&255],L=L>>>8^r[(L^(128|z>>2&63))&255],L=L>>>8^r[(L^(128|M>>6&15|(z&3)<<4))&255],L=L>>>8^r[(L^(128|M&63))&255]):(L=L>>>8^r[(L^(224|z>>12&15))&255],L=L>>>8^r[(L^(128|z>>6&63))&255],L=L>>>8^r[(L^(128|z&63))&255]);return~L}return e.table=r,e.bstr=k,e.buf=F,e.str=I,e})(),Mt=(function(){var t={};t.version="1.2.1";function r(se,pe){for(var le=se.split("/"),de=pe.split("/"),fe=0,ge=0,Re=Math.min(le.length,de.length);fe<Re;++fe){if(ge=le[fe].length-de[fe].length)return ge;if(le[fe]!=de[fe])return le[fe]<de[fe]?-1:1}return le.length-de.length}function n(se){if(se.charAt(se.length-1)=="/")return se.slice(0,-1).indexOf("/")===-1?se:n(se.slice(0,-1));var pe=se.lastIndexOf("/");return pe===-1?se:se.slice(0,pe+1)}function i(se){if(se.charAt(se.length-1)=="/")return i(se.slice(0,-1));var pe=se.lastIndexOf("/");return pe===-1?se:se.slice(pe+1)}function s(se,pe){typeof pe=="string"&&(pe=new Date(pe));var le=pe.getHours();le=le<<6|pe.getMinutes(),le=le<<5|pe.getSeconds()>>>1,se.write_shift(2,le);var de=pe.getFullYear()-1980;de=de<<4|pe.getMonth()+1,de=de<<5|pe.getDate(),se.write_shift(2,de)}function o(se){var pe=se.read_shift(2)&65535,le=se.read_shift(2)&65535,de=new Date,fe=le&31;le>>>=5;var ge=le&15;le>>>=4,de.setMilliseconds(0),de.setFullYear(le+1980),de.setMonth(ge-1),de.setDate(fe);var Re=pe&31;pe>>>=5;var je=pe&63;return pe>>>=6,de.setHours(pe),de.setMinutes(je),de.setSeconds(Re<<1),de}function a(se){ti(se,0);for(var pe={},le=0;se.l<=se.length-4;){var de=se.read_shift(2),fe=se.read_shift(2),ge=se.l+fe,Re={};de===21589&&(le=se.read_shift(1),le&1&&(Re.mtime=se.read_shift(4)),fe>5&&(le&2&&(Re.atime=se.read_shift(4)),le&4&&(Re.ctime=se.read_shift(4))),Re.mtime&&(Re.mt=new Date(Re.mtime*1e3))),se.l=ge,pe[de]=Re}return pe}var l;function c(){return l||(l={})}function u(se,pe){if(se[0]==80&&se[1]==75)return Ct(se,pe);if((se[0]|32)==109&&(se[1]|32)==105)return At(se,pe);if(se.length<512)throw new Error("CFB file size "+se.length+" < 512");var le=3,de=512,fe=0,ge=0,Re=0,je=0,Me=0,Be=[],Oe=se.slice(0,512);ti(Oe,0);var nt=h(Oe);switch(le=nt[0],le){case 3:de=512;break;case 4:de=4096;break;case 0:if(nt[1]==0)return Ct(se,pe);default:throw new Error("Major Version: Expected 3 or 4 saw "+le)}de!==512&&(Oe=se.slice(0,de),ti(Oe,28));var ct=se.slice(0,de);d(Oe,le);var ft=Oe.read_shift(4,"i");if(le===3&&ft!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ft);Oe.l+=4,Re=Oe.read_shift(4,"i"),Oe.l+=4,Oe.chk("00100000","Mini Stream Cutoff Size: "),je=Oe.read_shift(4,"i"),fe=Oe.read_shift(4,"i"),Me=Oe.read_shift(4,"i"),ge=Oe.read_shift(4,"i");for(var ce=-1,Se=0;Se<109&&(ce=Oe.read_shift(4,"i"),!(ce<0));++Se)Be[Se]=ce;var Le=f(se,de);g(Me,ge,Le,de,Be);var Qe=y(Le,Re,Be,de);Qe[Re].name="!Directory",fe>0&&je!==M&&(Qe[je].name="!MiniFAT"),Qe[Be[0]].name="!FAT",Qe.fat_addrs=Be,Qe.ssz=de;var gt={},ot=[],dt=[],Kt=[];C(Re,Qe,Le,ot,fe,gt,dt,je),m(dt,Kt,ot),ot.shift();var Nt={FileIndex:dt,FullPaths:Kt};return pe&&pe.raw&&(Nt.raw={header:ct,sectors:Le}),Nt}function h(se){if(se[se.l]==80&&se[se.l+1]==75)return[0,0];se.chk(B,"Header Signature: "),se.l+=16;var pe=se.read_shift(2,"u");return[se.read_shift(2,"u"),pe]}function d(se,pe){var le=9;switch(se.l+=2,le=se.read_shift(2)){case 9:if(pe!=3)throw new Error("Sector Shift: Expected 9 saw "+le);break;case 12:if(pe!=4)throw new Error("Sector Shift: Expected 12 saw "+le);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+le)}se.chk("0600","Mini Sector Shift: "),se.chk("000000000000","Reserved: ")}function f(se,pe){for(var le=Math.ceil(se.length/pe)-1,de=[],fe=1;fe<le;++fe)de[fe-1]=se.slice(fe*pe,(fe+1)*pe);return de[le-1]=se.slice(le*pe),de}function m(se,pe,le){for(var de=0,fe=0,ge=0,Re=0,je=0,Me=le.length,Be=[],Oe=[];de<Me;++de)Be[de]=Oe[de]=de,pe[de]=le[de];for(;je<Oe.length;++je)de=Oe[je],fe=se[de].L,ge=se[de].R,Re=se[de].C,Be[de]===de&&(fe!==-1&&Be[fe]!==fe&&(Be[de]=Be[fe]),ge!==-1&&Be[ge]!==ge&&(Be[de]=Be[ge])),Re!==-1&&(Be[Re]=de),fe!==-1&&de!=Be[de]&&(Be[fe]=Be[de],Oe.lastIndexOf(fe)<je&&Oe.push(fe)),ge!==-1&&de!=Be[de]&&(Be[ge]=Be[de],Oe.lastIndexOf(ge)<je&&Oe.push(ge));for(de=1;de<Me;++de)Be[de]===de&&(ge!==-1&&Be[ge]!==ge?Be[de]=Be[ge]:fe!==-1&&Be[fe]!==fe&&(Be[de]=Be[fe]));for(de=1;de<Me;++de)if(se[de].type!==0){if(je=de,je!=Be[je])do je=Be[je],pe[de]=pe[je]+"/"+pe[de];while(je!==0&&Be[je]!==-1&&je!=Be[je]);Be[de]=-1}for(pe[0]+="/",de=1;de<Me;++de)se[de].type!==2&&(pe[de]+="/")}function v(se,pe,le){for(var de=se.start,fe=se.size,ge=[],Re=de;le&&fe>0&&Re>=0;)ge.push(pe.slice(Re*z,Re*z+z)),fe-=z,Re=Zl(le,Re*4);return ge.length===0?Je(0):Vn(ge).slice(0,se.size)}function g(se,pe,le,de,fe){var ge=M;if(se===M){if(pe!==0)throw new Error("DIFAT chain shorter than expected")}else if(se!==-1){var Re=le[se],je=(de>>>2)-1;if(!Re)return;for(var Me=0;Me<je&&(ge=Zl(Re,Me*4))!==M;++Me)fe.push(ge);g(Zl(Re,de-4),pe-1,le,de,fe)}}function w(se,pe,le,de,fe){var ge=[],Re=[];fe||(fe=[]);var je=de-1,Me=0,Be=0;for(Me=pe;Me>=0;){fe[Me]=!0,ge[ge.length]=Me,Re.push(se[Me]);var Oe=le[Math.floor(Me*4/de)];if(Be=Me*4&je,de<4+Be)throw new Error("FAT boundary crossed: "+Me+" 4 "+de);if(!se[Oe])break;Me=Zl(se[Oe],Be)}return{nodes:ge,data:N3([Re])}}function y(se,pe,le,de){var fe=se.length,ge=[],Re=[],je=[],Me=[],Be=de-1,Oe=0,nt=0,ct=0,ft=0;for(Oe=0;Oe<fe;++Oe)if(je=[],ct=Oe+pe,ct>=fe&&(ct-=fe),!Re[ct]){Me=[];var ce=[];for(nt=ct;nt>=0;){ce[nt]=!0,Re[nt]=!0,je[je.length]=nt,Me.push(se[nt]);var Se=le[Math.floor(nt*4/de)];if(ft=nt*4&Be,de<4+ft)throw new Error("FAT boundary crossed: "+nt+" 4 "+de);if(!se[Se]||(nt=Zl(se[Se],ft),ce[nt]))break}ge[ct]={nodes:je,data:N3([Me])}}return ge}function C(se,pe,le,de,fe,ge,Re,je){for(var Me=0,Be=de.length?2:0,Oe=pe[se].data,nt=0,ct=0,ft;nt<Oe.length;nt+=128){var ce=Oe.slice(nt,nt+128);ti(ce,64),ct=ce.read_shift(2),ft=hC(ce,0,ct-Be),de.push(ft);var Se={name:ft,type:ce.read_shift(1),color:ce.read_shift(1),L:ce.read_shift(4,"i"),R:ce.read_shift(4,"i"),C:ce.read_shift(4,"i"),clsid:ce.read_shift(16),state:ce.read_shift(4,"i"),start:0,size:0},Le=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);Le!==0&&(Se.ct=k(ce,ce.l-8));var Qe=ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2)+ce.read_shift(2);Qe!==0&&(Se.mt=k(ce,ce.l-8)),Se.start=ce.read_shift(4,"i"),Se.size=ce.read_shift(4,"i"),Se.size<0&&Se.start<0&&(Se.size=Se.type=0,Se.start=M,Se.name=""),Se.type===5?(Me=Se.start,fe>0&&Me!==M&&(pe[Me].name="!StreamData")):Se.size>=4096?(Se.storage="fat",pe[Se.start]===void 0&&(pe[Se.start]=w(le,Se.start,pe.fat_addrs,pe.ssz)),pe[Se.start].name=Se.name,Se.content=pe[Se.start].data.slice(0,Se.size)):(Se.storage="minifat",Se.size<0?Se.size=0:Me!==M&&Se.start!==M&&pe[Me]&&(Se.content=v(Se,pe[Me].data,(pe[je]||{}).data))),Se.content&&ti(Se.content,0),ge[ft]=Se,Re.push(Se)}}function k(se,pe){return new Date((Ji(se,pe+4)/1e7*Math.pow(2,32)+Ji(se,pe)/1e7-11644473600)*1e3)}function F(se,pe){return c(),u(l.readFileSync(se),pe)}function I(se,pe){var le=pe&&pe.type;switch(le||ar&&Buffer.isBuffer(se)&&(le="buffer"),le||"base64"){case"file":return F(se,pe);case"base64":return u(Qi(is(se)),pe);case"binary":return u(Qi(se),pe)}return u(se,pe)}function N(se,pe){var le=pe||{},de=le.root||"Root Entry";if(se.FullPaths||(se.FullPaths=[]),se.FileIndex||(se.FileIndex=[]),se.FullPaths.length!==se.FileIndex.length)throw new Error("inconsistent CFB structure");se.FullPaths.length===0&&(se.FullPaths[0]=de+"/",se.FileIndex[0]={name:de,type:5}),le.CLSID&&(se.FileIndex[0].clsid=le.CLSID),j(se)}function j(se){var pe="Sh33tJ5";if(!Mt.find(se,"/"+pe)){var le=Je(4);le[0]=55,le[1]=le[3]=50,le[2]=54,se.FileIndex.push({name:pe,type:2,content:le,size:4,L:69,R:69,C:69}),se.FullPaths.push(se.FullPaths[0]+pe),L(se)}}function L(se,pe){N(se);for(var le=!1,de=!1,fe=se.FullPaths.length-1;fe>=0;--fe){var ge=se.FileIndex[fe];switch(ge.type){case 0:de?le=!0:(se.FileIndex.pop(),se.FullPaths.pop());break;case 1:case 2:case 5:de=!0,isNaN(ge.R*ge.L*ge.C)&&(le=!0),ge.R>-1&&ge.L>-1&&ge.R==ge.L&&(le=!0);break;default:le=!0;break}}if(!(!le&&!pe)){var Re=new Date(1987,1,19),je=0,Me=Object.create?Object.create(null):{},Be=[];for(fe=0;fe<se.FullPaths.length;++fe)Me[se.FullPaths[fe]]=!0,se.FileIndex[fe].type!==0&&Be.push([se.FullPaths[fe],se.FileIndex[fe]]);for(fe=0;fe<Be.length;++fe){var Oe=n(Be[fe][0]);de=Me[Oe],de||(Be.push([Oe,{name:i(Oe).replace("/",""),type:1,clsid:S,ct:Re,mt:Re,content:null}]),Me[Oe]=!0)}for(Be.sort(function(ft,ce){return r(ft[0],ce[0])}),se.FullPaths=[],se.FileIndex=[],fe=0;fe<Be.length;++fe)se.FullPaths[fe]=Be[fe][0],se.FileIndex[fe]=Be[fe][1];for(fe=0;fe<Be.length;++fe){var nt=se.FileIndex[fe],ct=se.FullPaths[fe];if(nt.name=i(ct).replace("/",""),nt.L=nt.R=nt.C=-(nt.color=1),nt.size=nt.content?nt.content.length:0,nt.start=0,nt.clsid=nt.clsid||S,fe===0)nt.C=Be.length>1?1:-1,nt.size=0,nt.type=5;else if(ct.slice(-1)=="/"){for(je=fe+1;je<Be.length&&n(se.FullPaths[je])!=ct;++je);for(nt.C=je>=Be.length?-1:je,je=fe+1;je<Be.length&&n(se.FullPaths[je])!=n(ct);++je);nt.R=je>=Be.length?-1:je,nt.type=1}else n(se.FullPaths[fe+1]||"")==n(ct)&&(nt.R=fe+1),nt.type=2}}}function W(se,pe){var le=pe||{};if(le.fileType=="mad")return fr(se,le);if(L(se),le.fileType==="zip")return Ut(se,le);var de=(function(ft){for(var ce=0,Se=0,Le=0;Le<ft.FileIndex.length;++Le){var Qe=ft.FileIndex[Le];if(Qe.content){var gt=Qe.content.length;gt>0&&(gt<4096?ce+=gt+63>>6:Se+=gt+511>>9)}}for(var ot=ft.FullPaths.length+3>>2,dt=ce+7>>3,Kt=ce+127>>7,Nt=dt+Se+ot+Kt,Lt=Nt+127>>7,kt=Lt<=109?0:Math.ceil((Lt-109)/127);Nt+Lt+kt+127>>7>Lt;)kt=++Lt<=109?0:Math.ceil((Lt-109)/127);var qt=[1,kt,Lt,Kt,ot,Se,ce,0];return ft.FileIndex[0].size=ce<<6,qt[7]=(ft.FileIndex[0].start=qt[0]+qt[1]+qt[2]+qt[3]+qt[4]+qt[5])+(qt[6]+7>>3),qt})(se),fe=Je(de[7]<<9),ge=0,Re=0;{for(ge=0;ge<8;++ge)fe.write_shift(1,R[ge]);for(ge=0;ge<8;++ge)fe.write_shift(2,0);for(fe.write_shift(2,62),fe.write_shift(2,3),fe.write_shift(2,65534),fe.write_shift(2,9),fe.write_shift(2,6),ge=0;ge<3;++ge)fe.write_shift(2,0);for(fe.write_shift(4,0),fe.write_shift(4,de[2]),fe.write_shift(4,de[0]+de[1]+de[2]+de[3]-1),fe.write_shift(4,0),fe.write_shift(4,4096),fe.write_shift(4,de[3]?de[0]+de[1]+de[2]-1:M),fe.write_shift(4,de[3]),fe.write_shift(-4,de[1]?de[0]-1:M),fe.write_shift(4,de[1]),ge=0;ge<109;++ge)fe.write_shift(-4,ge<de[2]?de[1]+ge:-1)}if(de[1])for(Re=0;Re<de[1];++Re){for(;ge<236+Re*127;++ge)fe.write_shift(-4,ge<de[2]?de[1]+ge:-1);fe.write_shift(-4,Re===de[1]-1?M:Re+1)}var je=function(ft){for(Re+=ft;ge<Re-1;++ge)fe.write_shift(-4,ge+1);ft&&(++ge,fe.write_shift(-4,M))};for(Re=ge=0,Re+=de[1];ge<Re;++ge)fe.write_shift(-4,_.DIFSECT);for(Re+=de[2];ge<Re;++ge)fe.write_shift(-4,_.FATSECT);je(de[3]),je(de[4]);for(var Me=0,Be=0,Oe=se.FileIndex[0];Me<se.FileIndex.length;++Me)Oe=se.FileIndex[Me],Oe.content&&(Be=Oe.content.length,!(Be<4096)&&(Oe.start=Re,je(Be+511>>9)));for(je(de[6]+7>>3);fe.l&511;)fe.write_shift(-4,_.ENDOFCHAIN);for(Re=ge=0,Me=0;Me<se.FileIndex.length;++Me)Oe=se.FileIndex[Me],Oe.content&&(Be=Oe.content.length,!(!Be||Be>=4096)&&(Oe.start=Re,je(Be+63>>6)));for(;fe.l&511;)fe.write_shift(-4,_.ENDOFCHAIN);for(ge=0;ge<de[4]<<2;++ge){var nt=se.FullPaths[ge];if(!nt||nt.length===0){for(Me=0;Me<17;++Me)fe.write_shift(4,0);for(Me=0;Me<3;++Me)fe.write_shift(4,-1);for(Me=0;Me<12;++Me)fe.write_shift(4,0);continue}Oe=se.FileIndex[ge],ge===0&&(Oe.start=Oe.size?Oe.start-1:M);var ct=ge===0&&le.root||Oe.name;if(Be=2*(ct.length+1),fe.write_shift(64,ct,"utf16le"),fe.write_shift(2,Be),fe.write_shift(1,Oe.type),fe.write_shift(1,Oe.color),fe.write_shift(-4,Oe.L),fe.write_shift(-4,Oe.R),fe.write_shift(-4,Oe.C),Oe.clsid)fe.write_shift(16,Oe.clsid,"hex");else for(Me=0;Me<4;++Me)fe.write_shift(4,0);fe.write_shift(4,Oe.state||0),fe.write_shift(4,0),fe.write_shift(4,0),fe.write_shift(4,0),fe.write_shift(4,0),fe.write_shift(4,Oe.start),fe.write_shift(4,Oe.size),fe.write_shift(4,0)}for(ge=1;ge<se.FileIndex.length;++ge)if(Oe=se.FileIndex[ge],Oe.size>=4096)if(fe.l=Oe.start+1<<9,ar&&Buffer.isBuffer(Oe.content))Oe.content.copy(fe,fe.l,0,Oe.size),fe.l+=Oe.size+511&-512;else{for(Me=0;Me<Oe.size;++Me)fe.write_shift(1,Oe.content[Me]);for(;Me&511;++Me)fe.write_shift(1,0)}for(ge=1;ge<se.FileIndex.length;++ge)if(Oe=se.FileIndex[ge],Oe.size>0&&Oe.size<4096)if(ar&&Buffer.isBuffer(Oe.content))Oe.content.copy(fe,fe.l,0,Oe.size),fe.l+=Oe.size+63&-64;else{for(Me=0;Me<Oe.size;++Me)fe.write_shift(1,Oe.content[Me]);for(;Me&63;++Me)fe.write_shift(1,0)}if(ar)fe.l=fe.length;else for(;fe.l<fe.length;)fe.write_shift(1,0);return fe}function K(se,pe){var le=se.FullPaths.map(function(Me){return Me.toUpperCase()}),de=le.map(function(Me){var Be=Me.split("/");return Be[Be.length-(Me.slice(-1)=="/"?2:1)]}),fe=!1;pe.charCodeAt(0)===47?(fe=!0,pe=le[0].slice(0,-1)+pe):fe=pe.indexOf("/")!==-1;var ge=pe.toUpperCase(),Re=fe===!0?le.indexOf(ge):de.indexOf(ge);if(Re!==-1)return se.FileIndex[Re];var je=!ge.match(Ph);for(ge=ge.replace(Si,""),je&&(ge=ge.replace(Ph,"!")),Re=0;Re<le.length;++Re)if((je?le[Re].replace(Ph,"!"):le[Re]).replace(Si,"")==ge||(je?de[Re].replace(Ph,"!"):de[Re]).replace(Si,"")==ge)return se.FileIndex[Re];return null}var z=64,M=-2,B="d0cf11e0a1b11ae1",R=[208,207,17,224,161,177,26,225],S="00000000000000000000000000000000",_={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:M,FREESECT:-1,HEADER_SIGNATURE:B,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:S,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function T(se,pe,le){c();var de=W(se,le);l.writeFileSync(pe,de)}function E(se){for(var pe=new Array(se.length),le=0;le<se.length;++le)pe[le]=String.fromCharCode(se[le]);return pe.join("")}function D(se,pe){var le=W(se,pe);switch(pe&&pe.type||"buffer"){case"file":return c(),l.writeFileSync(pe.filename,le),le;case"binary":return typeof le=="string"?le:E(le);case"base64":return Cf(typeof le=="string"?le:E(le));case"buffer":if(ar)return Buffer.isBuffer(le)?le:pa(le);case"array":return typeof le=="string"?Qi(le):le}return le}var O;function P(se){try{var pe=se.InflateRaw,le=new pe;if(le._processChunk(new Uint8Array([3,0]),le._finishFlushFlag),le.bytesRead)O=se;else throw new Error("zlib does not expose bytesRead")}catch(de){console.error("cannot use native zlib: "+(de.message||de))}}function q(se,pe){if(!O)return Pt(se,pe);var le=O.InflateRaw,de=new le,fe=de._processChunk(se.slice(se.l),de._finishFlushFlag);return se.l+=de.bytesRead,fe}function X(se){return O?O.deflateRawSync(se):we(se)}var Q=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ee=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function V(se){var pe=(se<<1|se<<11)&139536|(se<<5|se<<15)&558144;return(pe>>16|pe>>8|pe)&255}for(var H=typeof Uint8Array<"u",Z=H?new Uint8Array(256):[],ie=0;ie<256;++ie)Z[ie]=V(ie);function te(se,pe){var le=Z[se&255];return pe<=8?le>>>8-pe:(le=le<<8|Z[se>>8&255],pe<=16?le>>>16-pe:(le=le<<8|Z[se>>16&255],le>>>24-pe))}function oe(se,pe){var le=pe&7,de=pe>>>3;return(se[de]|(le<=6?0:se[de+1]<<8))>>>le&3}function ue(se,pe){var le=pe&7,de=pe>>>3;return(se[de]|(le<=5?0:se[de+1]<<8))>>>le&7}function Ce(se,pe){var le=pe&7,de=pe>>>3;return(se[de]|(le<=4?0:se[de+1]<<8))>>>le&15}function ye(se,pe){var le=pe&7,de=pe>>>3;return(se[de]|(le<=3?0:se[de+1]<<8))>>>le&31}function ne(se,pe){var le=pe&7,de=pe>>>3;return(se[de]|(le<=1?0:se[de+1]<<8))>>>le&127}function me(se,pe,le){var de=pe&7,fe=pe>>>3,ge=(1<<le)-1,Re=se[fe]>>>de;return le<8-de||(Re|=se[fe+1]<<8-de,le<16-de)||(Re|=se[fe+2]<<16-de,le<24-de)||(Re|=se[fe+3]<<24-de),Re&ge}function ve(se,pe,le){var de=pe&7,fe=pe>>>3;return de<=5?se[fe]|=(le&7)<<de:(se[fe]|=le<<de&255,se[fe+1]=(le&7)>>8-de),pe+3}function Te(se,pe,le){var de=pe&7,fe=pe>>>3;return le=(le&1)<<de,se[fe]|=le,pe+1}function xe(se,pe,le){var de=pe&7,fe=pe>>>3;return le<<=de,se[fe]|=le&255,le>>>=8,se[fe+1]=le,pe+8}function Fe(se,pe,le){var de=pe&7,fe=pe>>>3;return le<<=de,se[fe]|=le&255,le>>>=8,se[fe+1]=le&255,se[fe+2]=le>>>8,pe+16}function Ge(se,pe){var le=se.length,de=2*le>pe?2*le:pe+5,fe=0;if(le>=pe)return se;if(ar){var ge=v3(de);if(se.copy)se.copy(ge);else for(;fe<se.length;++fe)ge[fe]=se[fe];return ge}else if(H){var Re=new Uint8Array(de);if(Re.set)Re.set(se);else for(;fe<le;++fe)Re[fe]=se[fe];return Re}return se.length=de,se}function Ve(se){for(var pe=new Array(se),le=0;le<se;++le)pe[le]=0;return pe}function Ye(se,pe,le){var de=1,fe=0,ge=0,Re=0,je=0,Me=se.length,Be=H?new Uint16Array(32):Ve(32);for(ge=0;ge<32;++ge)Be[ge]=0;for(ge=Me;ge<le;++ge)se[ge]=0;Me=se.length;var Oe=H?new Uint16Array(Me):Ve(Me);for(ge=0;ge<Me;++ge)Be[fe=se[ge]]++,de<fe&&(de=fe),Oe[ge]=0;for(Be[0]=0,ge=1;ge<=de;++ge)Be[ge+16]=je=je+Be[ge-1]<<1;for(ge=0;ge<Me;++ge)je=se[ge],je!=0&&(Oe[ge]=Be[je+16]++);var nt=0;for(ge=0;ge<Me;++ge)if(nt=se[ge],nt!=0)for(je=te(Oe[ge],de)>>de-nt,Re=(1<<de+4-nt)-1;Re>=0;--Re)pe[je|Re<<nt]=nt&15|ge<<4;return de}var ut=H?new Uint16Array(512):Ve(512),ht=H?new Uint16Array(32):Ve(32);if(!H){for(var be=0;be<512;++be)ut[be]=0;for(be=0;be<32;++be)ht[be]=0}(function(){for(var se=[],pe=0;pe<32;pe++)se.push(5);Ye(se,ht,32);var le=[];for(pe=0;pe<=143;pe++)le.push(8);for(;pe<=255;pe++)le.push(9);for(;pe<=279;pe++)le.push(7);for(;pe<=287;pe++)le.push(8);Ye(le,ut,288)})();var ze=(function(){for(var pe=H?new Uint8Array(32768):[],le=0,de=0;le<ee.length-1;++le)for(;de<ee[le+1];++de)pe[de]=le;for(;de<32768;++de)pe[de]=29;var fe=H?new Uint8Array(259):[];for(le=0,de=0;le<G.length-1;++le)for(;de<G[le+1];++de)fe[de]=le;function ge(je,Me){for(var Be=0;Be<je.length;){var Oe=Math.min(65535,je.length-Be),nt=Be+Oe==je.length;for(Me.write_shift(1,+nt),Me.write_shift(2,Oe),Me.write_shift(2,~Oe&65535);Oe-- >0;)Me[Me.l++]=je[Be++]}return Me.l}function Re(je,Me){for(var Be=0,Oe=0,nt=H?new Uint16Array(32768):[];Oe<je.length;){var ct=Math.min(65535,je.length-Oe);if(ct<10){for(Be=ve(Me,Be,+(Oe+ct==je.length)),Be&7&&(Be+=8-(Be&7)),Me.l=Be/8|0,Me.write_shift(2,ct),Me.write_shift(2,~ct&65535);ct-- >0;)Me[Me.l++]=je[Oe++];Be=Me.l*8;continue}Be=ve(Me,Be,+(Oe+ct==je.length)+2);for(var ft=0;ct-- >0;){var ce=je[Oe];ft=(ft<<5^ce)&32767;var Se=-1,Le=0;if((Se=nt[ft])&&(Se|=Oe&-32768,Se>Oe&&(Se-=32768),Se<Oe))for(;je[Se+Le]==je[Oe+Le]&&Le<250;)++Le;if(Le>2){ce=fe[Le],ce<=22?Be=xe(Me,Be,Z[ce+1]>>1)-1:(xe(Me,Be,3),Be+=5,xe(Me,Be,Z[ce-23]>>5),Be+=3);var Qe=ce<8?0:ce-4>>2;Qe>0&&(Fe(Me,Be,Le-G[ce]),Be+=Qe),ce=pe[Oe-Se],Be=xe(Me,Be,Z[ce]>>3),Be-=3;var gt=ce<4?0:ce-2>>1;gt>0&&(Fe(Me,Be,Oe-Se-ee[ce]),Be+=gt);for(var ot=0;ot<Le;++ot)nt[ft]=Oe&32767,ft=(ft<<5^je[Oe])&32767,++Oe;ct-=Le-1}else ce<=143?ce=ce+48:Be=Te(Me,Be,1),Be=xe(Me,Be,Z[ce]),nt[ft]=Oe&32767,++Oe}Be=xe(Me,Be,0)-1}return Me.l=(Be+7)/8|0,Me.l}return function(Me,Be){return Me.length<8?ge(Me,Be):Re(Me,Be)}})();function we(se){var pe=Je(50+Math.floor(se.length*1.1)),le=ze(se,pe);return pe.slice(0,le)}var Ee=H?new Uint16Array(32768):Ve(32768),Ie=H?new Uint16Array(32768):Ve(32768),Pe=H?new Uint16Array(128):Ve(128),De=1,Ze=1;function pt(se,pe){var le=ye(se,pe)+257;pe+=5;var de=ye(se,pe)+1;pe+=5;var fe=Ce(se,pe)+4;pe+=4;for(var ge=0,Re=H?new Uint8Array(19):Ve(19),je=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Me=1,Be=H?new Uint8Array(8):Ve(8),Oe=H?new Uint8Array(8):Ve(8),nt=Re.length,ct=0;ct<fe;++ct)Re[Q[ct]]=ge=ue(se,pe),Me<ge&&(Me=ge),Be[ge]++,pe+=3;var ft=0;for(Be[0]=0,ct=1;ct<=Me;++ct)Oe[ct]=ft=ft+Be[ct-1]<<1;for(ct=0;ct<nt;++ct)(ft=Re[ct])!=0&&(je[ct]=Oe[ft]++);var ce=0;for(ct=0;ct<nt;++ct)if(ce=Re[ct],ce!=0){ft=Z[je[ct]]>>8-ce;for(var Se=(1<<7-ce)-1;Se>=0;--Se)Pe[ft|Se<<ce]=ce&7|ct<<3}var Le=[];for(Me=1;Le.length<le+de;)switch(ft=Pe[ne(se,pe)],pe+=ft&7,ft>>>=3){case 16:for(ge=3+oe(se,pe),pe+=2,ft=Le[Le.length-1];ge-- >0;)Le.push(ft);break;case 17:for(ge=3+ue(se,pe),pe+=3;ge-- >0;)Le.push(0);break;case 18:for(ge=11+ne(se,pe),pe+=7;ge-- >0;)Le.push(0);break;default:Le.push(ft),Me<ft&&(Me=ft);break}var Qe=Le.slice(0,le),gt=Le.slice(le);for(ct=le;ct<286;++ct)Qe[ct]=0;for(ct=de;ct<30;++ct)gt[ct]=0;return De=Ye(Qe,Ee,286),Ze=Ye(gt,Ie,30),pe}function yt(se,pe){if(se[0]==3&&!(se[1]&3))return[dl(pe),2];for(var le=0,de=0,fe=v3(pe||1<<18),ge=0,Re=fe.length>>>0,je=0,Me=0;(de&1)==0;){if(de=ue(se,le),le+=3,de>>>1)de>>1==1?(je=9,Me=5):(le=pt(se,le),je=De,Me=Ze);else{le&7&&(le+=8-(le&7));var Be=se[le>>>3]|se[(le>>>3)+1]<<8;if(le+=32,Be>0)for(!pe&&Re<ge+Be&&(fe=Ge(fe,ge+Be),Re=fe.length);Be-- >0;)fe[ge++]=se[le>>>3],le+=8;continue}for(;;){!pe&&Re<ge+32767&&(fe=Ge(fe,ge+32767),Re=fe.length);var Oe=me(se,le,je),nt=de>>>1==1?ut[Oe]:Ee[Oe];if(le+=nt&15,nt>>>=4,(nt>>>8&255)===0)fe[ge++]=nt;else{if(nt==256)break;nt-=257;var ct=nt<8?0:nt-4>>2;ct>5&&(ct=0);var ft=ge+G[nt];ct>0&&(ft+=me(se,le,ct),le+=ct),Oe=me(se,le,Me),nt=de>>>1==1?ht[Oe]:Ie[Oe],le+=nt&15,nt>>>=4;var ce=nt<4?0:nt-2>>1,Se=ee[nt];for(ce>0&&(Se+=me(se,le,ce),le+=ce),!pe&&Re<ft&&(fe=Ge(fe,ft+100),Re=fe.length);ge<ft;)fe[ge]=fe[ge-Se],++ge}}}return pe?[fe,le+7>>>3]:[fe.slice(0,ge),le+7>>>3]}function Pt(se,pe){var le=se.slice(se.l||0),de=yt(le,pe);return se.l+=de[1],de[0]}function $t(se,pe){if(se)typeof console<"u"&&console.error(pe);else throw new Error(pe)}function Ct(se,pe){var le=se;ti(le,0);var de=[],fe=[],ge={FileIndex:de,FullPaths:fe};N(ge,{root:pe.root});for(var Re=le.length-4;(le[Re]!=80||le[Re+1]!=75||le[Re+2]!=5||le[Re+3]!=6)&&Re>=0;)--Re;le.l=Re+4,le.l+=4;var je=le.read_shift(2);le.l+=6;var Me=le.read_shift(4);for(le.l=Me,Re=0;Re<je;++Re){le.l+=20;var Be=le.read_shift(4),Oe=le.read_shift(4),nt=le.read_shift(2),ct=le.read_shift(2),ft=le.read_shift(2);le.l+=8;var ce=le.read_shift(4),Se=a(le.slice(le.l+nt,le.l+nt+ct));le.l+=nt+ct+ft;var Le=le.l;le.l=ce+4,It(le,Be,Oe,ge,Se),le.l=Le}return ge}function It(se,pe,le,de,fe){se.l+=2;var ge=se.read_shift(2),Re=se.read_shift(2),je=o(se);if(ge&8257)throw new Error("Unsupported ZIP encryption");for(var Me=se.read_shift(4),Be=se.read_shift(4),Oe=se.read_shift(4),nt=se.read_shift(2),ct=se.read_shift(2),ft="",ce=0;ce<nt;++ce)ft+=String.fromCharCode(se[se.l++]);if(ct){var Se=a(se.slice(se.l,se.l+ct));(Se[21589]||{}).mt&&(je=Se[21589].mt),((fe||{})[21589]||{}).mt&&(je=fe[21589].mt)}se.l+=ct;var Le=se.slice(se.l,se.l+Be);switch(Re){case 8:Le=q(se,Oe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Re)}var Qe=!1;ge&8&&(Me=se.read_shift(4),Me==134695760&&(Me=se.read_shift(4),Qe=!0),Be=se.read_shift(4),Oe=se.read_shift(4)),Be!=pe&&$t(Qe,"Bad compressed size: "+pe+" != "+Be),Oe!=le&&$t(Qe,"Bad uncompressed size: "+le+" != "+Oe),Ot(de,ft,Le,{unsafe:!0,mt:je})}function Ut(se,pe){var le=pe||{},de=[],fe=[],ge=Je(1),Re=le.compression?8:0,je=0,Me=0,Be=0,Oe=0,nt=0,ct=se.FullPaths[0],ft=ct,ce=se.FileIndex[0],Se=[],Le=0;for(Me=1;Me<se.FullPaths.length;++Me)if(ft=se.FullPaths[Me].slice(ct.length),ce=se.FileIndex[Me],!(!ce.size||!ce.content||ft=="Sh33tJ5")){var Qe=Oe,gt=Je(ft.length);for(Be=0;Be<ft.length;++Be)gt.write_shift(1,ft.charCodeAt(Be)&127);gt=gt.slice(0,gt.l),Se[nt]=gK.buf(ce.content,0);var ot=ce.content;Re==8&&(ot=X(ot)),ge=Je(30),ge.write_shift(4,67324752),ge.write_shift(2,20),ge.write_shift(2,je),ge.write_shift(2,Re),ce.mt?s(ge,ce.mt):ge.write_shift(4,0),ge.write_shift(-4,Se[nt]),ge.write_shift(4,ot.length),ge.write_shift(4,ce.content.length),ge.write_shift(2,gt.length),ge.write_shift(2,0),Oe+=ge.length,de.push(ge),Oe+=gt.length,de.push(gt),Oe+=ot.length,de.push(ot),ge=Je(46),ge.write_shift(4,33639248),ge.write_shift(2,0),ge.write_shift(2,20),ge.write_shift(2,je),ge.write_shift(2,Re),ge.write_shift(4,0),ge.write_shift(-4,Se[nt]),ge.write_shift(4,ot.length),ge.write_shift(4,ce.content.length),ge.write_shift(2,gt.length),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(4,0),ge.write_shift(4,Qe),Le+=ge.l,fe.push(ge),Le+=gt.length,fe.push(gt),++nt}return ge=Je(22),ge.write_shift(4,101010256),ge.write_shift(2,0),ge.write_shift(2,0),ge.write_shift(2,nt),ge.write_shift(2,nt),ge.write_shift(4,Le),ge.write_shift(4,Oe),ge.write_shift(2,0),Vn([Vn(de),Vn(fe),ge])}var _t={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function sr(se,pe){if(se.ctype)return se.ctype;var le=se.name||"",de=le.match(/\.([^\.]+)$/);return de&&_t[de[1]]||pe&&(de=(le=pe).match(/[\.\\]([^\.\\])+$/),de&&_t[de[1]])?_t[de[1]]:"application/octet-stream"}function Jt(se){for(var pe=Cf(se),le=[],de=0;de<pe.length;de+=76)le.push(pe.slice(de,de+76));return le.join(`\r
`)+`\r
`}function Tt(se){var pe=se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Be){var Oe=Be.charCodeAt(0).toString(16).toUpperCase();return"="+(Oe.length==1?"0"+Oe:Oe)});pe=pe.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),pe.charAt(0)==`
`&&(pe="=0D"+pe.slice(1)),pe=pe.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var le=[],de=pe.split(`\r
`),fe=0;fe<de.length;++fe){var ge=de[fe];if(ge.length==0){le.push("");continue}for(var Re=0;Re<ge.length;){var je=76,Me=ge.slice(Re,Re+je);Me.charAt(je-1)=="="?je--:Me.charAt(je-2)=="="?je-=2:Me.charAt(je-3)=="="&&(je-=3),Me=ge.slice(Re,Re+je),Re+=je,Re<ge.length&&(Me+="="),le.push(Me)}}return le.join(`\r
`)}function nr(se){for(var pe=[],le=0;le<se.length;++le){for(var de=se[le];le<=se.length&&de.charAt(de.length-1)=="=";)de=de.slice(0,de.length-1)+se[++le];pe.push(de)}for(var fe=0;fe<pe.length;++fe)pe[fe]=pe[fe].replace(/[=][0-9A-Fa-f]{2}/g,function(ge){return String.fromCharCode(parseInt(ge.slice(1),16))});return Qi(pe.join(`\r
`))}function vr(se,pe,le){for(var de="",fe="",ge="",Re,je=0;je<10;++je){var Me=pe[je];if(!Me||Me.match(/^\s*$/))break;var Be=Me.match(/^(.*?):\s*([^\s].*)$/);if(Be)switch(Be[1].toLowerCase()){case"content-location":de=Be[2].trim();break;case"content-type":ge=Be[2].trim();break;case"content-transfer-encoding":fe=Be[2].trim();break}}switch(++je,fe.toLowerCase()){case"base64":Re=Qi(is(pe.slice(je).join("")));break;case"quoted-printable":Re=nr(pe.slice(je));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+fe)}var Oe=Ot(se,de.slice(le.length),Re,{unsafe:!0});ge&&(Oe.ctype=ge)}function At(se,pe){if(E(se.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var le=pe&&pe.root||"",de=(ar&&Buffer.isBuffer(se)?se.toString("binary"):E(se)).split(`\r
`),fe=0,ge="";for(fe=0;fe<de.length;++fe)if(ge=de[fe],!!/^Content-Location:/i.test(ge)&&(ge=ge.slice(ge.indexOf("file")),le||(le=ge.slice(0,ge.lastIndexOf("/")+1)),ge.slice(0,le.length)!=le))for(;le.length>0&&(le=le.slice(0,le.length-1),le=le.slice(0,le.lastIndexOf("/")+1),ge.slice(0,le.length)!=le););var Re=(de[1]||"").match(/boundary="(.*?)"/);if(!Re)throw new Error("MAD cannot find boundary");var je="--"+(Re[1]||""),Me=[],Be=[],Oe={FileIndex:Me,FullPaths:Be};N(Oe);var nt,ct=0;for(fe=0;fe<de.length;++fe){var ft=de[fe];ft!==je&&ft!==je+"--"||(ct++&&vr(Oe,de.slice(nt,fe),le),nt=fe)}return Oe}function fr(se,pe){var le=pe||{},de=le.boundary||"SheetJS";de="------="+de;for(var fe=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+de.slice(2)+'"',"","",""],ge=se.FullPaths[0],Re=ge,je=se.FileIndex[0],Me=1;Me<se.FullPaths.length;++Me)if(Re=se.FullPaths[Me].slice(ge.length),je=se.FileIndex[Me],!(!je.size||!je.content||Re=="Sh33tJ5")){Re=Re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Le){return"_x"+Le.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Le){return"_u"+Le.charCodeAt(0).toString(16)+"_"});for(var Be=je.content,Oe=ar&&Buffer.isBuffer(Be)?Be.toString("binary"):E(Be),nt=0,ct=Math.min(1024,Oe.length),ft=0,ce=0;ce<=ct;++ce)(ft=Oe.charCodeAt(ce))>=32&&ft<128&&++nt;var Se=nt>=ct*4/5;fe.push(de),fe.push("Content-Location: "+(le.root||"file:///C:/SheetJS/")+Re),fe.push("Content-Transfer-Encoding: "+(Se?"quoted-printable":"base64")),fe.push("Content-Type: "+sr(je,Re)),fe.push(""),fe.push(Se?Tt(Oe):Jt(Oe))}return fe.push(de+`--\r
`),fe.join(`\r
`)}function yr(se){var pe={};return N(pe,se),pe}function Ot(se,pe,le,de){var fe=de&&de.unsafe;fe||N(se);var ge=!fe&&Mt.find(se,pe);if(!ge){var Re=se.FullPaths[0];pe.slice(0,Re.length)==Re?Re=pe:(Re.slice(-1)!="/"&&(Re+="/"),Re=(Re+pe).replace("//","/")),ge={name:i(pe),type:2},se.FileIndex.push(ge),se.FullPaths.push(Re),fe||Mt.utils.cfb_gc(se)}return ge.content=le,ge.size=le?le.length:0,de&&(de.CLSID&&(ge.clsid=de.CLSID),de.mt&&(ge.mt=de.mt),de.ct&&(ge.ct=de.ct)),ge}function ke(se,pe){N(se);var le=Mt.find(se,pe);if(le){for(var de=0;de<se.FileIndex.length;++de)if(se.FileIndex[de]==le)return se.FileIndex.splice(de,1),se.FullPaths.splice(de,1),!0}return!1}function He(se,pe,le){N(se);var de=Mt.find(se,pe);if(de){for(var fe=0;fe<se.FileIndex.length;++fe)if(se.FileIndex[fe]==de)return se.FileIndex[fe].name=i(le),se.FullPaths[fe]=le,!0}return!1}function Xe(se){L(se,!0)}return t.find=K,t.read=I,t.parse=u,t.write=D,t.writeFile=T,t.utils={cfb_new:yr,cfb_add:Ot,cfb_del:ke,cfb_mov:He,cfb_gc:Xe,ReadShift:Kh,CheckField:o5,prep_blob:ti,bconcat:Vn,use_zlib:P,_deflateRaw:we,_inflateRaw:Pt,consts:_},t})();function mK(e){return typeof e=="string"?mm(e):Array.isArray(e)?Gq(e):e}function Xf(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=mm(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?xo(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([mK(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=e,o.href=s,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var a=File(e);return a.open("w"),a.encoding="binary",Array.isArray(t)&&(t=Cl(t)),a.write(t),a.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function vK(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function hn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function E3(e,t){for(var r=[],n=hn(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function bm(e){for(var t=[],r=hn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function wm(e){for(var t=[],r=hn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function bK(e){for(var t=[],r=hn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var j0=new Date(1899,11,30,0,0,0);function Ln(e,t){var r=e.getTime(),n=j0.getTime()+(e.getTimezoneOffset()-j0.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var H6=new Date,wK=j0.getTime()+(H6.getTimezoneOffset()-j0.getTimezoneOffset())*6e4,T3=H6.getTimezoneOffset();function ym(e){var t=new Date;return t.setTime(e*24*60*60*1e3+wK),t.getTimezoneOffset()!==T3&&t.setTime(t.getTime()+(t.getTimezoneOffset()-T3)*6e4),t}function yK(e){var t=0,r=0,n=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(r=1,s>3&&(n=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(i[s],10)}return t}var k3=new Date("2017-02-19T19:06:09.000Z"),j6=isNaN(k3.getFullYear())?new Date("2/19/17"):k3,CK=j6.getFullYear()==2017;function Zr(e,t){var r=new Date(e);if(CK)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(j6.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function xc(e,t){if(ar&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return xo(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return xo(k6(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return xo(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return xo(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return r[s]||s})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function Jr(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Jr(e[r]));return t}function un(e,t){for(var r="";r.length<t;)r+=e;return r}function $s(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var xK=["january","february","march","april","may","june","july","august","september","october","november","december"];function pd(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var o=e.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&xK.indexOf(o)==-1)return r}else if(o.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var SK=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,i){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),o=[s[0]],a=1;a<s.length;++a)o.push(i),o.push(s[a]);return o}})();function V6(e){return e?e.content&&e.type?xc(e.content,!0):e.data?Dh(e.data):e.asNodeBuffer&&ar?Dh(e.asNodeBuffer().toString("binary")):e.asBinary?Dh(e.asBinary()):e._data&&e._data.getContent?Dh(xc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function G6(e){if(!e)return null;if(e.data)return g3(e.data);if(e.asNodeBuffer&&ar)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?g3(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function _K(e){return e&&e.name.slice(-4)===".bin"?G6(e):V6(e)}function ys(e,t){for(var r=e.FullPaths||hn(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),i=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var o=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==o||i==o)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function oC(e,t){var r=ys(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Fn(e,t,r){if(!r)return _K(oC(e,t));if(!t)return null;try{return Fn(e,t)}catch{return null}}function es(e,t,r){if(!r)return V6(oC(e,t));if(!t)return null;try{return es(e,t)}catch{return null}}function EK(e,t,r){return G6(oC(e,t))}function R3(e){for(var t=e.FullPaths||hn(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function rr(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ar?n=pa(r):n=zq(r),Mt.utils.cfb_add(e,t,n)}Mt.utils.cfb_add(e,t,r)}else e.file(t,r)}function aC(){return Mt.utils.cfb_new()}function z6(e,t){switch(t.type){case"base64":return Mt.read(e,{type:"base64"});case"binary":return Mt.read(e,{type:"binary"});case"buffer":case"array":return Mt.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function Ih(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var i=n.shift();i===".."?r.pop():i!=="."&&r.push(i)}return r.join("/")}var _n=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,TK=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,A3=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,kK=/<[^>]*>/g,vi=_n.match(A3)?A3:kK,RK=/<\w*:/,AK=/<(\/?)\w+:/;function Wt(e,t,r){for(var n={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(n[0]=e.slice(0,i)),i===e.length)return n;var o=e.match(TK),a=0,l="",c=0,u="",h="",d=1;if(o)for(c=0;c!=o.length;++c){for(h=o[c],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(u=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(d=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+d,h.length-d),a=0;a!=u.length&&u.charCodeAt(a)!==58;++a);if(a===u.length)u.indexOf("_")>0&&(u=u.slice(0,u.indexOf("_"))),n[u]=l,n[u.toLowerCase()]=l;else{var f=(a===5&&u.slice(0,5)==="xmlns"?"xmlns":"")+u.slice(a+1);if(n[f]&&u.slice(a-3,a)=="ext")continue;n[f]=l,n[f.toLowerCase()]=l}}return n}function Ro(e){return e.replace(AK,"<$1")}var U6={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},lC=bm(U6),xr=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var i=n+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(a,l){return U6[a]||String.fromCharCode(parseInt(l,a.indexOf("x")>-1?16:10))||a}).replace(t,function(a,l){return String.fromCharCode(parseInt(l,16))});var o=i.indexOf("]]>");return r(i.slice(0,s))+i.slice(s+9,o)+r(i.slice(o+3))}})(),cC=/[&<>'"]/g,FK=/[\u0000-\u0008\u000b-\u001f]/g;function Br(e){var t=e+"";return t.replace(cC,function(r){return lC[r]}).replace(FK,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function F3(e){return Br(e).replace(/ /g,"_x0020_")}var W6=/[\u0000-\u001f]/g;function uC(e){var t=e+"";return t.replace(cC,function(r){return lC[r]}).replace(/\n/g,"<br/>").replace(W6,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function MK(e){var t=e+"";return t.replace(cC,function(r){return lC[r]}).replace(W6,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var M3=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function DK(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function Xr(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Cb(e){for(var t="",r=0,n=0,i=0,s=0,o=0,a=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){o=(n&31)<<6,o|=i&63,t+=String.fromCharCode(o);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|s&63);continue}o=e.charCodeAt(r++),a=((n&7)<<18|(i&63)<<12|(s&63)<<6|o&63)-65536,t+=String.fromCharCode(55296+(a>>>10&1023)),t+=String.fromCharCode(56320+(a&1023))}return t}function D3(e){var t=dl(2*e.length),r,n,i=1,s=0,o=0,a;for(n=0;n<e.length;n+=i)i=1,(a=e.charCodeAt(n))<128?r=a:a<224?(r=(a&31)*64+(e.charCodeAt(n+1)&63),i=2):a<240?(r=(a&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(a&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,o=55296+(r>>>10&1023),r=56320+(r&1023)),o!==0&&(t[s++]=o&255,t[s++]=o>>>8,o=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function P3(e){return pa(e,"binary").toString("utf8")}var Tg="foo bar baz",Ur=ar&&(P3(Tg)==Cb(Tg)&&P3||D3(Tg)==Cb(Tg)&&D3)||Cb,xo=ar?function(e){return pa(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Sf=(function(){var e={};return function(r,n){var i=r+"|"+(n||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),$6=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}})(),PK=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),IK=/<\/?(?:vt:)?variant>/g,OK=/<(?:vt:)([^>]*)>([\s\S]*)</;function I3(e,t){var r=Wt(e),n=e.match(PK(r.baseType))||[],i=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return i}return n.forEach(function(s){var o=s.replace(IK,"").match(OK);o&&i.push({v:Ur(o[2]),t:o[1]})}),i}var q6=/(^\s|\s$|\n)/;function ri(e,t){return"<"+e+(t.match(q6)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function _f(e){return hn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function mt(e,t,r){return"<"+e+(r!=null?_f(r):"")+(t!=null?(t.match(q6)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Aw(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function NK(e,t){switch(typeof e){case"string":var r=mt("vt:lpwstr",Br(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return mt((e|0)==e?"vt:i4":"vt:r8",Br(String(e)));case"boolean":return mt("vt:bool",e?"true":"false")}if(e instanceof Date)return mt("vt:filetime",Aw(e));throw new Error("Unable to serialize "+e)}function dC(e){if(ar&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return Ur(Cl(nC(e)));throw new Error("Bad input format: expected Buffer or string")}var Ef=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Nn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Pc=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Zi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function LK(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function BK(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,o=n?-t:t;isFinite(o)?o==0?i=s=0:(i=Math.floor(Math.log(o)/Math.LN2),s=o*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var a=0;a<=5;++a,s/=256)e[r+a]=s&255;e[r+6]=(i&15)<<4|s&15,e[r+7]=i>>4|n}var O3=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,s=e[0][n].length;i<s;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},N3=ar?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:pa(t)})):O3(e)}:O3,L3=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(Qo(e,i)));return n.join("").replace(Si,"")},hC=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Si,""):L3(e,t,r)}:L3,B3=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},K6=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):B3(e,t,r)}:B3,H3=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(Ru(e,i)));return n.join("")},Yf=ar?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):H3(t,r,n)}:H3,X6=function(e,t){var r=Ji(e,t);return r>0?Yf(e,t+4,t+4+r-1):""},Y6=X6,Z6=function(e,t){var r=Ji(e,t);return r>0?Yf(e,t+4,t+4+r-1):""},J6=Z6,Q6=function(e,t){var r=2*Ji(e,t);return r>0?Yf(e,t+4,t+4+r-1):""},e5=Q6,t5=function(t,r){var n=Ji(t,r);return n>0?hC(t,r+4,r+4+n):""},r5=t5,n5=function(e,t){var r=Ji(e,t);return r>0?Yf(e,t+4,t+4+r):""},i5=n5,s5=function(e,t){return LK(e,t)},V0=s5,fC=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ar&&(Y6=function(t,r){if(!Buffer.isBuffer(t))return X6(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},J6=function(t,r){if(!Buffer.isBuffer(t))return Z6(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},e5=function(t,r){if(!Buffer.isBuffer(t))return Q6(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},r5=function(t,r){if(!Buffer.isBuffer(t))return t5(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},i5=function(t,r){if(!Buffer.isBuffer(t))return n5(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},V0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):s5(t,r)},fC=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Ru=function(e,t){return e[t]},Qo=function(e,t){return e[t+1]*256+e[t]},HK=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Ji=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Zl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},jK=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Kh(e,t){var r="",n,i,s=[],o,a,l,c;switch(t){case"dbcs":if(c=this.l,ar&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Qo(this,c)),c+=2;e*=2;break;case"utf8":r=Yf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=hC(this,this.l,this.l+e);break;case"wstr":return Kh.call(this,e,"dbcs");case"lpstr-ansi":r=Y6(this,this.l),e=4+Ji(this,this.l);break;case"lpstr-cp":r=J6(this,this.l),e=4+Ji(this,this.l);break;case"lpwstr":r=e5(this,this.l),e=4+2*Ji(this,this.l);break;case"lpp4":e=4+Ji(this,this.l),r=r5(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Ji(this,this.l),r=i5(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(o=Ru(this,this.l+e++))!==0;)s.push(Eg(o));r=s.join("");break;case"_wstr":for(e=0,r="";(o=Qo(this,this.l+e))!==0;)s.push(Eg(o)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Ru(this,c),this.l=c+1,a=Kh.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(Eg(Qo(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return o=Ru(this,c),this.l=c+1,a=Kh.call(this,e-l,o?"dbcs-cont":"sbcs-cont"),s.join("")+a;s.push(Eg(Ru(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Ru(this,this.l),this.l++,n;case 2:return n=(t==="i"?HK:Qo)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?Zl:jK)(this,this.l),this.l+=4,n):(i=Ji(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=V0(this,this.l):i=V0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=K6(this,this.l,e);break}}return this.l+=e,r}var VK=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},GK=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},zK=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function UK(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)zK(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var o=t.charCodeAt(i);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,VK(this,t,this.l);break;case 8:if(n=8,r==="f"){BK(this,t,this.l);break}case 16:break;case-4:n=4,GK(this,t,this.l);break}return this.l+=n,this}function o5(e,t){var r=K6(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function ti(e,t){e.l=t,e.read_shift=Kh,e.chk=o5,e.write_shift=UK}function gi(e,t){e.l+=t}function Je(e){var t=dl(e);return ti(t,0),t}function ga(e,t,r){if(e){var n,i,s;ti(e,e.l||0);for(var o=e.length,a=0,l=0;e.l<o;){a=e.read_shift(1),a&128&&(a=(a&127)+((e.read_shift(1)&127)<<7));var c=Mf[a]||Mf[65535];for(n=e.read_shift(1),s=n&127,i=1;i<4&&n&128;++i)s+=((n=e.read_shift(1))&127)<<7*i;l=e.l+s;var u=c.f&&c.f(e,s,r);if(e.l=l,t(u,c,a))return}}}function Bi(){var e=[],t=ar?256:2048,r=function(c){var u=Je(c);return ti(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},o=function(){return i(),Vn(e)},a=function(c){i(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:a,end:o,_bufs:e}}function lt(e,t,r,n){var i=+t,s;if(!isNaN(i)){n||(n=Mf[i].p||(r||[]).length||0),s=1+(i>=128?1:0)+1,n>=128&&++s,n>=16384&&++s,n>=2097152&&++s;var o=e.next(s);i<=127?o.write_shift(1,i):(o.write_shift(1,(i&127)+128),o.write_shift(1,i>>7));for(var a=0;a!=4;++a)if(n>=128)o.write_shift(1,(n&127)+128),n>>=7;else{o.write_shift(1,n);break}n>0&&fC(r)&&e.push(r)}}function Xh(e,t,r){var n=Jr(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function j3(e,t,r){var n=Jr(e);return n.s=Xh(n.s,t.s,r),n.e=Xh(n.e,t.s,r),n}function Yh(e,t){if(e.cRel&&e.c<0)for(e=Jr(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Jr(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=zt(e);return!e.cRel&&e.cRel!=null&&(r=qK(r)),!e.rRel&&e.rRel!=null&&(r=WK(r)),r}function xb(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+sn(e.s.c)+":"+(e.e.cRel?"":"$")+sn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Sn(e.s.r)+":"+(e.e.rRel?"":"$")+Sn(e.e.r):Yh(e.s,t.biff)+":"+Yh(e.e,t.biff)}function pC(e){return parseInt($K(e),10)-1}function Sn(e){return""+(e+1)}function WK(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function $K(e){return e.replace(/\$(\d+)$/,"$1")}function gC(e){for(var t=KK(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function sn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function qK(e){return e.replace(/^([A-Z])/,"$$$1")}function KK(e){return e.replace(/^\$([A-Z])/,"$1")}function XK(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function on(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function zt(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Vi(e){var t=e.indexOf(":");return t==-1?{s:on(e),e:on(e)}:{s:on(e.slice(0,t)),e:on(e.slice(t+1))}}function er(e,t){return typeof t>"u"||typeof t=="number"?er(e.s,e.e):(typeof e!="string"&&(e=zt(e)),typeof t!="string"&&(t=zt(t)),e==t?e:e+":"+t)}function Sr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,s=e.length;for(r=0;n<s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=s&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function V3(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=As(e.z,r?Ln(t):t)}catch{}try{return e.w=As((e.XF||{}).numFmtId||(r?14:0),r?Ln(t):t)}catch{return""+t}}function ua(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?ma[e.v]||e.v:t==null?V3(e,e.v):V3(e,t))}function xl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function a5(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,s=e||(i?[]:{}),o=0,a=0;if(s&&n.origin!=null){if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?on(n.origin):n.origin;o=l.r,a=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var u=Sr(s["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),o==-1&&(c.e.r=o=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var d=0;d!=t[h].length;++d)if(!(typeof t[h][d]>"u")){var f={v:t[h][d]},m=o+h,v=a+d;if(c.s.r>m&&(c.s.r=m),c.s.c>v&&(c.s.c=v),c.e.r<m&&(c.e.r=m),c.e.c<v&&(c.e.c=v),t[h][d]&&typeof t[h][d]=="object"&&!Array.isArray(t[h][d])&&!(t[h][d]instanceof Date))f=t[h][d];else if(Array.isArray(f.v)&&(f.f=t[h][d][1],f.v=f.v[0]),f.v===null)if(f.f)f.t="n";else if(n.nullError)f.t="e",f.v=0;else if(n.sheetStubs)f.t="z";else continue;else typeof f.v=="number"?f.t="n":typeof f.v=="boolean"?f.t="b":f.v instanceof Date?(f.z=n.dateNF||Gt[14],n.cellDates?(f.t="d",f.w=As(f.z,Ln(f.v))):(f.t="n",f.v=Ln(f.v),f.w=As(f.z,f.v))):f.t="s";if(i)s[m]||(s[m]=[]),s[m][v]&&s[m][v].z&&(f.z=s[m][v].z),s[m][v]=f;else{var g=zt({c:v,r:m});s[g]&&s[g].z&&(f.z=s[g].z),s[g]=f}}}return c.s.c<1e7&&(s["!ref"]=er(c)),s}function kd(e,t){return a5(null,e,t)}function YK(e){return e.read_shift(4,"i")}function qs(e,t){return t||(t=Je(4)),t.write_shift(4,e),t}function pi(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Un(e,t){var r=!1;return t==null&&(r=!0,t=Je(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function ZK(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function JK(e,t){return t||(t=Je(4)),t.write_shift(2,0),t.write_shift(2,0),t}function mC(e,t){var r=e.l,n=e.read_shift(1),i=pi(e),s=[],o={t:i,h:i};if((n&1)!==0){for(var a=e.read_shift(4),l=0;l!=a;++l)s.push(ZK(e));o.r=s}else o.r=[{ich:0,ifnt:0}];return e.l=r+t,o}function QK(e,t){var r=!1;return t==null&&(r=!0,t=Je(15+4*e.t.length)),t.write_shift(1,0),Un(e.t,t),r?t.slice(0,t.l):t}var eX=mC;function tX(e,t){var r=!1;return t==null&&(r=!0,t=Je(23+4*e.t.length)),t.write_shift(1,1),Un(e.t,t),t.write_shift(4,1),JK({},t),r?t.slice(0,t.l):t}function Ms(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Ic(e,t){return t==null&&(t=Je(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Oc(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Nc(e,t){return t==null&&(t=Je(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var rX=pi,l5=Un;function vC(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function G0(e,t){var r=!1;return t==null&&(r=!0,t=Je(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var nX=pi,Fw=vC,bC=G0;function wC(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?V0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Zl(t,0)>>2;return r?i/100:i}function c5(e,t){t==null&&(t=Je(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function u5(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function iX(e,t){return t||(t=Je(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Lc=u5,Rd=iX;function fi(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Sc(e,t){return(t||Je(8)).write_shift(8,e,"f")}function sX(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),o=e.read_shift(1),a=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=uc[i];c&&(t.rgb=kf(c));break;case 2:t.rgb=kf([o,a,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function z0(e,t){if(t||(t=Je(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function oX(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function aX(e,t){t||(t=Je(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function d5(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function lX(e){return d5(e,1)}function cX(e){return d5(e,2)}var yC=2,Pi=3,kg=11,G3=12,U0=19,Rg=64,uX=65,dX=71,hX=4108,fX=4126,jn=80,h5=81,pX=[jn,h5],Mw={1:{n:"CodePage",t:yC},2:{n:"Category",t:jn},3:{n:"PresentationFormat",t:jn},4:{n:"ByteCount",t:Pi},5:{n:"LineCount",t:Pi},6:{n:"ParagraphCount",t:Pi},7:{n:"SlideCount",t:Pi},8:{n:"NoteCount",t:Pi},9:{n:"HiddenCount",t:Pi},10:{n:"MultimediaClipCount",t:Pi},11:{n:"ScaleCrop",t:kg},12:{n:"HeadingPairs",t:hX},13:{n:"TitlesOfParts",t:fX},14:{n:"Manager",t:jn},15:{n:"Company",t:jn},16:{n:"LinksUpToDate",t:kg},17:{n:"CharacterCount",t:Pi},19:{n:"SharedDoc",t:kg},22:{n:"HyperlinksChanged",t:kg},23:{n:"AppVersion",t:Pi,p:"version"},24:{n:"DigSig",t:uX},26:{n:"ContentType",t:jn},27:{n:"ContentStatus",t:jn},28:{n:"Language",t:jn},29:{n:"Version",t:jn},255:{},2147483648:{n:"Locale",t:U0},2147483651:{n:"Behavior",t:U0},1919054434:{}},Dw={1:{n:"CodePage",t:yC},2:{n:"Title",t:jn},3:{n:"Subject",t:jn},4:{n:"Author",t:jn},5:{n:"Keywords",t:jn},6:{n:"Comments",t:jn},7:{n:"Template",t:jn},8:{n:"LastAuthor",t:jn},9:{n:"RevNumber",t:jn},10:{n:"EditTime",t:Rg},11:{n:"LastPrinted",t:Rg},12:{n:"CreatedDate",t:Rg},13:{n:"ModifiedDate",t:Rg},14:{n:"PageCount",t:Pi},15:{n:"WordCount",t:Pi},16:{n:"CharCount",t:Pi},17:{n:"Thumbnail",t:dX},18:{n:"Application",t:jn},19:{n:"DocSecurity",t:Pi},255:{},2147483648:{n:"Locale",t:U0},2147483651:{n:"Behavior",t:U0},1919054434:{}},z3={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},gX=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function mX(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var vX=mX([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),uc=Jr(vX),ma={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},f5={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Pw={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ag={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function CC(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bX(e){var t=CC();if(!e||!e.match)return t;var r={};if((e.match(vi)||[]).forEach(function(n){var i=Wt(n);switch(i[0].replace(RK,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[i.Extension]=i.ContentType;break;case"<Override":t[Pw[i.ContentType]]!==void 0&&t[Pw[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Nn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function p5(e,t){var r=bK(Pw),n=[],i;n[n.length]=_n,n[n.length]=mt("Types",null,{xmlns:Nn.CT,"xmlns:xsd":Nn.xsd,"xmlns:xsi":Nn.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return mt("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=mt("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Ag[l][t.bookType]||Ag[l].xlsx}))},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=mt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:Ag[l][t.bookType]||Ag[l].xlsx})})},a=function(l){(e[l]||[]).forEach(function(c){n[n.length]=mt("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return s("workbooks"),o("sheets"),o("charts"),a("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(a),a("vba"),a("comments"),a("threadedcomments"),a("drawings"),o("metadata"),a("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var lr={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function Tf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Zh(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(vi)||[]).forEach(function(i){var s=Wt(i);if(s[0]==="<Relationship"){var o={};o.Type=s.Type,o.Target=s.Target,o.Id=s.Id,s.TargetMode&&(o.TargetMode=s.TargetMode);var a=s.TargetMode==="External"?s.Target:Ih(s.Target,t);r[a]=o,n[s.Id]=o}}),r["!id"]=n,r}function rd(e){var t=[_n,mt("Relationships",null,{xmlns:Nn.RELS})];return hn(e["!id"]).forEach(function(r){t[t.length]=mt("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Or(e,t,r,n,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[lr.HLINK,lr.XPATH,lr.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var wX="application/vnd.oasis.opendocument.spreadsheet";function yX(e,t){for(var r=dC(e),n,i;n=Ef.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(i=Wt(n[0],!1),i.path=="/"&&i.type!==wX)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function CX(e){var t=[_n];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function U3(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function xX(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function SX(e){var t=[_n];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(U3(e[r][0],e[r][1])),t.push(xX("",e[r][0]));return t.push(U3("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function g5(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+N0.version+"</meta:generator></office:meta></office:document-meta>"}var Ts=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],_X=(function(){for(var e=new Array(Ts.length),t=0;t<Ts.length;++t){var r=Ts[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function m5(e){var t={};e=Ur(e);for(var r=0;r<Ts.length;++r){var n=Ts[r],i=e.match(_X[r]);i!=null&&i.length>0&&(t[n[1]]=xr(i[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=Zr(t[n[1]]))}return t}function Sb(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=Br(t),n[n.length]=r?mt(e,t,r):ri(e,t))}function v5(e,t){var r=t||{},n=[_n,mt("cp:coreProperties",null,{"xmlns:cp":Nn.CORE_PROPS,"xmlns:dc":Nn.dc,"xmlns:dcterms":Nn.dcterms,"xmlns:dcmitype":Nn.dcmitype,"xmlns:xsi":Nn.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Sb("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Aw(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&Sb("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Aw(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var s=0;s!=Ts.length;++s){var o=Ts[s],a=r.Props&&r.Props[o[1]]!=null?r.Props[o[1]]:e?e[o[1]]:null;a===!0?a="1":a===!1?a="0":typeof a=="number"&&(a=String(a)),a!=null&&Sb(o[0],a,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var dc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],b5=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function w5(e,t,r,n){var i=[];if(typeof e=="string")i=I3(e,n);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(u){return{v:u}}));var o=typeof t=="string"?I3(t,n).map(function(u){return u.v}):t,a=0,l=0;if(o.length>0)for(var c=0;c!==i.length;c+=2){switch(l=+i[c+1].v,i[c].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=o.slice(a,a+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=l,r.DefinedNames=o.slice(a,a+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=o.slice(a,a+l);break}a+=l}}function EX(e,t,r){var n={};return t||(t={}),e=Ur(e),dc.forEach(function(i){var s=(e.match(Sf(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=xr(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var o=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));o&&o.length>0&&(n[i[1]]=o[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&w5(n.HeadingPairs,n.TitlesOfParts,t,r),t}function y5(e){var t=[],r=mt;return e||(e={}),e.Application="SheetJS",t[t.length]=_n,t[t.length]=mt("Properties",null,{xmlns:Nn.EXT_PROPS,"xmlns:vt":Nn.vt}),dc.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=Br(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+Br(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var TX=/<[^>]+>[^<]*/g;function kX(e,t){var r={},n="",i=e.match(TX);if(i)for(var s=0;s!=i.length;++s){var o=i[s],a=Wt(o);switch(a[0]){case"<?xml":break;case"<Properties":break;case"<property":n=xr(a.name);break;case"</property>":n=null;break;default:if(o.indexOf("<vt:")===0){var l=o.split(">"),c=l[0].slice(4),u=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=xr(u);break;case"bool":r[n]=Xr(u);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(u,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(u);break;case"filetime":case"date":r[n]=Zr(u);break;case"cy":case"error":r[n]=xr(u);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",o,c,l)}}else if(o.slice(0,2)!=="</"){if(t.WTF)throw new Error(o)}}}return r}function C5(e){var t=[_n,mt("Properties",null,{xmlns:Nn.CUST_PROPS,"xmlns:vt":Nn.vt})];if(!e)return t.join("");var r=1;return hn(e).forEach(function(i){++r,t[t.length]=mt("property",NK(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:Br(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Iw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},_b;function RX(e,t,r){_b||(_b=bm(Iw)),t=_b[t]||t,e[t]=r}function AX(e,t){var r=[];return hn(Iw).map(function(n){for(var i=0;i<Ts.length;++i)if(Ts[i][1]==n)return Ts[i];for(i=0;i<dc.length;++i)if(dc[i][1]==n)return dc[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];n[2]==="date"&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"Z")),typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(ri(Iw[n[1]]||n[1],i))}}),mt("DocumentProperties",r.join(""),{xmlns:Zi.o})}function FX(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&hn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var o=0;o<Ts.length;++o)if(s==Ts[o][1])return;for(o=0;o<dc.length;++o)if(s==dc[o][1])return;for(o=0;o<r.length;++o)if(s==r[o])return;var a=e[s],l="string";typeof a=="number"?(l="float",a=String(a)):a===!0||a===!1?(l="boolean",a=a?"1":"0"):a=String(a),i.push(mt(F3(s),a,{"dt:dt":l}))}}),t&&hn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var o=t[s],a="string";typeof o=="number"?(a="float",o=String(o)):o===!0||o===!1?(a="boolean",o=o?"1":"0"):o instanceof Date?(a="dateTime.tz",o=o.toISOString()):o=String(o),i.push(mt(F3(s),o,{"dt:dt":a}))}}),"<"+n+' xmlns="'+Zi.o+'">'+i.join("")+"</"+n+">"}function xC(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function MX(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var s=n/Math.pow(2,32)|0;s>0&&(n=n%Math.pow(2,32),i+=s);var o=Je(8);return o.write_shift(4,n),o.write_shift(4,i),o}function x5(e,t,r){var n=e.l,i=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return i}function S5(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function _5(e,t,r){return t===31?S5(e):x5(e,t,r)}function Ow(e,t,r){return _5(e,t,r===!1?0:4)}function DX(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return _5(e,t,0)}function PX(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var i=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Si,""),e.l-i&2&&(e.l+=2)}return r}function IX(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Si,"");return r}function OX(e){var t=e.l,r=W0(e,h5);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=W0(e,Pi);return[r,n]}function NX(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(OX(e));return r}function W3(e,t){for(var r=e.read_shift(4),n={},i=0;i!=r;++i){var s=e.read_shift(4),o=e.read_shift(4);n[s]=e.read_shift(o,t===1200?"utf16le":"utf8").replace(Si,"").replace(Ph,"!"),t===1200&&o%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function E5(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function LX(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function W0(e,t,r){var n=e.read_shift(2),i,s=r||{};if(e.l+=2,t!==G3&&n!==t&&pX.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===G3?n:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return x5(e,n,4).replace(Si,"");case 31:return S5(e);case 64:return xC(e);case 65:return E5(e);case 71:return LX(e);case 80:return Ow(e,n,!s.raw).replace(Si,"");case 81:return DX(e,n).replace(Si,"");case 4108:return NX(e);case 4126:case 4127:return n==4127?PX(e):IX(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function $3(e,t){var r=Je(4),n=Je(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Je(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=MX(t);break;case 31:case 80:for(n=Je(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Vn([r,n])}function q3(e,t){var r=e.l,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0,a=0,l=-1,c={};for(o=0;o!=i;++o){var u=e.read_shift(4),h=e.read_shift(4);s[o]=[u,h+r]}s.sort(function(y,C){return y[1]-C[1]});var d={};for(o=0;o!=i;++o){if(e.l!==s[o][1]){var f=!0;if(o>0&&t)switch(t[s[o-1][0]].t){case 2:e.l+2===s[o][1]&&(e.l+=2,f=!1);break;case 80:e.l<=s[o][1]&&(e.l=s[o][1],f=!1);break;case 4108:e.l<=s[o][1]&&(e.l=s[o][1],f=!1);break}if((!t||o==0)&&e.l<=s[o][1]&&(f=!1,e.l=s[o][1]),f)throw new Error("Read Error: Expected address "+s[o][1]+" at "+e.l+" :"+o)}if(t){var m=t[s[o][0]];if(d[m.n]=W0(e,m.t,{raw:!0}),m.p==="version"&&(d[m.n]=String(d[m.n]>>16)+"."+("0000"+String(d[m.n]&65535)).slice(-4)),m.n=="CodePage")switch(d[m.n]){case 0:d[m.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:zs(a=d[m.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+d[m.n])}}else if(s[o][0]===1){if(a=d.CodePage=W0(e,yC),zs(a),l!==-1){var v=e.l;e.l=s[l][1],c=W3(e,a),e.l=v}}else if(s[o][0]===0){if(a===0){l=o,e.l=s[o+1][1];continue}c=W3(e,a)}else{var g=c[s[o][0]],w;switch(e[e.l]){case 65:e.l+=4,w=E5(e);break;case 30:e.l+=4,w=Ow(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,w=Ow(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,w=e.read_shift(4,"i");break;case 19:e.l+=4,w=e.read_shift(4);break;case 5:e.l+=4,w=e.read_shift(8,"f");break;case 11:e.l+=4,w=bn(e,4);break;case 64:e.l+=4,w=Zr(xC(e));break;default:throw new Error("unparsed value: "+e[e.l])}d[g]=w}}return e.l=r+n,d}var T5=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function BX(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function K3(e,t,r){var n=Je(8),i=[],s=[],o=8,a=0,l=Je(8),c=Je(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),s.push(l),i.push(c),o+=8+l.length,!t){c=Je(8),c.write_shift(4,0),i.unshift(c);var u=[Je(4)];for(u[0].write_shift(4,e.length),a=0;a<e.length;++a){var h=e[a][0];for(l=Je(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,a+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Vn(u),s.unshift(l),o+=8+l.length}for(a=0;a<e.length;++a)if(!(t&&!t[e[a][0]])&&!(T5.indexOf(e[a][0])>-1||b5.indexOf(e[a][0])>-1)&&e[a][1]!=null){var d=e[a][1],f=0;if(t){f=+t[e[a][0]];var m=r[f];if(m.p=="version"&&typeof d=="string"){var v=d.split(".");d=(+v[0]<<16)+(+v[1]||0)}l=$3(m.t,d)}else{var g=BX(d);g==-1&&(g=31,d=String(d)),l=$3(g,d)}s.push(l),c=Je(8),c.write_shift(4,t?f:2+a),i.push(c),o+=8+l.length}var w=8*(s.length+1);for(a=0;a<s.length;++a)i[a].write_shift(4,w),w+=s[a].length;return n.write_shift(4,o),n.write_shift(4,s.length),Vn([n].concat(i).concat(s))}function X3(e,t,r){var n=e.content;if(!n)return{};ti(n,0);var i,s,o,a,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),u=n.read_shift(16);if(u!==Mt.utils.consts.HEADER_CLSID&&u!==r)throw new Error("Bad PropertySet CLSID "+u);if(i=n.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=n.read_shift(16),a=n.read_shift(4),i===1&&a!==n.l)throw new Error("Length mismatch: "+a+" !== "+n.l);i===2&&(o=n.read_shift(16),l=n.read_shift(4));var h=q3(n,t),d={SystemIdentifier:c};for(var f in h)d[f]=h[f];if(d.FMTID=s,i===1)return d;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var m;try{m=q3(n,null)}catch{}for(f in m)d[f]=m[f];return d.FMTID=[s,o],d}function Y3(e,t,r,n,i,s){var o=Je(i?68:48),a=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Mt.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,i?2:1),o.write_shift(16,t,"hex"),o.write_shift(4,i?68:48);var l=K3(e,r,n);if(a.push(l),i){var c=K3(i,null,null);o.write_shift(16,s,"hex"),o.write_shift(4,68+l.length),a.push(c)}return Vn(a)}function Xa(e,t){return e.read_shift(t),null}function HX(e,t){t||(t=Je(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function jX(e,t,r){for(var n=[],i=e.l+t;e.l<i;)n.push(r(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return n}function bn(e,t){return e.read_shift(t)===1}function Ci(e,t){return t||(t=Je(2)),t.write_shift(2,+!!e),t}function Mn(e){return e.read_shift(2,"u")}function Cs(e,t){return t||(t=Je(2)),t.write_shift(2,e),t}function k5(e,t){return jX(e,t,Mn)}function VX(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function R5(e,t,r){return r||(r=Je(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function Zf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var o=n?e.read_shift(n,i):"";return o}function GX(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,i=r&8,s=1+(r&1),o=0,a,l={};i&&(o=e.read_shift(2)),n&&(a=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",u=t===0?"":e.read_shift(t,c);return i&&(e.l+=4*o),n&&(e.l+=a),l.t=u,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function zX(e){var t=e.t||"",r=Je(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Je(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Vn(i)}function _c(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Jf(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):_c(e,n,r)}function Bc(e,t,r){if(r.biff>5)return Jf(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function A5(e,t,r){return r||(r=Je(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function UX(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function WX(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var i=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Si,"");return n&&(e.l+=24),i}function $X(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var o=e.read_shift(s>>1,"utf16le").replace(Si,"");return r+o}function qX(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return WX(e);case"0303000000000000c000000000000046":return $X(e);default:throw new Error("Unsupported Moniker "+r)}}function Fg(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Si,""):"";return r}function Z3(e,t){t||(t=Je(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function KX(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var i=e.read_shift(2);e.l+=2;var s,o,a,l,c="",u,h;i&16&&(s=Fg(e,r-e.l)),i&128&&(o=Fg(e,r-e.l)),(i&257)===257&&(a=Fg(e,r-e.l)),(i&257)===1&&(l=qX(e,r-e.l)),i&8&&(c=Fg(e,r-e.l)),i&32&&(u=e.read_shift(16)),i&64&&(h=xC(e)),e.l=r;var d=o||a||l||"";d&&c&&(d+="#"+c),d||(d="#"+c),i&2&&d.charAt(0)=="/"&&d.charAt(1)!="/"&&(d="file://"+d);var f={Target:d};return u&&(f.guid=u),h&&(f.time=h),s&&(f.Tooltip=s),f}function XX(e){var t=Je(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),s=i>-1?31:23;switch(n.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var o=[8,6815827,6619237,4849780,83];for(r=0;r<o.length;++r)t.write_shift(4,o[r]);if(s==28)n=n.slice(1),Z3(n,t);else if(s&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));var a=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(a.length+1)),r=0;r<a.length;++r)t.write_shift(2,a.charCodeAt(r));t.write_shift(2,0),s&8&&Z3(i>-1?n.slice(i+1):"",t)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<o.length;++r)t.write_shift(1,parseInt(o[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function F5(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),i=e.read_shift(1);return[t,r,n,i]}function M5(e,t){var r=F5(e);return r[3]=0,r}function Ao(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function Ec(e,t,r,n){return n||(n=Je(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function YX(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function ZX(e,t,r){return t===0?"":Bc(e,t,r)}function JX(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),s=e.read_shift(n,"i"),o=e.read_shift(n,"i");return[i,s,o]}function D5(e){var t=e.read_shift(2),r=wC(e);return[t,r]}function QX(e,t,r){e.l+=4,t-=4;var n=e.l+t,i=Zf(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,i}function Cm(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function P5(e,t){return t||(t=Je(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function I5(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1);return{s:{c:n,r:t},e:{c:i,r}}}var eY=I5;function O5(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function tY(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function rY(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function li(e){e.l+=2,e.l+=e.read_shift(2)}var nY={0:li,4:li,5:li,6:li,7:rY,8:li,9:li,10:li,11:li,12:li,13:tY,14:li,15:li,16:li,17:li,18:li,19:li,20:li,21:O5};function iY(e,t){for(var r=e.l+t,n=[];e.l<r;){var i=e.read_shift(2);e.l-=2;try{n.push(nY[i](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function Mg(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function SC(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=Je(i);return s.write_shift(2,n),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function sY(e,t){return t===0||e.read_shift(2),1200}function oY(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,i=Bc(e,0,r);return e.read_shift(t+n-e.l),i}function aY(e,t){var r=!t||t.biff==8,n=Je(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function lY(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function cY(e,t,r){var n=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var o=Zf(e,0,r);return o.length===0&&(o="Sheet1"),{pos:n,hs:i,dt:s,name:o}}function uY(e,t){var r=!t||t.biff>=8?2:1,n=Je(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function dY(e,t){for(var r=e.l+t,n=e.read_shift(4),i=e.read_shift(4),s=[],o=0;o!=i&&e.l<r;++o)s.push(GX(e));return s.Count=n,s.Unique=i,s}function hY(e,t){var r=Je(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=zX(e[i]);var s=Vn([r].concat(n));return s.parts=[r.length].concat(n.map(function(o){return o.length})),s}function fY(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function pY(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function gY(e){var t=YX(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function mY(e){return e.read_shift(2),e.read_shift(4)}function J3(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var i=e.read_shift(2);r&&r.biff==2&&(n=1-(i>>15),i&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,i]}function vY(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),a=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,i],Flags:s,CurTab:o,FirstTab:a,Selected:l,TabRatio:c}}function bY(){var e=Je(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function wY(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function yY(e){var t=Je(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function CY(){}function xY(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Zf(e,0,r),n}function SY(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,s=Je(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),s}function _Y(e){var t=Ao(e);return t.isst=e.read_shift(4),t}function EY(e,t,r,n){var i=Je(10);return Ec(e,t,n,i),i.write_shift(4,r),i}function TY(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,i=Ao(e);r.biff==2&&e.l++;var s=Jf(e,n-e.l,r);return i.val=s,i}function kY(e,t,r,n,i){var s=!i||i.biff==8,o=Je(8+ +s+(1+s)*r.length);return Ec(e,t,n,o),o.write_shift(2,r.length),s&&o.write_shift(1,1),o.write_shift((1+s)*r.length,r,s?"utf16le":"sbcs"),o}function RY(e,t,r){var n=e.read_shift(2),i=Bc(e,0,r);return[n,i]}function AY(e,t,r,n){var i=r&&r.biff==5;n||(n=Je(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=n.length>n.l?n.slice(0,n.l):n;return s.l==null&&(s.l=s.length),s}var FY=Bc;function Q3(e,t,r){var n=e.l+t,i=r.biff==8||!r.biff?4:2,s=e.read_shift(i),o=e.read_shift(i),a=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:a},e:{r:o,c:l}}}function MY(e,t){var r=t.biff==8||!t.biff?4:2,n=Je(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function DY(e){var t=e.read_shift(2),r=e.read_shift(2),n=D5(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function PY(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(D5(e));if(e.l!==r)throw new Error("MulRK read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulRK length mismatch");return{r:n,c:i,C:o,rkrec:s}}function IY(e,t){for(var r=e.l+t-2,n=e.read_shift(2),i=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var o=e.read_shift(2);if(s.length!=o-i+1)throw new Error("MulBlank length mismatch");return{r:n,c:i,C:o,ixfe:s}}function OY(e,t,r,n){var i={},s=e.read_shift(4),o=e.read_shift(4),a=e.read_shift(4),l=e.read_shift(2);return i.patternType=gX[a>>26],n.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=o&15,i.dgRight=o>>4&15,i.dgTop=o>>8&15,i.dgBottom=o>>12&15,i.icvLeft=o>>16&127,i.icvRight=o>>23&127,i.grbitDiag=o>>30&3,i.icvTop=a&127,i.icvBottom=a>>7&127,i.icvDiag=a>>14&127,i.dgDiag=a>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function NY(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=OY(e,t,n.fStyle,r),n}function eE(e,t,r,n){var i=r&&r.biff==5;n||(n=Je(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),n.write_shift(4,s),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function LY(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function BY(e){var t=Je(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function tE(e,t,r){var n=Ao(e);(r.biff==2||t==9)&&++e.l;var i=VX(e);return n.val=i,n.t=i===!0||i===!1?"b":"e",n}function HY(e,t,r,n,i,s){var o=Je(8);return Ec(e,t,n,o),R5(r,s,o),o}function jY(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ao(e),i=fi(e);return n.val=i,n}function VY(e,t,r,n){var i=Je(14);return Ec(e,t,n,i),Sc(r,i),i}var rE=ZX;function GY(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var o=_c(e,s),a=[];n>e.l;)a.push(Jf(e));return[s,i,o,a]}function nE(e,t,r){var n=e.read_shift(2),i,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(i=QX(e,t-2,r)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var zY=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function iE(e,t,r){var n=e.l+t,i=e.read_shift(2),s=e.read_shift(1),o=e.read_shift(1),a=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=_c(e,o,r);i&32&&(c=zY[c.charCodeAt(0)]);var u=n-e.l;r&&r.biff==2&&--u;var h=n==e.l||a===0||!(u>0)?[]:ite(e,u,r,a);return{chKey:s,Name:c,itab:l,rgce:h}}function N5(e,t,r){if(r.biff<8)return UY(e,t,r);for(var n=[],i=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(JX(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function UY(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Zf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function WY(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),i=e.read_shift(2),s=_c(e,n,r),o=_c(e,i,r);return[s,o]}function $Y(e,t,r){var n=I5(e);e.l++;var i=e.read_shift(1);return t-=8,[ste(e,t,r),i,n]}function sE(e,t,r){var n=eY(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,rte(e,t,r)]}function qY(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function KY(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),o=e.read_shift(2),a=Bc(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:i},a,o,s]}}function XY(e,t,r){return KY(e,t,r)}function YY(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(Cm(e));return r}function ZY(e){var t=Je(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)P5(e[r],t);return t}function JY(e,t,r){if(r&&r.biff<8)return eZ(e,t,r);var n=O5(e),i=iY(e,t-22,n[1]);return{cmo:n,ft:i}}var QY={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=r,{fmt:n}}};function eZ(e,t,r){e.l+=4;var n=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var o=[];return o.push((QY[n]||gi)(e,t,r)),{cmo:[i,n,s],ft:o}}function tZ(e,t,r){var n=e.l,i="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],o;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:o=UX(e,6,r);var a=e.read_shift(2);e.read_shift(2),Mn(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var u=e[e.l],h=_c(e,e.lens[c+1]-e.lens[c]-1);if(i+=h,i.length>=(u?a:2*a))break}if(i.length!==a&&i.length!==a*2)throw new Error("cchText: "+a+" != "+i.length);return e.l=n+t,{t:i}}catch{return e.l=n+t,{t:i}}}function rZ(e,t){var r=Cm(e);e.l+=16;var n=KX(e,t-24);return[r,n]}function nZ(e){var t=Je(24),r=on(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Vn([t,XX(e[1])])}function iZ(e,t){e.read_shift(2);var r=Cm(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Si,""),[r,n]}function sZ(e){var t=e[1].Tooltip,r=Je(10+2*(t.length+1));r.write_shift(2,2048);var n=on(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function oZ(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=z3[r]||r,r=e.read_shift(2),t[1]=z3[r]||r,t}function aZ(e){return e||(e=Je(4)),e.write_shift(2,1),e.write_shift(2,1),e}function lZ(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(M5(e));return r}function cZ(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(M5(e));return r}function uZ(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function L5(e,t,r){if(!r.cellStyles)return gi(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),a=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:s,w:o,ixfe:a,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function dZ(e,t){var r=Je(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function hZ(e,t){var r={};return t<32||(e.l+=16,r.header=fi(e),r.footer=fi(e),e.l+=2),r}function fZ(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var i=e.read_shift(1);return e.l+=3,i&16&&(n.area=!0),n}function pZ(e){for(var t=Je(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var gZ=Ao,mZ=k5,vZ=Jf;function bZ(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,i}function wZ(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ao(e);++e.l;var i=Bc(e,t-7,r);return n.t="str",n.val=i,n}function yZ(e){var t=Ao(e);++e.l;var r=fi(e);return t.t="n",t.val=r,t}function CZ(e,t,r){var n=Je(15);return rp(n,e,t),n.write_shift(8,r,"f"),n}function xZ(e){var t=Ao(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function SZ(e,t,r){var n=Je(9);return rp(n,e,t),n.write_shift(2,r),n}function _Z(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function EZ(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function TZ(e,t,r){var n=e.l+t,i=Ao(e),s=e.read_shift(2),o=_c(e,s,r);return e.l=n,i.t="str",i.val=o,i}var kZ=[2,3,48,49,131,139,140,245],Nw=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=bm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(a,l){var c=[],u=dl(1);switch(l.type){case"base64":u=Qi(is(a));break;case"binary":u=Qi(a);break;case"buffer":case"array":u=a;break}ti(u,0);var h=u.read_shift(1),d=!!(h&136),f=!1,m=!1;switch(h){case 2:break;case 3:break;case 48:f=!0,d=!0;break;case 49:f=!0,d=!0;break;case 131:break;case 139:break;case 140:m=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var v=0,g=521;h==2&&(v=u.read_shift(2)),u.l+=3,h!=2&&(v=u.read_shift(4)),v>1048576&&(v=1e6),h!=2&&(g=u.read_shift(2));var w=u.read_shift(2),y=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(y=e[u[u.l]]),u.l+=1,u.l+=2),m&&(u.l+=36);for(var C=[],k={},F=Math.min(u.length,h==2?521:g-10-(f?264:0)),I=m?32:11;u.l<F&&u[u.l]!=13;)switch(k={},k.name=yf.utils.decode(y,u.slice(u.l,u.l+I)).replace(/[\u0000\r\n].*$/g,""),u.l+=I,k.type=String.fromCharCode(u.read_shift(1)),h!=2&&!m&&(k.offset=u.read_shift(4)),k.len=u.read_shift(1),h==2&&(k.offset=u.read_shift(2)),k.dec=u.read_shift(1),k.name.length&&C.push(k),h!=2&&(u.l+=m?13:14),k.type){case"B":(!f||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(u[u.l]!==13&&(u.l=g-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=g;var N=0,j=0;for(c[0]=[],j=0;j!=C.length;++j)c[0][j]=C[j].name;for(;v-- >0;){if(u[u.l]===42){u.l+=w;continue}for(++u.l,c[++N]=[],j=0,j=0;j!=C.length;++j){var L=u.slice(u.l,u.l+C[j].len);u.l+=C[j].len,ti(L,0);var W=yf.utils.decode(y,L);switch(C[j].type){case"C":W.trim().length&&(c[N][j]=W.replace(/\s+$/,""));break;case"D":W.length===8?c[N][j]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):c[N][j]=W;break;case"F":c[N][j]=parseFloat(W.trim());break;case"+":case"I":c[N][j]=m?L.read_shift(-4,"i")^2147483648:L.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":c[N][j]=!0;break;case"N":case"F":c[N][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!d)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[N][j]="##MEMO##"+(m?parseInt(W.trim(),10):L.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(c[N][j]=+W||0);break;case"@":c[N][j]=new Date(L.read_shift(-8,"f")-621356832e5);break;case"T":c[N][j]=new Date((L.read_shift(4)-2440588)*864e5+L.read_shift(4));break;case"Y":c[N][j]=L.read_shift(4,"i")/1e4+L.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[N][j]=-L.read_shift(-8,"f");break;case"B":if(f&&C[j].len==8){c[N][j]=L.read_shift(8,"f");break}case"G":case"P":L.l+=C[j].len;break;case"0":if(C[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+C[j].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=C,c}function n(a,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=kd(r(a,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(a,l){try{return xl(n(a,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function o(a,l){var c=l||{};if(+c.codepage>=0&&zs(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=Bi(),h=X0(a,{header:1,raw:!0,cellDates:!0}),d=h[0],f=h.slice(1),m=a["!cols"]||[],v=0,g=0,w=0,y=1;for(v=0;v<d.length;++v){if(((m[v]||{}).DBF||{}).name){d[v]=m[v].DBF.name,++w;continue}if(d[v]!=null){if(++w,typeof d[v]=="number"&&(d[v]=d[v].toString(10)),typeof d[v]!="string")throw new Error("DBF Invalid column name "+d[v]+" |"+typeof d[v]+"|");if(d.indexOf(d[v])!==v){for(g=0;g<1024;++g)if(d.indexOf(d[v]+"_"+g)==-1){d[v]+="_"+g;break}}}}var C=Sr(a["!ref"]),k=[],F=[],I=[];for(v=0;v<=C.e.c-C.s.c;++v){var N="",j="",L=0,W=[];for(g=0;g<f.length;++g)f[g][v]!=null&&W.push(f[g][v]);if(W.length==0||d[v]==null){k[v]="?";continue}for(g=0;g<W.length;++g){switch(typeof W[g]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=W[g]instanceof Date?"D":"C";break;default:j="C"}L=Math.max(L,String(W[g]).length),N=N&&N!=j?"C":j}L>250&&(L=250),j=((m[v]||{}).DBF||{}).type,j=="C"&&m[v].DBF.len>L&&(L=m[v].DBF.len),N=="B"&&j=="N"&&(N="N",I[v]=m[v].DBF.dec,L=m[v].DBF.len),F[v]=N=="C"||j=="N"?L:s[N]||0,y+=F[v],k[v]=N}var K=u.next(32);for(K.write_shift(4,318902576),K.write_shift(4,f.length),K.write_shift(2,296+32*w),K.write_shift(2,y),v=0;v<4;++v)K.write_shift(4,0);for(K.write_shift(4,0|(+t[T6]||3)<<8),v=0,g=0;v<d.length;++v)if(d[v]!=null){var z=u.next(32),M=(d[v].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,M,"sbcs"),z.write_shift(1,k[v]=="?"?"C":k[v],"sbcs"),z.write_shift(4,g),z.write_shift(1,F[v]||s[k[v]]||0),z.write_shift(1,I[v]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),g+=F[v]||s[k[v]]||0}var B=u.next(264);for(B.write_shift(4,13),v=0;v<65;++v)B.write_shift(4,0);for(v=0;v<f.length;++v){var R=u.next(y);for(R.write_shift(1,0),g=0;g<d.length;++g)if(d[g]!=null)switch(k[g]){case"L":R.write_shift(1,f[v][g]==null?63:f[v][g]?84:70);break;case"B":R.write_shift(8,f[v][g]||0,"f");break;case"N":var S="0";for(typeof f[v][g]=="number"&&(S=f[v][g].toFixed(I[g]||0)),w=0;w<F[g]-S.length;++w)R.write_shift(1,32);R.write_shift(1,S,"sbcs");break;case"D":f[v][g]?(R.write_shift(4,("0000"+f[v][g].getFullYear()).slice(-4),"sbcs"),R.write_shift(2,("00"+(f[v][g].getMonth()+1)).slice(-2),"sbcs"),R.write_shift(2,("00"+f[v][g].getDate()).slice(-2),"sbcs")):R.write_shift(8,"00000000","sbcs");break;case"C":var _=String(f[v][g]!=null?f[v][g]:"").slice(0,F[g]);for(R.write_shift(1,_,"sbcs"),w=0;w<F[g]-_.length;++w)R.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:o}})(),B5=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+hn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(d,f){var m=e[f];return typeof m=="number"?m3(m):m},n=function(d,f,m){var v=f.charCodeAt(0)-32<<4|m.charCodeAt(0)-48;return v==59?d:m3(v)};e["|"]=254;function i(d,f){switch(f.type){case"base64":return s(is(d),f);case"binary":return s(d,f);case"buffer":return s(ar&&Buffer.isBuffer(d)?d.toString("binary"):Cl(d),f);case"array":return s(xc(d),f)}throw new Error("Unrecognized type "+f.type)}function s(d,f){var m=d.split(/[\n\r]+/),v=-1,g=-1,w=0,y=0,C=[],k=[],F=null,I={},N=[],j=[],L=[],W=0,K;for(+f.codepage>=0&&zs(+f.codepage);w!==m.length;++w){W=0;var z=m[w].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),M=z.replace(/;;/g,"\0").split(";").map(function(Q){return Q.replace(/\u0000/g,";")}),B=M[0],R;if(z.length>0)switch(B){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":M[1].charAt(0)=="P"&&k.push(z.slice(3).replace(/;;/g,";"));break;case"C":var S=!1,_=!1,T=!1,E=!1,D=-1,O=-1;for(y=1;y<M.length;++y)switch(M[y].charAt(0)){case"A":break;case"X":g=parseInt(M[y].slice(1))-1,_=!0;break;case"Y":for(v=parseInt(M[y].slice(1))-1,_||(g=0),K=C.length;K<=v;++K)C[K]=[];break;case"K":R=M[y].slice(1),R.charAt(0)==='"'?R=R.slice(1,R.length-1):R==="TRUE"?R=!0:R==="FALSE"?R=!1:isNaN($s(R))?isNaN(pd(R).getDate())||(R=Zr(R)):(R=$s(R),F!==null&&Ed(F)&&(R=ym(R))),S=!0;break;case"E":E=!0;var P=nd(M[y].slice(1),{r:v,c:g});C[v][g]=[C[v][g],P];break;case"S":T=!0,C[v][g]=[C[v][g],"S5S"];break;case"G":break;case"R":D=parseInt(M[y].slice(1))-1;break;case"C":O=parseInt(M[y].slice(1))-1;break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+z)}if(S&&(C[v][g]&&C[v][g].length==2?C[v][g][0]=R:C[v][g]=R,F=null),T){if(E)throw new Error("SYLK shared formula cannot have own formula");var q=D>-1&&C[D][O];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");C[v][g][1]=r8(q[1],{r:v-D,c:g-O})}break;case"F":var X=0;for(y=1;y<M.length;++y)switch(M[y].charAt(0)){case"X":g=parseInt(M[y].slice(1))-1,++X;break;case"Y":for(v=parseInt(M[y].slice(1))-1,K=C.length;K<=v;++K)C[K]=[];break;case"M":W=parseInt(M[y].slice(1))/20;break;case"F":break;case"G":break;case"P":F=k[parseInt(M[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(L=M[y].slice(1).split(" "),K=parseInt(L[0],10);K<=parseInt(L[1],10);++K)W=parseInt(L[2],10),j[K-1]=W===0?{hidden:!0}:{wch:W},hl(j[K-1]);break;case"C":g=parseInt(M[y].slice(1))-1,j[g]||(j[g]={});break;case"R":v=parseInt(M[y].slice(1))-1,N[v]||(N[v]={}),W>0?(N[v].hpt=W,N[v].hpx=md(W)):W===0&&(N[v].hidden=!0);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+z)}X<1&&(F=null);break;default:if(f&&f.WTF)throw new Error("SYLK bad record "+z)}}return N.length>0&&(I["!rows"]=N),j.length>0&&(I["!cols"]=j),f&&f.sheetRows&&(C=C.slice(0,f.sheetRows)),[C,I]}function o(d,f){var m=i(d,f),v=m[0],g=m[1],w=kd(v,f);return hn(g).forEach(function(y){w[y]=g[y]}),w}function a(d,f){return xl(o(d,f),f)}function l(d,f,m,v){var g="C;Y"+(m+1)+";X"+(v+1)+";K";switch(d.t){case"n":g+=d.v||0,d.f&&!d.F&&(g+=";E"+AC(d.f,{r:m,c:v}));break;case"b":g+=d.v?"TRUE":"FALSE";break;case"e":g+=d.w||d.v;break;case"d":g+='"'+(d.w||d.v)+'"';break;case"s":g+='"'+d.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function c(d,f){f.forEach(function(m,v){var g="F;W"+(v+1)+" "+(v+1)+" ";m.hidden?g+="0":(typeof m.width=="number"&&!m.wpx&&(m.wpx=Rf(m.width)),typeof m.wpx=="number"&&!m.wch&&(m.wch=Af(m.wpx)),typeof m.wch=="number"&&(g+=Math.round(m.wch))),g.charAt(g.length-1)!=" "&&d.push(g)})}function u(d,f){f.forEach(function(m,v){var g="F;";m.hidden?g+="M0;":m.hpt?g+="M"+20*m.hpt+";":m.hpx&&(g+="M"+20*Ff(m.hpx)+";"),g.length>2&&d.push(g+"R"+(v+1))})}function h(d,f){var m=["ID;PWXL;N;E"],v=[],g=Sr(d["!ref"]),w,y=Array.isArray(d),C=`\r
`;m.push("P;PGeneral"),m.push("F;P0;DG0G8;M255"),d["!cols"]&&c(m,d["!cols"]),d["!rows"]&&u(m,d["!rows"]),m.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var k=g.s.r;k<=g.e.r;++k)for(var F=g.s.c;F<=g.e.c;++F){var I=zt({r:k,c:F});w=y?(d[k]||[])[F]:d[I],!(!w||w.v==null&&(!w.f||w.F))&&v.push(l(w,d,k,F))}return m.join(C)+C+v.join(C)+C+"E"+C}return{to_workbook:a,to_sheet:o,from_sheet:h}})(),H5=(function(){function e(s,o){switch(o.type){case"base64":return t(is(s),o);case"binary":return t(s,o);case"buffer":return t(ar&&Buffer.isBuffer(s)?s.toString("binary"):Cl(s),o);case"array":return t(xc(s),o)}throw new Error("Unrecognized type "+o.type)}function t(s,o){for(var a=s.split(`
`),l=-1,c=-1,u=0,h=[];u!==a.length;++u){if(a[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var d=a[u].trim().split(","),f=d[0],m=d[1];++u;for(var v=a[u]||"";(v.match(/["]/g)||[]).length&1&&u<a.length-1;)v+=`
`+a[++u];switch(v=v.trim(),+f){case-1:if(v==="BOT"){h[++l]=[],c=0;continue}else if(v!=="EOD")throw new Error("Unrecognized DIF special command "+v);break;case 0:v==="TRUE"?h[l][c]=!0:v==="FALSE"?h[l][c]=!1:isNaN($s(m))?isNaN(pd(m).getDate())?h[l][c]=m:h[l][c]=Zr(m):h[l][c]=$s(m),++c;break;case 1:v=v.slice(1,v.length-1),v=v.replace(/""/g,'"'),v&&v.match(/^=".*"$/)&&(v=v.slice(2,-1)),h[l][c++]=v!==""?v:null;break}if(v==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function r(s,o){return kd(e(s,o),o)}function n(s,o){return xl(r(s,o),o)}var i=(function(){var s=function(l,c,u,h,d){l.push(c),l.push(u+","+h),l.push('"'+d.replace(/"/g,'""')+'"')},o=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=Sr(l["!ref"]),h,d=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,u.e.r-u.s.r+1,""),s(c,"TUPLES",0,u.e.c-u.s.c+1,""),s(c,"DATA",0,0,"");for(var f=u.s.r;f<=u.e.r;++f){o(c,-1,0,"BOT");for(var m=u.s.c;m<=u.e.c;++m){var v=zt({r:f,c:m});if(h=d?(l[f]||[])[m]:l[v],!h){o(c,1,0,"");continue}switch(h.t){case"n":var g=h.w;!g&&h.v!=null&&(g=h.v),g==null?h.f&&!h.F?o(c,1,0,"="+h.f):o(c,1,0,""):o(c,0,g,"V");break;case"b":o(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=As(h.z||Gt[14],Ln(Zr(h.v)))),o(c,0,h.w,"V");break;default:o(c,1,0,"")}}}o(c,-1,0,"EOD");var w=`\r
`,y=c.join(w);return y}})();return{to_workbook:n,to_sheet:r,from_sheet:i}})(),j5=(function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,d){for(var f=h.split(`
`),m=-1,v=-1,g=0,w=[];g!==f.length;++g){var y=f[g].trim().split(":");if(y[0]==="cell"){var C=on(y[1]);if(w.length<=C.r)for(m=w.length;m<=C.r;++m)w[m]||(w[m]=[]);switch(m=C.r,v=C.c,y[2]){case"t":w[m][v]=e(y[3]);break;case"v":w[m][v]=+y[3];break;case"vtf":var k=y[y.length-1];case"vtc":y[3]==="nl"?w[m][v]=!!+y[4]:w[m][v]=+y[4],y[2]=="vtf"&&(w[m][v]=[w[m][v],k])}}}return d&&d.sheetRows&&(w=w.slice(0,d.sheetRows)),w}function n(h,d){return kd(r(h,d),d)}function i(h,d){return xl(n(h,d),d)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,a=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var d=[],f=[],m,v="",g=Vi(h["!ref"]),w=Array.isArray(h),y=g.s.r;y<=g.e.r;++y)for(var C=g.s.c;C<=g.e.c;++C)if(v=zt({r:y,c:C}),m=w?(h[y]||[])[C]:h[v],!(!m||m.v==null||m.t==="z")){switch(f=["cell",v,"t"],m.t){case"s":case"str":f.push(t(m.v));break;case"n":m.f?(f[2]="vtf",f[3]="n",f[4]=m.v,f[5]=t(m.f)):(f[2]="v",f[3]=m.v);break;case"b":f[2]="vt"+(m.f?"f":"c"),f[3]="nl",f[4]=m.v?"1":"0",f[5]=t(m.f||(m.v?"TRUE":"FALSE"));break;case"d":var k=Ln(Zr(m.v));f[2]="vtc",f[3]="nd",f[4]=""+k,f[5]=m.w||As(m.z||Gt[14],k);break;case"e":continue}d.push(f.join(":"))}return d.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),d.push("valueformat:1:text-wiki"),d.join(`
`)}function u(h){return[s,o,a,o,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}})(),gd=(function(){function e(u,h,d,f,m){m.raw?h[d][f]=u:u===""||(u==="TRUE"?h[d][f]=!0:u==="FALSE"?h[d][f]=!1:isNaN($s(u))?isNaN(pd(u).getDate())?h[d][f]=u:h[d][f]=Zr(u):h[d][f]=$s(u))}function t(u,h){var d=h||{},f=[];if(!u||u.length===0)return f;for(var m=u.split(/[\r\n]/),v=m.length-1;v>=0&&m[v].length===0;)--v;for(var g=10,w=0,y=0;y<=v;++y)w=m[y].indexOf(" "),w==-1?w=m[y].length:w++,g=Math.max(g,w);for(y=0;y<=v;++y){f[y]=[];var C=0;for(e(m[y].slice(0,g).trim(),f,y,C,d),C=1;C<=(m[y].length-g)/10+1;++C)e(m[y].slice(g+(C-1)*10,g+C*10).trim(),f,y,C,d)}return d.sheetRows&&(f=f.slice(0,d.sheetRows)),f}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},d=!1,f=0,m=0;f<u.length;++f)(m=u.charCodeAt(f))==34?d=!d:!d&&m in r&&(h[m]=(h[m]||0)+1);m=[];for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&m.push([h[f],f]);if(!m.length){h=n;for(f in h)Object.prototype.hasOwnProperty.call(h,f)&&m.push([h[f],f])}return m.sort(function(v,g){return v[0]-g[0]||n[v[1]]-n[g[1]]}),r[m.pop()[1]]||44}function s(u,h){var d=h||{},f="",m=d.dense?[]:{},v={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(f=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(f=u.charAt(4),u=u.slice(6)):f=i(u.slice(0,1024)):d&&d.FS?f=d.FS:f=i(u.slice(0,1024));var g=0,w=0,y=0,C=0,k=0,F=f.charCodeAt(0),I=!1,N=0,j=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var L=d.dateNF!=null?fK(d.dateNF):null;function W(){var K=u.slice(C,k),z={};if(K.charAt(0)=='"'&&K.charAt(K.length-1)=='"'&&(K=K.slice(1,-1).replace(/""/g,'"')),K.length===0)z.t="z";else if(d.raw)z.t="s",z.v=K;else if(K.trim().length===0)z.t="s",z.v=K;else if(K.charCodeAt(0)==61)K.charCodeAt(1)==34&&K.charCodeAt(K.length-1)==34?(z.t="s",z.v=K.slice(2,-1).replace(/""/g,'"')):GQ(K)?(z.t="n",z.f=K.slice(1)):(z.t="s",z.v=K);else if(K=="TRUE")z.t="b",z.v=!0;else if(K=="FALSE")z.t="b",z.v=!1;else if(!isNaN(y=$s(K)))z.t="n",d.cellText!==!1&&(z.w=K),z.v=y;else if(!isNaN(pd(K).getDate())||L&&K.match(L)){z.z=d.dateNF||Gt[14];var M=0;L&&K.match(L)&&(K=pK(K,d.dateNF,K.match(L)||[]),M=1),d.cellDates?(z.t="d",z.v=Zr(K,M)):(z.t="n",z.v=Ln(Zr(K,M))),d.cellText!==!1&&(z.w=As(z.z,z.v instanceof Date?Ln(z.v):z.v)),d.cellNF||delete z.z}else z.t="s",z.v=K;if(z.t=="z"||(d.dense?(m[g]||(m[g]=[]),m[g][w]=z):m[zt({c:w,r:g})]=z),C=k+1,j=u.charCodeAt(C),v.e.c<w&&(v.e.c=w),v.e.r<g&&(v.e.r=g),N==F)++w;else if(w=0,++g,d.sheetRows&&d.sheetRows<=g)return!0}e:for(;k<u.length;++k)switch(N=u.charCodeAt(k)){case 34:j===34&&(I=!I);break;case F:case 10:case 13:if(!I&&W())break e;break}return k-C>0&&W(),m["!ref"]=er(v),m}function o(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?s(u,h):kd(t(u,h),h)}function a(u,h){var d="",f=h.type=="string"?[0,0,0,0]:LC(u,h);switch(h.type){case"base64":d=is(u);break;case"binary":d=u;break;case"buffer":h.codepage==65001?d=u.toString("utf8"):h.codepage&&typeof yf<"u"||(d=ar&&Buffer.isBuffer(u)?u.toString("binary"):Cl(u));break;case"array":d=xc(u);break;case"string":d=u;break;default:throw new Error("Unrecognized type "+h.type)}return f[0]==239&&f[1]==187&&f[2]==191?d=Ur(d.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?d=Ur(d):h.type=="binary"&&typeof yf<"u",d.slice(0,19)=="socialcalc:version:"?j5.to_sheet(h.type=="string"?d:Ur(d),h):o(d,h)}function l(u,h){return xl(a(u,h),h)}function c(u){for(var h=[],d=Sr(u["!ref"]),f,m=Array.isArray(u),v=d.s.r;v<=d.e.r;++v){for(var g=[],w=d.s.c;w<=d.e.c;++w){var y=zt({r:v,c:w});if(f=m?(u[v]||[])[w]:u[y],!f||f.v==null){g.push("          ");continue}for(var C=(f.w||(ua(f),f.w)||"").slice(0,10);C.length<10;)C+=" ";g.push(C+(w===0?" ":""))}h.push(g.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:a,from_sheet:c}})();function RZ(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var i=B5.to_workbook(e,r);return r.WTF=n,i}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return gd.to_workbook(e,t)}}var hc=(function(){function e(P,q,X){if(P){ti(P,P.l||0);for(var Q=X.Enum||D;P.l<P.length;){var G=P.read_shift(2),ee=Q[G]||Q[65535],V=P.read_shift(2),H=P.l+V,Z=ee.f&&ee.f(P,V,X);if(P.l=H,q(Z,ee,G))return}}}function t(P,q){switch(q.type){case"base64":return r(Qi(is(P)),q);case"binary":return r(Qi(P),q);case"buffer":case"array":return r(P,q)}throw"Unsupported type "+q.type}function r(P,q){if(!P)return P;var X=q||{},Q=X.dense?[]:{},G="Sheet1",ee="",V=0,H={},Z=[],ie=[],te={s:{r:0,c:0},e:{r:0,c:0}},oe=X.sheetRows||0;if(P[2]==0&&(P[3]==8||P[3]==9)&&P.length>=16&&P[14]==5&&P[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(P[2]==2)X.Enum=D,e(P,function(ne,me,ve){switch(ve){case 0:X.vers=ne,ne>=4096&&(X.qpro=!0);break;case 6:te=ne;break;case 204:ne&&(ee=ne);break;case 222:ee=ne;break;case 15:case 51:X.qpro||(ne[1].v=ne[1].v.slice(1));case 13:case 14:case 16:ve==14&&(ne[2]&112)==112&&(ne[2]&15)>1&&(ne[2]&15)<15&&(ne[1].z=X.dateNF||Gt[14],X.cellDates&&(ne[1].t="d",ne[1].v=ym(ne[1].v))),X.qpro&&ne[3]>V&&(Q["!ref"]=er(te),H[G]=Q,Z.push(G),Q=X.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},V=ne[3],G=ee||"Sheet"+(V+1),ee="");var Te=X.dense?(Q[ne[0].r]||[])[ne[0].c]:Q[zt(ne[0])];if(Te){Te.t=ne[1].t,Te.v=ne[1].v,ne[1].z!=null&&(Te.z=ne[1].z),ne[1].f!=null&&(Te.f=ne[1].f);break}X.dense?(Q[ne[0].r]||(Q[ne[0].r]=[]),Q[ne[0].r][ne[0].c]=ne[1]):Q[zt(ne[0])]=ne[1];break}},X);else if(P[2]==26||P[2]==14)X.Enum=O,P[2]==14&&(X.qpro=!0,P.l=0),e(P,function(ne,me,ve){switch(ve){case 204:G=ne;break;case 22:ne[1].v=ne[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(ne[3]>V&&(Q["!ref"]=er(te),H[G]=Q,Z.push(G),Q=X.dense?[]:{},te={s:{r:0,c:0},e:{r:0,c:0}},V=ne[3],G="Sheet"+(V+1)),oe>0&&ne[0].r>=oe)break;X.dense?(Q[ne[0].r]||(Q[ne[0].r]=[]),Q[ne[0].r][ne[0].c]=ne[1]):Q[zt(ne[0])]=ne[1],te.e.c<ne[0].c&&(te.e.c=ne[0].c),te.e.r<ne[0].r&&(te.e.r=ne[0].r);break;case 27:ne[14e3]&&(ie[ne[14e3][0]]=ne[14e3][1]);break;case 1537:ie[ne[0]]=ne[1],ne[0]==V&&(G=ne[1]);break}},X);else throw new Error("Unrecognized LOTUS BOF "+P[2]);if(Q["!ref"]=er(te),H[ee||G]=Q,Z.push(ee||G),!ie.length)return{SheetNames:Z,Sheets:H};for(var ue={},Ce=[],ye=0;ye<ie.length;++ye)H[Z[ye]]?(Ce.push(ie[ye]||Z[ye]),ue[ie[ye]]=H[ie[ye]]||H[Z[ye]]):(Ce.push(ie[ye]),ue[ie[ye]]={"!ref":"A1"});return{SheetNames:Ce,Sheets:ue}}function n(P,q){var X=q||{};if(+X.codepage>=0&&zs(+X.codepage),X.type=="string")throw new Error("Cannot write WK1 to JS string");var Q=Bi(),G=Sr(P["!ref"]),ee=Array.isArray(P),V=[];vt(Q,0,s(1030)),vt(Q,6,l(G));for(var H=Math.min(G.e.r,8191),Z=G.s.r;Z<=H;++Z)for(var ie=Sn(Z),te=G.s.c;te<=G.e.c;++te){Z===G.s.r&&(V[te]=sn(te));var oe=V[te]+ie,ue=ee?(P[Z]||[])[te]:P[oe];if(!(!ue||ue.t=="z"))if(ue.t=="n")(ue.v|0)==ue.v&&ue.v>=-32768&&ue.v<=32767?vt(Q,13,f(Z,te,ue.v)):vt(Q,14,v(Z,te,ue.v));else{var Ce=ua(ue);vt(Q,15,h(Z,te,Ce.slice(0,239)))}}return vt(Q,1),Q.end()}function i(P,q){var X=q||{};if(+X.codepage>=0&&zs(+X.codepage),X.type=="string")throw new Error("Cannot write WK3 to JS string");var Q=Bi();vt(Q,0,o(P));for(var G=0,ee=0;G<P.SheetNames.length;++G)(P.Sheets[P.SheetNames[G]]||{})["!ref"]&&vt(Q,27,E(P.SheetNames[G],ee++));var V=0;for(G=0;G<P.SheetNames.length;++G){var H=P.Sheets[P.SheetNames[G]];if(!(!H||!H["!ref"])){for(var Z=Sr(H["!ref"]),ie=Array.isArray(H),te=[],oe=Math.min(Z.e.r,8191),ue=Z.s.r;ue<=oe;++ue)for(var Ce=Sn(ue),ye=Z.s.c;ye<=Z.e.c;++ye){ue===Z.s.r&&(te[ye]=sn(ye));var ne=te[ye]+Ce,me=ie?(H[ue]||[])[ye]:H[ne];if(!(!me||me.t=="z"))if(me.t=="n")vt(Q,23,W(ue,ye,V,me.v));else{var ve=ua(me);vt(Q,22,N(ue,ye,V,ve.slice(0,239)))}}++V}}return vt(Q,1),Q.end()}function s(P){var q=Je(2);return q.write_shift(2,P),q}function o(P){var q=Je(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var X=0,Q=0,G=0,ee=0;ee<P.SheetNames.length;++ee){var V=P.SheetNames[ee],H=P.Sheets[V];if(!(!H||!H["!ref"])){++G;var Z=Vi(H["!ref"]);X<Z.e.r&&(X=Z.e.r),Q<Z.e.c&&(Q=Z.e.c)}}return X>8191&&(X=8191),q.write_shift(2,X),q.write_shift(1,G),q.write_shift(1,Q),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function a(P,q,X){var Q={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&X.qpro?(Q.s.c=P.read_shift(1),P.l++,Q.s.r=P.read_shift(2),Q.e.c=P.read_shift(1),P.l++,Q.e.r=P.read_shift(2),Q):(Q.s.c=P.read_shift(2),Q.s.r=P.read_shift(2),q==12&&X.qpro&&(P.l+=2),Q.e.c=P.read_shift(2),Q.e.r=P.read_shift(2),q==12&&X.qpro&&(P.l+=2),Q.s.c==65535&&(Q.s.c=Q.e.c=Q.s.r=Q.e.r=0),Q)}function l(P){var q=Je(8);return q.write_shift(2,P.s.c),q.write_shift(2,P.s.r),q.write_shift(2,P.e.c),q.write_shift(2,P.e.r),q}function c(P,q,X){var Q=[{c:0,r:0},{t:"n",v:0},0,0];return X.qpro&&X.vers!=20768?(Q[0].c=P.read_shift(1),Q[3]=P.read_shift(1),Q[0].r=P.read_shift(2),P.l+=2):(Q[2]=P.read_shift(1),Q[0].c=P.read_shift(2),Q[0].r=P.read_shift(2)),Q}function u(P,q,X){var Q=P.l+q,G=c(P,q,X);if(G[1].t="s",X.vers==20768){P.l++;var ee=P.read_shift(1);return G[1].v=P.read_shift(ee,"utf8"),G}return X.qpro&&P.l++,G[1].v=P.read_shift(Q-P.l,"cstr"),G}function h(P,q,X){var Q=Je(7+X.length);Q.write_shift(1,255),Q.write_shift(2,q),Q.write_shift(2,P),Q.write_shift(1,39);for(var G=0;G<Q.length;++G){var ee=X.charCodeAt(G);Q.write_shift(1,ee>=128?95:ee)}return Q.write_shift(1,0),Q}function d(P,q,X){var Q=c(P,q,X);return Q[1].v=P.read_shift(2,"i"),Q}function f(P,q,X){var Q=Je(7);return Q.write_shift(1,255),Q.write_shift(2,q),Q.write_shift(2,P),Q.write_shift(2,X,"i"),Q}function m(P,q,X){var Q=c(P,q,X);return Q[1].v=P.read_shift(8,"f"),Q}function v(P,q,X){var Q=Je(13);return Q.write_shift(1,255),Q.write_shift(2,q),Q.write_shift(2,P),Q.write_shift(8,X,"f"),Q}function g(P,q,X){var Q=P.l+q,G=c(P,q,X);if(G[1].v=P.read_shift(8,"f"),X.qpro)P.l=Q;else{var ee=P.read_shift(2);k(P.slice(P.l,P.l+ee),G),P.l+=ee}return G}function w(P,q,X){var Q=q&32768;return q&=-32769,q=(Q?P:0)+(q>=8192?q-16384:q),(Q?"":"$")+(X?sn(q):Sn(q))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},C=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(P,q){ti(P,0);for(var X=[],Q=0,G="",ee="",V="",H="";P.l<P.length;){var Z=P[P.l++];switch(Z){case 0:X.push(P.read_shift(8,"f"));break;case 1:ee=w(q[0].c,P.read_shift(2),!0),G=w(q[0].r,P.read_shift(2),!1),X.push(ee+G);break;case 2:{var ie=w(q[0].c,P.read_shift(2),!0),te=w(q[0].r,P.read_shift(2),!1);ee=w(q[0].c,P.read_shift(2),!0),G=w(q[0].r,P.read_shift(2),!1),X.push(ie+te+":"+ee+G)}break;case 3:if(P.l<P.length){console.error("WK1 premature formula end");return}break;case 4:X.push("("+X.pop()+")");break;case 5:X.push(P.read_shift(2));break;case 6:{for(var oe="";Z=P[P.l++];)oe+=String.fromCharCode(Z);X.push('"'+oe.replace(/"/g,'""')+'"')}break;case 8:X.push("-"+X.pop());break;case 23:X.push("+"+X.pop());break;case 22:X.push("NOT("+X.pop()+")");break;case 20:case 21:H=X.pop(),V=X.pop(),X.push(["AND","OR"][Z-20]+"("+V+","+H+")");break;default:if(Z<32&&C[Z])H=X.pop(),V=X.pop(),X.push(V+C[Z]+H);else if(y[Z]){if(Q=y[Z][1],Q==69&&(Q=P[P.l++]),Q>X.length){console.error("WK1 bad formula parse 0x"+Z.toString(16)+":|"+X.join("|")+"|");return}var ue=X.slice(-Q);X.length-=Q,X.push(y[Z][0]+"("+ue.join(",")+")")}else return Z<=7?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=24?console.error("WK1 unsupported op "+Z.toString(16)):Z<=30?console.error("WK1 invalid opcode "+Z.toString(16)):Z<=115?console.error("WK1 unsupported function opcode "+Z.toString(16)):console.error("WK1 unrecognized opcode "+Z.toString(16))}}X.length==1?q[1].f=""+X[0]:console.error("WK1 bad formula parse |"+X.join("|")+"|")}function F(P){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=P.read_shift(2),q[3]=P[P.l++],q[0].c=P[P.l++],q}function I(P,q){var X=F(P);return X[1].t="s",X[1].v=P.read_shift(q-4,"cstr"),X}function N(P,q,X,Q){var G=Je(6+Q.length);G.write_shift(2,P),G.write_shift(1,X),G.write_shift(1,q),G.write_shift(1,39);for(var ee=0;ee<Q.length;++ee){var V=Q.charCodeAt(ee);G.write_shift(1,V>=128?95:V)}return G.write_shift(1,0),G}function j(P,q){var X=F(P);X[1].v=P.read_shift(2);var Q=X[1].v>>1;if(X[1].v&1)switch(Q&7){case 0:Q=(Q>>3)*5e3;break;case 1:Q=(Q>>3)*500;break;case 2:Q=(Q>>3)/20;break;case 3:Q=(Q>>3)/200;break;case 4:Q=(Q>>3)/2e3;break;case 5:Q=(Q>>3)/2e4;break;case 6:Q=(Q>>3)/16;break;case 7:Q=(Q>>3)/64;break}return X[1].v=Q,X}function L(P,q){var X=F(P),Q=P.read_shift(4),G=P.read_shift(4),ee=P.read_shift(2);if(ee==65535)return Q===0&&G===3221225472?(X[1].t="e",X[1].v=15):Q===0&&G===3489660928?(X[1].t="e",X[1].v=42):X[1].v=0,X;var V=ee&32768;return ee=(ee&32767)-16446,X[1].v=(1-V*2)*(G*Math.pow(2,ee+32)+Q*Math.pow(2,ee)),X}function W(P,q,X,Q){var G=Je(14);if(G.write_shift(2,P),G.write_shift(1,X),G.write_shift(1,q),Q==0)return G.write_shift(4,0),G.write_shift(4,0),G.write_shift(2,65535),G;var ee=0,V=0,H=0,Z=0;return Q<0&&(ee=1,Q=-Q),V=Math.log2(Q)|0,Q/=Math.pow(2,V-31),Z=Q>>>0,(Z&2147483648)==0&&(Q/=2,++V,Z=Q>>>0),Q-=Z,Z|=2147483648,Z>>>=0,Q*=Math.pow(2,32),H=Q>>>0,G.write_shift(4,H),G.write_shift(4,Z),V+=16383+(ee?32768:0),G.write_shift(2,V),G}function K(P,q){var X=L(P);return P.l+=q-14,X}function z(P,q){var X=F(P),Q=P.read_shift(4);return X[1].v=Q>>6,X}function M(P,q){var X=F(P),Q=P.read_shift(8,"f");return X[1].v=Q,X}function B(P,q){var X=M(P);return P.l+=q-10,X}function R(P,q){return P[P.l+q-1]==0?P.read_shift(q,"cstr"):""}function S(P,q){var X=P[P.l++];X>q-1&&(X=q-1);for(var Q="";Q.length<X;)Q+=String.fromCharCode(P[P.l++]);return Q}function _(P,q,X){if(!(!X.qpro||q<21)){var Q=P.read_shift(1);P.l+=17,P.l+=1,P.l+=2;var G=P.read_shift(q-21,"cstr");return[Q,G]}}function T(P,q){for(var X={},Q=P.l+q;P.l<Q;){var G=P.read_shift(2);if(G==14e3){for(X[G]=[0,""],X[G][0]=P.read_shift(2);P[P.l];)X[G][1]+=String.fromCharCode(P[P.l]),P.l++;P.l++}}return X}function E(P,q){var X=Je(5+P.length);X.write_shift(2,14e3),X.write_shift(2,q);for(var Q=0;Q<P.length;++Q){var G=P.charCodeAt(Q);X[X.l++]=G>127?95:G}return X[X.l++]=0,X}var D={0:{n:"BOF",f:Mn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:a},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:d},14:{n:"NUMBER",f:m},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:R},222:{n:"SHEETNAMELP",f:S},65535:{n:""}},O={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:I},23:{n:"NUMBER17",f:L},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:K},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:T},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:M},40:{n:"FORMULA28",f:B},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:R},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}})();function AZ(e){var t={},r=e.match(vi),n=0,i=!1;if(r)for(;n!=r.length;++n){var s=Wt(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=eC[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var FZ=(function(){var e=Sf("t"),t=Sf("rPr");function r(s){var o=s.match(e);if(!o)return{t:"s",v:""};var a={t:"s",v:xr(o[1])},l=s.match(t);return l&&(a.s=AZ(l[1])),a}var n=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(o){return o.replace(n,"").split(i).map(r).filter(function(a){return a.v})}})(),MZ=(function(){var t=/(\r\n|\n)/g;function r(i,s,o){var a=[];i.u&&a.push("text-decoration: underline;"),i.uval&&a.push("text-underline-style:"+i.uval+";"),i.sz&&a.push("font-size:"+i.sz+"pt;"),i.outline&&a.push("text-effect: outline;"),i.shadow&&a.push("text-shadow: auto;"),s.push('<span style="'+a.join("")+'">'),i.b&&(s.push("<b>"),o.push("</b>")),i.i&&(s.push("<i>"),o.push("</i>")),i.strike&&(s.push("<s>"),o.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),o.push("</"+l+">")),o.push("</span>"),i}function n(i){var s=[[],i.v,[]];return i.v?(i.s&&r(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}})(),DZ=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,PZ=/<(?:\w+:)?r>/,IZ=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function _C(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=xr(Ur(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=Ur(e),r&&(n.h=uC(n.t))):e.match(PZ)&&(n.r=Ur(e),n.t=xr(Ur((e.replace(IZ,"").match(DZ)||[]).join("").replace(vi,""))),r&&(n.h=MZ(FZ(n.r)))),n):{t:""}}var OZ=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,NZ=/<(?:\w+:)?(?:si|sstItem)>/g,LZ=/<\/(?:\w+:)?(?:si|sstItem)>/;function BZ(e,t){var r=[],n="";if(!e)return r;var i=e.match(OZ);if(i){n=i[2].replace(NZ,"").split(LZ);for(var s=0;s!=n.length;++s){var o=_C(n[s].trim(),t);o!=null&&(r[r.length]=o)}i=Wt(i[1]),r.Count=i.count,r.Unique=i.uniqueCount}return r}var HZ=/^\s|\s$|[\t\n\r]/;function V5(e,t){if(!t.bookSST)return"";var r=[_n];r[r.length]=mt("sst",null,{xmlns:Pc[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(HZ)&&(s+=' xml:space="preserve"'),s+=">"+Br(i.t)+"</t>"),s+="</si>",r[r.length]=s}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function jZ(e){return[e.read_shift(4),e.read_shift(4)]}function VZ(e,t){var r=[],n=!1;return ga(e,function(s,o,a){switch(a){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(o.T,!n||t.WTF)throw new Error("Unexpected record 0x"+a.toString(16))}}),r}function GZ(e,t){return t||(t=Je(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var zZ=QK;function UZ(e){var t=Bi();lt(t,159,GZ(e));for(var r=0;r<e.length;++r)lt(t,19,zZ(e[r]));return lt(t,160),t.end()}function G5(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function oa(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function WZ(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=oa(e,4),t.U=oa(e,4),t.W=oa(e,4),t}function $Z(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function qZ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push($Z(e));return t}function KZ(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function XZ(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=oa(e,4),t.U=oa(e,4),t.W=oa(e,4),t}function YZ(e){var t=XZ(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function z5(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var i=!1;switch(n.AlgID){case 26126:case 26127:case 26128:i=n.Flags==36;break;case 26625:i=n.Flags==4;break;case 0:i=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function U5(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function ZZ(e){var t=oa(e);switch(t.Minor){case 2:return[t.Minor,JZ(e)];case 3:return[t.Minor,QZ()];case 4:return[t.Minor,eJ(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function JZ(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=z5(e,r),i=U5(e,e.length-e.l);return{t:"Std",h:n,v:i}}function QZ(){throw new Error("File is password-protected: ECMA-376 Extensible")}function eJ(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(vi,function(s){var o=Wt(s);switch(Ro(o[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(a){n[a]=o[a]});break;case"<dataIntegrity":n.encryptedHmacKey=o.encryptedHmacKey,n.encryptedHmacValue=o.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=o.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(o);break;default:throw o[0]}}),n}function tJ(e,t){var r={},n=r.EncryptionVersionInfo=oa(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,r.EncryptionHeader=z5(e,i),t-=i,r.EncryptionVerifier=U5(e,t),r}function rJ(e){var t={},r=t.EncryptionVersionInfo=oa(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function EC(e){var t=0,r,n=G5(e),i=n.length+1,s,o,a,l,c;for(r=dl(i),r[0]=n.length,s=1;s!=i;++s)r[s]=n[s-1];for(s=i-1;s>=0;--s)o=r[s],a=(t&16384)===0?0:1,l=t<<1&32767,c=a|l,t=c^o;return t^52811}var W5=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(o){return(o/2|o*128)&255},i=function(o,a){return n(o^a)},s=function(o){for(var a=t[o.length-1],l=104,c=o.length-1;c>=0;--c)for(var u=o[c],h=0;h!=7;++h)u&64&&(a^=r[l]),u*=2,--l;return a};return function(o){for(var a=G5(o),l=s(a),c=a.length,u=dl(16),h=0;h!=16;++h)u[h]=0;var d,f,m;for((c&1)===1&&(d=l>>8,u[c]=i(e[0],d),--c,d=l&255,f=a[a.length-1],u[c]=i(f,d));c>0;)--c,d=l>>8,u[c]=i(a[c],d),--c,d=l&255,u[c]=i(a[c],d);for(c=15,m=15-a.length;m>0;)d=l>>8,u[c]=i(e[m],d),--c,--m,d=l&255,u[c]=i(a[c],d),--c,--m;return u}})(),nJ=function(e,t,r,n,i){i||(i=t),n||(n=W5(e));var s,o;for(s=0;s!=t.length;++s)o=t[s],o^=n[r],o=(o>>5|o<<3)&255,i[s]=o,++r;return[i,r,n]},iJ=function(e){var t=0,r=W5(e);return function(n){var i=nJ("",n,t,r);return t=i[1],i[0]}};function sJ(e,t,r,n){var i={key:Mn(e),verificationBytes:Mn(e)};return r.password&&(i.verifier=EC(r.password)),n.valid=i.verificationBytes===i.verifier,n.valid&&(n.insitu=iJ(r.password)),i}function oJ(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=rJ(e):n.Data=tJ(e,t),n}function aJ(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?oJ(e,t-2,n):sJ(e,r.biff>=8?t:t-2,r,n),n}var $5=(function(){function e(i,s){switch(s.type){case"base64":return t(is(i),s);case"binary":return t(i,s);case"buffer":return t(ar&&Buffer.isBuffer(i)?i.toString("binary"):Cl(i),s);case"array":return t(xc(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var o=s||{},a=o.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(a)&&(a[h]=[]);for(var d=/\\\w+\b/g,f=0,m,v=-1;m=d.exec(u);){switch(m[0]){case"\\cell":var g=u.slice(f,d.lastIndex-m[0].length);if(g[0]==" "&&(g=g.slice(1)),++v,g.length){var w={v:g,t:"s"};Array.isArray(a)?a[h][v]=w:a[zt({r:h,c:v})]=w}break}f=d.lastIndex}v>c.e.c&&(c.e.c=v)}),a["!ref"]=er(c),a}function r(i,s){return xl(e(i,s),s)}function n(i){for(var s=["{\\rtf1\\ansi"],o=Sr(i["!ref"]),a,l=Array.isArray(i),c=o.s.r;c<=o.e.r;++c){s.push("\\trowd\\trautofit1");for(var u=o.s.c;u<=o.e.c;++u)s.push("\\cellx"+(u+1));for(s.push("\\pard\\intbl"),u=o.s.c;u<=o.e.c;++u){var h=zt({r:c,c:u});a=l?(i[c]||[])[u]:i[h],!(!a||a.v==null&&(!a.f||a.F))&&(s.push(" "+(a.w||(ua(a),a.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function lJ(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function kf(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function cJ(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.max(t,r,n),s=Math.min(t,r,n),o=i-s;if(o===0)return[0,0,t];var a=0,l=0,c=i+s;switch(l=o/(c>1?2-c:c),i){case t:a=((r-n)/o+6)%6;break;case r:a=(n-t)/o+2;break;case n:a=(t-r)/o+4;break}return[a/6,l,c/2]}function uJ(e){var t=e[0],r=e[1],n=e[2],i=r*2*(n<.5?n:1-n),s=n-i/2,o=[s,s,s],a=6*t,l;if(r!==0)switch(a|0){case 0:case 6:l=i*a,o[0]+=i,o[1]+=l;break;case 1:l=i*(2-a),o[0]+=l,o[1]+=i;break;case 2:l=i*(a-2),o[1]+=i,o[2]+=l;break;case 3:l=i*(4-a),o[1]+=l,o[2]+=i;break;case 4:l=i*(a-4),o[2]+=i,o[0]+=l;break;case 5:l=i*(6-a),o[2]+=l,o[0]+=i;break}for(var c=0;c!=3;++c)o[c]=Math.round(o[c]*255);return o}function $0(e,t){if(t===0)return e;var r=cJ(lJ(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),kf(uJ(r))}var q5=6,dJ=15,hJ=1,hi=q5;function Rf(e){return Math.floor((e+Math.round(128/hi)/256)*hi)}function Af(e){return Math.floor((e-5)/hi*100+.5)/100}function q0(e){return Math.round((e*hi+5)/hi*256)/256}function Eb(e){return q0(Af(Rf(e)))}function TC(e){var t=Math.abs(e-Eb(e)),r=hi;if(t>.005)for(hi=hJ;hi<dJ;++hi)Math.abs(e-Eb(e))<=t&&(t=Math.abs(e-Eb(e)),r=hi);hi=r}function hl(e){e.width?(e.wpx=Rf(e.width),e.wch=Af(e.wpx),e.MDW=hi):e.wpx?(e.wch=Af(e.wpx),e.width=q0(e.wch),e.MDW=hi):typeof e.wch=="number"&&(e.width=q0(e.wch),e.wpx=Rf(e.width),e.MDW=hi),e.customWidth&&delete e.customWidth}var fJ=96,K5=fJ;function Ff(e){return e*96/K5}function md(e){return e*K5/96}var pJ={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function gJ(e,t,r,n){t.Borders=[];var i={},s=!1;(e[0].match(vi)||[]).forEach(function(o){var a=Wt(o);switch(Ro(a[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},a.diagonalUp&&(i.diagonalUp=Xr(a.diagonalUp)),a.diagonalDown&&(i.diagonalDown=Xr(a.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in borders")}})}function mJ(e,t,r,n){t.Fills=[];var i={},s=!1;(e[0].match(vi)||[]).forEach(function(o){var a=Wt(o);switch(Ro(a[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":a.patternType&&(i.patternType=a.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),a.indexed&&(i.bgColor.indexed=parseInt(a.indexed,10)),a.theme&&(i.bgColor.theme=parseInt(a.theme,10)),a.tint&&(i.bgColor.tint=parseFloat(a.tint)),a.rgb&&(i.bgColor.rgb=a.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),a.theme&&(i.fgColor.theme=parseInt(a.theme,10)),a.tint&&(i.fgColor.tint=parseFloat(a.tint)),a.rgb!=null&&(i.fgColor.rgb=a.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fills")}})}function vJ(e,t,r,n){t.Fonts=[];var i={},s=!1;(e[0].match(vi)||[]).forEach(function(o){var a=Wt(o);switch(Ro(a[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":a.val&&(i.name=Ur(a.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=a.val?Xr(a.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=a.val?Xr(a.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(a.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=a.val?Xr(a.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=a.val?Xr(a.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=a.val?Xr(a.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=a.val?Xr(a.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=a.val?Xr(a.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":a.val&&(i.sz=+a.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":a.val&&(i.vertAlign=a.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":a.val&&(i.family=parseInt(a.val,10));break;case"<family/>":case"</family>":break;case"<scheme":a.val&&(i.scheme=a.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(a.val=="1")break;a.codepage=eC[parseInt(a.val,10)];break;case"<color":if(i.color||(i.color={}),a.auto&&(i.color.auto=Xr(a.auto)),a.rgb)i.color.rgb=a.rgb.slice(-6);else if(a.indexed){i.color.index=parseInt(a.indexed,10);var l=uc[i.color.index];i.color.index==81&&(l=uc[1]),l||(l=uc[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else a.theme&&(i.color.theme=parseInt(a.theme,10),a.tint&&(i.color.tint=parseFloat(a.tint)),a.theme&&r.themeElements&&r.themeElements.clrScheme&&(i.color.rgb=$0(r.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+a[0]+" in fonts")}})}function bJ(e,t,r){t.NumberFmt=[];for(var n=hn(Gt),i=0;i<n.length;++i)t.NumberFmt[n[i]]=Gt[n[i]];var s=e[0].match(vi);if(s)for(i=0;i<s.length;++i){var o=Wt(s[i]);switch(Ro(o[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var a=xr(Ur(o.formatCode)),l=parseInt(o.numFmtId,10);if(t.NumberFmt[l]=a,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=a}sa(a,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+o[0]+" in numFmts")}}}function wJ(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=mt("numFmt",null,{numFmtId:n,formatCode:Br(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=mt("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Dg=["numFmtId","fillId","fontId","borderId","xfId"],Pg=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function yJ(e,t,r){t.CellXf=[];var n,i=!1;(e[0].match(vi)||[]).forEach(function(s){var o=Wt(s),a=0;switch(Ro(o[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=o,delete n[0],a=0;a<Dg.length;++a)n[Dg[a]]&&(n[Dg[a]]=parseInt(n[Dg[a]],10));for(a=0;a<Pg.length;++a)n[Pg[a]]&&(n[Pg[a]]=Xr(n[Pg[a]]));if(t.NumberFmt&&n.numFmtId>392){for(a=392;a>60;--a)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[a]){n.numFmtId=a;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};o.vertical&&(l.vertical=o.vertical),o.horizontal&&(l.horizontal=o.horizontal),o.textRotation!=null&&(l.textRotation=o.textRotation),o.indent&&(l.indent=o.indent),o.wrapText&&(l.wrapText=Xr(o.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(r&&r.WTF&&!i)throw new Error("unrecognized "+o[0]+" in cellXfs")}})}function CJ(e){var t=[];return t[t.length]=mt("cellXfs",null),e.forEach(function(r){t[t.length]=mt("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=mt("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var xJ=(function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(a,l,c){var u={};if(!a)return u;a=a.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=a.match(t))&&bJ(h,u,c),(h=a.match(i))&&vJ(h,u,l,c),(h=a.match(n))&&mJ(h,u,l,c),(h=a.match(s))&&gJ(h,u,l,c),(h=a.match(r))&&yJ(h,u,c),u}})();function X5(e,t){var r=[_n,mt("styleSheet",null,{xmlns:Pc[0],"xmlns:vt":Nn.vt})],n;return e.SSF&&(n=wJ(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=CJ(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function SJ(e,t){var r=e.read_shift(2),n=pi(e);return[r,n]}function _J(e,t,r){r||(r=Je(6+4*t.length)),r.write_shift(2,e),Un(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function EJ(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=oX(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var o=e.read_shift(1);o!=0&&(n.underline=o);var a=e.read_shift(1);a>0&&(n.family=a);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=sX(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=pi(e),n}function TJ(e,t){t||(t=Je(153)),t.write_shift(2,e.sz*20),aX(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),z0(e.color,t);var n=0;return n=2,t.write_shift(1,n),Un(e.name,t),t.length>t.l?t.slice(0,t.l):t}var kJ=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Tb,RJ=gi;function oE(e,t){t||(t=Je(84)),Tb||(Tb=bm(kJ));var r=Tb[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(z0({auto:1},t),z0({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function AJ(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function Y5(e,t,r){r||(r=Je(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Th(e,t){return t||(t=Je(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var FJ=gi;function MJ(e,t){return t||(t=Je(51)),t.write_shift(1,0),Th(null,t),Th(null,t),Th(null,t),Th(null,t),Th(null,t),t.length>t.l?t.slice(0,t.l):t}function DJ(e,t){return t||(t=Je(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),G0(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function PJ(e,t,r){var n=Je(2052);return n.write_shift(4,e),G0(t,n),G0(r,n),n.length>n.l?n.slice(0,n.l):n}function IJ(e,t,r){var n={};n.NumberFmt=[];for(var i in Gt)n.NumberFmt[i]=Gt[i];n.CellXf=[],n.Fonts=[];var s=[],o=!1;return ga(e,function(l,c,u){switch(u){case 44:n.NumberFmt[l[0]]=l[1],sa(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=$0(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:s.push(u),o=!0;break;case 38:s.pop(),o=!1;break;default:if(c.T>0)s.push(u);else if(c.T<0)s.pop();else if(!o||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+u.toString(16))}}),n}function OJ(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&(lt(e,615,qs(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&lt(e,44,_J(i,t[i]))}),lt(e,616))}}function NJ(e){var t=1;lt(e,611,qs(t)),lt(e,43,TJ({sz:12,color:{theme:1},name:"Calibri",family:2})),lt(e,612)}function LJ(e){var t=2;lt(e,603,qs(t)),lt(e,45,oE({patternType:"none"})),lt(e,45,oE({patternType:"gray125"})),lt(e,604)}function BJ(e){var t=1;lt(e,613,qs(t)),lt(e,46,MJ()),lt(e,614)}function HJ(e){var t=1;lt(e,626,qs(t)),lt(e,47,Y5({numFmtId:0},65535)),lt(e,627)}function jJ(e,t){lt(e,617,qs(t.length)),t.forEach(function(r){lt(e,47,Y5(r,0))}),lt(e,618)}function VJ(e){var t=1;lt(e,619,qs(t)),lt(e,48,DJ({xfId:0,name:"Normal"})),lt(e,620)}function GJ(e){var t=0;lt(e,505,qs(t)),lt(e,506)}function zJ(e){var t=0;lt(e,508,PJ(t,"TableStyleMedium9","PivotStyleMedium4")),lt(e,509)}function UJ(e,t){var r=Bi();return lt(r,278),OJ(r,e.SSF),NJ(r),LJ(r),BJ(r),HJ(r),jJ(r,t.cellXfs),VJ(r),GJ(r),zJ(r),lt(r,279),r.end()}var WJ=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function $J(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(vi)||[]).forEach(function(i){var s=Wt(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[WJ.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function qJ(){}function KJ(){}var XJ=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,YJ=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ZJ=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function JJ(e,t,r){t.themeElements={};var n;[["clrScheme",XJ,$J],["fontScheme",YJ,qJ],["fmtScheme",ZJ,KJ]].forEach(function(i){if(!(n=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](n,t,r)})}var QJ=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function Z5(e,t){(!e||e.length===0)&&(e=kC());var r,n={};if(!(r=e.match(QJ)))throw new Error("themeElements not found in theme");return JJ(r[0],n,t),n.raw=e,n}function kC(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[_n];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function eQ(e,t,r){var n=e.l+t,i=e.read_shift(4);if(i!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var o;try{o=z6(s,{type:"array"})}catch{return}var a=es(o,"theme/theme/theme1.xml",!0);if(a)return Z5(a,r)}}function tQ(e){return e.read_shift(4)}function rQ(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=nQ(e,4);break;case 2:t.xclrValue=F5(e);break;case 3:t.xclrValue=tQ(e);break;case 4:e.l+=4;break}return e.l+=8,t}function nQ(e,t){return gi(e,t)}function iQ(e,t){return gi(e,t)}function sQ(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=rQ(e);break;case 6:n[1]=iQ(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function oQ(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(sQ(e,r-e.l));return{ixfe:n,ext:s}}function aQ(e,t){t.forEach(function(r){r[0]})}function lQ(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:pi(e)}}function cQ(e){var t=Je(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Un(e.name,t),t.slice(0,t.l)}function uQ(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function dQ(e){var t=Je(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function hQ(e,t){var r=Je(8+2*t.length);return r.write_shift(4,e),Un(t,r),r.slice(0,r.l)}function fQ(e){return e.l+=4,e.read_shift(4)!=0}function pQ(e,t){var r=Je(8);return r.write_shift(4,e),r.write_shift(4,1),r}function gQ(e,t,r){var n={Types:[],Cell:[],Value:[]},i=r||{},s=[],o=!1,a=2;return ga(e,function(l,c,u){switch(u){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(h){a==1?n.Cell.push({type:n.Types[h[0]-1].name,index:h[1]}):a==0&&n.Value.push({type:n.Types[h[0]-1].name,index:h[1]})});break;case 337:a=l?1:0;break;case 338:a=2;break;case 35:s.push(u),o=!0;break;case 36:s.pop(),o=!1;break;default:if(!c.T){if(!o||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function mQ(){var e=Bi();return lt(e,332),lt(e,334,qs(1)),lt(e,335,cQ({name:"XLDAPR",version:12e4,flags:3496657072})),lt(e,336),lt(e,339,hQ(1,"XLDAPR")),lt(e,52),lt(e,35,qs(514)),lt(e,4096,qs(0)),lt(e,4097,Cs(1)),lt(e,36),lt(e,53),lt(e,340),lt(e,337,pQ(1)),lt(e,51,dQ([[1,0]])),lt(e,338),lt(e,333),e.end()}function vQ(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var i=!1,s=2,o;return e.replace(vi,function(a){var l=Wt(a);switch(Ro(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(o=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!o)break;o.offsets||(o.offsets=[]),o.offsets.push(+l.i);break;default:if(!i&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return a}),n}function J5(){var e=[_n];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function bQ(e){var t=[];if(!e)return t;var r=1;return(e.match(vi)||[]).forEach(function(n){var i=Wt(n);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?r=i.i:i.i=r,t.push(i);break}}),t}function wQ(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=zt(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function yQ(e,t,r){var n=[];return ga(e,function(s,o,a){switch(a){case 63:n.push(s);break;default:if(!o.T)throw new Error("Unexpected record 0x"+a.toString(16))}}),n}function CQ(e,t,r,n){if(!e)return e;var i=n||{},s=!1;ga(e,function(a,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},i)}function xQ(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var Hu=1024;function Q5(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[mt("xml",null,{"xmlns:v":Zi.v,"xmlns:o":Zi.o,"xmlns:x":Zi.x,"xmlns:mv":Zi.mv}).replace(/\/>/,">"),mt("o:shapelayout",mt("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),mt("v:shapetype",[mt("v:stroke",null,{joinstyle:"miter"}),mt("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];Hu<e*1e3;)Hu+=1e3;return t.forEach(function(s){var o=on(s[0]),a={color2:"#BEFF82",type:"gradient"};a.type=="gradient"&&(a.angle="-180");var l=a.type=="gradient"?mt("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=mt("v:fill",l,a),u={on:"t",obscured:"t"};++Hu,i=i.concat(["<v:shape"+_f({id:"_x0000_s"+Hu,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,mt("v:shadow",null,u),mt("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",ri("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),ri("x:AutoFill","False"),ri("x:Row",String(o.r)),ri("x:Column",String(o.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function aE(e,t,r,n){var i=Array.isArray(e),s;t.forEach(function(o){var a=on(o.ref);if(i?(e[a.r]||(e[a.r]=[]),s=e[a.r][a.c]):s=e[o.ref],!s){s={t:"z"},i?e[a.r][a.c]=s:e[o.ref]=s;var l=Sr(e["!ref"]||"BDWGO1000001:A1");l.s.r>a.r&&(l.s.r=a.r),l.e.r<a.r&&(l.e.r=a.r),l.s.c>a.c&&(l.s.c=a.c),l.e.c<a.c&&(l.e.c=a.c);var c=er(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var u={a:o.author,t:o.t,r:o.r,T:r};o.h&&(u.h=o.h);for(var h=s.c.length-1;h>=0;--h){if(!r&&s.c[h].T)return;r&&!s.c[h].T&&s.c.splice(h,1)}if(r&&n){for(h=0;h<n.length;++h)if(u.a==n[h].id){u.a=n[h].name||u.a;break}}s.c.push(u)})}function SQ(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?author[^>]*>(.*)/);a&&r.push(a[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(o){if(!(o===""||o.trim()==="")){var a=o.match(/<(?:\w+:)?comment[^>]*>/);if(a){var l=Wt(a[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},u=on(l.ref);if(!(t.sheetRows&&t.sheetRows<=u.r)){var h=o.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),d=!!h&&!!h[1]&&_C(h[1])||{r:"",t:"",h:""};c.r=d.r,d.r=="<t></t>"&&(d.t=d.h=""),c.t=(d.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=d.h),n.push(c)}}}}),n}function e8(e){var t=[_n,mt("comments",null,{xmlns:Pc[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var s=Br(i.a);r.indexOf(s)==-1&&(r.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,s=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(Br(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(ri("t",Br(s[0]||"")));else{for(var o=`Comment:
    `+s[0]+`
`,a=1;a<s.length;++a)o+=`Reply:
    `+s[a]+`
`;t.push(ri("t",Br(o)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function _Q(e,t){var r=[],n=!1,i={},s=0;return e.replace(vi,function(a,l){var c=Wt(a);switch(Ro(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":i.t!=null&&r.push(i);break;case"<text>":case"<text":s=l+a.length;break;case"</text>":i.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return a}),r}function EQ(e,t,r){var n=[_n,mt("ThreadedComments",null,{xmlns:Nn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(o,a){if(!o.T){delete o.ID;return}o.a&&t.indexOf(o.a)==-1&&t.push(o.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};a==0?s=l.id:l.parentId=s,o.ID=l.id,o.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(o.a)).slice(-12)+"}"),n.push(mt("threadedComment",ri("text",o.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function TQ(e,t){var r=[],n=!1;return e.replace(vi,function(s){var o=Wt(s);switch(Ro(o[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:o.displayname,id:o.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+o[0]+" in threaded comments")}return s}),r}function kQ(e){var t=[_n,mt("personList",null,{xmlns:Nn.TCMNT,"xmlns:x":Pc[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(mt("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function RQ(e){var t={};t.iauthor=e.read_shift(4);var r=Lc(e);return t.rfx=r.s,t.ref=zt(r.s),e.l+=16,t}function AQ(e,t){return t==null&&(t=Je(36)),t.write_shift(4,e[1].iauthor),Rd(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var FQ=pi;function MQ(e){return Un(e.slice(0,54))}function DQ(e,t){var r=[],n=[],i={},s=!1;return ga(e,function(a,l,c){switch(c){case 632:n.push(a);break;case 635:i=a;break;case 637:i.t=a.t,i.h=a.h,i.r=a.r;break;case 636:if(i.author=n[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,r.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function PQ(e){var t=Bi(),r=[];return lt(t,628),lt(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),lt(t,632,MQ(i.a)))})}),lt(t,631),lt(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var s={s:on(n[0]),e:on(n[0])};lt(t,635,AQ([s,i])),i.t&&i.t.length>0&&lt(t,637,tX(i)),lt(t,636),delete i.iauthor})}),lt(t,634),lt(t,629),t.end()}var IQ="application/vnd.ms-office.vbaProject";function OQ(e){var t=Mt.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var i=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Mt.utils.cfb_add(t,i,e.FileIndex[n].content)}}),Mt.write(t)}function NQ(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Mt.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var t8=["xlsb","xlsm","xlam","biff8","xla"];function LQ(){return{"!type":"dialog"}}function BQ(){return{"!type":"dialog"}}function HQ(){return{"!type":"macro"}}function jQ(){return{"!type":"macro"}}var nd=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,s,o){var a=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),o.length==0?a=!0:o.charAt(0)=="["&&(a=!0,o=o.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,u=o.length>0?parseInt(o,10)|0:0;return a?u+=t.c:--u,l?c+=t.r:--c,i+(a?"":"$")+sn(u)+(l?"":"$")+Sn(c)}return function(i,s){return t=s,i.replace(e,r)}})(),RC=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,AC=(function(){return function(t,r){return t.replace(RC,function(n,i,s,o,a,l){var c=gC(o)-(s?0:r.c),u=pC(l)-(a?0:r.r),h=u==0?"":a?u+1:"["+u+"]",d=c==0?"":s?c+1:"["+c+"]";return i+"R"+h+"C"+d})}})();function r8(e,t){return e.replace(RC,function(r,n,i,s,o,a){return n+(i=="$"?i+s:sn(gC(s)+t.c))+(o=="$"?o+a:Sn(pC(a)+t.r))})}function VQ(e,t,r){var n=Vi(t),i=n.s,s=on(r),o={r:s.r-i.r,c:s.c-i.c};return r8(e,o)}function GQ(e){return e.length!=1}function lE(e){return e.replace(/_xlfn\./g,"")}function An(e){e.l+=1}function fl(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function n8(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return i8(e);r.biff==12&&(n=4)}var i=e.read_shift(n),s=e.read_shift(n),o=fl(e),a=fl(e);return{s:{r:i,c:o[0],cRel:o[1],rRel:o[2]},e:{r:s,c:a[0],cRel:a[1],rRel:a[2]}}}function i8(e){var t=fl(e),r=fl(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function zQ(e,t,r){if(r.biff<8)return i8(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),s=fl(e),o=fl(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function s8(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return UQ(e);var n=e.read_shift(r&&r.biff==12?4:2),i=fl(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function UQ(e){var t=fl(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function WQ(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function $Q(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return qQ(e);var i=e.read_shift(n>=12?4:2),s=e.read_shift(2),o=(s&16384)>>14,a=(s&32768)>>15;if(s&=16383,a==1)for(;i>524287;)i-=1048576;if(o==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:o,rRel:a}}function qQ(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function KQ(e,t,r){var n=(e[e.l++]&96)>>5,i=n8(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function XQ(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var o=n8(e,s,r);return[n,i,o]}function YQ(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function ZQ(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,i]}function JQ(e,t,r){var n=(e[e.l++]&96)>>5,i=zQ(e,t-1,r);return[n,i]}function QQ(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function cE(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function eee(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],s=0;s<=n;++s)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function tee(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function ree(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function nee(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function iee(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function o8(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function see(e){return e.read_shift(2),o8(e)}function oee(e){return e.read_shift(2),o8(e)}function aee(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=s8(e,0,r);return[n,i]}function lee(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=$Q(e,0,r);return[n,i]}function cee(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=s8(e,0,r);return[n,i,s]}function uee(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[fte[i],c8[i],n]}function dee(e,t,r){var n=e[e.l++],i=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:hee(e);return[i,(s[0]===0?c8:hte)[s[1]]]}function hee(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function fee(e,t,r){e.l+=r&&r.biff==2?3:4}function pee(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function gee(e){return e.l++,ma[e.read_shift(1)]}function mee(e){return e.l++,e.read_shift(2)}function vee(e){return e.l++,e.read_shift(1)!==0}function bee(e){return e.l++,fi(e)}function wee(e,t,r){return e.l++,Zf(e,t-1,r)}function yee(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=bn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=ma[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=fi(e);break;case 2:r[1]=Bc(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Cee(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],s=0;s!=n;++s)i.push((r.biff==12?Lc:Cm)(e));return i}function xee(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var s=0,o=[];s!=n&&(o[s]=[]);++s)for(var a=0;a!=i;++a)o[s][a]=yee(e,r.biff);return o}function See(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,s=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function _ee(e,t,r){if(r.biff==5)return Eee(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[n,i,s]}function Eee(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Tee(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function kee(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function Ree(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Aee(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,i]}var Fee=gi,Mee=gi,Dee=gi;function Qf(e,t,r){return e.l+=2,[WQ(e)]}function FC(e){return e.l+=6,[]}var Pee=Qf,Iee=FC,Oee=FC,Nee=Qf;function a8(e){return e.l+=2,[Mn(e),e.read_shift(2)&1]}var Lee=Qf,Bee=a8,Hee=FC,jee=Qf,Vee=Qf,Gee=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function zee(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),o=Gee[r>>2&31];return{ixti:t,coltype:r&3,rt:o,idx:n,c:i,C:s}}function Uee(e){return e.l+=2,[e.read_shift(4)]}function Wee(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function $ee(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function qee(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Kee(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Xee(e){return e.l+=4,[0,0]}var uE={1:{n:"PtgExp",f:pee},2:{n:"PtgTbl",f:Dee},3:{n:"PtgAdd",f:An},4:{n:"PtgSub",f:An},5:{n:"PtgMul",f:An},6:{n:"PtgDiv",f:An},7:{n:"PtgPower",f:An},8:{n:"PtgConcat",f:An},9:{n:"PtgLt",f:An},10:{n:"PtgLe",f:An},11:{n:"PtgEq",f:An},12:{n:"PtgGe",f:An},13:{n:"PtgGt",f:An},14:{n:"PtgNe",f:An},15:{n:"PtgIsect",f:An},16:{n:"PtgUnion",f:An},17:{n:"PtgRange",f:An},18:{n:"PtgUplus",f:An},19:{n:"PtgUminus",f:An},20:{n:"PtgPercent",f:An},21:{n:"PtgParen",f:An},22:{n:"PtgMissArg",f:An},23:{n:"PtgStr",f:wee},26:{n:"PtgSheet",f:Wee},27:{n:"PtgEndSheet",f:$ee},28:{n:"PtgErr",f:gee},29:{n:"PtgBool",f:vee},30:{n:"PtgInt",f:mee},31:{n:"PtgNum",f:bee},32:{n:"PtgArray",f:QQ},33:{n:"PtgFunc",f:uee},34:{n:"PtgFuncVar",f:dee},35:{n:"PtgName",f:See},36:{n:"PtgRef",f:aee},37:{n:"PtgArea",f:KQ},38:{n:"PtgMemArea",f:Tee},39:{n:"PtgMemErr",f:Fee},40:{n:"PtgMemNoMem",f:Mee},41:{n:"PtgMemFunc",f:kee},42:{n:"PtgRefErr",f:Ree},43:{n:"PtgAreaErr",f:YQ},44:{n:"PtgRefN",f:lee},45:{n:"PtgAreaN",f:JQ},46:{n:"PtgMemAreaN",f:qee},47:{n:"PtgMemNoMemN",f:Kee},57:{n:"PtgNameX",f:_ee},58:{n:"PtgRef3d",f:cee},59:{n:"PtgArea3d",f:XQ},60:{n:"PtgRefErr3d",f:Aee},61:{n:"PtgAreaErr3d",f:ZQ},255:{}},Yee={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Zee={1:{n:"PtgElfLel",f:a8},2:{n:"PtgElfRw",f:jee},3:{n:"PtgElfCol",f:Pee},6:{n:"PtgElfRwV",f:Vee},7:{n:"PtgElfColV",f:Nee},10:{n:"PtgElfRadical",f:Lee},11:{n:"PtgElfRadicalS",f:Hee},13:{n:"PtgElfColS",f:Iee},15:{n:"PtgElfColSV",f:Oee},16:{n:"PtgElfRadicalLel",f:Bee},25:{n:"PtgList",f:zee},29:{n:"PtgSxName",f:Uee},255:{}},Jee={0:{n:"PtgAttrNoop",f:Xee},1:{n:"PtgAttrSemi",f:iee},2:{n:"PtgAttrIf",f:ree},4:{n:"PtgAttrChoose",f:eee},8:{n:"PtgAttrGoto",f:tee},16:{n:"PtgAttrSum",f:fee},32:{n:"PtgAttrBaxcel",f:cE},33:{n:"PtgAttrBaxcel",f:cE},64:{n:"PtgAttrSpace",f:see},65:{n:"PtgAttrSpaceSemi",f:oee},128:{n:"PtgAttrIfError",f:nee},255:{}};function ep(e,t,r,n){if(n.biff<8)return gi(e,t);for(var i=e.l+t,s=[],o=0;o!==r.length;++o)switch(r[o][0]){case"PtgArray":r[o][1]=xee(e,0,n),s.push(r[o][1]);break;case"PtgMemArea":r[o][2]=Cee(e,r[o][1],n),s.push(r[o][2]);break;case"PtgExp":n&&n.biff==12&&(r[o][1][1]=e.read_shift(4),s.push(r[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[o][0]}return t=i-e.l,t!==0&&s.push(gi(e,t)),s}function tp(e,t,r){for(var n=e.l+t,i,s,o=[];n!=e.l;)t=n-e.l,s=e[e.l],i=uE[s]||uE[Yee[s]],(s===24||s===25)&&(i=(s===24?Zee:Jee)[e[e.l+1]]),!i||!i.f?gi(e,t):o.push([i.n,i.f(e,t,r)]);return o}function Qee(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],s=0;s<n.length;++s){var o=n[s];o?o[0]===2?i.push('"'+o[1].replace(/"/g,'""')+'"'):i.push(o[1]):i.push("")}t.push(i.join(","))}return t.join(";")}var ete={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tte(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function l8(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function dE(e,t,r){var n=l8(e,t,r);return n=="#REF"?n:tte(n,r)}function di(e,t,r,n,i){var s=i&&i.biff||8,o={s:{c:0,r:0}},a=[],l,c,u,h=0,d=0,f,m="";if(!e[0]||!e[0][0])return"";for(var v=-1,g="",w=0,y=e[0].length;w<y;++w){var C=e[0][w];switch(C[0]){case"PtgUminus":a.push("-"+a.pop());break;case"PtgUplus":a.push("+"+a.pop());break;case"PtgPercent":a.push(a.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=a.pop(),c=a.pop(),v>=0){switch(e[0][v][1][0]){case 0:g=un(" ",e[0][v][1][1]);break;case 1:g=un("\r",e[0][v][1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}c=c+g,v=-1}a.push(c+ete[C[0]]+l);break;case"PtgIsect":l=a.pop(),c=a.pop(),a.push(c+" "+l);break;case"PtgUnion":l=a.pop(),c=a.pop(),a.push(c+","+l);break;case"PtgRange":l=a.pop(),c=a.pop(),a.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=Xh(C[1][1],o,i),a.push(Yh(u,s));break;case"PtgRefN":u=r?Xh(C[1][1],r,i):C[1][1],a.push(Yh(u,s));break;case"PtgRef3d":h=C[1][1],u=Xh(C[1][2],o,i),m=dE(n,h,i),a.push(m+"!"+Yh(u,s));break;case"PtgFunc":case"PtgFuncVar":var k=C[1][0],F=C[1][1];k||(k=0),k&=127;var I=k==0?[]:a.slice(-k);a.length-=k,F==="User"&&(F=I.shift()),a.push(F+"("+I.join(",")+")");break;case"PtgBool":a.push(C[1]?"TRUE":"FALSE");break;case"PtgInt":a.push(C[1]);break;case"PtgNum":a.push(String(C[1]));break;case"PtgStr":a.push('"'+C[1].replace(/"/g,'""')+'"');break;case"PtgErr":a.push(C[1]);break;case"PtgAreaN":f=j3(C[1][1],r?{s:r}:o,i),a.push(xb(f,i));break;case"PtgArea":f=j3(C[1][1],o,i),a.push(xb(f,i));break;case"PtgArea3d":h=C[1][1],f=C[1][2],m=dE(n,h,i),a.push(m+"!"+xb(f,i));break;case"PtgAttrSum":a.push("SUM("+a.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":d=C[1][2];var N=(n.names||[])[d-1]||(n[0]||[])[d],j=N?N.Name:"SH33TJSNAME"+String(d);j&&j.slice(0,6)=="_xlfn."&&!i.xlfn&&(j=j.slice(6)),a.push(j);break;case"PtgNameX":var L=C[1][1];d=C[1][2];var W;if(i.biff<=5)L<0&&(L=-L),n[L]&&(W=n[L][d]);else{var K="";if(((n[L]||[])[0]||[])[0]==14849||(((n[L]||[])[0]||[])[0]==1025?n[L][d]&&n[L][d].itab>0&&(K=n.SheetNames[n[L][d].itab-1]+"!"):K=n.SheetNames[d-1]+"!"),n[L]&&n[L][d])K+=n[L][d].Name;else if(n[0]&&n[0][d])K+=n[0][d].Name;else{var z=(l8(n,L,i)||"").split(";;");z[d-1]?K=z[d-1]:K+="SH33TJSERRX"}a.push(K);break}W||(W={Name:"SH33TJSERRY"}),a.push(W.Name);break;case"PtgParen":var M="(",B=")";if(v>=0){switch(g="",e[0][v][1][0]){case 2:M=un(" ",e[0][v][1][1])+M;break;case 3:M=un("\r",e[0][v][1][1])+M;break;case 4:B=un(" ",e[0][v][1][1])+B;break;case 5:B=un("\r",e[0][v][1][1])+B;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][v][1][0])}v=-1}a.push(M+a.pop()+B);break;case"PtgRefErr":a.push("#REF!");break;case"PtgRefErr3d":a.push("#REF!");break;case"PtgExp":u={c:C[1][1],r:C[1][0]};var R={c:r.c,r:r.r};if(n.sharedf[zt(u)]){var S=n.sharedf[zt(u)];a.push(di(S,o,R,n,i))}else{var _=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){a.push(di(c[1],o,R,n,i)),_=!0;break}_||a.push(C[1])}break;case"PtgArray":a.push("{"+Qee(C[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":v=w;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":a.push("");break;case"PtgAreaErr":a.push("#REF!");break;case"PtgAreaErr3d":a.push("#REF!");break;case"PtgList":a.push("Table"+C[1].idx+"[#"+C[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(C));default:throw new Error("Unrecognized Formula Token: "+String(C))}var T=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&v>=0&&T.indexOf(e[0][w][0])==-1){C=e[0][v];var E=!0;switch(C[1][0]){case 4:E=!1;case 0:g=un(" ",C[1][1]);break;case 5:E=!1;case 1:g=un("\r",C[1][1]);break;default:if(g="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+C[1][0])}a.push((E?g:"")+a.pop()+(E?"":g)),v=-1}}if(a.length>1&&i.WTF)throw new Error("bad formula stack");return a[0]}function rte(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],gi(e,t-2)];var a=tp(e,o,r);return t!==o+i&&(s=ep(e,t-o-i,a,r)),e.l=n,[a,s]}function nte(e,t,r){var n=e.l+t,i=r.biff==2?1:2,s,o=e.read_shift(i);if(o==65535)return[[],gi(e,t-2)];var a=tp(e,o,r);return t!==o+i&&(s=ep(e,t-o-i,a,r)),e.l=n,[a,s]}function ite(e,t,r,n){var i=e.l+t,s=tp(e,n,r),o;return i!==e.l&&(o=ep(e,i-e.l,s,r)),[s,o]}function ste(e,t,r){var n=e.l+t,i,s=e.read_shift(2),o=tp(e,s,r);return s==65535?[[],gi(e,t-2)]:(t!==s+2&&(i=ep(e,n-s-2,o,r)),[o,i])}function ote(e){var t;if(Qo(e,e.l+6)!==65535)return[fi(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function ate(e){if(e==null){var t=Je(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Sc(e);return Sc(0)}function kb(e,t,r){var n=e.l+t,i=Ao(e);r.biff==2&&++e.l;var s=ote(e),o=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var a=nte(e,n-e.l,r);return{cell:i,val:s[0],formula:a,shared:o>>3&1,tt:s[1]}}function lte(e,t,r,n,i){var s=Ec(t,r,i),o=ate(e.v),a=Je(6),l=33;a.write_shift(2,l),a.write_shift(4,0);for(var c=Je(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var h=Vn([s,o,a,c]);return h}function xm(e,t,r){var n=e.read_shift(4),i=tp(e,n,r),s=e.read_shift(4),o=s>0?ep(e,s,i,r):null;return[i,o]}var cte=xm,Sm=xm,ute=xm,dte=xm,hte={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},c8={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},fte={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function hE(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function pte(e){var t="of:="+e.replace(RC,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function Rb(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function gte(e){return e.replace(/\./,"!")}var Jh={},id={},Qh=typeof Map<"u";function MC(e,t,r){var n=0,i=e.length;if(r){if(Qh?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var s=Qh?r.get(t):r[t];n<s.length;++n)if(e[s[n]].t===t)return e.Count++,s[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(Qh?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function _m(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(hi=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Af(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=q0(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function fc(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Sl(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){sa(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===n)return i;return e[s]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function u8(e,t,r,n,i,s){try{n.cellNF&&(e.z=Gt[t])}catch(a){if(n.WTF)throw a}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=Zr(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(Gt[t]==null&&sa(hK[t]||"General",t),e.t==="e")e.w=e.w||ma[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=xf(e.v);else if(e.t==="d"){var o=Ln(e.v);(o|0)===o?e.w=o.toString(10):e.w=xf(o)}else{if(e.v===void 0)return"";e.w=Cc(e.v,id)}else e.t==="d"?e.w=As(t,Ln(e.v),id):e.w=As(t,e.v,id)}catch(a){if(n.WTF)throw a}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=$0(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=$0(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(a){if(n.WTF&&s.Fills)throw a}}}function mte(e,t,r){if(e&&e["!ref"]){var n=Sr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function vte(e,t){var r=Sr(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=er(r))}var bte=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,wte=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,yte=/<(?:\w:)?hyperlink [^>]*>/mg,Cte=/"(\w*:\w*)"/,xte=/<(?:\w:)?col\b[^>]*[\/]?>/g,Ste=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,_te=/<(?:\w:)?pageMargins[^>]*\/>/g,d8=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Ete=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Tte=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function kte(e,t,r,n,i,s,o){if(!e)return e;n||(n={"!id":{}});var a=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",u="",h=e.match(wte);h?(c=e.slice(0,h.index),u=e.slice(h.index+h[0].length)):c=u=e;var d=c.match(d8);d?DC(d[0],a,i,r):(d=c.match(Ete))&&Ate(d[0],d[1]||"",a,i,r);var f=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(f>0){var m=c.slice(f,f+50).match(Cte);m&&vte(a,m[1])}var v=c.match(Tte);v&&v[1]&&Gte(v[1],i);var g=[];if(t.cellStyles){var w=c.match(xte);w&&Lte(g,w)}h&&Wte(h[1],a,t,l,s,o);var y=u.match(Ste);y&&(a["!autofilter"]=Hte(y[0]));var C=[],k=u.match(bte);if(k)for(f=0;f!=k.length;++f)C[f]=Sr(k[f].slice(k[f].indexOf('"')+1));var F=u.match(yte);F&&Ite(a,F,n);var I=u.match(_te);if(I&&(a["!margins"]=Ote(Wt(I[0]))),!a["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(a["!ref"]=er(l)),t.sheetRows>0&&a["!ref"]){var N=Sr(a["!ref"]);t.sheetRows<=+N.e.r&&(N.e.r=t.sheetRows-1,N.e.r>l.e.r&&(N.e.r=l.e.r),N.e.r<N.s.r&&(N.s.r=N.e.r),N.e.c>l.e.c&&(N.e.c=l.e.c),N.e.c<N.s.c&&(N.s.c=N.e.c),a["!fullref"]=a["!ref"],a["!ref"]=er(N))}return g.length>0&&(a["!cols"]=g),C.length>0&&(a["!merges"]=C),a}function Rte(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+er(e[r])+'"/>';return t+"</mergeCells>"}function DC(e,t,r,n){var i=Wt(e);r.Sheets[n]||(r.Sheets[n]={}),i.codeName&&(r.Sheets[n].CodeName=xr(Ur(i.codeName)))}function Ate(e,t,r,n,i){DC(e.slice(0,e.indexOf(">")),r,n,i)}function Fte(e,t,r,n,i){var s=!1,o={},a=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}s=!0,o.codeName=xo(Br(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),a=(a||"")+mt("outlinePr",null,c)}!s&&!a||(i[i.length]=mt("sheetPr",a,o))}var Mte=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Dte=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Pte(e){var t={sheet:1};return Mte.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Dte.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=EC(e.password).toString(16).toUpperCase()),mt("sheetProtection",null,t)}function Ite(e,t,r){for(var n=Array.isArray(e),i=0;i!=t.length;++i){var s=Wt(Ur(t[i]),!0);if(!s.ref)return;var o=((r||{})["!id"]||[])[s.id];o?(s.Target=o.Target,s.location&&(s.Target+="#"+xr(s.location))):(s.Target="#"+xr(s.location),o={Target:s.Target,TargetMode:"Internal"}),s.Rel=o,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var a=Sr(s.ref),l=a.s.r;l<=a.e.r;++l)for(var c=a.s.c;c<=a.e.c;++c){var u=zt({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[u]||(e[u]={t:"z",v:void 0}),e[u].l=s)}}}function Ote(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Nte(e){return fc(e),mt("pageMargins",null,e)}function Lte(e,t){for(var r=!1,n=0;n!=t.length;++n){var i=Wt(t[n],!0);i.hidden&&(i.hidden=Xr(i.hidden));var s=parseInt(i.min,10)-1,o=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!r&&i.width&&(r=!0,TC(i.width)),hl(i);s<=o;)e[s++]=Jr(i)}}function Bte(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=mt("col",null,_m(i,n)));return r[r.length]="</cols>",r.join("")}function Hte(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function jte(e,t,r,n){var i=typeof e.ref=="string"?e.ref:er(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Vi(i);o.s.r==o.e.r&&(o.e.r=Vi(t["!ref"]).e.r,i=er(o));for(var a=0;a<s.length;++a){var l=s[a];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return a==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),mt("autoFilter",null,{ref:i})}var Vte=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Gte(e,t){t.Views||(t.Views=[{}]),(e.match(Vte)||[]).forEach(function(r,n){var i=Wt(r);t.Views[n]||(t.Views[n]={}),+i.zoomScale&&(t.Views[n].zoom=+i.zoomScale),Xr(i.rightToLeft)&&(t.Views[n].RTL=!0)})}function zte(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),mt("sheetViews",mt("sheetView",null,i),{})}function Ute(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,o=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=ma[e.v];break;case"d":n&&n.cellDates?i=Zr(e.v,-1).toISOString():(e=Jr(e),e.t="n",i=""+(e.v=Ln(Zr(e.v)))),typeof e.z>"u"&&(e.z=Gt[14]);break;default:i=e.v;break}var a=ri("v",Br(i)),l={r:t},c=Sl(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){a=ri("v",""+MC(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=o),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;a=mt("f",Br(e.f),u)+(e.v!=null?a:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),mt("c",a,l)}var Wte=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=Sf("v"),o=Sf("f");return function(l,c,u,h,d,f){for(var m=0,v="",g=[],w=[],y=0,C=0,k=0,F="",I,N,j=0,L=0,W,K,z=0,M=0,B=Array.isArray(f.CellXf),R,S=[],_=[],T=Array.isArray(c),E=[],D={},O=!1,P=!!u.sheetStubs,q=l.split(t),X=0,Q=q.length;X!=Q;++X){v=q[X].trim();var G=v.length;if(G!==0){var ee=0;e:for(m=0;m<G;++m)switch(v[m]){case">":if(v[m-1]!="/"){++m;break e}if(u&&u.cellStyles){if(N=Wt(v.slice(ee,m),!0),j=N.r!=null?parseInt(N.r,10):j+1,L=-1,u.sheetRows&&u.sheetRows<j)continue;D={},O=!1,N.ht&&(O=!0,D.hpt=parseFloat(N.ht),D.hpx=md(D.hpt)),N.hidden=="1"&&(O=!0,D.hidden=!0),N.outlineLevel!=null&&(O=!0,D.level=+N.outlineLevel),O&&(E[j-1]=D)}break;case"<":ee=m;break}if(ee>=m)break;if(N=Wt(v.slice(ee,m),!0),j=N.r!=null?parseInt(N.r,10):j+1,L=-1,!(u.sheetRows&&u.sheetRows<j)){h.s.r>j-1&&(h.s.r=j-1),h.e.r<j-1&&(h.e.r=j-1),u&&u.cellStyles&&(D={},O=!1,N.ht&&(O=!0,D.hpt=parseFloat(N.ht),D.hpx=md(D.hpt)),N.hidden=="1"&&(O=!0,D.hidden=!0),N.outlineLevel!=null&&(O=!0,D.level=+N.outlineLevel),O&&(E[j-1]=D)),g=v.slice(m).split(e);for(var V=0;V!=g.length&&g[V].trim().charAt(0)=="<";++V);for(g=g.slice(V),m=0;m!=g.length;++m)if(v=g[m].trim(),v.length!==0){if(w=v.match(r),y=m,C=0,k=0,v="<c "+(v.slice(0,1)=="<"?">":"")+v,w!=null&&w.length===2){for(y=0,F=w[1],C=0;C!=F.length&&!((k=F.charCodeAt(C)-64)<1||k>26);++C)y=26*y+k;--y,L=y}else++L;for(C=0;C!=v.length&&v.charCodeAt(C)!==62;++C);if(++C,N=Wt(v.slice(0,C),!0),N.r||(N.r=zt({r:j-1,c:L})),F=v.slice(C),I={t:""},(w=F.match(s))!=null&&w[1]!==""&&(I.v=xr(w[1])),u.cellFormula){if((w=F.match(o))!=null&&w[1]!==""){if(I.f=xr(Ur(w[1])).replace(/\r\n/g,`
`),u.xlfn||(I.f=lE(I.f)),w[0].indexOf('t="array"')>-1)I.F=(F.match(i)||[])[1],I.F.indexOf(":")>-1&&S.push([Sr(I.F),I.F]);else if(w[0].indexOf('t="shared"')>-1){K=Wt(w[0]);var H=xr(Ur(w[1]));u.xlfn||(H=lE(H)),_[parseInt(K.si,10)]=[K,H,N.r]}}else(w=F.match(/<f[^>]*\/>/))&&(K=Wt(w[0]),_[K.si]&&(I.f=VQ(_[K.si][1],_[K.si][2],N.r)));var Z=on(N.r);for(C=0;C<S.length;++C)Z.r>=S[C][0].s.r&&Z.r<=S[C][0].e.r&&Z.c>=S[C][0].s.c&&Z.c<=S[C][0].e.c&&(I.F=S[C][1])}if(N.t==null&&I.v===void 0)if(I.f||I.F)I.v=0,I.t="n";else if(P)I.t="z";else continue;else I.t=N.t||"n";switch(h.s.c>L&&(h.s.c=L),h.e.c<L&&(h.e.c=L),I.t){case"n":if(I.v==""||I.v==null){if(!P)continue;I.t="z"}else I.v=parseFloat(I.v);break;case"s":if(typeof I.v>"u"){if(!P)continue;I.t="z"}else W=Jh[parseInt(I.v,10)],I.v=W.t,I.r=W.r,u.cellHTML&&(I.h=W.h);break;case"str":I.t="s",I.v=I.v!=null?Ur(I.v):"",u.cellHTML&&(I.h=uC(I.v));break;case"inlineStr":w=F.match(n),I.t="s",w!=null&&(W=_C(w[1]))?(I.v=W.t,u.cellHTML&&(I.h=W.h)):I.v="";break;case"b":I.v=Xr(I.v);break;case"d":u.cellDates?I.v=Zr(I.v,1):(I.v=Ln(Zr(I.v,1)),I.t="n");break;case"e":(!u||u.cellText!==!1)&&(I.w=I.v),I.v=f5[I.v];break}if(z=M=0,R=null,B&&N.s!==void 0&&(R=f.CellXf[N.s],R!=null&&(R.numFmtId!=null&&(z=R.numFmtId),u.cellStyles&&R.fillId!=null&&(M=R.fillId))),u8(I,z,M,u,d,f),u.cellDates&&B&&I.t=="n"&&Ed(Gt[z])&&(I.t="d",I.v=ym(I.v)),N.cm&&u.xlmeta){var ie=(u.xlmeta.Cell||[])[+N.cm-1];ie&&ie.type=="XLDAPR"&&(I.D=!0)}if(T){var te=on(N.r);c[te.r]||(c[te.r]=[]),c[te.r][te.c]=I}else c[N.r]=I}}}}E.length>0&&(c["!rows"]=E)}})();function $te(e,t,r,n){var i=[],s=[],o=Sr(e["!ref"]),a="",l,c="",u=[],h=0,d=0,f=e["!rows"],m=Array.isArray(e),v={r:c},g,w=-1;for(d=o.s.c;d<=o.e.c;++d)u[d]=sn(d);for(h=o.s.r;h<=o.e.r;++h){for(s=[],c=Sn(h),d=o.s.c;d<=o.e.c;++d){l=u[d]+c;var y=m?(e[h]||[])[d]:e[l];y!==void 0&&(a=Ute(y,l,e,t))!=null&&s.push(a)}(s.length>0||f&&f[h])&&(v={r:c},f&&f[h]&&(g=f[h],g.hidden&&(v.hidden=1),w=-1,g.hpx?w=Ff(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(v.ht=w,v.customHeight=1),g.level&&(v.outlineLevel=g.level)),i[i.length]=mt("row",s.join(""),v))}if(f)for(;h<f.length;++h)f&&f[h]&&(v={r:h+1},g=f[h],g.hidden&&(v.hidden=1),w=-1,g.hpx?w=Ff(g.hpx):g.hpt&&(w=g.hpt),w>-1&&(v.ht=w,v.customHeight=1),g.level&&(v.outlineLevel=g.level),i[i.length]=mt("row","",v));return i.join("")}function h8(e,t,r,n){var i=[_n,mt("worksheet",null,{xmlns:Pc[0],"xmlns:r":Nn.r})],s=r.SheetNames[e],o=0,a="",l=r.Sheets[s];l==null&&(l={});var c=l["!ref"]||"A1",u=Sr(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=er(u)}n||(n={}),l["!comments"]=[];var h=[];Fte(l,r,e,t,i),i[i.length]=mt("dimension",null,{ref:c}),i[i.length]=zte(l,t,e,r),t.sheetFormat&&(i[i.length]=mt("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=Bte(l,l["!cols"])),i[o=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(a=$te(l,t),a.length>0&&(i[i.length]=a)),i.length>o+1&&(i[i.length]="</sheetData>",i[o]=i[o].replace("/>",">")),l["!protect"]&&(i[i.length]=Pte(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=jte(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=Rte(l["!merges"]));var d=-1,f,m=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(v){v[1].Target&&(f={ref:v[0]},v[1].Target.charAt(0)!="#"&&(m=Or(n,-1,Br(v[1].Target).replace(/#.*$/,""),lr.HLINK),f["r:id"]="rId"+m),(d=v[1].Target.indexOf("#"))>-1&&(f.location=Br(v[1].Target.slice(d+1))),v[1].Tooltip&&(f.tooltip=Br(v[1].Tooltip)),i[i.length]=mt("hyperlink",null,f))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=Nte(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=ri("ignoredErrors",mt("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(m=Or(n,-1,"../drawings/drawing"+(e+1)+".xml",lr.DRAW),i[i.length]=mt("drawing",null,{"r:id":"rId"+m}),l["!drawing"]=h),l["!comments"].length>0&&(m=Or(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",lr.VML),i[i.length]=mt("legacyDrawing",null,{"r:id":"rId"+m}),l["!legacy"]=m),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function qte(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=i/20),r}function Kte(e,t,r){var n=Je(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var s=320;i.hpx?s=Ff(i.hpx)*20:i.hpt&&(s=i.hpt*20),n.write_shift(2,s),n.write_shift(1,0);var o=0;i.level&&(o|=i.level),i.hidden&&(o|=16),(i.hpx||i.hpt)&&(o|=32),n.write_shift(1,o),n.write_shift(1,0);var a=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,d=-1,f=u<<10;f<u+1<<10;++f){c.c=f;var m=Array.isArray(r)?(r[c.r]||[])[c.c]:r[zt(c)];m&&(h<0&&(h=f),d=f)}h<0||(++a,n.write_shift(4,h),n.write_shift(4,d))}var v=n.l;return n.l=l,n.write_shift(4,a),n.l=v,n.length>n.l?n.slice(0,n.l):n}function Xte(e,t,r,n){var i=Kte(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&lt(e,0,i)}var Yte=Lc,Zte=Rd;function Jte(){}function Qte(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=rX(e),r}function ere(e,t,r){r==null&&(r=Je(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return z0({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),l5(e,r),r.slice(0,r.l)}function tre(e){var t=Ms(e);return[t]}function rre(e,t,r){return r==null&&(r=Je(8)),Ic(t,r)}function nre(e){var t=Oc(e);return[t]}function ire(e,t,r){return r==null&&(r=Je(4)),Nc(t,r)}function sre(e){var t=Ms(e),r=e.read_shift(1);return[t,r,"b"]}function ore(e,t,r){return r==null&&(r=Je(9)),Ic(t,r),r.write_shift(1,e.v?1:0),r}function are(e){var t=Oc(e),r=e.read_shift(1);return[t,r,"b"]}function lre(e,t,r){return r==null&&(r=Je(5)),Nc(t,r),r.write_shift(1,e.v?1:0),r}function cre(e){var t=Ms(e),r=e.read_shift(1);return[t,r,"e"]}function ure(e,t,r){return r==null&&(r=Je(9)),Ic(t,r),r.write_shift(1,e.v),r}function dre(e){var t=Oc(e),r=e.read_shift(1);return[t,r,"e"]}function hre(e,t,r){return r==null&&(r=Je(8)),Nc(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function fre(e){var t=Ms(e),r=e.read_shift(4);return[t,r,"s"]}function pre(e,t,r){return r==null&&(r=Je(12)),Ic(t,r),r.write_shift(4,t.v),r}function gre(e){var t=Oc(e),r=e.read_shift(4);return[t,r,"s"]}function mre(e,t,r){return r==null&&(r=Je(8)),Nc(t,r),r.write_shift(4,t.v),r}function vre(e){var t=Ms(e),r=fi(e);return[t,r,"n"]}function bre(e,t,r){return r==null&&(r=Je(16)),Ic(t,r),Sc(e.v,r),r}function f8(e){var t=Oc(e),r=fi(e);return[t,r,"n"]}function wre(e,t,r){return r==null&&(r=Je(12)),Nc(t,r),Sc(e.v,r),r}function yre(e){var t=Ms(e),r=wC(e);return[t,r,"n"]}function Cre(e,t,r){return r==null&&(r=Je(12)),Ic(t,r),c5(e.v,r),r}function xre(e){var t=Oc(e),r=wC(e);return[t,r,"n"]}function Sre(e,t,r){return r==null&&(r=Je(8)),Nc(t,r),c5(e.v,r),r}function _re(e){var t=Ms(e),r=mC(e);return[t,r,"is"]}function Ere(e){var t=Ms(e),r=pi(e);return[t,r,"str"]}function Tre(e,t,r){return r==null&&(r=Je(12+4*e.v.length)),Ic(t,r),Un(e.v,r),r.length>r.l?r.slice(0,r.l):r}function kre(e){var t=Oc(e),r=pi(e);return[t,r,"str"]}function Rre(e,t,r){return r==null&&(r=Je(8+4*e.v.length)),Nc(t,r),Un(e.v,r),r.length>r.l?r.slice(0,r.l):r}function Are(e,t,r){var n=e.l+t,i=Ms(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"b"];if(r.cellFormula){e.l+=2;var a=Sm(e,n-e.l,r);o[3]=di(a,null,i,r.supbooks,r)}else e.l=n;return o}function Fre(e,t,r){var n=e.l+t,i=Ms(e);i.r=r["!row"];var s=e.read_shift(1),o=[i,s,"e"];if(r.cellFormula){e.l+=2;var a=Sm(e,n-e.l,r);o[3]=di(a,null,i,r.supbooks,r)}else e.l=n;return o}function Mre(e,t,r){var n=e.l+t,i=Ms(e);i.r=r["!row"];var s=fi(e),o=[i,s,"n"];if(r.cellFormula){e.l+=2;var a=Sm(e,n-e.l,r);o[3]=di(a,null,i,r.supbooks,r)}else e.l=n;return o}function Dre(e,t,r){var n=e.l+t,i=Ms(e);i.r=r["!row"];var s=pi(e),o=[i,s,"str"];if(r.cellFormula){e.l+=2;var a=Sm(e,n-e.l,r);o[3]=di(a,null,i,r.supbooks,r)}else e.l=n;return o}var Pre=Lc,Ire=Rd;function Ore(e,t){return t==null&&(t=Je(4)),t.write_shift(4,e),t}function Nre(e,t){var r=e.l+t,n=Lc(e),i=vC(e),s=pi(e),o=pi(e),a=pi(e);e.l=r;var l={rfx:n,relId:i,loc:s,display:a};return o&&(l.Tooltip=o),l}function Lre(e,t){var r=Je(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Rd({s:on(e[0]),e:on(e[0])},r),bC("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Un(i||"",r),Un(e[1].Tooltip||"",r),Un("",r),r.slice(0,r.l)}function Bre(){}function Hre(e,t,r){var n=e.l+t,i=u5(e),s=e.read_shift(1),o=[i];if(o[2]=s,r.cellFormula){var a=cte(e,n-e.l,r);o[1]=a}else e.l=n;return o}function jre(e,t,r){var n=e.l+t,i=Lc(e),s=[i];if(r.cellFormula){var o=dte(e,n-e.l,r);s[1]=o,e.l=n}else e.l=n;return s}function Vre(e,t,r){r==null&&(r=Je(18));var n=_m(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var p8=["left","right","top","bottom","header","footer"];function Gre(e){var t={};return p8.forEach(function(r){t[r]=fi(e)}),t}function zre(e,t){return t==null&&(t=Je(48)),fc(e),p8.forEach(function(r){Sc(e[r],t)}),t}function Ure(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Wre(e,t,r){r==null&&(r=Je(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function $re(e){var t=Je(24);return t.write_shift(4,4),t.write_shift(4,1),Rd(e,t),t}function qre(e,t){return t==null&&(t=Je(66)),t.write_shift(2,e.password?EC(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function Kre(){}function Xre(){}function Yre(e,t,r,n,i,s,o){if(!e)return e;var a=t||{};n||(n={"!id":{}});var l=a.dense?[]:{},c,u={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,d=!1,f,m,v,g,w,y,C,k,F,I=[];a.biff=12,a["!row"]=0;var N=0,j=!1,L=[],W={},K=a.supbooks||i.supbooks||[[]];if(K.sharedf=W,K.arrayf=L,K.SheetNames=i.SheetNames||i.Sheets.map(function(T){return T.name}),!a.supbooks&&(a.supbooks=K,i.Names))for(var z=0;z<i.Names.length;++z)K[0][z+1]=i.Names[z];var M=[],B=[],R=!1;Mf[16]={n:"BrtShortReal",f:f8};var S;if(ga(e,function(E,D,O){if(!d)switch(O){case 148:c=E;break;case 0:f=E,a.sheetRows&&a.sheetRows<=f.r&&(d=!0),k=Sn(g=f.r),a["!row"]=f.r,(E.hidden||E.hpt||E.level!=null)&&(E.hpt&&(E.hpx=md(E.hpt)),B[E.r]=E);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(m={t:E[2]},E[2]){case"n":m.v=E[1];break;case"s":C=Jh[E[1]],m.v=C.t,m.r=C.r;break;case"b":m.v=!!E[1];break;case"e":m.v=E[1],a.cellText!==!1&&(m.w=ma[m.v]);break;case"str":m.t="s",m.v=E[1];break;case"is":m.t="s",m.v=E[1].t;break}if((v=o.CellXf[E[0].iStyleRef])&&u8(m,v.numFmtId,null,a,s,o),w=E[0].c==-1?w+1:E[0].c,a.dense?(l[g]||(l[g]=[]),l[g][w]=m):l[sn(w)+k]=m,a.cellFormula){for(j=!1,N=0;N<L.length;++N){var P=L[N];f.r>=P[0].s.r&&f.r<=P[0].e.r&&w>=P[0].s.c&&w<=P[0].e.c&&(m.F=er(P[0]),j=!0)}!j&&E.length>3&&(m.f=E[3])}if(u.s.r>f.r&&(u.s.r=f.r),u.s.c>w&&(u.s.c=w),u.e.r<f.r&&(u.e.r=f.r),u.e.c<w&&(u.e.c=w),a.cellDates&&v&&m.t=="n"&&Ed(Gt[v.numFmtId])){var q=tc(m.v);q&&(m.t="d",m.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}S&&(S.type=="XLDAPR"&&(m.D=!0),S=void 0);break;case 1:case 12:if(!a.sheetStubs||h)break;m={t:"z",v:void 0},w=E[0].c==-1?w+1:E[0].c,a.dense?(l[g]||(l[g]=[]),l[g][w]=m):l[sn(w)+k]=m,u.s.r>f.r&&(u.s.r=f.r),u.s.c>w&&(u.s.c=w),u.e.r<f.r&&(u.e.r=f.r),u.e.c<w&&(u.e.c=w),S&&(S.type=="XLDAPR"&&(m.D=!0),S=void 0);break;case 176:I.push(E);break;case 49:S=((a.xlmeta||{}).Cell||[])[E-1];break;case 494:var X=n["!id"][E.relId];for(X?(E.Target=X.Target,E.loc&&(E.Target+="#"+E.loc),E.Rel=X):E.relId==""&&(E.Target="#"+E.loc),g=E.rfx.s.r;g<=E.rfx.e.r;++g)for(w=E.rfx.s.c;w<=E.rfx.e.c;++w)a.dense?(l[g]||(l[g]=[]),l[g][w]||(l[g][w]={t:"z",v:void 0}),l[g][w].l=E):(y=zt({c:w,r:g}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=E);break;case 426:if(!a.cellFormula)break;L.push(E),F=a.dense?l[g][w]:l[sn(w)+k],F.f=di(E[1],u,{r:f.r,c:w},K,a),F.F=er(E[0]);break;case 427:if(!a.cellFormula)break;W[zt(E[0].s)]=E[1],F=a.dense?l[g][w]:l[sn(w)+k],F.f=di(E[1],u,{r:f.r,c:w},K,a);break;case 60:if(!a.cellStyles)break;for(;E.e>=E.s;)M[E.e--]={width:E.w/256,hidden:!!(E.flags&1),level:E.level},R||(R=!0,TC(E.w/256)),hl(M[E.e+1]);break;case 161:l["!autofilter"]={ref:er(E)};break;case 476:l["!margins"]=E;break;case 147:i.Sheets[r]||(i.Sheets[r]={}),E.name&&(i.Sheets[r].CodeName=E.name),(E.above||E.left)&&(l["!outline"]={above:E.above,left:E.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),E.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!D.T){if(!h||a.WTF)throw new Error("Unexpected record 0x"+O.toString(16))}}},a),delete a.supbooks,delete a["!row"],!l["!ref"]&&(u.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=er(c||u)),a.sheetRows&&l["!ref"]){var _=Sr(l["!ref"]);a.sheetRows<=+_.e.r&&(_.e.r=a.sheetRows-1,_.e.r>u.e.r&&(_.e.r=u.e.r),_.e.r<_.s.r&&(_.s.r=_.e.r),_.e.c>u.e.c&&(_.e.c=u.e.c),_.e.c<_.s.c&&(_.s.c=_.e.c),l["!fullref"]=l["!ref"],l["!ref"]=er(_))}return I.length>0&&(l["!merges"]=I),M.length>0&&(l["!cols"]=M),B.length>0&&(l["!rows"]=B),l}function Zre(e,t,r,n,i,s,o){if(t.v===void 0)return!1;var a="";switch(t.t){case"b":a=t.v?"1":"0";break;case"d":t=Jr(t),t.z=t.z||Gt[14],t.v=Ln(Zr(t.v)),t.t="n";break;case"n":case"e":a=""+t.v;break;default:a=t.v;break}var l={r,c:n};switch(l.s=Sl(i.cellXfs,t,i),t.l&&s["!links"].push([zt(l),t.l]),t.c&&s["!comments"].push([zt(l),t.c]),t.t){case"s":case"str":return i.bookSST?(a=MC(i.Strings,t.v,i.revStrings),l.t="s",l.v=a,o?lt(e,18,mre(t,l)):lt(e,7,pre(t,l))):(l.t="str",o?lt(e,17,Rre(t,l)):lt(e,6,Tre(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?o?lt(e,13,Sre(t,l)):lt(e,2,Cre(t,l)):o?lt(e,16,wre(t,l)):lt(e,5,bre(t,l)),!0;case"b":return l.t="b",o?lt(e,15,lre(t,l)):lt(e,4,ore(t,l)),!0;case"e":return l.t="e",o?lt(e,14,hre(t,l)):lt(e,3,ure(t,l)),!0}return o?lt(e,12,ire(t,l)):lt(e,1,rre(t,l)),!0}function Jre(e,t,r,n){var i=Sr(t["!ref"]||"A1"),s,o="",a=[];lt(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){o=Sn(u),Xte(e,t,i,u);var h=!1;if(u<=i.e.r)for(var d=i.s.c;d<=i.e.c;++d){u===i.s.r&&(a[d]=sn(d)),s=a[d]+o;var f=l?(t[u]||[])[d]:t[s];if(!f){h=!1;continue}h=Zre(e,f,u,d,n,t,h)}}lt(e,146)}function Qre(e,t){!t||!t["!merges"]||(lt(e,177,Ore(t["!merges"].length)),t["!merges"].forEach(function(r){lt(e,176,Ire(r))}),lt(e,178))}function ene(e,t){!t||!t["!cols"]||(lt(e,390),t["!cols"].forEach(function(r,n){r&&lt(e,60,Vre(n,r))}),lt(e,391))}function tne(e,t){!t||!t["!ref"]||(lt(e,648),lt(e,649,$re(Sr(t["!ref"]))),lt(e,650))}function rne(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=Or(r,-1,n[1].Target.replace(/#.*$/,""),lr.HLINK);lt(e,494,Lre(n,i))}}),delete t["!links"]}function nne(e,t,r,n){if(t["!comments"].length>0){var i=Or(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",lr.VML);lt(e,551,bC("rId"+i)),t["!legacy"]=i}}function ine(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:er(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var o=r.Workbook.Names,a=Vi(s);a.s.r==a.e.r&&(a.e.r=Vi(t["!ref"]).e.r,s=er(a));for(var l=0;l<o.length;++l){var c=o[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+s;break}}l==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+s}),lt(e,161,Rd(Sr(s))),lt(e,162)}}function sne(e,t,r){lt(e,133),lt(e,137,Wre(t,r)),lt(e,138),lt(e,134)}function one(e,t){t["!protect"]&&lt(e,535,qre(t["!protect"]))}function ane(e,t,r,n){var i=Bi(),s=r.SheetNames[e],o=r.Sheets[s]||{},a=s;try{r&&r.Workbook&&(a=r.Workbook.Sheets[e].CodeName||a)}catch{}var l=Sr(o["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],lt(i,129),(r.vbaraw||o["!outline"])&&lt(i,147,ere(a,o["!outline"])),lt(i,148,Zte(l)),sne(i,o,r.Workbook),ene(i,o),Jre(i,o,e,t),one(i,o),ine(i,o,r,e),Qre(i,o),rne(i,o,n),o["!margins"]&&lt(i,476,zre(o["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&tne(i,o),nne(i,o,e,n),lt(i,130),i.end()}function lne(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var o=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);o&&(t[+o[1]]=r?+o[2]:o[2])});var i=xr((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,i,n]}function cne(e,t,r,n,i,s){var o=s||{"!type":"chart"};if(!e)return s;var a=0,l=0,c="A",u={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var d=lne(h);u.s.r=u.s.c=0,u.e.c=a,c=sn(a),d[0].forEach(function(f,m){o[c+Sn(m)]={t:"n",v:f,z:d[1]},l=m}),u.e.r<l&&(u.e.r=l),++a}),a>0&&(o["!ref"]=er(u)),o}function une(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o,a=e.match(d8);return a&&DC(a[0],s,i,r),(o=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=o[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function dne(e,t){e.l+=10;var r=pi(e);return{name:r}}function hne(e,t,r,n,i){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},o=!1;return ga(e,function(l,c,u){switch(u){case 550:s["!rel"]=l;break;case 651:i.Sheets[r]||(i.Sheets[r]={}),l.name&&(i.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:o=!0;break;case 36:o=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!o||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var PC=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],fne=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],pne=[],gne=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function fE(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],i=0;i!=t.length;++i){var s=t[i];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=Xr(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function pE(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=Xr(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function g8(e){pE(e.WBProps,PC),pE(e.CalcPr,gne),fE(e.WBView,fne),fE(e.Sheets,pne),id.date1904=Xr(e.WBProps.date1904)}function mne(e){return!e.Workbook||!e.Workbook.WBProps?"false":Xr(e.Workbook.WBProps.date1904)?"true":"false"}var vne="][*?/\\".split("");function m8(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return vne.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function bne(e,t,r){e.forEach(function(n,i){m8(n);for(var s=0;s<i;++s)if(n==e[s])throw new Error("Duplicate Sheet Name: "+n);if(r){var o=t&&t[i]&&t[i].CodeName||n;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function wne(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];bne(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)mte(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var yne=/<\w+:workbook/;function Cne(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,i="xmlns",s={},o=0;if(e.replace(vi,function(l,c){var u=Wt(l);switch(Ro(u[0])){case"<?xml":break;case"<workbook":l.match(yne)&&(i="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=u[i];break;case"</workbook>":break;case"<fileVersion":delete u[0],r.AppVersion=u;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":PC.forEach(function(h){if(u[h[0]]!=null)switch(h[2]){case"bool":r.WBProps[h[0]]=Xr(u[h[0]]);break;case"int":r.WBProps[h[0]]=parseInt(u[h[0]],10);break;default:r.WBProps[h[0]]=u[h[0]]}}),u.codeName&&(r.WBProps.CodeName=Ur(u.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete u[0],r.WBView.push(u);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(u.state){case"hidden":u.Hidden=1;break;case"veryHidden":u.Hidden=2;break;default:u.Hidden=0}delete u.state,u.name=xr(Ur(u.name)),delete u[0],r.Sheets.push(u);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=Ur(u.name),u.comment&&(s.Comment=u.comment),u.localSheetId&&(s.Sheet=+u.localSheetId),Xr(u.hidden||"0")&&(s.Hidden=!0),o=c+l.length;break;case"</definedName>":s.Ref=xr(Ur(e.slice(o,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete u[0],r.CalcPr=u;break;case"<calcPr/>":delete u[0],r.CalcPr=u;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+u[0]+" in workbook")}return l}),Pc.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return g8(r),r}function v8(e){var t=[_n];t[t.length]=mt("workbook",null,{xmlns:Pc[0],"xmlns:r":Nn.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(PC.forEach(function(a){e.Workbook.WBProps[a[0]]!=null&&e.Workbook.WBProps[a[0]]!=a[1]&&(n[a[0]]=e.Workbook.WBProps[a[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=mt("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var o={name:Br(e.SheetNames[s].slice(0,31))};if(o.sheetId=""+(s+1),o["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}t[t.length]=mt("sheet",null,o)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(a){var l={name:a.Name};a.Comment&&(l.comment=a.Comment),a.Sheet!=null&&(l.localSheetId=""+a.Sheet),a.Hidden&&(l.hidden="1"),a.Ref&&(t[t.length]=mt("definedName",Br(a.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function xne(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Fw(e),r.name=pi(e),r}function Sne(e,t){return t||(t=Je(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),bC(e.strRelID,t),Un(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function _ne(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?pi(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function Ene(e,t){t||(t=Je(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),l5(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function Tne(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function kne(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=nX(e),o=ute(e,0,r),a=vC(e);e.l=n;var l={Name:s,Ptg:o};return i<268435455&&(l.Sheet=i),a&&(l.Comment=a),l}function Rne(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],i=!1;t||(t={}),t.biff=12;var s=[],o=[[]];return o.SheetNames=[],o.XTI=[],Mf[16]={n:"BrtFRTArchID$",f:Tne},ga(e,function(l,c,u){switch(u){case 156:o.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=di(l.Ptg,null,null,o,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:o[0].length?o.push([u,l]):o[0]=[u,l],o[o.length-1].XTI=[];break;case 362:o.length===0&&(o[0]=[],o[0].XTI=[]),o[o.length-1].XTI=o[o.length-1].XTI.concat(l),o.XTI=o.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(u),i=!0;break;case 36:n.pop(),i=!1;break;case 37:n.push(u),i=!0;break;case 38:n.pop(),i=!1;break;case 16:break;default:if(!c.T){if(!i||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+u.toString(16))}}},t),g8(r),r.Names=s,r.supbooks=o,r}function Ane(e,t){lt(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};lt(e,156,Sne(i))}lt(e,144)}function Fne(e,t){t||(t=Je(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Un("SheetJS",t),Un(N0.version,t),Un(N0.version,t),Un("7262",t),t.length>t.l?t.slice(0,t.l):t}function Mne(e,t){t||(t=Je(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function Dne(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,s=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&s==-1&&(s=n);s>i||(lt(e,135),lt(e,158,Mne(i)),lt(e,136))}}function Pne(e,t){var r=Bi();return lt(r,131),lt(r,128,Fne()),lt(r,153,Ene(e.Workbook&&e.Workbook.WBProps||null)),Dne(r,e),Ane(r,e),lt(r,132),r.end()}function Ine(e,t,r){return t.slice(-4)===".bin"?Rne(e,r):Cne(e,r)}function One(e,t,r,n,i,s,o,a){return t.slice(-4)===".bin"?Yre(e,n,r,i,s,o,a):kte(e,n,r,i,s,o,a)}function Nne(e,t,r,n,i,s,o,a){return t.slice(-4)===".bin"?hne(e,n,r,i,s):une(e,n,r,i,s)}function Lne(e,t,r,n,i,s,o,a){return t.slice(-4)===".bin"?HQ():jQ()}function Bne(e,t,r,n,i,s,o,a){return t.slice(-4)===".bin"?LQ():BQ()}function Hne(e,t,r,n){return t.slice(-4)===".bin"?IJ(e,r,n):xJ(e,r,n)}function jne(e,t,r){return Z5(e,r)}function Vne(e,t,r){return t.slice(-4)===".bin"?VZ(e,r):BZ(e,r)}function Gne(e,t,r){return t.slice(-4)===".bin"?DQ(e,r):SQ(e,r)}function zne(e,t,r){return t.slice(-4)===".bin"?yQ(e):bQ(e)}function Une(e,t,r,n){return r.slice(-4)===".bin"?CQ(e,t,r,n):void 0}function Wne(e,t,r){return t.slice(-4)===".bin"?gQ(e,t,r):vQ(e,t,r)}function $ne(e,t,r){return(t.slice(-4)===".bin"?Pne:v8)(e)}function qne(e,t,r,n,i){return(t.slice(-4)===".bin"?ane:h8)(e,r,n,i)}function Kne(e,t,r){return(t.slice(-4)===".bin"?UJ:X5)(e,r)}function Xne(e,t,r){return(t.slice(-4)===".bin"?UZ:V5)(e,r)}function Yne(e,t,r){return(t.slice(-4)===".bin"?PQ:e8)(e)}function Zne(e){return(e.slice(-4)===".bin"?mQ:J5)()}var b8=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,w8=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Ls(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var i=e.match(b8),s,o,a,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(w8),(o=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?a="xmlns"+s[1].slice(6):a=s[1].slice(o+1),n[a]=s[2].slice(1,s[2].length-1));return n}function Jne(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(b8),i,s,o,a;if(n)for(a=0;a!=n.length;++a)i=n[a].match(w8),(s=i[1].indexOf(":"))===-1?r[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?o="xmlns"+i[1].slice(6):o=i[1].slice(s+1),r[o]=i[2].slice(1,i[2].length-1));return r}var ef;function Qne(e,t){var r=ef[e]||xr(e);return r==="General"?Cc(t):As(r,t)}function eie(e,t,r,n){var i=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=Xr(n);break;case"i2":case"int":i=parseInt(n,10);break;case"r4":case"float":i=parseFloat(n);break;case"date":case"dateTime.tz":i=Zr(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[xr(t)]=i}function tie(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||ma[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=xf(e.v):e.w=Cc(e.v):e.w=Qne(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=ef[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&Ed(n)){var i=tc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(r.WTF)throw s}}}function rie(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=pJ[n.Pattern]||n.Pattern)}e[t.ID]=t}function nie(e,t,r,n,i,s,o,a,l,c){var u="General",h=n.StyleID,d={};c=c||{};var f=[],m=0;for(h===void 0&&a&&(h=a.StyleID),h===void 0&&o&&(h=o.StyleID);s[h]!==void 0&&(s[h].nf&&(u=s[h].nf),s[h].Interior&&f.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=Xr(e);break;case"String":n.t="s",n.r=M3(xr(e)),n.v=e.indexOf("<")>-1?xr(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(Zr(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=xr(e):n.v<60&&(n.v=n.v-1),(!u||u=="General")&&(u="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=f5[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=M3(t||e));break}if(tie(n,u,c),c.cellFormula!==!1)if(n.Formula){var v=xr(n.Formula);v.charCodeAt(0)==61&&(v=v.slice(1)),n.f=nd(v,i),delete n.Formula,n.ArrayRange=="RC"?n.F=nd("RC:RC",i):n.ArrayRange&&(n.F=nd(n.ArrayRange,i),l.push([Sr(n.F),n.F]))}else for(m=0;m<l.length;++m)i.r>=l[m][0].s.r&&i.r<=l[m][0].e.r&&i.c>=l[m][0].s.c&&i.c<=l[m][0].e.c&&(n.F=l[m][1]);c.cellStyles&&(f.forEach(function(g){!d.patternType&&g.patternType&&(d.patternType=g.patternType)}),n.s=d),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function iie(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Ab(e,t){var r=t||{};Td();var n=Dh(dC(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=Ur(n));var i=n.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var o=Jr(r);return o.type="string",gd.to_workbook(n,o)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(me){i.indexOf("<"+me)>=0&&(s=!0)}),s)return zie(n,r);ef={"General Number":"General","General Date":Gt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":Gt[15],"Short Date":Gt[14],"Long Time":Gt[19],"Medium Time":Gt[18],"Short Time":Gt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:Gt[2],Standard:Gt[4],Percent:Gt[10],Scientific:Gt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var a,l=[],c,u={},h=[],d=r.dense?[]:{},f="",m={},v={},g=Ls('<Data ss:Type="String">'),w=0,y=0,C=0,k={s:{r:2e6,c:2e6},e:{r:0,c:0}},F={},I={},N="",j=0,L=[],W={},K={},z=0,M=[],B=[],R={},S=[],_,T=!1,E=[],D=[],O={},P=0,q=0,X={Sheets:[],WBProps:{date1904:!1}},Q={};Ef.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var G="";a=Ef.exec(n);)switch(a[3]=(G=a[3]).toLowerCase()){case"data":if(G=="data"){if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break}if(l[l.length-1][1])break;a[1]==="/"?nie(n.slice(w,a.index),N,g,l[l.length-1][0]=="comment"?R:m,{c:y,r:C},F,S[y],v,E,r):(N="",g=Ls(a[0]),w=a.index+a[0].length);break;case"cell":if(a[1]==="/")if(B.length>0&&(m.c=B),(!r.sheetRows||r.sheetRows>C)&&m.v!==void 0&&(r.dense?(d[C]||(d[C]=[]),d[C][y]=m):d[sn(y)+Sn(C)]=m),m.HRef&&(m.l={Target:xr(m.HRef)},m.HRefScreenTip&&(m.l.Tooltip=m.HRefScreenTip),delete m.HRef,delete m.HRefScreenTip),(m.MergeAcross||m.MergeDown)&&(P=y+(parseInt(m.MergeAcross,10)|0),q=C+(parseInt(m.MergeDown,10)|0),L.push({s:{c:y,r:C},e:{c:P,r:q}})),!r.sheetStubs)m.MergeAcross?y=P+1:++y;else if(m.MergeAcross||m.MergeDown){for(var ee=y;ee<=P;++ee)for(var V=C;V<=q;++V)(ee>y||V>C)&&(r.dense?(d[V]||(d[V]=[]),d[V][ee]={t:"z"}):d[sn(ee)+Sn(V)]={t:"z"});y=P+1}else++y;else m=Jne(a[0]),m.Index&&(y=+m.Index-1),y<k.s.c&&(k.s.c=y),y>k.e.c&&(k.e.c=y),a[0].slice(-2)==="/>"&&++y,B=[];break;case"row":a[1]==="/"||a[0].slice(-2)==="/>"?(C<k.s.r&&(k.s.r=C),C>k.e.r&&(k.e.r=C),a[0].slice(-2)==="/>"&&(v=Ls(a[0]),v.Index&&(C=+v.Index-1)),y=0,++C):(v=Ls(a[0]),v.Index&&(C=+v.Index-1),O={},(v.AutoFitHeight=="0"||v.Height)&&(O.hpx=parseInt(v.Height,10),O.hpt=Ff(O.hpx),D[C]=O),v.Hidden=="1"&&(O.hidden=!0,D[C]=O));break;case"worksheet":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));h.push(f),k.s.r<=k.e.r&&k.s.c<=k.e.c&&(d["!ref"]=er(k),r.sheetRows&&r.sheetRows<=k.e.r&&(d["!fullref"]=d["!ref"],k.e.r=r.sheetRows-1,d["!ref"]=er(k))),L.length&&(d["!merges"]=L),S.length>0&&(d["!cols"]=S),D.length>0&&(d["!rows"]=D),u[f]=d}else k={s:{r:2e6,c:2e6},e:{r:0,c:0}},C=y=0,l.push([a[3],!1]),c=Ls(a[0]),f=xr(c.Name),d=r.dense?[]:{},L=[],E=[],D=[],Q={name:f,Hidden:0},X.Sheets.push(Q);break;case"table":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else{if(a[0].slice(-2)=="/>")break;l.push([a[3],!1]),S=[],T=!1}break;case"style":a[1]==="/"?rie(F,I,r):I=Ls(a[0]);break;case"numberformat":I.nf=xr(Ls(a[0]).Format||"General"),ef[I.nf]&&(I.nf=ef[I.nf]);for(var H=0;H!=392&&Gt[H]!=I.nf;++H);if(H==392){for(H=57;H!=392;++H)if(Gt[H]==null){sa(I.nf,H);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(_=Ls(a[0]),_.Hidden&&(_.hidden=!0,delete _.Hidden),_.Width&&(_.wpx=parseInt(_.Width,10)),!T&&_.wpx>10){T=!0,hi=q5;for(var Z=0;Z<S.length;++Z)S[Z]&&hl(S[Z])}T&&hl(_),S[_.Index-1||S.length]=_;for(var ie=0;ie<+_.Span;++ie)S[S.length]=Jr(_);break;case"namedrange":if(a[1]==="/")break;X.Names||(X.Names=[]);var te=Wt(a[0]),oe={Name:te.Name,Ref:nd(te.RefersTo.slice(1),{r:0,c:0})};X.Sheets.length>0&&(oe.Sheet=X.Sheets.length-1),X.Names.push(oe);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(a[0].slice(-2)==="/>")break;a[1]==="/"?N+=n.slice(j,a.index):j=a.index+a[0].length;break;case"interior":if(!r.cellStyles)break;I.Interior=Ls(a[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(a[0].slice(-2)==="/>")break;a[1]==="/"?RX(W,G,n.slice(z,a.index)):z=a.index+a[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else l.push([a[3],!1]);break;case"comment":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"));iie(R),B.push(R)}else l.push([a[3],!1]),c=Ls(a[0]),R={a:c.Author};break;case"autofilter":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else if(a[0].charAt(a[0].length-2)!=="/"){var ue=Ls(a[0]);d["!autofilter"]={ref:nd(ue.Range).replace(/\$/g,"")},l.push([a[3],!0])}break;case"name":break;case"datavalidation":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(a[1]==="/"){if((c=l.pop())[0]!==a[3])throw new Error("Bad state: "+c.join("|"))}else a[0].charAt(a[0].length-2)!=="/"&&l.push([a[3],!0]);break;case"null":break;default:if(l.length==0&&a[3]=="document"||l.length==0&&a[3]=="uof")return wE(n,r);var Ce=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(a[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Ce=!1}break;case"componentoptions":switch(a[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Ce=!1}break;case"excelworkbook":switch(a[3]){case"date1904":X.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Ce=!1}break;case"workbookoptions":switch(a[3]){case"owcversion":break;case"height":break;case"width":break;default:Ce=!1}break;case"worksheetoptions":switch(a[3]){case"visible":if(a[0].slice(-2)!=="/>")if(a[1]==="/")switch(n.slice(z,a.index)){case"SheetHidden":Q.Hidden=1;break;case"SheetVeryHidden":Q.Hidden=2;break}else z=a.index+a[0].length;break;case"header":d["!margins"]||fc(d["!margins"]={},"xlml"),isNaN(+Wt(a[0]).Margin)||(d["!margins"].header=+Wt(a[0]).Margin);break;case"footer":d["!margins"]||fc(d["!margins"]={},"xlml"),isNaN(+Wt(a[0]).Margin)||(d["!margins"].footer=+Wt(a[0]).Margin);break;case"pagemargins":var ye=Wt(a[0]);d["!margins"]||fc(d["!margins"]={},"xlml"),isNaN(+ye.Top)||(d["!margins"].top=+ye.Top),isNaN(+ye.Left)||(d["!margins"].left=+ye.Left),isNaN(+ye.Right)||(d["!margins"].right=+ye.Right),isNaN(+ye.Bottom)||(d["!margins"].bottom=+ye.Bottom);break;case"displayrighttoleft":X.Views||(X.Views=[]),X.Views[0]||(X.Views[0]={}),X.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":d["!outline"]||(d["!outline"]={}),d["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Ce=!1}break;case"pivottable":case"pivotcache":switch(a[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Ce=!1}break;case"pagebreaks":switch(a[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Ce=!1}break;case"autofilter":switch(a[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Ce=!1}break;case"querytable":switch(a[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Ce=!1}break;case"datavalidation":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Ce=!1}break;case"sorting":case"conditionalformatting":switch(a[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Ce=!1}break;case"mapinfo":case"schema":case"data":switch(a[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Ce=!1}break;case"smarttags":break;default:Ce=!1;break}if(Ce||a[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+a[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(a[0].slice(-2)==="/>")break;a[1]==="/"?eie(K,G,M,n.slice(z,a.index)):(M=a,z=a.index+a[0].length);break}if(r.WTF)throw"Unrecognized tag: "+a[3]+"|"+l.join("|")}var ne={};return!r.bookSheets&&!r.bookProps&&(ne.Sheets=u),ne.SheetNames=h,ne.Workbook=X,ne.SSF=Jr(Gt),ne.Props=W,ne.Custprops=K,ne}function Lw(e,t){switch(OC(t=t||{}),t.type||"base64"){case"base64":return Ab(is(e),t);case"binary":case"buffer":case"file":return Ab(e,t);case"array":return Ab(Cl(e),t)}}function sie(e,t){var r=[];return e.Props&&r.push(AX(e.Props,t)),e.Custprops&&r.push(FX(e.Props,e.Custprops)),r.join("")}function oie(){return""}function aie(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var s=[];s.push(mt("NumberFormat",null,{"ss:Format":Br(Gt[n.numFmtId])}));var o={"ss:ID":"s"+(21+i)};r.push(mt("Style",s.join(""),o))}),mt("Styles",r.join(""))}function y8(e){return mt("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+AC(e.Ref,{r:0,c:0})})}function lie(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(y8(i)))}return mt("Names",r.join(""))}function cie(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,s=[],o=0;o<i.length;++o){var a=i[o];a.Sheet==r&&(a.Name.match(/^_xlfn\./)||s.push(y8(a)))}return s.join("")}function uie(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(mt("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(mt("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(mt("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(mt("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<r&&!(n.Workbook.Sheets[s]&&!n.Workbook.Sheets[s].Hidden);++s);s==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(ri("ProtectContents","True")),e["!protect"].objects&&i.push(ri("ProtectObjects","True")),e["!protect"].scenarios&&i.push(ri("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(ri("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(ri("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){e["!protect"][o[0]]&&i.push("<"+o[1]+"/>")})),i.length==0?"":mt("WorksheetOptions",i.join(""),{xmlns:Zi.x})}function die(e){return e.map(function(t){var r=DK(t.t||""),n=mt("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return mt("Comment",n,{"ss:Author":t.a})}).join("")}function hie(e,t,r,n,i,s,o){if(!e||e.v==null&&e.f==null)return"";var a={};if(e.f&&(a["ss:Formula"]="="+Br(AC(e.f,o))),e.F&&e.F.slice(0,t.length)==t){var l=on(e.F.slice(t.length+1));a["ss:ArrayRange"]="RC:R"+(l.r==o.r?"":"["+(l.r-o.r)+"]")+"C"+(l.c==o.c?"":"["+(l.c-o.c)+"]")}if(e.l&&e.l.Target&&(a["ss:HRef"]=Br(e.l.Target),e.l.Tooltip&&(a["x:HRefScreenTip"]=Br(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=o.c||c[u].s.r!=o.r||(c[u].e.c>c[u].s.c&&(a["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(a["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",d="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",d=String(e.v);break;case"b":h="Boolean",d=e.v?"1":"0";break;case"e":h="Error",d=ma[e.v];break;case"d":h="DateTime",d=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Gt[14]);break;case"s":h="String",d=MK(e.v||"");break}var f=Sl(n.cellXfs,e,n);a["ss:StyleID"]="s"+(21+f),a["ss:Index"]=o.c+1;var m=e.v!=null?d:"",v=e.t=="z"?"":'<Data ss:Type="'+h+'">'+m+"</Data>";return(e.c||[]).length>0&&(v+=die(e.c)),mt("Cell",v,a)}function fie(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=md(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function pie(e,t,r,n){if(!e["!ref"])return"";var i=Sr(e["!ref"]),s=e["!merges"]||[],o=0,a=[];e["!cols"]&&e["!cols"].forEach(function(g,w){hl(g);var y=!!g.width,C=_m(w,g),k={"ss:Index":w+1};y&&(k["ss:Width"]=Rf(C.width)),g.hidden&&(k["ss:Hidden"]="1"),a.push(mt("Column",null,k))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[fie(c,(e["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var d=!1;for(o=0;o!=s.length;++o)if(!(s[o].s.c>h)&&!(s[o].s.r>c)&&!(s[o].e.c<h)&&!(s[o].e.r<c)){(s[o].s.c!=h||s[o].s.r!=c)&&(d=!0);break}if(!d){var f={r:c,c:h},m=zt(f),v=l?(e[c]||[])[h]:e[m];u.push(hie(v,m,e,t,r,n,f))}}u.push("</Row>"),u.length>2&&a.push(u.join(""))}return a.join("")}function gie(e,t,r){var n=[],i=r.SheetNames[e],s=r.Sheets[i],o=s?cie(s,t,e,r):"";return o.length>0&&n.push("<Names>"+o+"</Names>"),o=s?pie(s,t,e,r):"",o.length>0&&n.push("<Table>"+o+"</Table>"),n.push(uie(s,t,e,r)),n.join("")}function mie(e,t){t||(t={}),e.SSF||(e.SSF=Jr(Gt)),e.SSF&&(Td(),vm(e.SSF),t.revssf=wm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Sl(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(sie(e,t)),r.push(oie()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(mt("Worksheet",gie(n,t,e),{"ss:Name":Br(e.SheetNames[n])}));return r[2]=aie(e,t),r[3]=lie(e),_n+mt("Workbook",r.join(""),{xmlns:Zi.ss,"xmlns:o":Zi.o,"xmlns:x":Zi.x,"xmlns:ss":Zi.ss,"xmlns:dt":Zi.dt,"xmlns:html":Zi.html})}function vie(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=lX(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=cX(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var bie=[60,1084,2066,2165,2175];function wie(e,t,r,n,i){var s=n,o=[],a=r.slice(r.l,r.l+s);if(i&&i.enc&&i.enc.insitu&&a.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(a)}o.push(a),r.l+=s;for(var l=Qo(r,r.l),c=Bw[l],u=0;c!=null&&bie.indexOf(l)>-1;)s=Qo(r,r.l+2),u=r.l+4,l==2066?u+=4:(l==2165||l==2175)&&(u+=12),a=r.slice(u,r.l+4+s),o.push(a),r.l+=4+s,c=Bw[l=Qo(r,r.l)];var h=Vn(o);ti(h,0);var d=0;h.lens=[];for(var f=0;f<o.length;++f)h.lens.push(d),d+=o[f].length;if(h.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+n;return t.f(h,h.length,i)}function lo(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=Gt[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||ma[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=xf(e.v):e.w=Cc(e.v):e.w=As(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&Ed(Gt[n]||String(n))){var i=tc(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Ig(e,t,r){return{v:e,ixfe:t,t:r}}function yie(e,t){var r={opts:{}},n={},i=t.dense?[]:{},s={},o={},a=null,l=[],c="",u={},h,d="",f,m,v,g,w={},y=[],C,k,F=[],I=[],N={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},L=function(we){return we<8?uc[we]:we<64&&I[we-8]||uc[we]},W=function(we,Ee,Ie){var Pe=Ee.XF.data;if(!(!Pe||!Pe.patternType||!Ie||!Ie.cellStyles)){Ee.s={},Ee.s.patternType=Pe.patternType;var De;(De=kf(L(Pe.icvFore)))&&(Ee.s.fgColor={rgb:De}),(De=kf(L(Pe.icvBack)))&&(Ee.s.bgColor={rgb:De})}},K=function(we,Ee,Ie){if(!(O>1)&&!(Ie.sheetRows&&we.r>=Ie.sheetRows)){if(Ie.cellStyles&&Ee.XF&&Ee.XF.data&&W(we,Ee,Ie),delete Ee.ixfe,delete Ee.XF,h=we,d=zt(we),(!o||!o.s||!o.e)&&(o={s:{r:0,c:0},e:{r:0,c:0}}),we.r<o.s.r&&(o.s.r=we.r),we.c<o.s.c&&(o.s.c=we.c),we.r+1>o.e.r&&(o.e.r=we.r+1),we.c+1>o.e.c&&(o.e.c=we.c+1),Ie.cellFormula&&Ee.f){for(var Pe=0;Pe<y.length;++Pe)if(!(y[Pe][0].s.c>we.c||y[Pe][0].s.r>we.r)&&!(y[Pe][0].e.c<we.c||y[Pe][0].e.r<we.r)){Ee.F=er(y[Pe][0]),(y[Pe][0].s.c!=we.c||y[Pe][0].s.r!=we.r)&&delete Ee.f,Ee.f&&(Ee.f=""+di(y[Pe][1],o,we,E,z));break}}Ie.dense?(i[we.r]||(i[we.r]=[]),i[we.r][we.c]=Ee):i[d]=Ee}},z={enc:!1,sbcch:0,snames:[],sharedf:w,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(z.password=t.password);var M,B=[],R=[],S=[],_=[],T=!1,E=[];E.SheetNames=z.snames,E.sharedf=z.sharedf,E.arrayf=z.arrayf,E.names=[],E.XTI=[];var D=0,O=0,P=0,q=[],X=[],Q;z.codepage=1200,zs(1200);for(var G=!1;e.l<e.length-1;){var ee=e.l,V=e.read_shift(2);if(V===0&&D===10)break;var H=e.l===e.length?0:e.read_shift(2),Z=Bw[V];if(Z&&Z.f){if(t.bookSheets&&D===133&&V!==133)break;if(D=V,Z.r===2||Z.r==12){var ie=e.read_shift(2);if(H-=2,!z.enc&&ie!==V&&((ie&255)<<8|ie>>8)!==V)throw new Error("rt mismatch: "+ie+"!="+V);Z.r==12&&(e.l+=10,H-=10)}var te={};if(V===10?te=Z.f(e,H,z):te=wie(V,Z,e,H,z),O==0&&[9,521,1033,2057].indexOf(D)===-1)continue;switch(V){case 34:r.opts.Date1904=N.WBProps.date1904=te;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(z.enc||(e.l=0),z.enc=te,!t.password)throw new Error("File is password-protected");if(te.valid==null)throw new Error("Encryption scheme unsupported");if(!te.valid)throw new Error("Password is incorrect");break;case 92:z.lastuser=te;break;case 66:var oe=Number(te);switch(oe){case 21010:oe=1200;break;case 32768:oe=1e4;break;case 32769:oe=1252;break}zs(z.codepage=oe),G=!0;break;case 317:z.rrtabid=te;break;case 25:z.winlocked=te;break;case 439:r.opts.RefreshAll=te;break;case 12:r.opts.CalcCount=te;break;case 16:r.opts.CalcDelta=te;break;case 17:r.opts.CalcIter=te;break;case 13:r.opts.CalcMode=te;break;case 14:r.opts.CalcPrecision=te;break;case 95:r.opts.CalcSaveRecalc=te;break;case 15:z.CalcRefMode=te;break;case 2211:r.opts.FullCalc=te;break;case 129:te.fDialog&&(i["!type"]="dialog"),te.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),te.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:F.push(te);break;case 430:E.push([te]),E[E.length-1].XTI=[];break;case 35:case 547:E[E.length-1].push(te);break;case 24:case 536:Q={Name:te.Name,Ref:di(te.rgce,o,null,E,z)},te.itab>0&&(Q.Sheet=te.itab-1),E.names.push(Q),E[0]||(E[0]=[],E[0].XTI=[]),E[E.length-1].push(te),te.Name=="_xlnm._FilterDatabase"&&te.itab>0&&te.rgce&&te.rgce[0]&&te.rgce[0][0]&&te.rgce[0][0][0]=="PtgArea3d"&&(X[te.itab-1]={ref:er(te.rgce[0][0][1][2])});break;case 22:z.ExternCount=te;break;case 23:E.length==0&&(E[0]=[],E[0].XTI=[]),E[E.length-1].XTI=E[E.length-1].XTI.concat(te),E.XTI=E.XTI.concat(te);break;case 2196:if(z.biff<8)break;Q!=null&&(Q.Comment=te[1]);break;case 18:i["!protect"]=te;break;case 19:te!==0&&z.WTF&&console.error("Password verifier: "+te);break;case 133:s[te.pos]=te,z.snames.push(te.name);break;case 10:{if(--O)break;if(o.e){if(o.e.r>0&&o.e.c>0){if(o.e.r--,o.e.c--,i["!ref"]=er(o),t.sheetRows&&t.sheetRows<=o.e.r){var ue=o.e.r;o.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=er(o),o.e.r=ue}o.e.r++,o.e.c++}B.length>0&&(i["!merges"]=B),R.length>0&&(i["!objects"]=R),S.length>0&&(i["!cols"]=S),_.length>0&&(i["!rows"]=_),N.Sheets.push(j)}c===""?u=i:n[c]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(z.biff===8&&(z.biff={9:2,521:3,1033:4}[V]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[te.BIFFVer]||8),z.biffguess=te.BIFFVer==0,te.BIFFVer==0&&te.dt==4096&&(z.biff=5,G=!0,zs(z.codepage=28591)),z.biff==8&&te.BIFFVer==0&&te.dt==16&&(z.biff=2),O++)break;if(i=t.dense?[]:{},z.biff<8&&!G&&(G=!0,zs(z.codepage=t.codepage||1252)),z.biff<5||te.BIFFVer==0&&te.dt==4096){c===""&&(c="Sheet1"),o={s:{r:0,c:0},e:{r:0,c:0}};var Ce={pos:e.l-H,name:c};s[Ce.pos]=Ce,z.snames.push(c)}else c=(s[ee]||{name:""}).name;te.dt==32&&(i["!type"]="chart"),te.dt==64&&(i["!type"]="macro"),B=[],R=[],z.arrayf=y=[],S=[],_=[],T=!1,j={Hidden:(s[ee]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[te.r]||[])[te.c]:i[zt({c:te.c,r:te.r})])&&++te.c,C={ixfe:te.ixfe,XF:F[te.ixfe]||{},v:te.val,t:"n"},P>0&&(C.z=q[C.ixfe>>8&63]),lo(C,t,r.opts.Date1904),K({c:te.c,r:te.r},C,t);break;case 5:case 517:C={ixfe:te.ixfe,XF:F[te.ixfe],v:te.val,t:te.t},P>0&&(C.z=q[C.ixfe>>8&63]),lo(C,t,r.opts.Date1904),K({c:te.c,r:te.r},C,t);break;case 638:C={ixfe:te.ixfe,XF:F[te.ixfe],v:te.rknum,t:"n"},P>0&&(C.z=q[C.ixfe>>8&63]),lo(C,t,r.opts.Date1904),K({c:te.c,r:te.r},C,t);break;case 189:for(var ye=te.c;ye<=te.C;++ye){var ne=te.rkrec[ye-te.c][0];C={ixfe:ne,XF:F[ne],v:te.rkrec[ye-te.c][1],t:"n"},P>0&&(C.z=q[C.ixfe>>8&63]),lo(C,t,r.opts.Date1904),K({c:ye,r:te.r},C,t)}break;case 6:case 518:case 1030:{if(te.val=="String"){a=te;break}if(C=Ig(te.val,te.cell.ixfe,te.tt),C.XF=F[C.ixfe],t.cellFormula){var me=te.formula;if(me&&me[0]&&me[0][0]&&me[0][0][0]=="PtgExp"){var ve=me[0][0][1][0],Te=me[0][0][1][1],xe=zt({r:ve,c:Te});w[xe]?C.f=""+di(te.formula,o,te.cell,E,z):C.F=((t.dense?(i[ve]||[])[Te]:i[xe])||{}).F}else C.f=""+di(te.formula,o,te.cell,E,z)}P>0&&(C.z=q[C.ixfe>>8&63]),lo(C,t,r.opts.Date1904),K(te.cell,C,t),a=te}break;case 7:case 519:if(a)a.val=te,C=Ig(te,a.cell.ixfe,"s"),C.XF=F[C.ixfe],t.cellFormula&&(C.f=""+di(a.formula,o,a.cell,E,z)),P>0&&(C.z=q[C.ixfe>>8&63]),lo(C,t,r.opts.Date1904),K(a.cell,C,t),a=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(te);var Fe=zt(te[0].s);if(f=t.dense?(i[te[0].s.r]||[])[te[0].s.c]:i[Fe],t.cellFormula&&f){if(!a||!Fe||!f)break;f.f=""+di(te[1],o,te[0],E,z),f.F=er(te[0])}}break;case 1212:{if(!t.cellFormula)break;if(d){if(!a)break;w[zt(a.cell)]=te[0],f=t.dense?(i[a.cell.r]||[])[a.cell.c]:i[zt(a.cell)],(f||{}).f=""+di(te[0],o,h,E,z)}}break;case 253:C=Ig(l[te.isst].t,te.ixfe,"s"),l[te.isst].h&&(C.h=l[te.isst].h),C.XF=F[C.ixfe],P>0&&(C.z=q[C.ixfe>>8&63]),lo(C,t,r.opts.Date1904),K({c:te.c,r:te.r},C,t);break;case 513:t.sheetStubs&&(C={ixfe:te.ixfe,XF:F[te.ixfe],t:"z"},P>0&&(C.z=q[C.ixfe>>8&63]),lo(C,t,r.opts.Date1904),K({c:te.c,r:te.r},C,t));break;case 190:if(t.sheetStubs)for(var Ge=te.c;Ge<=te.C;++Ge){var Ve=te.ixfe[Ge-te.c];C={ixfe:Ve,XF:F[Ve],t:"z"},P>0&&(C.z=q[C.ixfe>>8&63]),lo(C,t,r.opts.Date1904),K({c:Ge,r:te.r},C,t)}break;case 214:case 516:case 4:C=Ig(te.val,te.ixfe,"s"),C.XF=F[C.ixfe],P>0&&(C.z=q[C.ixfe>>8&63]),lo(C,t,r.opts.Date1904),K({c:te.c,r:te.r},C,t);break;case 0:case 512:O===1&&(o=te);break;case 252:l=te;break;case 1054:if(z.biff==4){q[P++]=te[1];for(var Ye=0;Ye<P+163&&Gt[Ye]!=te[1];++Ye);Ye>=163&&sa(te[1],P+163)}else sa(te[1],te[0]);break;case 30:{q[P++]=te;for(var ut=0;ut<P+163&&Gt[ut]!=te;++ut);ut>=163&&sa(te,P+163)}break;case 229:B=B.concat(te);break;case 93:R[te.cmo[0]]=z.lastobj=te;break;case 438:z.lastobj.TxO=te;break;case 127:z.lastobj.ImData=te;break;case 440:for(g=te[0].s.r;g<=te[0].e.r;++g)for(v=te[0].s.c;v<=te[0].e.c;++v)f=t.dense?(i[g]||[])[v]:i[zt({c:v,r:g})],f&&(f.l=te[1]);break;case 2048:for(g=te[0].s.r;g<=te[0].e.r;++g)for(v=te[0].s.c;v<=te[0].e.c;++v)f=t.dense?(i[g]||[])[v]:i[zt({c:v,r:g})],f&&f.l&&(f.l.Tooltip=te[1]);break;case 28:{if(z.biff<=5&&z.biff>=2)break;f=t.dense?(i[te[0].r]||[])[te[0].c]:i[zt(te[0])];var ht=R[te[2]];f||(t.dense?(i[te[0].r]||(i[te[0].r]=[]),f=i[te[0].r][te[0].c]={t:"z"}):f=i[zt(te[0])]={t:"z"},o.e.r=Math.max(o.e.r,te[0].r),o.s.r=Math.min(o.s.r,te[0].r),o.e.c=Math.max(o.e.c,te[0].c),o.s.c=Math.min(o.s.c,te[0].c)),f.c||(f.c=[]),m={a:te[1],t:ht.TxO.t},f.c.push(m)}break;case 2173:aQ(F[te.ixfe],te.ext);break;case 125:{if(!z.cellStyles)break;for(;te.e>=te.s;)S[te.e--]={width:te.w/256,level:te.level||0,hidden:!!(te.flags&1)},T||(T=!0,TC(te.w/256)),hl(S[te.e+1])}break;case 520:{var be={};te.level!=null&&(_[te.r]=be,be.level=te.level),te.hidden&&(_[te.r]=be,be.hidden=!0),te.hpt&&(_[te.r]=be,be.hpt=te.hpt,be.hpx=md(te.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||fc(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[V]]=te;break;case 161:i["!margins"]||fc(i["!margins"]={}),i["!margins"].header=te.header,i["!margins"].footer=te.footer;break;case 574:te.RTL&&(N.Views[0].RTL=!0);break;case 146:I=te;break;case 2198:M=te;break;case 140:k=te;break;case 442:c?j.CodeName=te||j.name:N.WBProps.CodeName=te||"ThisWorkbook";break}}else Z||console.error("Missing Info for XLS Record 0x"+V.toString(16)),e.l+=H}return r.SheetNames=hn(s).sort(function(ze,we){return Number(ze)-Number(we)}).map(function(ze){return s[ze].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&u["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=u)):r.Preamble=u,r.Sheets&&X.forEach(function(ze,we){r.Sheets[r.SheetNames[we]]["!autofilter"]=ze}),r.Strings=l,r.SSF=Jr(Gt),z.enc&&(r.Encryption=z.enc),M&&(r.Themes=M),r.Metadata={},k!==void 0&&(r.Metadata.Country=k),E.names.length>0&&(N.Names=E.names),r.Workbook=N,r}var tf={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Cie(e,t,r){var n=Mt.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var i=X3(n,Mw,tf.DSI);for(var s in i)t[s]=i[s]}catch(c){if(r.WTF)throw c}var o=Mt.find(e,"/!SummaryInformation");if(o&&o.size>0)try{var a=X3(o,Dw,tf.SI);for(var l in a)t[l]==null&&(t[l]=a[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(w5(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function xie(e,t){var r=[],n=[],i=[],s=0,o,a=E3(Mw,"n"),l=E3(Dw,"n");if(e.Props)for(o=hn(e.Props),s=0;s<o.length;++s)(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],e.Props[o[s]]]);if(e.Custprops)for(o=hn(e.Custprops),s=0;s<o.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},o[s])||(Object.prototype.hasOwnProperty.call(a,o[s])?r:Object.prototype.hasOwnProperty.call(l,o[s])?n:i).push([o[s],e.Custprops[o[s]]]);var c=[];for(s=0;s<i.length;++s)T5.indexOf(i[s][0])>-1||b5.indexOf(i[s][0])>-1||i[s][1]!=null&&c.push(i[s]);n.length&&Mt.utils.cfb_add(t,"/SummaryInformation",Y3(n,tf.SI,l,Dw)),(r.length||c.length)&&Mt.utils.cfb_add(t,"/DocumentSummaryInformation",Y3(r,tf.DSI,a,Mw,c.length?c:null,tf.UDI))}function C8(e,t){t||(t={}),OC(t),rC(),t.codepage&&tC(t.codepage);var r,n;if(e.FullPaths){if(Mt.find(e,"/encryption"))throw new Error("File is password-protected");r=Mt.find(e,"!CompObj"),n=Mt.find(e,"/Workbook")||Mt.find(e,"/Book")}else{switch(t.type){case"base64":e=Qi(is(e));break;case"binary":e=Qi(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}ti(e,0),n={content:e}}var i,s;if(r&&vie(r),t.bookProps&&!t.bookSheets)i={};else{var o=ar?"buffer":"array";if(n&&n.content)i=yie(n.content,t);else if((s=Mt.find(e,"PerfectOffice_MAIN"))&&s.content)i=hc.to_workbook(s.content,(t.type=o,t));else if((s=Mt.find(e,"NativeContent_MAIN"))&&s.content)i=hc.to_workbook(s.content,(t.type=o,t));else throw(s=Mt.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Mt.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=OQ(e))}var a={};return e.FullPaths&&Cie(e,a,t),i.Props=i.Custprops=a,t.bookFiles&&(i.cfb=e),i}function Sie(e,t){var r=t||{},n=Mt.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return Mt.utils.cfb_add(n,i,x8(e,r)),r.biff==8&&(e.Props||e.Custprops)&&xie(e,n),r.biff==8&&e.vbaraw&&NQ(n,Mt.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var Mf={0:{f:qte},1:{f:tre},2:{f:yre},3:{f:cre},4:{f:sre},5:{f:vre},6:{f:Ere},7:{f:fre},8:{f:Dre},9:{f:Mre},10:{f:Are},11:{f:Fre},12:{f:nre},13:{f:xre},14:{f:dre},15:{f:are},16:{f:f8},17:{f:kre},18:{f:gre},19:{f:mC},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:kne},40:{},42:{},43:{f:EJ},44:{f:SJ},45:{f:RJ},46:{f:FJ},47:{f:AJ},48:{},49:{f:YK},50:{},51:{f:uQ},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:L5},62:{f:_re},63:{f:wQ},64:{f:Kre},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:gi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ure},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Qte},148:{f:Yte,p:16},151:{f:Bre},152:{},153:{f:_ne},154:{},155:{},156:{f:xne},157:{},158:{},159:{T:1,f:jZ},160:{T:-1},161:{T:1,f:Lc},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Pre},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:lQ},336:{T:-1},337:{f:fQ,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Fw},357:{},358:{},359:{},360:{T:1},361:{},362:{f:N5},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Hre},427:{f:jre},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Gre},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Jte},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Nre},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Fw},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:FQ},633:{T:1},634:{T:-1},635:{T:1,f:RQ},636:{T:-1},637:{f:eX},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:dne},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Xre},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Bw={6:{f:kb},10:{f:Xa},12:{f:Mn},13:{f:Mn},14:{f:bn},15:{f:bn},16:{f:fi},17:{f:bn},18:{f:bn},19:{f:Mn},20:{f:rE},21:{f:rE},23:{f:N5},24:{f:iE},25:{f:bn},26:{},27:{},28:{f:XY},29:{},34:{f:bn},35:{f:nE},38:{f:fi},39:{f:fi},40:{f:fi},41:{f:fi},42:{f:bn},43:{f:bn},47:{f:aJ},49:{f:xY},51:{f:Mn},60:{},61:{f:vY},64:{f:bn},65:{f:CY},66:{f:Mn},77:{},80:{},81:{},82:{},85:{f:Mn},89:{},90:{},91:{},92:{f:oY},93:{f:JY},94:{},95:{f:bn},96:{},97:{},99:{f:bn},125:{f:L5},128:{f:LY},129:{f:lY},130:{f:Mn},131:{f:bn},132:{f:bn},133:{f:cY},134:{},140:{f:oZ},141:{f:Mn},144:{},146:{f:cZ},151:{},152:{},153:{},154:{},155:{},156:{f:Mn},157:{},158:{},160:{f:mZ},161:{f:hZ},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:PY},190:{f:IY},193:{f:Xa},197:{},198:{},199:{},200:{},201:{},202:{f:bn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Mn},220:{},221:{f:bn},222:{},224:{f:NY},225:{f:sY},226:{f:Xa},227:{},229:{f:YY},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:dY},253:{f:_Y},255:{f:fY},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:k5},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:bn},353:{f:Xa},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:GY},431:{f:bn},432:{},433:{},434:{},437:{},438:{f:tZ},439:{f:bn},440:{f:rZ},441:{},442:{f:Jf},443:{},444:{f:Mn},445:{},446:{},448:{f:Xa},449:{f:mY,r:2},450:{f:Xa},512:{f:Q3},513:{f:gZ},515:{f:jY},516:{f:TY},517:{f:tE},519:{f:vZ},520:{f:pY},523:{},545:{f:sE},549:{f:J3},566:{},574:{f:wY},638:{f:DY},659:{},1048:{},1054:{f:RY},1084:{},1212:{f:$Y},2048:{f:iZ},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Mg},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Xa},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:uZ,r:12},2173:{f:oQ,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:bn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:WY,r:12},2197:{},2198:{f:eQ,r:12},2199:{},2200:{},2201:{},2202:{f:qY,r:12},2203:{f:Xa},2204:{},2205:{},2206:{},2207:{},2211:{f:gY},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Mn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:fZ},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:lZ},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Q3},1:{},2:{f:xZ},3:{f:yZ},4:{f:wZ},5:{f:tE},7:{f:_Z},8:{},9:{f:Mg},11:{},22:{f:Mn},30:{f:FY},31:{},32:{},33:{f:sE},36:{},37:{f:J3},50:{f:EZ},62:{},52:{},67:{},68:{f:Mn},69:{},86:{},126:{},127:{f:bZ},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:TZ},223:{},234:{},354:{},421:{},518:{f:kb},521:{f:Mg},536:{f:iE},547:{f:nE},561:{},579:{},1030:{f:kb},1033:{f:Mg},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function vt(e,t,r,n){var i=t;if(!isNaN(i)){var s=n||(r||[]).length||0,o=e.next(4);o.write_shift(2,i),o.write_shift(2,s),s>0&&fC(r)&&e.push(r)}}function _ie(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return vt(e,t,r,i);var s=t;if(!isNaN(s)){for(var o=r.parts||[],a=0,l=0,c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;var u=e.next(4);for(u.write_shift(2,s),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(o[a]||8224)<=8224;)c+=o[a]||8224,a++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function rp(e,t,r){return e||(e=Je(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function Eie(e,t,r,n){var i=Je(9);return rp(i,e,t),R5(r,n||"b",i),i}function Tie(e,t,r){var n=Je(8+2*r.length);return rp(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function kie(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Ln(Zr(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?vt(e,2,SZ(r,n,i)):vt(e,3,CZ(r,n,i));return;case"b":case"e":vt(e,5,Eie(r,n,t.v,t.t));return;case"s":case"str":vt(e,4,Tie(r,n,(t.v||"").slice(0,255)));return}vt(e,1,rp(null,r,n))}function Rie(e,t,r,n){var i=Array.isArray(t),s=Sr(t["!ref"]||"A1"),o,a="",l=[];if(s.e.c>255||s.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),o=er(s)}for(var c=s.s.r;c<=s.e.r;++c){a=Sn(c);for(var u=s.s.c;u<=s.e.c;++u){c===s.s.r&&(l[u]=sn(u)),o=l[u]+a;var h=i?(t[c]||[])[u]:t[o];h&&kie(e,h,c,u)}}}function Aie(e,t){for(var r=t||{},n=Bi(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==r.sheet&&(i=s);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return vt(n,r.biff==4?1033:r.biff==3?521:9,SC(e,16,r)),Rie(n,e.Sheets[e.SheetNames[i]],i,r),vt(n,10),n.end()}function Fie(e,t,r){vt(e,49,SY({sz:12,name:"Arial"},r))}function Mie(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&vt(e,1054,AY(i,t[i],r))})}function Die(e,t){var r=Je(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),vt(e,2151,r),r=Je(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),P5(Sr(t["!ref"]||"A1"),r),r.write_shift(4,4),vt(e,2152,r)}function Pie(e,t){for(var r=0;r<16;++r)vt(e,224,eE({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){vt(e,224,eE(n,0,t))})}function Iie(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];vt(e,440,nZ(n)),n[1].Tooltip&&vt(e,2048,sZ(n))}delete t["!links"]}function Oie(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&vt(e,125,dZ(_m(i,n),i))})}}function Nie(e,t,r,n,i){var s=16+Sl(i.cellXfs,t,i);if(t.v==null&&!t.bf){vt(e,513,Ec(r,n,s));return}if(t.bf)vt(e,6,lte(t,r,n,i,s));else switch(t.t){case"d":case"n":var o=t.t=="d"?Ln(Zr(t.v)):t.v;vt(e,515,VY(r,n,o,s));break;case"b":case"e":vt(e,517,HY(r,n,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var a=MC(i.Strings,t.v,i.revStrings);vt(e,253,EY(r,n,a,s))}else vt(e,516,kY(r,n,(t.v||"").slice(0,255),s,i));break;default:vt(e,513,Ec(r,n,s))}}function Lie(e,t,r){var n=Bi(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=(r||{}).Workbook||{},a=(o.Sheets||[])[e]||{},l=Array.isArray(s),c=t.biff==8,u,h="",d=[],f=Sr(s["!ref"]||"A1"),m=c?65536:16384;if(f.e.c>255||f.e.r>=m){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");f.e.c=Math.min(f.e.c,255),f.e.r=Math.min(f.e.c,m-1)}vt(n,2057,SC(r,16,t)),vt(n,13,Cs(1)),vt(n,12,Cs(100)),vt(n,15,Ci(!0)),vt(n,17,Ci(!1)),vt(n,16,Sc(.001)),vt(n,95,Ci(!0)),vt(n,42,Ci(!1)),vt(n,43,Ci(!1)),vt(n,130,Cs(1)),vt(n,128,BY()),vt(n,131,Ci(!1)),vt(n,132,Ci(!1)),c&&Oie(n,s["!cols"]),vt(n,512,MY(f,t)),c&&(s["!links"]=[]);for(var v=f.s.r;v<=f.e.r;++v){h=Sn(v);for(var g=f.s.c;g<=f.e.c;++g){v===f.s.r&&(d[g]=sn(g)),u=d[g]+h;var w=l?(s[v]||[])[g]:s[u];w&&(Nie(n,w,v,g,t),c&&w.l&&s["!links"].push([u,w.l]))}}var y=a.CodeName||a.name||i;return c&&vt(n,574,yY((o.Views||[])[0])),c&&(s["!merges"]||[]).length&&vt(n,229,ZY(s["!merges"])),c&&Iie(n,s),vt(n,442,A5(y)),c&&Die(n,s),vt(n,10),n.end()}function Bie(e,t,r){var n=Bi(),i=(e||{}).Workbook||{},s=i.Sheets||[],o=i.WBProps||{},a=r.biff==8,l=r.biff==5;if(vt(n,2057,SC(e,5,r)),r.bookType=="xla"&&vt(n,135),vt(n,225,a?Cs(1200):null),vt(n,193,HX(2)),l&&vt(n,191),l&&vt(n,192),vt(n,226),vt(n,92,aY("SheetJS",r)),vt(n,66,Cs(a?1200:1252)),a&&vt(n,353,Cs(0)),a&&vt(n,448),vt(n,317,pZ(e.SheetNames.length)),a&&e.vbaraw&&vt(n,211),a&&e.vbaraw){var c=o.CodeName||"ThisWorkbook";vt(n,442,A5(c))}vt(n,156,Cs(17)),vt(n,25,Ci(!1)),vt(n,18,Ci(!1)),vt(n,19,Cs(0)),a&&vt(n,431,Ci(!1)),a&&vt(n,444,Cs(0)),vt(n,61,bY()),vt(n,64,Ci(!1)),vt(n,141,Cs(0)),vt(n,34,Ci(mne(e)=="true")),vt(n,14,Ci(!0)),a&&vt(n,439,Ci(!1)),vt(n,218,Cs(0)),Fie(n,e,r),Mie(n,e.SSF,r),Pie(n,r),a&&vt(n,352,Ci(!1));var u=n.end(),h=Bi();a&&vt(h,140,aZ()),a&&r.Strings&&_ie(h,252,hY(r.Strings)),vt(h,10);var d=h.end(),f=Bi(),m=0,v=0;for(v=0;v<e.SheetNames.length;++v)m+=(a?12:11)+(a?2:1)*e.SheetNames[v].length;var g=u.length+m+d.length;for(v=0;v<e.SheetNames.length;++v){var w=s[v]||{};vt(f,133,uY({pos:g,hs:w.Hidden||0,dt:0,name:e.SheetNames[v]},r)),g+=t[v].length}var y=f.end();if(m!=y.length)throw new Error("BS8 "+m+" != "+y.length);var C=[];return u.length&&C.push(u),y.length&&C.push(y),d.length&&C.push(d),Vn(C)}function Hie(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Jr(Gt)),e&&e.SSF&&(Td(),vm(e.SSF),r.revssf=wm(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,NC(r),r.cellXfs=[],Sl(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=Lie(i,r,e);return n.unshift(Bie(e,n,r)),Vn(n)}function x8(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=Vi(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return Hie(e,t);case 4:case 3:case 2:return Aie(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function gE(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),o=i.index,a=s&&s.index||e.length,l=SK(e.slice(o,a),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,u=0,h=0,d=0,f={s:{r:1e7,c:1e7},e:{r:0,c:0}},m=[];for(o=0;o<l.length;++o){var v=l[o].trim(),g=v.slice(0,3).toLowerCase();if(g=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}u=0;continue}if(!(g!="<td"&&g!="<th")){var w=v.split(/<\/t[dh]>/i);for(a=0;a<w.length;++a){var y=w[a].trim();if(y.match(/<t[dh]/i)){for(var C=y,k=0;C.charAt(0)=="<"&&(k=C.indexOf(">"))>-1;)C=C.slice(k+1);for(var F=0;F<m.length;++F){var I=m[F];I.s.c==u&&I.s.r<c&&c<=I.e.r&&(u=I.e.c+1,F=-1)}var N=Wt(y.slice(0,y.indexOf(">")));d=N.colspan?+N.colspan:1,((h=+N.rowspan)>1||d>1)&&m.push({s:{r:c,c:u},e:{r:c+(h||1)-1,c:u+d-1}});var j=N.t||N["data-t"]||"";if(!C.length){u+=d;continue}if(C=$6(C),f.s.r>c&&(f.s.r=c),f.e.r<c&&(f.e.r=c),f.s.c>u&&(f.s.c=u),f.e.c<u&&(f.e.c=u),!C.length){u+=d;continue}var L={t:"s",v:C};r.raw||!C.trim().length||j=="s"||(C==="TRUE"?L={t:"b",v:!0}:C==="FALSE"?L={t:"b",v:!1}:isNaN($s(C))?isNaN(pd(C).getDate())||(L={t:"d",v:Zr(C)},r.cellDates||(L={t:"n",v:Ln(L.v)}),L.z=r.dateNF||Gt[14]):L={t:"n",v:$s(C)}),r.dense?(n[c]||(n[c]=[]),n[c][u]=L):n[zt({r:c,c:u})]=L,u+=d}}}}return n["!ref"]=er(f),m.length&&(n["!merges"]=m),n}function jie(e,t,r,n){for(var i=e["!merges"]||[],s=[],o=t.s.c;o<=t.e.c;++o){for(var a=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>o)&&!(i[c].e.r<r||i[c].e.c<o)){if(i[c].s.r<r||i[c].s.c<o){a=-1;break}a=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(a<0)){var u=zt({r,c:o}),h=n.dense?(e[r]||[])[o]:e[u],d=h&&h.v!=null&&(h.h||uC(h.w||(ua(h),h.w)||""))||"",f={};a>1&&(f.rowspan=a),l>1&&(f.colspan=l),n.editable?d='<span contenteditable="true">'+d+"</span>":h&&(f["data-t"]=h&&h.t||"z",h.v!=null&&(f["data-v"]=h.v),h.z!=null&&(f["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(d='<a href="'+h.l.Target+'">'+d+"</a>")),f.id=(n.id||"sjs")+"-"+u,s.push(mt("td",d,f))}}var m="<tr>";return m+s.join("")+"</tr>"}var Vie='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',Gie="</body></html>";function zie(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return xl(gE(r[0],t),t);var n=jC();return r.forEach(function(i,s){VC(n,gE(i,t),"Sheet"+(s+1))}),n}function Uie(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function S8(e,t){var r=t||{},n=r.header!=null?r.header:Vie,i=r.footer!=null?r.footer:Gie,s=[n],o=Vi(e["!ref"]);r.dense=Array.isArray(e),s.push(Uie(e,o,r));for(var a=o.s.r;a<=o.e.r;++a)s.push(jie(e,o,a,r));return s.push("</table>"+i),s.join("")}function _8(e,t,r){var n=r||{},i=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var o=typeof n.origin=="string"?on(n.origin):n.origin;i=o.r,s=o.c}var a=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,a.length),c={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var u=Vi(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],d=0,f=e["!rows"]||(e["!rows"]=[]),m=0,v=0,g=0,w=0,y=0,C=0;for(e["!cols"]||(e["!cols"]=[]);m<a.length&&v<l;++m){var k=a[m];if(mE(k)){if(n.display)continue;f[v]={hidden:!0}}var F=k.children;for(g=w=0;g<F.length;++g){var I=F[g];if(!(n.display&&mE(I))){var N=I.hasAttribute("data-v")?I.getAttribute("data-v"):I.hasAttribute("v")?I.getAttribute("v"):$6(I.innerHTML),j=I.getAttribute("data-z")||I.getAttribute("z");for(d=0;d<h.length;++d){var L=h[d];L.s.c==w+s&&L.s.r<v+i&&v+i<=L.e.r&&(w=L.e.c+1-s,d=-1)}C=+I.getAttribute("colspan")||1,((y=+I.getAttribute("rowspan")||1)>1||C>1)&&h.push({s:{r:v+i,c:w+s},e:{r:v+i+(y||1)-1,c:w+s+(C||1)-1}});var W={t:"s",v:N},K=I.getAttribute("data-t")||I.getAttribute("t")||"";N!=null&&(N.length==0?W.t=K||"z":n.raw||N.trim().length==0||K=="s"||(N==="TRUE"?W={t:"b",v:!0}:N==="FALSE"?W={t:"b",v:!1}:isNaN($s(N))?isNaN(pd(N).getDate())||(W={t:"d",v:Zr(N)},n.cellDates||(W={t:"n",v:Ln(W.v)}),W.z=n.dateNF||Gt[14]):W={t:"n",v:$s(N)})),W.z===void 0&&j!=null&&(W.z=j);var z="",M=I.getElementsByTagName("A");if(M&&M.length)for(var B=0;B<M.length&&!(M[B].hasAttribute("href")&&(z=M[B].getAttribute("href"),z.charAt(0)!="#"));++B);z&&z.charAt(0)!="#"&&(W.l={Target:z}),n.dense?(e[v+i]||(e[v+i]=[]),e[v+i][w+s]=W):e[zt({c:w+s,r:v+i})]=W,c.e.c<w+s&&(c.e.c=w+s),w+=C}}++v}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,v-1+i),e["!ref"]=er(c),v>=l&&(e["!fullref"]=er((c.e.r=a.length-m+v-1+i,c))),e}function E8(e,t){var r=t||{},n=r.dense?[]:{};return _8(n,e,t)}function Wie(e,t){return xl(E8(e,t),t)}function mE(e){var t="",r=$ie(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function $ie(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function qie(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=xr(t.replace(/<[^>]*>/g,""));return[r]}var vE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function T8(e,t){var r=t||{},n=dC(e),i=[],s,o,a={name:""},l="",c=0,u,h,d={},f=[],m=r.dense?[]:{},v,g,w={value:""},y="",C=0,k=[],F=-1,I=-1,N={s:{r:1e6,c:1e7},e:{r:0,c:0}},j=0,L={},W=[],K={},z=0,M=0,B=[],R=1,S=1,_=[],T={Names:[]},E={},D=["",""],O=[],P={},q="",X=0,Q=!1,G=!1,ee=0;for(Ef.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");v=Ef.exec(n);)switch(v[3]=v[3].replace(/_.*$/,"")){case"table":case"":v[1]==="/"?(N.e.c>=N.s.c&&N.e.r>=N.s.r?m["!ref"]=er(N):m["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=N.e.r&&(m["!fullref"]=m["!ref"],N.e.r=r.sheetRows-1,m["!ref"]=er(N)),W.length&&(m["!merges"]=W),B.length&&(m["!rows"]=B),u.name=u.||u.name,typeof JSON<"u"&&JSON.stringify(u),f.push(u.name),d[u.name]=m,G=!1):v[0].charAt(v[0].length-2)!=="/"&&(u=Wt(v[0],!1),F=I=-1,N.s.r=N.s.c=1e7,N.e.r=N.e.c=0,m=r.dense?[]:{},W=[],B=[],G=!0);break;case"table-row-group":v[1]==="/"?--j:++j;break;case"table-row":case"":if(v[1]==="/"){F+=R,R=1;break}if(h=Wt(v[0],!1),h.?F=h.-1:F==-1&&(F=0),R=+h["number-rows-repeated"]||1,R<10)for(ee=0;ee<R;++ee)j>0&&(B[F+ee]={level:j});I=-1;break;case"covered-table-cell":v[1]!=="/"&&++I,r.sheetStubs&&(r.dense?(m[F]||(m[F]=[]),m[F][I]={t:"z"}):m[zt({r:F,c:I})]={t:"z"}),y="",k=[];break;case"table-cell":case"":if(v[0].charAt(v[0].length-2)==="/")++I,w=Wt(v[0],!1),S=parseInt(w["number-columns-repeated"]||"1",10),g={t:"z",v:null},w.formula&&r.cellFormula!=!1&&(g.f=hE(xr(w.formula))),(w.||w["value-type"])=="string"&&(g.t="s",g.v=xr(w["string-value"]||""),r.dense?(m[F]||(m[F]=[]),m[F][I]=g):m[zt({r:F,c:I})]=g),I+=S-1;else if(v[1]!=="/"){++I,y="",C=0,k=[],S=1;var V=R?F+R-1:F;if(I>N.e.c&&(N.e.c=I),I<N.s.c&&(N.s.c=I),F<N.s.r&&(N.s.r=F),V>N.e.r&&(N.e.r=V),w=Wt(v[0],!1),O=[],P={},g={t:w.||w["value-type"],v:null},r.cellFormula)if(w.formula&&(w.formula=xr(w.formula)),w["number-matrix-columns-spanned"]&&w["number-matrix-rows-spanned"]&&(z=parseInt(w["number-matrix-rows-spanned"],10)||0,M=parseInt(w["number-matrix-columns-spanned"],10)||0,K={s:{r:F,c:I},e:{r:F+z-1,c:I+M-1}},g.F=er(K),_.push([K,g.F])),w.formula)g.f=hE(w.formula);else for(ee=0;ee<_.length;++ee)F>=_[ee][0].s.r&&F<=_[ee][0].e.r&&I>=_[ee][0].s.c&&I<=_[ee][0].e.c&&(g.F=_[ee][1]);switch((w["number-columns-spanned"]||w["number-rows-spanned"])&&(z=parseInt(w["number-rows-spanned"],10)||0,M=parseInt(w["number-columns-spanned"],10)||0,K={s:{r:F,c:I},e:{r:F+z-1,c:I+M-1}},W.push(K)),w["number-columns-repeated"]&&(S=parseInt(w["number-columns-repeated"],10)),g.t){case"boolean":g.t="b",g.v=Xr(w["boolean-value"]);break;case"float":g.t="n",g.v=parseFloat(w.value);break;case"percentage":g.t="n",g.v=parseFloat(w.value);break;case"currency":g.t="n",g.v=parseFloat(w.value);break;case"date":g.t="d",g.v=Zr(w["date-value"]),r.cellDates||(g.t="n",g.v=Ln(g.v)),g.z="m/d/yy";break;case"time":g.t="n",g.v=yK(w["time-value"])/86400,r.cellDates&&(g.t="d",g.v=ym(g.v)),g.z="HH:MM:SS";break;case"number":g.t="n",g.v=parseFloat(w.);break;default:if(g.t==="string"||g.t==="text"||!g.t)g.t="s",w["string-value"]!=null&&(y=xr(w["string-value"]),k=[]);else throw new Error("Unsupported value type "+g.t)}}else{if(Q=!1,g.t==="s"&&(g.v=y||"",k.length&&(g.R=k),Q=C==0),E.Target&&(g.l=E),O.length>0&&(g.c=O,O=[]),y&&r.cellText!==!1&&(g.w=y),Q&&(g.t="z",delete g.v),(!Q||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=F))for(var H=0;H<R;++H){if(S=parseInt(w["number-columns-repeated"]||"1",10),r.dense)for(m[F+H]||(m[F+H]=[]),m[F+H][I]=H==0?g:Jr(g);--S>0;)m[F+H][I+S]=Jr(g);else for(m[zt({r:F+H,c:I})]=g;--S>0;)m[zt({r:F+H,c:I+S})]=Jr(g);N.e.c<=I&&(N.e.c=I)}S=parseInt(w["number-columns-repeated"]||"1",10),I+=S-1,S=0,g={},y="",k=[]}E={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!0]);break;case"annotation":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s;P.t=y,k.length&&(P.R=k),P.a=q,O.push(P)}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);q="",X=0,y="",C=0,k=[];break;case"creator":v[1]==="/"?q=n.slice(X,v.index):X=v.index+v[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(v[1]==="/"){if((s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&i.push([v[3],!1]);y="",C=0,k=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(v[1]==="/"){if(L[a.name]=l,(s=i.pop())[0]!==v[3])throw"Bad state: "+s}else v[0].charAt(v[0].length-2)!=="/"&&(l="",a=Wt(v[0],!1),i.push([v[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Wt(v[0],!1),l+=vE[v[3]][o.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":o=Wt(v[0],!1),l+=vE[v[3]][o.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(v[0].slice(-2)==="/>")break;if(v[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,v.index);break}else c=v.index+v[0].length;break;case"named-range":o=Wt(v[0],!1),D=Rb(o["cell-range-address"]);var Z={Name:o.name,Ref:D[0]+"!"+D[1]};G&&(Z.Sheet=f.length),T.Names.push(Z);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(v[1]==="/"&&(!w||!w["string-value"])){var ie=qie(n.slice(C,v.index));y=(y.length>0?y+`
`:"")+ie[0]}else Wt(v[0],!1),C=v.index+v[0].length;break;case"s":break;case"database-range":if(v[1]==="/")break;try{D=Rb(Wt(v[0])["target-range-address"]),d[D[0]]["!autofilter"]={ref:D[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(v[1]!=="/"){if(E=Wt(v[0],!1),!E.href)break;E.Target=xr(E.href),delete E.href,E.Target.charAt(0)=="#"&&E.Target.indexOf(".")>-1?(D=Rb(E.Target.slice(1)),E.Target="#"+D[0]+"!"+D[1]):E.Target.match(/^\.\.[\\\/]/)&&(E.Target=E.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(v[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(v)}}var te={Sheets:d,SheetNames:f,Workbook:T};return r.bookSheets&&delete te.Sheets,te}function bE(e,t){t=t||{},ys(e,"META-INF/manifest.xml")&&yX(Fn(e,"META-INF/manifest.xml"),t);var r=es(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=T8(Ur(r),t);return ys(e,"meta.xml")&&(n.Props=m5(Fn(e,"meta.xml"))),n}function wE(e,t){return T8(e,t)}var Kie=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+_f({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return _n+t}})(),yE=(function(){var e=function(s){return Br(s).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(s,o,a){var l=[];l.push('      <table:table table:name="'+Br(o.SheetNames[a])+`" table:style-name="ta1">
`);var c=0,u=0,h=Vi(s["!ref"]||"A1"),d=s["!merges"]||[],f=0,m=Array.isArray(s);if(s["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(s["!cols"][u]?' table:style-name="co'+s["!cols"][u].ods+'"':"")+`></table:table-column>
`);var v="",g=s["!rows"]||[];for(c=0;c<h.s.r;++c)v=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+v+`></table:table-row>
`);for(;c<=h.e.r;++c){for(v=g[c]?' table:style-name="ro'+g[c].ods+'"':"",l.push("        <table:table-row"+v+`>
`),u=0;u<h.s.c;++u)l.push(t);for(;u<=h.e.c;++u){var w=!1,y={},C="";for(f=0;f!=d.length;++f)if(!(d[f].s.c>u)&&!(d[f].s.r>c)&&!(d[f].e.c<u)&&!(d[f].e.r<c)){(d[f].s.c!=u||d[f].s.r!=c)&&(w=!0),y["table:number-columns-spanned"]=d[f].e.c-d[f].s.c+1,y["table:number-rows-spanned"]=d[f].e.r-d[f].s.r+1;break}if(w){l.push(r);continue}var k=zt({r:c,c:u}),F=m?(s[c]||[])[u]:s[k];if(F&&F.f&&(y["table:formula"]=Br(pte(F.f)),F.F&&F.F.slice(0,k.length)==k)){var I=Vi(F.F);y["table:number-matrix-columns-spanned"]=I.e.c-I.s.c+1,y["table:number-matrix-rows-spanned"]=I.e.r-I.s.r+1}if(!F){l.push(t);continue}switch(F.t){case"b":C=F.v?"TRUE":"FALSE",y["office:value-type"]="boolean",y["office:boolean-value"]=F.v?"true":"false";break;case"n":C=F.w||String(F.v||0),y["office:value-type"]="float",y["office:value"]=F.v||0;break;case"s":case"str":C=F.v==null?"":F.v,y["office:value-type"]="string";break;case"d":C=F.w||Zr(F.v).toISOString(),y["office:value-type"]="date",y["office:date-value"]=Zr(F.v).toISOString(),y["table:style-name"]="ce1";break;default:l.push(t);continue}var N=e(C);if(F.l&&F.l.Target){var j=F.l.Target;j=j.charAt(0)=="#"?"#"+gte(j.slice(1)):j,j.charAt(0)!="#"&&!j.match(/^\w+:/)&&(j="../"+j),N=mt("text:a",N,{"xlink:href":j.replace(/&/g,"&amp;")})}l.push("          "+mt("table:table-cell",mt("text:p",N,{}),y)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,o){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var a=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;hl(h),h.ods=a;var d=c["!cols"][u].wpx+"px";s.push('  <style:style style:name="co'+a+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+d+`"/>
`),s.push(`  </style:style>
`),++a}}});var l=0;o.SheetNames.map(function(c){return o.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(o,a){var l=[_n],c=_f({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=_f({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});a.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(g5().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,o),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)l.push(n(o.Sheets[o.SheetNames[h]],o,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),a.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}})();function k8(e,t){if(t.bookType=="fods")return yE(e,t);var r=aC(),n="",i=[],s=[];return n="mimetype",rr(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",rr(r,n,yE(e,t)),i.push([n,"text/xml"]),s.push([n,"ContentFile"]),n="styles.xml",rr(r,n,Kie(e,t)),i.push([n,"text/xml"]),s.push([n,"StylesFile"]),n="meta.xml",rr(r,n,_n+g5()),i.push([n,"text/xml"]),s.push([n,"MetadataFile"]),n="manifest.rdf",rr(r,n,SX(s)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",rr(r,n,CX(i)),r}function Tc(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Hw(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):Ur(Cl(e))}function Xie(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Qi(xo(e))}function Yie(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function pl(e){var t=e.reduce(function(i,s){return i+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function CE(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Zie(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,i=t+13;i>=t;--i)n=n*256+e[i];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Jie(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=r>=0?0:128}function Df(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Pr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function dn(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function Tr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Df(e,r),s=i&7;i=Math.floor(i/8);var o=0,a;if(i==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);a=e.slice(l,r[0])}break;case 5:o=4,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 1:o=8,a=e.slice(r[0],r[0]+o),r[0]+=o;break;case 2:o=Df(e,r),a=e.slice(r[0],r[0]+o),r[0]+=o;break;default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(n))}var c={data:a,type:s};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function Qn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(Pr(n*8+i.type)),i.type==2&&t.push(Pr(i.data.length)),t.push(i.data))})}),pl(t)}function IC(e,t){return e?.map(function(r){return t(r.data)})||[]}function ms(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Df(e,n),s=Tr(e.slice(n[0],n[0]+i));n[0]+=i;var o={id:dn(s[1][0].data),messages:[]};s[2].forEach(function(a){var l=Tr(a.data),c=dn(l[3][0].data);o.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(o.merge=dn(s[3][0].data)>>>0>0),r.push(o)}return r}function bu(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:Pr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:Pr(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(o){i.push(o.data),o.meta[3]=[{type:0,data:Pr(o.data.length)}],n[2].push({data:Qn(o.meta),type:2})});var s=Qn(n);t.push(Pr(s.length)),t.push(s),i.forEach(function(o){return t.push(o)})}),pl(t)}function Qie(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Df(t,r),i=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var o=t[r[0]++]>>2;if(o<60)++o;else{var a=o-59;o=t[r[0]],a>1&&(o|=t[r[0]+1]<<8),a>2&&(o|=t[r[0]+2]<<16),a>3&&(o|=t[r[0]+3]<<24),o>>>=0,o++,r[0]+=a}i.push(t.slice(r[0],r[0]+o)),r[0]+=o;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[pl(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=pl(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function vs(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Qie(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return pl(t)}function wu(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var s=Pr(n),o=s.length;t.push(s),n<=60?(o++,t.push(new Uint8Array([n-1<<2]))):n<=256?(o+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(o+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(o+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(o+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),o+=n,i[0]=0,i[1]=o&255,i[2]=o>>8&255,i[3]=o>>16&255,r+=n}return pl(t)}function ese(e,t,r,n){var i=Tc(e),s=i.getUint32(4,!0),o=(n>1?12:8)+CE(s&(n>1?3470:398))*4,a=-1,l=-1,c=NaN,u=new Date(2001,0,1);s&512&&(a=i.getUint32(o,!0),o+=4),o+=CE(s&(n>1?12288:4096))*4,s&16&&(l=i.getUint32(o,!0),o+=4),s&32&&(c=i.getFloat64(o,!0),o+=8),s&64&&(u.setTime(u.getTime()+i.getFloat64(o,!0)*1e3),o+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:c};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:r[a]};else if(l>-1)h={t:"s",v:t[l]};else if(!isNaN(c))h={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function tse(e,t,r){var n=Tc(e),i=n.getUint32(8,!0),s=12,o=-1,a=-1,l=NaN,c=NaN,u=new Date(2001,0,1);i&1&&(l=Zie(e,s),s+=16),i&2&&(c=n.getFloat64(s,!0),s+=8),i&4&&(u.setTime(u.getTime()+n.getFloat64(s,!0)*1e3),s+=8),i&8&&(a=n.getUint32(s,!0),s+=4),i&16&&(o=n.getUint32(s,!0),s+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[a]};break;case 5:h={t:"d",v:u};break;case 6:h={t:"b",v:c>0};break;case 7:h={t:"n",v:c/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:r[o]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return h}function Fb(e,t){var r=new Uint8Array(32),n=Tc(r),i=12,s=0;switch(r[0]=5,e.t){case"n":r[1]=2,Jie(r,i,e.v),s|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,s,!0),r.slice(0,i)}function Mb(e,t){var r=new Uint8Array(32),n=Tc(r),i=12,s=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,s,!0),r.slice(0,i)}function rse(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return ese(e,t,r,e[0]);case 5:return tse(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function ui(e){var t=Tr(e);return Df(t[1][0].data)}function xE(e,t){var r=Tr(t.data),n=dn(r[1][0].data),i=r[3],s=[];return(i||[]).forEach(function(o){var a=Tr(o.data),l=dn(a[1][0].data)>>>0;switch(n){case 1:s[l]=Hw(a[3][0].data);break;case 8:{var c=e[ui(a[9][0].data)][0],u=Tr(c.data),h=e[ui(u[1][0].data)][0],d=dn(h.meta[1][0].data);if(d!=2001)throw new Error("2000 unexpected reference to ".concat(d));var f=Tr(h.data);s[l]=f[3].map(function(m){return Hw(m.data)}).join("")}break}}),s}function nse(e,t){var r,n,i,s,o,a,l,c,u,h,d,f,m,v,g=Tr(e),w=dn(g[1][0].data)>>>0,y=dn(g[2][0].data)>>>0,C=((n=(r=g[8])==null?void 0:r[0])==null?void 0:n.data)&&dn(g[8][0].data)>0||!1,k,F;if((s=(i=g[7])==null?void 0:i[0])!=null&&s.data&&t!=0)k=(a=(o=g[7])==null?void 0:o[0])==null?void 0:a.data,F=(c=(l=g[6])==null?void 0:l[0])==null?void 0:c.data;else if((h=(u=g[4])==null?void 0:u[0])!=null&&h.data&&t!=1)k=(f=(d=g[4])==null?void 0:d[0])==null?void 0:f.data,F=(v=(m=g[3])==null?void 0:m[0])==null?void 0:v.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var I=C?4:1,N=Tc(k),j=[],L=0;L<k.length/2;++L){var W=N.getUint16(L*2,!0);W<65535&&j.push([L,W])}if(j.length!=y)throw"Expected ".concat(y," cells, found ").concat(j.length);var K=[];for(L=0;L<j.length-1;++L)K[j[L][0]]=F.subarray(j[L][1]*I,j[L+1][1]*I);return j.length>=1&&(K[j[j.length-1][0]]=F.subarray(j[j.length-1][1]*I)),{R:w,cells:K}}function ise(e,t){var r,n=Tr(t.data),i=(r=n?.[7])!=null&&r[0]?dn(n[7][0].data)>>>0>0?1:0:-1,s=IC(n[5],function(o){return nse(o,i)});return{nrows:dn(n[4][0].data)>>>0,data:s.reduce(function(o,a){return o[a.R]||(o[a.R]=[]),a.cells.forEach(function(l,c){if(o[a.R][c])throw new Error("Duplicate cell r=".concat(a.R," c=").concat(c));o[a.R][c]=l}),o},[])}}function sse(e,t,r){var n,i=Tr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(dn(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(dn(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));r["!ref"]=er(s);var o=Tr(i[4][0].data),a=xE(e,e[ui(o[4][0].data)][0]),l=(n=o[17])!=null&&n[0]?xE(e,e[ui(o[17][0].data)][0]):[],c=Tr(o[3][0].data),u=0;c[1].forEach(function(h){var d=Tr(h.data),f=e[ui(d[2][0].data)][0],m=dn(f.meta[1][0].data);if(m!=6002)throw new Error("6001 unexpected reference to ".concat(m));var v=ise(e,f);v.data.forEach(function(g,w){g.forEach(function(y,C){var k=zt({r:u+w,c:C}),F=rse(y,a,l);F&&(r[k]=F)})}),u+=v.nrows})}function ose(e,t){var r=Tr(t.data),n={"!ref":"A1"},i=e[ui(r[2][0].data)],s=dn(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return sse(e,i[0],n),n}function ase(e,t){var r,n=Tr(t.data),i={name:(r=n[1])!=null&&r[0]?Hw(n[1][0].data):"",sheets:[]},s=IC(n[2],ui);return s.forEach(function(o){e[o].forEach(function(a){var l=dn(a.meta[1][0].data);l==6e3&&i.sheets.push(ose(e,a))})}),i}function lse(e,t){var r=jC(),n=Tr(t.data),i=IC(n[1],ui);if(i.forEach(function(s){e[s].forEach(function(o){var a=dn(o.meta[1][0].data);if(a==2){var l=ase(e,o);l.sheets.forEach(function(c,u){VC(r,c,u==0?l.name:l.name+"_"+u,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function Db(e){var t,r,n,i,s={},o=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=vs(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var u;try{u=ms(c)}catch(h){return console.log("## "+(h.message||h))}u.forEach(function(h){s[h.id]=h.messages,o.push(h.id)})}}),!o.length)throw new Error("File has no messages");var a=((i=(n=(r=(t=s?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:i[0].data)&&dn(s[1][0].meta[1][0].data)==1&&s[1][0];if(a||o.forEach(function(l){s[l].forEach(function(c){var u=dn(c.meta[1][0].data)>>>0;if(u==1)if(!a)a=c;else throw new Error("Document has multiple roots")})}),!a)throw new Error("Cannot find Document root");return lse(s,a)}function cse(e,t,r){var n,i,s,o;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var a=((o=(s=e[8])==null?void 0:s[0])==null?void 0:o.data)&&dn(e[8][0].data)>0||!1;if(a)throw"Math only works with normal offsets";for(var l=0,c=Tc(e[7][0].data),u=0,h=[],d=Tc(e[4][0].data),f=0,m=[],v=0;v<t.length;++v){if(t[v]==null){c.setUint16(v*2,65535,!0),d.setUint16(v*2,65535);continue}c.setUint16(v*2,u,!0),d.setUint16(v*2,f,!0);var g,w;switch(typeof t[v]){case"string":g=Fb({t:"s",v:t[v]},r),w=Mb({t:"s",v:t[v]},r);break;case"number":g=Fb({t:"n",v:t[v]},r),w=Mb({t:"n",v:t[v]},r);break;case"boolean":g=Fb({t:"b",v:t[v]},r),w=Mb({t:"b",v:t[v]},r);break;default:throw new Error("Unsupported value "+t[v])}h.push(g),u+=g.length,m.push(w),f+=w.length,++l}for(e[2][0].data=Pr(l);v<e[7][0].data.length/2;++v)c.setUint16(v*2,65535,!0),d.setUint16(v*2,65535,!0);return e[6][0].data=pl(h),e[3][0].data=pl(m),l}function use(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Vi(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(er(n)));var s=X0(r,{range:n,header:1}),o=["~Sh33tJ5~"];s.forEach(function(q){return q.forEach(function(X){typeof X=="string"&&o.push(X)})});var a={},l=[],c=Mt.read(t.numbers,{type:"base64"});c.FileIndex.map(function(q,X){return[q,c.FullPaths[X]]}).forEach(function(q){var X=q[0],Q=q[1];if(X.type==2&&X.name.match(/\.iwa/)){var G=X.content,ee=vs(G),V=ms(ee);V.forEach(function(H){l.push(H.id),a[H.id]={deps:[],location:Q,type:dn(H.messages[0].meta[1][0].data)}})}}),l.sort(function(q,X){return q-X});var u=l.filter(function(q){return q>1}).map(function(q){return[q,Pr(q)]});c.FileIndex.map(function(q,X){return[q,c.FullPaths[X]]}).forEach(function(q){var X=q[0];if(q[1],!!X.name.match(/\.iwa/)){var Q=ms(vs(X.content));Q.forEach(function(G){G.messages.forEach(function(ee){u.forEach(function(V){G.messages.some(function(H){return dn(H.meta[1][0].data)!=11006&&Yie(H.data,V[1])})&&a[V[0]].deps.push(G.id)})})})}});for(var h=Mt.find(c,a[1].location),d=ms(vs(h.content)),f,m=0;m<d.length;++m){var v=d[m];v.id==1&&(f=v)}var g=ui(Tr(f.messages[0].data)[1][0].data);for(h=Mt.find(c,a[g].location),d=ms(vs(h.content)),m=0;m<d.length;++m)v=d[m],v.id==g&&(f=v);for(g=ui(Tr(f.messages[0].data)[2][0].data),h=Mt.find(c,a[g].location),d=ms(vs(h.content)),m=0;m<d.length;++m)v=d[m],v.id==g&&(f=v);for(g=ui(Tr(f.messages[0].data)[2][0].data),h=Mt.find(c,a[g].location),d=ms(vs(h.content)),m=0;m<d.length;++m)v=d[m],v.id==g&&(f=v);var w=Tr(f.messages[0].data);{w[6][0].data=Pr(n.e.r+1),w[7][0].data=Pr(n.e.c+1);var y=ui(w[46][0].data),C=Mt.find(c,a[y].location),k=ms(vs(C.content));{for(var F=0;F<k.length&&k[F].id!=y;++F);if(k[F].id!=y)throw"Bad ColumnRowUIDMapArchive";var I=Tr(k[F].messages[0].data);I[1]=[],I[2]=[],I[3]=[];for(var N=0;N<=n.e.c;++N){var j=[];j[1]=j[2]=[{type:0,data:Pr(N+420690)}],I[1].push({type:2,data:Qn(j)}),I[2].push({type:0,data:Pr(N)}),I[3].push({type:0,data:Pr(N)})}I[4]=[],I[5]=[],I[6]=[];for(var L=0;L<=n.e.r;++L)j=[],j[1]=j[2]=[{type:0,data:Pr(L+726270)}],I[4].push({type:2,data:Qn(j)}),I[5].push({type:0,data:Pr(L)}),I[6].push({type:0,data:Pr(L)});k[F].messages[0].data=Qn(I)}C.content=wu(bu(k)),C.size=C.content.length,delete w[46];var W=Tr(w[4][0].data);{W[7][0].data=Pr(n.e.r+1);var K=Tr(W[1][0].data),z=ui(K[2][0].data);C=Mt.find(c,a[z].location),k=ms(vs(C.content));{if(k[0].id!=z)throw"Bad HeaderStorageBucket";var M=Tr(k[0].messages[0].data);for(L=0;L<s.length;++L){var B=Tr(M[2][0].data);B[1][0].data=Pr(L),B[4][0].data=Pr(s[L].length),M[2][L]={type:M[2][0].type,data:Qn(B)}}k[0].messages[0].data=Qn(M)}C.content=wu(bu(k)),C.size=C.content.length;var R=ui(W[2][0].data);C=Mt.find(c,a[R].location),k=ms(vs(C.content));{if(k[0].id!=R)throw"Bad HeaderStorageBucket";for(M=Tr(k[0].messages[0].data),N=0;N<=n.e.c;++N)B=Tr(M[2][0].data),B[1][0].data=Pr(N),B[4][0].data=Pr(n.e.r+1),M[2][N]={type:M[2][0].type,data:Qn(B)};k[0].messages[0].data=Qn(M)}C.content=wu(bu(k)),C.size=C.content.length;var S=ui(W[4][0].data);(function(){for(var q=Mt.find(c,a[S].location),X=ms(vs(q.content)),Q,G=0;G<X.length;++G){var ee=X[G];ee.id==S&&(Q=ee)}var V=Tr(Q.messages[0].data);{V[3]=[];var H=[];o.forEach(function(te,oe){H[1]=[{type:0,data:Pr(oe)}],H[2]=[{type:0,data:Pr(1)}],H[3]=[{type:2,data:Xie(te)}],V[3].push({type:2,data:Qn(H)})})}Q.messages[0].data=Qn(V);var Z=bu(X),ie=wu(Z);q.content=ie,q.size=q.content.length})();var _=Tr(W[3][0].data);{var T=_[1][0];delete _[2];var E=Tr(T.data);{var D=ui(E[2][0].data);(function(){for(var q=Mt.find(c,a[D].location),X=ms(vs(q.content)),Q,G=0;G<X.length;++G){var ee=X[G];ee.id==D&&(Q=ee)}var V=Tr(Q.messages[0].data);{delete V[6],delete _[7];var H=new Uint8Array(V[5][0].data);V[5]=[];for(var Z=0,ie=0;ie<=n.e.r;++ie){var te=Tr(H);Z+=cse(te,s[ie],o),te[1][0].data=Pr(ie),V[5].push({data:Qn(te),type:2})}V[1]=[{type:0,data:Pr(n.e.c+1)}],V[2]=[{type:0,data:Pr(n.e.r+1)}],V[3]=[{type:0,data:Pr(Z)}],V[4]=[{type:0,data:Pr(n.e.r+1)}]}Q.messages[0].data=Qn(V);var oe=bu(X),ue=wu(oe);q.content=ue,q.size=q.content.length})()}T.data=Qn(E)}W[3][0].data=Qn(_)}w[4][0].data=Qn(W)}f.messages[0].data=Qn(w);var O=bu(d),P=wu(O);return h.content=P,h.size=h.content.length,c}function R8(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function OC(e){R8([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function NC(e){R8([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function dse(e){return lr.WS.indexOf(e)>-1?"sheet":e==lr.CS?"chart":e==lr.DS?"dialog":e==lr.MS?"macro":e&&e.length?e:"sheet"}function hse(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,dse(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function fse(e,t,r,n,i,s,o,a,l,c,u,h){try{s[n]=Zh(es(e,r,!0),t);var d=Fn(e,t),f;switch(a){case"sheet":f=One(d,t,i,l,s[n],c,u,h);break;case"chart":if(f=Nne(d,t,i,l,s[n],c,u,h),!f||!f["!drawel"])break;var m=Ih(f["!drawel"].Target,t),v=Tf(m),g=xQ(es(e,m,!0),Zh(es(e,v,!0),m)),w=Ih(g,m),y=Tf(w);f=cne(es(e,w,!0),w,l,Zh(es(e,y,!0),w),c,f);break;case"macro":f=Lne(d,t,i,l,s[n],c,u,h);break;case"dialog":f=Bne(d,t,i,l,s[n],c,u,h);break;default:throw new Error("Unrecognized sheet type "+a)}o[n]=f;var C=[];s&&s[n]&&hn(s[n]).forEach(function(k){var F="";if(s[n][k].Type==lr.CMNT){F=Ih(s[n][k].Target,t);var I=Gne(Fn(e,F,!0),F,l);if(!I||!I.length)return;aE(f,I,!1)}s[n][k].Type==lr.TCMNT&&(F=Ih(s[n][k].Target,t),C=C.concat(_Q(Fn(e,F,!0),l)))}),C&&C.length&&aE(f,C,!0,l.people||[])}catch(k){if(l.WTF)throw k}}function ps(e){return e.charAt(0)=="/"?e.slice(1):e}function pse(e,t){if(Td(),t=t||{},OC(t),ys(e,"META-INF/manifest.xml")||ys(e,"objectdata.xml"))return bE(e,t);if(ys(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof Db<"u"){if(e.FileIndex)return Db(e);var r=Mt.utils.cfb_new();return R3(e).forEach(function(B){rr(r,B,EK(e,B))}),Db(r)}throw new Error("Unsupported NUMBERS file")}if(!ys(e,"[Content_Types].xml"))throw ys(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ys(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=R3(e),i=bX(es(e,"[Content_Types].xml")),s=!1,o,a;if(i.workbooks.length===0&&(a="xl/workbook.xml",Fn(e,a,!0)&&i.workbooks.push(a)),i.workbooks.length===0){if(a="xl/workbook.bin",!Fn(e,a,!0))throw new Error("Could not find workbook");i.workbooks.push(a),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(Jh=[],i.sst)try{Jh=Vne(Fn(e,ps(i.sst)),i.sst,t)}catch(B){if(t.WTF)throw B}t.cellStyles&&i.themes.length&&(l=jne(es(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(c=Hne(Fn(e,ps(i.style)),i.style,l,t))}i.links.map(function(B){try{var R=Zh(es(e,Tf(ps(B))),B);return Une(Fn(e,ps(B)),R,B,t)}catch{}});var u=Ine(Fn(e,ps(i.workbooks[0])),i.workbooks[0],t),h={},d="";i.coreprops.length&&(d=Fn(e,ps(i.coreprops[0]),!0),d&&(h=m5(d)),i.extprops.length!==0&&(d=Fn(e,ps(i.extprops[0]),!0),d&&EX(d,h,t)));var f={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(d=es(e,ps(i.custprops[0]),!0),d&&(f=kX(d,t)));var m={};if((t.bookSheets||t.bookProps)&&(u.Sheets?o=u.Sheets.map(function(R){return R.name}):h.Worksheets&&h.SheetNames.length>0&&(o=h.SheetNames),t.bookProps&&(m.Props=h,m.Custprops=f),t.bookSheets&&typeof o<"u"&&(m.SheetNames=o),t.bookSheets?m.SheetNames:t.bookProps))return m;o={};var v={};t.bookDeps&&i.calcchain&&(v=zne(Fn(e,ps(i.calcchain)),i.calcchain));var g=0,w={},y,C;{var k=u.Sheets;h.Worksheets=k.length,h.SheetNames=[];for(var F=0;F!=k.length;++F)h.SheetNames[F]=k[F].name}var I=s?"bin":"xml",N=i.workbooks[0].lastIndexOf("/"),j=(i.workbooks[0].slice(0,N+1)+"_rels/"+i.workbooks[0].slice(N+1)+".rels").replace(/^\//,"");ys(e,j)||(j="xl/_rels/workbook."+I+".rels");var L=Zh(es(e,j,!0),j.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=Wne(Fn(e,ps(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=TQ(Fn(e,ps(i.people[0])),t)),L&&(L=hse(L,u.Sheets));var W=Fn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(g=0;g!=h.Worksheets;++g){var K="sheet";if(L&&L[g]?(y="xl/"+L[g][1].replace(/[\/]?xl\//,""),ys(e,y)||(y=L[g][1]),ys(e,y)||(y=j.replace(/_rels\/.*$/,"")+L[g][1]),K=L[g][2]):(y="xl/worksheets/sheet"+(g+1-W)+"."+I,y=y.replace(/sheet0\./,"sheet.")),C=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(g!=t.sheets)continue e;break;case"string":if(h.SheetNames[g].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var z=!1,M=0;M!=t.sheets.length;++M)typeof t.sheets[M]=="number"&&t.sheets[M]==g&&(z=1),typeof t.sheets[M]=="string"&&t.sheets[M].toLowerCase()==h.SheetNames[g].toLowerCase()&&(z=1);if(!z)continue e}}fse(e,y,C,h.SheetNames[g],g,w,o,K,t,u,l,c)}return m={Directory:i,Workbook:u,Props:h,Custprops:f,Deps:v,Sheets:o,SheetNames:h.SheetNames,Strings:Jh,Styles:c,Themes:l,SSF:Jr(Gt)},t&&t.bookFiles&&(e.files?(m.keys=n,m.files=e.files):(m.keys=[],m.files={},e.FullPaths.forEach(function(B,R){B=B.replace(/^Root Entry[\/]/,""),m.keys.push(B),m.files[B]=e.FileIndex[R]}))),t&&t.bookVBA&&(i.vba.length>0?m.vbaraw=Fn(e,ps(i.vba[0]),!0):i.defaults&&i.defaults.bin===IQ&&(m.vbaraw=Fn(e,"xl/vbaProject.bin",!0))),m}function gse(e,t){var r=t||{},n="Workbook",i=Mt.find(e,n);try{if(n="/!DataSpaces/Version",i=Mt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(WZ(i.content),n="/!DataSpaces/DataSpaceMap",i=Mt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=qZ(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Mt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=KZ(i.content);if(o.length!=1||o[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Mt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);YZ(i.content)}catch{}if(n="/EncryptionInfo",i=Mt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var a=ZZ(i.content);if(n="/EncryptedPackage",i=Mt.find(e,n),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(a[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(a[1],i.content,r.password||"",r);if(a[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(a[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function mse(e,t){return t.bookType=="ods"?k8(e,t):t.bookType=="numbers"?use(e,t):t.bookType=="xlsb"?vse(e,t):bse(e,t)}function vse(e,t){Hu=1024,e&&!e.SSF&&(e.SSF=Jr(Gt)),e&&e.SSF&&(Td(),vm(e.SSF),t.revssf=wm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Qh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=t8.indexOf(t.bookType)>-1,i=CC();NC(t=t||{});var s=aC(),o="",a=0;if(t.cellXfs=[],Sl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",rr(s,o,v5(e.Props,t)),i.coreprops.push(o),Or(t.rels,2,o,lr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,rr(s,o,y5(e.Props)),i.extprops.push(o),Or(t.rels,3,o,lr.EXT_PROPS),e.Custprops!==e.Props&&hn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",rr(s,o,C5(e.Custprops)),i.custprops.push(o),Or(t.rels,4,o,lr.CUST_PROPS)),a=1;a<=e.SheetNames.length;++a){var u={"!id":{}},h=e.Sheets[e.SheetNames[a-1]],d=(h||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+a+"."+r,rr(s,o,qne(a-1,o,t,e,u)),i.sheets.push(o),Or(t.wbrels,-1,"worksheets/sheet"+a+"."+r,lr.WS[0]),h){var f=h["!comments"],m=!1,v="";f&&f.length>0&&(v="xl/comments"+a+"."+r,rr(s,v,Yne(f,v)),i.comments.push(v),Or(u,-1,"../comments"+a+"."+r,lr.CMNT),m=!0),h["!legacy"]&&m&&rr(s,"xl/drawings/vmlDrawing"+a+".vml",Q5(a,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&rr(s,Tf(o),rd(u))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,rr(s,o,Xne(t.Strings,o,t)),i.strs.push(o),Or(t.wbrels,-1,"sharedStrings."+r,lr.SST)),o="xl/workbook."+r,rr(s,o,$ne(e,o)),i.workbooks.push(o),Or(t.rels,1,o,lr.WB),o="xl/theme/theme1.xml",rr(s,o,kC(e.Themes,t)),i.themes.push(o),Or(t.wbrels,-1,"theme/theme1.xml",lr.THEME),o="xl/styles."+r,rr(s,o,Kne(e,o,t)),i.styles.push(o),Or(t.wbrels,-1,"styles."+r,lr.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",rr(s,o,e.vbaraw),i.vba.push(o),Or(t.wbrels,-1,"vbaProject.bin",lr.VBA)),o="xl/metadata."+r,rr(s,o,Zne(o)),i.metadata.push(o),Or(t.wbrels,-1,"metadata."+r,lr.XLMETA),rr(s,"[Content_Types].xml",p5(i,t)),rr(s,"_rels/.rels",rd(t.rels)),rr(s,"xl/_rels/workbook."+r+".rels",rd(t.wbrels)),delete t.revssf,delete t.ssf,s}function bse(e,t){Hu=1024,e&&!e.SSF&&(e.SSF=Jr(Gt)),e&&e.SSF&&(Td(),vm(e.SSF),t.revssf=wm(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Qh?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=t8.indexOf(t.bookType)>-1,i=CC();NC(t=t||{});var s=aC(),o="",a=0;if(t.cellXfs=[],Sl(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),o="docProps/core.xml",rr(s,o,v5(e.Props,t)),i.coreprops.push(o),Or(t.rels,2,o,lr.CORE_PROPS),o="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,rr(s,o,y5(e.Props)),i.extprops.push(o),Or(t.rels,3,o,lr.EXT_PROPS),e.Custprops!==e.Props&&hn(e.Custprops||{}).length>0&&(o="docProps/custom.xml",rr(s,o,C5(e.Custprops)),i.custprops.push(o),Or(t.rels,4,o,lr.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,a=1;a<=e.SheetNames.length;++a){var h={"!id":{}},d=e.Sheets[e.SheetNames[a-1]],f=(d||{})["!type"]||"sheet";if(o="xl/worksheets/sheet"+a+"."+r,rr(s,o,h8(a-1,t,e,h)),i.sheets.push(o),Or(t.wbrels,-1,"worksheets/sheet"+a+"."+r,lr.WS[0]),d){var m=d["!comments"],v=!1,g="";if(m&&m.length>0){var w=!1;m.forEach(function(y){y[1].forEach(function(C){C.T==!0&&(w=!0)})}),w&&(g="xl/threadedComments/threadedComment"+a+"."+r,rr(s,g,EQ(m,u,t)),i.threadedcomments.push(g),Or(h,-1,"../threadedComments/threadedComment"+a+"."+r,lr.TCMNT)),g="xl/comments"+a+"."+r,rr(s,g,e8(m)),i.comments.push(g),Or(h,-1,"../comments"+a+"."+r,lr.CMNT),v=!0}d["!legacy"]&&v&&rr(s,"xl/drawings/vmlDrawing"+a+".vml",Q5(a,d["!comments"])),delete d["!comments"],delete d["!legacy"]}h["!id"].rId1&&rr(s,Tf(o),rd(h))}return t.Strings!=null&&t.Strings.length>0&&(o="xl/sharedStrings."+r,rr(s,o,V5(t.Strings,t)),i.strs.push(o),Or(t.wbrels,-1,"sharedStrings."+r,lr.SST)),o="xl/workbook."+r,rr(s,o,v8(e)),i.workbooks.push(o),Or(t.rels,1,o,lr.WB),o="xl/theme/theme1.xml",rr(s,o,kC(e.Themes,t)),i.themes.push(o),Or(t.wbrels,-1,"theme/theme1.xml",lr.THEME),o="xl/styles."+r,rr(s,o,X5(e,t)),i.styles.push(o),Or(t.wbrels,-1,"styles."+r,lr.STY),e.vbaraw&&n&&(o="xl/vbaProject.bin",rr(s,o,e.vbaraw),i.vba.push(o),Or(t.wbrels,-1,"vbaProject.bin",lr.VBA)),o="xl/metadata."+r,rr(s,o,J5()),i.metadata.push(o),Or(t.wbrels,-1,"metadata."+r,lr.XLMETA),u.length>1&&(o="xl/persons/person.xml",rr(s,o,kQ(u)),i.people.push(o),Or(t.wbrels,-1,"persons/person.xml",lr.PEOPLE)),rr(s,"[Content_Types].xml",p5(i,t)),rr(s,"_rels/.rels",rd(t.rels)),rr(s,"xl/_rels/workbook."+r+".rels",rd(t.wbrels)),delete t.revssf,delete t.ssf,s}function LC(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=is(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function wse(e,t){return Mt.find(e,"EncryptedPackage")?gse(e,t):C8(e,t)}function yse(e,t){var r,n=e,i=t||{};return i.type||(i.type=ar&&Buffer.isBuffer(e)?"buffer":"base64"),r=z6(n,i),pse(r,i)}function A8(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return Lw(e.slice(r),t);default:break e}return gd.to_workbook(e,t)}function Cse(e,t){var r="",n=LC(e,t);switch(t.type){case"base64":r=is(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=xc(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=Ur(r)),t.type="binary",A8(r,t)}function xse(e,t){var r=e;return t.type=="base64"&&(r=is(r)),r=yf.utils.decode(1200,r.slice(2),"str"),t.type="binary",A8(r,t)}function Sse(e){return e.match(/[^\x00-\x7F]/)?xo(e):e}function Pb(e,t,r,n){return n?(r.type="string",gd.to_workbook(e,r)):gd.to_workbook(t,r)}function K0(e,t){rC();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return K0(new Uint8Array(e),(r=Jr(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,i=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),id={},r.dateNF&&(id.dateNF=r.dateNF),r.type||(r.type=ar&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=ar?"buffer":"binary",n=vK(e),typeof Uint8Array<"u"&&!ar&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Sse(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var o=new ArrayBuffer(3),a=new Uint8Array(o);if(a.foo="bar",!a.foo)return r=Jr(r),r.type="array",K0(nC(n),r)}switch((i=LC(n,r))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return wse(Mt.read(n,r),r);break;case 9:if(i[1]<=8)return C8(n,r);break;case 60:return Lw(n,r);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return RZ(n,r);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return H5.to_workbook(n,r);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?yse(n,r):Pb(e,n,r,s);case 239:return i[3]===60?Lw(n,r):Pb(e,n,r,s);case 255:if(i[1]===254)return xse(n,r);if(i[1]===0&&i[2]===2&&i[3]===0)return hc.to_workbook(n,r);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return hc.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Nw.to_workbook(n,r);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return $5.to_workbook(n,r);break;case 10:case 13:case 32:return Cse(n,r);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return kZ.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?Nw.to_workbook(n,r):Pb(e,n,r,s)}function F8(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Xf(t.file,Mt.write(e,{type:ar?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Mt.write(e,t)}function _se(e,t){var r=Jr(t||{}),n=mse(e,r);return Ese(n,r)}function Ese(e,t){var r={},n=ar?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Mt.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(mm(i))}return t.password&&typeof encrypt_agile<"u"?F8(encrypt_agile(i,t.password),t):t.type==="file"?Xf(t.file,i):t.type=="string"?Ur(i):i}function Tse(e,t){var r=t||{},n=Sie(e,r);return F8(n,r)}function uo(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Cf(xo(n));case"binary":return xo(n);case"string":return e;case"file":return Xf(t.file,n,"utf8");case"buffer":return ar?pa(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):uo(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function kse(e,t){switch(t.type){case"base64":return Cf(e);case"binary":return e;case"string":return e;case"file":return Xf(t.file,e,"binary");case"buffer":return ar?pa(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function Og(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Cf(r):t.type=="string"?Ur(r):r;case"file":return Xf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function M8(e,t){rC(),wne(e);var r=Jr(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=M8(e,r);return r.type="array",mm(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return uo(mie(e,r),r);case"slk":case"sylk":return uo(B5.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return uo(S8(e.Sheets[e.SheetNames[i]],r),r);case"txt":return kse(D8(e.Sheets[e.SheetNames[i]],r),r);case"csv":return uo(HC(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return uo(H5.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return Og(Nw.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return uo(gd.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return uo($5.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return uo(j5.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return uo(k8(e,r),r);case"wk1":return Og(hc.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return Og(hc.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),Og(x8(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),Tse(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return _se(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function Rse(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function BC(e,t,r){var n={};return n.type="file",n.file=t,Rse(n),M8(e,n)}function Ase(e,t,r,n,i,s,o,a){var l=Sn(r),c=a.defval,u=a.raw||!Object.prototype.hasOwnProperty.call(a,"raw"),h=!0,d=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(d,"__rowNum__",{value:r,enumerable:!1})}catch{d.__rowNum__=r}else d.__rowNum__=r;if(!o||e[r])for(var f=t.s.c;f<=t.e.c;++f){var m=o?e[r][f]:e[n[f]+l];if(m===void 0||m.t===void 0){if(c===void 0)continue;s[f]!=null&&(d[s[f]]=c);continue}var v=m.v;switch(m.t){case"z":if(v==null)break;continue;case"e":v=v==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+m.t)}if(s[f]!=null){if(v==null)if(m.t=="e"&&v===null)d[s[f]]=null;else if(c!==void 0)d[s[f]]=c;else if(u&&v===null)d[s[f]]=null;else continue;else d[s[f]]=u&&(m.t!=="n"||m.t==="n"&&a.rawNumbers!==!1)?v:ua(m,v,a);v!=null&&(h=!1)}}return{row:d,isempty:h}}function X0(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,s=[],o=0,a="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=Sr(u);break;case"number":l=Sr(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var h=Sn(l.s.r),d=[],f=[],m=0,v=0,g=Array.isArray(e),w=l.s.r,y=0,C={};g&&!e[w]&&(e[w]=[]);var k=c.skipHidden&&e["!cols"]||[],F=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(k[y]||{}).hidden)switch(d[y]=sn(y),r=g?e[w][y]:e[d[y]+h],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=d[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),a=o=ua(r,null,c),v=C[o]||0,!v)C[o]=1;else{do a=o+"_"+v++;while(C[a]);C[o]=v,C[a]=1}s[y]=a}for(w=l.s.r+i;w<=l.e.r;++w)if(!(F[w]||{}).hidden){var I=Ase(e,l,w,d,n,s,g,c);(I.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(f[m++]=I.row)}return f.length=m,f}var SE=/"/g;function Fse(e,t,r,n,i,s,o,a){for(var l=!0,c=[],u="",h=Sn(r),d=t.s.c;d<=t.e.c;++d)if(n[d]){var f=a.dense?(e[r]||[])[d]:e[n[d]+h];if(f==null)u="";else if(f.v!=null){l=!1,u=""+(a.rawNumbers&&f.t=="n"?f.v:ua(f,null,a));for(var m=0,v=0;m!==u.length;++m)if((v=u.charCodeAt(m))===i||v===s||v===34||a.forceQuotes){u='"'+u.replace(SE,'""')+'"';break}u=="ID"&&(u='"ID"')}else f.f!=null&&!f.F?(l=!1,u="="+f.f,u.indexOf(",")>=0&&(u='"'+u.replace(SE,'""')+'"')):u="";c.push(u)}return a.blankrows===!1&&l?null:c.join(o)}function HC(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=Sr(e["!ref"]),s=n.FS!==void 0?n.FS:",",o=s.charCodeAt(0),a=n.RS!==void 0?n.RS:`
`,l=a.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var d=n.skipHidden&&e["!cols"]||[],f=n.skipHidden&&e["!rows"]||[],m=i.s.c;m<=i.e.c;++m)(d[m]||{}).hidden||(h[m]=sn(m));for(var v=0,g=i.s.r;g<=i.e.r;++g)(f[g]||{}).hidden||(u=Fse(e,i,g,h,o,l,s,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((v++?a:"")+u)));return delete n.dense,r.join("")}function D8(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=HC(e,t);return r}function Mse(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=Sr(e["!ref"]),s="",o=[],a,l=[],c=Array.isArray(e);for(a=i.s.c;a<=i.e.c;++a)o[a]=sn(a);for(var u=i.s.r;u<=i.e.r;++u)for(s=Sn(u),a=i.s.c;a<=i.e.c;++a)if(t=o[a]+s,r=c?(e[u]||[])[a]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function P8(e,t,r){var n=r||{},i=+!n.skipHeader,s=e||{},o=0,a=0;if(s&&n.origin!=null)if(typeof n.origin=="number")o=n.origin;else{var l=typeof n.origin=="string"?on(n.origin):n.origin;o=l.r,a=l.c}var c,u={s:{c:0,r:0},e:{c:a,r:o+t.length-1+i}};if(s["!ref"]){var h=Sr(s["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),o==-1&&(o=h.e.r+1,u.e.r=o+t.length-1+i)}else o==-1&&(o=0,u.e.r=t.length-1+i);var d=n.header||[],f=0;t.forEach(function(v,g){hn(v).forEach(function(w){(f=d.indexOf(w))==-1&&(d[f=d.length]=w);var y=v[w],C="z",k="",F=zt({c:a+f,r:o+g+i});c=Pf(s,F),y&&typeof y=="object"&&!(y instanceof Date)?s[F]=y:(typeof y=="number"?C="n":typeof y=="boolean"?C="b":typeof y=="string"?C="s":y instanceof Date?(C="d",n.cellDates||(C="n",y=Ln(y)),k=n.dateNF||Gt[14]):y===null&&n.nullError&&(C="e",y=0),c?(c.t=C,c.v=y,delete c.w,delete c.R,k&&(c.z=k)):s[F]=c={t:C,v:y},k&&(c.z=k))})}),u.e.c=Math.max(u.e.c,a+d.length-1);var m=Sn(o);if(i)for(f=0;f<d.length;++f)s[sn(f+a)+m]={t:"s",v:d[f]};return s["!ref"]=er(u),s}function Dse(e,t){return P8(null,e,t)}function Pf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=on(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Pf(e,zt(t)):Pf(e,zt({r:t,c:r||0}))}function Pse(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function jC(){return{SheetNames:[],Sheets:{}}}function VC(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var o=s&&s[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=o+i)!=-1;++i);}if(m8(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function Ise(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=Pse(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function Ose(e,t){return e.z=t,e}function I8(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function Nse(e,t,r){return I8(e,"#"+t,r)}function Lse(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function Bse(e,t,r,n){for(var i=typeof t!="string"?t:Sr(t),s=typeof t=="string"?t:er(t),o=i.s.r;o<=i.e.r;++o)for(var a=i.s.c;a<=i.e.c;++a){var l=Pf(e,o,a);l.t="n",l.F=s,delete l.v,o==i.s.r&&a==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var _s={encode_col:sn,encode_row:Sn,encode_cell:zt,encode_range:er,decode_col:gC,decode_row:pC,split_cell:XK,decode_cell:on,decode_range:Vi,format_cell:ua,sheet_add_aoa:a5,sheet_add_json:P8,sheet_add_dom:_8,aoa_to_sheet:kd,json_to_sheet:Dse,table_to_sheet:E8,table_to_book:Wie,sheet_to_csv:HC,sheet_to_txt:D8,sheet_to_json:X0,sheet_to_html:S8,sheet_to_formulae:Mse,sheet_to_row_object_array:X0,sheet_get_cell:Pf,book_new:jC,book_append_sheet:VC,book_set_sheet_visibility:Ise,cell_set_number_format:Ose,cell_set_hyperlink:I8,cell_set_internal_link:Nse,cell_add_comment:Lse,sheet_set_array_formula:Bse,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const _E=e=>{let t;const r=new Set,n=(c,u)=>{const h=typeof c=="function"?c(t):c;if(!Object.is(h,t)){const d=t;t=u??(typeof h!="object"||h===null)?h:Object.assign({},t,h),r.forEach(f=>f(t,d))}},i=()=>t,a={setState:n,getState:i,getInitialState:()=>l,subscribe:c=>(r.add(c),()=>r.delete(c))},l=t=e(n,i,a);return a},Hse=(e=>e?_E(e):_E),jse=e=>e;function Vse(e,t=jse){const r=st.useSyncExternalStore(e.subscribe,st.useCallback(()=>t(e.getState()),[e,t]),st.useCallback(()=>t(e.getInitialState()),[e,t]));return st.useDebugValue(r),r}const EE=e=>{const t=Hse(e),r=n=>Vse(t,n);return Object.assign(r,t),r},Em=(e=>e?EE(e):EE);function Tm(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Gse(e,t,r,n){function i(s){return s instanceof r?s:new r(function(o){o(s)})}return new(r||(r=Promise))(function(s,o){function a(u){try{c(n.next(u))}catch(h){o(h)}}function l(u){try{c(n.throw(u))}catch(h){o(h)}}function c(u){u.done?s(u.value):i(u.value).then(a,l)}c((n=n.apply(e,t||[])).next())})}const zse=e=>e?(...t)=>e(...t):(...t)=>fetch(...t);class GC extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class Use extends GC{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class TE extends GC{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class kE extends GC{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var jw;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(jw||(jw={}));class Wse{constructor(t,{headers:r={},customFetch:n,region:i=jw.Any}={}){this.url=t,this.headers=r,this.region=i,this.fetch=zse(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return Gse(this,arguments,void 0,function*(r,n={}){var i;let s,o;try{const{headers:a,method:l,body:c,signal:u,timeout:h}=n;let d={},{region:f}=n;f||(f=this.region);const m=new URL(`${this.url}/${r}`);f&&f!=="any"&&(d["x-region"]=f,m.searchParams.set("forceFunctionRegion",f));let v;c&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)?typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(d["Content-Type"]="application/octet-stream",v=c):typeof c=="string"?(d["Content-Type"]="text/plain",v=c):typeof FormData<"u"&&c instanceof FormData?v=c:(d["Content-Type"]="application/json",v=JSON.stringify(c)):c&&typeof c!="string"&&!(typeof Blob<"u"&&c instanceof Blob)&&!(c instanceof ArrayBuffer)&&!(typeof FormData<"u"&&c instanceof FormData)?v=JSON.stringify(c):v=c;let g=u;h&&(o=new AbortController,s=setTimeout(()=>o.abort(),h),u?(g=o.signal,u.addEventListener("abort",()=>o.abort())):g=o.signal);const w=yield this.fetch(m.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},d),this.headers),a),body:v,signal:g}).catch(F=>{throw new Use(F)}),y=w.headers.get("x-relay-error");if(y&&y==="true")throw new TE(w);if(!w.ok)throw new kE(w);let C=((i=w.headers.get("Content-Type"))!==null&&i!==void 0?i:"text/plain").split(";")[0].trim(),k;return C==="application/json"?k=yield w.json():C==="application/octet-stream"||C==="application/pdf"?k=yield w.blob():C==="text/event-stream"?k=w:C==="multipart/form-data"?k=yield w.formData():k=yield w.text(),{data:k,error:null,response:w}}catch(a){return{data:null,error:a,response:a instanceof kE||a instanceof TE?a.context:void 0}}finally{s&&clearTimeout(s)}})}}var $se=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},qse=class{constructor(e){var t,r,n;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=(t=e.shouldThrowOnError)!==null&&t!==void 0?t:!1,this.signal=e.signal,this.isMaybeSingle=(r=e.isMaybeSingle)!==null&&r!==void 0?r:!1,this.urlLengthLimit=(n=e.urlLengthLimit)!==null&&n!==void 0?n:8e3,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const n=this.fetch;let i=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{let o=null,a=null,l=null,c=s.status,u=s.statusText;if(s.ok){var h,d;if(r.method!=="HEAD"){var f;const w=await s.text();w===""||(r.headers.get("Accept")==="text/csv"||r.headers.get("Accept")&&(!((f=r.headers.get("Accept"))===null||f===void 0)&&f.includes("application/vnd.pgrst.plan+text"))?a=w:a=JSON.parse(w))}const v=(h=r.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),g=(d=s.headers.get("content-range"))===null||d===void 0?void 0:d.split("/");v&&g&&g.length>1&&(l=parseInt(g[1])),r.isMaybeSingle&&r.method==="GET"&&Array.isArray(a)&&(a.length>1?(o={code:"PGRST116",details:`Results contain ${a.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},a=null,l=null,c=406,u="Not Acceptable"):a.length===1?a=a[0]:a=null)}else{var m;const v=await s.text();try{o=JSON.parse(v),Array.isArray(o)&&s.status===404&&(a=[],o=null,c=200,u="OK")}catch{s.status===404&&v===""?(c=204,u="No Content"):o={message:v}}if(o&&r.isMaybeSingle&&(!(o==null||(m=o.details)===null||m===void 0)&&m.includes("0 rows"))&&(o=null,c=200,u="OK"),o&&r.shouldThrowOnError)throw new $se(o)}return{error:o,data:a,count:l,status:c,statusText:u}});return this.shouldThrowOnError||(i=i.catch(s=>{var o;let a="",l="",c="";const u=s?.cause;if(u){var h,d,f,m;const w=(h=u?.message)!==null&&h!==void 0?h:"",y=(d=u?.code)!==null&&d!==void 0?d:"";a=`${(f=s?.name)!==null&&f!==void 0?f:"FetchError"}: ${s?.message}`,a+=`

Caused by: ${(m=u?.name)!==null&&m!==void 0?m:"Error"}: ${w}`,y&&(a+=` (${y})`),u?.stack&&(a+=`
${u.stack}`)}else{var v;a=(v=s?.stack)!==null&&v!==void 0?v:""}const g=this.url.toString().length;return s?.name==="AbortError"||s?.code==="ABORT_ERR"?(c="",l="Request was aborted (timeout or manual cancellation)",g>this.urlLengthLimit&&(l+=`. Note: Your request URL is ${g} characters, which may exceed server limits. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [many IDs])), consider using an RPC function to pass values server-side.`)):(u?.name==="HeadersOverflowError"||u?.code==="UND_ERR_HEADERS_OVERFLOW")&&(c="",l="HTTP headers exceeded server limits (typically 16KB)",g>this.urlLengthLimit&&(l+=`. Your request URL is ${g} characters. If selecting many fields, consider using views. If filtering with large arrays (e.g., .in('id', [200+ IDs])), consider using an RPC function instead.`)),{error:{message:`${(o=s?.name)!==null&&o!==void 0?o:"FetchError"}: ${s?.message}`,details:a,hint:l,code:c},data:null,count:null,status:0,statusText:""}})),i.then(e,t)}returns(){return this}overrideTypes(){return this}},Kse=class extends qse{select(e){let t=!1;const r=(e??"*").split("").map(n=>/\s/.test(n)&&!t?"":(n==='"'&&(t=!t),n)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:n,referencedTable:i=n}={}){const s=i?`${i}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){const n=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(n,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:n=r}={}){const i=typeof n>"u"?"offset":`${n}.offset`,s=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:n=!1,wal:i=!1,format:s="text"}={}){var o;const a=[e?"analyze":null,t?"verbose":null,r?"settings":null,n?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.get("Accept"))!==null&&o!==void 0?o:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${l}"; options=${a};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};const RE=new RegExp("[,()]");var Au=class extends Kse{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&RE.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){const r=Array.from(new Set(t)).map(n=>typeof n=="string"&&RE.test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:n}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const s=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){const n=r?`${r}.or`:"or";return this.url.searchParams.append(n,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},Xse=class{constructor(e,{headers:t={},schema:r,fetch:n,urlLengthLimit:i=8e3}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=n,this.urlLengthLimit=i}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){const{head:r=!1,count:n}=t??{},i=r?"HEAD":"GET";let s=!1;const o=(e??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join(""),{url:a,headers:l}=this.cloneRequestState();return a.searchParams.set("select",o),n&&l.append("Prefer",`count=${n}`),new Au({method:i,url:a,headers:l,schema:this.schema,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}insert(e,{count:t,defaultToNull:r=!0}={}){var n;const i="POST",{url:s,headers:o}=this.cloneRequestState();if(t&&o.append("Prefer",`count=${t}`),r||o.append("Prefer","missing=default"),Array.isArray(e)){const a=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(a.length>0){const l=[...new Set(a)].map(c=>`"${c}"`);s.searchParams.set("columns",l.join(","))}}return new Au({method:i,url:s,headers:o,schema:this.schema,body:e,fetch:(n=this.fetch)!==null&&n!==void 0?n:fetch,urlLengthLimit:this.urlLengthLimit})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:n,defaultToNull:i=!0}={}){var s;const o="POST",{url:a,headers:l}=this.cloneRequestState();if(l.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),t!==void 0&&a.searchParams.set("on_conflict",t),n&&l.append("Prefer",`count=${n}`),i||l.append("Prefer","missing=default"),Array.isArray(e)){const c=e.reduce((u,h)=>u.concat(Object.keys(h)),[]);if(c.length>0){const u=[...new Set(c)].map(h=>`"${h}"`);a.searchParams.set("columns",u.join(","))}}return new Au({method:o,url:a,headers:l,schema:this.schema,body:e,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch,urlLengthLimit:this.urlLengthLimit})}update(e,{count:t}={}){var r;const n="PATCH",{url:i,headers:s}=this.cloneRequestState();return t&&s.append("Prefer",`count=${t}`),new Au({method:n,url:i,headers:s,schema:this.schema,body:e,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch,urlLengthLimit:this.urlLengthLimit})}delete({count:e}={}){var t;const r="DELETE",{url:n,headers:i}=this.cloneRequestState();return e&&i.append("Prefer",`count=${e}`),new Au({method:r,url:n,headers:i,schema:this.schema,fetch:(t=this.fetch)!==null&&t!==void 0?t:fetch,urlLengthLimit:this.urlLengthLimit})}};function If(e){"@babel/helpers - typeof";return If=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},If(e)}function Yse(e,t){if(If(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(If(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Zse(e){var t=Yse(e,"string");return If(t)=="symbol"?t:t+""}function Jse(e,t,r){return(t=Zse(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ng(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AE(Object(r),!0).forEach(function(n){Jse(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var Qse=class O8{constructor(t,{headers:r={},schema:n,fetch:i,timeout:s,urlLengthLimit:o=8e3}={}){this.url=t,this.headers=new Headers(r),this.schemaName=n,this.urlLengthLimit=o;const a=i??globalThis.fetch;s!==void 0&&s>0?this.fetch=(l,c)=>{const u=new AbortController,h=setTimeout(()=>u.abort(),s),d=c?.signal;if(d){if(d.aborted)return clearTimeout(h),a(l,c);const f=()=>{clearTimeout(h),u.abort()};return d.addEventListener("abort",f,{once:!0}),a(l,Ng(Ng({},c),{},{signal:u.signal})).finally(()=>{clearTimeout(h),d.removeEventListener("abort",f)})}return a(l,Ng(Ng({},c),{},{signal:u.signal})).finally(()=>clearTimeout(h))}:this.fetch=a}from(t){if(!t||typeof t!="string"||t.trim()==="")throw new Error("Invalid relation name: relation must be a non-empty string.");return new Xse(new URL(`${this.url}/${t}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}schema(t){return new O8(this.url,{headers:this.headers,schema:t,fetch:this.fetch,urlLengthLimit:this.urlLengthLimit})}rpc(t,r={},{head:n=!1,get:i=!1,count:s}={}){var o;let a;const l=new URL(`${this.url}/rpc/${t}`);let c;const u=f=>f!==null&&typeof f=="object"&&(!Array.isArray(f)||f.some(u)),h=n&&Object.values(r).some(u);h?(a="POST",c=r):n||i?(a=n?"HEAD":"GET",Object.entries(r).filter(([f,m])=>m!==void 0).map(([f,m])=>[f,Array.isArray(m)?`{${m.join(",")}}`:`${m}`]).forEach(([f,m])=>{l.searchParams.append(f,m)})):(a="POST",c=r);const d=new Headers(this.headers);return h?d.set("Prefer",s?`count=${s},return=minimal`:"return=minimal"):s&&d.set("Prefer",`count=${s}`),new Au({method:a,url:l,headers:d,schema:this.schemaName,body:c,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch,urlLengthLimit:this.urlLengthLimit})}};class eoe{constructor(){}static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};const r=globalThis.process;if(r){const n=r.versions;if(n&&n.node){const i=n.node,s=parseInt(i.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let r=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(r+=`

Suggested solution: ${t.workaround}`),new Error(r)}static createWebSocket(t,r){const n=this.getWebSocketConstructor();return new n(t,r)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const toe="2.97.0",roe=`realtime-js/${toe}`,noe="1.0.0",N8="2.0.0",FE=N8,Vw=1e4,ioe=1e3,soe=100;var Ja;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Ja||(Ja={}));var On;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(On||(On={}));var Vs;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Vs||(Vs={}));var Gw;(function(e){e.websocket="websocket"})(Gw||(Gw={}));var Jl;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(Jl||(Jl={}));class ooe{constructor(t){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=t??[]}encode(t,r){if(t.event===this.BROADCAST_EVENT&&!(t.payload instanceof ArrayBuffer)&&typeof t.payload.event=="string")return r(this._binaryEncodeUserBroadcastPush(t));let n=[t.join_ref,t.ref,t.topic,t.event,t.payload];return r(JSON.stringify(n))}_binaryEncodeUserBroadcastPush(t){var r;return this._isArrayBuffer((r=t.payload)===null||r===void 0?void 0:r.payload)?this._encodeBinaryUserBroadcastPush(t):this._encodeJsonUserBroadcastPush(t)}_encodeBinaryUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:new ArrayBuffer(0);return this._encodeUserBroadcastPush(t,this.BINARY_ENCODING,i)}_encodeJsonUserBroadcastPush(t){var r,n;const i=(n=(r=t.payload)===null||r===void 0?void 0:r.payload)!==null&&n!==void 0?n:{},o=new TextEncoder().encode(JSON.stringify(i)).buffer;return this._encodeUserBroadcastPush(t,this.JSON_ENCODING,o)}_encodeUserBroadcastPush(t,r,n){var i,s;const o=t.topic,a=(i=t.ref)!==null&&i!==void 0?i:"",l=(s=t.join_ref)!==null&&s!==void 0?s:"",c=t.payload.event,u=this.allowedMetadataKeys?this._pick(t.payload,this.allowedMetadataKeys):{},h=Object.keys(u).length===0?"":JSON.stringify(u);if(l.length>255)throw new Error(`joinRef length ${l.length} exceeds maximum of 255`);if(a.length>255)throw new Error(`ref length ${a.length} exceeds maximum of 255`);if(o.length>255)throw new Error(`topic length ${o.length} exceeds maximum of 255`);if(c.length>255)throw new Error(`userEvent length ${c.length} exceeds maximum of 255`);if(h.length>255)throw new Error(`metadata length ${h.length} exceeds maximum of 255`);const d=this.USER_BROADCAST_PUSH_META_LENGTH+l.length+a.length+o.length+c.length+h.length,f=new ArrayBuffer(this.HEADER_LENGTH+d);let m=new DataView(f),v=0;m.setUint8(v++,this.KINDS.userBroadcastPush),m.setUint8(v++,l.length),m.setUint8(v++,a.length),m.setUint8(v++,o.length),m.setUint8(v++,c.length),m.setUint8(v++,h.length),m.setUint8(v++,r),Array.from(l,w=>m.setUint8(v++,w.charCodeAt(0))),Array.from(a,w=>m.setUint8(v++,w.charCodeAt(0))),Array.from(o,w=>m.setUint8(v++,w.charCodeAt(0))),Array.from(c,w=>m.setUint8(v++,w.charCodeAt(0))),Array.from(h,w=>m.setUint8(v++,w.charCodeAt(0)));var g=new Uint8Array(f.byteLength+n.byteLength);return g.set(new Uint8Array(f),0),g.set(new Uint8Array(n),f.byteLength),g.buffer}decode(t,r){if(this._isArrayBuffer(t)){let n=this._binaryDecode(t);return r(n)}if(typeof t=="string"){const n=JSON.parse(t),[i,s,o,a,l]=n;return r({join_ref:i,ref:s,topic:o,event:a,payload:l})}return r({})}_binaryDecode(t){const r=new DataView(t),n=r.getUint8(0),i=new TextDecoder;if(n===this.KINDS.userBroadcast)return this._decodeUserBroadcast(t,r,i)}_decodeUserBroadcast(t,r,n){const i=r.getUint8(1),s=r.getUint8(2),o=r.getUint8(3),a=r.getUint8(4);let l=this.HEADER_LENGTH+4;const c=n.decode(t.slice(l,l+i));l=l+i;const u=n.decode(t.slice(l,l+s));l=l+s;const h=n.decode(t.slice(l,l+o));l=l+o;const d=t.slice(l,t.byteLength),f=a===this.JSON_ENCODING?JSON.parse(n.decode(d)):d,m={type:this.BROADCAST_EVENT,event:u,payload:f};return o>0&&(m.meta=JSON.parse(h)),{join_ref:null,ref:null,topic:c,event:this.BROADCAST_EVENT,payload:m}}_isArrayBuffer(t){var r;return t instanceof ArrayBuffer||((r=t?.constructor)===null||r===void 0?void 0:r.name)==="ArrayBuffer"}_pick(t,r){return!t||typeof t!="object"?{}:Object.fromEntries(Object.entries(t).filter(([n])=>r.includes(n)))}}let L8=class{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var $r;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})($r||($r={}));const ME=(e,t,r={})=>{var n;const i=(n=r.skipTypes)!==null&&n!==void 0?n:[];return t?Object.keys(t).reduce((s,o)=>(s[o]=aoe(o,e,t,i),s),{}):{}},aoe=(e,t,r,n)=>{const i=t.find(a=>a.name===e),s=i?.type,o=r[e];return s&&!n.includes(s)?B8(s,o):zw(o)},B8=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return doe(t,r)}switch(e){case $r.bool:return loe(t);case $r.float4:case $r.float8:case $r.int2:case $r.int4:case $r.int8:case $r.numeric:case $r.oid:return coe(t);case $r.json:case $r.jsonb:return uoe(t);case $r.timestamp:return hoe(t);case $r.abstime:case $r.date:case $r.daterange:case $r.int4range:case $r.int8range:case $r.money:case $r.reltime:case $r.text:case $r.time:case $r.timestamptz:case $r.timetz:case $r.tsrange:case $r.tstzrange:return zw(t);default:return zw(t)}},zw=e=>e,loe=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},coe=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},uoe=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e},doe=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const o=e.slice(1,r);try{s=JSON.parse("["+o+"]")}catch{s=o?o.split(","):[]}return s.map(a=>B8(t,a))}return e},hoe=e=>typeof e=="string"?e.replace(" ","T"):e,H8=e=>{const t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class Ib{constructor(t,r,n={},i=Vw){this.channel=t,this.event=r,this.payload=n,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var DE;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(DE||(DE={}));class rf{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=r?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},i=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=rf.syncState(this.state,i,s,o),this.pendingDiffs.forEach(l=>{this.state=rf.syncDiff(this.state,l,s,o)}),this.pendingDiffs=[],a()}),this.channel._on(n.diff,{},i=>{const{onJoin:s,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(i):(this.state=rf.syncDiff(this.state,i,s,o),a())}),this.onJoin((i,s,o)=>{this.channel._trigger("presence",{event:"join",key:i,currentPresences:s,newPresences:o})}),this.onLeave((i,s,o)=>{this.channel._trigger("presence",{event:"leave",key:i,currentPresences:s,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,i){const s=this.cloneDeep(t),o=this.transformState(r),a={},l={};return this.map(s,(c,u)=>{o[c]||(l[c]=u)}),this.map(o,(c,u)=>{const h=s[c];if(h){const d=u.map(g=>g.presence_ref),f=h.map(g=>g.presence_ref),m=u.filter(g=>f.indexOf(g.presence_ref)<0),v=h.filter(g=>d.indexOf(g.presence_ref)<0);m.length>0&&(a[c]=m),v.length>0&&(l[c]=v)}else a[c]=u}),this.syncDiff(s,{joins:a,leaves:l},n,i)}static syncDiff(t,r,n,i){const{joins:s,leaves:o}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),i||(i=()=>{}),this.map(s,(a,l)=>{var c;const u=(c=t[a])!==null&&c!==void 0?c:[];if(t[a]=this.cloneDeep(l),u.length>0){const h=t[a].map(f=>f.presence_ref),d=u.filter(f=>h.indexOf(f.presence_ref)<0);t[a].unshift(...d)}n(a,u,l)}),this.map(o,(a,l)=>{let c=t[a];if(!c)return;const u=l.map(h=>h.presence_ref);c=c.filter(h=>u.indexOf(h.presence_ref)<0),t[a]=c,i(a,c,l),c.length===0&&delete t[a]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const i=t[n];return"metas"in i?r[n]=i.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=i,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var PE;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(PE||(PE={}));var nf;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(nf||(nf={}));var Xo;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Xo||(Xo={}));class ju{constructor(t,r={config:{}},n){var i,s;if(this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=On.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new Ib(this,Vs.join,this.params,this.timeout),this.rejoinTimer=new L8(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=On.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=On.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=On.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=On.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=On.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Vs.reply,{},(o,a)=>{this._trigger(this._replyEventName(a),o)}),this.presence=new rf(this),this.broadcastEndpointURL=H8(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((s=(i=this.params.config)===null||i===void 0?void 0:i.broadcast)===null||s===void 0)&&s.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,r=this.timeout){var n,i,s;if(this.socket.isConnected()||this.socket.connect(),this.state==On.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params,c=(i=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&i!==void 0?i:[],u=!!this.bindings[nf.PRESENCE]&&this.bindings[nf.PRESENCE].length>0||((s=this.params.config.presence)===null||s===void 0?void 0:s.enabled)===!0,h={},d={broadcast:o,presence:Object.assign(Object.assign({},a),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(h.access_token=this.socket.accessTokenValue),this._onError(f=>t?.(Xo.CHANNEL_ERROR,f)),this._onClose(()=>t?.(Xo.CLOSED)),this.updateJoinPayload(Object.assign({config:d},h)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var m;if(this.socket._isManualToken()||this.socket.setAuth(),f===void 0){t?.(Xo.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,g=(m=v?.length)!==null&&m!==void 0?m:0,w=[];for(let y=0;y<g;y++){const C=v[y],{filter:{event:k,schema:F,table:I,filter:N}}=C,j=f&&f[y];if(j&&j.event===k&&ju.isFilterValueEqual(j.schema,F)&&ju.isFilterValueEqual(j.table,I)&&ju.isFilterValueEqual(j.filter,N))w.push(Object.assign(Object.assign({},C),{id:j.id}));else{this.unsubscribe(),this.state=On.errored,t?.(Xo.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=w,t&&t(Xo.SUBSCRIBED);return}}).receive("error",f=>{this.state=On.errored,t?.(Xo.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t?.(Xo.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this.state===On.joined&&t===nf.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(t,r,n)}async httpSend(t,r,n={}){var i;if(r==null)return Promise.reject("Payload is required for httpSend()");const s={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(s.Authorization=`Bearer ${this.socket.accessTokenValue}`);const o={method:"POST",headers:s,body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:r,private:this.private}]})},a=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(i=n.timeout)!==null&&i!==void 0?i:this.timeout);if(a.status===202)return{success:!0};let l=a.statusText;try{const c=await a.json();l=c.error||c.message||l}catch{}return Promise.reject(new Error(l))}async send(t,r={}){var n,i;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:s,payload:o}=t,a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);const l={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:o,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((i=c.body)===null||i===void 0?void 0:i.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var o,a,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(a=(o=this.params)===null||o===void 0?void 0:o.config)===null||a===void 0?void 0:a.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=On.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Vs.close,"leave",this._joinRef())};this.joinPush.destroy();let n=null;return new Promise(i=>{n=new Ib(this,Vs.leave,{},t),n.receive("ok",()=>{r(),i("ok")}).receive("timeout",()=>{r(),i("timed out")}).receive("error",()=>{i("error")}),n.send(),this._canPush()||n.trigger("ok",{})}).finally(()=>{n?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=On.closed,this.bindings={}}async _fetchWithTimeout(t,r,n){const i=new AbortController,s=setTimeout(()=>i.abort(),n),o=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:i.signal}));return clearTimeout(s),o}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new Ib(this,t,r,n);return this._canPush()?i.send():this._addToPushBuffer(i),i}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>soe){const r=this.pushBuffer.shift();r&&(r.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${r.event}`,r.payload))}}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var i,s;const o=t.toLocaleLowerCase(),{close:a,error:l,leave:c,join:u}=Vs;if(n&&[a,l,c,u].indexOf(o)>=0&&n!==this._joinRef())return;let d=this._onMessage(o,r,n);if(r&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(i=this.bindings.postgres_changes)===null||i===void 0||i.filter(f=>{var m,v,g;return((m=f.filter)===null||m===void 0?void 0:m.event)==="*"||((g=(v=f.filter)===null||v===void 0?void 0:v.event)===null||g===void 0?void 0:g.toLocaleLowerCase())===o}).map(f=>f.callback(d,n)):(s=this.bindings[o])===null||s===void 0||s.filter(f=>{var m,v,g,w,y,C;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in f){const k=f.id,F=(m=f.filter)===null||m===void 0?void 0:m.event;return k&&((v=r.ids)===null||v===void 0?void 0:v.includes(k))&&(F==="*"||F?.toLocaleLowerCase()===((g=r.data)===null||g===void 0?void 0:g.type.toLocaleLowerCase()))}else{const k=(y=(w=f?.filter)===null||w===void 0?void 0:w.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return k==="*"||k===((C=r?.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return f.type.toLocaleLowerCase()===o}).map(f=>{if(typeof d=="object"&&"ids"in d){const m=d.data,{schema:v,table:g,commit_timestamp:w,type:y,errors:C}=m;d=Object.assign(Object.assign({},{schema:v,table:g,commit_timestamp:w,eventType:y,new:{},old:{},errors:C}),this._getPayloadRecords(m))}f.callback(d,n)})}_isClosed(){return this.state===On.closed}_isJoined(){return this.state===On.joined}_isJoining(){return this.state===On.joining}_isLeaving(){return this.state===On.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const i=t.toLocaleLowerCase(),s={type:i,filter:r,callback:n};return this.bindings[i]?this.bindings[i].push(s):this.bindings[i]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]&&(this.bindings[n]=this.bindings[n].filter(i=>{var s;return!(((s=i.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&ju.isEqual(i.filter,r))})),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}static isFilterValueEqual(t,r){return(t??void 0)===(r??void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Vs.close,{},t)}_onError(t){this._on(Vs.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=On.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=ME(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=ME(t.columns,t.old_record)),r}}const Ob=()=>{},Lg={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},foe=[1e3,2e3,5e3,1e4],poe=1e4,goe=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class moe{constructor(t,r){var n;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Vw,this.transport=null,this.heartbeatIntervalMs=Lg.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Ob,this.ref=0,this.reconnectTimer=null,this.vsn=FE,this.logger=Ob,this.conn=null,this.sendBuffer=[],this.serializer=new ooe,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=i=>i?(...s)=>i(...s):(...s)=>fetch(...s),!(!((n=r?.params)===null||n===void 0)&&n.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=r.params.apikey,this.endPoint=`${t}/${Gw.websocket}`,this.httpEndpoint=H8(t),this._initializeOptions(r),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(r?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=eoe.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const r=t.message;throw r.includes("Node.js")?new Error(`${r}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${r}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(t,r){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const n=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(n),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(t?this.conn.close(t,r??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case Ja.connecting:return Jl.Connecting;case Ja.open:return Jl.Open;case Ja.closing:return Jl.Closing;default:return Jl.Closed}}isConnected(){return this.connectionState()===Jl.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,r={config:{}}){const n=`realtime:${t}`,i=this.getChannels().find(s=>s.topic===n);if(i)return i;{const s=new ju(`realtime:${t}`,r,this);return this.channels.push(s),s}}push(t){const{topic:r,event:n,payload:i,ref:s}=t,o=()=>{this.encode(t,a=>{var l;(l=this.conn)===null||l===void 0||l.send(a)})};this.log("push",`${r} ${n} (${s})`,i),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(r){this.log("error","error in heartbeat callback",r)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(r){this.log("error","error in heartbeat callback",r)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(ioe,"heartbeat timeout"),setTimeout(()=>{var r;this.isConnected()||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout()},Lg.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(r){this.log("error","error in heartbeat callback",r)}this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,r=>{if(r.topic==="phoenix"&&r.event==="phx_reply"&&r.ref&&r.ref===this.pendingHeartbeatRef){const c=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback(r.payload.status==="ok"?"ok":"error",c)}catch(u){this.log("error","error in heartbeat callback",u)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}const{topic:n,event:i,payload:s,ref:o}=r,a=o?`(${o})`:"",l=s.status||"";this.log("receive",`${l} ${n} ${i} ${a}`.trim(),s),this.channels.filter(c=>c._isMember(n)).forEach(c=>c._trigger(i,s,o)),this._triggerStateCallbacks("message",r)})}_clearTimer(t){var r;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((r=this.reconnectTimer)===null||r===void 0||r.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t),this.conn.readyState===Ja.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===Ja.open||this.conn.readyState===Ja.connecting)try{this.conn.close()}catch(t){this.log("error","Error closing connection",t)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(r=>{this.log("error","error waiting for auth on connect",r),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this._terminateWorker()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(t){var r;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(r=this.reconnectTimer)===null||r===void 0||r.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t);try{this.heartbeatCallback("error")}catch(r){this.log("error","error in heartbeat callback",r)}}_triggerChanError(){this.channels.forEach(t=>t._trigger(Vs.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",i=new URLSearchParams(r);return`${t}${n}${i}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([goe],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}_setConnectionState(t,r=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=r)}async _performAuth(t=null){let r,n=!1;if(t)r=t,n=!0;else if(this.accessToken)try{r=await this.accessToken()}catch(i){this.log("error","Error fetching access token from callback",i),r=this.accessTokenValue}else r=this.accessTokenValue;n?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=r&&(this.accessTokenValue=r,this.channels.forEach(i=>{const s={access_token:r,version:roe};r&&i.updateJoinPayload(s),i.joinedOnce&&i._isJoined()&&i._push(Vs.access_token,{access_token:r})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this._isManualToken()||this.setAuth().catch(r=>{this.log("error",`Error setting auth in ${t}`,r)})}_triggerStateCallbacks(t,r){try{this.stateChangeCallbacks[t].forEach(n=>{try{n(r)}catch(i){this.log("error",`error in ${t} callback`,i)}})}catch(n){this.log("error",`error triggering ${t} callbacks`,n)}}_setupReconnectionTimer(){this.reconnectTimer=new L8(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Lg.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var r,n,i,s,o,a,l,c,u,h,d,f;switch(this.transport=(r=t?.transport)!==null&&r!==void 0?r:null,this.timeout=(n=t?.timeout)!==null&&n!==void 0?n:Vw,this.heartbeatIntervalMs=(i=t?.heartbeatIntervalMs)!==null&&i!==void 0?i:Lg.HEARTBEAT_INTERVAL,this.worker=(s=t?.worker)!==null&&s!==void 0?s:!1,this.accessToken=(o=t?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(a=t?.heartbeatCallback)!==null&&a!==void 0?a:Ob,this.vsn=(l=t?.vsn)!==null&&l!==void 0?l:FE,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:(m=>foe[m-1]||poe),this.vsn){case noe:this.encode=(u=t?.encode)!==null&&u!==void 0?u:((m,v)=>v(JSON.stringify(m))),this.decode=(h=t?.decode)!==null&&h!==void 0?h:((m,v)=>v(JSON.parse(m)));break;case N8:this.encode=(d=t?.encode)!==null&&d!==void 0?d:this.serializer.encode.bind(this.serializer),this.decode=(f=t?.decode)!==null&&f!==void 0?f:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}}var Of=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown=t.icebergType==="CommitStateUnknownException"||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return this.status===404}isConflict(){return this.status===409}isAuthenticationTimeout(){return this.status===419}};function voe(e,t,r){const n=new URL(t,e);if(r)for(const[i,s]of Object.entries(r))s!==void 0&&n.searchParams.set(i,s);return n.toString()}async function boe(e){return!e||e.type==="none"?{}:e.type==="bearer"?{Authorization:`Bearer ${e.token}`}:e.type==="header"?{[e.name]:e.value}:e.type==="custom"?await e.getHeaders():{}}function woe(e){const t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:n,query:i,body:s,headers:o}){const a=voe(e.baseUrl,n,i),l=await boe(e.auth),c=await t(a,{method:r,headers:{...s?{"Content-Type":"application/json"}:{},...l,...o},body:s?JSON.stringify(s):void 0}),u=await c.text(),h=(c.headers.get("content-type")||"").includes("application/json"),d=h&&u?JSON.parse(u):u;if(!c.ok){const f=h?d:void 0,m=f?.error;throw new Of(m?.message??`Request failed with status ${c.status}`,{status:c.status,icebergType:m?.type,icebergCode:m?.code,details:f})}return{status:c.status,headers:c.headers,data:d}}}}function Bg(e){return e.join("")}var yoe=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){const t=e?{parent:Bg(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(n=>({namespace:n}))}async createNamespace(e,t){const r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${Bg(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${Bg(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${Bg(e.namespace)}`}),!0}catch(t){if(t instanceof Of&&t.status===404)return!1;throw t}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(r){if(r instanceof Of&&r.status===409)return;throw r}}};function yu(e){return e.join("")}var Coe=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${yu(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){const r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${yu(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){const r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${yu(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${yu(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){const t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${yu(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){const t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${yu(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(r){if(r instanceof Of&&r.status===404)return!1;throw r}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof Of&&r.status===409)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},xoe=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);const r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=woe({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new yoe(this.client,t),this.tableOps=new Coe(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},km=class extends Error{constructor(e,t="storage",r,n){super(e),this.__isStorageError=!0,this.namespace=t,this.name=t==="vectors"?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=n}};function Rm(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}var Hg=class extends km{constructor(e,t,r,n="storage"){super(e,n,t,r),this.name=n==="vectors"?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},j8=class extends km{constructor(e,t,r="storage"){super(e,r),this.name=r==="vectors"?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};const Soe=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),_oe=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},Uw=e=>{if(Array.isArray(e))return e.map(r=>Uw(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const i=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[i]=Uw(n)}),t},Eoe=e=>!e||typeof e!="string"||e.length===0||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\")?!1:/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function Nf(e){"@babel/helpers - typeof";return Nf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Nf(e)}function Toe(e,t){if(Nf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Nf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function koe(e){var t=Toe(e,"string");return Nf(t)=="symbol"?t:t+""}function Roe(e,t,r){return(t=koe(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ht(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?IE(Object(r),!0).forEach(function(n){Roe(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):IE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const OE=e=>{var t;return e.msg||e.message||e.error_description||(typeof e.error=="string"?e.error:(t=e.error)===null||t===void 0?void 0:t.message)||JSON.stringify(e)},Aoe=async(e,t,r,n)=>{if(e&&typeof e=="object"&&"status"in e&&"ok"in e&&typeof e.status=="number"&&!r?.noResolveJson){const i=e,s=i.status||500;if(typeof i.json=="function")i.json().then(o=>{const a=o?.statusCode||o?.code||s+"";t(new Hg(OE(o),s,a,n))}).catch(()=>{if(n==="vectors"){const o=s+"";t(new Hg(i.statusText||`HTTP ${s} error`,s,o,n))}else{const o=s+"";t(new Hg(i.statusText||`HTTP ${s} error`,s,o,n))}});else{const o=s+"";t(new Hg(i.statusText||`HTTP ${s} error`,s,o,n))}}else t(new j8(OE(e),e,n))},Foe=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"||e==="HEAD"||!n?Ht(Ht({},i),r):(_oe(n)?(i.headers=Ht({"Content-Type":"application/json"},t?.headers),i.body=JSON.stringify(n)):i.body=n,t?.duplex&&(i.duplex=t.duplex),Ht(Ht({},i),r))};async function kh(e,t,r,n,i,s,o){return new Promise((a,l)=>{e(r,Foe(t,n,i,s)).then(c=>{if(!c.ok)throw c;if(n?.noResolveJson)return c;if(o==="vectors"){const u=c.headers.get("content-type");if(c.headers.get("content-length")==="0"||c.status===204)return{};if(!u||!u.includes("application/json"))return{}}return c.json()}).then(c=>a(c)).catch(c=>Aoe(c,l,n,o))})}function V8(e="storage"){return{get:async(t,r,n,i)=>kh(t,"GET",r,n,i,void 0,e),post:async(t,r,n,i,s)=>kh(t,"POST",r,i,s,n,e),put:async(t,r,n,i,s)=>kh(t,"PUT",r,i,s,n,e),head:async(t,r,n,i)=>kh(t,"HEAD",r,Ht(Ht({},n),{},{noResolveJson:!0}),i,void 0,e),remove:async(t,r,n,i,s)=>kh(t,"DELETE",r,i,s,n,e)}}const Moe=V8("storage"),{get:Lf,post:js,put:Ww,head:Doe,remove:zC}=Moe,ts=V8("vectors");var Ad=class{constructor(e,t={},r,n="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=Soe(r),this.namespace=n}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Ht(Ht({},this.headers),{},{[e]:t}),this}async handleOperation(e){var t=this;try{return{data:await e(),error:null}}catch(r){if(t.shouldThrowOnError)throw r;if(Rm(r))return{data:null,error:r};throw r}}},Poe=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){var e=this;try{return{data:(await e.downloadFn()).body,error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Rm(t))return{data:null,error:t};throw t}}};let G8;G8=Symbol.toStringTag;var Ioe=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[G8]="BlobDownloadBuilder",this.promise=null}asStream(){return new Poe(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){var e=this;try{return{data:await(await e.downloadFn()).blob(),error:null}}catch(t){if(e.shouldThrowOnError)throw t;if(Rm(t))return{data:null,error:t};throw t}}};const Ooe={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},NE={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var Noe=class extends Ad{constructor(e,t={},r,n){super(e,t,n,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,n){var i=this;return i.handleOperation(async()=>{let s;const o=Ht(Ht({},NE),n);let a=Ht(Ht({},i.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&r instanceof Blob?(s=new FormData,s.append("cacheControl",o.cacheControl),l&&s.append("metadata",i.encodeMetadata(l)),s.append("",r)):typeof FormData<"u"&&r instanceof FormData?(s=r,s.has("cacheControl")||s.append("cacheControl",o.cacheControl),l&&!s.has("metadata")&&s.append("metadata",i.encodeMetadata(l))):(s=r,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=i.toBase64(i.encodeMetadata(l))),(typeof ReadableStream<"u"&&s instanceof ReadableStream||s&&typeof s=="object"&&"pipe"in s&&typeof s.pipe=="function")&&!o.duplex&&(o.duplex="half")),n?.headers&&(a=Ht(Ht({},a),n.headers));const c=i._removeEmptyFolders(t),u=i._getFinalPath(c),h=await(e=="PUT"?Ww:js)(i.fetch,`${i.url}/object/${u}`,s,Ht({headers:a},o?.duplex?{duplex:o.duplex}:{}));return{path:c,id:h.Id,fullPath:h.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,n){var i=this;const s=i._removeEmptyFolders(e),o=i._getFinalPath(s),a=new URL(i.url+`/object/upload/sign/${o}`);return a.searchParams.set("token",t),i.handleOperation(async()=>{let l;const c=Ht({upsert:NE.upsert},n),u=Ht(Ht({},i.headers),{"x-upsert":String(c.upsert)});return typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl)):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType),{path:s,fullPath:(await Ww(i.fetch,a.toString(),l,{headers:u})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let n=r._getFinalPath(e);const i=Ht({},r.headers);t?.upsert&&(i["x-upsert"]="true");const s=await js(r.fetch,`${r.url}/object/upload/sign/${n}`,{},{headers:i}),o=new URL(r.url+s.url),a=o.searchParams.get("token");if(!a)throw new km("No token returned by API");return{signedUrl:o.toString(),path:e,token:a}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var n=this;return n.handleOperation(async()=>await js(n.fetch,`${n.url}/object/move`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:n.headers}))}async copy(e,t,r){var n=this;return n.handleOperation(async()=>({path:(await js(n.fetch,`${n.url}/object/copy`,{bucketId:n.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:n.headers})).Key}))}async createSignedUrl(e,t,r){var n=this;return n.handleOperation(async()=>{let i=n._getFinalPath(e),s=await js(n.fetch,`${n.url}/object/sign/${i}`,Ht({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:n.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{signedUrl:encodeURI(`${n.url}${s.signedURL}${o}`)}})}async createSignedUrls(e,t,r){var n=this;return n.handleOperation(async()=>{const i=await js(n.fetch,`${n.url}/object/sign/${n.bucketId}`,{expiresIn:t,paths:e},{headers:n.headers}),s=r?.download?`&download=${r.download===!0?"":r.download}`:"";return i.map(o=>Ht(Ht({},o),{},{signedUrl:o.signedURL?encodeURI(`${n.url}${o.signedURL}${s}`):null}))})}download(e,t,r){const n=typeof t?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(t?.transform||{}),s=i?`?${i}`:"",o=this._getFinalPath(e),a=()=>Lf(this.fetch,`${this.url}/${n}/${o}${s}`,{headers:this.headers,noResolveJson:!0},r);return new Ioe(a,this.shouldThrowOnError)}async info(e){var t=this;const r=t._getFinalPath(e);return t.handleOperation(async()=>Uw(await Lf(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){var t=this;const r=t._getFinalPath(e);try{return await Doe(t.fetch,`${t.url}/object/${r}`,{headers:t.headers}),{data:!0,error:null}}catch(n){if(t.shouldThrowOnError)throw n;if(Rm(n)&&n instanceof j8){const i=n.originalError;if([400,404].includes(i?.status))return{data:!1,error:n}}throw n}}getPublicUrl(e,t){const r=this._getFinalPath(e),n=[],i=t?.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&n.push(i);const s=typeof t?.transform<"u"?"render/image":"object",o=this.transformOptsToQueryString(t?.transform||{});o!==""&&n.push(o);let a=n.join("&");return a!==""&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${s}/public/${r}${a}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await zC(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var n=this;return n.handleOperation(async()=>{const i=Ht(Ht(Ht({},Ooe),t),{},{prefix:e||""});return await js(n.fetch,`${n.url}/object/list/${n.bucketId}`,i,{headers:n.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{const n=Ht({},e);return await js(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,n,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};const Loe="2.97.0",np={"X-Client-Info":`storage-js/${Loe}`};var Boe=class extends Ad{constructor(e,t={},r,n){const i=new URL(e);n?.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase."));const s=i.href.replace(/\/$/,""),o=Ht(Ht({},np),t);super(s,o,r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=t.listBucketOptionsToQueryString(e);return await Lf(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await Lf(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await js(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await Ww(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await js(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await zC(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},Hoe=class extends Ad{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Ht(Ht({},np),t);super(n,i,r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await js(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{const r=new URLSearchParams;e?.limit!==void 0&&r.set("limit",e.limit.toString()),e?.offset!==void 0&&r.set("offset",e.offset.toString()),e?.sortColumn&&r.set("sortColumn",e.sortColumn),e?.sortOrder&&r.set("sortOrder",e.sortOrder),e?.search&&r.set("search",e.search);const n=r.toString(),i=n?`${t.url}/bucket?${n}`:`${t.url}/bucket`;return await Lf(t.fetch,i,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await zC(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!Eoe(e))throw new km("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");const r=new xoe({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),n=this.shouldThrowOnError;return new Proxy(r,{get(i,s){const o=i[s];return typeof o!="function"?o:async(...a)=>{try{return{data:await o.apply(i,a),error:null}}catch(l){if(n)throw l;return{data:null,error:l}}}}})}},joe=class extends Ad{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Ht(Ht({},np),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await ts.post(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await ts.post(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await ts.post(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await ts.post(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},Voe=class extends Ad{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Ht(Ht({},np),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await ts.post(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await ts.post(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await ts.post(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await ts.post(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await ts.post(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},Goe=class extends Ad{constructor(e,t={},r){const n=e.replace(/\/$/,""),i=Ht(Ht({},np),{},{"Content-Type":"application/json"},t);super(n,i,r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await ts.post(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await ts.post(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await ts.post(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await ts.post(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},zoe=class extends Goe{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new Uoe(this.url,this.headers,e,this.fetch)}async createBucket(e){var t=()=>super.createBucket,r=this;return t().call(r,e)}async getBucket(e){var t=()=>super.getBucket,r=this;return t().call(r,e)}async listBuckets(e={}){var t=()=>super.listBuckets,r=this;return t().call(r,e)}async deleteBucket(e){var t=()=>super.deleteBucket,r=this;return t().call(r,e)}},Uoe=class extends joe{constructor(e,t,r,n){super(e,t,n),this.vectorBucketName=r}async createIndex(e){var t=()=>super.createIndex,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName}))}async listIndexes(e={}){var t=()=>super.listIndexes,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName}))}async getIndex(e){var t=()=>super.getIndex,r=this;return t().call(r,r.vectorBucketName,e)}async deleteIndex(e){var t=()=>super.deleteIndex,r=this;return t().call(r,r.vectorBucketName,e)}index(e){return new Woe(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},Woe=class extends Voe{constructor(e,t,r,n,i){super(e,t,i),this.vectorBucketName=r,this.indexName=n}async putVectors(e){var t=()=>super.putVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async getVectors(e){var t=()=>super.getVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async listVectors(e={}){var t=()=>super.listVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async queryVectors(e){var t=()=>super.queryVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}async deleteVectors(e){var t=()=>super.deleteVectors,r=this;return t().call(r,Ht(Ht({},e),{},{vectorBucketName:r.vectorBucketName,indexName:r.indexName}))}},$oe=class extends Boe{constructor(e,t={},r,n){super(e,t,r,n)}from(e){return new Noe(this.url,this.headers,e,this.fetch)}get vectors(){return new zoe(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Hoe(this.url+"/iceberg",this.headers,this.fetch)}};const z8="2.97.0",Fu=30*1e3,$w=3,Nb=$w*Fu,qoe="http://localhost:9999",Koe="supabase.auth.token",Xoe={"X-Client-Info":`gotrue-js/${z8}`},qw="X-Supabase-Api-Version",U8={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Yoe=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,Zoe=600*1e3;class Bf extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Rt(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class Joe extends Bf{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function Qoe(e){return Rt(e)&&e.name==="AuthApiError"}class Ql extends Bf{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class va extends Bf{constructor(t,r,n,i){super(t,n,i),this.name=r,this.status=n}}class Yi extends va{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function Lb(e){return Rt(e)&&e.name==="AuthSessionMissingError"}class Cu extends va{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class jg extends va{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Vg extends va{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function eae(e){return Rt(e)&&e.name==="AuthImplicitGrantRedirectError"}class LE extends va{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class tae extends va{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class Kw extends va{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function Bb(e){return Rt(e)&&e.name==="AuthRetryableFetchError"}class BE extends va{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Xw extends va{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Y0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),HE=` 	
\r=`.split(""),rae=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<HE.length;t+=1)e[HE[t].charCodeAt(0)]=-2;for(let t=0;t<Y0.length;t+=1)e[Y0[t].charCodeAt(0)]=t;return e})();function jE(e,t,r){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Y0[n]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const n=t.queue>>t.queuedBits-6&63;r(Y0[n]),t.queuedBits-=6}}function W8(e,t,r){const n=rae[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function VE(e){const t=[],r=o=>{t.push(String.fromCodePoint(o))},n={utf8seq:0,codepoint:0},i={queue:0,queuedBits:0},s=o=>{sae(o,n,r)};for(let o=0;o<e.length;o+=1)W8(e.charCodeAt(o),i,s);return t.join("")}function nae(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function iae(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const i=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|i)+65536,r+=1}nae(n,t)}}function sae(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if((e>>7-n&1)===0){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function sd(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};for(let i=0;i<e.length;i+=1)W8(e.charCodeAt(i),r,n);return new Uint8Array(t)}function oae(e){const t=[];return iae(e,r=>t.push(r)),new Uint8Array(t)}function rc(e){const t=[],r={queue:0,queuedBits:0},n=i=>{t.push(i)};return e.forEach(i=>jE(i,r,n)),jE(null,r,n),t.join("")}function aae(e){return Math.round(Date.now()/1e3)+e}function lae(){return Symbol("auth-callback")}const ei=()=>typeof window<"u"&&typeof document<"u",Ul={tested:!1,writable:!1},$8=()=>{if(!ei())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ul.tested)return Ul.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),Ul.tested=!0,Ul.writable=!0}catch{Ul.tested=!0,Ul.writable=!1}return Ul.writable};function cae(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((i,s)=>{t[s]=i})}catch{}return r.searchParams.forEach((n,i)=>{t[i]=n}),t}const q8=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),uae=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Mu=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},Wl=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},Zn=async(e,t)=>{await e.removeItem(t)};class Am{constructor(){this.promise=new Am.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Am.promiseConstructor=Promise;function Gg(e){const t=e.split(".");if(t.length!==3)throw new Xw("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!Yoe.test(t[n]))throw new Xw("JWT not in base64url format");return{header:JSON.parse(VE(t[0])),payload:JSON.parse(VE(t[1])),signature:sd(t[2]),raw:{header:t[0],payload:t[1]}}}async function dae(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function hae(e,t){return new Promise((n,i)=>{(async()=>{for(let s=0;s<1/0;s++)try{const o=await e(s);if(!t(s,null,o)){n(o);return}}catch(o){if(!t(s,o)){i(o);return}}})()})}function fae(e){return("0"+e.toString(16)).substr(-2)}function pae(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let i="";for(let s=0;s<56;s++)i+=r.charAt(Math.floor(Math.random()*n));return i}return crypto.getRandomValues(t),Array.from(t,fae).join("")}async function gae(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),i=new Uint8Array(n);return Array.from(i).map(s=>String.fromCharCode(s)).join("")}async function mae(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await gae(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function xu(e,t,r=!1){const n=pae();let i=n;r&&(i+="/PASSWORD_RECOVERY"),await Mu(e,`${t}-code-verifier`,i);const s=await mae(n);return[s,n===s?"plain":"s256"]}const vae=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function bae(e){const t=e.headers.get(qw);if(!t||!t.match(vae))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function wae(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function yae(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Cae=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Su(e){if(!Cae.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Hb(){const e={};return new Proxy(e,{get:(t,r)=>{if(r==="__isUserNotAvailableProxy")return!0;if(typeof r=="symbol"){const n=r.toString();if(n==="Symbol(Symbol.toPrimitive)"||n==="Symbol(Symbol.toStringTag)"||n==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${r}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,r)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${r}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function xae(e,t){return new Proxy(e,{get:(r,n,i)=>{if(n==="__isInsecureUserWarningProxy")return!0;if(typeof n=="symbol"){const s=n.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)"||s==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(r,n,i)}return!t.value&&typeof n=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),t.value=!0),Reflect.get(r,n,i)}})}function GE(e){return JSON.parse(JSON.stringify(e))}const ql=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Sae=[502,503,504];async function zE(e){var t;if(!uae(e))throw new Kw(ql(e),0);if(Sae.includes(e.status))throw new Kw(ql(e),e.status);let r;try{r=await e.json()}catch(s){throw new Ql(ql(s),s)}let n;const i=bae(e);if(i&&i.getTime()>=U8["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new BE(ql(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Yi}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,o)=>s&&typeof o=="string",!0))throw new BE(ql(r),e.status,r.weak_password.reasons);throw new Joe(ql(r),e.status||500,n)}const _ae=(e,t,r,n)=>{const i={method:e,headers:t?.headers||{}};return e==="GET"?i:(i.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),i.body=JSON.stringify(n),Object.assign(Object.assign({},i),r))};async function Vt(e,t,r,n){var i;const s=Object.assign({},n?.headers);s[qw]||(s[qw]=U8["2024-01-01"].name),n?.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const o=(i=n?.query)!==null&&i!==void 0?i:{};n?.redirectTo&&(o.redirect_to=n.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await Eae(e,t,r+a,{headers:s,noResolveJson:n?.noResolveJson},{},n?.body);return n?.xform?n?.xform(l):{data:Object.assign({},l),error:null}}async function Eae(e,t,r,n,i,s){const o=_ae(t,n,i,s);let a;try{a=await e(r,Object.assign({},o))}catch(l){throw console.error(l),new Kw(ql(l),0)}if(a.ok||await zE(a),n?.noResolveJson)return a;try{return await a.json()}catch(l){await zE(l)}}function Bs(e){var t;let r=null;Rae(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=aae(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function UE(e){const t=Bs(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Qa(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Tae(e){return{data:e,error:null}}function kae(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s}=e,o=Tm(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:t,email_otp:r,hashed_token:n,redirect_to:i,verification_type:s},l=Object.assign({},o);return{data:{properties:a,user:l},error:null}}function WE(e){return e}function Rae(e){return e.access_token&&e.refresh_token&&e.expires_in}const jb=["global","local","others"];class Aae{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=q8(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(t,r=jb[0]){if(jb.indexOf(r)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${jb.join(", ")}`);try{return await Vt(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Rt(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Vt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Qa})}catch(n){if(Rt(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=Tm(t,["options"]),i=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(i.new_email=n?.newEmail,delete i.newEmail),await Vt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:kae,redirectTo:r?.redirectTo})}catch(r){if(Rt(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Vt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Qa})}catch(r){if(Rt(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,i,s,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Vt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:WE});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(m=>{const v=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=v}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Rt(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){Su(t);try{return await Vt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Qa})}catch(r){if(Rt(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){Su(t);try{return await Vt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Qa})}catch(n){if(Rt(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){Su(t);try{return await Vt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Qa})}catch(n){if(Rt(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){Su(t.userId);try{const{data:r,error:n}=await Vt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:i=>({data:{factors:i},error:null})});return{data:r,error:n}}catch(r){if(Rt(r))return{data:null,error:r};throw r}}async _deleteFactor(t){Su(t.userId),Su(t.id);try{return{data:await Vt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Rt(r))return{data:null,error:r};throw r}}async _listOAuthClients(t){var r,n,i,s,o,a,l;try{const c={nextPage:null,lastPage:0,total:0},u=await Vt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t?.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(i=t?.perPage)===null||i===void 0?void 0:i.toString())!==null&&s!==void 0?s:""},xform:WE});if(u.error)throw u.error;const h=await u.json(),d=(o=u.headers.get("x-total-count"))!==null&&o!==void 0?o:0,f=(l=(a=u.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&l!==void 0?l:[];return f.length>0&&(f.forEach(m=>{const v=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),g=JSON.parse(m.split(";")[1].split("=")[1]);c[`${g}Page`]=v}),c.total=parseInt(d)),{data:Object.assign(Object.assign({},h),c),error:null}}catch(c){if(Rt(c))return{data:{clients:[]},error:c};throw c}}async _createOAuthClient(t){try{return await Vt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Rt(r))return{data:null,error:r};throw r}}async _getOAuthClient(t){try{return await Vt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Rt(r))return{data:null,error:r};throw r}}async _updateOAuthClient(t,r){try{return await Vt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${t}`,{body:r,headers:this.headers,xform:n=>({data:n,error:null})})}catch(n){if(Rt(n))return{data:null,error:n};throw n}}async _deleteOAuthClient(t){try{return await Vt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Rt(r))return{data:null,error:r};throw r}}async _regenerateOAuthClientSecret(t){try{return await Vt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(Rt(r))return{data:null,error:r};throw r}}}function $E(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}const _u={debug:!!(globalThis&&$8()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class K8 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class qE extends K8{}async function Fae(e,t,r){_u.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;t>0&&setTimeout(()=>{n.abort(),_u.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve();try{return await globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async i=>{if(i){_u.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{_u.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(t===0)throw _u.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new qE(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(_u.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}})}catch(i){throw i?.name==="AbortError"?new qE(`Acquiring an exclusive Navigator LockManager lock "${e}" timed out waiting ${t}ms`):i}}function Mae(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function X8(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw new Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}function Dae(e){return parseInt(e,16)}function Pae(e){const t=new TextEncoder().encode(e);return"0x"+Array.from(t,n=>n.toString(16).padStart(2,"0")).join("")}function Iae(e){var t;const{chainId:r,domain:n,expirationTime:i,issuedAt:s=new Date,nonce:o,notBefore:a,requestId:l,resources:c,scheme:u,uri:h,version:d}=e;{if(!Number.isInteger(r))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!n)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!h)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(d!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${d}`);if(!((t=e.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`)}const f=X8(e.address),m=u?`${u}://${n}`:n,v=e.statement?`${e.statement}
`:"",g=`${m} wants you to sign in with your Ethereum account:
${f}

${v}`;let w=`URI: ${h}
Version: ${d}
Chain ID: ${r}${o?`
Nonce: ${o}`:""}
Issued At: ${s.toISOString()}`;if(i&&(w+=`
Expiration Time: ${i.toISOString()}`),a&&(w+=`
Not Before: ${a.toISOString()}`),l&&(w+=`
Request ID: ${l}`),c){let y=`
Resources:`;for(const C of c){if(!C||typeof C!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${C}`);y+=`
- ${C}`}w+=y}return`${g}
${w}`}class Dn extends Error{constructor({message:t,code:r,cause:n,name:i}){var s;super(t,{cause:n}),this.__isWebAuthnError=!0,this.name=(s=i??(n instanceof Error?n.name:void 0))!==null&&s!==void 0?s:"Unknown Error",this.code=r}}class Z0 extends Dn{constructor(t,r){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:r,message:t}),this.name="WebAuthnUnknownError",this.originalError=r}}function Oae({error:e,options:t}){var r,n,i;const{publicKey:s}=t;if(!s)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Dn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if(e.name==="ConstraintError"){if(((r=s.authenticatorSelection)===null||r===void 0?void 0:r.requireResidentKey)===!0)return new Dn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});if(t.mediation==="conditional"&&((n=s.authenticatorSelection)===null||n===void 0?void 0:n.userVerification)==="required")return new Dn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});if(((i=s.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new Dn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else{if(e.name==="InvalidStateError")return new Dn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});if(e.name==="NotAllowedError")return new Dn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="NotSupportedError")return s.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new Dn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}):new Dn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});if(e.name==="SecurityError"){const o=window.location.hostname;if(Y8(o)){if(s.rp.id!==o)return new Dn({message:`The RP ID "${s.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Dn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="TypeError"){if(s.user.id.byteLength<1||s.user.id.byteLength>64)return new Dn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if(e.name==="UnknownError")return new Dn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Dn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}function Nae({error:e,options:t}){const{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if(e.name==="AbortError"){if(t.signal instanceof AbortSignal)return new Dn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else{if(e.name==="NotAllowedError")return new Dn({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});if(e.name==="SecurityError"){const n=window.location.hostname;if(Y8(n)){if(r.rpId!==n)return new Dn({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else return new Dn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e})}else if(e.name==="UnknownError")return new Dn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e})}return new Dn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}class Lae{createNewAbortSignal(){if(this.controller){const r=new Error("Cancelling existing WebAuthn API call for new one");r.name="AbortError",this.controller.abort(r)}const t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){const t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}}const Bae=new Lae;function Hae(e){if(!e)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(e);const{challenge:t,user:r,excludeCredentials:n}=e,i=Tm(e,["challenge","user","excludeCredentials"]),s=sd(t).buffer,o=Object.assign(Object.assign({},r),{id:sd(r.id).buffer}),a=Object.assign(Object.assign({},i),{challenge:s,user:o});if(n&&n.length>0){a.excludeCredentials=new Array(n.length);for(let l=0;l<n.length;l++){const c=n[l];a.excludeCredentials[l]=Object.assign(Object.assign({},c),{id:sd(c.id).buffer,type:c.type||"public-key",transports:c.transports})}}return a}function jae(e){if(!e)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(e);const{challenge:t,allowCredentials:r}=e,n=Tm(e,["challenge","allowCredentials"]),i=sd(t).buffer,s=Object.assign(Object.assign({},n),{challenge:i});if(r&&r.length>0){s.allowCredentials=new Array(r.length);for(let o=0;o<r.length;o++){const a=r[o];s.allowCredentials[o]=Object.assign(Object.assign({},a),{id:sd(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return s}function Vae(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e;return{id:e.id,rawId:e.id,response:{attestationObject:rc(new Uint8Array(e.response.attestationObject)),clientDataJSON:rc(new Uint8Array(e.response.clientDataJSON))},type:"public-key",clientExtensionResults:e.getClientExtensionResults(),authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Gae(e){var t;if("toJSON"in e&&typeof e.toJSON=="function")return e.toJSON();const r=e,n=e.getClientExtensionResults(),i=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:rc(new Uint8Array(i.authenticatorData)),clientDataJSON:rc(new Uint8Array(i.clientDataJSON)),signature:rc(new Uint8Array(i.signature)),userHandle:i.userHandle?rc(new Uint8Array(i.userHandle)):void 0},type:"public-key",clientExtensionResults:n,authenticatorAttachment:(t=r.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Y8(e){return e==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function KE(){var e,t;return!!(ei()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}async function zae(e){try{const t=await navigator.credentials.create(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Z0("Browser returned unexpected credential type",t)}:{data:null,error:new Z0("Empty credential response",t)}}catch(t){return{data:null,error:Oae({error:t,options:e})}}}async function Uae(e){try{const t=await navigator.credentials.get(e);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Z0("Browser returned unexpected credential type",t)}:{data:null,error:new Z0("Empty credential response",t)}}catch(t){return{data:null,error:Nae({error:t,options:e})}}}const Wae={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},$ae={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function J0(...e){const t=i=>i!==null&&typeof i=="object"&&!Array.isArray(i),r=i=>i instanceof ArrayBuffer||ArrayBuffer.isView(i),n={};for(const i of e)if(i)for(const s in i){const o=i[s];if(o!==void 0)if(Array.isArray(o))n[s]=o;else if(r(o))n[s]=o;else if(t(o)){const a=n[s];t(a)?n[s]=J0(a,o):n[s]=J0(o)}else n[s]=o}return n}function qae(e,t){return J0(Wae,e,t||{})}function Kae(e,t){return J0($ae,e,t||{})}class Xae{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(t){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))}async _challenge({factorId:t,webauthn:r,friendlyName:n,signal:i},s){var o;try{const{data:a,error:l}=await this.client.mfa.challenge({factorId:t,webauthn:r});if(!a)return{data:null,error:l};const c=i??Bae.createNewAbortSignal();if(a.webauthn.type==="create"){const{user:u}=a.webauthn.credential_options.publicKey;if(!u.name){const h=n;if(h)u.name=`${u.id}:${h}`;else{const f=(await this.client.getUser()).data.user,m=((o=f?.user_metadata)===null||o===void 0?void 0:o.name)||f?.email||f?.id||"User";u.name=`${u.id}:${m}`}}u.displayName||(u.displayName=u.name)}switch(a.webauthn.type){case"create":{const u=qae(a.webauthn.credential_options.publicKey,s?.create),{data:h,error:d}=await zae({publicKey:u,signal:c});return h?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}case"request":{const u=Kae(a.webauthn.credential_options.publicKey,s?.request),{data:h,error:d}=await Uae(Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:u,signal:c}));return h?{data:{factorId:t,challengeId:a.id,webauthn:{type:a.webauthn.type,credential_response:h}},error:null}:{data:null,error:d}}}}catch(a){return Rt(a)?{data:null,error:a}:{data:null,error:new Ql("Unexpected error in challenge",a)}}}async _verify({challengeId:t,factorId:r,webauthn:n}){return this.client.mfa.verify({factorId:r,challengeId:t,webauthn:n})}async _authenticate({factorId:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Bf("rpId is required for WebAuthn authentication")};try{if(!KE())return{data:null,error:new Ql("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this.challenge({factorId:t,webauthn:{rpId:r,rpOrigins:n},signal:i},{request:s});if(!o)return{data:null,error:a};const{webauthn:l}=o;return this._verify({factorId:t,challengeId:o.challengeId,webauthn:{type:l.type,rpId:r,rpOrigins:n,credential_response:l.credential_response}})}catch(o){return Rt(o)?{data:null,error:o}:{data:null,error:new Ql("Unexpected error in authenticate",o)}}}async _register({friendlyName:t,webauthn:{rpId:r=typeof window<"u"?window.location.hostname:void 0,rpOrigins:n=typeof window<"u"?[window.location.origin]:void 0,signal:i}={}},s){if(!r)return{data:null,error:new Bf("rpId is required for WebAuthn registration")};try{if(!KE())return{data:null,error:new Ql("Browser does not support WebAuthn",null)};const{data:o,error:a}=await this._enroll({friendlyName:t});if(!o)return await this.client.mfa.listFactors().then(u=>{var h;return(h=u.data)===null||h===void 0?void 0:h.all.find(d=>d.factor_type==="webauthn"&&d.friendly_name===t&&d.status!=="unverified")}).then(u=>u?this.client.mfa.unenroll({factorId:u?.id}):void 0),{data:null,error:a};const{data:l,error:c}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:r,rpOrigins:n},signal:i},{create:s});return l?this._verify({factorId:o.id,challengeId:l.challengeId,webauthn:{rpId:r,rpOrigins:n,type:l.webauthn.type,credential_response:l.webauthn.credential_response}}):{data:null,error:c}}catch(o){return Rt(o)?{data:null,error:o}:{data:null,error:new Ql("Unexpected error in register",o)}}}}Mae();const Yae={url:qoe,storageKey:Koe,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Xoe,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4,skipAutoInitialize:!1};async function XE(e,t,r){return await r()}const Eu={};class Hf{get jwks(){var t,r;return(r=(t=Eu[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&r!==void 0?r:{keys:[]}}set jwks(t){Eu[this.storageKey]=Object.assign(Object.assign({},Eu[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,r;return(r=(t=Eu[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&r!==void 0?r:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Eu[this.storageKey]=Object.assign(Object.assign({},Eu[this.storageKey]),{cachedAt:t})}constructor(t){var r,n,i;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const s=Object.assign(Object.assign({},Yae),t);if(this.storageKey=s.storageKey,this.instanceID=(r=Hf.nextInstanceID[this.storageKey])!==null&&r!==void 0?r:0,Hf.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.instanceID>0&&ei()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=s.persistSession,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Aae({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=q8(s.fetch),this.lock=s.lock||XE,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,this.throwOnError=s.throwOnError,this.lockAcquireTimeout=s.lockAcquireTimeout,s.lock?this.lock=s.lock:this.persistSession&&ei()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=Fae:this.lock=XE,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Xae(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:$8()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=$E(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=$E(this.memoryStorage)),ei()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(i=this.broadcastChannel)===null||i===void 0||i.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o);try{await this._notifyAllSubscribers(o.data.event,o.data.session,!1)}catch(a){this._debug("#broadcastChannel","error",a)}})}s.skipAutoInitialize||this.initialize().catch(o=>{this._debug("#initialize()","error",o)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(t){if(this.throwOnError&&t&&t.error)throw t.error;return t}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${z8}) ${new Date().toISOString()}`}_debug(...t){return this.logDebugMessages&&this.logger(this._logPrefix(),...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{let r={},n="none";if(ei()&&(r=cae(window.location.href),this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce")),ei()&&this.detectSessionInUrl&&n!=="none"){const{data:i,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),eae(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return{error:s}}const{session:o,redirectType:a}=i;return this._debug("#_initialize()","detected session in URL",o,"redirect type",a),await this._saveSession(o),setTimeout(async()=>{a==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Rt(r)?this._returnResult({error:r}):this._returnResult({error:new Ql("Unexpected error during initialization",r)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,i;try{const s=await Vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t?.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(i=t?.options)===null||i===void 0?void 0:i.captchaToken}},xform:Bs}),{data:o,error:a}=s;if(a||!o)return this._returnResult({data:{user:null,session:null},error:a});const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(Rt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signUp(t){var r,n,i;try{let s;if("email"in t){const{email:u,password:h,options:d}=t;let f=null,m=null;this.flowType==="pkce"&&([f,m]=await xu(this.storage,this.storageKey)),s=await Vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:d?.emailRedirectTo,body:{email:u,password:h,data:(r=d?.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:d?.captchaToken},code_challenge:f,code_challenge_method:m},xform:Bs})}else if("phone"in t){const{phone:u,password:h,options:d}=t;s=await Vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:u,password:h,data:(n=d?.data)!==null&&n!==void 0?n:{},channel:(i=d?.channel)!==null&&i!==void 0?i:"sms",gotrue_meta_security:{captcha_token:d?.captchaToken}},xform:Bs})}else throw new jg("You must provide either an email or phone number and a password");const{data:o,error:a}=s;if(a||!o)return await Zn(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:a});const l=o.session,c=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(s){if(await Zn(this.storage,`${this.storageKey}-code-verifier`),Rt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:o,options:a}=t;r=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:UE})}else if("phone"in t){const{phone:s,password:o,options:a}=t;r=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:o,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:UE})}else throw new jg("You must provide either an email or phone number and a password");const{data:n,error:i}=r;if(i)return this._returnResult({data:{user:null,session:null},error:i});if(!n||!n.session||!n.user){const s=new Cu;return this._returnResult({data:{user:null,session:null},error:s})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:i})}catch(r){if(Rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOAuth(t){var r,n,i,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(i=t.options)===null||i===void 0?void 0:i.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:r}=t;switch(r){case"ethereum":return await this.signInWithEthereum(t);case"solana":return await this.signInWithSolana(t);default:throw new Error(`@supabase/auth-js: Unsupported chain "${r}"`)}}async signInWithEthereum(t){var r,n,i,s,o,a,l,c,u,h,d;let f,m;if("message"in t)f=t.message,m=t.signature;else{const{chain:v,wallet:g,statement:w,options:y}=t;let C;if(ei())if(typeof g=="object")C=g;else{const L=window;if("ethereum"in L&&typeof L.ethereum=="object"&&"request"in L.ethereum&&typeof L.ethereum.request=="function")C=L.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof g!="object"||!y?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");C=g}const k=new URL((r=y?.url)!==null&&r!==void 0?r:window.location.href),F=await C.request({method:"eth_requestAccounts"}).then(L=>L).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!F||F.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=X8(F[0]);let N=(n=y?.signInWithEthereum)===null||n===void 0?void 0:n.chainId;if(!N){const L=await C.request({method:"eth_chainId"});N=Dae(L)}const j={domain:k.host,address:I,statement:w,uri:k.href,version:"1",chainId:N,nonce:(i=y?.signInWithEthereum)===null||i===void 0?void 0:i.nonce,issuedAt:(o=(s=y?.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(a=y?.signInWithEthereum)===null||a===void 0?void 0:a.expirationTime,notBefore:(l=y?.signInWithEthereum)===null||l===void 0?void 0:l.notBefore,requestId:(c=y?.signInWithEthereum)===null||c===void 0?void 0:c.requestId,resources:(u=y?.signInWithEthereum)===null||u===void 0?void 0:u.resources};f=Iae(j),m=await C.request({method:"personal_sign",params:[Pae(f),I]})}try{const{data:v,error:g}=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:f,signature:m},!((h=t.options)===null||h===void 0)&&h.captchaToken?{gotrue_meta_security:{captcha_token:(d=t.options)===null||d===void 0?void 0:d.captchaToken}}:null),xform:Bs});if(g)throw g;if(!v||!v.session||!v.user){const w=new Cu;return this._returnResult({data:{user:null,session:null},error:w})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:g})}catch(v){if(Rt(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async signInWithSolana(t){var r,n,i,s,o,a,l,c,u,h,d,f;let m,v;if("message"in t)m=t.message,v=t.signature;else{const{chain:g,wallet:w,statement:y,options:C}=t;let k;if(ei())if(typeof w=="object")k=w;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))k=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof w!="object"||!C?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=w}const F=new URL((r=C?.url)!==null&&r!==void 0?r:window.location.href);if("signIn"in k&&k.signIn){const I=await k.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C?.signInWithSolana),{version:"1",domain:F.host,uri:F.href}),y?{statement:y}:null));let N;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")N=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)N=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in N&&"signature"in N&&(typeof N.signedMessage=="string"||N.signedMessage instanceof Uint8Array)&&N.signature instanceof Uint8Array)m=typeof N.signedMessage=="string"?N.signedMessage:new TextDecoder().decode(N.signedMessage),v=N.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in k)||typeof k.signMessage!="function"||!("publicKey"in k)||typeof k!="object"||!k.publicKey||!("toBase58"in k.publicKey)||typeof k.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");m=[`${F.host} wants you to sign in with your Solana account:`,k.publicKey.toBase58(),...y?["",y,""]:[""],"Version: 1",`URI: ${F.href}`,`Issued At: ${(i=(n=C?.signInWithSolana)===null||n===void 0?void 0:n.issuedAt)!==null&&i!==void 0?i:new Date().toISOString()}`,...!((s=C?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((o=C?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((a=C?.signInWithSolana)===null||a===void 0)&&a.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((l=C?.signInWithSolana)===null||l===void 0)&&l.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((c=C?.signInWithSolana)===null||c===void 0)&&c.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((h=(u=C?.signInWithSolana)===null||u===void 0?void 0:u.resources)===null||h===void 0)&&h.length?["Resources",...C.signInWithSolana.resources.map(N=>`- ${N}`)]:[]].join(`
`);const I=await k.signMessage(new TextEncoder().encode(m),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=I}}try{const{data:g,error:w}=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:m,signature:rc(v)},!((d=t.options)===null||d===void 0)&&d.captchaToken?{gotrue_meta_security:{captcha_token:(f=t.options)===null||f===void 0?void 0:f.captchaToken}}:null),xform:Bs});if(w)throw w;if(!g||!g.session||!g.user){const y=new Cu;return this._returnResult({data:{user:null,session:null},error:y})}return g.session&&(await this._saveSession(g.session),await this._notifyAllSubscribers("SIGNED_IN",g.session)),this._returnResult({data:Object.assign({},g),error:w})}catch(g){if(Rt(g))return this._returnResult({data:{user:null,session:null},error:g});throw g}}async _exchangeCodeForSession(t){const r=await Wl(this.storage,`${this.storageKey}-code-verifier`),[n,i]=(r??"").split("/");try{if(!n&&this.flowType==="pkce")throw new tae;const{data:s,error:o}=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Bs});if(await Zn(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!s||!s.session||!s.user){const a=new Cu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:a})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign(Object.assign({},s),{redirectType:i??null}),error:o})}catch(s){if(await Zn(this.storage,`${this.storageKey}-code-verifier`),Rt(s))return this._returnResult({data:{user:null,session:null,redirectType:null},error:s});throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:i,access_token:s,nonce:o}=t,a=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:i,access_token:s,nonce:o,gotrue_meta_security:{captcha_token:r?.captchaToken}},xform:Bs}),{data:l,error:c}=a;if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l||!l.session||!l.user){const u=new Cu;return this._returnResult({data:{user:null,session:null},error:u})}return l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),this._returnResult({data:l,error:c})}catch(r){if(Rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithOtp(t){var r,n,i,s,o;try{if("email"in t){const{email:a,options:l}=t;let c=null,u=null;this.flowType==="pkce"&&([c,u]=await xu(this.storage,this.storageKey));const{error:h}=await Vt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:a,data:(r=l?.data)!==null&&r!==void 0?r:{},create_user:(n=l?.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},code_challenge:c,code_challenge_method:u},redirectTo:l?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:h})}if("phone"in t){const{phone:a,options:l}=t,{data:c,error:u}=await Vt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:a,data:(i=l?.data)!==null&&i!==void 0?i:{},create_user:(s=l?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l?.captchaToken},channel:(o=l?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:c?.message_id},error:u})}throw new jg("You must provide either an email or phone number.")}catch(a){if(await Zn(this.storage,`${this.storageKey}-code-verifier`),Rt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async verifyOtp(t){var r,n;try{let i,s;"options"in t&&(i=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:o,error:a}=await Vt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:i,xform:Bs});if(a)throw a;if(!o)throw new Error("An error occurred on token verification.");const l=o.session,c=o.user;return l?.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),this._returnResult({data:{user:c,session:l},error:null})}catch(i){if(Rt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithSSO(t){var r,n,i,s,o;try{let a=null,l=null;this.flowType==="pkce"&&([a,l]=await xu(this.storage,this.storageKey));const c=await Vt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((i=t?.options)===null||i===void 0)&&i.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:this.headers,xform:Tae});return!((s=c.data)===null||s===void 0)&&s.url&&ei()&&!(!((o=t.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(c.data.url),this._returnResult(c)}catch(a){if(await Zn(this.storage,`${this.storageKey}-code-verifier`),Rt(a))return this._returnResult({data:null,error:a});throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Yi;const{error:i}=await Vt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return this._returnResult({data:{user:null,session:null},error:i})})}catch(t){if(Rt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:i,options:s}=t,{error:o}=await Vt(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:i,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in t){const{phone:n,type:i,options:s}=t,{data:o,error:a}=await Vt(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:i,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:a})}throw new jg("You must provide either an email or phone number and a type")}catch(r){if(Rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),i=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await i}catch{}})()),i}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const i=[...this.pendingInLock];await Promise.all(i),this.pendingInLock.splice(0,i.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await Wl(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<Nb:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.userStorage){const o=await Wl(this.userStorage,this.storageKey+"-user");o?.user?t.user=o.user:t.user=Hb()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};t.user=xae(t.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{session:null},error:s}):this._returnResult({data:{session:i},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(t){if(t)return await this._getUser(t);await this.initializePromise;const r=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return r.data.user&&(this.suppressGetSessionWarning=!0),r}async _getUser(t){try{return t?await Vt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Qa}):await this._useSession(async r=>{var n,i,s;const{data:o,error:a}=r;if(a)throw a;return!(!((n=o.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Yi}:await Vt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(i=o.session)===null||i===void 0?void 0:i.access_token)!==null&&s!==void 0?s:void 0,xform:Qa})})}catch(r){if(Rt(r))return Lb(r)&&(await this._removeSession(),await Zn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:r});throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:i,error:s}=n;if(s)throw s;if(!i.session)throw new Yi;const o=i.session;let a=null,l=null;this.flowType==="pkce"&&t.email!=null&&([a,l]=await xu(this.storage,this.storageKey));const{data:c,error:u}=await Vt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r?.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:a,code_challenge_method:l}),jwt:o.access_token,xform:Qa});if(u)throw u;return o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(n){if(await Zn(this.storage,`${this.storageKey}-code-verifier`),Rt(n))return this._returnResult({data:{user:null},error:n});throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Yi;const r=Date.now()/1e3;let n=r,i=!0,s=null;const{payload:o}=Gg(t.access_token);if(o.exp&&(n=o.exp,i=n<=r),i){const{data:a,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});if(!a)return{data:{user:null,session:null},error:null};s=a}else{const{data:a,error:l}=await this._getUser(t.access_token);if(l)return this._returnResult({data:{user:null,session:null},error:l});s={access_token:t.access_token,refresh_token:t.refresh_token,user:a.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return this._returnResult({data:{user:s.user,session:s},error:null})}catch(r){if(Rt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:o,error:a}=r;if(a)throw a;t=(n=o.session)!==null&&n!==void 0?n:void 0}if(!t?.refresh_token)throw new Yi;const{data:i,error:s}=await this._callRefreshToken(t.refresh_token);return s?this._returnResult({data:{user:null,session:null},error:s}):i?this._returnResult({data:{user:i.user,session:i},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(r){if(Rt(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async _getSessionFromURL(t,r){try{if(!ei())throw new Vg("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Vg(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new LE("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Vg("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new LE("No code detected.");const{data:y,error:C}=await this._exchangeCodeForSession(t.code);if(C)throw C;const k=new URL(window.location.href);return k.searchParams.delete("code"),window.history.replaceState(window.history.state,"",k.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:i,access_token:s,refresh_token:o,expires_in:a,expires_at:l,token_type:c}=t;if(!s||!a||!o||!c)throw new Vg("No session defined in URL");const u=Math.round(Date.now()/1e3),h=parseInt(a);let d=u+h;l&&(d=parseInt(l));const f=d-u;f*1e3<=Fu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${f}s, should have been closer to ${h}s`);const m=d-h;u-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,d,u):u-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,d,u);const{data:v,error:g}=await this._getUser(s);if(g)throw g;const w={provider_token:n,provider_refresh_token:i,access_token:s,expires_in:h,expires_at:d,refresh_token:o,token_type:c,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:w,redirectType:t.type},error:null})}catch(n){if(Rt(n))return this._returnResult({data:{session:null,redirectType:null},error:n});throw n}}_isImplicitGrantCallback(t){return typeof this.detectSessionInUrl=="function"?this.detectSessionInUrl(new URL(window.location.href),t):!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await Wl(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s&&!Lb(s))return this._returnResult({error:s});const o=(n=i.session)===null||n===void 0?void 0:n.access_token;if(o){const{error:a}=await this.admin.signOut(o,t);if(a&&!(Qoe(a)&&(a.status===404||a.status===401||a.status===403)||Lb(a)))return this._returnResult({error:a})}return t!=="others"&&(await this._removeSession(),await Zn(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(t){const r=lae(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,i;try{const{data:{session:s},error:o}=r;if(o)throw o;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((i=this.stateChangeEmitters.get(t))===null||i===void 0?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,i=null;this.flowType==="pkce"&&([n,i]=await xu(this.storage,this.storageKey,!0));try{return await Vt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:i,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(await Zn(this.storage,`${this.storageKey}-code-verifier`),Rt(s))return this._returnResult({data:null,error:s});throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return this._returnResult({data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async linkIdentity(t){return"token"in t?this.linkIdentityIdToken(t):this.linkIdentityOAuth(t)}async linkIdentityOAuth(t){var r;try{const{data:n,error:i}=await this._useSession(async s=>{var o,a,l,c,u;const{data:h,error:d}=s;if(d)throw d;const f=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(a=t.options)===null||a===void 0?void 0:a.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Vt(this.fetch,"GET",f,{headers:this.headers,jwt:(u=(c=h.session)===null||c===void 0?void 0:c.access_token)!==null&&u!==void 0?u:void 0})});if(i)throw i;return ei()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n?.url),this._returnResult({data:{provider:t.provider,url:n?.url},error:null})}catch(n){if(Rt(n))return this._returnResult({data:{provider:t.provider,url:null},error:n});throw n}}async linkIdentityIdToken(t){return await this._useSession(async r=>{var n;try{const{error:i,data:{session:s}}=r;if(i)throw i;const{options:o,provider:a,token:l,access_token:c,nonce:u}=t,h=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(n=s?.access_token)!==null&&n!==void 0?n:void 0,body:{provider:a,id_token:l,access_token:c,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Bs}),{data:d,error:f}=h;return f?this._returnResult({data:{user:null,session:null},error:f}):!d||!d.session||!d.user?this._returnResult({data:{user:null,session:null},error:new Cu}):(d.session&&(await this._saveSession(d.session),await this._notifyAllSubscribers("USER_UPDATED",d.session)),this._returnResult({data:d,error:f}))}catch(i){if(await Zn(this.storage,`${this.storageKey}-code-verifier`),Rt(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}})}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:o}=r;if(o)throw o;return await Vt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(i=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&i!==void 0?i:void 0})})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await hae(async i=>(i>0&&await dae(200*Math.pow(2,i-1)),this._debug(r,"refreshing attempt",i),await Vt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Bs})),(i,s)=>{const o=200*Math.pow(2,i);return s&&Bb(s)&&Date.now()+o-n<Fu})}catch(n){if(this._debug(r,"error",n),Rt(n))return this._returnResult({data:{session:null,user:null},error:n});throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),ei()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t,r;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const i=await Wl(this.storage,this.storageKey);if(i&&this.userStorage){let o=await Wl(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:i.user},await Mu(this.userStorage,this.storageKey+"-user",o)),i.user=(t=o?.user)!==null&&t!==void 0?t:Hb()}else if(i&&!i.user&&!i.user){const o=await Wl(this.storage,this.storageKey+"-user");o&&o?.user?(i.user=o.user,await Zn(this.storage,this.storageKey+"-user"),await Mu(this.storage,this.storageKey,i)):i.user=Hb()}if(this._debug(n,"session from storage",i),!this._isValidSession(i)){this._debug(n,"session is not valid"),i!==null&&await this._removeSession();return}const s=((r=i.expires_at)!==null&&r!==void 0?r:1/0)*1e3-Date.now()<Nb;if(this._debug(n,`session has${s?"":" not"} expired with margin of ${Nb}s`),s){if(this.autoRefreshToken&&i.refresh_token){const{error:o}=await this._callRefreshToken(i.refresh_token);o&&(console.error(o),Bb(o)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(i.user&&i.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:a}=await this._getUser(i.access_token);!a&&o?.user?(i.user=o.user,await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)):this._debug(n,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(n,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",i)}catch(i){this._debug(n,"error",i),console.error(i);return}finally{this._debug(n,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Yi;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const i=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new Am;const{data:s,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!s.session)throw new Yi;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const a={data:s.session,error:null};return this.refreshingDeferred.resolve(a),a}catch(s){if(this._debug(i,"error",s),Rt(s)){const o={data:null,error:s};return Bb(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(o),o}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(t,r,n=!0){const i=`#_notifyAllSubscribers(${t})`;this._debug(i,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],o=Array.from(this.stateChangeEmitters.values()).map(async a=>{try{await a.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(o),s.length>0){for(let a=0;a<s.length;a+=1)console.error(s[a]);throw s[0]}}finally{this._debug(i,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await Zn(this.storage,`${this.storageKey}-code-verifier`);const r=Object.assign({},t),n=r.user&&r.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!n&&r.user&&await Mu(this.userStorage,this.storageKey+"-user",{user:r.user});const i=Object.assign({},r);delete i.user;const s=GE(i);await Mu(this.storage,this.storageKey,s)}else{const i=GE(r);await Mu(this.storage,this.storageKey,i)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await Zn(this.storage,this.storageKey),await Zn(this.storage,this.storageKey+"-code-verifier"),await Zn(this.storage,this.storageKey+"-user"),this.userStorage&&await Zn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&ei()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Fu);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t);const r=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=r,r&&typeof r=="object"&&typeof r.unref=="function"?r.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(r)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t);const r=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,r&&clearTimeout(r)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const i=Math.floor((n.expires_at*1e3-t)/Fu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts ${Fu}ms, refresh threshold is ${$w} ticks`),i<=$w&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof K8)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ei()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(t){this._debug("#visibilityChangedCallback","error",t)}},window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const i=[`provider=${encodeURIComponent(r)}`];if(n?.redirectTo&&i.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n?.scopes&&i.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,o]=await xu(this.storage,this.storageKey),a=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(o)}`});i.push(a.toString())}if(n?.queryParams){const s=new URLSearchParams(n.queryParams);i.push(s.toString())}return n?.skipBrowserRedirect&&i.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${i.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;return s?this._returnResult({data:null,error:s}):await Vt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,i;const{data:s,error:o}=r;if(o)return this._returnResult({data:null,error:o});const a=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:t.factorType==="totp"?{issuer:t.issuer}:{}),{data:l,error:c}=await Vt(this.fetch,"POST",`${this.url}/factors`,{body:a,headers:this.headers,jwt:(n=s?.session)===null||n===void 0?void 0:n.access_token});return c?this._returnResult({data:null,error:c}):(t.factorType==="totp"&&l.type==="totp"&&(!((i=l?.totp)===null||i===void 0)&&i.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),this._returnResult({data:l,error:null}))})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async _verify(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const o=Object.assign({challenge_id:t.challengeId},"webauthn"in t?{webauthn:Object.assign(Object.assign({},t.webauthn),{credential_response:t.webauthn.type==="create"?Vae(t.webauthn.credential_response):Gae(t.webauthn.credential_response)})}:{code:t.code}),{data:a,error:l}=await Vt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:o,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});return l?this._returnResult({data:null,error:l}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),this._returnResult({data:a,error:l}))})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}})}async _challenge(t){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async r=>{var n;const{data:i,error:s}=r;if(s)return this._returnResult({data:null,error:s});const o=await Vt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:t,headers:this.headers,jwt:(n=i?.session)===null||n===void 0?void 0:n.access_token});if(o.error)return o;const{data:a}=o;if(a.type!=="webauthn")return{data:a,error:null};switch(a.webauthn.type){case"create":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:Hae(a.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},a),{webauthn:Object.assign(Object.assign({},a.webauthn),{credential_options:Object.assign(Object.assign({},a.webauthn.credential_options),{publicKey:jae(a.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?this._returnResult({data:null,error:n}):await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){var t;const{data:{user:r},error:n}=await this.getUser();if(n)return{data:null,error:n};const i={all:[],phone:[],totp:[],webauthn:[]};for(const s of(t=r?.factors)!==null&&t!==void 0?t:[])i.all.push(s),s.status==="verified"&&i[s.factor_type].push(s);return{data:i,error:null}}async _getAuthenticatorAssuranceLevel(t){var r,n,i,s;if(t)try{const{payload:f}=Gg(t);let m=null;f.aal&&(m=f.aal);let v=m;const{data:{user:g},error:w}=await this.getUser(t);if(w)return this._returnResult({data:null,error:w});((n=(r=g?.factors)===null||r===void 0?void 0:r.filter(k=>k.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(v="aal2");const C=f.amr||[];return{data:{currentLevel:m,nextLevel:v,currentAuthenticationMethods:C},error:null}}catch(f){if(Rt(f))return this._returnResult({data:null,error:f});throw f}const{data:{session:o},error:a}=await this.getSession();if(a)return this._returnResult({data:null,error:a});if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:l}=Gg(o.access_token);let c=null;l.aal&&(c=l.aal);let u=c;((s=(i=o.user.factors)===null||i===void 0?void 0:i.filter(f=>f.status==="verified"))!==null&&s!==void 0?s:[]).length>0&&(u="aal2");const d=l.amr||[];return{data:{currentLevel:c,nextLevel:u,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?await Vt(this.fetch,"GET",`${this.url}/oauth/authorizations/${t}`,{headers:this.headers,jwt:n.access_token,xform:s=>({data:s,error:null})}):this._returnResult({data:null,error:new Yi})})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async _approveAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Yi});const o=await Vt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"approve"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&ei()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Rt(n))return this._returnResult({data:null,error:n});throw n}}async _denyAuthorization(t,r){try{return await this._useSession(async n=>{const{data:{session:i},error:s}=n;if(s)return this._returnResult({data:null,error:s});if(!i)return this._returnResult({data:null,error:new Yi});const o=await Vt(this.fetch,"POST",`${this.url}/oauth/authorizations/${t}/consent`,{headers:this.headers,jwt:i.access_token,body:{action:"deny"},xform:a=>({data:a,error:null})});return o.data&&o.data.redirect_url&&ei()&&!r?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(n){if(Rt(n))return this._returnResult({data:null,error:n});throw n}}async _listOAuthGrants(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;return n?this._returnResult({data:null,error:n}):r?await Vt(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Yi})})}catch(t){if(Rt(t))return this._returnResult({data:null,error:t});throw t}}async _revokeOAuthGrant(t){try{return await this._useSession(async r=>{const{data:{session:n},error:i}=r;return i?this._returnResult({data:null,error:i}):n?(await Vt(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:n.access_token,query:{client_id:t.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new Yi})})}catch(r){if(Rt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(a=>a.kid===t);if(n)return n;const i=Date.now();if(n=this.jwks.keys.find(a=>a.kid===t),n&&this.jwks_cached_at+Zoe>i)return n;const{data:s,error:o}=await Vt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!s.keys||s.keys.length===0||(this.jwks=s,this.jwks_cached_at=i,n=s.keys.find(a=>a.kid===t),!n)?null:n}async getClaims(t,r={}){try{let n=t;if(!n){const{data:f,error:m}=await this.getSession();if(m||!f.session)return this._returnResult({data:null,error:m});n=f.session.access_token}const{header:i,payload:s,signature:o,raw:{header:a,payload:l}}=Gg(n);r?.allowExpired||wae(s.exp);const c=!i.alg||i.alg.startsWith("HS")||!i.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(i.kid,r?.keys?{keys:r.keys}:r?.jwks);if(!c){const{error:f}=await this.getUser(n);if(f)throw f;return{data:{claims:s,header:i,signature:o},error:null}}const u=yae(i.alg),h=await crypto.subtle.importKey("jwk",c,u,!0,["verify"]);if(!await crypto.subtle.verify(u,h,o,oae(`${a}.${l}`)))throw new Xw("Invalid JWT signature");return{data:{claims:s,header:i,signature:o},error:null}}catch(n){if(Rt(n))return this._returnResult({data:null,error:n});throw n}}}Hf.nextInstanceID={};const Zae=Hf,Jae="2.97.0";let Oh="";typeof Deno<"u"?Oh="deno":typeof document<"u"?Oh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Oh="react-native":Oh="node";const Qae={"X-Client-Info":`supabase-js-${Oh}/${Jae}`},ele={headers:Qae},tle={schema:"public"},rle={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},nle={};function jf(e){"@babel/helpers - typeof";return jf=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jf(e)}function ile(e,t){if(jf(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(jf(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sle(e){var t=ile(e,"string");return jf(t)=="symbol"?t:t+""}function ole(e,t,r){return(t=sle(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YE(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function cn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?YE(Object(r),!0).forEach(function(n){ole(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):YE(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}const ale=e=>e?(...t)=>e(...t):(...t)=>fetch(...t),lle=()=>Headers,cle=(e,t,r)=>{const n=ale(r),i=lle();return async(s,o)=>{var a;const l=(a=await t())!==null&&a!==void 0?a:e;let c=new i(o?.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,cn(cn({},o),{},{headers:c}))}};function ule(e){return e.endsWith("/")?e:e+"/"}function dle(e,t){var r,n;const{db:i,auth:s,realtime:o,global:a}=e,{db:l,auth:c,realtime:u,global:h}=t,d={db:cn(cn({},l),i),auth:cn(cn({},c),s),realtime:cn(cn({},u),o),storage:{},global:cn(cn(cn({},h),a),{},{headers:cn(cn({},(r=h?.headers)!==null&&r!==void 0?r:{}),(n=a?.headers)!==null&&n!==void 0?n:{})}),accessToken:async()=>""};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}function hle(e){const t=e?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(ule(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}var fle=class extends Zae{constructor(e){super(e)}},ple=class{constructor(e,t,r){var n,i;this.supabaseUrl=e,this.supabaseKey=t;const s=hle(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",s),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",s),this.storageUrl=new URL("storage/v1",s),this.functionsUrl=new URL("functions/v1",s);const o=`sb-${s.hostname.split(".")[0]}-auth-token`,a={db:tle,realtime:nle,auth:cn(cn({},rle),{},{storageKey:o}),global:ele},l=dle(r??{},a);if(this.storageKey=(n=l.auth.storageKey)!==null&&n!==void 0?n:"",this.headers=(i=l.global.headers)!==null&&i!==void 0?i:{},l.accessToken)this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(u,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}});else{var c;this.auth=this._initSupabaseAuthClient((c=l.auth)!==null&&c!==void 0?c:{},this.headers,l.global.fetch)}this.fetch=cle(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(cn({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(u=>this.realtime.setAuth(u)).catch(u=>console.warn("Failed to set initial Realtime auth token:",u)),this.rest=new Qse(new URL("rest/v1",s).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch,timeout:l.db.timeout,urlLengthLimit:l.db.urlLengthLimit}),this.storage=new $oe(this.storageUrl.href,this.headers,this.fetch,r?.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new Wse(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e=this,t,r;if(e.accessToken)return await e.accessToken();const{data:n}=await e.auth.getSession();return(t=(r=n.session)===null||r===void 0?void 0:r.access_token)!==null&&t!==void 0?t:e.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,storageKey:s,flowType:o,lock:a,debug:l,throwOnError:c},u,h){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new fle({url:this.authUrl.href,headers:cn(cn({},d),u),storageKey:s,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:n,userStorage:i,flowType:o,lock:a,debug:l,throwOnError:c,fetch:h,hasCustomAuthorizationHeader:Object.keys(this.headers).some(f=>f.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new moe(this.realtimeUrl.href,cn(cn({},e),{},{params:cn(cn({},{apikey:this.supabaseKey}),e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",t?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};const gle=(e,t,r)=>new ple(e,t,r);function mle(){if(typeof window<"u")return!1;const e=globalThis.process;if(!e)return!1;const t=e.version;if(t==null)return!1;const r=t.match(/^v(\d+)\./);return r?parseInt(r[1],10)<=18:!1}mle()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const vle="https://nvrcsheavwwrcukhtvcw.supabase.co",ble="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im52cmNzaGVhdnd3cmN1a2h0dmN3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzA3MzkyMDUsImV4cCI6MjA4NjMxNTIwNX0.0ndDO1K8c_WnP3FQumSCoWf-XGlBsrBfJXlCNMplGSE",Yt=gle(vle,ble),wle={laminador1:[],laminador2:[],laminador3:[]},Rh=e=>({skuLaminacion:e.sku_laminacion,ending:e.ending,codigoProgramacion:e.codigo_programacion,descripcion:e.descripcion,skuPalanquilla:e.sku_palanquilla,calidadPalanquilla:e.calidad_palanquilla,ritmoTH:Number(e.ritmo_th),rendimientoMetalico:Number(e.rendimiento_metalico),fam:e.fam,aciertoCalibracion:Number(e.acierto_calibracion),idTablaCambioMedida:e.id_tabla_cambio_medida,pesoPalanquilla:Number(e.peso_palanquilla),almacenDestino:e.almacen_destino,comentarios:e.comentarios,id:e.id}),Vb=(e,t)=>({process_id:e,sku_laminacion:t.skuLaminacion,ending:t.ending,codigo_programacion:t.codigoProgramacion,descripcion:t.descripcion,sku_palanquilla:t.skuPalanquilla,calidad_palanquilla:t.calidadPalanquilla,ritmo_th:t.ritmoTH,rendimiento_metalico:t.rendimientoMetalico,fam:t.fam,acierto_calibracion:t.aciertoCalibracion,id_tabla_cambio_medida:t.idTablaCambioMedida,peso_palanquilla:t.pesoPalanquilla,almacen_destino:t.almacenDestino,comentarios:t.comentarios}),Ks=Em((e,t)=>({articlesByProcess:wle,loading:!1,getArticles:r=>t().articlesByProcess[r]||[],fetchArticles:async r=>{e({loading:!0});let n=[],i=0;const s=1e3;let o=!0;for(;o;){const{data:l,error:c}=await Yt.from("scheduler_articles").select("*").eq("process_id",r).range(i,i+s-1);if(c){console.error(`Error fetching articles for ${r}:`,c),e({loading:!1});return}l&&l.length>0?(n=[...n,...l],i+=s,l.length<s&&(o=!1)):o=!1}const a=n.map(Rh);e(l=>({articlesByProcess:{...l.articlesByProcess,[r]:a},loading:!1}))},fetchAllArticles:async()=>{e({loading:!0});const{data:r,error:n}=await Yt.from("scheduler_articles").select("*");if(n){console.error("Error fetching all articles:",n),e({loading:!1});return}const i={laminador1:[],laminador2:[],laminador3:[]};(r||[]).forEach(s=>{const o=s.process_id;i[o]&&i[o].push(Rh(s))}),e({articlesByProcess:i,loading:!1})},addArticle:async(r,n)=>{const{data:i,error:s}=await Yt.from("scheduler_articles").insert(Vb(r,n)).select().single();if(s){console.error("Error adding article:",s);return}e(o=>({articlesByProcess:{...o.articlesByProcess,[r]:[...o.articlesByProcess[r]||[],Rh(i)]}}))},setArticles:async(r,n)=>{e({loading:!0});const{error:i}=await Yt.from("scheduler_articles").delete().eq("process_id",r);if(i){console.error("Error deleting old articles:",i),e({loading:!1});return}const s=n.map(l=>Vb(r,l)),{data:o,error:a}=await Yt.from("scheduler_articles").insert(s).select();if(a){console.error("Error inserting articles:",a),e({loading:!1});return}e(l=>({articlesByProcess:{...l.articlesByProcess,[r]:(o||[]).map(Rh)},loading:!1}))},updateArticle:async(r,n,i)=>{const{data:s,error:o}=await Yt.from("scheduler_articles").update(Vb(r,i)).eq("id",n).select().single();if(o){console.error("Error updating article:",o);return}e(a=>({articlesByProcess:{...a.articlesByProcess,[r]:(a.articlesByProcess[r]||[]).map(l=>l.id===n?Rh(s):l)}}))},deleteArticle:async(r,n)=>{const{error:i}=await Yt.from("scheduler_articles").delete().eq("id",n);if(i){console.error("Error deleting article:",i);return}e(s=>({articlesByProcess:{...s.articlesByProcess,[r]:(s.articlesByProcess[r]||[]).filter(o=>o.id!==n)}}))},deleteArticles:async(r,n)=>{const{error:i}=await Yt.from("scheduler_articles").delete().in("id",n);if(i){console.error("Error deleting articles:",i);return}e(s=>({articlesByProcess:{...s.articlesByProcess,[r]:(s.articlesByProcess[r]||[]).filter(o=>!n.includes(o.id))}}))}}));const Z8=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();const yle=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const Cle=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());const ZE=e=>{const t=Cle(e);return t.charAt(0).toUpperCase()+t.slice(1)};var xle={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Sle=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const _le=ae.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...a},l)=>ae.createElement("svg",{ref:l,...xle,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:Z8("lucide",i),...!s&&!Sle(a)&&{"aria-hidden":"true"},...a},[...o.map(([c,u])=>ae.createElement(c,u)),...Array.isArray(s)?s:[s]]));const Zt=(e,t)=>{const r=ae.forwardRef(({className:n,...i},s)=>ae.createElement(_le,{ref:s,iconNode:t,className:Z8(`lucide-${yle(ZE(e))}`,`lucide-${e}`,n),...i}));return r.displayName=ZE(e),r};const Ele=[["path",{d:"M12 17V3",key:"1cwfxf"}],["path",{d:"m6 11 6 6 6-6",key:"12ii2o"}],["path",{d:"M19 21H5",key:"150jfl"}]],Tle=Zt("arrow-down-to-line",Ele);const kle=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Rle=Zt("arrow-right-left",kle);const Ale=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],Fle=Zt("calculator",Ale);const Mle=[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]],J8=Zt("calendar-clock",Mle);const Dle=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],UC=Zt("calendar",Dle);const Ple=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Q8=Zt("chart-column",Ple);const Ile=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],JE=Zt("check",Ile);const Ole=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Nle=Zt("chevron-down",Ole);const Lle=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],Ble=Zt("chevron-left",Lle);const Hle=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],jle=Zt("chevron-right",Hle);const Vle=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],QE=Zt("circle-check",Vle);const Gle=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],sf=Zt("clock",Gle);const zle=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]],Ule=Zt("columns-2",zle);const Wle=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],eA=Zt("database",Wle);const $le=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Fm=Zt("download",$le);const qle=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Kle=Zt("eye",qle);const Xle=[["path",{d:"M12 16h.01",key:"1drbdi"}],["path",{d:"M16 16h.01",key:"1f9h7w"}],["path",{d:"M3 19a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.5a.5.5 0 0 0-.769-.422l-4.462 2.844A.5.5 0 0 1 15 10.5v-2a.5.5 0 0 0-.769-.422L9.77 10.922A.5.5 0 0 1 9 10.5V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2z",key:"1iv0i2"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],Yle=Zt("factory",Xle);const Zle=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],Jle=Zt("file-spreadsheet",Zle);const Qle=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ece=Zt("funnel",Qle);const tce=[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]],rce=Zt("gauge",tce);const nce=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],ice=Zt("layout-dashboard",nce);const sce=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}],["path",{d:"M14 4h7",key:"3xa0d5"}],["path",{d:"M14 9h7",key:"1icrd9"}],["path",{d:"M14 15h7",key:"1mj8o2"}],["path",{d:"M14 20h7",key:"11slyb"}]],Gb=Zt("layout-list",sce);const oce=[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]],ace=Zt("lightbulb",oce);const lce=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],cce=Zt("package",lce);const uce=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],dce=Zt("play",uce);const hce=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],kc=Zt("plus",hce);const fce=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],pce=Zt("refresh-cw",fce);const gce=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],tA=Zt("rotate-ccw",gce);const mce=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],vce=Zt("save",mce);const bce=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],wce=Zt("settings-2",bce);const yce=[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Cce=Zt("settings",yce);const xce=[["path",{d:"M11.017 2.814a1 1 0 0 1 1.966 0l1.051 5.558a2 2 0 0 0 1.594 1.594l5.558 1.051a1 1 0 0 1 0 1.966l-5.558 1.051a2 2 0 0 0-1.594 1.594l-1.051 5.558a1 1 0 0 1-1.966 0l-1.051-5.558a2 2 0 0 0-1.594-1.594l-5.558-1.051a1 1 0 0 1 0-1.966l5.558-1.051a2 2 0 0 0 1.594-1.594z",key:"1s2grr"}],["path",{d:"M20 2v4",key:"1rf3ol"}],["path",{d:"M22 4h-4",key:"gwowj6"}],["circle",{cx:"4",cy:"20",r:"2",key:"6kqj1y"}]],Sce=Zt("sparkles",xce);const _ce=[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]],Ece=Zt("table",_ce);const Tce=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],kce=Zt("tag",Tce);const Rce=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Ace=Zt("timer",Rce);const Fce=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],sl=Zt("trash-2",Fce);const Mce=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Dce=Zt("trending-down",Mce);const Pce=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Ice=Zt("trending-up",Pce);const Oce=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],Nce=Zt("triangle-alert",Oce);const Lce=[["path",{d:"M9 14 4 9l5-5",key:"102s5s"}],["path",{d:"M4 9h10.5a5.5 5.5 0 0 1 5.5 5.5a5.5 5.5 0 0 1-5.5 5.5H11",key:"f3b9sd"}]],Bce=Zt("undo-2",Lce);const Hce=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],WC=Zt("upload",Hce);const jce=[["circle",{cx:"12",cy:"5",r:"3",key:"rqqgnr"}],["path",{d:"M6.5 8a2 2 0 0 0-1.905 1.46L2.1 18.5A2 2 0 0 0 4 21h16a2 2 0 0 0 1.925-2.54L19.4 9.5A2 2 0 0 0 17.48 8Z",key:"56o5sh"}]],Vce=Zt("weight",jce);const Gce=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],rA=Zt("x",Gce);const zce=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Uce=Zt("zap",zce),Wce={laminador1:[],laminador2:[],laminador3:[]},Ah=e=>({fromId:e.from_id,toId:e.to_id,durationHours:Number(e.duration_hours),id:e.id}),zb=(e,t)=>({process_id:e,from_id:t.fromId,to_id:t.toId,duration_hours:t.durationHours}),aa=Em((e,t)=>({rulesByProcess:Wce,loading:!1,getRules:r=>t().rulesByProcess[r]||[],fetchRules:async r=>{e({loading:!0});let n=[],i=0;const s=1e3;let o=!0;for(;o;){const{data:l,error:c}=await Yt.from("scheduler_changeover_rules").select("*").eq("process_id",r).range(i,i+s-1);if(c){console.error("Error fetching rules:",c),e({loading:!1});return}l&&l.length>0?(n=[...n,...l],i+=s,l.length<s&&(o=!1)):o=!1}const a=n.map(Ah);e(l=>({rulesByProcess:{...l.rulesByProcess,[r]:a},loading:!1}))},fetchAllRules:async()=>{e({loading:!0});const{data:r,error:n}=await Yt.from("scheduler_changeover_rules").select("*");if(n){console.error("Error fetching all rules:",n),e({loading:!1});return}const i={laminador1:[],laminador2:[],laminador3:[]};(r||[]).forEach(s=>{const o=s.process_id;i[o]&&i[o].push(Ah(s))}),e({rulesByProcess:i,loading:!1})},setRules:async(r,n)=>{e({loading:!0});const{error:i}=await Yt.from("scheduler_changeover_rules").delete().eq("process_id",r);if(i){console.error("Error deleting old rules:",i),e({loading:!1});return}const s=n.map(l=>zb(r,l)),{data:o,error:a}=await Yt.from("scheduler_changeover_rules").insert(s).select();if(a){console.error("Error inserting rules:",a),e({loading:!1});return}e(l=>({rulesByProcess:{...l.rulesByProcess,[r]:(o||[]).map(Ah)},loading:!1}))},addRule:async(r,n)=>{const{data:i,error:s}=await Yt.from("scheduler_changeover_rules").insert(zb(r,n)).select().single();if(s){console.error("Error adding rule:",s);return}e(o=>({rulesByProcess:{...o.rulesByProcess,[r]:[...o.rulesByProcess[r]||[],Ah(i)]}}))},updateRule:async(r,n,i)=>{const{data:s,error:o}=await Yt.from("scheduler_changeover_rules").update(zb(r,i)).eq("id",n).select().single();if(o){console.error("Error updating rule:",o);return}e(a=>({rulesByProcess:{...a.rulesByProcess,[r]:(a.rulesByProcess[r]||[]).map(l=>l.id===n?Ah(s):l)}}))},deleteRules:async(r,n)=>{const{error:i}=await Yt.from("scheduler_changeover_rules").delete().in("id",n);if(i){console.error("Error deleting rules:",i);return}e(s=>({rulesByProcess:{...s.rulesByProcess,[r]:(s.rulesByProcess[r]||[]).filter(o=>!n.includes(o.id))}}))}})),nA=6048e5,$ce=864e5,$C=6e4,qce=36e5,Kce=1e3,eT=Symbol.for("constructDateFrom");function Wn(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&eT in e?e[eT](t):e instanceof Date?new e.constructor(t):new Date(t)}function Fr(e,t){return Wn(t||e,e)}function vd(e,t,r){const n=Fr(e,r?.in);return isNaN(t)?Wn(r?.in||e,NaN):(t&&n.setDate(n.getDate()+t),n)}let Xce={};function Fd(){return Xce}function gl(e,t){const r=Fd(),n=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,i=Fr(e,t?.in),s=i.getDay(),o=(s<n?7:0)+s-n;return i.setDate(i.getDate()-o),i.setHours(0,0,0,0),i}function bd(e,t){return gl(e,{...t,weekStartsOn:1})}function iA(e,t){const r=Fr(e,t?.in),n=r.getFullYear(),i=Wn(r,0);i.setFullYear(n+1,0,4),i.setHours(0,0,0,0);const s=bd(i),o=Wn(r,0);o.setFullYear(n,0,4),o.setHours(0,0,0,0);const a=bd(o);return r.getTime()>=s.getTime()?n+1:r.getTime()>=a.getTime()?n:n-1}function Q0(e){const t=Fr(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Yce(e,...t){const r=Wn.bind(null,t.find(n=>typeof n=="object"));return t.map(r)}function Rc(e,t){const r=Fr(e,t?.in);return r.setHours(0,0,0,0),r}function Zce(e,t,r){const[n,i]=Yce(r?.in,e,t),s=Rc(n),o=Rc(i),a=+s-Q0(s),l=+o-Q0(o);return Math.round((a-l)/$ce)}function Jce(e,t){const r=iA(e,t),n=Wn(e,0);return n.setFullYear(r,0,4),n.setHours(0,0,0,0),bd(n)}function wn(e,t,r){const n=Fr(e,r?.in);return n.setTime(n.getTime()+t*$C),n}function Qce(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function eue(e){return!(!Qce(e)&&typeof e!="number"||isNaN(+Fr(e)))}function tue(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function qC(e,t){return+Fr(e)-+Fr(t)}function sA(e,t,r){const n=qC(e,t)/$C;return tue(r?.roundingMethod)(n)}function rue(e,t){const r=Fr(e,t?.in);return r.setHours(23,59,59,999),r}function nue(e,t){const r=Fr(e,t?.in);return r.setFullYear(r.getFullYear(),0,1),r.setHours(0,0,0,0),r}const iue={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},sue=(e,t,r)=>{let n;const i=iue[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function od(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const oue={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},aue={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},lue={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},cue={date:od({formats:oue,defaultWidth:"full"}),time:od({formats:aue,defaultWidth:"full"}),dateTime:od({formats:lue,defaultWidth:"full"})},uue={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},due=(e,t,r,n)=>uue[e];function mo(e){return(t,r)=>{const n=r?.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,a=r?.width?String(r.width):o;i=e.formattingValues[a]||e.formattingValues[o]}else{const o=e.defaultWidth,a=r?.width?String(r.width):e.defaultWidth;i=e.values[a]||e.values[o]}const s=e.argumentCallback?e.argumentCallback(t):t;return i[s]}}const hue={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},fue={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},pue={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},gue={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},mue={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},vue={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},bue=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},wue={ordinalNumber:bue,era:mo({values:hue,defaultWidth:"wide"}),quarter:mo({values:fue,defaultWidth:"wide",argumentCallback:e=>e-1}),month:mo({values:pue,defaultWidth:"wide"}),day:mo({values:gue,defaultWidth:"wide"}),dayPeriod:mo({values:mue,defaultWidth:"wide",formattingValues:vue,defaultFormattingWidth:"wide"})};function vo(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],s=t.match(i);if(!s)return null;const o=s[0],a=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(a)?Cue(a,h=>h.test(o)):yue(a,h=>h.test(o));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const u=t.slice(o.length);return{value:c,rest:u}}}function yue(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function Cue(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function oA(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],s=t.match(e.parsePattern);if(!s)return null;let o=e.valueCallback?e.valueCallback(s[0]):s[0];o=r.valueCallback?r.valueCallback(o):o;const a=t.slice(i.length);return{value:o,rest:a}}}const xue=/^(\d+)(th|st|nd|rd)?/i,Sue=/\d+/i,_ue={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Eue={any:[/^b/i,/^(a|c)/i]},Tue={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},kue={any:[/1/i,/2/i,/3/i,/4/i]},Rue={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Aue={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Fue={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Mue={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Due={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Pue={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Iue={ordinalNumber:oA({matchPattern:xue,parsePattern:Sue,valueCallback:e=>parseInt(e,10)}),era:vo({matchPatterns:_ue,defaultMatchWidth:"wide",parsePatterns:Eue,defaultParseWidth:"any"}),quarter:vo({matchPatterns:Tue,defaultMatchWidth:"wide",parsePatterns:kue,defaultParseWidth:"any",valueCallback:e=>e+1}),month:vo({matchPatterns:Rue,defaultMatchWidth:"wide",parsePatterns:Aue,defaultParseWidth:"any"}),day:vo({matchPatterns:Fue,defaultMatchWidth:"wide",parsePatterns:Mue,defaultParseWidth:"any"}),dayPeriod:vo({matchPatterns:Due,defaultMatchWidth:"any",parsePatterns:Pue,defaultParseWidth:"any"})},aA={code:"en-US",formatDistance:sue,formatLong:cue,formatRelative:due,localize:wue,match:Iue,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Oue(e,t){const r=Fr(e,t?.in);return Zce(r,nue(r))+1}function lA(e,t){const r=Fr(e,t?.in),n=+bd(r)-+Jce(r);return Math.round(n/nA)+1}function KC(e,t){const r=Fr(e,t?.in),n=r.getFullYear(),i=Fd(),s=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??i.firstWeekContainsDate??i.locale?.options?.firstWeekContainsDate??1,o=Wn(t?.in||e,0);o.setFullYear(n+1,0,s),o.setHours(0,0,0,0);const a=gl(o,t),l=Wn(t?.in||e,0);l.setFullYear(n,0,s),l.setHours(0,0,0,0);const c=gl(l,t);return+r>=+a?n+1:+r>=+c?n:n-1}function Nue(e,t){const r=Fd(),n=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,i=KC(e,t),s=Wn(t?.in||e,0);return s.setFullYear(i,0,n),s.setHours(0,0,0,0),gl(s,t)}function cA(e,t){const r=Fr(e,t?.in),n=+gl(r,t)-+Nue(r,t);return Math.round(n/nA)+1}function Ir(e,t){const r=e<0?"-":"",n=Math.abs(e).toString().padStart(t,"0");return r+n}const Ya={y(e,t){const r=e.getFullYear(),n=r>0?r:1-r;return Ir(t==="yy"?n%100:n,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):Ir(r+1,2)},d(e,t){return Ir(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];default:return r==="am"?"a.m.":"p.m."}},h(e,t){return Ir(e.getHours()%12||12,t.length)},H(e,t){return Ir(e.getHours(),t.length)},m(e,t){return Ir(e.getMinutes(),t.length)},s(e,t){return Ir(e.getSeconds(),t.length)},S(e,t){const r=t.length,n=e.getMilliseconds(),i=Math.trunc(n*Math.pow(10,r-3));return Ir(i,t.length)}},Tu={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},tT={G:function(e,t,r){const n=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(n,{width:"abbreviated"});case"GGGGG":return r.era(n,{width:"narrow"});default:return r.era(n,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){const n=e.getFullYear(),i=n>0?n:1-n;return r.ordinalNumber(i,{unit:"year"})}return Ya.y(e,t)},Y:function(e,t,r,n){const i=KC(e,n),s=i>0?i:1-i;if(t==="YY"){const o=s%100;return Ir(o,2)}return t==="Yo"?r.ordinalNumber(s,{unit:"year"}):Ir(s,t.length)},R:function(e,t){const r=iA(e);return Ir(r,t.length)},u:function(e,t){const r=e.getFullYear();return Ir(r,t.length)},Q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(n);case"QQ":return Ir(n,2);case"Qo":return r.ordinalNumber(n,{unit:"quarter"});case"QQQ":return r.quarter(n,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(n,{width:"narrow",context:"formatting"});default:return r.quarter(n,{width:"wide",context:"formatting"})}},q:function(e,t,r){const n=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(n);case"qq":return Ir(n,2);case"qo":return r.ordinalNumber(n,{unit:"quarter"});case"qqq":return r.quarter(n,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(n,{width:"narrow",context:"standalone"});default:return r.quarter(n,{width:"wide",context:"standalone"})}},M:function(e,t,r){const n=e.getMonth();switch(t){case"M":case"MM":return Ya.M(e,t);case"Mo":return r.ordinalNumber(n+1,{unit:"month"});case"MMM":return r.month(n,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(n,{width:"narrow",context:"formatting"});default:return r.month(n,{width:"wide",context:"formatting"})}},L:function(e,t,r){const n=e.getMonth();switch(t){case"L":return String(n+1);case"LL":return Ir(n+1,2);case"Lo":return r.ordinalNumber(n+1,{unit:"month"});case"LLL":return r.month(n,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(n,{width:"narrow",context:"standalone"});default:return r.month(n,{width:"wide",context:"standalone"})}},w:function(e,t,r,n){const i=cA(e,n);return t==="wo"?r.ordinalNumber(i,{unit:"week"}):Ir(i,t.length)},I:function(e,t,r){const n=lA(e);return t==="Io"?r.ordinalNumber(n,{unit:"week"}):Ir(n,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getDate(),{unit:"date"}):Ya.d(e,t)},D:function(e,t,r){const n=Oue(e);return t==="Do"?r.ordinalNumber(n,{unit:"dayOfYear"}):Ir(n,t.length)},E:function(e,t,r){const n=e.getDay();switch(t){case"E":case"EE":case"EEE":return r.day(n,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(n,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},e:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return Ir(s,2);case"eo":return r.ordinalNumber(s,{unit:"day"});case"eee":return r.day(i,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(i,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(i,{width:"short",context:"formatting"});default:return r.day(i,{width:"wide",context:"formatting"})}},c:function(e,t,r,n){const i=e.getDay(),s=(i-n.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return Ir(s,t.length);case"co":return r.ordinalNumber(s,{unit:"day"});case"ccc":return r.day(i,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(i,{width:"narrow",context:"standalone"});case"cccccc":return r.day(i,{width:"short",context:"standalone"});default:return r.day(i,{width:"wide",context:"standalone"})}},i:function(e,t,r){const n=e.getDay(),i=n===0?7:n;switch(t){case"i":return String(i);case"ii":return Ir(i,t.length);case"io":return r.ordinalNumber(i,{unit:"day"});case"iii":return r.day(n,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(n,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(n,{width:"short",context:"formatting"});default:return r.day(n,{width:"wide",context:"formatting"})}},a:function(e,t,r){const i=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},b:function(e,t,r){const n=e.getHours();let i;switch(n===12?i=Tu.noon:n===0?i=Tu.midnight:i=n/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},B:function(e,t,r){const n=e.getHours();let i;switch(n>=17?i=Tu.evening:n>=12?i=Tu.afternoon:n>=4?i=Tu.morning:i=Tu.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(i,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(i,{width:"narrow",context:"formatting"});default:return r.dayPeriod(i,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){let n=e.getHours()%12;return n===0&&(n=12),r.ordinalNumber(n,{unit:"hour"})}return Ya.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getHours(),{unit:"hour"}):Ya.H(e,t)},K:function(e,t,r){const n=e.getHours()%12;return t==="Ko"?r.ordinalNumber(n,{unit:"hour"}):Ir(n,t.length)},k:function(e,t,r){let n=e.getHours();return n===0&&(n=24),t==="ko"?r.ordinalNumber(n,{unit:"hour"}):Ir(n,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getMinutes(),{unit:"minute"}):Ya.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getSeconds(),{unit:"second"}):Ya.s(e,t)},S:function(e,t){return Ya.S(e,t)},X:function(e,t,r){const n=e.getTimezoneOffset();if(n===0)return"Z";switch(t){case"X":return nT(n);case"XXXX":case"XX":return Kl(n);default:return Kl(n,":")}},x:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"x":return nT(n);case"xxxx":case"xx":return Kl(n);default:return Kl(n,":")}},O:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+rT(n,":");default:return"GMT"+Kl(n,":")}},z:function(e,t,r){const n=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+rT(n,":");default:return"GMT"+Kl(n,":")}},t:function(e,t,r){const n=Math.trunc(+e/1e3);return Ir(n,t.length)},T:function(e,t,r){return Ir(+e,t.length)}};function rT(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Math.trunc(n/60),s=n%60;return s===0?r+String(i):r+String(i)+t+Ir(s,2)}function nT(e,t){return e%60===0?(e>0?"-":"+")+Ir(Math.abs(e)/60,2):Kl(e,t)}function Kl(e,t=""){const r=e>0?"-":"+",n=Math.abs(e),i=Ir(Math.trunc(n/60),2),s=Ir(n%60,2);return r+i+t+s}const iT=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},uA=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},Lue=(e,t)=>{const r=e.match(/(P+)(p+)?/)||[],n=r[1],i=r[2];if(!i)return iT(e,t);let s;switch(n){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;default:s=t.dateTime({width:"full"});break}return s.replace("{{date}}",iT(n,t)).replace("{{time}}",uA(i,t))},Yw={p:uA,P:Lue},Bue=/^D+$/,Hue=/^Y+$/,jue=["D","DD","YY","YYYY"];function dA(e){return Bue.test(e)}function hA(e){return Hue.test(e)}function Zw(e,t,r){const n=Vue(e,t,r);if(console.warn(n),jue.includes(e))throw new RangeError(n)}function Vue(e,t,r){const n=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${n} to the input \`${r}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const Gue=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,zue=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,Uue=/^'([^]*?)'?$/,Wue=/''/g,$ue=/[a-zA-Z]/;function Nr(e,t,r){const n=Fd(),i=r?.locale??n.locale??aA,s=r?.firstWeekContainsDate??r?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,o=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,a=Fr(e,r?.in);if(!eue(a))throw new RangeError("Invalid time value");let l=t.match(zue).map(u=>{const h=u[0];if(h==="p"||h==="P"){const d=Yw[h];return d(u,i.formatLong)}return u}).join("").match(Gue).map(u=>{if(u==="''")return{isToken:!1,value:"'"};const h=u[0];if(h==="'")return{isToken:!1,value:que(u)};if(tT[h])return{isToken:!0,value:u};if(h.match($ue))throw new RangeError("Format string contains an unescaped latin alphabet character `"+h+"`");return{isToken:!1,value:u}});i.localize.preprocessor&&(l=i.localize.preprocessor(a,l));const c={firstWeekContainsDate:s,weekStartsOn:o,locale:i};return l.map(u=>{if(!u.isToken)return u.value;const h=u.value;(!r?.useAdditionalWeekYearTokens&&hA(h)||!r?.useAdditionalDayOfYearTokens&&dA(h))&&Zw(h,t,String(e));const d=tT[h[0]];return d(a,h,i.localize,c)}).join("")}function que(e){const t=e.match(Uue);return t?t[1].replace(Wue,"'"):e}function Mm(e,t){return Fr(e,t?.in).getDay()}function Kue(){return Object.assign({},Fd())}function Xue(e,t){const r=Fr(e,t?.in).getDay();return r===0?7:r}function Nh(e,t){return+Fr(e)>+Fr(t)}function Du(e,t){return+Fr(e)<+Fr(t)}function Yue(e,t){const r=Zue(t)?new t(0):Wn(t,0);return r.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),r.setHours(e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()),r}function Zue(e){return typeof e=="function"&&e.prototype?.constructor===e}const Jue=10;class fA{subPriority=0;validate(t,r){return!0}}class Que extends fA{constructor(t,r,n,i,s){super(),this.value=t,this.validateValue=r,this.setValue=n,this.priority=i,s&&(this.subPriority=s)}validate(t,r){return this.validateValue(t,this.value,r)}set(t,r,n){return this.setValue(t,r,this.value,n)}}class ede extends fA{priority=Jue;subPriority=-1;constructor(t,r){super(),this.context=t||(n=>Wn(r,n))}set(t,r){return r.timestampIsSet?t:Wn(t,Yue(t,this.context))}}class Rr{run(t,r,n,i){const s=this.parse(t,r,n,i);return s?{setter:new Que(s.value,this.validate,this.set,this.priority,this.subPriority),rest:s.rest}:null}validate(t,r,n){return!0}}class tde extends Rr{priority=140;parse(t,r,n){switch(r){case"G":case"GG":case"GGG":return n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"});case"GGGGG":return n.era(t,{width:"narrow"});default:return n.era(t,{width:"wide"})||n.era(t,{width:"abbreviated"})||n.era(t,{width:"narrow"})}}set(t,r,n){return r.era=n,t.setFullYear(n,0,1),t.setHours(0,0,0,0),t}incompatibleTokens=["R","u","t","T"]}const Cn={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},bo={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function xn(e,t){return e&&{value:t(e.value),rest:e.rest}}function nn(e,t){const r=t.match(e);return r?{value:parseInt(r[0],10),rest:t.slice(r[0].length)}:null}function wo(e,t){const r=t.match(e);if(!r)return null;if(r[0]==="Z")return{value:0,rest:t.slice(1)};const n=r[1]==="+"?1:-1,i=r[2]?parseInt(r[2],10):0,s=r[3]?parseInt(r[3],10):0,o=r[5]?parseInt(r[5],10):0;return{value:n*(i*qce+s*$C+o*Kce),rest:t.slice(r[0].length)}}function pA(e){return nn(Cn.anyDigitsSigned,e)}function fn(e,t){switch(e){case 1:return nn(Cn.singleDigit,t);case 2:return nn(Cn.twoDigits,t);case 3:return nn(Cn.threeDigits,t);case 4:return nn(Cn.fourDigits,t);default:return nn(new RegExp("^\\d{1,"+e+"}"),t)}}function em(e,t){switch(e){case 1:return nn(Cn.singleDigitSigned,t);case 2:return nn(Cn.twoDigitsSigned,t);case 3:return nn(Cn.threeDigitsSigned,t);case 4:return nn(Cn.fourDigitsSigned,t);default:return nn(new RegExp("^-?\\d{1,"+e+"}"),t)}}function XC(e){switch(e){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;default:return 0}}function gA(e,t){const r=t>0,n=r?t:1-t;let i;if(n<=50)i=e||100;else{const s=n+50,o=Math.trunc(s/100)*100,a=e>=s%100;i=e+o-(a?100:0)}return r?i:1-i}function mA(e){return e%400===0||e%4===0&&e%100!==0}class rde extends Rr{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(t,r,n){const i=s=>({year:s,isTwoDigitYear:r==="yy"});switch(r){case"y":return xn(fn(4,t),i);case"yo":return xn(n.ordinalNumber(t,{unit:"year"}),i);default:return xn(fn(r.length,t),i)}}validate(t,r){return r.isTwoDigitYear||r.year>0}set(t,r,n){const i=t.getFullYear();if(n.isTwoDigitYear){const o=gA(n.year,i);return t.setFullYear(o,0,1),t.setHours(0,0,0,0),t}const s=!("era"in r)||r.era===1?n.year:1-n.year;return t.setFullYear(s,0,1),t.setHours(0,0,0,0),t}}class nde extends Rr{priority=130;parse(t,r,n){const i=s=>({year:s,isTwoDigitYear:r==="YY"});switch(r){case"Y":return xn(fn(4,t),i);case"Yo":return xn(n.ordinalNumber(t,{unit:"year"}),i);default:return xn(fn(r.length,t),i)}}validate(t,r){return r.isTwoDigitYear||r.year>0}set(t,r,n,i){const s=KC(t,i);if(n.isTwoDigitYear){const a=gA(n.year,s);return t.setFullYear(a,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),gl(t,i)}const o=!("era"in r)||r.era===1?n.year:1-n.year;return t.setFullYear(o,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),gl(t,i)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]}class ide extends Rr{priority=130;parse(t,r){return em(r==="R"?4:r.length,t)}set(t,r,n){const i=Wn(t,0);return i.setFullYear(n,0,4),i.setHours(0,0,0,0),bd(i)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]}class sde extends Rr{priority=130;parse(t,r){return em(r==="u"?4:r.length,t)}set(t,r,n){return t.setFullYear(n,0,1),t.setHours(0,0,0,0),t}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]}class ode extends Rr{priority=120;parse(t,r,n){switch(r){case"Q":case"QQ":return fn(r.length,t);case"Qo":return n.ordinalNumber(t,{unit:"quarter"});case"QQQ":return n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return n.quarter(t,{width:"narrow",context:"formatting"});default:return n.quarter(t,{width:"wide",context:"formatting"})||n.quarter(t,{width:"abbreviated",context:"formatting"})||n.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=1&&r<=4}set(t,r,n){return t.setMonth((n-1)*3,1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]}class ade extends Rr{priority=120;parse(t,r,n){switch(r){case"q":case"qq":return fn(r.length,t);case"qo":return n.ordinalNumber(t,{unit:"quarter"});case"qqq":return n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return n.quarter(t,{width:"narrow",context:"standalone"});default:return n.quarter(t,{width:"wide",context:"standalone"})||n.quarter(t,{width:"abbreviated",context:"standalone"})||n.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,r){return r>=1&&r<=4}set(t,r,n){return t.setMonth((n-1)*3,1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]}class lde extends Rr{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(t,r,n){const i=s=>s-1;switch(r){case"M":return xn(nn(Cn.month,t),i);case"MM":return xn(fn(2,t),i);case"Mo":return xn(n.ordinalNumber(t,{unit:"month"}),i);case"MMM":return n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return n.month(t,{width:"narrow",context:"formatting"});default:return n.month(t,{width:"wide",context:"formatting"})||n.month(t,{width:"abbreviated",context:"formatting"})||n.month(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=0&&r<=11}set(t,r,n){return t.setMonth(n,1),t.setHours(0,0,0,0),t}}class cde extends Rr{priority=110;parse(t,r,n){const i=s=>s-1;switch(r){case"L":return xn(nn(Cn.month,t),i);case"LL":return xn(fn(2,t),i);case"Lo":return xn(n.ordinalNumber(t,{unit:"month"}),i);case"LLL":return n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return n.month(t,{width:"narrow",context:"standalone"});default:return n.month(t,{width:"wide",context:"standalone"})||n.month(t,{width:"abbreviated",context:"standalone"})||n.month(t,{width:"narrow",context:"standalone"})}}validate(t,r){return r>=0&&r<=11}set(t,r,n){return t.setMonth(n,1),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]}function ude(e,t,r){const n=Fr(e,r?.in),i=cA(n,r)-t;return n.setDate(n.getDate()-i*7),Fr(n,r?.in)}class dde extends Rr{priority=100;parse(t,r,n){switch(r){case"w":return nn(Cn.week,t);case"wo":return n.ordinalNumber(t,{unit:"week"});default:return fn(r.length,t)}}validate(t,r){return r>=1&&r<=53}set(t,r,n,i){return gl(ude(t,n,i),i)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]}function hde(e,t,r){const n=Fr(e,r?.in),i=lA(n,r)-t;return n.setDate(n.getDate()-i*7),n}class fde extends Rr{priority=100;parse(t,r,n){switch(r){case"I":return nn(Cn.week,t);case"Io":return n.ordinalNumber(t,{unit:"week"});default:return fn(r.length,t)}}validate(t,r){return r>=1&&r<=53}set(t,r,n){return bd(hde(t,n))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]}const pde=[31,28,31,30,31,30,31,31,30,31,30,31],gde=[31,29,31,30,31,30,31,31,30,31,30,31];class mde extends Rr{priority=90;subPriority=1;parse(t,r,n){switch(r){case"d":return nn(Cn.date,t);case"do":return n.ordinalNumber(t,{unit:"date"});default:return fn(r.length,t)}}validate(t,r){const n=t.getFullYear(),i=mA(n),s=t.getMonth();return i?r>=1&&r<=gde[s]:r>=1&&r<=pde[s]}set(t,r,n){return t.setDate(n),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]}class vde extends Rr{priority=90;subpriority=1;parse(t,r,n){switch(r){case"D":case"DD":return nn(Cn.dayOfYear,t);case"Do":return n.ordinalNumber(t,{unit:"date"});default:return fn(r.length,t)}}validate(t,r){const n=t.getFullYear();return mA(n)?r>=1&&r<=366:r>=1&&r<=365}set(t,r,n){return t.setMonth(0,n),t.setHours(0,0,0,0),t}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]}function YC(e,t,r){const n=Fd(),i=r?.weekStartsOn??r?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,s=Fr(e,r?.in),o=s.getDay(),l=(t%7+7)%7,c=7-i,u=t<0||t>6?t-(o+c)%7:(l+c)%7-(o+c)%7;return vd(s,u,r)}class bde extends Rr{priority=90;parse(t,r,n){switch(r){case"E":case"EE":case"EEE":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return n.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=0&&r<=6}set(t,r,n,i){return t=YC(t,n,i),t.setHours(0,0,0,0),t}incompatibleTokens=["D","i","e","c","t","T"]}class wde extends Rr{priority=90;parse(t,r,n,i){const s=o=>{const a=Math.floor((o-1)/7)*7;return(o+i.weekStartsOn+6)%7+a};switch(r){case"e":case"ee":return xn(fn(r.length,t),s);case"eo":return xn(n.ordinalNumber(t,{unit:"day"}),s);case"eee":return n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});case"eeeee":return n.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"});default:return n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"})}}validate(t,r){return r>=0&&r<=6}set(t,r,n,i){return t=YC(t,n,i),t.setHours(0,0,0,0),t}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]}class yde extends Rr{priority=90;parse(t,r,n,i){const s=o=>{const a=Math.floor((o-1)/7)*7;return(o+i.weekStartsOn+6)%7+a};switch(r){case"c":case"cc":return xn(fn(r.length,t),s);case"co":return xn(n.ordinalNumber(t,{unit:"day"}),s);case"ccc":return n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});case"ccccc":return n.day(t,{width:"narrow",context:"standalone"});case"cccccc":return n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"});default:return n.day(t,{width:"wide",context:"standalone"})||n.day(t,{width:"abbreviated",context:"standalone"})||n.day(t,{width:"short",context:"standalone"})||n.day(t,{width:"narrow",context:"standalone"})}}validate(t,r){return r>=0&&r<=6}set(t,r,n,i){return t=YC(t,n,i),t.setHours(0,0,0,0),t}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]}function Cde(e,t,r){const n=Fr(e,r?.in),i=Xue(n,r),s=t-i;return vd(n,s,r)}class xde extends Rr{priority=90;parse(t,r,n){const i=s=>s===0?7:s;switch(r){case"i":case"ii":return fn(r.length,t);case"io":return n.ordinalNumber(t,{unit:"day"});case"iii":return xn(n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),i);case"iiiii":return xn(n.day(t,{width:"narrow",context:"formatting"}),i);case"iiiiii":return xn(n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),i);default:return xn(n.day(t,{width:"wide",context:"formatting"})||n.day(t,{width:"abbreviated",context:"formatting"})||n.day(t,{width:"short",context:"formatting"})||n.day(t,{width:"narrow",context:"formatting"}),i)}}validate(t,r){return r>=1&&r<=7}set(t,r,n){return t=Cde(t,n),t.setHours(0,0,0,0),t}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]}class Sde extends Rr{priority=80;parse(t,r,n){switch(r){case"a":case"aa":case"aaa":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,r,n){return t.setHours(XC(n),0,0,0),t}incompatibleTokens=["b","B","H","k","t","T"]}class _de extends Rr{priority=80;parse(t,r,n){switch(r){case"b":case"bb":case"bbb":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,r,n){return t.setHours(XC(n),0,0,0),t}incompatibleTokens=["a","B","H","k","t","T"]}class Ede extends Rr{priority=80;parse(t,r,n){switch(r){case"B":case"BB":case"BBB":return n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return n.dayPeriod(t,{width:"narrow",context:"formatting"});default:return n.dayPeriod(t,{width:"wide",context:"formatting"})||n.dayPeriod(t,{width:"abbreviated",context:"formatting"})||n.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,r,n){return t.setHours(XC(n),0,0,0),t}incompatibleTokens=["a","b","t","T"]}class Tde extends Rr{priority=70;parse(t,r,n){switch(r){case"h":return nn(Cn.hour12h,t);case"ho":return n.ordinalNumber(t,{unit:"hour"});default:return fn(r.length,t)}}validate(t,r){return r>=1&&r<=12}set(t,r,n){const i=t.getHours()>=12;return i&&n<12?t.setHours(n+12,0,0,0):!i&&n===12?t.setHours(0,0,0,0):t.setHours(n,0,0,0),t}incompatibleTokens=["H","K","k","t","T"]}class kde extends Rr{priority=70;parse(t,r,n){switch(r){case"H":return nn(Cn.hour23h,t);case"Ho":return n.ordinalNumber(t,{unit:"hour"});default:return fn(r.length,t)}}validate(t,r){return r>=0&&r<=23}set(t,r,n){return t.setHours(n,0,0,0),t}incompatibleTokens=["a","b","h","K","k","t","T"]}class Rde extends Rr{priority=70;parse(t,r,n){switch(r){case"K":return nn(Cn.hour11h,t);case"Ko":return n.ordinalNumber(t,{unit:"hour"});default:return fn(r.length,t)}}validate(t,r){return r>=0&&r<=11}set(t,r,n){return t.getHours()>=12&&n<12?t.setHours(n+12,0,0,0):t.setHours(n,0,0,0),t}incompatibleTokens=["h","H","k","t","T"]}class Ade extends Rr{priority=70;parse(t,r,n){switch(r){case"k":return nn(Cn.hour24h,t);case"ko":return n.ordinalNumber(t,{unit:"hour"});default:return fn(r.length,t)}}validate(t,r){return r>=1&&r<=24}set(t,r,n){const i=n<=24?n%24:n;return t.setHours(i,0,0,0),t}incompatibleTokens=["a","b","h","H","K","t","T"]}class Fde extends Rr{priority=60;parse(t,r,n){switch(r){case"m":return nn(Cn.minute,t);case"mo":return n.ordinalNumber(t,{unit:"minute"});default:return fn(r.length,t)}}validate(t,r){return r>=0&&r<=59}set(t,r,n){return t.setMinutes(n,0,0),t}incompatibleTokens=["t","T"]}class Mde extends Rr{priority=50;parse(t,r,n){switch(r){case"s":return nn(Cn.second,t);case"so":return n.ordinalNumber(t,{unit:"second"});default:return fn(r.length,t)}}validate(t,r){return r>=0&&r<=59}set(t,r,n){return t.setSeconds(n,0),t}incompatibleTokens=["t","T"]}class Dde extends Rr{priority=30;parse(t,r){const n=i=>Math.trunc(i*Math.pow(10,-r.length+3));return xn(fn(r.length,t),n)}set(t,r,n){return t.setMilliseconds(n),t}incompatibleTokens=["t","T"]}class Pde extends Rr{priority=10;parse(t,r){switch(r){case"X":return wo(bo.basicOptionalMinutes,t);case"XX":return wo(bo.basic,t);case"XXXX":return wo(bo.basicOptionalSeconds,t);case"XXXXX":return wo(bo.extendedOptionalSeconds,t);default:return wo(bo.extended,t)}}set(t,r,n){return r.timestampIsSet?t:Wn(t,t.getTime()-Q0(t)-n)}incompatibleTokens=["t","T","x"]}class Ide extends Rr{priority=10;parse(t,r){switch(r){case"x":return wo(bo.basicOptionalMinutes,t);case"xx":return wo(bo.basic,t);case"xxxx":return wo(bo.basicOptionalSeconds,t);case"xxxxx":return wo(bo.extendedOptionalSeconds,t);default:return wo(bo.extended,t)}}set(t,r,n){return r.timestampIsSet?t:Wn(t,t.getTime()-Q0(t)-n)}incompatibleTokens=["t","T","X"]}class Ode extends Rr{priority=40;parse(t){return pA(t)}set(t,r,n){return[Wn(t,n*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"}class Nde extends Rr{priority=20;parse(t){return pA(t)}set(t,r,n){return[Wn(t,n),{timestampIsSet:!0}]}incompatibleTokens="*"}const Lde={G:new tde,y:new rde,Y:new nde,R:new ide,u:new sde,Q:new ode,q:new ade,M:new lde,L:new cde,w:new dde,I:new fde,d:new mde,D:new vde,E:new bde,e:new wde,c:new yde,i:new xde,a:new Sde,b:new _de,B:new Ede,h:new Tde,H:new kde,K:new Rde,k:new Ade,m:new Fde,s:new Mde,S:new Dde,X:new Pde,x:new Ide,t:new Ode,T:new Nde},Bde=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Hde=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,jde=/^'([^]*?)'?$/,Vde=/''/g,Gde=/\S/,zde=/[a-zA-Z]/;function Ude(e,t,r,n){const i=()=>Wn(r,NaN),s=Kue(),o=s.locale??aA,a=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,l=s.weekStartsOn??s.locale?.options?.weekStartsOn??0,c={firstWeekContainsDate:a,weekStartsOn:l,locale:o},u=[new ede(n?.in,r)],h=t.match(Hde).map(g=>{const w=g[0];if(w in Yw){const y=Yw[w];return y(g,o.formatLong)}return g}).join("").match(Bde),d=[];for(let g of h){hA(g)&&Zw(g,t,e),dA(g)&&Zw(g,t,e);const w=g[0],y=Lde[w];if(y){const{incompatibleTokens:C}=y;if(Array.isArray(C)){const F=d.find(I=>C.includes(I.token)||I.token===w);if(F)throw new RangeError(`The format string mustn't contain \`${F.fullToken}\` and \`${g}\` at the same time`)}else if(y.incompatibleTokens==="*"&&d.length>0)throw new RangeError(`The format string mustn't contain \`${g}\` and any other token at the same time`);d.push({token:w,fullToken:g});const k=y.run(e,g,o.match,c);if(!k)return i();u.push(k.setter),e=k.rest}else{if(w.match(zde))throw new RangeError("Format string contains an unescaped latin alphabet character `"+w+"`");if(g==="''"?g="'":w==="'"&&(g=Wde(g)),e.indexOf(g)===0)e=e.slice(g.length);else return i()}}if(e.length>0&&Gde.test(e))return i();const f=u.map(g=>g.priority).sort((g,w)=>w-g).filter((g,w,y)=>y.indexOf(g)===w).map(g=>u.filter(w=>w.priority===g).sort((w,y)=>y.subPriority-w.subPriority)).map(g=>g[0]);let m=Fr(r,n?.in);if(isNaN(+m))return i();const v={};for(const g of f){if(!g.validate(m,c))return i();const w=g.set(m,v,c);Array.isArray(w)?(m=w[0],Object.assign(v,w[1])):m=w}return m}function Wde(e){return e.match(jde)[1].replace(Vde,"'")}function Lh(e,t,r){const n=Fr(e,r?.in);return n.setHours(t),n}function Bh(e,t,r){const n=Fr(e,r?.in);return n.setMinutes(t),n}const $de=18,qde=30,Kde=20,Xde=30,Yde=120,Zde=18,Jde=30,Qde=60,ehe=60,the=6,rhe=30,nhe=40,ihe=40,Ub=200,wd=(e,t)=>qC(e,t)/6e4,she=(e,t)=>{const r=Nr(e,"yyyy-MM-dd");return t.includes(r)},ohe={production:"#dbeafe",changeover:"bg-red-100 text-red-800",adjustment:"bg-yellow-100 text-yellow-800",quality_change:"bg-pink-100 text-pink-800",stop_change:"bg-teal-100 text-teal-800",ring_change:"bg-violet-100 text-violet-800",channel_change:"bg-orange-100 text-orange-800",maintenance_hp:"#fee2e2",forced_stop:"bg-gray-100 text-gray-800",off_shift:"#f3f4f6"},ahe={production:"Produccin",changeover:"Cambio de Medida",adjustment:"Acierto y Calib.",quality_change:"Cambio Calidad",stop_change:"Cambio de Tope",ring_change:"Cambio Anillo",channel_change:"Cambio Canal",maintenance_hp:"Mantenimiento",forced_stop:"Parada Manual",off_shift:"Fuera de Turno"},Hs=(e,t,r,n)=>{const i=wn(t,r),s=ahe[e];return{type:e,start:new Date(t),end:i,durationMinutes:r,label:s,description:n||s,color:ohe[e]}},lhe=(e,t)=>{if(t.is24h)return!0;const r=Mm(e),n=e.getHours(),i=e.getMinutes(),s=n*60+i,o=t.days[r];if(o&&o.active&&o.hours>0){const c=o.startHour*60+o.startMinute,u=c+o.hours*60;if(u<=1440){if(s>=c&&s<u)return!0}else if(s>=c)return!0}const a=(r+6)%7,l=t.days[a];if(l&&l.active&&l.hours>0){const u=l.startHour*60+l.startMinute+l.hours*60;if(u>1440){const h=u-1440;if(s<h)return!0}}return!1},che=(e,t)=>{if(t.is24h)return e;let r=new Date(e);for(let n=0;n<14;n++){const i=Mm(r),s=t.days[i];if(s&&s.active&&s.hours>0){const o=Bh(Lh(new Date(r),s.startHour),s.startMinute);if(o.setSeconds(0,0),o>=e)return o}r=Rc(vd(r,1))}return e},sT=(e,t)=>{if(t.is24h||lhe(e,t))return null;const r=che(e,t),n=wd(r,e);return n<=0?null:{nextStart:r,gapMinutes:n}},uhe=(e,t)=>{if(t.is24h)return 1/0;const r=Mm(e),n=e.getHours(),i=e.getMinutes(),s=n*60+i,o=t.days[r];if(o&&o.active&&o.hours>0){const c=o.startHour*60+o.startMinute,u=c+o.hours*60;if(u<=1440){if(s>=c&&s<u)return u-s}else if(s>=c)return 1440-s+(u-1440)}const a=(r+6)%7,l=t.days[a];if(l&&l.active&&l.hours>0){const u=l.startHour*60+l.startMinute+l.hours*60;if(u>1440){const h=u-1440;if(s<h)return h-s}}return 0},dhe=(e,t,r)=>{let n=new Date(t);if(n.setSeconds(0,0),r&&!r.is24h){const i=sT(n,r);i&&(n=i.nextStart)}return e.map(i=>{const s=new Date(n),o=[],a=()=>{if(!r||r.is24h)return;const l=sT(n,r);l&&(o.push(Hs("off_shift",n,l.gapMinutes,"Fuera de Turno")),n=l.nextStart)};if(a(),i.stoppages&&Object.entries(i.stoppages).forEach(([l,c])=>{c>0&&(o.push(Hs("forced_stop",n,c,`Parada (ID: ${l})`)),n=wn(n,c),a())}),i.ringChangeMinutes&&i.ringChangeMinutes>0&&(o.push(Hs("ring_change",n,i.ringChangeMinutes,"Cambio Anillo (Manual)")),n=wn(n,i.ringChangeMinutes),a()),i.channelChangeMinutes&&i.channelChangeMinutes>0&&(o.push(Hs("channel_change",n,i.channelChangeMinutes,"Cambio Canal (Manual)")),n=wn(n,i.channelChangeMinutes),a()),i.changeoverMinutes&&i.changeoverMinutes>0?(o.push(Hs("changeover",n,i.changeoverMinutes)),n=wn(n,i.changeoverMinutes),a(),i.adjustmentMinutes&&i.adjustmentMinutes>0&&(o.push(Hs("adjustment",n,i.adjustmentMinutes)),n=wn(n,i.adjustmentMinutes),a())):i.qualityChangeMinutes&&i.qualityChangeMinutes>0?(o.push(Hs("quality_change",n,i.qualityChangeMinutes)),n=wn(n,i.qualityChangeMinutes),a()):i.stopChangeMinutes&&i.stopChangeMinutes>0&&(o.push(Hs("stop_change",n,i.stopChangeMinutes)),n=wn(n,i.stopChangeMinutes),a()),i.productionTimeMinutes>0){let l=i.productionTimeMinutes;for(;l>.01;)if(a(),r&&!r.is24h){const c=uhe(n,r),u=Math.min(l,c);u>.01?(o.push(Hs("production",n,u)),n=wn(n,u),l-=u):n=wn(n,.1)}else o.push(Hs("production",n,l)),n=wn(n,l),l=0}return{...i,computedStart:s,computedEnd:new Date(n),segments:o}})},hhe=e=>{const t=[];return e.forEach((r,n)=>{r.segments.forEach((i,s)=>{t.push({itemIndex:n,segmentIndex:s,type:i.type,start:new Date(i.start),end:new Date(i.end),durationMinutes:i.durationMinutes})})}),t.sort((r,n)=>r.start.getTime()-n.start.getTime())},Wb=(e,t,r)=>e.filter(n=>n.type!=="production").reduce((n,i)=>{const s=new Date(Math.max(i.start.getTime(),t.getTime())),o=new Date(Math.min(i.end.getTime(),r.getTime()));return n+Math.max(0,wd(o,s))},0),oT=(e,t,r)=>{const n=r.getTime();return e.some(i=>i.type===t&&i.start.getTime()===n)},fhe=(e,t)=>{let r=[e];for(const n of t){const i=[];for(const s of r)n.end.getTime()<=s.start.getTime()||n.start.getTime()>=s.end.getTime()?i.push(s):(n.start.getTime()>s.start.getTime()&&i.push({start:s.start,end:n.start}),n.end.getTime()<s.end.getTime()&&i.push({start:n.end,end:s.end}));r=i}return r.map(n=>({...n,duration:wd(n.end,n.start)})).filter(n=>n.duration>.1)},phe=(e,t,r,n,i=[])=>{const s=[];let o=Rc(t);const a=vd(Rc(r),1);for(;Du(o,a)||o.getTime()===a.getTime();){const l=Mm(o),c=l===0||l===6,u=she(o,n);let h=null,d=null;const f=Bh(Lh(new Date(o),the),rhe);if(f.setSeconds(0,0),!Du(f,t)&&!Nh(f,r)&&!oT(e,"channel_change",f)){const v=wn(f,-420);Wb(e,v,f)<ihe&&(d={timestamp:new Date(f),type:"channel_change",durationMinutes:nhe},s.push(d))}const m=Bh(Lh(new Date(o),Zde),Jde);if(m.setSeconds(0,0),!Du(m,t)&&!Nh(m,r)&&!oT(e,"ring_change",m)){const v=wn(m,-420);Wb(e,v,m)<ehe&&(h={timestamp:new Date(m),type:"ring_change",durationMinutes:Qde},s.push(h))}if(!c&&!u){const v=Bh(Lh(new Date(o),$de),qde);v.setSeconds(0,0);const g=Bh(Lh(new Date(o),Kde),Xde);if(g.setSeconds(0,0),!Du(v,t)&&!Nh(v,r)){const w=Wb(e,v,g);let y=0;if(h){const F=h.timestamp,I=wn(F,h.durationMinutes),N=new Date(Math.max(F.getTime(),v.getTime())),j=new Date(Math.min(I.getTime(),g.getTime()));N<j&&(y=sA(j,N))}const C=w+y,k=Math.max(0,Yde-C);if(k>.5){let F=ghe(e,v,g);if(h){const I=wn(h.timestamp,h.durationMinutes);F&&I>F&&(F=I)}if(F&&F<g){const I=wd(g,F),N=Math.min(k,I);N>.5&&s.push({timestamp:new Date(F),type:"maintenance_hp",durationMinutes:N})}}}}o=vd(o,1)}return i.forEach(l=>{const c=new Date(l.start),u=wn(c,l.durationMinutes);if(Nh(wn(c,1),r)||Du(wn(u,-1),t))return;const h=e.filter(f=>f.type!=="production").map(f=>({start:f.start,end:f.end}));fhe({start:c,end:u},h).forEach(f=>{f.duration>.1&&s.push({timestamp:f.start,type:"forced_stop",durationMinutes:f.duration,manualLabel:l.label})})}),s.sort((l,c)=>l.timestamp.getTime()-c.timestamp.getTime())},ghe=(e,t,r)=>{const n=t.getTime(),i=r.getTime(),s=[...e].sort((o,a)=>o.start.getTime()-a.start.getTime());for(const o of s){if(o.type!=="production")continue;const a=o.start.getTime(),l=o.end.getTime();if(a<i&&l>n)return new Date(Math.max(n,a))}return null},mhe=(e,t)=>{const{timestamp:r,type:n,durationMinutes:i}=t,s=r.getTime();for(const o of e)for(let a=0;a<o.segments.length;a++){const l=o.segments[a],c=l.start.getTime(),u=l.end.getTime();if(s>=c&&s<u){if(l.type==="production"){const h=[],d=wd(r,l.start);d>.01&&h.push({...l,end:new Date(r),durationMinutes:d});const f=n==="ring_change"?"Cambio de Anillo (Automtico)":n==="channel_change"?"Cambio de Canal (Automtico)":n==="forced_stop"?t.manualLabel||"Parada Manual":`Mantenimiento (${Math.round(i)} min)`;h.push(Hs(n,r,i,f));const m=wn(r,i),v=wd(l.end,r);return v>.01&&h.push({...l,start:new Date(m),end:wn(m,v),durationMinutes:v}),o.segments.splice(a,1,...h),!0}return!1}}return!1},vhe=e=>{if(e.length===0)return;let t=new Date(e[0].computedStart);for(const r of e){r.computedStart=new Date(t);for(const n of r.segments)n.start=new Date(t),n.end=wn(t,n.durationMinutes),t=new Date(n.end);r.computedEnd=new Date(t)}},bhe=(e,t,r)=>{let n=0,i=!0;for(;i&&n<Ub;){i=!1,n++;const s=hhe(e);if(e.length===0)break;const o=e[0].computedStart,a=e[e.length-1].computedEnd,l=phe(s,o,a,t,r);if(l.length===0)break;const c=[...l].sort((u,h)=>u.timestamp.getTime()-h.timestamp.getTime());for(const u of c)if(mhe(e,u)){i=!0;break}i&&vhe(e)}return n>=Ub&&console.warn(`Scheduler: Mximo de iteraciones (${Ub}) alcanzado. El timeline puede no estar completamente optimizado.`),e},whe=(e,t,r=[],n=[],i)=>{if(e.length===0)return[];const s=dhe(e,t,i);return bhe(s,r,n)},aT=e=>{if(!e)return null;const t=e.match(/X\s*(\d+(?:\.\d+)?)\s?M/i);return t?t[1]:null},lT=(e,t,r,n,i=[],s=[],o)=>{let a=[...e].sort((u,h)=>u.sequenceOrder-h.sequenceOrder);const l=a.map((u,h)=>{const d=String(u.skuCode||"").replace(/\s+/g,"");let f=t.find(k=>String(k.codigoProgramacion||"").replace(/\s+/g,"")===d);f||(f=t.find(k=>String(k.skuLaminacion||"")===d));const m=parseFloat(String(f?.ritmoTH||0))||0;let v=0;if(h>0){const k=a[h-1],F=String(k.skuCode||"").replace(/\s+/g,"");let I=t.find(N=>String(N.codigoProgramacion||"").replace(/\s+/g,"")===F);if(I||(I=t.find(N=>String(N.skuLaminacion||"")===F)),f?.idTablaCambioMedida&&I?.idTablaCambioMedida){const N=String(I.idTablaCambioMedida).trim(),j=String(f.idTablaCambioMedida).trim(),L=r.find(W=>String(W.fromId).trim()===N&&String(W.toId).trim()===j);L&&(v=(L.durationHours||0)*60)}}let g=0;if(h>0&&v===0){const k=a[h-1],F=t.find(I=>I.codigoProgramacion===k.skuCode);f?.calidadPalanquilla&&F?.calidadPalanquilla&&f.calidadPalanquilla.trim()!==F.calidadPalanquilla.trim()&&(g=60)}let w=0;if(h>0&&v===0&&g===0){const k=a[h-1],F=t.find(j=>j.codigoProgramacion===k.skuCode),I=aT(f?.descripcion),N=aT(F?.descripcion);I&&N&&I!==N&&(w=10)}let y=0;v>0&&(y=(f?.aciertoCalibracion||0)*60);let C=0;return m>0&&u.quantity>0&&(C=u.quantity/m*60),{...u,changeoverMinutes:v,qualityChangeMinutes:g,stopChangeMinutes:w,adjustmentMinutes:y,productionTimeMinutes:C,calculatedPace:m}});return whe(l,n,i,s,o).map(u=>({...u,startTime:u.computedStart,endTime:u.computedEnd,segments:u.segments}))},yhe=[{id:"s1",colId:"col_change",label:"Cambio Medida",defaultDuration:0},{id:"s2",colId:"col_maint",label:"Mantenimiento",defaultDuration:0}],Che=5,Ii=(e,t,r,n=0)=>({active:e,hours:t,startHour:r,startMinute:n}),xhe={is24h:!0,days:{0:Ii(!0,24,0),1:Ii(!0,24,0),2:Ii(!0,24,0),3:Ii(!0,24,0),4:Ii(!0,24,0),5:Ii(!0,24,0),6:Ii(!0,24,0)}},She={is24h:!1,days:{0:Ii(!0,16,22,0),1:Ii(!0,16,22,0),2:Ii(!0,16,22,0),3:Ii(!0,16,22,0),4:Ii(!0,16,22,0),5:Ii(!0,16,22,0),6:Ii(!1,0,0,0)}},_he=e=>JSON.parse(JSON.stringify(e==="laminador1"?She:xhe)),$b=e=>({schedule:[],stoppageConfigs:yhe,programStartDate:new Date,columnLabels:{},scheduleHistory:[],holidays:[],manualStops:[],workSchedule:_he(e),visualTargetDate:null,sequencerConfig:{draftItems:[],params:{poblacion:100,generaciones:250,pesoVenta:.5,costoVP:100,costoTC:5e3,tasaMutacion:.15,tasaElitismo:.1},lastResult:null}}),Lr=Em((e,t)=>({activeProcessId:"laminador1",processes:{laminador1:$b("laminador1"),laminador2:$b("laminador2"),laminador3:$b("laminador3")},activeTab:"scheduler",setActiveProcess:async r=>{e({activeProcessId:r}),await Promise.all([Ks.getState().fetchArticles(r),aa.getState().fetchRules(r),t().fetchProcessData(r)])},setActiveTab:r=>e({activeTab:r}),fetchProcessData:async r=>{const[n,i,s,o]=await Promise.all([Yt.from("scheduler_process_configs").select("*").eq("id",r).single(),Yt.from("scheduler_production_items").select("*").eq("process_id",r).order("sequence_order"),Yt.from("scheduler_stoppage_configs").select("*").eq("process_id",r),Yt.from("scheduler_manual_stops").select("*").eq("process_id",r)]);if(n.data&&e(a=>({processes:{...a.processes,[r]:{...a.processes[r],programStartDate:new Date(n.data.program_start_date),workSchedule:n.data.work_schedule,holidays:n.data.holidays,columnLabels:n.data.column_labels,visualTargetDate:n.data.visual_target_date?new Date(n.data.visual_target_date):null,sequencerConfig:n.data.sequencer_config||a.processes[r].sequencerConfig}}})),i.data){const a=i.data.map(l=>({id:l.id,sequenceOrder:l.sequence_order,skuCode:l.sku_code,quantity:Number(l.quantity),stoppages:l.stoppages,startTime:new Date,endTime:new Date,calculatedPace:0,productionTimeMinutes:0}));e(l=>({processes:{...l.processes,[r]:{...l.processes[r],schedule:a}}}))}s.data&&s.data.length>0&&e(a=>({processes:{...a.processes,[r]:{...a.processes[r],stoppageConfigs:s.data.map(l=>({id:l.id,colId:l.col_id,label:l.label,defaultDuration:Number(l.default_duration)}))}}})),o.data&&e(a=>({processes:{...a.processes,[r]:{...a.processes[r],manualStops:o.data.map(l=>({id:l.id,start:new Date(l.start_time),durationMinutes:Number(l.duration_minutes),label:l.label}))}}})),t().recalculateSchedule()},saveProcessItems:async(r,n)=>{try{const{error:i}=await Yt.from("scheduler_production_items").delete().eq("process_id",r);if(i)throw i;if(n.length===0)return;const s=n.map(a=>({id:a.id||crypto.randomUUID(),process_id:r,sequence_order:a.sequenceOrder,sku_code:a.skuCode,quantity:a.quantity,stoppages:a.stoppages})),{error:o}=await Yt.from("scheduler_production_items").insert(s);if(o)throw o}catch(i){console.error(`Error persisting items for ${r}:`,i),alert(`Error crtico al guardar en Supabase (${r}). Los cambios se mantienen solo en local.`)}},_saveSnapshot:()=>{e(r=>{const n=r.activeProcessId,i=r.processes[n];return{processes:{...r.processes,[n]:{...i,scheduleHistory:[JSON.parse(JSON.stringify(i.schedule)),...i.scheduleHistory].slice(0,Che)}}}})},setProgramStartDate:async r=>{const n=t().activeProcessId;e(i=>({processes:{...i.processes,[n]:{...i.processes[n],programStartDate:r}}})),await Yt.from("scheduler_process_configs").update({program_start_date:r}).eq("id",n),t().recalculateSchedule()},addScheduleItem:async r=>{t()._saveSnapshot();const n=t().activeProcessId,i=t().processes[n],s={...r,id:crypto.randomUUID(),sequenceOrder:i.schedule.length};e(o=>({processes:{...o.processes,[n]:{...i,schedule:[...i.schedule,s]}}})),await t().saveProcessItems(n,t().processes[n].schedule),t().recalculateSchedule()},insertScheduleItem:async(r,n)=>{t()._saveSnapshot();const i=t().activeProcessId,s=t().processes[i],o=[...s.schedule];o.splice(r,0,n);const a=o.map((l,c)=>({...l,sequenceOrder:c}));e(l=>({processes:{...l.processes,[i]:{...s,schedule:a}}})),await t().saveProcessItems(i,a),t().recalculateSchedule()},addScheduleItems:async r=>{t()._saveSnapshot();const n=t().activeProcessId,i=t().processes[n],s=[...i.schedule,...r].map((o,a)=>({...o,sequenceOrder:a}));e(o=>({processes:{...o.processes,[n]:{...i,schedule:s}}})),await t().saveProcessItems(n,s),t().recalculateSchedule()},updateScheduleItem:async(r,n)=>{const i=t().activeProcessId,s=t().processes[i],o=s.schedule.map(a=>a.id===r?{...a,...n}:a);e(a=>({processes:{...a.processes,[i]:{...s,schedule:o}}})),await Yt.from("scheduler_production_items").update({sku_code:n.skuCode,quantity:n.quantity,stoppages:n.stoppages,sequence_order:n.sequenceOrder}).eq("id",r),t().recalculateSchedule()},deleteScheduleItem:async r=>{t()._saveSnapshot();const n=t().activeProcessId,i=t().processes[n],s=i.schedule.filter(o=>o.id!==r).map((o,a)=>({...o,sequenceOrder:a}));e(o=>({processes:{...o.processes,[n]:{...i,schedule:s}}})),await Yt.from("scheduler_production_items").delete().eq("id",r),await t().saveProcessItems(n,s),t().recalculateSchedule()},clearSchedule:async()=>{t()._saveSnapshot();const r=t().activeProcessId;e(n=>({processes:{...n.processes,[r]:{...n.processes[r],schedule:[]}}})),await Yt.from("scheduler_production_items").delete().eq("process_id",r)},reorderSchedule:async r=>{t()._saveSnapshot();const n=t().activeProcessId,i=r.map((s,o)=>({...s,sequenceOrder:o}));e(s=>({processes:{...s.processes,[n]:{...s.processes[n],schedule:i}}})),await t().saveProcessItems(n,i),t().recalculateSchedule()},addStoppageConfig:async r=>{const n=t().activeProcessId;e(i=>({processes:{...i.processes,[n]:{...i.processes[n],stoppageConfigs:[...i.processes[n].stoppageConfigs,r]}}})),await Yt.from("scheduler_stoppage_configs").insert({id:r.id,process_id:n,col_id:r.colId,label:r.label,default_duration:r.defaultDuration})},removeStoppageConfig:async r=>{const n=t().activeProcessId;e(i=>({processes:{...i.processes,[n]:{...i.processes[n],stoppageConfigs:i.processes[n].stoppageConfigs.filter(s=>s.id!==r)}}})),await Yt.from("scheduler_stoppage_configs").delete().eq("id",r)},recalculateSchedule:()=>{const r=t(),n=r.activeProcessId,i=r.processes[n],{schedule:s,programStartDate:o,holidays:a,manualStops:l,workSchedule:c}=i,u=Ks.getState().getArticles(n),h=aa.getState().getRules(n),d=lT(s,u,h,o,a,l,c);e(f=>({processes:{...f.processes,[n]:{...f.processes[n],schedule:d}}}))},undo:async()=>{const r=t(),n=r.activeProcessId,i=r.processes[n];if(i.scheduleHistory.length===0)return;const[s,...o]=i.scheduleHistory;e(a=>({processes:{...a.processes,[n]:{...a.processes[n],schedule:s,scheduleHistory:o}}})),await t().saveProcessItems(n,s),t().recalculateSchedule()},canUndo:()=>{const r=t(),n=r.activeProcessId;return r.processes[n].scheduleHistory.length>0},setColumnLabel:async(r,n)=>{const i=t().activeProcessId,s=t().processes[i],o={...s.columnLabels,[r]:n};e(a=>({processes:{...a.processes,[i]:{...s,columnLabels:o}}})),await Yt.from("scheduler_process_configs").update({column_labels:o}).eq("id",i)},setSchedule:async r=>{const n=t().activeProcessId;e(i=>({processes:{...i.processes,[n]:{...i.processes[n],schedule:r,scheduleHistory:[]}}})),await t().saveProcessItems(n,r),t().recalculateSchedule()},setStoppageConfigs:async r=>{const n=t().activeProcessId;e(i=>({processes:{...i.processes,[n]:{...i.processes[n],stoppageConfigs:r}}})),await Yt.from("scheduler_stoppage_configs").delete().eq("process_id",n),await Yt.from("scheduler_stoppage_configs").insert(r.map(i=>({id:i.id,process_id:n,col_id:i.colId,label:i.label,default_duration:i.defaultDuration})))},importColumnLabels:async r=>{const n=t().activeProcessId;e(i=>({processes:{...i.processes,[n]:{...i.processes[n],columnLabels:r}}})),await Yt.from("scheduler_process_configs").update({column_labels:r}).eq("id",n)},addHoliday:async r=>{const n=t().activeProcessId,i=t().processes[n];if(i.holidays.includes(r))return;const s=[...i.holidays,r].sort();e(o=>({processes:{...o.processes,[n]:{...i,holidays:s}}})),await Yt.from("scheduler_process_configs").update({holidays:s}).eq("id",n)},removeHoliday:async r=>{const n=t().activeProcessId,i=t().processes[n],s=i.holidays.filter(o=>o!==r);e(o=>({processes:{...o.processes,[n]:{...i,holidays:s}}})),await Yt.from("scheduler_process_configs").update({holidays:s}).eq("id",n)},isHoliday:r=>{const n=t(),i=n.activeProcessId,s=n.processes[i],o=Nr(r,"yyyy-MM-dd");return s.holidays.includes(o)},addManualStop:async r=>{t()._saveSnapshot();const n=t().activeProcessId;e(i=>({processes:{...i.processes,[n]:{...i.processes[n],manualStops:[...i.processes[n].manualStops,r]}}})),await Yt.from("scheduler_manual_stops").insert({id:r.id||crypto.randomUUID(),process_id:n,start_time:r.start,duration_minutes:r.durationMinutes,label:r.label}),t().recalculateSchedule()},updateManualStop:async(r,n)=>{t()._saveSnapshot();const i=t().activeProcessId,s=t().processes[i],o=s.manualStops.map(a=>a.id===r?{...a,...n}:a);e(a=>({processes:{...a.processes,[i]:{...s,manualStops:o}}})),await Yt.from("scheduler_manual_stops").update({start_time:n.start,duration_minutes:n.durationMinutes,label:n.label}).eq("id",r),t().recalculateSchedule()},deleteManualStop:async r=>{t()._saveSnapshot();const n=t().activeProcessId,i=t().processes[n],s=i.manualStops.filter(o=>o.id!==r);e(o=>({processes:{...o.processes,[n]:{...i,manualStops:s}}})),await Yt.from("scheduler_manual_stops").delete().eq("id",r),t().recalculateSchedule()},setManualStops:async r=>{const n=t().activeProcessId;e(i=>({processes:{...i.processes,[n]:{...i.processes[n],manualStops:r}}})),await Yt.from("scheduler_manual_stops").delete().eq("process_id",n),await Yt.from("scheduler_manual_stops").insert(r.map(i=>({id:i.id||crypto.randomUUID(),process_id:n,start_time:i.start,duration_minutes:i.durationMinutes,label:i.label})))},setWorkSchedule:async r=>{const n=t().activeProcessId;e(i=>({processes:{...i.processes,[n]:{...i.processes[n],workSchedule:r}}})),await Yt.from("scheduler_process_configs").update({work_schedule:r}).eq("id",n),t().recalculateSchedule()},setVisualTargetDate:async r=>{const n=t().activeProcessId;e(i=>({processes:{...i.processes,[n]:{...i.processes[n],visualTargetDate:r}}})),await Yt.from("scheduler_process_configs").update({visual_target_date:r}).eq("id",n)},updateItemEndTime:async(r,n)=>{const i=t(),s=i.activeProcessId,o=i.processes[s],{schedule:a,programStartDate:l,holidays:c,manualStops:u,workSchedule:h}=o,d=Ks.getState().getArticles(s),f=aa.getState().getRules(s),m=a.findIndex(j=>j.id===r);if(m===-1)return;const v=a[m];if(!v.startTime)return;const g=new Date(v.startTime);if(n<=g){alert("La fecha fin debe ser posterior a la fecha de inicio.");return}const w=v.calculatedPace||1,y=(n.getTime()-g.getTime())/6e4;let C=v.productionTimeMinutes||0;v.endTime&&v.startTime&&(C=(new Date(v.endTime).getTime()-new Date(v.startTime).getTime())/6e4);let k=0;v.quantity>0&&C>0?k=v.quantity*(y/C):k=y/60*w;let F=k;const I=j=>{const L=[...a];L[m]={...v,quantity:j};const K=lT(L,d,f,l,c,u,h)[m];if(!K.computedEnd)return{error:1/0,diff:0,end:new Date};const z=(K.computedEnd.getTime()-n.getTime())/6e4;return{error:Math.abs(z),diff:z,end:K.computedEnd}};for(let j=0;j<3;j++){const L=I(F);if(L.error<2)break;const W=L.diff*(w/60);F-=W,F<0&&(F=0)}t()._saveSnapshot();const N=o.schedule.map((j,L)=>L===m?{...j,quantity:Math.round(F*100)/100}:j);e(j=>({processes:{...j.processes,[s]:{...j.processes[s],schedule:N}}})),await Yt.from("scheduler_production_items").update({quantity:Math.round(F*100)/100}).eq("id",r),t().recalculateSchedule()},saveSequencerConfig:async r=>{const n=t().activeProcessId;e(i=>({processes:{...i.processes,[n]:{...i.processes[n],sequencerConfig:r}}})),await Yt.from("scheduler_process_configs").update({sequencer_config:r}).eq("id",n)}})),Ehe=()=>{const e=Lr(k=>k.activeProcessId),t=Ks(k=>k.articlesByProcess[e]||[]),{setArticles:r,addArticle:n,updateArticle:i,deleteArticles:s}=Ks(),o=ae.useRef(null),[a,l]=ae.useState(null),c=ae.useMemo(()=>[{field:"skuLaminacion",headerName:"SKU Laminacin",editable:!0,filter:!0,sortable:!0,checkboxSelection:!0,headerCheckboxSelection:!0},{field:"ending",headerName:"Ending",editable:!0,filter:!0,sortable:!0},{field:"codigoProgramacion",headerName:"Cdigo Programacin",editable:!0,filter:!0,sortable:!0},{field:"descripcion",headerName:"Descripcin",editable:!0,filter:!0,sortable:!0,width:200},{field:"skuPalanquilla",headerName:"SKU Palanquilla",editable:!0,filter:!0,sortable:!0},{field:"calidadPalanquilla",headerName:"Calidad Palanquilla",editable:!0,filter:!0,sortable:!0},{field:"ritmoTH",headerName:"Ritmo t/h",editable:!0,filter:!0,sortable:!0,type:"numericColumn"},{field:"rendimientoMetalico",headerName:"Rendimiento Metlico %",editable:!0,filter:!0,sortable:!0,type:"numericColumn"},{field:"fam",headerName:"Fam.",editable:!0,filter:!0,sortable:!0},{field:"aciertoCalibracion",headerName:"Acierto y Calibracin (h)",editable:!0,filter:!0,sortable:!0,type:"numericColumn"},{field:"idTablaCambioMedida",headerName:"ID Tabla Cambio Medida",editable:!0,filter:!0,sortable:!0},{field:"pesoPalanquilla",headerName:"Peso Palanquilla (kg)",editable:!0,filter:!0,sortable:!0,type:"numericColumn"},{field:"almacenDestino",headerName:"Almacn Destino",editable:!0,filter:!0,sortable:!0},{field:"comentarios",headerName:"Comentarios",editable:!0,filter:!0,sortable:!0,width:250}],[]),u=ae.useMemo(()=>({resizable:!0,sortable:!0,filter:!0,minWidth:100}),[]),[h,d]=ae.useState(""),f=k=>{l(k.api),k.api.autoSizeAllColumns()};st.useEffect(()=>{a&&a.updateGridOptions({quickFilterText:h})},[h,a]);const m=k=>{const F=k.target.files?.[0];if(!F)return;const I=new FileReader;I.onload=N=>{const j=N.target?.result,L=K0(j,{type:"binary"}),W=L.SheetNames[0],K=L.Sheets[W],z=_s.sheet_to_json(K,{header:1}),M=z[0],B=z.slice(1),R=D=>{const O=D.trim().toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"");if(O.includes("sku laminacion"))return"skuLaminacion";if(O.includes("ending"))return"ending";if(O.includes("codigo programacion")||O.includes("codigo prog"))return"codigoProgramacion";if(O.includes("descripcion"))return"descripcion";if(O.includes("sku palanquilla"))return"skuPalanquilla";if(O.includes("calidad palanquilla"))return"calidadPalanquilla";if(O.includes("ritmo"))return"ritmoTH";if(O.includes("rendimiento metal"))return"rendimientoMetalico";if(O.includes("fam"))return"fam";if(O.includes("acierto")&&O.includes("calibracion"))return"aciertoCalibracion";if(O.includes("tabla")&&O.includes("cambio"))return"idTablaCambioMedida";if(O.includes("peso palanquilla"))return"pesoPalanquilla";if(O.includes("almacen destino"))return"almacenDestino";if(O.includes("comentarios"))return"comentarios"},S={},_=[];M.forEach((D,O)=>{if(!D)return;const P=R(String(D));P?S[O]=P:_.push(`[${O}] "${D}"`)}),_.length>0&&(console.warn(" Columnas NO reconocidas:",_.join(", ")),alert(` ${_.length} columna(s) no reconocida(s):
${_.join(`
`)}`));const T=new Set(["ritmoTH","rendimientoMetalico","aciertoCalibracion","pesoPalanquilla"]),E=B.map(D=>{const O={};return Object.keys(S).forEach(P=>{const q=S[P],X=D[P];if(T.has(q)){const Q=Number(X);O[q]=isNaN(Q)?0:Q}else O[q]=X!=null?String(X).trim():""}),O}).filter(D=>D.skuLaminacion);r(e,E)},I.readAsBinaryString(F),k.target.value=""},v=k=>{k.data.id&&i(e,k.data.id,k.data)},g=()=>{n(e,{skuLaminacion:"",ending:"",codigoProgramacion:"",descripcion:"",skuPalanquilla:"",calidadPalanquilla:"",ritmoTH:0,rendimientoMetalico:0,fam:"",aciertoCalibracion:0,idTablaCambioMedida:"",pesoPalanquilla:0,almacenDestino:"",comentarios:""}),setTimeout(()=>{a?.ensureIndexVisible(t.length-1)},100)},w=()=>{const k=a?.getSelectedNodes();if(k&&k.length>0){const F=k.map(I=>I.data.id).filter(I=>!!I);s(e,F),a?.deselectAll()}},y={skuLaminacion:"SKU Laminacin",ending:"Ending",codigoProgramacion:"Cdigo Programacin",descripcion:"Descripcin",skuPalanquilla:"SKU Palanquilla",calidadPalanquilla:"Calidad Palanquilla",ritmoTH:"Ritmo T/H",rendimientoMetalico:"Rendimiento Metlico %",fam:"Fam.",aciertoCalibracion:"Acierto y Calibracin",idTablaCambioMedida:"ID Tabla Cambio Medida",pesoPalanquilla:"Peso Palanquilla (kg)",almacenDestino:"Almacn Destino",comentarios:"Comentarios"},C=()=>{const k=t.map(N=>{const j={};return Object.keys(y).forEach(L=>{const W=y[L];W&&(j[W]=N[L])}),j}),F=_s.json_to_sheet(k),I=_s.book_new();_s.book_append_sheet(I,F,"Maestro Articulos"),BC(I,"Maestro_Articulos_Export.xlsx")};return J.jsxs("div",{className:"h-full flex flex-col p-4 bg-gray-50",children:[J.jsxs("div",{className:"flex flex-col gap-4 mb-4 bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsxs("div",{className:"flex flex-col",children:[J.jsx("h2",{className:"text-xl font-bold text-gray-800 tracking-tight",children:"Maestro de Artculos"}),J.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[J.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-blue-600 bg-blue-50 px-2 py-0.5 rounded border border-blue-100",children:e.replace("laminador","Laminador ")}),J.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:"Base de datos especfica por proceso"})]})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsxs("div",{className:"relative",children:[J.jsx("input",{type:"text",placeholder:"Buscar en todos los campos...",className:"pl-3 pr-8 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 w-64 shadow-sm",value:h,onChange:k=>d(k.target.value)}),h&&J.jsx("button",{onClick:()=>d(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:""})]}),J.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),J.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors shadow-sm text-sm font-medium",children:[J.jsx(WC,{size:16}),"Importar",J.jsx("input",{type:"file",accept:".xlsx, .xls",className:"hidden",onChange:m})]}),J.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors shadow-sm text-sm font-medium",children:[J.jsx(Fm,{size:16}),"Exportar"]})]})]}),J.jsxs("div",{className:"flex gap-2",children:[J.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors text-sm font-semibold",children:[J.jsx(kc,{size:16})," Agregar Fila"]}),J.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-3 py-1.5 bg-white text-red-600 border border-red-200 rounded-lg hover:bg-red-50 transition-colors text-sm font-semibold",children:[J.jsx(sl,{size:16})," Eliminar"]})]})]}),J.jsx("div",{className:"flex-1 w-full ag-theme-quartz shadow-sm rounded-lg overflow-hidden border border-gray-200",children:J.jsx(Qy,{ref:o,rowData:t,columnDefs:c,defaultColDef:u,onGridReady:f,onCellValueChanged:v,getRowId:k=>k.data.id,rowSelection:{mode:"multiRow"},animateRows:!0,pagination:!0,paginationPageSize:50,paginationPageSizeSelector:[10,20,50,100],rowHeight:32,headerHeight:48})})]})},The=()=>{const e=Lr(C=>C.activeProcessId),t=aa(C=>C.rulesByProcess[e]||[]),{setRules:r,addRule:n,updateRule:i,deleteRules:s}=aa(),o=ae.useRef(null),[a,l]=ae.useState(null),c=ae.useMemo(()=>[{field:"fromId",headerName:"ID Origen (From)",editable:!0,filter:!0,sortable:!0,checkboxSelection:!0,headerCheckboxSelection:!0},{field:"toId",headerName:"ID Destino (To)",editable:!0,filter:!0,sortable:!0},{field:"durationHours",headerName:"Tiempo (Horas)",editable:!0,filter:!0,sortable:!0,type:"numericColumn"}],[]),u=ae.useMemo(()=>({resizable:!0,sortable:!0,filter:!0,flex:1,minWidth:100}),[]),[h,d]=ae.useState(""),f=C=>{l(C.api),C.api.autoSizeAllColumns()};st.useEffect(()=>{a&&a.updateGridOptions({quickFilterText:h})},[h,a]);const m=C=>{const k=C.target.files?.[0];if(!k)return;const F=new FileReader;F.onload=I=>{const N=I.target?.result,j=K0(N,{type:"binary"}),L=j.SheetNames[0],W=j.Sheets[L],K=W["!ref"];if(!K)return;const z=_s.decode_range(K),M=z.e.r-z.s.r+1,B=z.e.c-z.s.c+1,R=[];for(let S=0;S<M;S++){const _=(S+1).toString();for(let T=0;T<B;T++){const E=_s.encode_cell({r:z.s.r+S,c:z.s.c+T}),D=W[E];D&&D.t==="n"&&typeof D.v=="number"&&R.push({fromId:_,toId:(T+1).toString(),durationHours:D.v})}}console.log(`[Importar Matriz] ${R.length} reglas importadas (${M} filas x ${B} cols)`),r(e,R)},F.readAsBinaryString(k),C.target.value=""},v=C=>{C.data.id&&i(e,C.data.id,C.data)},g=()=>{n(e,{fromId:"",toId:"",durationHours:0}),setTimeout(()=>{a?.ensureIndexVisible(t.length-1)},100)},w=()=>{const C=a?.getSelectedNodes();if(C&&C.length>0){const k=C.map(F=>F.data.id).filter(F=>!!F);s(e,k),a?.deselectAll()}},y=()=>{const C=_s.json_to_sheet(t),k=_s.book_new();_s.book_append_sheet(k,C,"Reglas Cambio"),BC(k,"Reglas_Cambio.xlsx")};return J.jsxs("div",{className:"h-full flex flex-col p-4 bg-gray-50",children:[J.jsxs("div",{className:"flex flex-col gap-4 mb-4 bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:[J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsxs("div",{className:"flex flex-col",children:[J.jsx("h2",{className:"text-xl font-bold text-gray-800 tracking-tight",children:"Matriz de Tiempos de Cambio"}),J.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[J.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-orange-600 bg-orange-50 px-2 py-0.5 rounded border border-orange-100",children:e.replace("laminador","Laminador ")}),J.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:"Reglas especficas por proceso"})]})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsxs("div",{className:"relative",children:[J.jsx("input",{type:"text",placeholder:"Buscar...",className:"pl-3 pr-8 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 w-48 shadow-sm",value:h,onChange:C=>d(C.target.value)}),h&&J.jsx("button",{onClick:()=>d(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:""})]}),J.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),J.jsxs("label",{className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg cursor-pointer hover:bg-gray-50 transition-colors shadow-sm text-sm font-medium",children:[J.jsx(WC,{size:16}),"Importar Matriz",J.jsx("input",{type:"file",accept:".xlsx, .xls",className:"hidden",onChange:m})]}),J.jsxs("button",{onClick:y,className:"flex items-center gap-2 px-3 py-2 bg-white border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors shadow-sm text-sm font-medium",children:[J.jsx(Fm,{size:16}),"Exportar Lista"]})]})]}),J.jsxs("div",{className:"flex gap-2",children:[J.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 text-blue-700 border border-blue-200 rounded-lg hover:bg-blue-100 transition-colors text-sm font-semibold",children:[J.jsx(kc,{size:16})," Agregar Regla"]}),J.jsxs("button",{onClick:w,className:"flex items-center gap-2 px-3 py-1.5 bg-white text-red-600 border border-red-200 rounded-lg hover:bg-red-50 transition-colors text-sm font-semibold",children:[J.jsx(sl,{size:16})," Eliminar"]})]})]}),J.jsx("div",{className:"flex-1 w-full ag-theme-quartz shadow-sm rounded-lg overflow-hidden border border-gray-200",children:J.jsx(Qy,{ref:o,rowData:t,columnDefs:c,defaultColDef:u,onGridReady:f,onCellValueChanged:v,getRowId:C=>C.data.id,rowSelection:{mode:"multiRow"},animateRows:!0,pagination:!0,paginationPageSize:50,rowHeight:32,headerHeight:48})})]})},khe=()=>{const[e,t]=ae.useState("articles");return J.jsxs("div",{className:"h-full flex flex-col",children:[J.jsxs("div",{className:"flex bg-white border-b px-4",children:[J.jsxs("button",{onClick:()=>t("articles"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${e==="articles"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[J.jsx(Ece,{size:16}),"Maestro Artculos"]}),J.jsxs("button",{onClick:()=>t("changeovers"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium border-b-2 transition-colors ${e==="changeovers"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[J.jsx(Rle,{size:16}),"Matriz de Cambios"]})]}),J.jsxs("div",{className:"flex-1 overflow-hidden",children:[e==="articles"&&J.jsx(Ehe,{}),e==="changeovers"&&J.jsx(The,{})]})]})},Rhe={lessThanXSeconds:{one:"menos de un segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"medio minuto",lessThanXMinutes:{one:"menos de un minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"alrededor de 1 hora",other:"alrededor de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 da",other:"{{count}} das"},aboutXWeeks:{one:"alrededor de 1 semana",other:"alrededor de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"alrededor de 1 mes",other:"alrededor de {{count}} meses"},xMonths:{one:"1 mes",other:"{{count}} meses"},aboutXYears:{one:"alrededor de 1 ao",other:"alrededor de {{count}} aos"},xYears:{one:"1 ao",other:"{{count}} aos"},overXYears:{one:"ms de 1 ao",other:"ms de {{count}} aos"},almostXYears:{one:"casi 1 ao",other:"casi {{count}} aos"}},Ahe=(e,t,r)=>{let n;const i=Rhe[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r?.addSuffix?r.comparison&&r.comparison>0?"en "+n:"hace "+n:n},Fhe={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/y"},Mhe={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},Dhe={full:"{{date}} 'a las' {{time}}",long:"{{date}} 'a las' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Phe={date:od({formats:Fhe,defaultWidth:"full"}),time:od({formats:Mhe,defaultWidth:"full"}),dateTime:od({formats:Dhe,defaultWidth:"full"})},Ihe={lastWeek:"'el' eeee 'pasado a la' p",yesterday:"'ayer a la' p",today:"'hoy a la' p",tomorrow:"'maana a la' p",nextWeek:"eeee 'a la' p",other:"P"},Ohe={lastWeek:"'el' eeee 'pasado a las' p",yesterday:"'ayer a las' p",today:"'hoy a las' p",tomorrow:"'maana a las' p",nextWeek:"eeee 'a las' p",other:"P"},Nhe=(e,t,r,n)=>t.getHours()!==1?Ohe[e]:Ihe[e],Lhe={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","despus de cristo"]},Bhe={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},Hhe={narrow:["e","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],wide:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"]},jhe={narrow:["d","l","m","m","j","v","s"],short:["do","lu","ma","mi","ju","vi","s"],abbreviated:["dom","lun","mar","mi","jue","vie","sb"],wide:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"]},Vhe={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"maana",afternoon:"tarde",evening:"tarde",night:"noche"}},Ghe={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},abbreviated:{am:"AM",pm:"PM",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"},wide:{am:"a.m.",pm:"p.m.",midnight:"medianoche",noon:"mediodia",morning:"de la maana",afternoon:"de la tarde",evening:"de la tarde",night:"de la noche"}},zhe=(e,t)=>Number(e)+"",Uhe={ordinalNumber:zhe,era:mo({values:Lhe,defaultWidth:"wide"}),quarter:mo({values:Bhe,defaultWidth:"wide",argumentCallback:e=>Number(e)-1}),month:mo({values:Hhe,defaultWidth:"wide"}),day:mo({values:jhe,defaultWidth:"wide"}),dayPeriod:mo({values:Vhe,defaultWidth:"wide",formattingValues:Ghe,defaultFormattingWidth:"wide"})},Whe=/^(\d+)()?/i,$he=/\d+/i,qhe={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|a\.?\s?e\.?\s?c\.?|d\.?\s?c\.?|e\.?\s?c\.?)/i,wide:/^(antes de cristo|antes de la era com[u]n|despu[e]s de cristo|era com[u]n)/i},Khe={any:[/^ac/i,/^dc/i],wide:[/^(antes de cristo|antes de la era com[u]n)/i,/^(despu[e]s de cristo|era com[u]n)/i]},Xhe={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},Yhe={any:[/1/i,/2/i,/3/i,/4/i]},Zhe={narrow:/^[efmajsond]/i,abbreviated:/^(ene|feb|mar|abr|may|jun|jul|ago|sep|oct|nov|dic)/i,wide:/^(enero|febrero|marzo|abril|mayo|junio|julio|agosto|septiembre|octubre|noviembre|diciembre)/i},Jhe={narrow:[/^e/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^en/i,/^feb/i,/^mar/i,/^abr/i,/^may/i,/^jun/i,/^jul/i,/^ago/i,/^sep/i,/^oct/i,/^nov/i,/^dic/i]},Qhe={narrow:/^[dlmjvs]/i,short:/^(do|lu|ma|mi|ju|vi|s[a])/i,abbreviated:/^(dom|lun|mar|mi[e]|jue|vie|s[a]b)/i,wide:/^(domingo|lunes|martes|mi[e]rcoles|jueves|viernes|s[a]bado)/i},efe={narrow:[/^d/i,/^l/i,/^m/i,/^m/i,/^j/i,/^v/i,/^s/i],any:[/^do/i,/^lu/i,/^ma/i,/^mi/i,/^ju/i,/^vi/i,/^sa/i]},tfe={narrow:/^(a|p|mn|md|(de la|a las) (maana|tarde|noche))/i,any:/^([ap]\.?\s?m\.?|medianoche|mediodia|(de la|a las) (maana|tarde|noche))/i},rfe={any:{am:/^a/i,pm:/^p/i,midnight:/^mn/i,noon:/^md/i,morning:/maana/i,afternoon:/tarde/i,evening:/tarde/i,night:/noche/i}},nfe={ordinalNumber:oA({matchPattern:Whe,parsePattern:$he,valueCallback:function(e){return parseInt(e,10)}}),era:vo({matchPatterns:qhe,defaultMatchWidth:"wide",parsePatterns:Khe,defaultParseWidth:"any"}),quarter:vo({matchPatterns:Xhe,defaultMatchWidth:"wide",parsePatterns:Yhe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:vo({matchPatterns:Zhe,defaultMatchWidth:"wide",parsePatterns:Jhe,defaultParseWidth:"any"}),day:vo({matchPatterns:Qhe,defaultMatchWidth:"wide",parsePatterns:efe,defaultParseWidth:"any"}),dayPeriod:vo({matchPatterns:tfe,defaultMatchWidth:"any",parsePatterns:rfe,defaultParseWidth:"any"})},Xs={code:"es",formatDistance:Ahe,formatLong:Phe,formatRelative:Nhe,localize:Uhe,match:nfe,options:{weekStartsOn:1,firstWeekContainsDate:1}},Jn=[];for(let e=0;e<256;++e)Jn.push((e+256).toString(16).slice(1));function ife(e,t=0){return(Jn[e[t+0]]+Jn[e[t+1]]+Jn[e[t+2]]+Jn[e[t+3]]+"-"+Jn[e[t+4]]+Jn[e[t+5]]+"-"+Jn[e[t+6]]+Jn[e[t+7]]+"-"+Jn[e[t+8]]+Jn[e[t+9]]+"-"+Jn[e[t+10]]+Jn[e[t+11]]+Jn[e[t+12]]+Jn[e[t+13]]+Jn[e[t+14]]+Jn[e[t+15]]).toLowerCase()}let qb;const sfe=new Uint8Array(16);function ofe(){if(!qb){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");qb=crypto.getRandomValues.bind(crypto)}return qb(sfe)}const afe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),cT={randomUUID:afe};function lfe(e,t,r){e=e||{};const n=e.random??e.rng?.()??ofe();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,ife(n)}function Jw(e,t,r){return cT.randomUUID&&!e?cT.randomUUID():lfe(e)}const cfe=({isOpen:e,onClose:t,onSave:r,initialDate:n,minDate:i,itemName:s})=>{const[o,a]=ae.useState(""),[l,c]=ae.useState(null);if(ae.useEffect(()=>{if(e&&n){try{a(Nr(n,"yyyy-MM-dd'T'HH:mm"))}catch{a("")}c(null)}},[e,n]),!e)return null;const u=()=>{if(!o){c("Por favor seleccione una fecha y hora.");return}const h=new Date(o);if(isNaN(h.getTime())){c("Fecha invlida.");return}if(i&&h<=i){c(`La fecha fin debe ser posterior al inicio (${Nr(i,"dd/MM HH:mm")}).`);return}r(h),t()};return J.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center bg-black/50 backdrop-blur-sm",children:J.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md overflow-hidden animate-in fade-in zoom-in duration-200",children:[J.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 p-4 flex justify-between items-center text-white",children:[J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx(J8,{size:20}),J.jsx("h3",{className:"font-bold text-lg",children:"Definir Fecha Fin Objetivo"})]}),J.jsx("button",{onClick:t,className:"hover:bg-white/20 p-1 rounded transition-colors",children:J.jsx(rA,{size:20})})]}),J.jsxs("div",{className:"p-6 space-y-4",children:[J.jsxs("div",{className:"text-sm text-gray-600 bg-blue-50 p-3 rounded-lg border border-blue-100",children:[J.jsxs("p",{children:["El sistema calcular automticamente la ",J.jsx("strong",{children:"Cantidad (Ton)"})," necesaria para que la orden:"]}),J.jsx("p",{className:"font-medium text-blue-800 mt-1",children:s||"Seleccionada"}),J.jsx("p",{children:"finalice exactamente en la fecha indicada."})]}),J.jsxs("div",{className:"space-y-2",children:[J.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nueva Fecha Fin"}),J.jsx("input",{type:"datetime-local",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all font-mono text-lg",value:o,onChange:h=>{a(h.target.value),c(null)}}),l&&J.jsx("p",{className:"text-red-500 text-sm mt-1",children:l})]}),i&&J.jsxs("p",{className:"text-xs text-gray-500",children:["* Fecha de Inicio actual: ",Nr(i,"dd/MM/yyyy HH:mm")]})]}),J.jsxs("div",{className:"p-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-3",children:[J.jsx("button",{onClick:t,className:"px-4 py-2 text-gray-700 font-medium hover:bg-gray-100 rounded-lg transition-colors",children:"Cancelar"}),J.jsxs("button",{onClick:u,className:"px-4 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 shadow-lg hover:shadow-xl transition-all flex items-center gap-2",children:[J.jsx(Fle,{size:18}),"Calcular y Guardar"]})]})]})})},zg="scheduler-column-state",ufe=()=>{const e=Lr(be=>be.activeProcessId),t=Lr(be=>be.processes[e]);if(!t)return J.jsx("div",{className:"flex items-center justify-center h-full text-zinc-500 bg-zinc-50/50",children:J.jsxs("div",{className:"flex flex-col items-center gap-3",children:[J.jsx("div",{className:"w-8 h-8 border-2 border-indigo-500 border-t-transparent rounded-full animate-spin"}),J.jsx("p",{className:"text-sm font-medium",children:"Cargando datos del proceso..."})]})});const{schedule:r,stoppageConfigs:n,programStartDate:i,scheduleHistory:s,columnLabels:o}=t,{insertScheduleItem:a,addScheduleItems:l,updateScheduleItem:c,deleteScheduleItem:u,clearSchedule:h,reorderSchedule:d,setProgramStartDate:f,recalculateSchedule:m,undo:v,canUndo:g,setColumnLabel:w,updateItemEndTime:y,setActiveTab:C,setVisualTargetDate:k}=Lr(),F=Ks(be=>be.articlesByProcess[e]||[]),[I,N]=ae.useState(null),j=st.useRef(null),[L,W]=ae.useState(null),[K,z]=ae.useState(null),[M,B]=ae.useState(!1);st.useEffect(()=>{const be=()=>B(!1);return window.addEventListener("mouseup",be),()=>window.removeEventListener("mouseup",be)},[]);const R=ae.useCallback((be,ze,we)=>{const Ee=we.getColDef();let Ie=be.getCellValue({rowNode:ze,colId:we.getColId()});return Ee.valueFormatter&&(Ie=Ee.valueFormatter({value:Ie,data:ze.data,node:ze,colDef:Ee,api:be,column:we,context:be.getGridOption("context")})),Ie},[]);st.useEffect(()=>{const be=ze=>{if(!L||!K||!j.current?.api)return;const we=document.activeElement;if(!(we?.closest(".ag-theme-quartz")||we===document.body)&&we?.tagName==="INPUT")return;const Ie=j.current.api,Pe=Ie.getAllDisplayedColumns(),De=Pe.findIndex(It=>It.getColId()===L.colId),Ze=Pe.findIndex(It=>It.getColId()===K.colId);if(De===-1||Ze===-1)return;const pt=Math.min(De,Ze),yt=Math.max(De,Ze),Pt=Math.min(L.rowIndex,K.rowIndex),$t=Math.max(L.rowIndex,K.rowIndex),Ct=[];for(let It=Pt;It<=$t;It++){const Ut=Ie.getDisplayedRowAtIndex(It);if(!Ut)continue;const _t=[];for(let sr=pt;sr<=yt;sr++){const Jt=Pe[sr],Tt=R(Ie,Ut,Jt);_t.push(Tt!=null?String(Tt):"")}Ct.push(_t.join("	"))}if(Ct.length>0){const It=Ct.join(`
`);ze.clipboardData&&(ze.clipboardData.setData("text/plain",It),ze.preventDefault())}};return document.addEventListener("copy",be),()=>document.removeEventListener("copy",be)},[L,K,R]);const S=ae.useCallback(be=>{be.node.rowIndex===null||be.node.rowIndex===void 0||(be.event.shiftKey&&L?(z({rowIndex:be.node.rowIndex,colId:be.column.getColId()}),B(!0)):(W({rowIndex:be.node.rowIndex,colId:be.column.getColId()}),z({rowIndex:be.node.rowIndex,colId:be.column.getColId()}),B(!0)))},[L]),_=ae.useCallback(be=>{M&&be.node.rowIndex!==null&&be.node.rowIndex!==void 0&&z({rowIndex:be.node.rowIndex,colId:be.column.getColId()})},[M]),T=ae.useCallback(be=>{const ze=be.stoppages?Object.values(be.stoppages).reduce((Ee,Ie)=>Ee+(Ie||0),0):0;return(be.segments||[]).filter(Ee=>Ee.type==="maintenance_hp").reduce((Ee,Ie)=>Ee+Ie.durationMinutes,0)>0||ze>30?"critical":(be.changeoverMinutes||0)>0||(be.adjustmentMinutes||0)>0?"warning":"normal"},[]),E=ae.useMemo(()=>({"row-critical":be=>T(be.data)==="critical","row-warning":be=>T(be.data)==="warning","row-normal":be=>T(be.data)==="normal"}),[T]),D=ae.useCallback(be=>{if(!L||!K)return!1;const ze=be.api;if(!ze)return!1;const we=be.node.rowIndex;if(we==null)return!1;const Ee=Math.min(L.rowIndex,K.rowIndex),Ie=Math.max(L.rowIndex,K.rowIndex);if(we<Ee||we>Ie)return!1;const Pe=ze.getAllDisplayedColumns(),De=Pe.findIndex(Ct=>Ct.getColId()===L.colId),Ze=Pe.findIndex(Ct=>Ct.getColId()===K.colId),pt=Math.min(De,Ze),yt=Math.max(De,Ze),Pt=be.column.getColId(),$t=Pe.findIndex(Ct=>Ct.getColId()===Pt);return $t>=pt&&$t<=yt},[L,K]),O=ae.useMemo(()=>({resizable:!0,sortable:!0,wrapHeaderText:!0,autoHeaderHeight:!0,cellClassRules:{"cell-selected":D}}),[D]);st.useEffect(()=>{const be=()=>N(null);return document.addEventListener("click",be),()=>document.removeEventListener("click",be)},[]);const[P,q]=ae.useState(null),X=be=>{P&&(y(P.itemId,be),q(null))},Q=ae.useCallback(be=>{be.event.preventDefault(),N({x:be.event.clientX,y:be.event.clientY,rowIndex:be.node.rowIndex,rowId:be.data.id})},[]),G=be=>{if(!I)return;const ze={id:Jw(),sequenceOrder:0,skuCode:"",quantity:0,calculatedPace:0,productionTimeMinutes:0,stoppages:{},startTime:new Date,endTime:new Date},we=I.rowIndex+be;a(we,ze),N(null)},ee=()=>{I&&(u(I.rowId),N(null))};st.useEffect(()=>{m()},[m]);const V=ae.useCallback(be=>{if(be.colDef.colId==="endTime"&&be.data){const ze=be.data;q({isOpen:!0,itemId:ze.id,initialDate:ze.endTime?new Date(ze.endTime):new Date,minDate:ze.startTime?new Date(ze.startTime):new Date,itemName:`${ze.skuCode} - ${F.find(we=>we.codigoProgramacion===ze.skuCode)?.descripcion||""}`})}},[F]),[H,Z]=ae.useState(null),[ie,te]=ae.useState(""),oe=ae.useCallback(be=>{try{const we=localStorage.getItem(zg);if(we){let Ee=JSON.parse(we);if(Array.isArray(Ee)){const Ie=be.api.getColumns()?.map(Pe=>Pe.getColId());Ie&&(Ee=Ee.filter(Pe=>Ie.includes(Pe.colId))),be.api.applyColumnState({state:Ee,applyOrder:!0})}}else be.api.autoSizeAllColumns()}catch(we){console.warn("Failed to restore column state:",we),be.api.autoSizeAllColumns()}const ze=document.querySelector(".ag-theme-quartz");ze&&ze.addEventListener("dblclick",we=>{const Ie=we.target.closest(".ag-header-cell");if(Ie){const Pe=Ie.getAttribute("col-id"),De=Ie.querySelector(".ag-header-cell-text")?.textContent||"";Pe&&Pe!==""&&Pe!=="undefined"&&(Z({field:Pe,defaultLabel:De}),te(o[Pe]||De))}})},[o]),ue=()=>{H&&ie.trim()&&w(H.field,ie.trim()),Z(null),te("")},Ce=ae.useCallback(be=>{const ze=be.api.getColumnState();localStorage.setItem(zg,JSON.stringify(ze))},[]),ye=ae.useCallback(()=>{const be=j.current?.api;if(!be)return;const ze=be.getColumnState();localStorage.setItem(zg,JSON.stringify(ze))},[]),ne=ae.useCallback(()=>{const be=j.current?.api;be&&be.autoSizeAllColumns()},[]),me=ae.useCallback(()=>{const be=j.current?.api;be&&(localStorage.removeItem(zg),be.resetColumnState(),setTimeout(()=>be.autoSizeAllColumns(),100))},[]),ve=ae.useMemo(()=>{if(r.length===0)return null;const be=r[r.length-1];return be?.endTime?new Date(be.endTime):null},[r]),Te=be=>{if(be.node.rowPinned==="bottom"){const ze=be.column.getColId(),we=be.data._breakdowns?.[ze],Ie=be.colDef.type==="numericColumn"||be.colDef.type==="rightAligned"?"justify-end":"justify-start";return J.jsx("div",{title:we,className:`w-full h-full flex items-center ${Ie} cursor-help decoration-dotted underline decoration-gray-400`,children:be.valueFormatted||be.value})}return be.valueFormatted||be.value},xe=ae.useMemo(()=>{const be=(we,Ee)=>{const Ie={};return r.forEach(Pe=>{let De=0;we!=="segments"&&(De=Pe[we]||0),De>0&&Pe.skuCode&&(Ie[Pe.skuCode]=(Ie[Pe.skuCode]||0)+De)}),Object.entries(Ie).sort(([,Pe],[,De])=>De-Pe).map(([Pe,De])=>`${Pe}: ${Math.round(De)} min`).join(`
`)},ze={skuCode:"TOTALES",quantity:r.reduce((we,Ee)=>we+(Ee.quantity||0),0),productionTimeMinutes:r.reduce((we,Ee)=>we+(Ee.productionTimeMinutes||0),0),changeoverMinutes:r.reduce((we,Ee)=>we+(Ee.changeoverMinutes||0),0),qualityChangeMinutes:r.reduce((we,Ee)=>we+(Ee.qualityChangeMinutes||0),0),stopChangeMinutes:r.reduce((we,Ee)=>we+(Ee.stopChangeMinutes||0),0),ringChangeMinutes:r.reduce((we,Ee)=>{const Ie=Ee.ringChangeMinutes||0,Pe=(Ee.segments||[]).filter(De=>De.type==="ring_change").reduce((De,Ze)=>De+Ze.durationMinutes,0);return we+Ie+Pe},0),channelChangeMinutes:r.reduce((we,Ee)=>{const Ie=Ee.channelChangeMinutes||0,Pe=(Ee.segments||[]).filter(De=>De.type==="channel_change").reduce((De,Ze)=>De+Ze.durationMinutes,0);return we+Ie+Pe},0),adjustmentMinutes:r.reduce((we,Ee)=>we+(Ee.adjustmentMinutes||0),0),maintenanceMinutes:r.reduce((we,Ee)=>we+(Ee.segments||[]).filter(Ie=>Ie.type==="maintenance_hp").reduce((Ie,Pe)=>Ie+Pe.durationMinutes,0),0),stoppages:{},_breakdowns:{changeoverMinutes:be("changeoverMinutes"),qualityChangeMinutes:be("qualityChangeMinutes"),stopChangeMinutes:be("stopChangeMinutes"),ringChangeMinutes:(()=>{const we={};return r.forEach(Ee=>{const Ie=Ee.ringChangeMinutes||0,Pe=(Ee.segments||[]).filter(Ze=>Ze.type==="ring_change").reduce((Ze,pt)=>Ze+pt.durationMinutes,0),De=Ie+Pe;De>0&&Ee.skuCode&&(we[Ee.skuCode]=(we[Ee.skuCode]||0)+De)}),Object.entries(we).sort(([,Ee],[,Ie])=>Ie-Ee).map(([Ee,Ie])=>`${Ee}: ${Math.round(Ie)} min`).join(`
`)})(),channelChangeMinutes:(()=>{const we={};return r.forEach(Ee=>{const Ie=Ee.channelChangeMinutes||0,Pe=(Ee.segments||[]).filter(Ze=>Ze.type==="channel_change").reduce((Ze,pt)=>Ze+pt.durationMinutes,0),De=Ie+Pe;De>0&&Ee.skuCode&&(we[Ee.skuCode]=(we[Ee.skuCode]||0)+De)}),Object.entries(we).sort(([,Ee],[,Ie])=>Ie-Ee).map(([Ee,Ie])=>`${Ee}: ${Math.round(Ie)} min`).join(`
`)})(),adjustmentMinutes:be("adjustmentMinutes"),maintenanceMinutes:(()=>{const we={};return r.forEach(Ee=>{const Ie=(Ee.segments||[]).filter(Pe=>Pe.type==="maintenance_hp").reduce((Pe,De)=>Pe+De.durationMinutes,0);Ie>0&&Ee.skuCode&&(we[Ee.skuCode]=(we[Ee.skuCode]||0)+Ie)}),Object.entries(we).sort(([,Ee],[,Ie])=>Ie-Ee).map(([Ee,Ie])=>`${Ee}: ${Math.round(Ie)} min`).join(`
`)})(),otherMinutes:(()=>{const we={};return r.forEach(Ee=>{const Ie=(Ee.segments||[]).filter(Pe=>Pe.type==="forced_stop").reduce((Pe,De)=>Pe+De.durationMinutes,0);Ie>0&&Ee.skuCode&&(we[Ee.skuCode]=(we[Ee.skuCode]||0)+Ie)}),Object.entries(we).sort(([,Ee],[,Ie])=>Ie-Ee).map(([Ee,Ie])=>`${Ee}: ${Math.round(Ie)} min`).join(`
`)})()}};return ze.otherMinutes=r.reduce((we,Ee)=>we+(Ee.segments||[]).filter(Ie=>Ie.type==="forced_stop").reduce((Ie,Pe)=>Ie+Pe.durationMinutes,0),0),n.forEach(we=>{ze.stoppages[we.id]=r.reduce((Ie,Pe)=>Ie+(Pe.stoppages?.[we.id]||0),0);const Ee={};r.forEach(Ie=>{const Pe=Ie.stoppages?.[we.id]||0;Pe>0&&Ie.skuCode&&(Ee[Ie.skuCode]=(Ee[Ie.skuCode]||0)+Pe)}),ze._breakdowns[we.id]=Object.entries(Ee).sort(([,Ie],[,Pe])=>Pe-Ie).map(([Ie,Pe])=>`${Ie}: ${Math.round(Pe)} min`).join(`
`)}),[ze]},[r,n]),Fe=ae.useMemo(()=>{const be=(we,Ee)=>o[we]||Ee,ze=[{rowDrag:!0,width:50,pinned:"left"},{colId:"sequenceOrder",field:"sequenceOrder",headerName:be("sequenceOrder","Seq"),width:60,pinned:"left",sortable:!0,valueFormatter:we=>we.value!=null?String(we.value+1):""},{colId:"skuCode",field:"skuCode",headerName:be("skuCode","Cd. Producto"),editable:!0,pinned:"left",width:140,wrapHeaderText:!0,autoHeaderHeight:!0,cellClass:we=>(F.some(Ie=>Ie.codigoProgramacion===we.value)?"font-bold":"bg-red-50 text-red-600")+" cell-mono"},{colId:"descripcion",headerName:be("descripcion","Descripcin"),width:300,wrapHeaderText:!0,autoHeaderHeight:!0,valueGetter:we=>{const Ee=F.find(Ie=>Ie.codigoProgramacion===we.data?.skuCode);return Ee?Ee.descripcion:"---"}},{colId:"calidadPalanquilla",headerName:be("calidadPalanquilla",`Calidad 
Palanquilla`),width:120,wrapHeaderText:!0,autoHeaderHeight:!0,valueGetter:we=>F.find(Ie=>Ie.codigoProgramacion===we.data?.skuCode)?.calidadPalanquilla||"---"},{colId:"quantity",field:"quantity",headerName:be("quantity","Cantidad (Ton)"),editable:!0,width:110,wrapHeaderText:!0,autoHeaderHeight:!0,type:"numericColumn",cellClass:"cell-mono",valueParser:we=>we.newValue?parseFloat(String(we.newValue).replace(/,/g,"")):0}];return ze.push({colId:"endTime",headerName:"Fin",width:160,editable:!0,valueGetter:we=>we.data?.endTime,valueSetter:we=>{if(!we.newValue)return!1;const Ee=new Date(we.newValue);return isNaN(Ee.getTime())?(alert("Formato de fecha invlido. Use AAAA-MM-DD HH:mm"),!1):(y(we.data.id,Ee),!0)},cellRenderer:we=>{if(!we.value)return"";let Ee="";try{Ee=Nr(new Date(we.value),"EEE dd/MM HH:mm",{locale:Xs})}catch{return""}return J.jsxs("div",{className:"flex items-center justify-between w-full h-full group",children:[J.jsx("span",{children:Ee}),J.jsx("button",{className:"p-1 hover:bg-blue-100 rounded text-gray-400 hover:text-blue-600 opacity-0 group-hover:opacity-100 transition-opacity",title:"Ver en Secuencia Diaria",onClick:Ie=>{Ie.stopPropagation(),k(new Date(we.value)),C("visual")},children:J.jsx(Kle,{size:16})})]})},cellStyle:{fontWeight:"bold",color:"#1e3a8a",display:"flex",alignItems:"center"}}),ze.push({colId:"ritmo",headerName:be("ritmo","Ritmo (T/H)"),width:100,wrapHeaderText:!0,autoHeaderHeight:!0,cellClass:"cell-mono",valueGetter:we=>we.data?.calculatedPace?.toFixed(0)||0}),ze.push({colId:"hTrab",headerName:be("hTrab","H-Trab"),width:90,wrapHeaderText:!0,autoHeaderHeight:!0,cellClass:"cell-mono",valueGetter:we=>((we.data?.productionTimeMinutes||0)/60).toFixed(1)}),ze.push({colId:"changeoverMinutes",headerName:be("changeoverMinutes","Cambio Medida"),width:100,wrapHeaderText:!0,autoHeaderHeight:!0,valueGetter:we=>we.data?.changeoverMinutes?`${Math.round(we.data.changeoverMinutes)} min`:"-",cellStyle:we=>we.data?.changeoverMinutes?{color:"#e11d48",fontWeight:"bold"}:void 0,cellRenderer:Te}),ze.push({colId:"maintenanceMinutes",headerName:be("maintenanceMinutes","Mantenimiento"),width:120,wrapHeaderText:!0,autoHeaderHeight:!0,valueGetter:we=>{const Ee=we.data;if(Ee&&Ee.maintenanceMinutes!==void 0){const De=Ee.maintenanceMinutes;return De>0?`${Math.round(De)} min`:"-"}const Pe=(Ee?.segments||[]).filter(De=>De.type==="maintenance_hp").reduce((De,Ze)=>De+Ze.durationMinutes,0);return Pe>0?`${Math.round(Pe)} min`:"-"},cellStyle:we=>{let Ee=0;const Ie=we.data;return Ie&&Ie.maintenanceMinutes!==void 0?Ee=Ie.maintenanceMinutes:Ee=(Ie?.segments||[]).filter(De=>De.type==="maintenance_hp").reduce((De,Ze)=>De+Ze.durationMinutes,0),Ee>0?{color:"#b91c1c",fontWeight:"bold"}:void 0},cellRenderer:Te}),ze.push({colId:"otherMinutes",headerName:be("otherMinutes","Otros"),width:100,wrapHeaderText:!0,autoHeaderHeight:!0,valueGetter:we=>{const Ee=we.data;if(Ee&&Ee.otherMinutes!==void 0){const De=Ee.otherMinutes;return De>0?`${Math.round(De)} min`:"-"}const Pe=(Ee?.segments||[]).filter(De=>De.type==="forced_stop").reduce((De,Ze)=>De+Ze.durationMinutes,0);return Pe>0?`${Math.round(Pe)} min`:"-"},cellStyle:we=>{let Ee=0;const Ie=we.data;return Ie&&Ie.otherMinutes!==void 0?Ee=Ie.otherMinutes:Ee=(Ie?.segments||[]).filter(De=>De.type==="forced_stop").reduce((De,Ze)=>De+Ze.durationMinutes,0),Ee>0?{backgroundColor:"#f3f4f6",color:"#1f2937",fontWeight:"bold"}:void 0},cellRenderer:Te}),ze.push({colId:"ringChangeMinutes",headerName:be("ringChangeMinutes","Cambio Anillo"),width:100,wrapHeaderText:!0,autoHeaderHeight:!0,valueGetter:we=>{const Ee=we.data?.ringChangeMinutes||0,Ie=(we.data?.segments||[]).filter(De=>De.type==="ring_change").reduce((De,Ze)=>De+Ze.durationMinutes,0),Pe=Ee+Ie;return Pe>0?`${Math.round(Pe)} min`:"-"},cellStyle:we=>{const Ee=we.data?.ringChangeMinutes||0,Ie=(we.data?.segments||[]).filter(Pe=>Pe.type==="ring_change").reduce((Pe,De)=>Pe+De.durationMinutes,0);return Ee+Ie>0?{color:"#7c3aed",fontWeight:"bold"}:void 0},cellRenderer:Te}),ze.push({colId:"channelChangeMinutes",headerName:be("channelChangeMinutes","Cambio Canal"),width:100,wrapHeaderText:!0,autoHeaderHeight:!0,valueGetter:we=>{const Ee=we.data?.channelChangeMinutes||0,Ie=(we.data?.segments||[]).filter(De=>De.type==="channel_change").reduce((De,Ze)=>De+Ze.durationMinutes,0),Pe=Ee+Ie;return Pe>0?`${Math.round(Pe)} min`:"-"},cellStyle:we=>{const Ee=we.data?.channelChangeMinutes||0,Ie=(we.data?.segments||[]).filter(Pe=>Pe.type==="channel_change").reduce((Pe,De)=>Pe+De.durationMinutes,0);return Ee+Ie>0?{color:"#ea580c",fontWeight:"bold"}:void 0},cellRenderer:Te}),ze.push({colId:"adjustmentMinutes",headerName:be("adjustmentMinutes","Acierto y Calibracin"),width:130,wrapHeaderText:!0,autoHeaderHeight:!0,valueGetter:we=>we.data?.adjustmentMinutes?`${Math.round(we.data.adjustmentMinutes)} min`:"-",cellStyle:we=>we.data?.adjustmentMinutes?{color:"#ca8a04",fontWeight:"bold"}:void 0,cellRenderer:Te}),ze.push({colId:"qualityChangeMinutes",headerName:be("qualityChangeMinutes","Cambio Calidad"),width:100,wrapHeaderText:!0,autoHeaderHeight:!0,valueGetter:we=>we.data?.qualityChangeMinutes?`${Math.round(we.data.qualityChangeMinutes)} min`:"-",cellStyle:we=>we.data?.qualityChangeMinutes?{color:"#9d174d",fontWeight:"bold"}:void 0,cellRenderer:Te}),ze.push({colId:"stopChangeMinutes",headerName:be("stopChangeMinutes","Cambio Tope"),width:100,wrapHeaderText:!0,autoHeaderHeight:!0,valueGetter:we=>we.data?.stopChangeMinutes?`${Math.round(we.data.stopChangeMinutes)} min`:"-",cellStyle:we=>we.data?.stopChangeMinutes?{color:"#0d9488",fontWeight:"bold"}:void 0,cellRenderer:Te}),n.forEach(we=>{ze.push({headerName:we.label,colId:we.id,width:100,editable:!0,wrapHeaderText:!0,autoHeaderHeight:!0,type:"numericColumn",valueGetter:Ee=>Ee.data?.stoppages?.[we.id]||0,cellRenderer:Te,valueSetter:Ee=>{const Ie=Number(String(Ee.newValue).replace(/,/g,""));if(isNaN(Ie))return!1;const Pe=Ee.data.stoppages||{};return Ee.data.stoppages={...Pe,[we.id]:Ie},!0}})}),ze.push({colId:"startTime",headerName:"Inicio",width:160,valueGetter:we=>we.data?.startTime,valueFormatter:we=>{if(!we.value)return"";try{return Nr(new Date(we.value),"EEE dd/MM HH:mm",{locale:Xs})}catch{return""}}}),ze.push({headerName:"",width:60,cellRenderer:we=>J.jsx("button",{onClick:()=>u(we.data.id),className:"text-gray-400 hover:text-red-600",children:J.jsx(sl,{size:16})})}),ze},[F,n,u,o,y]),Ge=ae.useCallback(be=>{const ze=be.clipboardData.getData("text");if(!ze)return;const Ee=j.current?.api?.getFocusedCell(),Ie=ze.split(/\r\n|\r|\n/).filter(Ze=>Ze.trim()!=="");if(Ie.length===0)return;if(Ee?.column.getColId()==="quantity"){be.preventDefault();const Ze=Ee.rowIndex;if(Ze==null)return;Ie.forEach((pt,yt)=>{const Pt=Ze+yt;if(Pt>=r.length)return;const $t=pt.split("	")[0].trim(),Ct=parseFloat($t.replace(/,/g,""));if(!isNaN(Ct)){const It=r[Pt];c(It.id,{quantity:Ct})}});return}const Pe=[],De=r.length;Ie.forEach((Ze,pt)=>{const yt=Ze.split("	");if(yt.length===0)return;const Pt=yt[0].trim(),$t=yt.length>1&&parseFloat(yt[1].trim().replace(/,/g,""))||0;Pt&&Pe.push({id:Jw(),sequenceOrder:De+pt,skuCode:Pt,quantity:$t,calculatedPace:0,productionTimeMinutes:0,stoppages:{},startTime:new Date,endTime:new Date})}),Pe.length>0&&(be.preventDefault(),l(Pe))},[r,l,c]),Ve=ae.useCallback(be=>{if(!be.data)return;const{id:ze}=be.data,we=be.colDef.field,Ee=be.colDef.colId;n.some(Pe=>Pe.id===Ee)&&Ee?c(ze,{stoppages:{...be.data.stoppages,[Ee]:Number(be.newValue)}}):we&&c(ze,{[we]:be.newValue})},[c,n]),Ye=ae.useCallback(be=>{const ze=[];be.api.forEachNode(we=>{we.data&&ze.push(we.data)}),d(ze)},[d]),ut=be=>{be.target.value&&f(new Date(be.target.value))},ht=()=>{window.confirm("Ests seguro de que quieres BORRAR TODA la programacin? esta accin no se puede deshacer.")&&h()};return J.jsxs("div",{className:"h-full flex flex-col gap-2 relative",onPaste:Ge,tabIndex:0,style:{outline:"none"},children:[P&&J.jsx(cfe,{isOpen:P.isOpen,onClose:()=>q(null),onSave:X,initialDate:P.initialDate,minDate:P.minDate,itemName:P.itemName}),I&&J.jsxs("div",{className:"fixed z-50 bg-white border border-gray-200 rounded-lg shadow-xl py-1 w-48",style:{top:I.y,left:I.x},children:[J.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-2 text-sm text-gray-700",onClick:()=>G(0),children:[J.jsx(kc,{size:14,className:"text-gray-500"}),"Insertar Fila Arriba"]}),J.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center gap-2 text-sm text-gray-700",onClick:()=>G(1),children:[J.jsx(kc,{size:14,className:"text-gray-500 transform rotate-180"}),"Insertar Fila Abajo"]}),J.jsx("div",{className:"border-t border-gray-100 my-1"}),J.jsxs("button",{className:"w-full text-left px-4 py-2 hover:bg-red-50 flex items-center gap-2 text-sm text-red-600",onClick:ee,children:[J.jsx(sl,{size:14}),"Eliminar Fila"]})]}),J.jsxs("div",{className:"flex flex-col gap-4 p-4 bg-white border-b border-gray-200",children:[J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsxs("div",{className:"flex items-center gap-6",children:[J.jsx("h2",{className:"text-xl font-bold text-gray-800 tracking-tight",children:"Programacin de Produccin"}),J.jsx("div",{className:"h-6 w-px bg-gray-300 mx-2"}),J.jsxs("div",{className:"flex items-center gap-4",children:[J.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 px-3 py-1.5 rounded-lg border border-gray-200 shadow-sm",children:[J.jsx(J8,{size:16,className:"text-gray-500"}),J.jsx("span",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide",children:"Inicio"}),J.jsx("input",{type:"datetime-local",className:"bg-transparent text-sm font-bold text-gray-900 outline-none w-36 font-mono",value:i?Nr(new Date(i),"yyyy-MM-dd'T'HH:mm"):"",onChange:ut})]}),ve&&J.jsxs("div",{className:"flex items-center gap-2 bg-blue-50 px-3 py-1.5 rounded-lg border border-blue-100 shadow-sm",children:[J.jsx("span",{className:"text-xs font-semibold text-blue-500 uppercase tracking-wide",children:"Fin Est."}),J.jsx("span",{className:"text-sm font-bold text-blue-900 font-mono",children:Nr(ve,"EEE dd/MM HH:mm",{locale:Xs})})]}),r.length>0&&J.jsxs(J.Fragment,{children:[J.jsxs("div",{className:"flex items-center gap-2 bg-green-50 px-3 py-1.5 rounded-lg border border-green-100 shadow-sm",children:[J.jsx("span",{className:"text-xs font-semibold text-green-600 uppercase tracking-wide",children:"Prod"}),J.jsxs("span",{className:"text-sm font-bold text-green-800 font-mono",children:[(r.reduce((be,ze)=>be+(ze.productionTimeMinutes||0),0)/60).toFixed(1)," h"]})]}),J.jsxs("div",{className:"flex items-center gap-2 bg-red-50 px-3 py-1.5 rounded-lg border border-red-100 shadow-sm",children:[J.jsx("span",{className:"text-xs font-semibold text-red-600 uppercase tracking-wide",children:"Paradas"}),J.jsxs("span",{className:"text-sm font-bold text-red-800 font-mono",children:[((r.reduce((be,ze)=>{const we=(ze.changeoverMinutes||0)+(ze.qualityChangeMinutes||0)+(ze.stopChangeMinutes||0)+(ze.ringChangeMinutes||0)+(ze.channelChangeMinutes||0)+(ze.adjustmentMinutes||0),Ee=(ze.segments||[]).filter(De=>De.type==="ring_change").reduce((De,Ze)=>De+Ze.durationMinutes,0),Ie=(ze.segments||[]).filter(De=>De.type==="channel_change").reduce((De,Ze)=>De+Ze.durationMinutes,0),Pe=(ze.segments||[]).filter(De=>De.type==="maintenance_hp").reduce((De,Ze)=>De+Ze.durationMinutes,0);return be+we+Ee+Ie+Pe},0)+r.reduce((be,ze)=>be+Object.values(ze.stoppages||{}).reduce((we,Ee)=>we+Ee,0),0))/60).toFixed(1)," h"]})]})]})]})]}),J.jsxs("span",{className:"text-xs text-green-600 flex items-center gap-1.5 px-3 py-1 bg-green-50 rounded-full border border-green-100 font-medium ml-auto mr-6",children:[J.jsxs("span",{className:"relative flex h-2 w-2",children:[J.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-green-400 opacity-75"}),J.jsx("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-green-500"})]}),"Guardado automtico"]})]}),J.jsxs("div",{className:"flex items-center justify-end gap-2 border-t border-gray-100 pt-3",children:[J.jsxs("div",{className:"flex items-center gap-1 mr-auto",children:[J.jsx("button",{onClick:ne,className:"p-2 text-gray-500 hover:bg-gray-100 hover:text-blue-600 rounded-lg transition-colors",title:"Autoajustar anchos al contenido",children:J.jsx(Ule,{size:18})}),J.jsx("button",{onClick:ye,className:"p-2 text-gray-500 hover:bg-gray-100 hover:text-green-600 rounded-lg transition-colors",title:"Guardar distribucin de columnas",children:J.jsx(vce,{size:18})}),J.jsx("button",{onClick:me,className:"p-2 text-gray-500 hover:bg-gray-100 hover:text-blue-600 rounded-lg transition-colors",title:"Restaurar distribucin por defecto",children:J.jsx(tA,{size:18})})]}),J.jsx("div",{className:"h-6 w-px bg-gray-200 mx-2"}),J.jsxs("button",{onClick:v,disabled:!g(),className:`
                            flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold transition-all
                            ${g()?"bg-amber-50 text-amber-700 hover:bg-amber-100 border border-amber-200":"bg-gray-50 text-gray-300 border border-gray-100 cursor-not-allowed"}
                        `,title:"Deshacer ltimo cambio",children:[J.jsx(Bce,{size:16}),"Deshacer ",s.length>0&&`(${s.length})`]}),J.jsxs("button",{onClick:ht,className:"flex items-center gap-2 px-3 py-1.5 rounded-lg text-xs font-semibold bg-white text-gray-500 border border-gray-200 hover:bg-red-50 hover:text-red-600 hover:border-red-200 transition-all",title:"Borrar toda la tabla",children:[J.jsx(sl,{size:16}),"Limpiar"]})]})]}),J.jsx("div",{className:"flex-1 ag-theme-quartz",children:J.jsx(Qy,{ref:j,rowData:r,columnDefs:Fe,defaultColDef:O,rowDragManaged:!0,rowSelection:{mode:"multiRow",enableClickSelection:!1},suppressCopyRowsToClipboard:!0,onRowDragEnd:Ye,onCellValueChanged:Ve,onCellContextMenu:Q,onCellMouseDown:S,onCellMouseOver:_,preventDefaultOnContextMenu:!0,animateRows:!0,getRowId:be=>be.data.id,pinnedBottomRowData:xe,onGridReady:oe,onCellDoubleClicked:V,rowClassRules:E,rowHeight:32,headerHeight:48,maintainColumnOrder:!0,onColumnResized:Ce,onColumnMoved:Ce,onColumnVisible:Ce,onColumnPinned:Ce})}),H&&J.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:J.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-96",children:[J.jsx("h3",{className:"text-lg font-bold text-gray-800 mb-4",children:"Editar Nombre de Columna"}),J.jsxs("p",{className:"text-sm text-gray-500 mb-2",children:["Columna: ",J.jsx("span",{className:"font-mono bg-gray-100 px-1 rounded",children:H.field})]}),J.jsx("input",{type:"text",value:ie,onChange:be=>te(be.target.value),onKeyDown:be=>{be.key==="Enter"&&ue(),be.key==="Escape"&&Z(null)},className:"w-full border border-gray-300 rounded px-3 py-2 mb-4 focus:outline-none focus:ring-2 focus:ring-blue-500",autoFocus:!0}),J.jsxs("div",{className:"flex justify-end gap-2",children:[J.jsx("button",{onClick:()=>Z(null),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded transition",children:"Cancelar"}),J.jsx("button",{onClick:ue,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Guardar"})]})]})})]})};function Ug(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Kb={exports:{}};var uT;function dfe(){return uT||(uT=1,(function(e,t){(function(r){e.exports=r()})((function(){return(function r(n,i,s){function o(c,u){if(!i[c]){if(!n[c]){var h=typeof Ug=="function"&&Ug;if(!u&&h)return h(c,!0);if(a)return a(c,!0);var d=new Error("Cannot find module '"+c+"'");throw d.code="MODULE_NOT_FOUND",d}var f=i[c]={exports:{}};n[c][0].call(f.exports,(function(m){return o(n[c][1][m]||m)}),f,f.exports,r,n,i,s)}return i[c].exports}for(var a=typeof Ug=="function"&&Ug,l=0;l<s.length;l++)o(s[l]);return o})({1:[function(r,n,i){const s=r("fs"),o=r("fast-csv"),a=r("dayjs/plugin/customParseFormat"),l=r("dayjs/plugin/utc"),c=r("dayjs").extend(a).extend(l),u=r("../utils/stream-buf"),{fs:{exists:h}}=r("../utils/utils"),d={true:!0,false:!1,"#N/A":{error:"#N/A"},"#REF!":{error:"#REF!"},"#NAME?":{error:"#NAME?"},"#DIV/0!":{error:"#DIV/0!"},"#NULL!":{error:"#NULL!"},"#VALUE!":{error:"#VALUE!"},"#NUM!":{error:"#NUM!"}};n.exports=class{constructor(f){this.workbook=f,this.worksheet=null}async readFile(f,m){if(m=m||{},!await h(f))throw new Error("File not found: "+f);const v=s.createReadStream(f),g=await this.read(v,m);return v.close(),g}read(f,m){return m=m||{},new Promise((v,g)=>{const w=this.workbook.addWorksheet(m.sheetName),y=m.dateFormats||["YYYY-MM-DD[T]HH:mm:ssZ","YYYY-MM-DD[T]HH:mm:ss","MM-DD-YYYY","YYYY-MM-DD"],C=m.map||function(F){if(F==="")return null;const I=Number(F);if(!Number.isNaN(I)&&I!==1/0)return I;const N=y.reduce((L,W)=>{if(L)return L;const K=c(F,W,!0);return K.isValid()?K:null},null);if(N)return new Date(N.valueOf());const j=d[F];return j!==void 0?j:F},k=o.parse(m.parserOptions).on("data",F=>{w.addRow(F.map(C))}).on("end",()=>{k.emit("worksheet",w)});k.on("worksheet",v).on("error",g),f.pipe(k)})}createInputStream(){throw new Error("`CSV#createInputStream` is deprecated. You should use `CSV#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}write(f,m){return new Promise((v,g)=>{m=m||{};const w=this.workbook.getWorksheet(m.sheetName||m.sheetId),y=o.format(m.formatterOptions);f.on("finish",()=>{v()}),y.on("error",g),y.pipe(f);const{dateFormat:C,dateUTC:k}=m,F=m.map||(j=>{if(j){if(j.text||j.hyperlink)return j.hyperlink||j.text||"";if(j.formula||j.result)return j.result||"";if(j instanceof Date)return C?k?c.utc(j).format(C):c(j).format(C):k?c.utc(j).format():c(j).format();if(j.error)return j.error;if(typeof j=="object")return JSON.stringify(j)}return j}),I=m.includeEmptyRows===void 0||m.includeEmptyRows;let N=1;w&&w.eachRow((j,L)=>{if(I)for(;N++<L-1;)y.write([]);const{values:W}=j;W.shift(),y.write(W.map(F)),N=L}),y.end()})}writeFile(f,m){const v={encoding:(m=m||{}).encoding||"utf8"},g=s.createWriteStream(f,v);return this.write(g,m)}async writeBuffer(f){const m=new u;return await this.write(m,f),m.read()}}},{"../utils/stream-buf":24,"../utils/utils":27,dayjs:391,"dayjs/plugin/customParseFormat":392,"dayjs/plugin/utc":393,"fast-csv":424,fs:216}],2:[function(r,n,i){const s=r("../utils/col-cache");class o{constructor(l,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(this.worksheet=l,c)if(typeof c=="string"){const h=s.decodeAddress(c);this.nativeCol=h.col+u,this.nativeColOff=0,this.nativeRow=h.row+u,this.nativeRowOff=0}else c.nativeCol!==void 0?(this.nativeCol=c.nativeCol||0,this.nativeColOff=c.nativeColOff||0,this.nativeRow=c.nativeRow||0,this.nativeRowOff=c.nativeRowOff||0):c.col!==void 0?(this.col=c.col+u,this.row=c.row+u):(this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0);else this.nativeCol=0,this.nativeColOff=0,this.nativeRow=0,this.nativeRowOff=0}static asInstance(l){return l instanceof o||l==null?l:new o(l)}get col(){return this.nativeCol+Math.min(this.colWidth-1,this.nativeColOff)/this.colWidth}set col(l){this.nativeCol=Math.floor(l),this.nativeColOff=Math.floor((l-this.nativeCol)*this.colWidth)}get row(){return this.nativeRow+Math.min(this.rowHeight-1,this.nativeRowOff)/this.rowHeight}set row(l){this.nativeRow=Math.floor(l),this.nativeRowOff=Math.floor((l-this.nativeRow)*this.rowHeight)}get colWidth(){return this.worksheet&&this.worksheet.getColumn(this.nativeCol+1)&&this.worksheet.getColumn(this.nativeCol+1).isCustomWidth?Math.floor(1e4*this.worksheet.getColumn(this.nativeCol+1).width):64e4}get rowHeight(){return this.worksheet&&this.worksheet.getRow(this.nativeRow+1)&&this.worksheet.getRow(this.nativeRow+1).height?Math.floor(1e4*this.worksheet.getRow(this.nativeRow+1).height):18e4}get model(){return{nativeCol:this.nativeCol,nativeColOff:this.nativeColOff,nativeRow:this.nativeRow,nativeRowOff:this.nativeRowOff}}set model(l){this.nativeCol=l.nativeCol,this.nativeColOff=l.nativeColOff,this.nativeRow=l.nativeRow,this.nativeRowOff=l.nativeRowOff}}n.exports=o},{"../utils/col-cache":19}],3:[function(r,n,i){const s=r("../utils/col-cache"),o=r("../utils/under-dash"),a=r("./enums"),{slideFormula:l}=r("../utils/shared-formula"),c=r("./note");class u{constructor(f,m,v){if(!f||!m)throw new Error("A Cell needs a Row");this._row=f,this._column=m,s.validateAddress(v),this._address=v,this._value=h.create(u.Types.Null,this),this.style=this._mergeStyle(f.style,m.style,{}),this._mergeCount=0}get worksheet(){return this._row.worksheet}get workbook(){return this._row.worksheet.workbook}destroy(){delete this.style,delete this._value,delete this._row,delete this._column,delete this._address}get numFmt(){return this.style.numFmt}set numFmt(f){this.style.numFmt=f}get font(){return this.style.font}set font(f){this.style.font=f}get alignment(){return this.style.alignment}set alignment(f){this.style.alignment=f}get border(){return this.style.border}set border(f){this.style.border=f}get fill(){return this.style.fill}set fill(f){this.style.fill=f}get protection(){return this.style.protection}set protection(f){this.style.protection=f}_mergeStyle(f,m,v){const g=f&&f.numFmt||m&&m.numFmt;g&&(v.numFmt=g);const w=f&&f.font||m&&m.font;w&&(v.font=w);const y=f&&f.alignment||m&&m.alignment;y&&(v.alignment=y);const C=f&&f.border||m&&m.border;C&&(v.border=C);const k=f&&f.fill||m&&m.fill;k&&(v.fill=k);const F=f&&f.protection||m&&m.protection;return F&&(v.protection=F),v}get address(){return this._address}get row(){return this._row.number}get col(){return this._column.number}get $col$row(){return`$${this._column.letter}$${this.row}`}get type(){return this._value.type}get effectiveType(){return this._value.effectiveType}toCsvString(){return this._value.toCsvString()}addMergeRef(){this._mergeCount++}releaseMergeRef(){this._mergeCount--}get isMerged(){return this._mergeCount>0||this.type===u.Types.Merge}merge(f,m){this._value.release(),this._value=h.create(u.Types.Merge,this,f),m||(this.style=f.style)}unmerge(){this.type===u.Types.Merge&&(this._value.release(),this._value=h.create(u.Types.Null,this),this.style=this._mergeStyle(this._row.style,this._column.style,{}))}isMergedTo(f){return this._value.type===u.Types.Merge&&this._value.isMergedTo(f)}get master(){return this.type===u.Types.Merge?this._value.master:this}get isHyperlink(){return this._value.type===u.Types.Hyperlink}get hyperlink(){return this._value.hyperlink}get value(){return this._value.value}set value(f){this.type!==u.Types.Merge?(this._value.release(),this._value=h.create(h.getType(f),this,f)):this._value.master.value=f}get note(){return this._comment&&this._comment.note}set note(f){this._comment=new c(f)}get text(){return this._value.toString()}get html(){return o.escapeHtml(this.text)}toString(){return this.text}_upgradeToHyperlink(f){this.type===u.Types.String&&(this._value=h.create(u.Types.Hyperlink,this,{text:this._value.value,hyperlink:f}))}get formula(){return this._value.formula}get result(){return this._value.result}get formulaType(){return this._value.formulaType}get fullAddress(){const{worksheet:f}=this._row;return{sheetName:f.name,address:this.address,row:this.row,col:this.col}}get name(){return this.names[0]}set name(f){this.names=[f]}get names(){return this.workbook.definedNames.getNamesEx(this.fullAddress)}set names(f){const{definedNames:m}=this.workbook;m.removeAllNames(this.fullAddress),f.forEach(v=>{m.addEx(this.fullAddress,v)})}addName(f){this.workbook.definedNames.addEx(this.fullAddress,f)}removeName(f){this.workbook.definedNames.removeEx(this.fullAddress,f)}removeAllNames(){this.workbook.definedNames.removeAllNames(this.fullAddress)}get _dataValidations(){return this.worksheet.dataValidations}get dataValidation(){return this._dataValidations.find(this.address)}set dataValidation(f){this._dataValidations.add(this.address,f)}get model(){const{model:f}=this._value;return f.style=this.style,this._comment&&(f.comment=this._comment.model),f}set model(f){this._value.release(),this._value=h.create(f.type,this),this._value.model=f,f.comment&&f.comment.type==="note"&&(this._comment=c.fromModel(f.comment)),f.style?this.style=f.style:this.style={}}}u.Types=a.ValueType;const h={getType:d=>d==null?u.Types.Null:d instanceof String||typeof d=="string"?u.Types.String:typeof d=="number"?u.Types.Number:typeof d=="boolean"?u.Types.Boolean:d instanceof Date?u.Types.Date:d.text&&d.hyperlink?u.Types.Hyperlink:d.formula||d.sharedFormula?u.Types.Formula:d.richText?u.Types.RichText:d.sharedString?u.Types.SharedString:d.error?u.Types.Error:u.Types.JSON,types:[{t:u.Types.Null,f:class{constructor(d){this.model={address:d.address,type:u.Types.Null}}get value(){return null}set value(d){}get type(){return u.Types.Null}get effectiveType(){return u.Types.Null}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return""}release(){}toString(){return""}}},{t:u.Types.Number,f:class{constructor(d,f){this.model={address:d.address,type:u.Types.Number,value:f}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return u.Types.Number}get effectiveType(){return u.Types.Number}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.String,f:class{constructor(d,f){this.model={address:d.address,type:u.Types.String,value:f}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return`"${this.model.value.replace(/"/g,'""')}"`}release(){}toString(){return this.model.value}}},{t:u.Types.Date,f:class{constructor(d,f){this.model={address:d.address,type:u.Types.Date,value:f}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return u.Types.Date}get effectiveType(){return u.Types.Date}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.value.toISOString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Hyperlink,f:class{constructor(d,f){this.model={address:d.address,type:u.Types.Hyperlink,text:f?f.text:void 0,hyperlink:f?f.hyperlink:void 0},f&&f.tooltip&&(this.model.tooltip=f.tooltip)}get value(){const d={text:this.model.text,hyperlink:this.model.hyperlink};return this.model.tooltip&&(d.tooltip=this.model.tooltip),d}set value(d){this.model={text:d.text,hyperlink:d.hyperlink},d.tooltip&&(this.model.tooltip=d.tooltip)}get text(){return this.model.text}set text(d){this.model.text=d}get hyperlink(){return this.model.hyperlink}set hyperlink(d){this.model.hyperlink=d}get type(){return u.Types.Hyperlink}get effectiveType(){return u.Types.Hyperlink}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.hyperlink}release(){}toString(){return this.model.text}}},{t:u.Types.Formula,f:class{constructor(d,f){this.cell=d,this.model={address:d.address,type:u.Types.Formula,shareType:f?f.shareType:void 0,ref:f?f.ref:void 0,formula:f?f.formula:void 0,sharedFormula:f?f.sharedFormula:void 0,result:f?f.result:void 0}}_copyModel(d){const f={},m=v=>{const g=d[v];g&&(f[v]=g)};return m("formula"),m("result"),m("ref"),m("shareType"),m("sharedFormula"),f}get value(){return this._copyModel(this.model)}set value(d){this.model=this._copyModel(d)}validate(d){switch(h.getType(d)){case u.Types.Null:case u.Types.String:case u.Types.Number:case u.Types.Date:break;case u.Types.Hyperlink:case u.Types.Formula:default:throw new Error("Cannot process that type of result value")}}get dependencies(){return{ranges:this.formula.match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g),cells:this.formula.replace(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}:[A-Z]{1,3}\d{1,4}/g,"").match(/([a-zA-Z0-9]+!)?[A-Z]{1,3}\d{1,4}/g)}}get formula(){return this.model.formula||this._getTranslatedFormula()}set formula(d){this.model.formula=d}get formulaType(){return this.model.formula?a.FormulaType.Master:this.model.sharedFormula?a.FormulaType.Shared:a.FormulaType.None}get result(){return this.model.result}set result(d){this.model.result=d}get type(){return u.Types.Formula}get effectiveType(){const d=this.model.result;return d==null?a.ValueType.Null:d instanceof String||typeof d=="string"?a.ValueType.String:typeof d=="number"?a.ValueType.Number:d instanceof Date?a.ValueType.Date:d.text&&d.hyperlink?a.ValueType.Hyperlink:d.formula?a.ValueType.Formula:a.ValueType.Null}get address(){return this.model.address}set address(d){this.model.address=d}_getTranslatedFormula(){if(!this._translatedFormula&&this.model.sharedFormula){const{worksheet:d}=this.cell,f=d.findCell(this.model.sharedFormula);this._translatedFormula=f&&l(f.formula,f.address,this.model.address)}return this._translatedFormula}toCsvString(){return""+(this.model.result||"")}release(){}toString(){return this.model.result?this.model.result.toString():""}}},{t:u.Types.Merge,f:class{constructor(d,f){this.model={address:d.address,type:u.Types.Merge,master:f?f.address:void 0},this._master=f,f&&f.addMergeRef()}get value(){return this._master.value}set value(d){d instanceof u?(this._master&&this._master.releaseMergeRef(),d.addMergeRef(),this._master=d):this._master.value=d}isMergedTo(d){return d===this._master}get master(){return this._master}get type(){return u.Types.Merge}get effectiveType(){return this._master.effectiveType}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return""}release(){this._master.releaseMergeRef()}toString(){return this.value.toString()}}},{t:u.Types.JSON,f:class{constructor(d,f){this.model={address:d.address,type:u.Types.String,value:JSON.stringify(f),rawValue:f}}get value(){return this.model.rawValue}set value(d){this.model.rawValue=d,this.model.value=JSON.stringify(d)}get type(){return u.Types.String}get effectiveType(){return u.Types.String}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.value}release(){}toString(){return this.model.value}}},{t:u.Types.SharedString,f:class{constructor(d,f){this.model={address:d.address,type:u.Types.SharedString,value:f}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return u.Types.SharedString}get effectiveType(){return u.Types.SharedString}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.value.toString()}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.RichText,f:class{constructor(d,f){this.model={address:d.address,type:u.Types.String,value:f}}get value(){return this.model.value}set value(d){this.model.value=d}toString(){return this.model.value.richText.map(d=>d.text).join("")}get type(){return u.Types.RichText}get effectiveType(){return u.Types.RichText}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return`"${this.text.replace(/"/g,'""')}"`}release(){}}},{t:u.Types.Boolean,f:class{constructor(d,f){this.model={address:d.address,type:u.Types.Boolean,value:f}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return u.Types.Boolean}get effectiveType(){return u.Types.Boolean}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.model.value?1:0}release(){}toString(){return this.model.value.toString()}}},{t:u.Types.Error,f:class{constructor(d,f){this.model={address:d.address,type:u.Types.Error,value:f}}get value(){return this.model.value}set value(d){this.model.value=d}get type(){return u.Types.Error}get effectiveType(){return u.Types.Error}get address(){return this.model.address}set address(d){this.model.address=d}toCsvString(){return this.toString()}release(){}toString(){return this.model.value.error.toString()}}}].reduce((d,f)=>(d[f.t]=f.f,d),[]),create(d,f,m){const v=this.types[d];if(!v)throw new Error("Could not create Value of type "+d);return new v(f,m)}};n.exports=u},{"../utils/col-cache":19,"../utils/shared-formula":23,"../utils/under-dash":26,"./enums":7,"./note":9}],4:[function(r,n,i){const s=r("../utils/under-dash"),o=r("./enums"),a=r("../utils/col-cache");class l{constructor(u,h,d){this._worksheet=u,this._number=h,d!==!1&&(this.defn=d)}get number(){return this._number}get worksheet(){return this._worksheet}get letter(){return a.n2l(this._number)}get isCustomWidth(){return this.width!==void 0&&this.width!==9}get defn(){return{header:this._header,key:this.key,width:this.width,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel}}set defn(u){u?(this.key=u.key,this.width=u.width!==void 0?u.width:9,this.outlineLevel=u.outlineLevel,u.style?this.style=u.style:this.style={},this.header=u.header,this._hidden=!!u.hidden):(delete this._header,delete this._key,delete this.width,this.style={},this.outlineLevel=0)}get headers(){return this._header&&this._header instanceof Array?this._header:[this._header]}get header(){return this._header}set header(u){u!==void 0?(this._header=u,this.headers.forEach((h,d)=>{this._worksheet.getCell(d+1,this.number).value=h})):this._header=void 0}get key(){return this._key}set key(u){(this._key&&this._worksheet.getColumnKey(this._key))===this&&this._worksheet.deleteColumnKey(this._key),this._key=u,u&&this._worksheet.setColumnKey(this._key,this)}get hidden(){return!!this._hidden}set hidden(u){this._hidden=u}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(u){this._outlineLevel=u}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelCol)}toString(){return JSON.stringify({key:this.key,width:this.width,headers:this.headers.length?this.headers:void 0})}equivalentTo(u){return this.width===u.width&&this.hidden===u.hidden&&this.outlineLevel===u.outlineLevel&&s.isEqual(this.style,u.style)}get isDefault(){if(this.isCustomWidth||this.hidden||this.outlineLevel)return!1;const u=this.style;return!u||!(u.font||u.numFmt||u.alignment||u.border||u.fill||u.protection)}get headerCount(){return this.headers.length}eachCell(u,h){const d=this.number;h||(h=u,u=null),this._worksheet.eachRow(u,(f,m)=>{h(f.getCell(d),m)})}get values(){const u=[];return this.eachCell((h,d)=>{h&&h.type!==o.ValueType.Null&&(u[d]=h.value)}),u}set values(u){if(!u)return;const h=this.number;let d=0;u.hasOwnProperty("0")&&(d=1),u.forEach((f,m)=>{this._worksheet.getCell(m+d,h).value=f})}_applyStyle(u,h){return this.style[u]=h,this.eachCell(d=>{d[u]=h}),h}get numFmt(){return this.style.numFmt}set numFmt(u){this._applyStyle("numFmt",u)}get font(){return this.style.font}set font(u){this._applyStyle("font",u)}get alignment(){return this.style.alignment}set alignment(u){this._applyStyle("alignment",u)}get protection(){return this.style.protection}set protection(u){this._applyStyle("protection",u)}get border(){return this.style.border}set border(u){this._applyStyle("border",u)}get fill(){return this.style.fill}set fill(u){this._applyStyle("fill",u)}static toModel(u){const h=[];let d=null;return u&&u.forEach((f,m)=>{f.isDefault?d&&(d=null):d&&f.equivalentTo(d)?d.max=m+1:(d={min:m+1,max:m+1,width:f.width!==void 0?f.width:9,style:f.style,isCustomWidth:f.isCustomWidth,hidden:f.hidden,outlineLevel:f.outlineLevel,collapsed:f.collapsed},h.push(d))}),h.length?h:void 0}static fromModel(u,h){const d=[];let f=1,m=0;for(h=(h=h||[]).sort((function(v,g){return v.min-g.min}));m<h.length;){const v=h[m++];for(;f<v.min;)d.push(new l(u,f++));for(;f<=v.max;)d.push(new l(u,f++,v))}return d.length?d:null}}n.exports=l},{"../utils/col-cache":19,"../utils/under-dash":26,"./enums":7}],5:[function(r,n,i){n.exports=class{constructor(s){this.model=s||{}}add(s,o){return this.model[s]=o}find(s){return this.model[s]}remove(s){this.model[s]=void 0}}},{}],6:[function(r,n,i){const s=r("../utils/under-dash"),o=r("../utils/col-cache"),a=r("../utils/cell-matrix"),l=r("./range"),c=/[$](\w+)[$](\d+)(:[$](\w+)[$](\d+))?/;n.exports=class{constructor(){this.matrixMap={}}getMatrix(u){return this.matrixMap[u]||(this.matrixMap[u]=new a)}add(u,h){const d=o.decodeEx(u);this.addEx(d,h)}addEx(u,h){const d=this.getMatrix(h);if(u.top)for(let f=u.left;f<=u.right;f++)for(let m=u.top;m<=u.bottom;m++){const v={sheetName:u.sheetName,address:o.n2l(f)+m,row:m,col:f};d.addCellEx(v)}else d.addCellEx(u)}remove(u,h){const d=o.decodeEx(u);this.removeEx(d,h)}removeEx(u,h){this.getMatrix(h).removeCellEx(u)}removeAllNames(u){s.each(this.matrixMap,h=>{h.removeCellEx(u)})}forEach(u){s.each(this.matrixMap,(h,d)=>{h.forEach(f=>{u(d,f)})})}getNames(u){return this.getNamesEx(o.decodeEx(u))}getNamesEx(u){return s.map(this.matrixMap,(h,d)=>h.findCellEx(u)&&d).filter(Boolean)}_explore(u,h){h.mark=!1;const{sheetName:d}=h,f=new l(h.row,h.col,h.row,h.col,d);let m,v;function g(y,C){const k=u.findCellAt(d,y,h.col);return!(!k||!k.mark)&&(f[C]=y,k.mark=!1,!0)}for(v=h.row-1;g(v,"top");v--);for(v=h.row+1;g(v,"bottom");v++);function w(y,C){const k=[];for(v=f.top;v<=f.bottom;v++){const F=u.findCellAt(d,v,y);if(!F||!F.mark)return!1;k.push(F)}f[C]=y;for(let F=0;F<k.length;F++)k[F].mark=!1;return!0}for(m=h.col-1;w(m,"left");m--);for(m=h.col+1;w(m,"right");m++);return f}getRanges(u,h){return(h=h||this.matrixMap[u])?(h.forEach(d=>{d.mark=!0}),{name:u,ranges:h.map(d=>d.mark&&this._explore(h,d)).filter(Boolean).map(d=>d.$shortRange)}):{name:u,ranges:[]}}normaliseMatrix(u,h){u.forEachInSheet(h,(d,f,m)=>{d&&(d.row===f&&d.col===m||(d.row=f,d.col=m,d.address=o.n2l(m)+f))})}spliceRows(u,h,d,f){s.each(this.matrixMap,m=>{m.spliceRows(u,h,d,f),this.normaliseMatrix(m,u)})}spliceColumns(u,h,d,f){s.each(this.matrixMap,m=>{m.spliceColumns(u,h,d,f),this.normaliseMatrix(m,u)})}get model(){return s.map(this.matrixMap,(u,h)=>this.getRanges(h,u)).filter(u=>u.ranges.length)}set model(u){const h=this.matrixMap={};u.forEach(d=>{const f=h[d.name]=new a;d.ranges.forEach(m=>{c.test(m.split("!").pop()||"")&&f.addCell(m)})})}}},{"../utils/cell-matrix":18,"../utils/col-cache":19,"../utils/under-dash":26,"./range":10}],7:[function(r,n,i){n.exports={ValueType:{Null:0,Merge:1,Number:2,String:3,Date:4,Hyperlink:5,Formula:6,SharedString:7,RichText:8,Boolean:9,Error:10},FormulaType:{None:0,Master:1,Shared:2},RelationshipType:{None:0,OfficeDocument:1,Worksheet:2,CalcChain:3,SharedStrings:4,Styles:5,Theme:6,Hyperlink:7},DocumentType:{Xlsx:1},ReadingOrder:{LeftToRight:1,RightToLeft:2},ErrorValue:{NotApplicable:"#N/A",Ref:"#REF!",Name:"#NAME?",DivZero:"#DIV/0!",Null:"#NULL!",Value:"#VALUE!",Num:"#NUM!"}}},{}],8:[function(r,n,i){const s=r("../utils/col-cache"),o=r("./anchor");n.exports=class{constructor(a,l){this.worksheet=a,this.model=l}get model(){switch(this.type){case"background":return{type:this.type,imageId:this.imageId};case"image":return{type:this.type,imageId:this.imageId,hyperlinks:this.range.hyperlinks,range:{tl:this.range.tl.model,br:this.range.br&&this.range.br.model,ext:this.range.ext,editAs:this.range.editAs}};default:throw new Error("Invalid Image Type")}}set model(a){let{type:l,imageId:c,range:u,hyperlinks:h}=a;if(this.type=l,this.imageId=c,l==="image")if(typeof u=="string"){const d=s.decode(u);this.range={tl:new o(this.worksheet,{col:d.left,row:d.top},-1),br:new o(this.worksheet,{col:d.right,row:d.bottom},0),editAs:"oneCell"}}else this.range={tl:new o(this.worksheet,u.tl,0),br:u.br&&new o(this.worksheet,u.br,0),ext:u.ext,editAs:u.editAs,hyperlinks:h||u.hyperlinks}}}},{"../utils/col-cache":19,"./anchor":2}],9:[function(r,n,i){const s=r("../utils/under-dash");class o{constructor(l){this.note=l}get model(){let l=null;return typeof this.note==="string"?l={type:"note",note:{texts:[{text:this.note}]}}:l={type:"note",note:this.note},s.deepMerge({},o.DEFAULT_CONFIGS,l)}set model(l){const{note:c}=l,{texts:u}=c;u.length===1&&Object.keys(u[0]).length===1?this.note=u[0].text:this.note=c}static fromModel(l){const c=new o;return c.model=l,c}}o.DEFAULT_CONFIGS={note:{margins:{insetmode:"auto",inset:[.13,.13,.25,.25]},protection:{locked:"True",lockText:"True"},editAs:"absolute"}},n.exports=o},{"../utils/under-dash":26}],10:[function(r,n,i){const s=r("../utils/col-cache");class o{constructor(){this.decode(arguments)}setTLBR(l,c,u,h,d){if(arguments.length<4){const f=s.decodeAddress(l),m=s.decodeAddress(c);this.model={top:Math.min(f.row,m.row),left:Math.min(f.col,m.col),bottom:Math.max(f.row,m.row),right:Math.max(f.col,m.col),sheetName:u},this.setTLBR(f.row,f.col,m.row,m.col,d)}else this.model={top:Math.min(l,u),left:Math.min(c,h),bottom:Math.max(l,u),right:Math.max(c,h),sheetName:d}}decode(l){switch(l.length){case 5:this.setTLBR(l[0],l[1],l[2],l[3],l[4]);break;case 4:this.setTLBR(l[0],l[1],l[2],l[3]);break;case 3:this.setTLBR(l[0],l[1],l[2]);break;case 2:this.setTLBR(l[0],l[1]);break;case 1:{const c=l[0];if(c instanceof o)this.model={top:c.model.top,left:c.model.left,bottom:c.model.bottom,right:c.model.right,sheetName:c.sheetName};else if(c instanceof Array)this.decode(c);else if(c.top&&c.left&&c.bottom&&c.right)this.model={top:c.top,left:c.left,bottom:c.bottom,right:c.right,sheetName:c.sheetName};else{const u=s.decodeEx(c);u.top?this.model={top:u.top,left:u.left,bottom:u.bottom,right:u.right,sheetName:u.sheetName}:this.model={top:u.row,left:u.col,bottom:u.row,right:u.col,sheetName:u.sheetName}}break}case 0:this.model={top:0,left:0,bottom:0,right:0};break;default:throw new Error("Invalid number of arguments to _getDimensions() - "+l.length)}}get top(){return this.model.top||1}set top(l){this.model.top=l}get left(){return this.model.left||1}set left(l){this.model.left=l}get bottom(){return this.model.bottom||1}set bottom(l){this.model.bottom=l}get right(){return this.model.right||1}set right(l){this.model.right=l}get sheetName(){return this.model.sheetName}set sheetName(l){this.model.sheetName=l}get _serialisedSheetName(){const{sheetName:l}=this.model;return l?/^[a-zA-Z0-9]*$/.test(l)?l+"!":`'${l}'!`:""}expand(l,c,u,h){(!this.model.top||l<this.top)&&(this.top=l),(!this.model.left||c<this.left)&&(this.left=c),(!this.model.bottom||u>this.bottom)&&(this.bottom=u),(!this.model.right||h>this.right)&&(this.right=h)}expandRow(l){if(l){const{dimensions:c,number:u}=l;c&&this.expand(u,c.min,u,c.max)}}expandToAddress(l){const c=s.decodeEx(l);this.expand(c.row,c.col,c.row,c.col)}get tl(){return s.n2l(this.left)+this.top}get $t$l(){return`$${s.n2l(this.left)}$${this.top}`}get br(){return s.n2l(this.right)+this.bottom}get $b$r(){return`$${s.n2l(this.right)}$${this.bottom}`}get range(){return`${this._serialisedSheetName+this.tl}:${this.br}`}get $range(){return`${this._serialisedSheetName+this.$t$l}:${this.$b$r}`}get shortRange(){return this.count>1?this.range:this._serialisedSheetName+this.tl}get $shortRange(){return this.count>1?this.$range:this._serialisedSheetName+this.$t$l}get count(){return(1+this.bottom-this.top)*(1+this.right-this.left)}toString(){return this.range}intersects(l){return(!l.sheetName||!this.sheetName||l.sheetName===this.sheetName)&&!(l.bottom<this.top)&&!(l.top>this.bottom)&&!(l.right<this.left)&&!(l.left>this.right)}contains(l){const c=s.decodeEx(l);return this.containsEx(c)}containsEx(l){return(!l.sheetName||!this.sheetName||l.sheetName===this.sheetName)&&l.row>=this.top&&l.row<=this.bottom&&l.col>=this.left&&l.col<=this.right}forEachAddress(l){for(let c=this.left;c<=this.right;c++)for(let u=this.top;u<=this.bottom;u++)l(s.encodeAddress(u,c),u,c)}}n.exports=o},{"../utils/col-cache":19}],11:[function(r,n,i){const s=r("../utils/under-dash"),o=r("./enums"),a=r("../utils/col-cache"),l=r("./cell");n.exports=class{constructor(c,u){this._worksheet=c,this._number=u,this._cells=[],this.style={},this.outlineLevel=0}get number(){return this._number}get worksheet(){return this._worksheet}commit(){this._worksheet._commitRow(this)}destroy(){delete this._worksheet,delete this._cells,delete this.style}findCell(c){return this._cells[c-1]}getCellEx(c){let u=this._cells[c.col-1];if(!u){const h=this._worksheet.getColumn(c.col);u=new l(this,h,c.address),this._cells[c.col-1]=u}return u}getCell(c){if(typeof c=="string"){const u=this._worksheet.getColumnKey(c);c=u?u.number:a.l2n(c)}return this._cells[c-1]||this.getCellEx({address:a.encodeAddress(this._number,c),row:this._number,col:c})}splice(c,u){const h=c+u;for(var d=arguments.length,f=new Array(d>2?d-2:0),m=2;m<d;m++)f[m-2]=arguments[m];const v=f.length-u,g=this._cells.length;let w,y,C;if(v<0)for(w=c+f.length;w<=g;w++)C=this._cells[w-1],y=this._cells[w-v-1],y?(C=this.getCell(w),C.value=y.value,C.style=y.style,C._comment=y._comment):C&&(C.value=null,C.style={},C._comment=void 0);else if(v>0)for(w=g;w>=h;w--)y=this._cells[w-1],y?(C=this.getCell(w+v),C.value=y.value,C.style=y.style,C._comment=y._comment):this._cells[w+v-1]=void 0;for(w=0;w<f.length;w++)C=this.getCell(c+w),C.value=f[w],C.style={},C._comment=void 0}eachCell(c,u){if(u||(u=c,c=null),c&&c.includeEmpty){const h=this._cells.length;for(let d=1;d<=h;d++)u(this.getCell(d),d)}else this._cells.forEach((h,d)=>{h&&h.type!==o.ValueType.Null&&u(h,d+1)})}addPageBreak(c,u){const h=this._worksheet,d=Math.max(0,c-1)||0,f=Math.max(0,u-1)||16838,m={id:this._number,max:f,man:1};d&&(m.min=d),h.rowBreaks.push(m)}get values(){const c=[];return this._cells.forEach(u=>{u&&u.type!==o.ValueType.Null&&(c[u.col]=u.value)}),c}set values(c){if(this._cells=[],c)if(c instanceof Array){let u=0;c.hasOwnProperty("0")&&(u=1),c.forEach((h,d)=>{h!==void 0&&(this.getCellEx({address:a.encodeAddress(this._number,d+u),row:this._number,col:d+u}).value=h)})}else this._worksheet.eachColumnKey((u,h)=>{c[h]!==void 0&&(this.getCellEx({address:a.encodeAddress(this._number,u.number),row:this._number,col:u.number}).value=c[h])})}get hasValues(){return s.some(this._cells,c=>c&&c.type!==o.ValueType.Null)}get cellCount(){return this._cells.length}get actualCellCount(){let c=0;return this.eachCell(()=>{c++}),c}get dimensions(){let c=0,u=0;return this._cells.forEach(h=>{h&&h.type!==o.ValueType.Null&&((!c||c>h.col)&&(c=h.col),u<h.col&&(u=h.col))}),c>0?{min:c,max:u}:null}_applyStyle(c,u){return this.style[c]=u,this._cells.forEach(h=>{h&&(h[c]=u)}),u}get numFmt(){return this.style.numFmt}set numFmt(c){this._applyStyle("numFmt",c)}get font(){return this.style.font}set font(c){this._applyStyle("font",c)}get alignment(){return this.style.alignment}set alignment(c){this._applyStyle("alignment",c)}get protection(){return this.style.protection}set protection(c){this._applyStyle("protection",c)}get border(){return this.style.border}set border(c){this._applyStyle("border",c)}get fill(){return this.style.fill}set fill(c){this._applyStyle("fill",c)}get hidden(){return!!this._hidden}set hidden(c){this._hidden=c}get outlineLevel(){return this._outlineLevel||0}set outlineLevel(c){this._outlineLevel=c}get collapsed(){return!!(this._outlineLevel&&this._outlineLevel>=this._worksheet.properties.outlineLevelRow)}get model(){const c=[];let u=0,h=0;return this._cells.forEach(d=>{if(d){const f=d.model;f&&((!u||u>d.col)&&(u=d.col),h<d.col&&(h=d.col),c.push(f))}}),this.height||c.length?{cells:c,number:this.number,min:u,max:h,height:this.height,style:this.style,hidden:this.hidden,outlineLevel:this.outlineLevel,collapsed:this.collapsed}:null}set model(c){if(c.number!==this._number)throw new Error("Invalid row number in model");let u;this._cells=[],c.cells.forEach(h=>{switch(h.type){case l.Types.Merge:break;default:{let d;if(h.address)d=a.decodeAddress(h.address);else if(u){const{row:f}=u,m=u.col+1;d={row:f,col:m,address:a.encodeAddress(f,m),$col$row:`$${a.n2l(m)}$${f}`}}u=d,this.getCellEx(d).model=h;break}}}),c.height?this.height=c.height:delete this.height,this.hidden=c.hidden,this.outlineLevel=c.outlineLevel||0,this.style=c.style&&JSON.parse(JSON.stringify(c.style))||{}}}},{"../utils/col-cache":19,"../utils/under-dash":26,"./cell":3,"./enums":7}],12:[function(r,n,i){const s=r("../utils/col-cache");class o{constructor(l,c,u){this.table=l,this.column=c,this.index=u}_set(l,c){this.table.cacheState(),this.column[l]=c}get name(){return this.column.name}set name(l){this._set("name",l)}get filterButton(){return this.column.filterButton}set filterButton(l){this.column.filterButton=l}get style(){return this.column.style}set style(l){this.column.style=l}get totalsRowLabel(){return this.column.totalsRowLabel}set totalsRowLabel(l){this._set("totalsRowLabel",l)}get totalsRowFunction(){return this.column.totalsRowFunction}set totalsRowFunction(l){this._set("totalsRowFunction",l)}get totalsRowResult(){return this.column.totalsRowResult}set totalsRowResult(l){this._set("totalsRowResult",l)}get totalsRowFormula(){return this.column.totalsRowFormula}set totalsRowFormula(l){this._set("totalsRowFormula",l)}}n.exports=class{constructor(a,l){this.worksheet=a,l&&(this.table=l,this.validate(),this.store())}getFormula(a){switch(a.totalsRowFunction){case"none":return null;case"average":return`SUBTOTAL(101,${this.table.name}[${a.name}])`;case"countNums":return`SUBTOTAL(102,${this.table.name}[${a.name}])`;case"count":return`SUBTOTAL(103,${this.table.name}[${a.name}])`;case"max":return`SUBTOTAL(104,${this.table.name}[${a.name}])`;case"min":return`SUBTOTAL(105,${this.table.name}[${a.name}])`;case"stdDev":return`SUBTOTAL(106,${this.table.name}[${a.name}])`;case"var":return`SUBTOTAL(107,${this.table.name}[${a.name}])`;case"sum":return`SUBTOTAL(109,${this.table.name}[${a.name}])`;case"custom":return a.totalsRowFormula;default:throw new Error("Invalid Totals Row Function: "+a.totalsRowFunction)}}get width(){return this.table.columns.length}get height(){return this.table.rows.length}get filterHeight(){return this.height+(this.table.headerRow?1:0)}get tableHeight(){return this.filterHeight+(this.table.totalsRow?1:0)}validate(){const{table:a}=this,l=(v,g,w)=>{v[g]===void 0&&(v[g]=w)};l(a,"headerRow",!0),l(a,"totalsRow",!1),l(a,"style",{}),l(a.style,"theme","TableStyleMedium2"),l(a.style,"showFirstColumn",!1),l(a.style,"showLastColumn",!1),l(a.style,"showRowStripes",!1),l(a.style,"showColumnStripes",!1);const c=(v,g)=>{if(!v)throw new Error(g)};c(a.ref,"Table must have ref"),c(a.columns,"Table must have column definitions"),c(a.rows,"Table must have row definitions"),a.tl=s.decodeAddress(a.ref);const{row:u,col:h}=a.tl;c(u>0,"Table must be on valid row"),c(h>0,"Table must be on valid col");const{width:d,filterHeight:f,tableHeight:m}=this;a.autoFilterRef=s.encode(u,h,u+f-1,h+d-1),a.tableRef=s.encode(u,h,u+m-1,h+d-1),a.columns.forEach((v,g)=>{c(v.name,`Column ${g} must have a name`),g===0?l(v,"totalsRowLabel","Total"):(l(v,"totalsRowFunction","none"),v.totalsRowFormula=this.getFormula(v))})}store(){const a=(f,m)=>{m&&Object.keys(m).forEach(v=>{f[v]=m[v]})},{worksheet:l,table:c}=this,{row:u,col:h}=c.tl;let d=0;if(c.headerRow){const f=l.getRow(u+d++);c.columns.forEach((m,v)=>{const{style:g,name:w}=m,y=f.getCell(h+v);y.value=w,a(y,g)})}if(c.rows.forEach(f=>{const m=l.getRow(u+d++);f.forEach((v,g)=>{const w=m.getCell(h+g);w.value=v,a(w,c.columns[g].style)})}),c.totalsRow){const f=l.getRow(u+d++);c.columns.forEach((m,v)=>{const g=f.getCell(h+v);if(v===0)g.value=m.totalsRowLabel;else{const w=this.getFormula(m);g.value=w?{formula:m.totalsRowFormula,result:m.totalsRowResult}:null}a(g,m.style)})}}load(a){const{table:l}=this,{row:c,col:u}=l.tl;let h=0;if(l.headerRow){const d=a.getRow(c+h++);l.columns.forEach((f,m)=>{d.getCell(u+m).value=f.name})}if(l.rows.forEach(d=>{const f=a.getRow(c+h++);d.forEach((m,v)=>{f.getCell(u+v).value=m})}),l.totalsRow){const d=a.getRow(c+h++);l.columns.forEach((f,m)=>{const v=d.getCell(u+m);m===0?v.value=f.totalsRowLabel:this.getFormula(f)&&(v.value={formula:f.totalsRowFormula,result:f.totalsRowResult})})}}get model(){return this.table}set model(a){this.table=a}cacheState(){this._cache||(this._cache={ref:this.ref,width:this.width,tableHeight:this.tableHeight})}commit(){if(!this._cache)return;this.validate();const a=s.decodeAddress(this._cache.ref);if(this.ref!==this._cache.ref)for(let l=0;l<this._cache.tableHeight;l++){const c=this.worksheet.getRow(a.row+l);for(let u=0;u<this._cache.width;u++)c.getCell(a.col+u).value=null}else{for(let l=this.tableHeight;l<this._cache.tableHeight;l++){const c=this.worksheet.getRow(a.row+l);for(let u=0;u<this._cache.width;u++)c.getCell(a.col+u).value=null}for(let l=0;l<this.tableHeight;l++){const c=this.worksheet.getRow(a.row+l);for(let u=this.width;u<this._cache.width;u++)c.getCell(a.col+u).value=null}}this.store()}addRow(a,l){this.cacheState(),l===void 0?this.table.rows.push(a):this.table.rows.splice(l,0,a)}removeRows(a){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.rows.splice(a,l)}getColumn(a){const l=this.table.columns[a];return new o(this,l,a)}addColumn(a,l,c){this.cacheState(),c===void 0?(this.table.columns.push(a),this.table.rows.forEach((u,h)=>{u.push(l[h])})):(this.table.columns.splice(c,0,a),this.table.rows.forEach((u,h)=>{u.splice(c,0,l[h])}))}removeColumns(a){let l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cacheState(),this.table.columns.splice(a,l),this.table.rows.forEach(c=>{c.splice(a,l)})}_assign(a,l,c){this.cacheState(),a[l]=c}get ref(){return this.table.ref}set ref(a){this._assign(this.table,"ref",a)}get name(){return this.table.name}set name(a){this.table.name=a}get displayName(){return this.table.displyName||this.table.name}set displayNamename(a){this.table.displayName=a}get headerRow(){return this.table.headerRow}set headerRow(a){this._assign(this.table,"headerRow",a)}get totalsRow(){return this.table.totalsRow}set totalsRow(a){this._assign(this.table,"totalsRow",a)}get theme(){return this.table.style.name}set theme(a){this.table.style.name=a}get showFirstColumn(){return this.table.style.showFirstColumn}set showFirstColumn(a){this.table.style.showFirstColumn=a}get showLastColumn(){return this.table.style.showLastColumn}set showLastColumn(a){this.table.style.showLastColumn=a}get showRowStripes(){return this.table.style.showRowStripes}set showRowStripes(a){this.table.style.showRowStripes=a}get showColumnStripes(){return this.table.style.showColumnStripes}set showColumnStripes(a){this.table.style.showColumnStripes=a}}},{"../utils/col-cache":19}],13:[function(r,n,i){const s=r("./worksheet"),o=r("./defined-names"),a=r("../xlsx/xlsx"),l=r("../csv/csv");n.exports=class{constructor(){this.category="",this.company="",this.created=new Date,this.description="",this.keywords="",this.manager="",this.modified=this.created,this.properties={},this.calcProperties={},this._worksheets=[],this.subject="",this.title="",this.views=[],this.media=[],this._definedNames=new o}get xlsx(){return this._xlsx||(this._xlsx=new a(this)),this._xlsx}get csv(){return this._csv||(this._csv=new l(this)),this._csv}get nextId(){for(let c=1;c<this._worksheets.length;c++)if(!this._worksheets[c])return c;return this._worksheets.length||1}addWorksheet(c,u){const h=this.nextId;u&&(typeof u=="string"?(console.trace('tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { argb: "rbg value" } }'),u={properties:{tabColor:{argb:u}}}):(u.argb||u.theme||u.indexed)&&(console.trace("tabColor argument is now deprecated. Please use workbook.addWorksheet(name, {properties: { tabColor: { ... } }"),u={properties:{tabColor:u}}));const d=this._worksheets.reduce((v,g)=>(g&&g.orderNo)>v?g.orderNo:v,0),f=Object.assign({},u,{id:h,name:c,orderNo:d+1,workbook:this}),m=new s(f);return this._worksheets[h]=m,m}removeWorksheetEx(c){delete this._worksheets[c.id]}removeWorksheet(c){const u=this.getWorksheet(c);u&&u.destroy()}getWorksheet(c){return c===void 0?this._worksheets.find(Boolean):typeof c=="number"?this._worksheets[c]:typeof c=="string"?this._worksheets.find(u=>u&&u.name===c):void 0}get worksheets(){return this._worksheets.slice(1).sort((c,u)=>c.orderNo-u.orderNo).filter(Boolean)}eachSheet(c){this.worksheets.forEach(u=>{c(u,u.id)})}get definedNames(){return this._definedNames}clearThemes(){this._themes=void 0}addImage(c){const u=this.media.length;return this.media.push(Object.assign({},c,{type:"image"})),u}getImage(c){return this.media[c]}get model(){return{creator:this.creator||"Unknown",lastModifiedBy:this.lastModifiedBy||"Unknown",lastPrinted:this.lastPrinted,created:this.created,modified:this.modified,properties:this.properties,worksheets:this.worksheets.map(c=>c.model),sheets:this.worksheets.map(c=>c.model).filter(Boolean),definedNames:this._definedNames.model,views:this.views,company:this.company,manager:this.manager,title:this.title,subject:this.subject,keywords:this.keywords,category:this.category,description:this.description,language:this.language,revision:this.revision,contentStatus:this.contentStatus,themes:this._themes,media:this.media,calcProperties:this.calcProperties}}set model(c){this.creator=c.creator,this.lastModifiedBy=c.lastModifiedBy,this.lastPrinted=c.lastPrinted,this.created=c.created,this.modified=c.modified,this.company=c.company,this.manager=c.manager,this.title=c.title,this.subject=c.subject,this.keywords=c.keywords,this.category=c.category,this.description=c.description,this.language=c.language,this.revision=c.revision,this.contentStatus=c.contentStatus,this.properties=c.properties,this.calcProperties=c.calcProperties,this._worksheets=[],c.worksheets.forEach(u=>{const{id:h,name:d,state:f}=u,m=c.sheets&&c.sheets.findIndex(v=>v.id===h);(this._worksheets[h]=new s({id:h,name:d,orderNo:m,state:f,workbook:this})).model=u}),this._definedNames.model=c.definedNames,this.views=c.views,this._themes=c.themes,this.media=c.media||[]}}},{"../csv/csv":1,"../xlsx/xlsx":144,"./defined-names":6,"./worksheet":14}],14:[function(r,n,i){const s=r("../utils/under-dash"),o=r("../utils/col-cache"),a=r("./range"),l=r("./row"),c=r("./column"),u=r("./enums"),h=r("./image"),d=r("./table"),f=r("./data-validations"),m=r("../utils/encryptor"),{copyStyle:v}=r("../utils/copy-style");n.exports=class{constructor(g){g=g||{},this._workbook=g.workbook,this.id=g.id,this.orderNo=g.orderNo,this.name=g.name,this.state=g.state||"visible",this._rows=[],this._columns=null,this._keys={},this._merges={},this.rowBreaks=[],this.properties=Object.assign({},{defaultRowHeight:15,dyDescent:55,outlineLevelCol:0,outlineLevelRow:0},g.properties),this.pageSetup=Object.assign({},{margins:{left:.7,right:.7,top:.75,bottom:.75,header:.3,footer:.3},orientation:"portrait",horizontalDpi:4294967295,verticalDpi:4294967295,fitToPage:!(!g.pageSetup||!g.pageSetup.fitToWidth&&!g.pageSetup.fitToHeight||g.pageSetup.scale),pageOrder:"downThenOver",blackAndWhite:!1,draft:!1,cellComments:"None",errors:"displayed",scale:100,fitToWidth:1,fitToHeight:1,paperSize:void 0,showRowColHeaders:!1,showGridLines:!1,firstPageNumber:void 0,horizontalCentered:!1,verticalCentered:!1,rowBreaks:null,colBreaks:null},g.pageSetup),this.headerFooter=Object.assign({},{differentFirst:!1,differentOddEven:!1,oddHeader:null,oddFooter:null,evenHeader:null,evenFooter:null,firstHeader:null,firstFooter:null},g.headerFooter),this.dataValidations=new f,this.views=g.views||[],this.autoFilter=g.autoFilter||null,this._media=[],this.sheetProtection=null,this.tables={},this.conditionalFormattings=[]}get name(){return this._name}set name(g){if(g===void 0&&(g="sheet"+this.id),this._name!==g){if(typeof g!="string")throw new Error("The name has to be a string.");if(g==="")throw new Error("The name can't be empty.");if(g==="History")throw new Error('The name "History" is protected. Please use a different name.');if(/[*?:/\\[\]]/.test(g))throw new Error(`Worksheet name ${g} cannot include any of the following characters: * ? : \\ / [ ]`);if(/(^')|('$)/.test(g))throw new Error("The first or last character of worksheet name cannot be a single quotation mark: "+g);if(g&&g.length>31&&(console.warn(`Worksheet name ${g} exceeds 31 chars. This will be truncated`),g=g.substring(0,31)),this._workbook._worksheets.find(w=>w&&w.name.toLowerCase()===g.toLowerCase()))throw new Error("Worksheet name already exists: "+g);this._name=g}}get workbook(){return this._workbook}destroy(){this._workbook.removeWorksheetEx(this)}get dimensions(){const g=new a;return this._rows.forEach(w=>{if(w){const y=w.dimensions;y&&g.expand(w.number,y.min,w.number,y.max)}}),g}get columns(){return this._columns}set columns(g){this._headerRowCount=g.reduce((C,k)=>{const F=(k.header?1:k.headers&&k.headers.length)||0;return Math.max(C,F)},0);let w=1;const y=this._columns=[];g.forEach(C=>{const k=new c(this,w++,!1);y.push(k),k.defn=C})}getColumnKey(g){return this._keys[g]}setColumnKey(g,w){this._keys[g]=w}deleteColumnKey(g){delete this._keys[g]}eachColumnKey(g){s.each(this._keys,g)}getColumn(g){if(typeof g=="string"){const w=this._keys[g];if(w)return w;g=o.l2n(g)}if(this._columns||(this._columns=[]),g>this._columns.length){let w=this._columns.length+1;for(;w<=g;)this._columns.push(new c(this,w++))}return this._columns[g-1]}spliceColumns(g,w){const y=this._rows.length;for(var C=arguments.length,k=new Array(C>2?C-2:0),F=2;F<C;F++)k[F-2]=arguments[F];if(k.length>0)for(let L=0;L<y;L++){const W=[g,w];k.forEach(z=>{W.push(z[L]||null)});const K=this.getRow(L+1);K.splice.apply(K,W)}else this._rows.forEach(L=>{L&&L.splice(g,w)});const I=k.length-w,N=g+w,j=this._columns.length;if(I<0)for(let L=g+k.length;L<=j;L++)this.getColumn(L).defn=this.getColumn(L-I).defn;else if(I>0)for(let L=j;L>=N;L--)this.getColumn(L+I).defn=this.getColumn(L).defn;for(let L=g;L<g+k.length;L++)this.getColumn(L).defn=null;this.workbook.definedNames.spliceColumns(this.name,g,w,k.length)}get lastColumn(){return this.getColumn(this.columnCount)}get columnCount(){let g=0;return this.eachRow(w=>{g=Math.max(g,w.cellCount)}),g}get actualColumnCount(){const g=[];let w=0;return this.eachRow(y=>{y.eachCell(C=>{let{col:k}=C;g[k]||(g[k]=!0,w++)})}),w}_commitRow(){}get _lastRowNumber(){const g=this._rows;let w=g.length;for(;w>0&&g[w-1]===void 0;)w--;return w}get _nextRow(){return this._lastRowNumber+1}get lastRow(){if(this._rows.length)return this._rows[this._rows.length-1]}findRow(g){return this._rows[g-1]}findRows(g,w){return this._rows.slice(g-1,g-1+w)}get rowCount(){return this._lastRowNumber}get actualRowCount(){let g=0;return this.eachRow(()=>{g++}),g}getRow(g){let w=this._rows[g-1];return w||(w=this._rows[g-1]=new l(this,g)),w}getRows(g,w){if(w<1)return;const y=[];for(let C=g;C<g+w;C++)y.push(this.getRow(C));return y}addRow(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=this._nextRow,C=this.getRow(y);return C.values=g,this._setStyleOption(y,w[0]==="i"?w:"n"),C}addRows(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";const y=[];return g.forEach(C=>{y.push(this.addRow(C,w))}),y}insertRow(g,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";return this.spliceRows(g,0,w),this._setStyleOption(g,y),this.getRow(g)}insertRows(g,w){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"n";if(this.spliceRows(g,0,...w),y!=="n")for(let C=0;C<w.length;C++)y[0]==="o"&&this.findRow(w.length+g+C)!==void 0?this._copyStyle(w.length+g+C,g+C,y[1]==="+"):y[0]==="i"&&this.findRow(g-1)!==void 0&&this._copyStyle(g-1,g+C,y[1]==="+");return this.getRows(g,w.length)}_setStyleOption(g){let w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"n";w[0]==="o"&&this.findRow(g+1)!==void 0?this._copyStyle(g+1,g,w[1]==="+"):w[0]==="i"&&this.findRow(g-1)!==void 0&&this._copyStyle(g-1,g,w[1]==="+")}_copyStyle(g,w){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const C=this.getRow(g),k=this.getRow(w);k.style=v(C.style),C.eachCell({includeEmpty:y},(F,I)=>{k.getCell(I).style=v(F.style)}),k.height=C.height}duplicateRow(g,w){let y=arguments.length>2&&arguments[2]!==void 0&&arguments[2];const C=this._rows[g-1],k=new Array(w).fill(C.values);this.spliceRows(g+1,y?0:w,...k);for(let F=0;F<w;F++){const I=this._rows[g+F];I.style=C.style,I.height=C.height,C.eachCell({includeEmpty:!0},(N,j)=>{I.getCell(j).style=N.style})}}spliceRows(g,w){const y=g+w;for(var C=arguments.length,k=new Array(C>2?C-2:0),F=2;F<C;F++)k[F-2]=arguments[F];const I=k.length,N=I-w,j=this._rows.length;let L,W;if(N<0)for(g===j&&(this._rows[j-1]=void 0),L=y;L<=j;L++)if(W=this._rows[L-1],W){const K=this.getRow(L+N);K.values=W.values,K.style=W.style,K.height=W.height,W.eachCell({includeEmpty:!0},(z,M)=>{K.getCell(M).style=z.style}),this._rows[L-1]=void 0}else this._rows[L+N-1]=void 0;else if(N>0)for(L=j;L>=y;L--)if(W=this._rows[L-1],W){const K=this.getRow(L+N);K.values=W.values,K.style=W.style,K.height=W.height,W.eachCell({includeEmpty:!0},(z,M)=>{if(K.getCell(M).style=z.style,z._value.constructor.name==="MergeValue"){const B=this.getRow(z._row._number+I).getCell(M),R=z._value._master,S=this.getRow(R._row._number+I).getCell(R._column._number);B.merge(S)}})}else this._rows[L+N-1]=void 0;for(L=0;L<I;L++){const K=this.getRow(g+L);K.style={},K.values=k[L]}this.workbook.definedNames.spliceRows(this.name,g,w,I)}eachRow(g,w){if(w||(w=g,g=void 0),g&&g.includeEmpty){const y=this._rows.length;for(let C=1;C<=y;C++)w(this.getRow(C),C)}else this._rows.forEach(y=>{y&&y.hasValues&&w(y,y.number)})}getSheetValues(){const g=[];return this._rows.forEach(w=>{w&&(g[w.number]=w.values)}),g}findCell(g,w){const y=o.getAddress(g,w),C=this._rows[y.row-1];return C?C.findCell(y.col):void 0}getCell(g,w){const y=o.getAddress(g,w);return this.getRow(y.row).getCellEx(y)}mergeCells(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];const C=new a(w);this._mergeCellsInternal(C)}mergeCellsWithoutStyle(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];const C=new a(w);this._mergeCellsInternal(C,!0)}_mergeCellsInternal(g,w){s.each(this._merges,C=>{if(C.intersects(g))throw new Error("Cannot merge already merged cells")});const y=this.getCell(g.top,g.left);for(let C=g.top;C<=g.bottom;C++)for(let k=g.left;k<=g.right;k++)(C>g.top||k>g.left)&&this.getCell(C,k).merge(y,w);this._merges[y.address]=g}_unMergeMaster(g){const w=this._merges[g.address];if(w){for(let y=w.top;y<=w.bottom;y++)for(let C=w.left;C<=w.right;C++)this.getCell(y,C).unmerge();delete this._merges[g.address]}}get hasMerges(){return s.some(this._merges,Boolean)}unMergeCells(){for(var g=arguments.length,w=new Array(g),y=0;y<g;y++)w[y]=arguments[y];const C=new a(w);for(let k=C.top;k<=C.bottom;k++)for(let F=C.left;F<=C.right;F++){const I=this.findCell(k,F);I&&(I.type===u.ValueType.Merge?this._unMergeMaster(I.master):this._merges[I.address]&&this._unMergeMaster(I))}}fillFormula(g,w,y){let C=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"shared";const k=o.decode(g),{top:F,left:I,bottom:N,right:j}=k,L=j-I+1,W=o.encodeAddress(F,I),K=C==="shared";let z;z=typeof y=="function"?y:Array.isArray(y)?Array.isArray(y[0])?(B,R)=>y[B-F][R-I]:(B,R)=>y[(B-F)*L+(R-I)]:()=>{};let M=!0;for(let B=F;B<=N;B++)for(let R=I;R<=j;R++)M?(this.getCell(B,R).value={shareType:C,formula:w,ref:g,result:z(B,R)},M=!1):this.getCell(B,R).value=K?{sharedFormula:W,result:z(B,R)}:z(B,R)}addImage(g,w){const y={type:"image",imageId:g,range:w};this._media.push(new h(this,y))}getImages(){return this._media.filter(g=>g.type==="image")}addBackgroundImage(g){const w={type:"background",imageId:g};this._media.push(new h(this,w))}getBackgroundImageId(){const g=this._media.find(w=>w.type==="background");return g&&g.imageId}protect(g,w){return new Promise(y=>{this.sheetProtection={sheet:!0},w&&"spinCount"in w&&(w.spinCount=Number.isFinite(w.spinCount)?Math.round(Math.max(0,w.spinCount)):1e5),g&&(this.sheetProtection.algorithmName="SHA-512",this.sheetProtection.saltValue=m.randomBytes(16).toString("base64"),this.sheetProtection.spinCount=w&&"spinCount"in w?w.spinCount:1e5,this.sheetProtection.hashValue=m.convertPasswordToHash(g,"SHA512",this.sheetProtection.saltValue,this.sheetProtection.spinCount)),w&&(this.sheetProtection=Object.assign(this.sheetProtection,w),!g&&"spinCount"in w&&delete this.sheetProtection.spinCount),y()})}unprotect(){this.sheetProtection=null}addTable(g){const w=new d(this,g);return this.tables[g.name]=w,w}getTable(g){return this.tables[g]}removeTable(g){delete this.tables[g]}getTables(){return Object.values(this.tables)}addConditionalFormatting(g){this.conditionalFormattings.push(g)}removeConditionalFormatting(g){typeof g=="number"?this.conditionalFormattings.splice(g,1):this.conditionalFormattings=g instanceof Function?this.conditionalFormattings.filter(g):[]}get tabColor(){return console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor}set tabColor(g){console.trace("worksheet.tabColor property is now deprecated. Please use worksheet.properties.tabColor"),this.properties.tabColor=g}get model(){const g={id:this.id,name:this.name,dataValidations:this.dataValidations.model,properties:this.properties,state:this.state,pageSetup:this.pageSetup,headerFooter:this.headerFooter,rowBreaks:this.rowBreaks,views:this.views,autoFilter:this.autoFilter,media:this._media.map(C=>C.model),sheetProtection:this.sheetProtection,tables:Object.values(this.tables).map(C=>C.model),conditionalFormattings:this.conditionalFormattings};g.cols=c.toModel(this.columns);const w=g.rows=[],y=g.dimensions=new a;return this._rows.forEach(C=>{const k=C&&C.model;k&&(y.expand(k.number,k.min,k.number,k.max),w.push(k))}),g.merges=[],s.each(this._merges,C=>{g.merges.push(C.range)}),g}_parseRows(g){this._rows=[],g.rows.forEach(w=>{const y=new l(this,w.number);this._rows[y.number-1]=y,y.model=w})}_parseMergeCells(g){s.each(g.mergeCells,w=>{this.mergeCellsWithoutStyle(w)})}set model(g){this.name=g.name,this._columns=c.fromModel(this,g.cols),this._parseRows(g),this._parseMergeCells(g),this.dataValidations=new f(g.dataValidations),this.properties=g.properties,this.pageSetup=g.pageSetup,this.headerFooter=g.headerFooter,this.views=g.views,this.autoFilter=g.autoFilter,this._media=g.media.map(w=>new h(this,w)),this.sheetProtection=g.sheetProtection,this.tables=g.tables.reduce((w,y)=>{const C=new d;return C.model=y,w[y.name]=C,w},{}),this.conditionalFormattings=g.conditionalFormattings}}},{"../utils/col-cache":19,"../utils/copy-style":20,"../utils/encryptor":21,"../utils/under-dash":26,"./column":4,"./data-validations":5,"./enums":7,"./image":8,"./range":10,"./row":11,"./table":12}],15:[function(r,n,i){r("core-js/modules/es.promise"),r("core-js/modules/es.promise.finally"),r("core-js/modules/es.object.assign"),r("core-js/modules/es.object.keys"),r("core-js/modules/es.object.values"),r("core-js/modules/es.symbol"),r("core-js/modules/es.symbol.async-iterator"),r("core-js/modules/es.array.iterator"),r("core-js/modules/es.array.includes"),r("core-js/modules/es.array.find-index"),r("core-js/modules/es.array.find"),r("core-js/modules/es.string.from-code-point"),r("core-js/modules/es.string.includes"),r("core-js/modules/es.number.is-nan"),r("regenerator-runtime/runtime");const s={Workbook:r("./doc/workbook")},o=r("./doc/enums");Object.keys(o).forEach(a=>{s[a]=o[a]}),n.exports=s},{"./doc/enums":7,"./doc/workbook":13,"core-js/modules/es.array.find":359,"core-js/modules/es.array.find-index":358,"core-js/modules/es.array.includes":360,"core-js/modules/es.array.iterator":361,"core-js/modules/es.number.is-nan":363,"core-js/modules/es.object.assign":364,"core-js/modules/es.object.keys":366,"core-js/modules/es.object.values":367,"core-js/modules/es.promise":372,"core-js/modules/es.promise.finally":371,"core-js/modules/es.string.from-code-point":376,"core-js/modules/es.string.includes":377,"core-js/modules/es.symbol":381,"core-js/modules/es.symbol.async-iterator":378,"regenerator-runtime/runtime":492}],16:[function(r,n,i){const s=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");i.bufferToString=function(o){return typeof o=="string"?o:s?s.decode(o):o.toString()}},{}],17:[function(r,n,i){const s=typeof TextEncoder>"u"?null:new TextEncoder("utf-8"),{Buffer:o}=r("buffer");i.stringToBuffer=function(a){return typeof a!="string"?a:s?o.from(s.encode(a).buffer):o.from(a)}},{buffer:220}],18:[function(r,n,i){const s=r("./under-dash"),o=r("./col-cache");n.exports=class{constructor(a){this.template=a,this.sheets={}}addCell(a){this.addCellEx(o.decodeEx(a))}getCell(a){return this.findCellEx(o.decodeEx(a),!0)}findCell(a){return this.findCellEx(o.decodeEx(a),!1)}findCellAt(a,l,c){const u=this.sheets[a],h=u&&u[l];return h&&h[c]}addCellEx(a){if(a.top)for(let l=a.top;l<=a.bottom;l++)for(let c=a.left;c<=a.right;c++)this.getCellAt(a.sheetName,l,c);else this.findCellEx(a,!0)}getCellEx(a){return this.findCellEx(a,!0)}findCellEx(a,l){const c=this.findSheet(a,l),u=this.findSheetRow(c,a,l);return this.findRowCell(u,a,l)}getCellAt(a,l,c){const u=this.sheets[a]||(this.sheets[a]=[]),h=u[l]||(u[l]=[]);return h[c]||(h[c]={sheetName:a,address:o.n2l(c)+l,row:l,col:c})}removeCellEx(a){const l=this.findSheet(a);if(!l)return;const c=this.findSheetRow(l,a);c&&delete c[a.col]}forEachInSheet(a,l){const c=this.sheets[a];c&&c.forEach((u,h)=>{u&&u.forEach((d,f)=>{d&&l(d,h,f)})})}forEach(a){s.each(this.sheets,(l,c)=>{this.forEachInSheet(c,a)})}map(a){const l=[];return this.forEach(c=>{l.push(a(c))}),l}findSheet(a,l){const c=a.sheetName;return this.sheets[c]?this.sheets[c]:l?this.sheets[c]=[]:void 0}findSheetRow(a,l,c){const{row:u}=l;return a&&a[u]?a[u]:c?a[u]=[]:void 0}findRowCell(a,l,c){const{col:u}=l;return a&&a[u]?a[u]:c?a[u]=this.template?Object.assign(l,JSON.parse(JSON.stringify(this.template))):l:void 0}spliceRows(a,l,c,u){const h=this.sheets[a];if(h){const d=[];for(let f=0;f<u;f++)d.push([]);h.splice(l,c,...d)}}spliceColumns(a,l,c,u){const h=this.sheets[a];if(h){const d=[];for(let f=0;f<u;f++)d.push(null);s.each(h,f=>{f.splice(l,c,...d)})}}}},{"./col-cache":19,"./under-dash":26}],19:[function(r,n,i){const s=/^[A-Z]+\d+$/,o={_dictionary:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],_l2nFill:0,_l2n:{},_n2l:[],_level:a=>a<=26?1:a<=676?2:3,_fill(a){let l,c,u,h,d,f=1;if(a>=4)throw new Error("Out of bounds. Excel supports columns from 1 to 16384");if(this._l2nFill<1&&a>=1){for(;f<=26;)l=this._dictionary[f-1],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=1}if(this._l2nFill<2&&a>=2){for(f=27;f<=702;)c=f-27,u=c%26,h=Math.floor(c/26),l=this._dictionary[h]+this._dictionary[u],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=2}if(this._l2nFill<3&&a>=3){for(f=703;f<=16384;)c=f-703,u=c%26,h=Math.floor(c/26)%26,d=Math.floor(c/676),l=this._dictionary[d]+this._dictionary[h]+this._dictionary[u],this._n2l[f]=l,this._l2n[l]=f,f++;this._l2nFill=3}},l2n(a){if(this._l2n[a]||this._fill(a.length),!this._l2n[a])throw new Error("Out of bounds. Invalid column letter: "+a);return this._l2n[a]},n2l(a){if(a<1||a>16384)throw new Error(a+" is out of bounds. Excel supports columns from 1 to 16384");return this._n2l[a]||this._fill(this._level(a)),this._n2l[a]},_hash:{},validateAddress(a){if(!s.test(a))throw new Error("Invalid Address: "+a);return!0},decodeAddress(a){const l=a.length<5&&this._hash[a];if(l)return l;let c=!1,u="",h=0,d=!1,f="",m=0;for(let g,w=0;w<a.length;w++)if(g=a.charCodeAt(w),!d&&g>=65&&g<=90)c=!0,u+=a[w],h=26*h+g-64;else if(g>=48&&g<=57)d=!0,f+=a[w],m=10*m+g-48;else if(d&&c&&g!==36)break;if(c){if(h>16384)throw new Error("Out of bounds. Invalid column letter: "+u)}else h=void 0;d||(m=void 0);const v={address:a=u+f,col:h,row:m,$col$row:`$${u}$${f}`};return h<=100&&m<=100&&(this._hash[a]=v,this._hash[v.$col$row]=v),v},getAddress(a,l){if(l){const c=this.n2l(l)+a;return this.decodeAddress(c)}return this.decodeAddress(a)},decode(a){const l=a.split(":");if(l.length===2){const c=this.decodeAddress(l[0]),u=this.decodeAddress(l[1]),h={top:Math.min(c.row,u.row),left:Math.min(c.col,u.col),bottom:Math.max(c.row,u.row),right:Math.max(c.col,u.col)};return h.tl=this.n2l(h.left)+h.top,h.br=this.n2l(h.right)+h.bottom,h.dimensions=`${h.tl}:${h.br}`,h}return this.decodeAddress(a)},decodeEx(a){const l=a.match(/(?:(?:(?:'((?:[^']|'')*)')|([^'^ !]*))!)?(.*)/),c=l[1]||l[2],u=l[3],h=u.split(":");if(h.length>1){let f=this.decodeAddress(h[0]),m=this.decodeAddress(h[1]);const v=Math.min(f.row,m.row),g=Math.min(f.col,m.col),w=Math.max(f.row,m.row),y=Math.max(f.col,m.col);return f=this.n2l(g)+v,m=this.n2l(y)+w,{top:v,left:g,bottom:w,right:y,sheetName:c,tl:{address:f,col:g,row:v,$col$row:`$${this.n2l(g)}$${v}`,sheetName:c},br:{address:m,col:y,row:w,$col$row:`$${this.n2l(y)}$${w}`,sheetName:c},dimensions:`${f}:${m}`}}if(u.startsWith("#"))return c?{sheetName:c,error:u}:{error:u};const d=this.decodeAddress(u);return c?{sheetName:c,...d}:d},encodeAddress:(a,l)=>o.n2l(l)+a,encode(){switch(arguments.length){case 2:return o.encodeAddress(arguments[0],arguments[1]);case 4:return`${o.encodeAddress(arguments[0],arguments[1])}:${o.encodeAddress(arguments[2],arguments[3])}`;default:throw new Error("Can only encode with 2 or 4 arguments")}},inRange(a,l){const[c,u,,h,d]=a,[f,m]=l;return f>=c&&f<=h&&m>=u&&m<=d}};n.exports=o},{}],20:[function(r,n,i){const s=(a,l)=>({...a,...l.reduce((c,u)=>(a[u]&&(c[u]={...a[u]}),c),{})}),o=function(a,l,c){let u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[];a[c]&&(l[c]=s(a[c],u))};i.copyStyle=a=>{if(!a)return a;if(l=a,Object.keys(l).length===0)return{};var l;const c={...a};return o(a,c,"font",["color"]),o(a,c,"alignment"),o(a,c,"protection"),a.border&&(o(a,c,"border"),o(a.border,c.border,"top",["color"]),o(a.border,c.border,"left",["color"]),o(a.border,c.border,"bottom",["color"]),o(a.border,c.border,"right",["color"]),o(a.border,c.border,"diagonal",["color"])),a.fill&&(o(a,c,"fill",["fgColor","bgColor","center"]),a.fill.stops&&(c.fill.stops=a.fill.stops.map(u=>s(u,["color"])))),c}},{}],21:[function(r,n,i){(function(s){(function(){const o=r("crypto"),a={hash(l){const c=o.createHash(l);for(var u=arguments.length,h=new Array(u>1?u-1:0),d=1;d<u;d++)h[d-1]=arguments[d];return c.update(s.concat(h)),c.digest()},convertPasswordToHash(l,c,u,h){if(c=c.toLowerCase(),o.getHashes().indexOf(c)<0)throw new Error(`Hash algorithm '${c}' not supported!`);const d=s.from(l,"utf16le");let f=this.hash(c,s.from(u,"base64"),d);for(let m=0;m<h;m++){const v=s.alloc(4);v.writeUInt32LE(m,0),f=this.hash(c,f,v)}return f.toString("base64")},randomBytes:l=>o.randomBytes(l)};n.exports=a}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220,crypto:390}],22:[function(r,n,i){const{SaxesParser:s}=r("saxes"),{PassThrough:o}=r("readable-stream"),{bufferToString:a}=r("./browser-buffer-decode");n.exports=async function*(l){l.pipe&&!l[Symbol.asyncIterator]&&(l=l.pipe(new o));const c=new s;let u;c.on("error",d=>{u=d});let h=[];c.on("opentag",d=>h.push({eventType:"opentag",value:d})),c.on("text",d=>h.push({eventType:"text",value:d})),c.on("closetag",d=>h.push({eventType:"closetag",value:d}));for await(const d of l){if(c.write(a(d)),u)throw u;yield h,h=[]}}},{"./browser-buffer-decode":16,"readable-stream":491,saxes:496}],23:[function(r,n,i){const s=r("./col-cache"),o=/(([a-z_\-0-9]*)!)?([a-z0-9_$]{2,})([(])?/gi,a=/^([$])?([a-z]+)([$])?([1-9][0-9]*)$/i;n.exports={slideFormula:function(l,c,u){const h=s.decode(c),d=s.decode(u);return l.replace(o,(f,m,v,g,w)=>{if(w)return f;const y=a.exec(g);if(y){const C=y[1],k=y[2].toUpperCase(),F=y[3],I=y[4];if(k.length>3||k.length===3&&k>"XFD")return f;let N=s.l2n(k),j=parseInt(I,10);return C||(N+=d.col-h.col),F||(j+=d.row-h.row),(m||"")+(C||"")+s.n2l(N)+(F||"")+j}return f})}}},{"./col-cache":19}],24:[function(r,n,i){(function(s,o){(function(){const a=r("readable-stream"),l=r("./utils"),c=r("./string-buf");class u{constructor(g,w){this._data=g,this._encoding=w}get length(){return this.toBuffer().length}copy(g,w,y,C){return this.toBuffer().copy(g,w,y,C)}toBuffer(){return this._buffer||(this._buffer=o.from(this._data,this._encoding)),this._buffer}}class h{constructor(g){this._data=g}get length(){return this._data.length}copy(g,w,y,C){return this._data._buf.copy(g,w,y,C)}toBuffer(){return this._data.toBuffer()}}class d{constructor(g){this._data=g}get length(){return this._data.length}copy(g,w,y,C){this._data.copy(g,w,y,C)}toBuffer(){return this._data}}class f{constructor(g){this.size=g,this.buffer=o.alloc(g),this.iRead=0,this.iWrite=0}toBuffer(){if(this.iRead===0&&this.iWrite===this.size)return this.buffer;const g=o.alloc(this.iWrite-this.iRead);return this.buffer.copy(g,0,this.iRead,this.iWrite),g}get length(){return this.iWrite-this.iRead}get eod(){return this.iRead===this.iWrite}get full(){return this.iWrite===this.size}read(g){let w;return g===0?null:g===void 0||g>=this.length?(w=this.toBuffer(),this.iRead=this.iWrite,w):(w=o.alloc(g),this.buffer.copy(w,0,this.iRead,g),this.iRead+=g,w)}write(g,w,y){const C=Math.min(y,this.size-this.iWrite);return g.copy(this.buffer,this.iWrite,w,w+C),this.iWrite+=C,C}}const m=function(v){v=v||{},this.bufSize=v.bufSize||1048576,this.buffers=[],this.batch=v.batch||!1,this.corked=!1,this.inPos=0,this.outPos=0,this.pipes=[],this.paused=!1,this.encoding=null};l.inherits(m,a.Duplex,{toBuffer(){switch(this.buffers.length){case 0:return null;case 1:return this.buffers[0].toBuffer();default:return o.concat(this.buffers.map(v=>v.toBuffer()))}},_getWritableBuffer(){if(this.buffers.length){const g=this.buffers[this.buffers.length-1];if(!g.full)return g}const v=new f(this.bufSize);return this.buffers.push(v),v},async _pipe(v){await Promise.all(this.pipes.map((function(g){return new Promise(w=>{g.write(v.toBuffer(),()=>{w()})})})))},_writeToBuffers(v){let g=0;const w=v.length;for(;g<w;)g+=this._getWritableBuffer().write(v,g,w-g)},async write(v,g,w){let y;if(g instanceof Function&&(w=g,g="utf8"),w=w||l.nop,v instanceof c)y=new h(v);else if(v instanceof o)y=new d(v);else{if(!(typeof v=="string"||v instanceof String||v instanceof ArrayBuffer))throw new Error("Chunk must be one of type String, Buffer or StringBuf.");y=new u(v,g)}if(this.pipes.length)if(this.batch)for(this._writeToBuffers(y);!this.corked&&this.buffers.length>1;)this._pipe(this.buffers.shift());else this.corked?(this._writeToBuffers(y),s.nextTick(w)):(await this._pipe(y),w());else this.paused||this.emit("data",y.toBuffer()),this._writeToBuffers(y),this.emit("readable");return!0},cork(){this.corked=!0},_flush(){if(this.pipes.length)for(;this.buffers.length;)this._pipe(this.buffers.shift())},uncork(){this.corked=!1,this._flush()},end(v,g,w){const y=C=>{C?w(C):(this._flush(),this.pipes.forEach(k=>{k.end()}),this.emit("finish"))};v?this.write(v,g,y):y()},read(v){let g;if(v){for(g=[];v&&this.buffers.length&&!this.buffers[0].eod;){const w=this.buffers[0],y=w.read(v);v-=y.length,g.push(y),w.eod&&w.full&&this.buffers.shift()}return o.concat(g)}return g=this.buffers.map(w=>w.toBuffer()).filter(Boolean),this.buffers=[],o.concat(g)},setEncoding(v){this.encoding=v},pause(){this.paused=!0},resume(){this.paused=!1},isPaused(){return!!this.paused},pipe(v){this.pipes.push(v),!this.paused&&this.buffers.length&&this.end()},unpipe(v){this.pipes=this.pipes.filter(g=>g!==v)},unshift(){throw new Error("Not Implemented")},wrap(){throw new Error("Not Implemented")}}),n.exports=m}).call(this)}).call(this,r("_process"),r("buffer").Buffer)},{"./string-buf":25,"./utils":27,_process:467,buffer:220,"readable-stream":491}],25:[function(r,n,i){(function(s){(function(){n.exports=class{constructor(o){this._buf=s.alloc(o&&o.size||16384),this._encoding=o&&o.encoding||"utf8",this._inPos=0,this._buffer=void 0}get length(){return this._inPos}get capacity(){return this._buf.length}get buffer(){return this._buf}toBuffer(){return this._buffer||(this._buffer=s.alloc(this.length),this._buf.copy(this._buffer,0,0,this.length)),this._buffer}reset(o){o=o||0,this._buffer=void 0,this._inPos=o}_grow(o){let a=2*this._buf.length;for(;a<o;)a*=2;const l=s.alloc(a);this._buf.copy(l,0),this._buf=l}addText(o){this._buffer=void 0;let a=this._inPos+this._buf.write(o,this._inPos,this._encoding);for(;a>=this._buf.length-4;)this._grow(this._inPos+o.length),a=this._inPos+this._buf.write(o,this._inPos,this._encoding);this._inPos=a}addStringBuf(o){o.length&&(this._buffer=void 0,this.length+o.length>this.capacity&&this._grow(this.length+o.length),o._buf.copy(this._buf,this._inPos,0,o.length),this._inPos+=o.length)}}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220}],26:[function(r,n,i){const{toString:s}=Object.prototype,o=/["&<>]/,a={each:function(l,c){l&&(Array.isArray(l)?l.forEach(c):Object.keys(l).forEach(u=>{c(l[u],u)}))},some:function(l,c){return!!l&&(Array.isArray(l)?l.some(c):Object.keys(l).some(u=>c(l[u],u)))},every:function(l,c){return!l||(Array.isArray(l)?l.every(c):Object.keys(l).every(u=>c(l[u],u)))},map:function(l,c){return l?Array.isArray(l)?l.map(c):Object.keys(l).map(u=>c(l[u],u)):[]},keyBy:(l,c)=>l.reduce((u,h)=>(u[h[c]]=h,u),{}),isEqual:function(l,c){const u=typeof l,h=typeof c,d=Array.isArray(l),f=Array.isArray(c);let m;if(u!==h)return!1;switch(typeof l){case"object":if(d||f)return!(!d||!f)&&l.length===c.length&&l.every((v,g)=>{const w=c[g];return a.isEqual(v,w)});if(l===null||c===null)return l===c;if(m=Object.keys(l),Object.keys(c).length!==m.length)return!1;for(const v of m)if(!c.hasOwnProperty(v))return!1;return a.every(l,(v,g)=>{const w=c[g];return a.isEqual(v,w)});default:return l===c}},escapeHtml(l){const c=o.exec(l);if(!c)return l;let u="",h="",d=0,f=c.index;for(;f<l.length;f++){switch(l.charAt(f)){case'"':h="&quot;";break;case"&":h="&amp;";break;case"'":h="&apos;";break;case"<":h="&lt;";break;case">":h="&gt;";break;default:continue}d!==f&&(u+=l.substring(d,f)),d=f+1,u+=h}return d!==f?u+l.substring(d,f):u},strcmp:(l,c)=>l<c?-1:l>c?1:0,isUndefined:l=>s.call(l)==="[object Undefined]",isObject:l=>s.call(l)==="[object Object]",deepMerge(){const l=arguments[0]||{},{length:c}=arguments;let u,h,d;function f(m,v){u=l[v],d=Array.isArray(m),a.isObject(m)||d?(d?(d=!1,h=u&&Array.isArray(u)?u:[]):h=u&&a.isObject(u)?u:{},l[v]=a.deepMerge(h,m)):a.isUndefined(m)||(l[v]=m)}for(let m=0;m<c;m++)a.each(arguments[m],f);return l}};n.exports=a},{}],27:[function(r,n,i){(function(s,o){(function(){const a=r("fs"),l=/[<>&'"\x7F\x00-\x08\x0B-\x0C\x0E-\x1F]/,c={nop(){},promiseImmediate:u=>new Promise(h=>{s.setImmediate?o(()=>{h(u)}):setTimeout(()=>{h(u)},1)}),inherits:function(u,h,d,f){u.super_=h,f||(f=d,d=null),d&&Object.keys(d).forEach(v=>{Object.defineProperty(u,v,Object.getOwnPropertyDescriptor(d,v))});const m={constructor:{value:u,enumerable:!1,writable:!1,configurable:!0}};f&&Object.keys(f).forEach(v=>{m[v]=Object.getOwnPropertyDescriptor(f,v)}),u.prototype=Object.create(h.prototype,m)},dateToExcel:(u,h)=>25569+u.getTime()/864e5-(h?1462:0),excelToDate(u,h){const d=Math.round(24*(u-25569+(h?1462:0))*3600*1e3);return new Date(d)},parsePath(u){const h=u.lastIndexOf("/");return{path:u.substring(0,h),name:u.substring(h+1)}},getRelsPath(u){const h=c.parsePath(u);return`${h.path}/_rels/${h.name}.rels`},xmlEncode(u){const h=l.exec(u);if(!h)return u;let d="",f="",m=0,v=h.index;for(;v<u.length;v++){const g=u.charCodeAt(v);switch(g){case 34:f="&quot;";break;case 38:f="&amp;";break;case 39:f="&apos;";break;case 60:f="&lt;";break;case 62:f="&gt;";break;case 127:f="";break;default:if(g<=31&&(g<=8||g>=11&&g!==13)){f="";break}continue}m!==v&&(d+=u.substring(m,v)),m=v+1,f&&(d+=f)}return m!==v?d+u.substring(m,v):d},xmlDecode:u=>u.replace(/&([a-z]*);/g,h=>{switch(h){case"&lt;":return"<";case"&gt;":return">";case"&amp;":return"&";case"&apos;":return"'";case"&quot;":return'"';default:return h}}),validInt(u){const h=parseInt(u,10);return Number.isNaN(h)?0:h},isDateFmt(u){return u?(u=(u=u.replace(/\[[^\]]*]/g,"")).replace(/"[^"]*"/g,"")).match(/[ymdhMsb]+/)!==null:!1},fs:{exists:u=>new Promise(h=>{a.access(u,a.constants.F_OK,d=>{h(!d)})})},toIsoDateString:u=>u.toIsoString().subsstr(0,10),parseBoolean:u=>u===!0||u==="true"||u===1||u==="1"};n.exports=c}).call(this)}).call(this,typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{},r("timers").setImmediate)},{fs:216,timers:523}],28:[function(r,n,i){const s=r("./under-dash"),o=r("./utils");function a(u,h,d){u.push(` ${h}="${o.xmlEncode(d.toString())}"`)}function l(u,h){if(h){const d=[];s.each(h,(f,m)=>{f!==void 0&&a(d,m,f)}),u.push(d.join(""))}}class c{constructor(){this._xml=[],this._stack=[],this._rollbacks=[]}get tos(){return this._stack.length?this._stack[this._stack.length-1]:void 0}get cursor(){return this._xml.length}openXml(h){const d=this._xml;d.push("<?xml"),l(d,h),d.push(`?>
`)}openNode(h,d){const f=this.tos,m=this._xml;f&&this.open&&m.push(">"),this._stack.push(h),m.push("<"),m.push(h),l(m,d),this.leaf=!0,this.open=!0}addAttribute(h,d){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");d!==void 0&&a(this._xml,h,d)}addAttributes(h){if(!this.open)throw new Error("Cannot write attributes to node if it is not open");l(this._xml,h)}writeText(h){const d=this._xml;this.open&&(d.push(">"),this.open=!1),this.leaf=!1,d.push(o.xmlEncode(h.toString()))}writeXml(h){this.open&&(this._xml.push(">"),this.open=!1),this.leaf=!1,this._xml.push(h)}closeNode(){const h=this._stack.pop(),d=this._xml;this.leaf?d.push("/>"):(d.push("</"),d.push(h),d.push(">")),this.open=!1,this.leaf=!1}leafNode(h,d,f){this.openNode(h,d),f!==void 0&&this.writeText(f),this.closeNode()}closeAll(){for(;this._stack.length;)this.closeNode()}addRollback(){return this._rollbacks.push({xml:this._xml.length,stack:this._stack.length,leaf:this.leaf,open:this.open}),this.cursor}commit(){this._rollbacks.pop()}rollback(){const h=this._rollbacks.pop();this._xml.length>h.xml&&this._xml.splice(h.xml,this._xml.length-h.xml),this._stack.length>h.stack&&this._stack.splice(h.stack,this._stack.length-h.stack),this.leaf=h.leaf,this.open=h.open}get xml(){return this.closeAll(),this._xml.join("")}}c.StdDocAttributes={version:"1.0",encoding:"UTF-8",standalone:"yes"},n.exports=c},{"./under-dash":26,"./utils":27}],29:[function(r,n,i){(function(s){(function(){const o=r("events"),a=r("jszip"),l=r("./stream-buf"),{stringToBuffer:c}=r("./browser-buffer-encode");class u extends o.EventEmitter{constructor(d){super(),this.options=Object.assign({type:"nodebuffer",compression:"DEFLATE"},d),this.zip=new a,this.stream=new l}append(d,f){f.hasOwnProperty("base64")&&f.base64?this.zip.file(f.name,d,{base64:!0}):(s.browser&&typeof d=="string"&&(d=c(d)),this.zip.file(f.name,d))}async finalize(){const d=await this.zip.generateAsync(this.options);this.stream.end(d),this.emit("finish")}read(d){return this.stream.read(d)}setEncoding(d){return this.stream.setEncoding(d)}pause(){return this.stream.pause()}resume(){return this.stream.resume()}isPaused(){return this.stream.isPaused()}pipe(d,f){return this.stream.pipe(d,f)}unpipe(d){return this.stream.unpipe(d)}unshift(d){return this.stream.unshift(d)}wrap(d){return this.stream.wrap(d)}}n.exports={ZipWriter:u}}).call(this)}).call(this,r("_process"))},{"./browser-buffer-encode":17,"./stream-buf":24,_process:467,events:422,jszip:441}],30:[function(r,n,i){n.exports={0:{f:"General"},1:{f:"0"},2:{f:"0.00"},3:{f:"#,##0"},4:{f:"#,##0.00"},9:{f:"0%"},10:{f:"0.00%"},11:{f:"0.00E+00"},12:{f:"# ?/?"},13:{f:"# ??/??"},14:{f:"mm-dd-yy"},15:{f:"d-mmm-yy"},16:{f:"d-mmm"},17:{f:"mmm-yy"},18:{f:"h:mm AM/PM"},19:{f:"h:mm:ss AM/PM"},20:{f:"h:mm"},21:{f:"h:mm:ss"},22:{f:'m/d/yy "h":mm'},27:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},28:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},29:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},30:{"zh-tw":"m/d/yy ","zh-cn":"m-d-yy","ja-jp":"m/d/yy","ko-kr":"mm-dd-yy"},31:{"zh-tw":'yyyy""m""d""',"zh-cn":'yyyy""m""d""',"ja-jp":'yyyy""m""d""',"ko-kr":'yyyy"" mm"" dd""'},32:{"zh-tw":'hh""mm""',"zh-cn":'h""mm""',"ja-jp":'h""mm""',"ko-kr":'h"" mm""'},33:{"zh-tw":'hh""mm""ss""',"zh-cn":'h""mm""ss""',"ja-jp":'h""mm""ss""',"ko-kr":'h"" mm"" ss""'},34:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},35:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},36:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},37:{f:"#,##0 ;(#,##0)"},38:{f:"#,##0 ;[Red](#,##0)"},39:{f:"#,##0.00 ;(#,##0.00)"},40:{f:"#,##0.00 ;[Red](#,##0.00)"},45:{f:"mm:ss"},46:{f:"[h]:mm:ss"},47:{f:"mmss.0"},48:{f:"##0.0E+0"},49:{f:"@"},50:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},51:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},52:{"zh-tw":'/ hh""mm""',"zh-cn":'yyyy""m""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},53:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'m""d""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},54:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},55:{"zh-tw":'/ hh""mm""',"zh-cn":'/ h""mm""',"ja-jp":'yyyy""m""',"ko-kr":"yyyy-mm-dd"},56:{"zh-tw":'/ hh""mm""ss""',"zh-cn":'/ h""mm""ss""',"ja-jp":'m""d""',"ko-kr":"yyyy-mm-dd"},57:{"zh-tw":"[$-404]e/m/d","zh-cn":'yyyy""m""',"ja-jp":"[$-411]ge.m.d","ko-kr":'yyyy"" mm"" dd""'},58:{"zh-tw":'[$-404]e""m""d""',"zh-cn":'m""d""',"ja-jp":'[$-411]ggge""m""d""',"ko-kr":"mm-dd"},59:{"th-th":"t0"},60:{"th-th":"t0.00"},61:{"th-th":"t#,##0"},62:{"th-th":"t#,##0.00"},67:{"th-th":"t0%"},68:{"th-th":"t0.00%"},69:{"th-th":"t# ?/?"},70:{"th-th":"t# ??/??"},81:{"th-th":"d/m/bb"}}},{}],31:[function(r,n,i){n.exports={OfficeDocument:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",Worksheet:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet",CalcChain:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/calcChain",SharedStrings:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",Styles:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",Theme:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",Hyperlink:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",Image:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",CoreProperties:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",ExtenderProperties:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",Comments:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",VmlDrawing:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",Table:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/table"}},{}],32:[function(r,n,i){const s=r("../../utils/parse-sax"),o=r("../../utils/xml-stream");class a{prepare(){}render(){}parseOpen(c){}parseText(c){}parseClose(c){}reconcile(c,u){}reset(){this.model=null,this.map&&Object.values(this.map).forEach(c=>{c instanceof a?c.reset():c.xform&&c.xform.reset()})}mergeModel(c){this.model=Object.assign(this.model||{},c)}async parse(c){for await(const u of c)for(const{eventType:h,value:d}of u)if(h==="opentag")this.parseOpen(d);else if(h==="text")this.parseText(d);else if(h==="closetag"&&!this.parseClose(d.name))return this.model;return this.model}async parseStream(c){return this.parse(s(c))}get xml(){return this.toXml(this.model)}toXml(c){const u=new o;return this.render(u,c),u.xml}static toAttribute(c,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(c===void 0){if(h)return u}else if(h||c!==u)return c.toString()}static toStringAttribute(c,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return a.toAttribute(c,u,h)}static toStringValue(c,u){return c===void 0?u:c}static toBoolAttribute(c,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(c===void 0){if(h)return u}else if(h||c!==u)return c?"1":"0"}static toBoolValue(c,u){return c===void 0?u:c==="1"}static toIntAttribute(c,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return a.toAttribute(c,u,h)}static toIntValue(c,u){return c===void 0?u:parseInt(c,10)}static toFloatAttribute(c,u){let h=arguments.length>2&&arguments[2]!==void 0&&arguments[2];return a.toAttribute(c,u,h)}static toFloatValue(c,u){return c===void 0?u:parseFloat(c)}}n.exports=a},{"../../utils/parse-sax":22,"../../utils/xml-stream":28}],33:[function(r,n,i){const s=r("../base-xform"),o=r("../../../utils/col-cache");function a(c){try{return o.decodeEx(c),!0}catch{return!1}}function l(c){const u=[];let h=!1,d="";return c.split(",").forEach(f=>{if(!f)return;const m=(f.match(/'/g)||[]).length;if(!m)return void(h?d+=f+",":a(f)&&u.push(f));const v=m%2==0;!h&&v&&a(f)?u.push(f):h&&!v?(h=!1,a(d+f)&&u.push(d+f),d=""):(h=!0,d+=f+",")}),u}n.exports=class extends s{render(c,u){c.openNode("definedName",{name:u.name,localSheetId:u.localSheetId}),c.writeText(u.ranges.join(",")),c.closeNode()}parseOpen(c){return c.name==="definedName"?(this._parsedName=c.attributes.name,this._parsedLocalSheetId=c.attributes.localSheetId,this._parsedText=[],!0):!1}parseText(c){this._parsedText.push(c)}parseClose(){return this.model={name:this._parsedName,ranges:l(this._parsedText.join(""))},this._parsedLocalSheetId!==void 0&&(this.model.localSheetId=parseInt(this._parsedLocalSheetId,10)),!1}}},{"../../../utils/col-cache":19,"../base-xform":32}],34:[function(r,n,i){const s=r("../../../utils/utils"),o=r("../base-xform");n.exports=class extends o{render(a,l){a.leafNode("sheet",{sheetId:l.id,name:l.name,state:l.state,"r:id":l.rId})}parseOpen(a){return a.name==="sheet"&&(this.model={name:s.xmlDecode(a.attributes.name),id:parseInt(a.attributes.sheetId,10),state:a.attributes.state,rId:a.attributes["r:id"]},!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/utils":27,"../base-xform":32}],35:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{render(o,a){o.leafNode("calcPr",{calcId:171027,fullCalcOnLoad:a.fullCalcOnLoad?1:void 0})}parseOpen(o){return o.name==="calcPr"&&(this.model={},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],36:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{render(o,a){o.leafNode("workbookPr",{date1904:a.date1904?1:void 0,defaultThemeVersion:164011,filterPrivacy:1})}parseOpen(o){return o.name==="workbookPr"&&(this.model={date1904:o.attributes.date1904==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],37:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{render(o,a){const l={xWindow:a.x||0,yWindow:a.y||0,windowWidth:a.width||12e3,windowHeight:a.height||24e3,firstSheet:a.firstSheet,activeTab:a.activeTab};a.visibility&&a.visibility!=="visible"&&(l.visibility=a.visibility),o.leafNode("workbookView",l)}parseOpen(o){if(o.name==="workbookView"){const a=this.model={},l=function(u,h,d){const f=h!==void 0?a[u]=h:d;f!==void 0&&(a[u]=f)},c=function(u,h,d){const f=h!==void 0?a[u]=parseInt(h,10):d;f!==void 0&&(a[u]=f)};return c("x",o.attributes.xWindow,0),c("y",o.attributes.yWindow,0),c("width",o.attributes.windowWidth,25e3),c("height",o.attributes.windowHeight,1e4),l("visibility",o.attributes.visibility,"visible"),c("activeTab",o.attributes.activeTab,void 0),c("firstSheet",o.attributes.firstSheet,void 0),!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],38:[function(r,n,i){const s=r("../../../utils/under-dash"),o=r("../../../utils/col-cache"),a=r("../../../utils/xml-stream"),l=r("../base-xform"),c=r("../static-xform"),u=r("../list-xform"),h=r("./defined-name-xform"),d=r("./sheet-xform"),f=r("./workbook-view-xform"),m=r("./workbook-properties-xform"),v=r("./workbook-calc-properties-xform");class g extends l{constructor(){super(),this.map={fileVersion:g.STATIC_XFORMS.fileVersion,workbookPr:new m,bookViews:new u({tag:"bookViews",count:!1,childXform:new f}),sheets:new u({tag:"sheets",count:!1,childXform:new d}),definedNames:new u({tag:"definedNames",count:!1,childXform:new h}),calcPr:new v}}prepare(y){y.sheets=y.worksheets;const C=[];let k=0;y.sheets.forEach(F=>{if(F.pageSetup&&F.pageSetup.printArea&&F.pageSetup.printArea.split("&&").forEach(I=>{const N=I.split(":"),j={name:"_xlnm.Print_Area",ranges:[`'${F.name}'!$${N[0]}:$${N[1]}`],localSheetId:k};C.push(j)}),F.pageSetup&&(F.pageSetup.printTitlesRow||F.pageSetup.printTitlesColumn)){const I=[];if(F.pageSetup.printTitlesColumn){const j=F.pageSetup.printTitlesColumn.split(":");I.push(`'${F.name}'!$${j[0]}:$${j[1]}`)}if(F.pageSetup.printTitlesRow){const j=F.pageSetup.printTitlesRow.split(":");I.push(`'${F.name}'!$${j[0]}:$${j[1]}`)}const N={name:"_xlnm.Print_Titles",ranges:I,localSheetId:k};C.push(N)}k++}),C.length&&(y.definedNames=y.definedNames.concat(C)),(y.media||[]).forEach((F,I)=>{F.name=F.type+(I+1)})}render(y,C){y.openXml(a.StdDocAttributes),y.openNode("workbook",g.WORKBOOK_ATTRIBUTES),this.map.fileVersion.render(y),this.map.workbookPr.render(y,C.properties),this.map.bookViews.render(y,C.views),this.map.sheets.render(y,C.sheets),this.map.definedNames.render(y,C.definedNames),this.map.calcPr.render(y,C.calcProperties),y.closeNode()}parseOpen(y){return this.parser?(this.parser.parseOpen(y),!0):(y.name==="workbook"||(this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y)),!0)}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){return this.parser?(this.parser.parseClose(y)||(this.parser=void 0),!0):y==="workbook"?(this.model={sheets:this.map.sheets.model,properties:this.map.workbookPr.model||{},views:this.map.bookViews.model,calcProperties:{}},this.map.definedNames.model&&(this.model.definedNames=this.map.definedNames.model),!1):!0}reconcile(y){const C=(y.workbookRels||[]).reduce((j,L)=>(j[L.Id]=L,j),{}),k=[];let F,I=0;(y.sheets||[]).forEach(j=>{const L=C[j.rId];L&&(F=y.worksheetHash["xl/"+L.Target.replace(/^(\s|\/xl\/)+/,"")],F&&(F.name=j.name,F.id=j.id,F.state=j.state,k[I++]=F))});const N=[];s.each(y.definedNames,j=>{if(j.name==="_xlnm.Print_Area"){if(F=k[j.localSheetId],F){F.pageSetup||(F.pageSetup={});const L=o.decodeEx(j.ranges[0]);F.pageSetup.printArea=F.pageSetup.printArea?`${F.pageSetup.printArea}&&${L.dimensions}`:L.dimensions}}else if(j.name==="_xlnm.Print_Titles"){if(F=k[j.localSheetId],F){F.pageSetup||(F.pageSetup={});const L=j.ranges.join(","),W=/\$/g,K=/\$\d+:\$\d+/,z=L.match(K);if(z&&z.length){const R=z[0];F.pageSetup.printTitlesRow=R.replace(W,"")}const M=/\$[A-Z]+:\$[A-Z]+/,B=L.match(M);if(B&&B.length){const R=B[0];F.pageSetup.printTitlesColumn=R.replace(W,"")}}}else N.push(j)}),y.definedNames=N,y.media.forEach((j,L)=>{j.index=L})}}g.WORKBOOK_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x15","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},g.STATIC_XFORMS={fileVersion:new c({tag:"fileVersion",$:{appName:"xl",lastEdited:5,lowestEdited:5,rupBuild:9303}})},n.exports=g},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./defined-name-xform":33,"./sheet-xform":34,"./workbook-calc-properties-xform":35,"./workbook-properties-xform":36,"./workbook-view-xform":37}],39:[function(r,n,i){const s=r("../strings/rich-text-xform"),o=r("../../../utils/utils"),a=r("../base-xform"),l=n.exports=function(c){this.model=c};o.inherits(l,a,{get tag(){return"r"},get richTextXform(){return this._richTextXform||(this._richTextXform=new s),this._richTextXform},render(c,u){u=u||this.model,c.openNode("comment",{ref:u.ref,authorId:0}),c.openNode("text"),u&&u.note&&u.note.texts&&u.note.texts.forEach(h=>{this.richTextXform.render(c,h)}),c.closeNode(),c.closeNode()},parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;switch(c.name){case"comment":return this.model={type:"note",note:{texts:[]},...c.attributes},!0;case"r":return this.parser=this.richTextXform,this.parser.parseOpen(c),!0;default:return!1}},parseText(c){this.parser&&this.parser.parseText(c)},parseClose(c){switch(c){case"comment":return!1;case"r":return this.model.note.texts.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(c),!0}}})},{"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],40:[function(r,n,i){const s=r("../../../utils/xml-stream"),o=r("../../../utils/utils"),a=r("../base-xform"),l=r("./comment-xform"),c=n.exports=function(){this.map={comment:new l}};o.inherits(c,a,{COMMENTS_ATTRIBUTES:{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main"}},{render(u,h){h=h||this.model,u.openXml(s.StdDocAttributes),u.openNode("comments",c.COMMENTS_ATTRIBUTES),u.openNode("authors"),u.leafNode("author",null,"Author"),u.closeNode(),u.openNode("commentList"),h.comments.forEach(d=>{this.map.comment.render(u,d)}),u.closeNode(),u.closeNode()},parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"commentList":return this.model={comments:[]},!0;case"comment":return this.parser=this.map.comment,this.parser.parseOpen(u),!0;default:return!1}},parseText(u){this.parser&&this.parser.parseText(u)},parseClose(u){switch(u){case"commentList":return!1;case"comment":return this.model.comments.push(this.parser.model),this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}})},{"../../../utils/utils":27,"../../../utils/xml-stream":28,"../base-xform":32,"./comment-xform":39}],41:[function(r,n,i){const s=r("../../base-xform");n.exports=class extends s{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,a,l){(a===l[2]||this.tag==="x:SizeWithCells"&&a===l[1])&&o.leafNode(this.tag)}parseOpen(o){return o.name===this.tag?(this.model={},this.model[this.tag]=!0,!0):!1}parseText(){}parseClose(){return!1}}},{"../../base-xform":32}],42:[function(r,n,i){const s=r("../../base-xform");n.exports=class extends s{constructor(o){super(),this._model=o}get tag(){return this._model&&this._model.tag}render(o,a){o.leafNode(this.tag,null,a)}parseOpen(o){return o.name===this.tag?(this.text="",!0):!1}parseText(o){this.text=o}parseClose(){return!1}}},{"../../base-xform":32}],43:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"x:Anchor"}getAnchorRect(o){const a=Math.floor(o.left),l=Math.floor(68*(o.left-a)),c=Math.floor(o.top),u=Math.floor(18*(o.top-c)),h=Math.floor(o.right),d=Math.floor(68*(o.right-h)),f=Math.floor(o.bottom);return[a,l,c,u,h,d,f,Math.floor(18*(o.bottom-f))]}getDefaultRect(o){const a=o.col,l=Math.max(o.row-2,0);return[a,6,l,14,a+2,2,l+4,16]}render(o,a){const l=a.anchor?this.getAnchorRect(a.anchor):this.getDefaultRect(a.refAddress);o.leafNode("x:Anchor",null,l.join(", "))}parseOpen(o){return o.name===this.tag?(this.text="",!0):!1}parseText(o){this.text=o}parseClose(){return!1}}},{"../base-xform":32}],44:[function(r,n,i){const s=r("../base-xform"),o=r("./vml-anchor-xform"),a=r("./style/vml-protection-xform"),l=r("./style/vml-position-xform"),c=["twoCells","oneCells","absolute"];n.exports=class extends s{constructor(){super(),this.map={"x:Anchor":new o,"x:Locked":new a({tag:"x:Locked"}),"x:LockText":new a({tag:"x:LockText"}),"x:SizeWithCells":new l({tag:"x:SizeWithCells"}),"x:MoveWithCells":new l({tag:"x:MoveWithCells"})}}get tag(){return"x:ClientData"}render(u,h){const{protection:d,editAs:f}=h.note;u.openNode(this.tag,{ObjectType:"Note"}),this.map["x:MoveWithCells"].render(u,f,c),this.map["x:SizeWithCells"].render(u,f,c),this.map["x:Anchor"].render(u,h),this.map["x:Locked"].render(u,d.locked),u.leafNode("x:AutoFill",null,"False"),this.map["x:LockText"].render(u,d.lockText),u.leafNode("x:Row",null,h.refAddress.row-1),u.leafNode("x:Column",null,h.refAddress.col-1),u.closeNode()}parseOpen(u){return u.name===this.tag?(this.reset(),this.model={anchor:[],protection:{},editAs:""}):(this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)),!0}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):u===this.tag?(this.normalizeModel(),!1):!0}normalizeModel(){const u=Object.assign({},this.map["x:MoveWithCells"].model,this.map["x:SizeWithCells"].model),h=Object.keys(u).length;this.model.editAs=c[h],this.model.anchor=this.map["x:Anchor"].text,this.model.protection.locked=this.map["x:Locked"].text,this.model.protection.lockText=this.map["x:LockText"].text}}},{"../base-xform":32,"./style/vml-position-xform":41,"./style/vml-protection-xform":42,"./vml-anchor-xform":43}],45:[function(r,n,i){const s=r("../../../utils/xml-stream"),o=r("../base-xform"),a=r("./vml-shape-xform");class l extends o{constructor(){super(),this.map={"v:shape":new a}}get tag(){return"xml"}render(u,h){u.openXml(s.StdDocAttributes),u.openNode(this.tag,l.DRAWING_ATTRIBUTES),u.openNode("o:shapelayout",{"v:ext":"edit"}),u.leafNode("o:idmap",{"v:ext":"edit",data:1}),u.closeNode(),u.openNode("v:shapetype",{id:"_x0000_t202",coordsize:"21600,21600","o:spt":202,path:"m,l,21600r21600,l21600,xe"}),u.leafNode("v:stroke",{joinstyle:"miter"}),u.leafNode("v:path",{gradientshapeok:"t","o:connecttype":"rect"}),u.closeNode(),h.comments.forEach((d,f)=>{this.map["v:shape"].render(u,d,f)}),u.closeNode()}parseOpen(u){return this.parser?(this.parser.parseOpen(u),!0):(u.name===this.tag?(this.reset(),this.model={comments:[]}):(this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)),!0)}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.model.comments.push(this.parser.model),this.parser=void 0),!0):u!==this.tag}reconcile(u,h){u.anchors.forEach(d=>{d.br?this.map["xdr:twoCellAnchor"].reconcile(d,h):this.map["xdr:oneCellAnchor"].reconcile(d,h)})}}l.DRAWING_ATTRIBUTES={"xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:x":"urn:schemas-microsoft-com:office:excel"},n.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"./vml-shape-xform":46}],46:[function(r,n,i){const s=r("../base-xform"),o=r("./vml-textbox-xform"),a=r("./vml-client-data-xform");class l extends s{constructor(){super(),this.map={"v:textbox":new o,"x:ClientData":new a}}get tag(){return"v:shape"}render(u,h,d){u.openNode("v:shape",l.V_SHAPE_ATTRIBUTES(h,d)),u.leafNode("v:fill",{color2:"infoBackground [80]"}),u.leafNode("v:shadow",{color:"none [81]",obscured:"t"}),u.leafNode("v:path",{"o:connecttype":"none"}),this.map["v:textbox"].render(u,h),this.map["x:ClientData"].render(u,h),u.closeNode()}parseOpen(u){return this.parser?(this.parser.parseOpen(u),!0):(u.name===this.tag?(this.reset(),this.model={margins:{insetmode:u.attributes["o:insetmode"]},anchor:"",editAs:"",protection:{}}):(this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)),!0)}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):u===this.tag?(this.model.margins.inset=this.map["v:textbox"].model&&this.map["v:textbox"].model.inset,this.model.protection=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.protection,this.model.anchor=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.anchor,this.model.editAs=this.map["x:ClientData"].model&&this.map["x:ClientData"].model.editAs,!1):!0}}l.V_SHAPE_ATTRIBUTES=(c,u)=>({id:"_x0000_s"+(1025+u),type:"#_x0000_t202",style:"position:absolute; margin-left:105.3pt;margin-top:10.5pt;width:97.8pt;height:59.1pt;z-index:1;visibility:hidden",fillcolor:"infoBackground [80]",strokecolor:"none [81]","o:insetmode":c.note.margins&&c.note.margins.insetmode}),n.exports=l},{"../base-xform":32,"./vml-client-data-xform":44,"./vml-textbox-xform":47}],47:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"v:textbox"}conversionUnit(o,a,l){return`${parseFloat(o)*a.toFixed(2)}${l}`}reverseConversionUnit(o){return(o||"").split(",").map(a=>Number(parseFloat(this.conversionUnit(parseFloat(a),.1,"")).toFixed(2)))}render(o,a){const l={style:"mso-direction-alt:auto"};if(a&&a.note){let{inset:c}=a.note&&a.note.margins;Array.isArray(c)&&(c=c.map(u=>this.conversionUnit(u,10,"mm")).join(",")),c&&(l.inset=c)}o.openNode("v:textbox",l),o.leafNode("div",{style:"text-align:left"}),o.closeNode()}parseOpen(o){return o.name===this.tag&&(this.model={inset:this.reverseConversionUnit(o.attributes.inset)}),!0}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],48:[function(r,n,i){const s=r("./base-xform");n.exports=class extends s{createNewModel(o){return{}}parseOpen(o){return this.parser=this.parser||this.map[o.name],this.parser?(this.parser.parseOpen(o),!0):o.name===this.tag&&(this.model=this.createNewModel(o),!0)}parseText(o){this.parser&&this.parser.parseText(o)}onParserClose(o,a){this.model[o]=a.model}parseClose(o){return this.parser?(this.parser.parseClose(o)||(this.onParserClose(o,this.parser),this.parser=void 0),!0):o!==this.tag}}},{"./base-xform":32}],49:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{render(o,a){o.openNode("HeadingPairs"),o.openNode("vt:vector",{size:2,baseType:"variant"}),o.openNode("vt:variant"),o.leafNode("vt:lpstr",void 0,"Worksheets"),o.closeNode(),o.openNode("vt:variant"),o.leafNode("vt:i4",void 0,a.length),o.closeNode(),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="HeadingPairs"}parseText(){}parseClose(o){return o!=="HeadingPairs"}}},{"../base-xform":32}],50:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{render(o,a){o.openNode("TitlesOfParts"),o.openNode("vt:vector",{size:a.length,baseType:"lpstr"}),a.forEach(l=>{o.leafNode("vt:lpstr",void 0,l.name)}),o.closeNode(),o.closeNode()}parseOpen(o){return o.name==="TitlesOfParts"}parseText(){}parseClose(o){return o!=="TitlesOfParts"}}},{"../base-xform":32}],51:[function(r,n,i){const s=r("../../../utils/xml-stream"),o=r("../base-xform"),a=r("../simple/string-xform"),l=r("./app-heading-pairs-xform"),c=r("./app-titles-of-parts-xform");class u extends o{constructor(){super(),this.map={Company:new a({tag:"Company"}),Manager:new a({tag:"Manager"}),HeadingPairs:new l,TitleOfParts:new c}}render(d,f){d.openXml(s.StdDocAttributes),d.openNode("Properties",u.PROPERTY_ATTRIBUTES),d.leafNode("Application",void 0,"Microsoft Excel"),d.leafNode("DocSecurity",void 0,"0"),d.leafNode("ScaleCrop",void 0,"false"),this.map.HeadingPairs.render(d,f.worksheets),this.map.TitleOfParts.render(d,f.worksheets),this.map.Company.render(d,f.company||""),this.map.Manager.render(d,f.manager),d.leafNode("LinksUpToDate",void 0,"false"),d.leafNode("SharedDoc",void 0,"false"),d.leafNode("HyperlinksChanged",void 0,"false"),d.leafNode("AppVersion",void 0,"16.0300"),d.closeNode()}parseOpen(d){return this.parser?(this.parser.parseOpen(d),!0):d.name==="Properties"?!0:(this.parser=this.map[d.name],!!this.parser&&(this.parser.parseOpen(d),!0))}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.parser=void 0),!0):d==="Properties"?(this.model={worksheets:this.map.TitleOfParts.model,company:this.map.Company.model,manager:this.map.Manager.model},!1):!0}}u.DateFormat=function(h){return h.toISOString().replace(/[.]\d{3,6}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties","xmlns:vt":"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/string-xform":119,"./app-heading-pairs-xform":49,"./app-titles-of-parts-xform":50}],52:[function(r,n,i){const s=r("../../../utils/xml-stream"),o=r("../base-xform");class a extends o{render(c,u){c.openXml(s.StdDocAttributes),c.openNode("Types",a.PROPERTY_ATTRIBUTES);const h={};(u.media||[]).forEach(d=>{if(d.type==="image"){const f=d.extension;h[f]||(h[f]=!0,c.leafNode("Default",{Extension:f,ContentType:"image/"+f}))}}),c.leafNode("Default",{Extension:"rels",ContentType:"application/vnd.openxmlformats-package.relationships+xml"}),c.leafNode("Default",{Extension:"xml",ContentType:"application/xml"}),c.leafNode("Override",{PartName:"/xl/workbook.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml"}),u.worksheets.forEach(d=>{const f=`/xl/worksheets/sheet${d.id}.xml`;c.leafNode("Override",{PartName:f,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml"})}),c.leafNode("Override",{PartName:"/xl/theme/theme1.xml",ContentType:"application/vnd.openxmlformats-officedocument.theme+xml"}),c.leafNode("Override",{PartName:"/xl/styles.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml"}),u.sharedStrings&&u.sharedStrings.count&&c.leafNode("Override",{PartName:"/xl/sharedStrings.xml",ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml"}),u.tables&&u.tables.forEach(d=>{c.leafNode("Override",{PartName:"/xl/tables/"+d.target,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml"})}),u.drawings&&u.drawings.forEach(d=>{c.leafNode("Override",{PartName:`/xl/drawings/${d.name}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.drawing+xml"})}),u.commentRefs&&(c.leafNode("Default",{Extension:"vml",ContentType:"application/vnd.openxmlformats-officedocument.vmlDrawing"}),u.commentRefs.forEach(d=>{let{commentName:f}=d;c.leafNode("Override",{PartName:`/xl/${f}.xml`,ContentType:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml"})})),c.leafNode("Override",{PartName:"/docProps/core.xml",ContentType:"application/vnd.openxmlformats-package.core-properties+xml"}),c.leafNode("Override",{PartName:"/docProps/app.xml",ContentType:"application/vnd.openxmlformats-officedocument.extended-properties+xml"}),c.closeNode()}parseOpen(){return!1}parseText(){}parseClose(){return!1}}a.PROPERTY_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"},n.exports=a},{"../../../utils/xml-stream":28,"../base-xform":32}],53:[function(r,n,i){const s=r("../../../utils/xml-stream"),o=r("../base-xform"),a=r("../simple/date-xform"),l=r("../simple/string-xform"),c=r("../simple/integer-xform");class u extends o{constructor(){super(),this.map={"dc:creator":new l({tag:"dc:creator"}),"dc:title":new l({tag:"dc:title"}),"dc:subject":new l({tag:"dc:subject"}),"dc:description":new l({tag:"dc:description"}),"dc:identifier":new l({tag:"dc:identifier"}),"dc:language":new l({tag:"dc:language"}),"cp:keywords":new l({tag:"cp:keywords"}),"cp:category":new l({tag:"cp:category"}),"cp:lastModifiedBy":new l({tag:"cp:lastModifiedBy"}),"cp:lastPrinted":new a({tag:"cp:lastPrinted",format:u.DateFormat}),"cp:revision":new c({tag:"cp:revision"}),"cp:version":new l({tag:"cp:version"}),"cp:contentStatus":new l({tag:"cp:contentStatus"}),"cp:contentType":new l({tag:"cp:contentType"}),"dcterms:created":new a({tag:"dcterms:created",attrs:u.DateAttrs,format:u.DateFormat}),"dcterms:modified":new a({tag:"dcterms:modified",attrs:u.DateAttrs,format:u.DateFormat})}}render(d,f){d.openXml(s.StdDocAttributes),d.openNode("cp:coreProperties",u.CORE_PROPERTY_ATTRIBUTES),this.map["dc:creator"].render(d,f.creator),this.map["dc:title"].render(d,f.title),this.map["dc:subject"].render(d,f.subject),this.map["dc:description"].render(d,f.description),this.map["dc:identifier"].render(d,f.identifier),this.map["dc:language"].render(d,f.language),this.map["cp:keywords"].render(d,f.keywords),this.map["cp:category"].render(d,f.category),this.map["cp:lastModifiedBy"].render(d,f.lastModifiedBy),this.map["cp:lastPrinted"].render(d,f.lastPrinted),this.map["cp:revision"].render(d,f.revision),this.map["cp:version"].render(d,f.version),this.map["cp:contentStatus"].render(d,f.contentStatus),this.map["cp:contentType"].render(d,f.contentType),this.map["dcterms:created"].render(d,f.created),this.map["dcterms:modified"].render(d,f.modified),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"cp:coreProperties":case"coreProperties":return!0;default:if(this.parser=this.map[d.name],this.parser)return this.parser.parseOpen(d),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(d))}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){if(this.parser)return this.parser.parseClose(d)||(this.parser=void 0),!0;switch(d){case"cp:coreProperties":case"coreProperties":return this.model={creator:this.map["dc:creator"].model,title:this.map["dc:title"].model,subject:this.map["dc:subject"].model,description:this.map["dc:description"].model,identifier:this.map["dc:identifier"].model,language:this.map["dc:language"].model,keywords:this.map["cp:keywords"].model,category:this.map["cp:category"].model,lastModifiedBy:this.map["cp:lastModifiedBy"].model,lastPrinted:this.map["cp:lastPrinted"].model,revision:this.map["cp:revision"].model,contentStatus:this.map["cp:contentStatus"].model,contentType:this.map["cp:contentType"].model,created:this.map["dcterms:created"].model,modified:this.map["dcterms:modified"].model},!1;default:throw new Error("Unexpected xml node in parseClose: "+d)}}}u.DateFormat=function(h){return h.toISOString().replace(/[.]\d{3}/,"")},u.DateAttrs={"xsi:type":"dcterms:W3CDTF"},u.CORE_PROPERTY_ATTRIBUTES={"xmlns:cp":"http://schemas.openxmlformats.org/package/2006/metadata/core-properties","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:dcterms":"http://purl.org/dc/terms/","xmlns:dcmitype":"http://purl.org/dc/dcmitype/","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance"},n.exports=u},{"../../../utils/xml-stream":28,"../base-xform":32,"../simple/date-xform":117,"../simple/integer-xform":118,"../simple/string-xform":119}],54:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{render(o,a){o.leafNode("Relationship",a)}parseOpen(o){return o.name==="Relationship"?(this.model=o.attributes,!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],55:[function(r,n,i){const s=r("../../../utils/xml-stream"),o=r("../base-xform"),a=r("./relationship-xform");class l extends o{constructor(){super(),this.map={Relationship:new a}}render(u,h){h=h||this._values,u.openXml(s.StdDocAttributes),u.openNode("Relationships",l.RELATIONSHIPS_ATTRIBUTES),h.forEach(d=>{this.map.Relationship.render(u,d)}),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"Relationships":return this.model=[],!0;default:if(this.parser=this.map[u.name],this.parser)return this.parser.parseOpen(u),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(u))}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){if(this.parser)return this.parser.parseClose(u)||(this.model.push(this.parser.model),this.parser=void 0),!0;if(u==="Relationships")return!1;throw new Error("Unexpected xml node in parseClose: "+u)}}l.RELATIONSHIPS_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"},n.exports=l},{"../../../utils/xml-stream":28,"../base-xform":32,"./relationship-xform":54}],56:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{parseOpen(o){return this.parser?(this.parser.parseOpen(o),!0):(o.name===this.tag?(this.reset(),this.model={range:{editAs:o.attributes.editAs||"oneCell"}}):(this.parser=this.map[o.name],this.parser&&this.parser.parseOpen(o)),!0)}parseText(o){this.parser&&this.parser.parseText(o)}reconcilePicture(o,a){if(o&&o.rId){const l=a.rels[o.rId].Target.match(/.*\/media\/(.+[.][a-zA-Z]{3,4})/);if(l){const c=l[1],u=a.mediaIndex[c];return a.media[u]}}}}},{"../base-xform":32}],57:[function(r,n,i){const s=r("../base-xform"),o=r("./blip-xform");n.exports=class extends s{constructor(){super(),this.map={"a:blip":new o}}get tag(){return"xdr:blipFill"}render(a,l){a.openNode(this.tag),this.map["a:blip"].render(a,l),a.openNode("a:stretch"),a.leafNode("a:fillRect"),a.closeNode(),a.closeNode()}parseOpen(a){return this.parser?(this.parser.parseOpen(a),!0):(a.name===this.tag?this.reset():(this.parser=this.map[a.name],this.parser&&this.parser.parseOpen(a)),!0)}parseText(){}parseClose(a){return this.parser?(this.parser.parseClose(a)||(this.parser=void 0),!0):a===this.tag?(this.model=this.map["a:blip"].model,!1):!0}}},{"../base-xform":32,"./blip-xform":58}],58:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"a:blip"}render(o,a){o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:embed":a.rId,cstate:"print"})}parseOpen(o){return o.name===this.tag&&(this.model={rId:o.attributes["r:embed"]}),!0}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],59:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"xdr:cNvPicPr"}render(o){o.openNode(this.tag),o.leafNode("a:picLocks",{noChangeAspect:"1"}),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],60:[function(r,n,i){const s=r("../base-xform"),o=r("./hlink-click-xform"),a=r("./ext-lst-xform");n.exports=class extends s{constructor(){super(),this.map={"a:hlinkClick":new o,"a:extLst":new a}}get tag(){return"xdr:cNvPr"}render(l,c){l.openNode(this.tag,{id:c.index,name:"Picture "+c.index}),this.map["a:hlinkClick"].render(l,c),this.map["a:extLst"].render(l,c),l.closeNode()}parseOpen(l){return this.parser?(this.parser.parseOpen(l),!0):(l.name===this.tag?this.reset():(this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)),!0)}parseText(){}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.parser=void 0),!0):l===this.tag?(this.model=this.map["a:hlinkClick"].model,!1):!0}}},{"../base-xform":32,"./ext-lst-xform":63,"./hlink-click-xform":65}],61:[function(r,n,i){const s=r("../base-xform"),o=r("../simple/integer-xform");n.exports=class extends s{constructor(a){super(),this.tag=a.tag,this.map={"xdr:col":new o({tag:"xdr:col",zero:!0}),"xdr:colOff":new o({tag:"xdr:colOff",zero:!0}),"xdr:row":new o({tag:"xdr:row",zero:!0}),"xdr:rowOff":new o({tag:"xdr:rowOff",zero:!0})}}render(a,l){a.openNode(this.tag),this.map["xdr:col"].render(a,l.nativeCol),this.map["xdr:colOff"].render(a,l.nativeColOff),this.map["xdr:row"].render(a,l.nativeRow),this.map["xdr:rowOff"].render(a,l.nativeRowOff),a.closeNode()}parseOpen(a){return this.parser?(this.parser.parseOpen(a),!0):(a.name===this.tag?this.reset():(this.parser=this.map[a.name],this.parser&&this.parser.parseOpen(a)),!0)}parseText(a){this.parser&&this.parser.parseText(a)}parseClose(a){return this.parser?(this.parser.parseClose(a)||(this.parser=void 0),!0):a===this.tag?(this.model={nativeCol:this.map["xdr:col"].model,nativeColOff:this.map["xdr:colOff"].model,nativeRow:this.map["xdr:row"].model,nativeRowOff:this.map["xdr:rowOff"].model},!1):!0}}},{"../base-xform":32,"../simple/integer-xform":118}],62:[function(r,n,i){const s=r("../../../utils/col-cache"),o=r("../../../utils/xml-stream"),a=r("../base-xform"),l=r("./two-cell-anchor-xform"),c=r("./one-cell-anchor-xform");class u extends a{constructor(){super(),this.map={"xdr:twoCellAnchor":new l,"xdr:oneCellAnchor":new c}}prepare(d){d.anchors.forEach((f,m)=>{f.anchorType=(function(v){return(typeof v.range=="string"?s.decode(v.range):v.range).br?"xdr:twoCellAnchor":"xdr:oneCellAnchor"})(f),this.map[f.anchorType].prepare(f,{index:m})})}get tag(){return"xdr:wsDr"}render(d,f){d.openXml(o.StdDocAttributes),d.openNode(this.tag,u.DRAWING_ATTRIBUTES),f.anchors.forEach(m=>{this.map[m.anchorType].render(d,m)}),d.closeNode()}parseOpen(d){return this.parser?(this.parser.parseOpen(d),!0):(d.name===this.tag?(this.reset(),this.model={anchors:[]}):(this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d)),!0)}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.model.anchors.push(this.parser.model),this.parser=void 0),!0):d!==this.tag}reconcile(d,f){d.anchors.forEach(m=>{m.br?this.map["xdr:twoCellAnchor"].reconcile(m,f):this.map["xdr:oneCellAnchor"].reconcile(m,f)})}}u.DRAWING_ATTRIBUTES={"xmlns:xdr":"http://schemas.openxmlformats.org/drawingml/2006/spreadsheetDrawing","xmlns:a":"http://schemas.openxmlformats.org/drawingml/2006/main"},n.exports=u},{"../../../utils/col-cache":19,"../../../utils/xml-stream":28,"../base-xform":32,"./one-cell-anchor-xform":67,"./two-cell-anchor-xform":70}],63:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"a:extLst"}render(o){o.openNode(this.tag),o.openNode("a:ext",{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}"}),o.leafNode("a16:creationId",{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{00000000-0008-0000-0000-000002000000}"}),o.closeNode(),o.closeNode()}parseOpen(o){switch(o.name){case this.tag:default:return!0}}parseText(){}parseClose(o){return o!==this.tag}}},{"../base-xform":32}],64:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.map={}}render(o,a){o.openNode(this.tag);const l=Math.floor(9525*a.width),c=Math.floor(9525*a.height);o.addAttribute("cx",l),o.addAttribute("cy",c),o.closeNode()}parseOpen(o){return o.name===this.tag&&(this.model={width:parseInt(o.attributes.cx||"0",10)/9525,height:parseInt(o.attributes.cy||"0",10)/9525},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],65:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"a:hlinkClick"}render(o,a){a.hyperlinks&&a.hyperlinks.rId&&o.leafNode(this.tag,{"xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","r:id":a.hyperlinks.rId,tooltip:a.hyperlinks.tooltip})}parseOpen(o){return o.name===this.tag&&(this.model={hyperlinks:{rId:o.attributes["r:id"],tooltip:o.attributes.tooltip}}),!0}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],66:[function(r,n,i){const s=r("../base-xform"),o=r("./c-nv-pr-xform"),a=r("./c-nv-pic-pr-xform");n.exports=class extends s{constructor(){super(),this.map={"xdr:cNvPr":new o,"xdr:cNvPicPr":new a}}get tag(){return"xdr:nvPicPr"}render(l,c){l.openNode(this.tag),this.map["xdr:cNvPr"].render(l,c),this.map["xdr:cNvPicPr"].render(l,c),l.closeNode()}parseOpen(l){return this.parser?(this.parser.parseOpen(l),!0):(l.name===this.tag?this.reset():(this.parser=this.map[l.name],this.parser&&this.parser.parseOpen(l)),!0)}parseText(){}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.parser=void 0),!0):l===this.tag?(this.model=this.map["xdr:cNvPr"].model,!1):!0}}},{"../base-xform":32,"./c-nv-pic-pr-xform":59,"./c-nv-pr-xform":60}],67:[function(r,n,i){const s=r("./base-cell-anchor-xform"),o=r("../static-xform"),a=r("./cell-position-xform"),l=r("./ext-xform"),c=r("./pic-xform");n.exports=class extends s{constructor(){super(),this.map={"xdr:from":new a({tag:"xdr:from"}),"xdr:ext":new l({tag:"xdr:ext"}),"xdr:pic":new c,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:oneCellAnchor"}prepare(u,h){this.map["xdr:pic"].prepare(u.picture,h)}render(u,h){u.openNode(this.tag,{editAs:h.range.editAs||"oneCell"}),this.map["xdr:from"].render(u,h.range.tl),this.map["xdr:ext"].render(u,h.range.ext),this.map["xdr:pic"].render(u,h.picture),this.map["xdr:clientData"].render(u,{}),u.closeNode()}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):u===this.tag?(this.model.range.tl=this.map["xdr:from"].model,this.model.range.ext=this.map["xdr:ext"].model,this.model.picture=this.map["xdr:pic"].model,!1):!0}reconcile(u,h){u.medium=this.reconcilePicture(u.picture,h)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./ext-xform":64,"./pic-xform":68}],68:[function(r,n,i){const s=r("../base-xform"),o=r("../static-xform"),a=r("./blip-fill-xform"),l=r("./nv-pic-pr-xform"),c=r("./sp-pr");n.exports=class extends s{constructor(){super(),this.map={"xdr:nvPicPr":new l,"xdr:blipFill":new a,"xdr:spPr":new o(c)}}get tag(){return"xdr:pic"}prepare(u,h){u.index=h.index+1}render(u,h){u.openNode(this.tag),this.map["xdr:nvPicPr"].render(u,h),this.map["xdr:blipFill"].render(u,h),this.map["xdr:spPr"].render(u,h),u.closeNode()}parseOpen(u){return this.parser?(this.parser.parseOpen(u),!0):(u.name===this.tag?this.reset():(this.parser=this.map[u.name],this.parser&&this.parser.parseOpen(u)),!0)}parseText(){}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.mergeModel(this.parser.model),this.parser=void 0),!0):u!==this.tag}}},{"../base-xform":32,"../static-xform":120,"./blip-fill-xform":57,"./nv-pic-pr-xform":66,"./sp-pr":69}],69:[function(r,n,i){n.exports={tag:"xdr:spPr",c:[{tag:"a:xfrm",c:[{tag:"a:off",$:{x:"0",y:"0"}},{tag:"a:ext",$:{cx:"0",cy:"0"}}]},{tag:"a:prstGeom",$:{prst:"rect"},c:[{tag:"a:avLst"}]}]}},{}],70:[function(r,n,i){const s=r("./base-cell-anchor-xform"),o=r("../static-xform"),a=r("./cell-position-xform"),l=r("./pic-xform");n.exports=class extends s{constructor(){super(),this.map={"xdr:from":new a({tag:"xdr:from"}),"xdr:to":new a({tag:"xdr:to"}),"xdr:pic":new l,"xdr:clientData":new o({tag:"xdr:clientData"})}}get tag(){return"xdr:twoCellAnchor"}prepare(c,u){this.map["xdr:pic"].prepare(c.picture,u)}render(c,u){c.openNode(this.tag,{editAs:u.range.editAs||"oneCell"}),this.map["xdr:from"].render(c,u.range.tl),this.map["xdr:to"].render(c,u.range.br),this.map["xdr:pic"].render(c,u.picture),this.map["xdr:clientData"].render(c,{}),c.closeNode()}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):c===this.tag?(this.model.range.tl=this.map["xdr:from"].model,this.model.range.br=this.map["xdr:to"].model,this.model.picture=this.map["xdr:pic"].model,!1):!0}reconcile(c,u){c.medium=this.reconcilePicture(c.picture,u)}}},{"../static-xform":120,"./base-cell-anchor-xform":56,"./cell-position-xform":61,"./pic-xform":68}],71:[function(r,n,i){const s=r("./base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.always=!!o.always,this.count=o.count,this.empty=o.empty,this.$count=o.$count||"count",this.$=o.$,this.childXform=o.childXform,this.maxItems=o.maxItems}prepare(o,a){const{childXform:l}=this;o&&o.forEach((c,u)=>{a.index=u,l.prepare(c,a)})}render(o,a){if(this.always||a&&a.length){o.openNode(this.tag,this.$),this.count&&o.addAttribute(this.$count,a&&a.length||0);const{childXform:l}=this;(a||[]).forEach((c,u)=>{l.render(o,c,u)}),o.closeNode()}else this.empty&&o.leafNode(this.tag)}parseOpen(o){return this.parser?(this.parser.parseOpen(o),!0):o.name===this.tag?(this.model=[],!0):!!this.childXform.parseOpen(o)&&(this.parser=this.childXform,!0)}parseText(o){this.parser&&this.parser.parseText(o)}parseClose(o){if(this.parser){if(!this.parser.parseClose(o)&&(this.model.push(this.parser.model),this.parser=void 0,this.maxItems&&this.model.length>this.maxItems))throw new Error(`Max ${this.childXform.tag} count (${this.maxItems}) exceeded`);return!0}return!1}reconcile(o,a){if(o){const{childXform:l}=this;o.forEach(c=>{l.reconcile(c,a)})}}}},{"./base-xform":32}],72:[function(r,n,i){const s=r("../../../utils/col-cache"),o=r("../base-xform");n.exports=class extends o{get tag(){return"autoFilter"}render(a,l){if(l)if(typeof l=="string")a.leafNode("autoFilter",{ref:l});else{const c=function(d){return typeof d=="string"?d:s.getAddress(d.row,d.column).address},u=c(l.from),h=c(l.to);u&&h&&a.leafNode("autoFilter",{ref:`${u}:${h}`})}}parseOpen(a){a.name==="autoFilter"&&(this.model=a.attributes.ref)}}},{"../../../utils/col-cache":19,"../base-xform":32}],73:[function(r,n,i){const s=r("../../../utils/utils"),o=r("../base-xform"),a=r("../../../doc/range"),l=r("../../../doc/enums"),c=r("../strings/rich-text-xform");function u(h){if(h==null)return l.ValueType.Null;if(h instanceof String||typeof h=="string")return l.ValueType.String;if(typeof h=="number")return l.ValueType.Number;if(typeof h=="boolean")return l.ValueType.Boolean;if(h instanceof Date)return l.ValueType.Date;if(h.text&&h.hyperlink)return l.ValueType.Hyperlink;if(h.formula)return l.ValueType.Formula;if(h.error)return l.ValueType.Error;throw new Error("I could not understand type of value")}n.exports=class extends o{constructor(){super(),this.richTextXForm=new c}get tag(){return"c"}prepare(h,d){const f=d.styles.addStyleModel(h.style||{},(function(m){return m.type===l.ValueType.Formula?u(m.result):m.type})(h));switch(f&&(h.styleId=f),h.comment&&d.comments.push({...h.comment,ref:h.address}),h.type){case l.ValueType.String:case l.ValueType.RichText:d.sharedStrings&&(h.ssId=d.sharedStrings.add(h.value));break;case l.ValueType.Date:d.date1904&&(h.date1904=!0);break;case l.ValueType.Hyperlink:d.sharedStrings&&h.text!==void 0&&h.text!==null&&(h.ssId=d.sharedStrings.add(h.text)),d.hyperlinks.push({address:h.address,target:h.hyperlink,tooltip:h.tooltip});break;case l.ValueType.Merge:d.merges.add(h);break;case l.ValueType.Formula:if(d.date1904&&(h.date1904=!0),h.shareType==="shared"&&(h.si=d.siFormulae++),h.formula)d.formulae[h.address]=h;else if(h.sharedFormula){const m=d.formulae[h.sharedFormula];if(!m)throw new Error("Shared Formula master must exist above and or left of clone for cell "+h.address);m.si===void 0?(m.shareType="shared",m.si=d.siFormulae++,m.range=new a(m.address,h.address)):m.range&&m.range.expandToAddress(h.address),h.si=m.si}}}renderFormula(h,d){let f=null;switch(d.shareType){case"shared":f={t:"shared",ref:d.ref||d.range.range,si:d.si};break;case"array":f={t:"array",ref:d.ref};break;default:d.si!==void 0&&(f={t:"shared",si:d.si})}switch(u(d.result)){case l.ValueType.Null:h.leafNode("f",f,d.formula);break;case l.ValueType.String:h.addAttribute("t","str"),h.leafNode("f",f,d.formula),h.leafNode("v",null,d.result);break;case l.ValueType.Number:h.leafNode("f",f,d.formula),h.leafNode("v",null,d.result);break;case l.ValueType.Boolean:h.addAttribute("t","b"),h.leafNode("f",f,d.formula),h.leafNode("v",null,d.result?1:0);break;case l.ValueType.Error:h.addAttribute("t","e"),h.leafNode("f",f,d.formula),h.leafNode("v",null,d.result.error);break;case l.ValueType.Date:h.leafNode("f",f,d.formula),h.leafNode("v",null,s.dateToExcel(d.result,d.date1904));break;default:throw new Error("I could not understand type of value")}}render(h,d){if(d.type!==l.ValueType.Null||d.styleId){switch(h.openNode("c"),h.addAttribute("r",d.address),d.styleId&&h.addAttribute("s",d.styleId),d.type){case l.ValueType.Null:break;case l.ValueType.Number:h.leafNode("v",null,d.value);break;case l.ValueType.Boolean:h.addAttribute("t","b"),h.leafNode("v",null,d.value?"1":"0");break;case l.ValueType.Error:h.addAttribute("t","e"),h.leafNode("v",null,d.value.error);break;case l.ValueType.String:case l.ValueType.RichText:d.ssId!==void 0?(h.addAttribute("t","s"),h.leafNode("v",null,d.ssId)):d.value&&d.value.richText?(h.addAttribute("t","inlineStr"),h.openNode("is"),d.value.richText.forEach(f=>{this.richTextXForm.render(h,f)}),h.closeNode("is")):(h.addAttribute("t","str"),h.leafNode("v",null,d.value));break;case l.ValueType.Date:h.leafNode("v",null,s.dateToExcel(d.value,d.date1904));break;case l.ValueType.Hyperlink:d.ssId!==void 0?(h.addAttribute("t","s"),h.leafNode("v",null,d.ssId)):(h.addAttribute("t","str"),h.leafNode("v",null,d.text));break;case l.ValueType.Formula:this.renderFormula(h,d);break;case l.ValueType.Merge:}h.closeNode()}}parseOpen(h){if(this.parser)return this.parser.parseOpen(h),!0;switch(h.name){case"c":return this.model={address:h.attributes.r},this.t=h.attributes.t,h.attributes.s&&(this.model.styleId=parseInt(h.attributes.s,10)),!0;case"f":return this.currentNode="f",this.model.si=h.attributes.si,this.model.shareType=h.attributes.t,this.model.ref=h.attributes.ref,!0;case"v":return this.currentNode="v",!0;case"t":return this.currentNode="t",!0;case"r":return this.parser=this.richTextXForm,this.parser.parseOpen(h),!0;default:return!1}}parseText(h){if(this.parser)this.parser.parseText(h);else switch(this.currentNode){case"f":this.model.formula=this.model.formula?this.model.formula+h:h;break;case"v":case"t":this.model.value&&this.model.value.richText?this.model.value.richText.text=this.model.value.richText.text?this.model.value.richText.text+h:h:this.model.value=this.model.value?this.model.value+h:h}}parseClose(h){switch(h){case"c":{const{model:d}=this;if(d.formula||d.shareType)d.type=l.ValueType.Formula,d.value&&(this.t==="str"?d.result=s.xmlDecode(d.value):this.t==="b"?d.result=parseInt(d.value,10)!==0:this.t==="e"?d.result={error:d.value}:d.result=parseFloat(d.value),d.value=void 0);else if(d.value!==void 0)switch(this.t){case"s":d.type=l.ValueType.String,d.value=parseInt(d.value,10);break;case"str":d.type=l.ValueType.String,d.value=s.xmlDecode(d.value);break;case"inlineStr":d.type=l.ValueType.String;break;case"b":d.type=l.ValueType.Boolean,d.value=parseInt(d.value,10)!==0;break;case"e":d.type=l.ValueType.Error,d.value={error:d.value};break;default:d.type=l.ValueType.Number,d.value=parseFloat(d.value)}else d.styleId?d.type=l.ValueType.Null:d.type=l.ValueType.Merge;return!1}case"f":case"v":case"is":return this.currentNode=void 0,!0;case"t":return this.parser?(this.parser.parseClose(h),!0):(this.currentNode=void 0,!0);case"r":return this.model.value=this.model.value||{},this.model.value.richText=this.model.value.richText||[],this.model.value.richText.push(this.parser.model),this.parser=void 0,this.currentNode=void 0,!0;default:return!!this.parser&&(this.parser.parseClose(h),!0)}}reconcile(h,d){const f=h.styleId&&d.styles&&d.styles.getStyleModel(h.styleId);switch(f&&(h.style=f),h.styleId!==void 0&&(h.styleId=void 0),h.type){case l.ValueType.String:typeof h.value=="number"&&d.sharedStrings&&(h.value=d.sharedStrings.getString(h.value)),h.value.richText&&(h.type=l.ValueType.RichText);break;case l.ValueType.Number:f&&s.isDateFmt(f.numFmt)&&(h.type=l.ValueType.Date,h.value=s.excelToDate(h.value,d.date1904));break;case l.ValueType.Formula:h.result!==void 0&&f&&s.isDateFmt(f.numFmt)&&(h.result=s.excelToDate(h.result,d.date1904)),h.shareType==="shared"&&(h.ref?d.formulae[h.si]=h.address:(h.sharedFormula=d.formulae[h.si],delete h.shareType),delete h.si)}const m=d.hyperlinkMap[h.address];m&&(h.type===l.ValueType.Formula?(h.text=h.result,h.result=void 0):(h.text=h.value,h.value=void 0),h.type=l.ValueType.Hyperlink,h.hyperlink=m);const v=d.commentsMap&&d.commentsMap[h.address];v&&(h.comment=v)}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/utils":27,"../base-xform":32,"../strings/rich-text-xform":122}],74:[function(r,n,i){const s=r("../../base-xform");n.exports=class extends s{get tag(){return"x14:cfIcon"}render(o,a){o.leafNode(this.tag,{iconSet:a.iconSet,iconId:a.iconId})}parseOpen(o){let{attributes:a}=o;this.model={iconSet:a.iconSet,iconId:s.toIntValue(a.iconId)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],75:[function(r,n,i){const{v4:s}=r("uuid"),o=r("../../base-xform"),a=r("../../composite-xform"),l=r("./databar-ext-xform"),c=r("./icon-set-ext-xform"),u={"3Triangles":!0,"3Stars":!0,"5Boxes":!0};class h extends a{constructor(){super(),this.map={"x14:dataBar":this.databarXform=new l,"x14:iconSet":this.iconSetXform=new c}}get tag(){return"x14:cfRule"}static isExt(f){return f.type==="dataBar"?l.isExt(f):!(f.type!=="iconSet"||!f.custom&&!u[f.iconSet])}prepare(f){h.isExt(f)&&(f.x14Id=`{${s()}}`.toUpperCase())}render(f,m){if(h.isExt(m))switch(m.type){case"dataBar":this.renderDataBar(f,m);break;case"iconSet":this.renderIconSet(f,m)}}renderDataBar(f,m){f.openNode(this.tag,{type:"dataBar",id:m.x14Id}),this.databarXform.render(f,m),f.closeNode()}renderIconSet(f,m){f.openNode(this.tag,{type:"iconSet",priority:m.priority,id:m.x14Id||`{${s()}}`}),this.iconSetXform.render(f,m),f.closeNode()}createNewModel(f){let{attributes:m}=f;return{type:m.type,x14Id:m.id,priority:o.toIntValue(m.priority)}}onParserClose(f,m){Object.assign(this.model,m.model)}}n.exports=h},{"../../base-xform":32,"../../composite-xform":48,"./databar-ext-xform":79,"./icon-set-ext-xform":81,uuid:528}],76:[function(r,n,i){const s=r("../../composite-xform"),o=r("./f-ext-xform");n.exports=class extends s{constructor(){super(),this.map={"xm:f":this.fExtXform=new o}}get tag(){return"x14:cfvo"}render(a,l){a.openNode(this.tag,{type:l.type}),l.value!==void 0&&this.fExtXform.render(a,l.value),a.closeNode()}createNewModel(a){return{type:a.attributes.type}}onParserClose(a,l){a==="xm:f"&&(this.model.value=l.model?parseFloat(l.model):0)}}},{"../../composite-xform":48,"./f-ext-xform":80}],77:[function(r,n,i){const s=r("../../composite-xform"),o=r("./sqref-ext-xform"),a=r("./cf-rule-ext-xform");n.exports=class extends s{constructor(){super(),this.map={"xm:sqref":this.sqRef=new o,"x14:cfRule":this.cfRule=new a}}get tag(){return"x14:conditionalFormatting"}prepare(l,c){l.rules.forEach(u=>{this.cfRule.prepare(u,c)})}render(l,c){c.rules.some(a.isExt)&&(l.openNode(this.tag,{"xmlns:xm":"http://schemas.microsoft.com/office/excel/2006/main"}),c.rules.filter(a.isExt).forEach(u=>this.cfRule.render(l,u)),this.sqRef.render(l,c.ref),l.closeNode())}createNewModel(){return{rules:[]}}onParserClose(l,c){switch(l){case"xm:sqref":this.model.ref=c.model;break;case"x14:cfRule":this.model.rules.push(c.model)}}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./sqref-ext-xform":82}],78:[function(r,n,i){const s=r("../../composite-xform"),o=r("./cf-rule-ext-xform"),a=r("./conditional-formatting-ext-xform");n.exports=class extends s{constructor(){super(),this.map={"x14:conditionalFormatting":this.cfXform=new a}}get tag(){return"x14:conditionalFormattings"}hasContent(l){return l.hasExtContent===void 0&&(l.hasExtContent=l.some(c=>c.rules.some(o.isExt))),l.hasExtContent}prepare(l,c){l.forEach(u=>{this.cfXform.prepare(u,c)})}render(l,c){this.hasContent(c)&&(l.openNode(this.tag),c.forEach(u=>this.cfXform.render(l,u)),l.closeNode())}createNewModel(){return[]}onParserClose(l,c){this.model.push(c.model)}}},{"../../composite-xform":48,"./cf-rule-ext-xform":75,"./conditional-formatting-ext-xform":77}],79:[function(r,n,i){const s=r("../../base-xform"),o=r("../../composite-xform"),a=r("../../style/color-xform"),l=r("./cfvo-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new l,"x14:borderColor":this.borderColorXform=new a("x14:borderColor"),"x14:negativeBorderColor":this.negativeBorderColorXform=new a("x14:negativeBorderColor"),"x14:negativeFillColor":this.negativeFillColorXform=new a("x14:negativeFillColor"),"x14:axisColor":this.axisColorXform=new a("x14:axisColor")}}static isExt(c){return!c.gradient}get tag(){return"x14:dataBar"}render(c,u){c.openNode(this.tag,{minLength:s.toIntAttribute(u.minLength,0,!0),maxLength:s.toIntAttribute(u.maxLength,100,!0),border:s.toBoolAttribute(u.border,!1),gradient:s.toBoolAttribute(u.gradient,!0),negativeBarColorSameAsPositive:s.toBoolAttribute(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:s.toBoolAttribute(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:s.toAttribute(u.axisPosition,"auto"),direction:s.toAttribute(u.direction,"leftToRight")}),u.cfvo.forEach(h=>{this.cfvoXform.render(c,h)}),this.borderColorXform.render(c,u.borderColor),this.negativeBorderColorXform.render(c,u.negativeBorderColor),this.negativeFillColorXform.render(c,u.negativeFillColor),this.axisColorXform.render(c,u.axisColor),c.closeNode()}createNewModel(c){let{attributes:u}=c;return{cfvo:[],minLength:s.toIntValue(u.minLength,0),maxLength:s.toIntValue(u.maxLength,100),border:s.toBoolValue(u.border,!1),gradient:s.toBoolValue(u.gradient,!0),negativeBarColorSameAsPositive:s.toBoolValue(u.negativeBarColorSameAsPositive,!0),negativeBarBorderColorSameAsPositive:s.toBoolValue(u.negativeBarBorderColorSameAsPositive,!0),axisPosition:s.toStringValue(u.axisPosition,"auto"),direction:s.toStringValue(u.direction,"leftToRight")}}onParserClose(c,u){const[,h]=c.split(":");h==="cfvo"?this.model.cfvo.push(u.model):this.model[h]=u.model}}},{"../../base-xform":32,"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-ext-xform":76}],80:[function(r,n,i){const s=r("../../base-xform");n.exports=class extends s{get tag(){return"xm:f"}render(o,a){o.leafNode(this.tag,null,a)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],81:[function(r,n,i){const s=r("../../base-xform"),o=r("../../composite-xform"),a=r("./cfvo-ext-xform"),l=r("./cf-icon-ext-xform");n.exports=class extends o{constructor(){super(),this.map={"x14:cfvo":this.cfvoXform=new a,"x14:cfIcon":this.cfIconXform=new l}}get tag(){return"x14:iconSet"}render(c,u){c.openNode(this.tag,{iconSet:s.toStringAttribute(u.iconSet),reverse:s.toBoolAttribute(u.reverse,!1),showValue:s.toBoolAttribute(u.showValue,!0),custom:s.toBoolAttribute(u.icons,!1)}),u.cfvo.forEach(h=>{this.cfvoXform.render(c,h)}),u.icons&&u.icons.forEach((h,d)=>{h.iconId=d,this.cfIconXform.render(c,h)}),c.closeNode()}createNewModel(c){let{attributes:u}=c;return{cfvo:[],iconSet:s.toStringValue(u.iconSet,"3TrafficLights"),reverse:s.toBoolValue(u.reverse,!1),showValue:s.toBoolValue(u.showValue,!0)}}onParserClose(c,u){const[,h]=c.split(":");switch(h){case"cfvo":this.model.cfvo.push(u.model);break;case"cfIcon":this.model.icons||(this.model.icons=[]),this.model.icons.push(u.model);break;default:this.model[h]=u.model}}}},{"../../base-xform":32,"../../composite-xform":48,"./cf-icon-ext-xform":74,"./cfvo-ext-xform":76}],82:[function(r,n,i){const s=r("../../base-xform");n.exports=class extends s{get tag(){return"xm:sqref"}render(o,a){o.leafNode(this.tag,null,a)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],83:[function(r,n,i){const s=r("../../base-xform"),o=r("../../composite-xform"),a=r("../../../../doc/range"),l=r("./databar-xform"),c=r("./ext-lst-ref-xform"),u=r("./formula-xform"),h=r("./color-scale-xform"),d=r("./icon-set-xform"),f={"3Triangles":!0,"3Stars":!0,"5Boxes":!0},m=g=>{const{type:w,operator:y}=g;switch(w){case"containsText":case"containsBlanks":case"notContainsBlanks":case"containsErrors":case"notContainsErrors":return{type:"containsText",operator:w};default:return{type:w,operator:y}}};class v extends o{constructor(){super(),this.map={dataBar:this.databarXform=new l,extLst:this.extLstRefXform=new c,formula:this.formulaXform=new u,colorScale:this.colorScaleXform=new h,iconSet:this.iconSetXform=new d}}get tag(){return"cfRule"}static isPrimitive(w){return w.type!=="iconSet"||!w.custom&&!f[w.iconSet]}render(w,y){switch(y.type){case"expression":this.renderExpression(w,y);break;case"cellIs":this.renderCellIs(w,y);break;case"top10":this.renderTop10(w,y);break;case"aboveAverage":this.renderAboveAverage(w,y);break;case"dataBar":this.renderDataBar(w,y);break;case"colorScale":this.renderColorScale(w,y);break;case"iconSet":this.renderIconSet(w,y);break;case"containsText":this.renderText(w,y);break;case"timePeriod":this.renderTimePeriod(w,y)}}renderExpression(w,y){w.openNode(this.tag,{type:"expression",dxfId:y.dxfId,priority:y.priority}),this.formulaXform.render(w,y.formulae[0]),w.closeNode()}renderCellIs(w,y){w.openNode(this.tag,{type:"cellIs",dxfId:y.dxfId,priority:y.priority,operator:y.operator}),y.formulae.forEach(C=>{this.formulaXform.render(w,C)}),w.closeNode()}renderTop10(w,y){w.leafNode(this.tag,{type:"top10",dxfId:y.dxfId,priority:y.priority,percent:s.toBoolAttribute(y.percent,!1),bottom:s.toBoolAttribute(y.bottom,!1),rank:s.toIntValue(y.rank,10,!0)})}renderAboveAverage(w,y){w.leafNode(this.tag,{type:"aboveAverage",dxfId:y.dxfId,priority:y.priority,aboveAverage:s.toBoolAttribute(y.aboveAverage,!0)})}renderDataBar(w,y){w.openNode(this.tag,{type:"dataBar",priority:y.priority}),this.databarXform.render(w,y),this.extLstRefXform.render(w,y),w.closeNode()}renderColorScale(w,y){w.openNode(this.tag,{type:"colorScale",priority:y.priority}),this.colorScaleXform.render(w,y),w.closeNode()}renderIconSet(w,y){v.isPrimitive(y)&&(w.openNode(this.tag,{type:"iconSet",priority:y.priority}),this.iconSetXform.render(w,y),w.closeNode())}renderText(w,y){w.openNode(this.tag,{type:y.operator,dxfId:y.dxfId,priority:y.priority,operator:s.toStringAttribute(y.operator,"containsText")});const C=(k=>{if(k.formulae&&k.formulae[0])return k.formulae[0];const F=new a(k.ref),{tl:I}=F;switch(k.operator){case"containsText":return`NOT(ISERROR(SEARCH("${k.text}",${I})))`;case"containsBlanks":return`LEN(TRIM(${I}))=0`;case"notContainsBlanks":return`LEN(TRIM(${I}))>0`;case"containsErrors":return`ISERROR(${I})`;case"notContainsErrors":return`NOT(ISERROR(${I}))`;default:return}})(y);C&&this.formulaXform.render(w,C),w.closeNode()}renderTimePeriod(w,y){w.openNode(this.tag,{type:"timePeriod",dxfId:y.dxfId,priority:y.priority,timePeriod:y.timePeriod});const C=(k=>{if(k.formulae&&k.formulae[0])return k.formulae[0];const F=new a(k.ref),{tl:I}=F;switch(k.timePeriod){case"thisWeek":return`AND(TODAY()-ROUNDDOWN(${I},0)<=WEEKDAY(TODAY())-1,ROUNDDOWN(${I},0)-TODAY()<=7-WEEKDAY(TODAY()))`;case"lastWeek":return`AND(TODAY()-ROUNDDOWN(${I},0)>=(WEEKDAY(TODAY())),TODAY()-ROUNDDOWN(${I},0)<(WEEKDAY(TODAY())+7))`;case"nextWeek":return`AND(ROUNDDOWN(${I},0)-TODAY()>(7-WEEKDAY(TODAY())),ROUNDDOWN(${I},0)-TODAY()<(15-WEEKDAY(TODAY())))`;case"yesterday":return`FLOOR(${I},1)=TODAY()-1`;case"today":return`FLOOR(${I},1)=TODAY()`;case"tomorrow":return`FLOOR(${I},1)=TODAY()+1`;case"last7Days":return`AND(TODAY()-FLOOR(${I},1)<=6,FLOOR(${I},1)<=TODAY())`;case"lastMonth":return`AND(MONTH(${I})=MONTH(EDATE(TODAY(),0-1)),YEAR(${I})=YEAR(EDATE(TODAY(),0-1)))`;case"thisMonth":return`AND(MONTH(${I})=MONTH(TODAY()),YEAR(${I})=YEAR(TODAY()))`;case"nextMonth":return`AND(MONTH(${I})=MONTH(EDATE(TODAY(),0+1)),YEAR(${I})=YEAR(EDATE(TODAY(),0+1)))`;default:return}})(y);C&&this.formulaXform.render(w,C),w.closeNode()}createNewModel(w){let{attributes:y}=w;return{...m(y),dxfId:s.toIntValue(y.dxfId),priority:s.toIntValue(y.priority),timePeriod:y.timePeriod,percent:s.toBoolValue(y.percent),bottom:s.toBoolValue(y.bottom),rank:s.toIntValue(y.rank),aboveAverage:s.toBoolValue(y.aboveAverage)}}onParserClose(w,y){switch(w){case"dataBar":case"extLst":case"colorScale":case"iconSet":Object.assign(this.model,y.model);break;case"formula":this.model.formulae=this.model.formulae||[],this.model.formulae.push(y.model)}}}n.exports=v},{"../../../../doc/range":10,"../../base-xform":32,"../../composite-xform":48,"./color-scale-xform":85,"./databar-xform":88,"./ext-lst-ref-xform":89,"./formula-xform":90,"./icon-set-xform":91}],84:[function(r,n,i){const s=r("../../base-xform");n.exports=class extends s{get tag(){return"cfvo"}render(o,a){o.leafNode(this.tag,{type:a.type,val:a.value})}parseOpen(o){this.model={type:o.attributes.type,value:s.toFloatValue(o.attributes.val)}}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],85:[function(r,n,i){const s=r("../../composite-xform"),o=r("../../style/color-xform"),a=r("./cfvo-xform");n.exports=class extends s{constructor(){super(),this.map={cfvo:this.cfvoXform=new a,color:this.colorXform=new o}}get tag(){return"colorScale"}render(l,c){l.openNode(this.tag),c.cfvo.forEach(u=>{this.cfvoXform.render(l,u)}),c.color.forEach(u=>{this.colorXform.render(l,u)}),l.closeNode()}createNewModel(l){return{cfvo:[],color:[]}}onParserClose(l,c){this.model[l].push(c.model)}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],86:[function(r,n,i){const s=r("../../composite-xform"),o=r("./cf-rule-xform");n.exports=class extends s{constructor(){super(),this.map={cfRule:new o}}get tag(){return"conditionalFormatting"}render(a,l){l.rules.some(o.isPrimitive)&&(a.openNode(this.tag,{sqref:l.ref}),l.rules.forEach(c=>{o.isPrimitive(c)&&(c.ref=l.ref,this.map.cfRule.render(a,c))}),a.closeNode())}createNewModel(a){let{attributes:l}=a;return{ref:l.sqref,rules:[]}}onParserClose(a,l){this.model.rules.push(l.model)}}},{"../../composite-xform":48,"./cf-rule-xform":83}],87:[function(r,n,i){const s=r("../../base-xform"),o=r("./conditional-formatting-xform");n.exports=class extends s{constructor(){super(),this.cfXform=new o}get tag(){return"conditionalFormatting"}reset(){this.model=[]}prepare(a,l){let c=a.reduce((u,h)=>Math.max(u,...h.rules.map(d=>d.priority||0)),1);a.forEach(u=>{u.rules.forEach(h=>{h.priority||(h.priority=c++),h.style&&(h.dxfId=l.styles.addDxfStyle(h.style))})})}render(a,l){l.forEach(c=>{this.cfXform.render(a,c)})}parseOpen(a){return this.parser?(this.parser.parseOpen(a),!0):a.name==="conditionalFormatting"?(this.parser=this.cfXform,this.parser.parseOpen(a),!0):!1}parseText(a){this.parser&&this.parser.parseText(a)}parseClose(a){return!!this.parser&&(!!this.parser.parseClose(a)||(this.model.push(this.parser.model),this.parser=void 0,!1))}reconcile(a,l){a.forEach(c=>{c.rules.forEach(u=>{u.dxfId!==void 0&&(u.style=l.styles.getDxfStyle(u.dxfId),delete u.dxfId)})})}}},{"../../base-xform":32,"./conditional-formatting-xform":86}],88:[function(r,n,i){const s=r("../../composite-xform"),o=r("../../style/color-xform"),a=r("./cfvo-xform");n.exports=class extends s{constructor(){super(),this.map={cfvo:this.cfvoXform=new a,color:this.colorXform=new o}}get tag(){return"dataBar"}render(l,c){l.openNode(this.tag),c.cfvo.forEach(u=>{this.cfvoXform.render(l,u)}),this.colorXform.render(l,c.color),l.closeNode()}createNewModel(){return{cfvo:[]}}onParserClose(l,c){switch(l){case"cfvo":this.model.cfvo.push(c.model);break;case"color":this.model.color=c.model}}}},{"../../composite-xform":48,"../../style/color-xform":128,"./cfvo-xform":84}],89:[function(r,n,i){const s=r("../../base-xform"),o=r("../../composite-xform");class a extends s{get tag(){return"x14:id"}render(u,h){u.leafNode(this.tag,null,h)}parseOpen(){this.model=""}parseText(u){this.model+=u}parseClose(u){return u!==this.tag}}class l extends o{constructor(){super(),this.map={"x14:id":this.idXform=new a}}get tag(){return"ext"}render(u,h){u.openNode(this.tag,{uri:"{B025F937-C7B1-47D3-B67F-A62EFF666E3E}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.idXform.render(u,h.x14Id),u.closeNode()}createNewModel(){return{}}onParserClose(u,h){this.model.x14Id=h.model}}n.exports=class extends o{constructor(){super(),this.map={ext:new l}}get tag(){return"extLst"}render(c,u){c.openNode(this.tag),this.map.ext.render(c,u),c.closeNode()}createNewModel(){return{}}onParserClose(c,u){Object.assign(this.model,u.model)}}},{"../../base-xform":32,"../../composite-xform":48}],90:[function(r,n,i){const s=r("../../base-xform");n.exports=class extends s{get tag(){return"formula"}render(o,a){o.leafNode(this.tag,null,a)}parseOpen(){this.model=""}parseText(o){this.model+=o}parseClose(o){return o!==this.tag}}},{"../../base-xform":32}],91:[function(r,n,i){const s=r("../../base-xform"),o=r("../../composite-xform"),a=r("./cfvo-xform");n.exports=class extends o{constructor(){super(),this.map={cfvo:this.cfvoXform=new a}}get tag(){return"iconSet"}render(l,c){l.openNode(this.tag,{iconSet:s.toStringAttribute(c.iconSet,"3TrafficLights"),reverse:s.toBoolAttribute(c.reverse,!1),showValue:s.toBoolAttribute(c.showValue,!0)}),c.cfvo.forEach(u=>{this.cfvoXform.render(l,u)}),l.closeNode()}createNewModel(l){let{attributes:c}=l;return{iconSet:s.toStringValue(c.iconSet,"3TrafficLights"),reverse:s.toBoolValue(c.reverse),showValue:s.toBoolValue(c.showValue),cfvo:[]}}onParserClose(l,c){this.model[l].push(c.model)}}},{"../../base-xform":32,"../../composite-xform":48,"./cfvo-xform":84}],92:[function(r,n,i){const s=r("../../../utils/utils"),o=r("../base-xform");n.exports=class extends o{get tag(){return"col"}prepare(a,l){const c=l.styles.addStyleModel(a.style||{});c&&(a.styleId=c)}render(a,l){a.openNode("col"),a.addAttribute("min",l.min),a.addAttribute("max",l.max),l.width&&a.addAttribute("width",l.width),l.styleId&&a.addAttribute("style",l.styleId),l.hidden&&a.addAttribute("hidden","1"),l.bestFit&&a.addAttribute("bestFit","1"),l.outlineLevel&&a.addAttribute("outlineLevel",l.outlineLevel),l.collapsed&&a.addAttribute("collapsed","1"),a.addAttribute("customWidth","1"),a.closeNode()}parseOpen(a){if(a.name==="col"){const l=this.model={min:parseInt(a.attributes.min||"0",10),max:parseInt(a.attributes.max||"0",10),width:a.attributes.width===void 0?void 0:parseFloat(a.attributes.width||"0")};return a.attributes.style&&(l.styleId=parseInt(a.attributes.style,10)),s.parseBoolean(a.attributes.hidden)&&(l.hidden=!0),s.parseBoolean(a.attributes.bestFit)&&(l.bestFit=!0),a.attributes.outlineLevel&&(l.outlineLevel=parseInt(a.attributes.outlineLevel,10)),s.parseBoolean(a.attributes.collapsed)&&(l.collapsed=!0),!0}return!1}parseText(){}parseClose(){return!1}reconcile(a,l){a.styleId&&(a.style=l.styles.getStyleModel(a.styleId))}}},{"../../../utils/utils":27,"../base-xform":32}],93:[function(r,n,i){const s=r("../../../utils/under-dash"),o=r("../../../utils/utils"),a=r("../../../utils/col-cache"),l=r("../base-xform"),c=r("../../../doc/range");function u(d,f,m,v){const g=f[m];g!==void 0?d[m]=g:v!==void 0&&(d[m]=v)}function h(d,f,m,v){const g=f[m];g!==void 0&&(d[m]=o.parseBoolean(g))}n.exports=class extends l{get tag(){return"dataValidations"}render(d,f){const m=(function(v){const g=s.map(v,(C,k)=>({address:k,dataValidation:C,marked:!1})).sort((C,k)=>s.strcmp(C.address,k.address)),w=s.keyBy(g,"address"),y=(C,k,F)=>{for(let I=0;I<k;I++){const N=a.encodeAddress(C.row+I,F);if(!v[N]||!s.isEqual(v[C.address],v[N]))return!1}return!0};return g.map(C=>{if(!C.marked){const k=a.decodeEx(C.address);if(k.dimensions)return w[k.dimensions].marked=!0,{...C.dataValidation,sqref:C.address};let F=1,I=a.encodeAddress(k.row+F,k.col);for(;v[I]&&s.isEqual(C.dataValidation,v[I]);)F++,I=a.encodeAddress(k.row+F,k.col);let N=1;for(;y(k,F,k.col+N);)N++;for(let j=0;j<F;j++)for(let L=0;L<N;L++)I=a.encodeAddress(k.row+j,k.col+L),w[I].marked=!0;if(F>1||N>1){const j=k.row+(F-1),L=k.col+(N-1);return{...C.dataValidation,sqref:`${C.address}:${a.encodeAddress(j,L)}`}}return{...C.dataValidation,sqref:C.address}}return null}).filter(Boolean)})(f);m.length&&(d.openNode("dataValidations",{count:m.length}),m.forEach(v=>{d.openNode("dataValidation"),v.type!=="any"&&(d.addAttribute("type",v.type),v.operator&&v.type!=="list"&&v.operator!=="between"&&d.addAttribute("operator",v.operator),v.allowBlank&&d.addAttribute("allowBlank","1")),v.showInputMessage&&d.addAttribute("showInputMessage","1"),v.promptTitle&&d.addAttribute("promptTitle",v.promptTitle),v.prompt&&d.addAttribute("prompt",v.prompt),v.showErrorMessage&&d.addAttribute("showErrorMessage","1"),v.errorStyle&&d.addAttribute("errorStyle",v.errorStyle),v.errorTitle&&d.addAttribute("errorTitle",v.errorTitle),v.error&&d.addAttribute("error",v.error),d.addAttribute("sqref",v.sqref),(v.formulae||[]).forEach((g,w)=>{d.openNode("formula"+(w+1)),v.type==="date"?d.writeText(o.dateToExcel(new Date(g))):d.writeText(g),d.closeNode()}),d.closeNode()}),d.closeNode())}parseOpen(d){switch(d.name){case"dataValidations":return this.model={},!0;case"dataValidation":{this._address=d.attributes.sqref;const f={type:d.attributes.type||"any",formulae:[]};switch(d.attributes.type&&h(f,d.attributes,"allowBlank"),h(f,d.attributes,"showInputMessage"),h(f,d.attributes,"showErrorMessage"),f.type){case"any":case"list":case"custom":break;default:u(f,d.attributes,"operator","between")}return u(f,d.attributes,"promptTitle"),u(f,d.attributes,"prompt"),u(f,d.attributes,"errorStyle"),u(f,d.attributes,"errorTitle"),u(f,d.attributes,"error"),this._dataValidation=f,!0}case"formula1":case"formula2":return this._formula=[],!0;default:return!1}}parseText(d){this._formula&&this._formula.push(d)}parseClose(d){switch(d){case"dataValidations":return!1;case"dataValidation":return this._dataValidation.formulae&&this._dataValidation.formulae.length||(delete this._dataValidation.formulae,delete this._dataValidation.operator),(this._address.split(/\s+/g)||[]).forEach(f=>{f.includes(":")?new c(f).forEachAddress(m=>{this.model[m]=this._dataValidation}):this.model[f]=this._dataValidation}),!0;case"formula1":case"formula2":{let f=this._formula.join("");switch(this._dataValidation.type){case"whole":case"textLength":f=parseInt(f,10);break;case"decimal":f=parseFloat(f);break;case"date":f=o.excelToDate(parseFloat(f))}return this._dataValidation.formulae.push(f),this._formula=void 0,!0}default:return!0}}}},{"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/utils":27,"../base-xform":32}],94:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"dimension"}render(o,a){a&&o.leafNode("dimension",{ref:a})}parseOpen(o){return o.name==="dimension"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],95:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"drawing"}render(o,a){a&&o.leafNode(this.tag,{"r:id":a.rId})}parseOpen(o){return o.name===this.tag?(this.model={rId:o.attributes["r:id"]},!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],96:[function(r,n,i){const s=r("../composite-xform"),o=r("./cf-ext/conditional-formattings-ext-xform");class a extends s{constructor(){super(),this.map={"x14:conditionalFormattings":this.conditionalFormattings=new o}}get tag(){return"ext"}hasContent(c){return this.conditionalFormattings.hasContent(c.conditionalFormattings)}prepare(c,u){this.conditionalFormattings.prepare(c.conditionalFormattings,u)}render(c,u){c.openNode("ext",{uri:"{78C0D931-6437-407d-A8EE-F0AAD7539E65}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"}),this.conditionalFormattings.render(c,u.conditionalFormattings),c.closeNode()}createNewModel(){return{}}onParserClose(c,u){this.model[c]=u.model}}n.exports=class extends s{constructor(){super(),this.map={ext:this.ext=new a}}get tag(){return"extLst"}prepare(l,c){this.ext.prepare(l,c)}hasContent(l){return this.ext.hasContent(l)}render(l,c){this.hasContent(c)&&(l.openNode("extLst"),this.ext.render(l,c),l.closeNode())}createNewModel(){return{}}onParserClose(l,c){Object.assign(this.model,c.model)}}},{"../composite-xform":48,"./cf-ext/conditional-formattings-ext-xform":78}],97:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"headerFooter"}render(o,a){if(a){o.addRollback();let l=!1;o.openNode("headerFooter"),a.differentFirst&&(o.addAttribute("differentFirst","1"),l=!0),a.differentOddEven&&(o.addAttribute("differentOddEven","1"),l=!0),a.oddHeader&&typeof a.oddHeader=="string"&&(o.leafNode("oddHeader",null,a.oddHeader),l=!0),a.oddFooter&&typeof a.oddFooter=="string"&&(o.leafNode("oddFooter",null,a.oddFooter),l=!0),a.evenHeader&&typeof a.evenHeader=="string"&&(o.leafNode("evenHeader",null,a.evenHeader),l=!0),a.evenFooter&&typeof a.evenFooter=="string"&&(o.leafNode("evenFooter",null,a.evenFooter),l=!0),a.firstHeader&&typeof a.firstHeader=="string"&&(o.leafNode("firstHeader",null,a.firstHeader),l=!0),a.firstFooter&&typeof a.firstFooter=="string"&&(o.leafNode("firstFooter",null,a.firstFooter),l=!0),l?(o.closeNode(),o.commit()):o.rollback()}}parseOpen(o){switch(o.name){case"headerFooter":return this.model={},o.attributes.differentFirst&&(this.model.differentFirst=parseInt(o.attributes.differentFirst,0)===1),o.attributes.differentOddEven&&(this.model.differentOddEven=parseInt(o.attributes.differentOddEven,0)===1),!0;case"oddHeader":return this.currentNode="oddHeader",!0;case"oddFooter":return this.currentNode="oddFooter",!0;case"evenHeader":return this.currentNode="evenHeader",!0;case"evenFooter":return this.currentNode="evenFooter",!0;case"firstHeader":return this.currentNode="firstHeader",!0;case"firstFooter":return this.currentNode="firstFooter",!0;default:return!1}}parseText(o){switch(this.currentNode){case"oddHeader":this.model.oddHeader=o;break;case"oddFooter":this.model.oddFooter=o;break;case"evenHeader":this.model.evenHeader=o;break;case"evenFooter":this.model.evenFooter=o;break;case"firstHeader":this.model.firstHeader=o;break;case"firstFooter":this.model.firstFooter=o}}parseClose(){switch(this.currentNode){case"oddHeader":case"oddFooter":case"evenHeader":case"evenFooter":case"firstHeader":case"firstFooter":return this.currentNode=void 0,!0;default:return!1}}}},{"../base-xform":32}],98:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"hyperlink"}render(o,a){this.isInternalLink(a)?o.leafNode("hyperlink",{ref:a.address,"r:id":a.rId,tooltip:a.tooltip,location:a.target}):o.leafNode("hyperlink",{ref:a.address,"r:id":a.rId,tooltip:a.tooltip})}parseOpen(o){return o.name==="hyperlink"&&(this.model={address:o.attributes.ref,rId:o.attributes["r:id"],tooltip:o.attributes.tooltip},o.attributes.location&&(this.model.target=o.attributes.location),!0)}parseText(){}parseClose(){return!1}isInternalLink(o){return o.target&&/^[^!]+![a-zA-Z]+[\d]+$/.test(o.target)}}},{"../base-xform":32}],99:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"mergeCell"}render(o,a){o.leafNode("mergeCell",{ref:a})}parseOpen(o){return o.name==="mergeCell"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],100:[function(r,n,i){const s=r("../../../utils/under-dash"),o=r("../../../doc/range"),a=r("../../../utils/col-cache"),l=r("../../../doc/enums");n.exports=class{constructor(){this.merges={}}add(c){if(this.merges[c.master])this.merges[c.master].expandToAddress(c.address);else{const u=`${c.master}:${c.address}`;this.merges[c.master]=new o(u)}}get mergeCells(){return s.map(this.merges,c=>c.range)}reconcile(c,u){s.each(c,h=>{const d=a.decode(h);for(let f=d.top;f<=d.bottom;f++){const m=u[f-1];for(let v=d.left;v<=d.right;v++){const g=m.cells[v-1];g?g.type===l.ValueType.Merge&&(g.master=d.tl):m.cells[v]={type:l.ValueType.Null,address:a.encodeAddress(f,v)}}}})}getMasterAddress(c){const u=this.hash[c];return u&&u.tl}}},{"../../../doc/enums":7,"../../../doc/range":10,"../../../utils/col-cache":19,"../../../utils/under-dash":26}],101:[function(r,n,i){const s=r("../base-xform"),o=a=>a!==void 0;n.exports=class extends s{get tag(){return"outlinePr"}render(a,l){return!(!l||!o(l.summaryBelow)&&!o(l.summaryRight))&&(a.leafNode(this.tag,{summaryBelow:o(l.summaryBelow)?Number(l.summaryBelow):void 0,summaryRight:o(l.summaryRight)?Number(l.summaryRight):void 0}),!0)}parseOpen(a){return a.name===this.tag&&(this.model={summaryBelow:o(a.attributes.summaryBelow)?!!Number(a.attributes.summaryBelow):void 0,summaryRight:o(a.attributes.summaryRight)?!!Number(a.attributes.summaryRight):void 0},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],102:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"brk"}render(o,a){o.leafNode("brk",a)}parseOpen(o){return o.name==="brk"&&(this.model=o.attributes.ref,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],103:[function(r,n,i){const s=r("../../../utils/under-dash"),o=r("../base-xform");n.exports=class extends o{get tag(){return"pageMargins"}render(a,l){if(l){const c={left:l.left,right:l.right,top:l.top,bottom:l.bottom,header:l.header,footer:l.footer};s.some(c,u=>u!==void 0)&&a.leafNode(this.tag,c)}}parseOpen(a){return a.name===this.tag?(this.model={left:parseFloat(a.attributes.left||.7),right:parseFloat(a.attributes.right||.7),top:parseFloat(a.attributes.top||.75),bottom:parseFloat(a.attributes.bottom||.75),header:parseFloat(a.attributes.header||.3),footer:parseFloat(a.attributes.footer||.3)},!0):!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],104:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"pageSetUpPr"}render(o,a){return!(!a||!a.fitToPage)&&(o.leafNode(this.tag,{fitToPage:a.fitToPage?"1":void 0}),!0)}parseOpen(o){return o.name===this.tag&&(this.model={fitToPage:o.attributes.fitToPage==="1"},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],105:[function(r,n,i){const s=r("../../../utils/under-dash"),o=r("../base-xform");function a(h){return h?"1":void 0}function l(h){if(h==="overThenDown")return h}function c(h){switch(h){case"atEnd":case"asDisplyed":return h;default:return}}function u(h){switch(h){case"dash":case"blank":case"NA":return h;default:return}}n.exports=class extends o{get tag(){return"pageSetup"}render(h,d){if(d){const f={paperSize:d.paperSize,orientation:d.orientation,horizontalDpi:d.horizontalDpi,verticalDpi:d.verticalDpi,pageOrder:l(d.pageOrder),blackAndWhite:a(d.blackAndWhite),draft:a(d.draft),cellComments:c(d.cellComments),errors:u(d.errors),scale:d.scale,fitToWidth:d.fitToWidth,fitToHeight:d.fitToHeight,firstPageNumber:d.firstPageNumber,useFirstPageNumber:a(d.firstPageNumber),usePrinterDefaults:a(d.usePrinterDefaults),copies:d.copies};s.some(f,m=>m!==void 0)&&h.leafNode(this.tag,f)}}parseOpen(h){if(h.name===this.tag)return this.model={paperSize:(d=h.attributes.paperSize,d!==void 0?parseInt(d,10):void 0),orientation:h.attributes.orientation||"portrait",horizontalDpi:parseInt(h.attributes.horizontalDpi||"4294967295",10),verticalDpi:parseInt(h.attributes.verticalDpi||"4294967295",10),pageOrder:h.attributes.pageOrder||"downThenOver",blackAndWhite:h.attributes.blackAndWhite==="1",draft:h.attributes.draft==="1",cellComments:h.attributes.cellComments||"None",errors:h.attributes.errors||"displayed",scale:parseInt(h.attributes.scale||"100",10),fitToWidth:parseInt(h.attributes.fitToWidth||"1",10),fitToHeight:parseInt(h.attributes.fitToHeight||"1",10),firstPageNumber:parseInt(h.attributes.firstPageNumber||"1",10),useFirstPageNumber:h.attributes.useFirstPageNumber==="1",usePrinterDefaults:h.attributes.usePrinterDefaults==="1",copies:parseInt(h.attributes.copies||"1",10)},!0;return!1;var d}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],106:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"picture"}render(o,a){a&&o.leafNode(this.tag,{"r:id":a.rId})}parseOpen(o){return o.name===this.tag?(this.model={rId:o.attributes["r:id"]},!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],107:[function(r,n,i){const s=r("../../../utils/under-dash"),o=r("../base-xform");function a(l){return l?"1":void 0}n.exports=class extends o{get tag(){return"printOptions"}render(l,c){if(c){const u={headings:a(c.showRowColHeaders),gridLines:a(c.showGridLines),horizontalCentered:a(c.horizontalCentered),verticalCentered:a(c.verticalCentered)};s.some(u,h=>h!==void 0)&&l.leafNode(this.tag,u)}}parseOpen(l){return l.name===this.tag?(this.model={showRowColHeaders:l.attributes.headings==="1",showGridLines:l.attributes.gridLines==="1",horizontalCentered:l.attributes.horizontalCentered==="1",verticalCentered:l.attributes.verticalCentered==="1"},!0):!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],108:[function(r,n,i){const s=r("./page-breaks-xform"),o=r("../list-xform");n.exports=class extends o{constructor(){super({tag:"rowBreaks",count:!0,childXform:new s})}render(a,l){if(l&&l.length){a.openNode(this.tag,this.$),this.count&&(a.addAttribute(this.$count,l.length),a.addAttribute("manualBreakCount",l.length));const{childXform:c}=this;l.forEach(u=>{c.render(a,u)}),a.closeNode()}else this.empty&&a.leafNode(this.tag)}}},{"../list-xform":71,"./page-breaks-xform":102}],109:[function(r,n,i){const s=r("../base-xform"),o=r("../../../utils/utils"),a=r("./cell-xform");n.exports=class extends s{constructor(l){super(),this.maxItems=l&&l.maxItems,this.map={c:new a}}get tag(){return"row"}prepare(l,c){const u=c.styles.addStyleModel(l.style);u&&(l.styleId=u);const h=this.map.c;l.cells.forEach(d=>{h.prepare(d,c)})}render(l,c,u){l.openNode("row"),l.addAttribute("r",c.number),c.height&&(l.addAttribute("ht",c.height),l.addAttribute("customHeight","1")),c.hidden&&l.addAttribute("hidden","1"),c.min>0&&c.max>0&&c.min<=c.max&&l.addAttribute("spans",`${c.min}:${c.max}`),c.styleId&&(l.addAttribute("s",c.styleId),l.addAttribute("customFormat","1")),l.addAttribute("x14ac:dyDescent","0.25"),c.outlineLevel&&l.addAttribute("outlineLevel",c.outlineLevel),c.collapsed&&l.addAttribute("collapsed","1");const h=this.map.c;c.cells.forEach(d=>{h.render(l,d,u)}),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;if(l.name==="row"){this.numRowsSeen+=1;const c=l.attributes.spans?l.attributes.spans.split(":").map(h=>parseInt(h,10)):[void 0,void 0],u=this.model={number:parseInt(l.attributes.r,10),min:c[0],max:c[1],cells:[]};return l.attributes.s&&(u.styleId=parseInt(l.attributes.s,10)),o.parseBoolean(l.attributes.hidden)&&(u.hidden=!0),o.parseBoolean(l.attributes.bestFit)&&(u.bestFit=!0),l.attributes.ht&&(u.height=parseFloat(l.attributes.ht)),l.attributes.outlineLevel&&(u.outlineLevel=parseInt(l.attributes.outlineLevel,10)),o.parseBoolean(l.attributes.collapsed)&&(u.collapsed=!0),!0}return this.parser=this.map[l.name],!!this.parser&&(this.parser.parseOpen(l),!0)}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){if(this.model.cells.push(this.parser.model),this.maxItems&&this.model.cells.length>this.maxItems)throw new Error(`Max column count (${this.maxItems}) exceeded`);this.parser=void 0}return!0}return!1}reconcile(l,c){l.style=l.styleId?c.styles.getStyleModel(l.styleId):{},l.styleId!==void 0&&(l.styleId=void 0);const u=this.map.c;l.cells.forEach(h=>{u.reconcile(h,c)})}}},{"../../../utils/utils":27,"../base-xform":32,"./cell-xform":73}],110:[function(r,n,i){const s=r("../../../utils/under-dash"),o=r("../base-xform");n.exports=class extends o{get tag(){return"sheetFormatPr"}render(a,l){if(l){const c={defaultRowHeight:l.defaultRowHeight,outlineLevelRow:l.outlineLevelRow,outlineLevelCol:l.outlineLevelCol,"x14ac:dyDescent":l.dyDescent};l.defaultColWidth&&(c.defaultColWidth=l.defaultColWidth),l.defaultRowHeight&&l.defaultRowHeight===15||(c.customHeight="1"),s.some(c,u=>u!==void 0)&&a.leafNode("sheetFormatPr",c)}}parseOpen(a){return a.name==="sheetFormatPr"&&(this.model={defaultRowHeight:parseFloat(a.attributes.defaultRowHeight||"0"),dyDescent:parseFloat(a.attributes["x14ac:dyDescent"]||"0"),outlineLevelRow:parseInt(a.attributes.outlineLevelRow||"0",10),outlineLevelCol:parseInt(a.attributes.outlineLevelCol||"0",10)},a.attributes.defaultColWidth&&(this.model.defaultColWidth=parseFloat(a.attributes.defaultColWidth)),!0)}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],111:[function(r,n,i){const s=r("../base-xform"),o=r("../style/color-xform"),a=r("./page-setup-properties-xform"),l=r("./outline-properties-xform");n.exports=class extends s{constructor(){super(),this.map={tabColor:new o("tabColor"),pageSetUpPr:new a,outlinePr:new l}}get tag(){return"sheetPr"}render(c,u){if(u){c.addRollback(),c.openNode("sheetPr");let h=!1;h=this.map.tabColor.render(c,u.tabColor)||h,h=this.map.pageSetUpPr.render(c,u.pageSetup)||h,h=this.map.outlinePr.render(c,u.outlineProperties)||h,h?(c.closeNode(),c.commit()):c.rollback()}}parseOpen(c){return this.parser?(this.parser.parseOpen(c),!0):c.name===this.tag?(this.reset(),!0):!!this.map[c.name]&&(this.parser=this.map[c.name],this.parser.parseOpen(c),!0)}parseText(c){return!!this.parser&&(this.parser.parseText(c),!0)}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):(this.map.tabColor.model||this.map.pageSetUpPr.model||this.map.outlinePr.model?(this.model={},this.map.tabColor.model&&(this.model.tabColor=this.map.tabColor.model),this.map.pageSetUpPr.model&&(this.model.pageSetup=this.map.pageSetUpPr.model),this.map.outlinePr.model&&(this.model.outlineProperties=this.map.outlinePr.model)):this.model=null,!1)}}},{"../base-xform":32,"../style/color-xform":128,"./outline-properties-xform":101,"./page-setup-properties-xform":104}],112:[function(r,n,i){const s=r("../../../utils/under-dash"),o=r("../base-xform");function a(c,u){return c?u:void 0}function l(c,u){return c===u||void 0}n.exports=class extends o{get tag(){return"sheetProtection"}render(c,u){if(u){const h={sheet:a(u.sheet,"1"),selectLockedCells:u.selectLockedCells===!1?"1":void 0,selectUnlockedCells:u.selectUnlockedCells===!1?"1":void 0,formatCells:a(u.formatCells,"0"),formatColumns:a(u.formatColumns,"0"),formatRows:a(u.formatRows,"0"),insertColumns:a(u.insertColumns,"0"),insertRows:a(u.insertRows,"0"),insertHyperlinks:a(u.insertHyperlinks,"0"),deleteColumns:a(u.deleteColumns,"0"),deleteRows:a(u.deleteRows,"0"),sort:a(u.sort,"0"),autoFilter:a(u.autoFilter,"0"),pivotTables:a(u.pivotTables,"0")};u.sheet&&(h.algorithmName=u.algorithmName,h.hashValue=u.hashValue,h.saltValue=u.saltValue,h.spinCount=u.spinCount,h.objects=a(u.objects===!1,"1"),h.scenarios=a(u.scenarios===!1,"1")),s.some(h,d=>d!==void 0)&&c.leafNode(this.tag,h)}}parseOpen(c){return c.name===this.tag?(this.model={sheet:l(c.attributes.sheet,"1"),objects:c.attributes.objects!=="1"&&void 0,scenarios:c.attributes.scenarios!=="1"&&void 0,selectLockedCells:c.attributes.selectLockedCells!=="1"&&void 0,selectUnlockedCells:c.attributes.selectUnlockedCells!=="1"&&void 0,formatCells:l(c.attributes.formatCells,"0"),formatColumns:l(c.attributes.formatColumns,"0"),formatRows:l(c.attributes.formatRows,"0"),insertColumns:l(c.attributes.insertColumns,"0"),insertRows:l(c.attributes.insertRows,"0"),insertHyperlinks:l(c.attributes.insertHyperlinks,"0"),deleteColumns:l(c.attributes.deleteColumns,"0"),deleteRows:l(c.attributes.deleteRows,"0"),sort:l(c.attributes.sort,"0"),autoFilter:l(c.attributes.autoFilter,"0"),pivotTables:l(c.attributes.pivotTables,"0")},c.attributes.algorithmName&&(this.model.algorithmName=c.attributes.algorithmName,this.model.hashValue=c.attributes.hashValue,this.model.saltValue=c.attributes.saltValue,this.model.spinCount=parseInt(c.attributes.spinCount,10)),!0):!1}parseText(){}parseClose(){return!1}}},{"../../../utils/under-dash":26,"../base-xform":32}],113:[function(r,n,i){const s=r("../../../utils/col-cache"),o=r("../base-xform"),a={frozen:"frozen",frozenSplit:"frozen",split:"split"};n.exports=class extends o{get tag(){return"sheetView"}prepare(l){switch(l.state){case"frozen":case"split":break;default:l.state="normal"}}render(l,c){l.openNode("sheetView",{workbookViewId:c.workbookViewId||0});const u=function(v,g,w){w&&l.addAttribute(v,g)};let h,d,f,m;switch(u("rightToLeft","1",c.rightToLeft===!0),u("tabSelected","1",c.tabSelected),u("showRuler","0",c.showRuler===!1),u("showRowColHeaders","0",c.showRowColHeaders===!1),u("showGridLines","0",c.showGridLines===!1),u("zoomScale",c.zoomScale,c.zoomScale),u("zoomScaleNormal",c.zoomScaleNormal,c.zoomScaleNormal),u("view",c.style,c.style),c.state){case"frozen":d=c.xSplit||0,f=c.ySplit||0,h=c.topLeftCell||s.getAddress(f+1,d+1).address,m=(c.xSplit&&c.ySplit?"bottomRight":c.xSplit&&"topRight")||"bottomLeft",l.leafNode("pane",{xSplit:c.xSplit||void 0,ySplit:c.ySplit||void 0,topLeftCell:h,activePane:m,state:"frozen"}),l.leafNode("selection",{pane:m,activeCell:c.activeCell,sqref:c.activeCell});break;case"split":c.activePane==="topLeft"&&(c.activePane=void 0),l.leafNode("pane",{xSplit:c.xSplit||void 0,ySplit:c.ySplit||void 0,topLeftCell:c.topLeftCell,activePane:c.activePane}),l.leafNode("selection",{pane:c.activePane,activeCell:c.activeCell,sqref:c.activeCell});break;case"normal":c.activeCell&&l.leafNode("selection",{activeCell:c.activeCell,sqref:c.activeCell})}l.closeNode()}parseOpen(l){switch(l.name){case"sheetView":return this.sheetView={workbookViewId:parseInt(l.attributes.workbookViewId,10),rightToLeft:l.attributes.rightToLeft==="1",tabSelected:l.attributes.tabSelected==="1",showRuler:l.attributes.showRuler!=="0",showRowColHeaders:l.attributes.showRowColHeaders!=="0",showGridLines:l.attributes.showGridLines!=="0",zoomScale:parseInt(l.attributes.zoomScale||"100",10),zoomScaleNormal:parseInt(l.attributes.zoomScaleNormal||"100",10),style:l.attributes.view},this.pane=void 0,this.selections={},!0;case"pane":return this.pane={xSplit:parseInt(l.attributes.xSplit||"0",10),ySplit:parseInt(l.attributes.ySplit||"0",10),topLeftCell:l.attributes.topLeftCell,activePane:l.attributes.activePane||"topLeft",state:l.attributes.state},!0;case"selection":{const c=l.attributes.pane||"topLeft";return this.selections[c]={pane:c,activeCell:l.attributes.activeCell},!0}default:return!1}}parseText(){}parseClose(l){let c,u;return l==="sheetView"?(this.sheetView&&this.pane?(c=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:a[this.pane.state]||"split",xSplit:this.pane.xSplit,ySplit:this.pane.ySplit,topLeftCell:this.pane.topLeftCell,showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},this.model.state==="split"&&(c.activePane=this.pane.activePane),u=this.selections[this.pane.activePane],u&&u.activeCell&&(c.activeCell=u.activeCell),this.sheetView.style&&(c.style=this.sheetView.style)):(c=this.model={workbookViewId:this.sheetView.workbookViewId,rightToLeft:this.sheetView.rightToLeft,state:"normal",showRuler:this.sheetView.showRuler,showRowColHeaders:this.sheetView.showRowColHeaders,showGridLines:this.sheetView.showGridLines,zoomScale:this.sheetView.zoomScale,zoomScaleNormal:this.sheetView.zoomScaleNormal},u=this.selections.topLeft,u&&u.activeCell&&(c.activeCell=u.activeCell),this.sheetView.style&&(c.style=this.sheetView.style)),!1):!0}reconcile(){}}},{"../../../utils/col-cache":19,"../base-xform":32}],114:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"tablePart"}render(o,a){a&&o.leafNode(this.tag,{"r:id":a.rId})}parseOpen(o){return o.name===this.tag?(this.model={rId:o.attributes["r:id"]},!0):!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],115:[function(r,n,i){const s=r("../../../utils/under-dash"),o=r("../../../utils/col-cache"),a=r("../../../utils/xml-stream"),l=r("../../rel-type"),c=r("./merges"),u=r("../base-xform"),h=r("../list-xform"),d=r("./row-xform"),f=r("./col-xform"),m=r("./dimension-xform"),v=r("./hyperlink-xform"),g=r("./merge-cell-xform"),w=r("./data-validations-xform"),y=r("./sheet-properties-xform"),C=r("./sheet-format-properties-xform"),k=r("./sheet-view-xform"),F=r("./sheet-protection-xform"),I=r("./page-margins-xform"),N=r("./page-setup-xform"),j=r("./print-options-xform"),L=r("./auto-filter-xform"),W=r("./picture-xform"),K=r("./drawing-xform"),z=r("./table-part-xform"),M=r("./row-breaks-xform"),B=r("./header-footer-xform"),R=r("./cf/conditional-formattings-xform"),S=r("./ext-lst-xform"),_=(E,D)=>{if(!D||!D.length)return E;if(!E||!E.length)return D;const O={},P={};return E.forEach(q=>{O[q.ref]=q,q.rules.forEach(X=>{const{x14Id:Q}=X;Q&&(P[Q]=X)})}),D.forEach(q=>{q.rules.forEach(X=>{const Q=P[X.x14Id];Q?((G,ee)=>{Object.keys(ee).forEach(V=>{const H=G[V],Z=ee[V];H===void 0&&Z!==void 0&&(G[V]=Z)})})(Q,X):O[q.ref]?O[q.ref].rules.push(X):E.push({ref:q.ref,rules:[X]})})}),E};class T extends u{constructor(D){super();const{maxRows:O,maxCols:P,ignoreNodes:q}=D||{};this.ignoreNodes=q||[],this.map={sheetPr:new y,dimension:new m,sheetViews:new h({tag:"sheetViews",count:!1,childXform:new k}),sheetFormatPr:new C,cols:new h({tag:"cols",count:!1,childXform:new f}),sheetData:new h({tag:"sheetData",count:!1,empty:!0,childXform:new d({maxItems:P}),maxItems:O}),autoFilter:new L,mergeCells:new h({tag:"mergeCells",count:!0,childXform:new g}),rowBreaks:new M,hyperlinks:new h({tag:"hyperlinks",count:!1,childXform:new v}),pageMargins:new I,dataValidations:new w,pageSetup:new N,headerFooter:new B,printOptions:new j,picture:new W,drawing:new K,sheetProtection:new F,tableParts:new h({tag:"tableParts",count:!0,childXform:new z}),conditionalFormatting:new R,extLst:new S}}prepare(D,O){O.merges=new c,D.hyperlinks=O.hyperlinks=[],D.comments=O.comments=[],O.formulae={},O.siFormulae=0,this.map.cols.prepare(D.cols,O),this.map.sheetData.prepare(D.rows,O),this.map.conditionalFormatting.prepare(D.conditionalFormattings,O),D.mergeCells=O.merges.mergeCells;const P=D.rels=[];function q(G){return"rId"+(G.length+1)}if(D.hyperlinks.forEach(G=>{const ee=q(P);G.rId=ee,P.push({Id:ee,Type:l.Hyperlink,Target:G.target,TargetMode:"External"})}),D.comments.length>0){const G={Id:q(P),Type:l.Comments,Target:`../comments${D.id}.xml`};P.push(G);const ee={Id:q(P),Type:l.VmlDrawing,Target:`../drawings/vmlDrawing${D.id}.vml`};P.push(ee),D.comments.forEach(V=>{V.refAddress=o.decodeAddress(V.ref)}),O.commentRefs.push({commentName:"comments"+D.id,vmlDrawing:"vmlDrawing"+D.id})}const X=[];let Q;D.media.forEach(G=>{if(G.type==="background"){const ee=q(P);Q=O.media[G.imageId],P.push({Id:ee,Type:l.Image,Target:`../media/${Q.name}.${Q.extension}`}),D.background={rId:ee},D.image=O.media[G.imageId]}else if(G.type==="image"){let{drawing:ee}=D;Q=O.media[G.imageId],ee||(ee=D.drawing={rId:q(P),name:"drawing"+ ++O.drawingsCount,anchors:[],rels:[]},O.drawings.push(ee),P.push({Id:ee.rId,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",Target:`../drawings/${ee.name}.xml`}));let V=this.preImageId===G.imageId?X[G.imageId]:X[ee.rels.length];V||(V=q(ee.rels),X[ee.rels.length]=V,ee.rels.push({Id:V,Type:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",Target:`../media/${Q.name}.${Q.extension}`}));const H={picture:{rId:V},range:G.range};if(G.hyperlinks&&G.hyperlinks.hyperlink){const Z=q(ee.rels);X[ee.rels.length]=Z,H.picture.hyperlinks={tooltip:G.hyperlinks.tooltip,rId:Z},ee.rels.push({Id:Z,Type:l.Hyperlink,Target:G.hyperlinks.hyperlink,TargetMode:"External"})}this.preImageId=G.imageId,ee.anchors.push(H)}}),D.tables.forEach(G=>{const ee=q(P);G.rId=ee,P.push({Id:ee,Type:l.Table,Target:"../tables/"+G.target}),G.columns.forEach(V=>{const{style:H}=V;H&&(V.dxfId=O.styles.addDxfStyle(H))})}),this.map.extLst.prepare(D,O)}render(D,O){D.openXml(a.StdDocAttributes),D.openNode("worksheet",T.WORKSHEET_ATTRIBUTES);const P=O.properties?{defaultRowHeight:O.properties.defaultRowHeight,dyDescent:O.properties.dyDescent,outlineLevelCol:O.properties.outlineLevelCol,outlineLevelRow:O.properties.outlineLevelRow}:void 0;O.properties&&O.properties.defaultColWidth&&(P.defaultColWidth=O.properties.defaultColWidth);const q={outlineProperties:O.properties&&O.properties.outlineProperties,tabColor:O.properties&&O.properties.tabColor,pageSetup:O.pageSetup&&O.pageSetup.fitToPage?{fitToPage:O.pageSetup.fitToPage}:void 0},X=O.pageSetup&&O.pageSetup.margins,Q={showRowColHeaders:O.pageSetup&&O.pageSetup.showRowColHeaders,showGridLines:O.pageSetup&&O.pageSetup.showGridLines,horizontalCentered:O.pageSetup&&O.pageSetup.horizontalCentered,verticalCentered:O.pageSetup&&O.pageSetup.verticalCentered},G=O.sheetProtection;this.map.sheetPr.render(D,q),this.map.dimension.render(D,O.dimensions),this.map.sheetViews.render(D,O.views),this.map.sheetFormatPr.render(D,P),this.map.cols.render(D,O.cols),this.map.sheetData.render(D,O.rows),this.map.sheetProtection.render(D,G),this.map.autoFilter.render(D,O.autoFilter),this.map.mergeCells.render(D,O.mergeCells),this.map.conditionalFormatting.render(D,O.conditionalFormattings),this.map.dataValidations.render(D,O.dataValidations),this.map.hyperlinks.render(D,O.hyperlinks),this.map.printOptions.render(D,Q),this.map.pageMargins.render(D,X),this.map.pageSetup.render(D,O.pageSetup),this.map.headerFooter.render(D,O.headerFooter),this.map.rowBreaks.render(D,O.rowBreaks),this.map.drawing.render(D,O.drawing),this.map.picture.render(D,O.background),this.map.tableParts.render(D,O.tables),this.map.extLst.render(D,O),O.rels&&O.rels.forEach(ee=>{ee.Type===l.VmlDrawing&&D.leafNode("legacyDrawing",{"r:id":ee.Id})}),D.closeNode()}parseOpen(D){return this.parser?(this.parser.parseOpen(D),!0):D.name==="worksheet"?(s.each(this.map,O=>{O.reset()}),!0):(this.map[D.name]&&!this.ignoreNodes.includes(D.name)&&(this.parser=this.map[D.name],this.parser.parseOpen(D)),!0)}parseText(D){this.parser&&this.parser.parseText(D)}parseClose(D){if(this.parser)return this.parser.parseClose(D)||(this.parser=void 0),!0;if(D==="worksheet"){const O=this.map.sheetFormatPr.model||{};this.map.sheetPr.model&&this.map.sheetPr.model.tabColor&&(O.tabColor=this.map.sheetPr.model.tabColor),this.map.sheetPr.model&&this.map.sheetPr.model.outlineProperties&&(O.outlineProperties=this.map.sheetPr.model.outlineProperties);const P={fitToPage:this.map.sheetPr.model&&this.map.sheetPr.model.pageSetup&&this.map.sheetPr.model.pageSetup.fitToPage||!1,margins:this.map.pageMargins.model},q=Object.assign(P,this.map.pageSetup.model,this.map.printOptions.model),X=_(this.map.conditionalFormatting.model,this.map.extLst.model&&this.map.extLst.model["x14:conditionalFormattings"]);return this.model={dimensions:this.map.dimension.model,cols:this.map.cols.model,rows:this.map.sheetData.model,mergeCells:this.map.mergeCells.model,hyperlinks:this.map.hyperlinks.model,dataValidations:this.map.dataValidations.model,properties:O,views:this.map.sheetViews.model,pageSetup:q,headerFooter:this.map.headerFooter.model,background:this.map.picture.model,drawing:this.map.drawing.model,tables:this.map.tableParts.model,conditionalFormattings:X},this.map.autoFilter.model&&(this.model.autoFilter=this.map.autoFilter.model),this.map.sheetProtection.model&&(this.model.sheetProtection=this.map.sheetProtection.model),!1}else return!0}reconcile(D,O){const P=(D.relationships||[]).reduce((X,Q)=>{if(X[Q.Id]=Q,Q.Type===l.Comments&&(D.comments=O.comments[Q.Target].comments),Q.Type===l.VmlDrawing&&D.comments&&D.comments.length){const G=O.vmlDrawings[Q.Target].comments;D.comments.forEach((ee,V)=>{ee.note=Object.assign({},ee.note,G[V])})}return X},{});if(O.commentsMap=(D.comments||[]).reduce((X,Q)=>(Q.ref&&(X[Q.ref]=Q),X),{}),O.hyperlinkMap=(D.hyperlinks||[]).reduce((X,Q)=>(Q.rId&&(X[Q.address]=P[Q.rId].Target),X),{}),O.formulae={},D.rows=D.rows&&D.rows.filter(Boolean)||[],D.rows.forEach(X=>{X.cells=X.cells&&X.cells.filter(Boolean)||[]}),this.map.cols.reconcile(D.cols,O),this.map.sheetData.reconcile(D.rows,O),this.map.conditionalFormatting.reconcile(D.conditionalFormattings,O),D.media=[],D.drawing){const X=P[D.drawing.rId].Target.match(/\/drawings\/([a-zA-Z0-9]+)[.][a-zA-Z]{3,4}$/);if(X){const Q=X[1];O.drawings[Q].anchors.forEach(G=>{if(G.medium){const ee={type:"image",imageId:G.medium.index,range:G.range,hyperlinks:G.picture.hyperlinks};D.media.push(ee)}})}}const q=D.background&&P[D.background.rId];if(q){const X=q.Target.split("/media/")[1],Q=O.mediaIndex&&O.mediaIndex[X];Q!==void 0&&D.media.push({type:"background",imageId:Q})}D.tables=(D.tables||[]).map(X=>{const Q=P[X.rId];return O.tables[Q.Target]}),delete D.relationships,delete D.hyperlinks,delete D.comments}}T.WORKSHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac"},n.exports=T},{"../../../utils/col-cache":19,"../../../utils/under-dash":26,"../../../utils/xml-stream":28,"../../rel-type":31,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":72,"./cf/conditional-formattings-xform":87,"./col-xform":92,"./data-validations-xform":93,"./dimension-xform":94,"./drawing-xform":95,"./ext-lst-xform":96,"./header-footer-xform":97,"./hyperlink-xform":98,"./merge-cell-xform":99,"./merges":100,"./page-margins-xform":103,"./page-setup-xform":105,"./picture-xform":106,"./print-options-xform":107,"./row-breaks-xform":108,"./row-xform":109,"./sheet-format-properties-xform":110,"./sheet-properties-xform":111,"./sheet-protection-xform":112,"./sheet-view-xform":113,"./table-part-xform":114}],116:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.attr=o.attr}render(o,a){a&&(o.openNode(this.tag),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.model=!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],117:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this._format=o.format||function(a){try{return Number.isNaN(a.getTime())?"":a.toISOString()}catch{return""}},this._parse=o.parse||function(a){return new Date(a)}}render(o,a){a&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,this._format(a)):o.writeText(this._format(a)),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=this._parse(o.attributes[this.attr]):this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this._parse(this.text.join(""))),!1}}},{"../base-xform":32}],118:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs,this.zero=o.zero}render(o,a){(a||this.zero)&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,a):o.writeText(a),o.closeNode())}parseOpen(o){return o.name===this.tag&&(this.attr?this.model=parseInt(o.attributes[this.attr],10):this.text=[],!0)}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=parseInt(this.text.join("")||0,10)),!1}}},{"../base-xform":32}],119:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{constructor(o){super(),this.tag=o.tag,this.attr=o.attr,this.attrs=o.attrs}render(o,a){a!==void 0&&(o.openNode(this.tag),this.attrs&&o.addAttributes(this.attrs),this.attr?o.addAttribute(this.attr,a):o.writeText(a),o.closeNode())}parseOpen(o){o.name===this.tag&&(this.attr?this.model=o.attributes[this.attr]:this.text=[])}parseText(o){this.attr||this.text.push(o)}parseClose(){return this.attr||(this.model=this.text.join("")),!1}}},{"../base-xform":32}],120:[function(r,n,i){const s=r("./base-xform"),o=r("../../utils/xml-stream");n.exports=class extends s{constructor(a){super(),this._model=a}render(a){if(!this._xml){const l=new o;(function c(u,h){u.openNode(h.tag,h.$),h.c&&h.c.forEach(d=>{c(u,d)}),h.t&&u.writeText(h.t),u.closeNode()})(l,this._model),this._xml=l.xml}a.writeXml(this._xml)}parseOpen(){return!0}parseText(){}parseClose(a){return a!==this._model.tag}}},{"../../utils/xml-stream":28,"./base-xform":32}],121:[function(r,n,i){const s=r("./text-xform"),o=r("./rich-text-xform"),a=r("../base-xform");n.exports=class extends a{constructor(){super(),this.map={r:new o,t:new s}}get tag(){return"rPh"}render(l,c){if(l.openNode(this.tag,{sb:c.sb||0,eb:c.eb||0}),c&&c.hasOwnProperty("richText")&&c.richText){const{r:u}=this.map;c.richText.forEach(h=>{u.render(l,h)})}else c&&this.map.t.render(l,c.text);l.closeNode()}parseOpen(l){const{name:c}=l;return this.parser?(this.parser.parseOpen(l),!0):c===this.tag?(this.model={sb:parseInt(l.attributes.sb,10),eb:parseInt(l.attributes.eb,10)},!0):(this.parser=this.map[c],!!this.parser&&(this.parser.parseOpen(l),!0))}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser){if(!this.parser.parseClose(l)){switch(l){case"r":{let c=this.model.richText;c||(c=this.model.richText=[]),c.push(this.parser.model);break}case"t":this.model.text=this.parser.model}this.parser=void 0}return!0}return l!==this.tag}}},{"../base-xform":32,"./rich-text-xform":122,"./text-xform":125}],122:[function(r,n,i){const s=r("./text-xform"),o=r("../style/font-xform"),a=r("../base-xform");class l extends a{constructor(u){super(),this.model=u}get tag(){return"r"}get textXform(){return this._textXform||(this._textXform=new s)}get fontXform(){return this._fontXform||(this._fontXform=new o(l.FONT_OPTIONS))}render(u,h){h=h||this.model,u.openNode("r"),h.font&&this.fontXform.render(u,h.font),this.textXform.render(u,h.text),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case"r":return this.model={},!0;case"t":return this.parser=this.textXform,this.parser.parseOpen(u),!0;case"rPr":return this.parser=this.fontXform,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){switch(u){case"r":return!1;case"t":return this.model.text=this.parser.model,this.parser=void 0,!0;case"rPr":return this.model.font=this.parser.model,this.parser=void 0,!0;default:return this.parser&&this.parser.parseClose(u),!0}}}l.FONT_OPTIONS={tagName:"rPr",fontNameTag:"rFont"},n.exports=l},{"../base-xform":32,"../style/font-xform":131,"./text-xform":125}],123:[function(r,n,i){const s=r("./text-xform"),o=r("./rich-text-xform"),a=r("./phonetic-text-xform"),l=r("../base-xform");n.exports=class extends l{constructor(c){super(),this.model=c,this.map={r:new o,t:new s,rPh:new a}}get tag(){return"si"}render(c,u){c.openNode(this.tag),u&&u.hasOwnProperty("richText")&&u.richText?u.richText.length?u.richText.forEach(h=>{this.map.r.render(c,h)}):this.map.t.render(c,""):u!=null&&this.map.t.render(c,u),c.closeNode()}parseOpen(c){const{name:u}=c;return this.parser?(this.parser.parseOpen(c),!0):u===this.tag?(this.model={},!0):(this.parser=this.map[u],!!this.parser&&(this.parser.parseOpen(c),!0))}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser){if(!this.parser.parseClose(c)){switch(c){case"r":{let u=this.model.richText;u||(u=this.model.richText=[]),u.push(this.parser.model);break}case"t":this.model=this.parser.model}this.parser=void 0}return!0}return c!==this.tag}}},{"../base-xform":32,"./phonetic-text-xform":121,"./rich-text-xform":122,"./text-xform":125}],124:[function(r,n,i){const s=r("../../../utils/xml-stream"),o=r("../base-xform"),a=r("./shared-string-xform");n.exports=class extends o{constructor(l){super(),this.model=l||{values:[],count:0},this.hash=Object.create(null),this.rich=Object.create(null)}get sharedStringXform(){return this._sharedStringXform||(this._sharedStringXform=new a)}get values(){return this.model.values}get uniqueCount(){return this.model.values.length}get count(){return this.model.count}getString(l){return this.model.values[l]}add(l){return l.richText?this.addRichText(l):this.addText(l)}addText(l){let c=this.hash[l];return c===void 0&&(c=this.hash[l]=this.model.values.length,this.model.values.push(l)),this.model.count++,c}addRichText(l){const c=this.sharedStringXform.toXml(l);let u=this.rich[c];return u===void 0&&(u=this.rich[c]=this.model.values.length,this.model.values.push(l)),this.model.count++,u}render(l,c){c=c||this._values,l.openXml(s.StdDocAttributes),l.openNode("sst",{xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",count:c.count,uniqueCount:c.values.length});const u=this.sharedStringXform;c.values.forEach(h=>{u.render(l,h)}),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"sst":return!0;case"si":return this.parser=this.sharedStringXform,this.parser.parseOpen(l),!0;default:throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(l))}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){if(this.parser)return this.parser.parseClose(l)||(this.model.values.push(this.parser.model),this.model.count++,this.parser=void 0),!0;if(l==="sst")return!1;throw new Error("Unexpected xml node in parseClose: "+l)}}},{"../../../utils/xml-stream":28,"../base-xform":32,"./shared-string-xform":123}],125:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"t"}render(o,a){o.openNode("t"),/^\s|\n|\s$/.test(a)&&o.addAttribute("xml:space","preserve"),o.writeText(a),o.closeNode()}get model(){return this._text.join("").replace(/_x([0-9A-F]{4})_/g,(o,a)=>String.fromCharCode(parseInt(a,16)))}parseOpen(o){return o.name==="t"?(this._text=[],!0):!1}parseText(o){this._text.push(o)}parseClose(){return!1}}},{"../base-xform":32}],126:[function(r,n,i){const s=r("../../../doc/enums"),o=r("../../../utils/utils"),a=r("../base-xform"),l={horizontalValues:["left","center","right","fill","centerContinuous","distributed","justify"].reduce((u,h)=>(u[h]=!0,u),{}),horizontal(u){return this.horizontalValues[u]?u:void 0},verticalValues:["top","middle","bottom","distributed","justify"].reduce((u,h)=>(u[h]=!0,u),{}),vertical(u){return u==="middle"?"center":this.verticalValues[u]?u:void 0},wrapText:u=>!!u||void 0,shrinkToFit:u=>!!u||void 0,textRotation(u){return u==="vertical"||(u=o.validInt(u))>=-90&&u<=90?u:void 0},indent:u=>(u=o.validInt(u),Math.max(0,u)),readingOrder(u){switch(u){case"ltr":return s.ReadingOrder.LeftToRight;case"rtl":return s.ReadingOrder.RightToLeft;default:return}}},c={toXml(u){if(u=l.textRotation(u)){if(u==="vertical")return 255;const h=Math.round(u);if(h>=0&&h<=90)return h;if(h<0&&h>=-90)return 90-h}},toModel(u){const h=o.validInt(u);if(h!==void 0){if(h===255)return"vertical";if(h>=0&&h<=90)return h;if(h>90&&h<=180)return 90-h}}};n.exports=class extends a{get tag(){return"alignment"}render(u,h){u.addRollback(),u.openNode("alignment");let d=!1;function f(m,v){v&&(u.addAttribute(m,v),d=!0)}f("horizontal",l.horizontal(h.horizontal)),f("vertical",l.vertical(h.vertical)),f("wrapText",!!l.wrapText(h.wrapText)&&"1"),f("shrinkToFit",!!l.shrinkToFit(h.shrinkToFit)&&"1"),f("indent",l.indent(h.indent)),f("textRotation",c.toXml(h.textRotation)),f("readingOrder",l.readingOrder(h.readingOrder)),u.closeNode(),d?u.commit():u.rollback()}parseOpen(u){const h={};let d=!1;function f(m,v,g){m&&(h[v]=g,d=!0)}f(u.attributes.horizontal,"horizontal",u.attributes.horizontal),f(u.attributes.vertical,"vertical",u.attributes.vertical==="center"?"middle":u.attributes.vertical),f(u.attributes.wrapText,"wrapText",o.parseBoolean(u.attributes.wrapText)),f(u.attributes.shrinkToFit,"shrinkToFit",o.parseBoolean(u.attributes.shrinkToFit)),f(u.attributes.indent,"indent",parseInt(u.attributes.indent,10)),f(u.attributes.textRotation,"textRotation",c.toModel(u.attributes.textRotation)),f(u.attributes.readingOrder,"readingOrder",u.attributes.readingOrder==="2"?"rtl":"ltr"),this.model=d?h:null}parseText(){}parseClose(){return!1}}},{"../../../doc/enums":7,"../../../utils/utils":27,"../base-xform":32}],127:[function(r,n,i){const s=r("../base-xform"),o=r("../../../utils/utils"),a=r("./color-xform");class l extends s{constructor(u){super(),this.name=u,this.map={color:new a}}get tag(){return this.name}render(u,h,d){const f=h&&h.color||d||this.defaultColor;u.openNode(this.name),h&&h.style&&(u.addAttribute("style",h.style),f&&this.map.color.render(u,f)),u.closeNode()}parseOpen(u){if(this.parser)return this.parser.parseOpen(u),!0;switch(u.name){case this.name:{const{style:h}=u.attributes;return this.model=h?{style:h}:void 0,!0}case"color":return this.parser=this.map.color,this.parser.parseOpen(u),!0;default:return!1}}parseText(u){this.parser&&this.parser.parseText(u)}parseClose(u){return this.parser?(this.parser.parseClose(u)||(this.parser=void 0),!0):(u===this.name&&this.map.color.model&&(this.model||(this.model={}),this.model.color=this.map.color.model),!1)}validStyle(u){return l.validStyleValues[u]}}l.validStyleValues=["thin","dashed","dotted","dashDot","hair","dashDotDot","slantDashDot","mediumDashed","mediumDashDotDot","mediumDashDot","medium","double","thick"].reduce((c,u)=>(c[u]=!0,c),{}),n.exports=class extends s{constructor(){super(),this.map={top:new l("top"),left:new l("left"),bottom:new l("bottom"),right:new l("right"),diagonal:new l("diagonal")}}render(c,u){const{color:h}=u;function d(f,m){f&&!f.color&&u.color&&(f={...f,color:u.color}),m.render(c,f,h)}c.openNode("border"),u.diagonal&&u.diagonal.style&&(u.diagonal.up&&c.addAttribute("diagonalUp","1"),u.diagonal.down&&c.addAttribute("diagonalDown","1")),d(u.left,this.map.left),d(u.right,this.map.right),d(u.top,this.map.top),d(u.bottom,this.map.bottom),d(u.diagonal,this.map.diagonal),c.closeNode()}parseOpen(c){return this.parser?(this.parser.parseOpen(c),!0):c.name==="border"?(this.reset(),this.diagonalUp=o.parseBoolean(c.attributes.diagonalUp),this.diagonalDown=o.parseBoolean(c.attributes.diagonalDown),!0):(this.parser=this.map[c.name],!!this.parser&&(this.parser.parseOpen(c),!0))}parseText(c){this.parser&&this.parser.parseText(c)}parseClose(c){if(this.parser)return this.parser.parseClose(c)||(this.parser=void 0),!0;if(c==="border"){const u=this.model={},h=function(d,f,m){f&&(m&&Object.assign(f,m),u[d]=f)};h("left",this.map.left.model),h("right",this.map.right.model),h("top",this.map.top.model),h("bottom",this.map.bottom.model),h("diagonal",this.map.diagonal.model,{up:this.diagonalUp,down:this.diagonalDown})}return!1}}},{"../../../utils/utils":27,"../base-xform":32,"./color-xform":128}],128:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{constructor(o){super(),this.name=o||"color"}get tag(){return this.name}render(o,a){return!!a&&(o.openNode(this.name),a.argb?o.addAttribute("rgb",a.argb):a.theme!==void 0?(o.addAttribute("theme",a.theme),a.tint!==void 0&&o.addAttribute("tint",a.tint)):a.indexed!==void 0?o.addAttribute("indexed",a.indexed):o.addAttribute("auto","1"),o.closeNode(),!0)}parseOpen(o){return o.name===this.name&&(o.attributes.rgb?this.model={argb:o.attributes.rgb}:o.attributes.theme?(this.model={theme:parseInt(o.attributes.theme,10)},o.attributes.tint&&(this.model.tint=parseFloat(o.attributes.tint))):o.attributes.indexed?this.model={indexed:parseInt(o.attributes.indexed,10)}:this.model=void 0,!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],129:[function(r,n,i){const s=r("../base-xform"),o=r("./alignment-xform"),a=r("./border-xform"),l=r("./fill-xform"),c=r("./font-xform"),u=r("./numfmt-xform"),h=r("./protection-xform");n.exports=class extends s{constructor(){super(),this.map={alignment:new o,border:new a,fill:new l,font:new c,numFmt:new u,protection:new h}}get tag(){return"dxf"}render(d,f){if(d.openNode(this.tag),f.font&&this.map.font.render(d,f.font),f.numFmt&&f.numFmtId){const m={id:f.numFmtId,formatCode:f.numFmt};this.map.numFmt.render(d,m)}f.fill&&this.map.fill.render(d,f.fill),f.alignment&&this.map.alignment.render(d,f.alignment),f.border&&this.map.border.render(d,f.border),f.protection&&this.map.protection.render(d,f.protection),d.closeNode()}parseOpen(d){return this.parser?(this.parser.parseOpen(d),!0):d.name===this.tag?(this.reset(),!0):(this.parser=this.map[d.name],this.parser&&this.parser.parseOpen(d),!0)}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return this.parser?(this.parser.parseClose(d)||(this.parser=void 0),!0):d!==this.tag||(this.model={alignment:this.map.alignment.model,border:this.map.border.model,fill:this.map.fill.model,font:this.map.font.model,numFmt:this.map.numFmt.model,protection:this.map.protection.model},!1)}}},{"../base-xform":32,"./alignment-xform":126,"./border-xform":127,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./protection-xform":133}],130:[function(r,n,i){const s=r("../base-xform"),o=r("./color-xform");class a extends s{constructor(){super(),this.map={color:new o}}get tag(){return"stop"}render(d,f){d.openNode("stop"),d.addAttribute("position",f.position),this.map.color.render(d,f.color),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"stop":return this.model={position:parseFloat(d.attributes.position)},!0;case"color":return this.parser=this.map.color,this.parser.parseOpen(d),!0;default:return!1}}parseText(){}parseClose(d){return!!this.parser&&(this.parser.parseClose(d)||(this.model.color=this.parser.model,this.parser=void 0),!0)}}class l extends s{constructor(){super(),this.map={fgColor:new o("fgColor"),bgColor:new o("bgColor")}}get name(){return"pattern"}get tag(){return"patternFill"}render(d,f){d.openNode("patternFill"),d.addAttribute("patternType",f.pattern),f.fgColor&&this.map.fgColor.render(d,f.fgColor),f.bgColor&&this.map.bgColor.render(d,f.bgColor),d.closeNode()}parseOpen(d){return this.parser?(this.parser.parseOpen(d),!0):d.name==="patternFill"?(this.model={type:"pattern",pattern:d.attributes.patternType},!0):(this.parser=this.map[d.name],!!this.parser&&(this.parser.parseOpen(d),!0))}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return!!this.parser&&(this.parser.parseClose(d)||(this.parser.model&&(this.model[d]=this.parser.model),this.parser=void 0),!0)}}class c extends s{constructor(){super(),this.map={stop:new a}}get name(){return"gradient"}get tag(){return"gradientFill"}render(d,f){switch(d.openNode("gradientFill"),f.gradient){case"angle":d.addAttribute("degree",f.degree);break;case"path":d.addAttribute("type","path"),f.center.left&&(d.addAttribute("left",f.center.left),f.center.right===void 0&&d.addAttribute("right",f.center.left)),f.center.right&&d.addAttribute("right",f.center.right),f.center.top&&(d.addAttribute("top",f.center.top),f.center.bottom===void 0&&d.addAttribute("bottom",f.center.top)),f.center.bottom&&d.addAttribute("bottom",f.center.bottom)}const m=this.map.stop;f.stops.forEach(v=>{m.render(d,v)}),d.closeNode()}parseOpen(d){if(this.parser)return this.parser.parseOpen(d),!0;switch(d.name){case"gradientFill":{const f=this.model={stops:[]};return d.attributes.degree?(f.gradient="angle",f.degree=parseInt(d.attributes.degree,10)):d.attributes.type==="path"&&(f.gradient="path",f.center={left:d.attributes.left?parseFloat(d.attributes.left):0,top:d.attributes.top?parseFloat(d.attributes.top):0},d.attributes.right!==d.attributes.left&&(f.center.right=d.attributes.right?parseFloat(d.attributes.right):0),d.attributes.bottom!==d.attributes.top&&(f.center.bottom=d.attributes.bottom?parseFloat(d.attributes.bottom):0)),!0}case"stop":return this.parser=this.map.stop,this.parser.parseOpen(d),!0;default:return!1}}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return!!this.parser&&(this.parser.parseClose(d)||(this.model.stops.push(this.parser.model),this.parser=void 0),!0)}}class u extends s{constructor(){super(),this.map={patternFill:new l,gradientFill:new c}}get tag(){return"fill"}render(d,f){switch(d.addRollback(),d.openNode("fill"),f.type){case"pattern":this.map.patternFill.render(d,f);break;case"gradient":this.map.gradientFill.render(d,f);break;default:return void d.rollback()}d.closeNode(),d.commit()}parseOpen(d){return this.parser?(this.parser.parseOpen(d),!0):d.name==="fill"?(this.model={},!0):(this.parser=this.map[d.name],!!this.parser&&(this.parser.parseOpen(d),!0))}parseText(d){this.parser&&this.parser.parseText(d)}parseClose(d){return!!this.parser&&(this.parser.parseClose(d)||(this.model=this.parser.model,this.model.type=this.parser.name,this.parser=void 0),!0)}validStyle(d){return u.validPatternValues[d]}}u.validPatternValues=["none","solid","darkVertical","darkGray","mediumGray","lightGray","gray125","gray0625","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","lightGrid"].reduce((h,d)=>(h[d]=!0,h),{}),u.StopXform=a,u.PatternFillXform=l,u.GradientFillXform=c,n.exports=u},{"../base-xform":32,"./color-xform":128}],131:[function(r,n,i){const s=r("./color-xform"),o=r("../simple/boolean-xform"),a=r("../simple/integer-xform"),l=r("../simple/string-xform"),c=r("./underline-xform"),u=r("../../../utils/under-dash"),h=r("../base-xform");class d extends h{constructor(m){super(),this.options=m||d.OPTIONS,this.map={b:{prop:"bold",xform:new o({tag:"b",attr:"val"})},i:{prop:"italic",xform:new o({tag:"i",attr:"val"})},u:{prop:"underline",xform:new c},charset:{prop:"charset",xform:new a({tag:"charset",attr:"val"})},color:{prop:"color",xform:new s},condense:{prop:"condense",xform:new o({tag:"condense",attr:"val"})},extend:{prop:"extend",xform:new o({tag:"extend",attr:"val"})},family:{prop:"family",xform:new a({tag:"family",attr:"val"})},outline:{prop:"outline",xform:new o({tag:"outline",attr:"val"})},vertAlign:{prop:"vertAlign",xform:new l({tag:"vertAlign",attr:"val"})},scheme:{prop:"scheme",xform:new l({tag:"scheme",attr:"val"})},shadow:{prop:"shadow",xform:new o({tag:"shadow",attr:"val"})},strike:{prop:"strike",xform:new o({tag:"strike",attr:"val"})},sz:{prop:"size",xform:new a({tag:"sz",attr:"val"})}},this.map[this.options.fontNameTag]={prop:"name",xform:new l({tag:this.options.fontNameTag,attr:"val"})}}get tag(){return this.options.tagName}render(m,v){const{map:g}=this;m.openNode(this.options.tagName),u.each(this.map,(w,y)=>{g[y].xform.render(m,v[w.prop])}),m.closeNode()}parseOpen(m){return this.parser?(this.parser.parseOpen(m),!0):this.map[m.name]?(this.parser=this.map[m.name].xform,this.parser.parseOpen(m)):m.name===this.options.tagName?(this.model={},!0):!1}parseText(m){this.parser&&this.parser.parseText(m)}parseClose(m){if(this.parser&&!this.parser.parseClose(m)){const v=this.map[m];return this.parser.model&&(this.model[v.prop]=this.parser.model),this.parser=void 0,!0}return m!==this.options.tagName}}d.OPTIONS={tagName:"font",fontNameTag:"name"},n.exports=d},{"../../../utils/under-dash":26,"../base-xform":32,"../simple/boolean-xform":116,"../simple/integer-xform":118,"../simple/string-xform":119,"./color-xform":128,"./underline-xform":136}],132:[function(r,n,i){const s=r("../../../utils/under-dash"),o=r("../../defaultnumformats"),a=r("../base-xform"),l=(function(){const u={};return s.each(o,(h,d)=>{h.f&&(u[h.f]=parseInt(d,10))}),u})();class c extends a{constructor(h,d){super(),this.id=h,this.formatCode=d}get tag(){return"numFmt"}render(h,d){h.leafNode("numFmt",{numFmtId:d.id,formatCode:d.formatCode})}parseOpen(h){return h.name==="numFmt"?(this.model={id:parseInt(h.attributes.numFmtId,10),formatCode:h.attributes.formatCode.replace(/[\\](.)/g,"$1")},!0):!1}parseText(){}parseClose(){return!1}}c.getDefaultFmtId=function(u){return l[u]},c.getDefaultFmtCode=function(u){return o[u]&&o[u].f},n.exports=c},{"../../../utils/under-dash":26,"../../defaultnumformats":30,"../base-xform":32}],133:[function(r,n,i){const s=r("../base-xform"),o={boolean:(a,l)=>a===void 0?l:a};n.exports=class extends s{get tag(){return"protection"}render(a,l){a.addRollback(),a.openNode("protection");let c=!1;function u(h,d){d!==void 0&&(a.addAttribute(h,d),c=!0)}u("locked",o.boolean(l.locked,!0)?void 0:"0"),u("hidden",o.boolean(l.hidden,!1)?"1":void 0),a.closeNode(),c?a.commit():a.rollback()}parseOpen(a){const l={locked:a.attributes.locked!=="0",hidden:a.attributes.hidden==="1"},c=!l.locked||l.hidden;this.model=c?l:null}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],134:[function(r,n,i){const s=r("../base-xform"),o=r("./alignment-xform"),a=r("./protection-xform");n.exports=class extends s{constructor(l){super(),this.xfId=!(!l||!l.xfId),this.map={alignment:new o,protection:new a}}get tag(){return"xf"}render(l,c){l.openNode("xf",{numFmtId:c.numFmtId||0,fontId:c.fontId||0,fillId:c.fillId||0,borderId:c.borderId||0}),this.xfId&&l.addAttribute("xfId",c.xfId||0),c.numFmtId&&l.addAttribute("applyNumberFormat","1"),c.fontId&&l.addAttribute("applyFont","1"),c.fillId&&l.addAttribute("applyFill","1"),c.borderId&&l.addAttribute("applyBorder","1"),c.alignment&&l.addAttribute("applyAlignment","1"),c.protection&&l.addAttribute("applyProtection","1"),c.alignment&&this.map.alignment.render(l,c.alignment),c.protection&&this.map.protection.render(l,c.protection),l.closeNode()}parseOpen(l){if(this.parser)return this.parser.parseOpen(l),!0;switch(l.name){case"xf":return this.model={numFmtId:parseInt(l.attributes.numFmtId,10),fontId:parseInt(l.attributes.fontId,10),fillId:parseInt(l.attributes.fillId,10),borderId:parseInt(l.attributes.borderId,10)},this.xfId&&(this.model.xfId=parseInt(l.attributes.xfId,10)),!0;case"alignment":return this.parser=this.map.alignment,this.parser.parseOpen(l),!0;case"protection":return this.parser=this.map.protection,this.parser.parseOpen(l),!0;default:return!1}}parseText(l){this.parser&&this.parser.parseText(l)}parseClose(l){return this.parser?(this.parser.parseClose(l)||(this.map.protection===this.parser?this.model.protection=this.parser.model:this.model.alignment=this.parser.model,this.parser=void 0),!0):l!=="xf"}}},{"../base-xform":32,"./alignment-xform":126,"./protection-xform":133}],135:[function(r,n,i){const s=r("../../../doc/enums"),o=r("../../../utils/xml-stream"),a=r("../base-xform"),l=r("../static-xform"),c=r("../list-xform"),u=r("./font-xform"),h=r("./fill-xform"),d=r("./border-xform"),f=r("./numfmt-xform"),m=r("./style-xform"),v=r("./dxf-xform");class g extends a{constructor(y){super(),this.map={numFmts:new c({tag:"numFmts",count:!0,childXform:new f}),fonts:new c({tag:"fonts",count:!0,childXform:new u,$:{"x14ac:knownFonts":1}}),fills:new c({tag:"fills",count:!0,childXform:new h}),borders:new c({tag:"borders",count:!0,childXform:new d}),cellStyleXfs:new c({tag:"cellStyleXfs",count:!0,childXform:new m}),cellXfs:new c({tag:"cellXfs",count:!0,childXform:new m({xfId:!0})}),dxfs:new c({tag:"dxfs",always:!0,count:!0,childXform:new v}),numFmt:new f,font:new u,fill:new h,border:new d,style:new m({xfId:!0}),cellStyles:g.STATIC_XFORMS.cellStyles,tableStyles:g.STATIC_XFORMS.tableStyles,extLst:g.STATIC_XFORMS.extLst},y&&this.init()}initIndex(){this.index={style:{},numFmt:{},numFmtNextId:164,font:{},border:{},fill:{}}}init(){this.model={styles:[],numFmts:[],fonts:[],borders:[],fills:[],dxfs:[]},this.initIndex(),this._addBorder({}),this._addStyle({numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}),this._addFill({type:"pattern",pattern:"none"}),this._addFill({type:"pattern",pattern:"gray125"}),this.weakMap=new WeakMap}render(y,C){C=C||this.model,y.openXml(o.StdDocAttributes),y.openNode("styleSheet",g.STYLESHEET_ATTRIBUTES),this.index?(C.numFmts&&C.numFmts.length&&(y.openNode("numFmts",{count:C.numFmts.length}),C.numFmts.forEach(k=>{y.writeXml(k)}),y.closeNode()),C.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),y.openNode("fonts",{count:C.fonts.length,"x14ac:knownFonts":1}),C.fonts.forEach(k=>{y.writeXml(k)}),y.closeNode(),y.openNode("fills",{count:C.fills.length}),C.fills.forEach(k=>{y.writeXml(k)}),y.closeNode(),y.openNode("borders",{count:C.borders.length}),C.borders.forEach(k=>{y.writeXml(k)}),y.closeNode(),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),y.openNode("cellXfs",{count:C.styles.length}),C.styles.forEach(k=>{y.writeXml(k)}),y.closeNode()):(this.map.numFmts.render(y,C.numFmts),this.map.fonts.render(y,C.fonts),this.map.fills.render(y,C.fills),this.map.borders.render(y,C.borders),this.map.cellStyleXfs.render(y,[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}]),this.map.cellXfs.render(y,C.styles)),g.STATIC_XFORMS.cellStyles.render(y),this.map.dxfs.render(y,C.dxfs),g.STATIC_XFORMS.tableStyles.render(y),g.STATIC_XFORMS.extLst.render(y),y.closeNode()}parseOpen(y){return this.parser?(this.parser.parseOpen(y),!0):y.name==="styleSheet"?(this.initIndex(),!0):(this.parser=this.map[y.name],this.parser&&this.parser.parseOpen(y),!0)}parseText(y){this.parser&&this.parser.parseText(y)}parseClose(y){if(this.parser)return this.parser.parseClose(y)||(this.parser=void 0),!0;switch(y){case"styleSheet":{this.model={};const C=(k,F)=>{F.model&&F.model.length&&(this.model[k]=F.model)};if(C("numFmts",this.map.numFmts),C("fonts",this.map.fonts),C("fills",this.map.fills),C("borders",this.map.borders),C("styles",this.map.cellXfs),C("dxfs",this.map.dxfs),this.index={model:[],numFmt:[]},this.model.numFmts){const k=this.index.numFmt;this.model.numFmts.forEach(F=>{k[F.id]=F.formatCode})}return!1}default:return!0}}addStyleModel(y,C){if(!y)return 0;if(this.model.fonts.length||this._addFont({size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}),this.weakMap&&this.weakMap.has(y))return this.weakMap.get(y);const k={};if(C=C||s.ValueType.Number,y.numFmt)k.numFmtId=this._addNumFmtStr(y.numFmt);else switch(C){case s.ValueType.Number:k.numFmtId=this._addNumFmtStr("General");break;case s.ValueType.Date:k.numFmtId=this._addNumFmtStr("mm-dd-yy")}y.font&&(k.fontId=this._addFont(y.font)),y.border&&(k.borderId=this._addBorder(y.border)),y.fill&&(k.fillId=this._addFill(y.fill)),y.alignment&&(k.alignment=y.alignment),y.protection&&(k.protection=y.protection);const F=this._addStyle(k);return this.weakMap&&this.weakMap.set(y,F),F}getStyleModel(y){const C=this.model.styles[y];if(!C)return null;let k=this.index.model[y];if(k)return k;if(k=this.index.model[y]={},C.numFmtId){const I=this.index.numFmt[C.numFmtId]||f.getDefaultFmtCode(C.numFmtId);I&&(k.numFmt=I)}function F(I,N,j){if(j||j===0){const L=N[j];L&&(k[I]=L)}}return F("font",this.model.fonts,C.fontId),F("border",this.model.borders,C.borderId),F("fill",this.model.fills,C.fillId),C.alignment&&(k.alignment=C.alignment),C.protection&&(k.protection=C.protection),k}addDxfStyle(y){return y.numFmt&&(y.numFmtId=this._addNumFmtStr(y.numFmt)),this.model.dxfs.push(y),this.model.dxfs.length-1}getDxfStyle(y){return this.model.dxfs[y]}_addStyle(y){const C=this.map.style.toXml(y);let k=this.index.style[C];return k===void 0&&(k=this.index.style[C]=this.model.styles.length,this.model.styles.push(C)),k}_addNumFmtStr(y){let C=f.getDefaultFmtId(y);if(C!==void 0||(C=this.index.numFmt[y],C!==void 0))return C;C=this.index.numFmt[y]=164+this.model.numFmts.length;const k=this.map.numFmt.toXml({id:C,formatCode:y});return this.model.numFmts.push(k),C}_addFont(y){const C=this.map.font.toXml(y);let k=this.index.font[C];return k===void 0&&(k=this.index.font[C]=this.model.fonts.length,this.model.fonts.push(C)),k}_addBorder(y){const C=this.map.border.toXml(y);let k=this.index.border[C];return k===void 0&&(k=this.index.border[C]=this.model.borders.length,this.model.borders.push(C)),k}_addFill(y){const C=this.map.fill.toXml(y);let k=this.index.fill[C];return k===void 0&&(k=this.index.fill[C]=this.model.fills.length,this.model.fills.push(C)),k}}g.STYLESHEET_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"x14ac x16r2","xmlns:x14ac":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac","xmlns:x16r2":"http://schemas.microsoft.com/office/spreadsheetml/2015/02/main"},g.STATIC_XFORMS={cellStyles:new l({tag:"cellStyles",$:{count:1},c:[{tag:"cellStyle",$:{name:"Normal",xfId:0,builtinId:0}}]}),dxfs:new l({tag:"dxfs",$:{count:0}}),tableStyles:new l({tag:"tableStyles",$:{count:0,defaultTableStyle:"TableStyleMedium2",defaultPivotStyle:"PivotStyleLight16"}}),extLst:new l({tag:"extLst",c:[{tag:"ext",$:{uri:"{EB79DEF2-80B8-43e5-95BD-54CBDDF9020C}","xmlns:x14":"http://schemas.microsoft.com/office/spreadsheetml/2009/9/main"},c:[{tag:"x14:slicerStyles",$:{defaultSlicerStyle:"SlicerStyleLight1"}}]},{tag:"ext",$:{uri:"{9260A510-F301-46a8-8635-F512D64BE5F5}","xmlns:x15":"http://schemas.microsoft.com/office/spreadsheetml/2010/11/main"},c:[{tag:"x15:timelineStyles",$:{defaultTimelineStyle:"TimeSlicerStyleLight1"}}]}]})},g.Mock=class extends g{constructor(){super(),this.model={styles:[{numFmtId:0,fontId:0,fillId:0,borderId:0,xfId:0}],numFmts:[],fonts:[{size:11,color:{theme:1},name:"Calibri",family:2,scheme:"minor"}],borders:[{}],fills:[{type:"pattern",pattern:"none"},{type:"pattern",pattern:"gray125"}]}}parseStream(w){return w.autodrain(),Promise.resolve()}addStyleModel(w,y){return y===s.ValueType.Date?this.dateStyleId:0}get dateStyleId(){if(!this._dateStyleId){const w={numFmtId:f.getDefaultFmtId("mm-dd-yy")};this._dateStyleId=this.model.styles.length,this.model.styles.push(w)}return this._dateStyleId}getStyleModel(){return{}}},n.exports=g},{"../../../doc/enums":7,"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"../static-xform":120,"./border-xform":127,"./dxf-xform":129,"./fill-xform":130,"./font-xform":131,"./numfmt-xform":132,"./style-xform":134}],136:[function(r,n,i){const s=r("../base-xform");class o extends s{constructor(l){super(),this.model=l}get tag(){return"u"}render(l,c){if((c=c||this.model)===!0)l.leafNode("u");else{const u=o.Attributes[c];u&&l.leafNode("u",u)}}parseOpen(l){l.name==="u"&&(this.model=l.attributes.val||!0)}parseText(){}parseClose(){return!1}}o.Attributes={single:{},double:{val:"double"},singleAccounting:{val:"singleAccounting"},doubleAccounting:{val:"doubleAccounting"}},n.exports=o},{"../base-xform":32}],137:[function(r,n,i){const s=r("../base-xform"),o=r("./filter-column-xform");n.exports=class extends s{constructor(){super(),this.map={filterColumn:new o}}get tag(){return"autoFilter"}prepare(a){a.columns.forEach((l,c)=>{this.map.filterColumn.prepare(l,{index:c})})}render(a,l){return a.openNode(this.tag,{ref:l.autoFilterRef}),l.columns.forEach(c=>{this.map.filterColumn.render(a,c)}),a.closeNode(),!0}parseOpen(a){if(this.parser)return this.parser.parseOpen(a),!0;switch(a.name){case this.tag:return this.model={autoFilterRef:a.attributes.ref,columns:[]},!0;default:if(this.parser=this.map[a.name],this.parser)return this.parseOpen(a),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(a))}}parseText(a){this.parser&&this.parser.parseText(a)}parseClose(a){if(this.parser)return this.parser.parseClose(a)||(this.model.columns.push(this.parser.model),this.parser=void 0),!0;if(a===this.tag)return!1;throw new Error("Unexpected xml node in parseClose: "+a)}}},{"../base-xform":32,"./filter-column-xform":139}],138:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"customFilter"}render(o,a){o.leafNode(this.tag,{val:a.val,operator:a.operator})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val,operator:o.attributes.operator},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],139:[function(r,n,i){const s=r("../base-xform"),o=r("../list-xform"),a=r("./custom-filter-xform"),l=r("./filter-xform");n.exports=class extends s{constructor(){super(),this.map={customFilters:new o({tag:"customFilters",count:!1,empty:!0,childXform:new a}),filters:new o({tag:"filters",count:!1,empty:!0,childXform:new l})}}get tag(){return"filterColumn"}prepare(c,u){c.colId=u.index.toString()}render(c,u){return u.customFilters?(c.openNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),this.map.customFilters.render(c,u.customFilters),c.closeNode(),!0):(c.leafNode(this.tag,{colId:u.colId,hiddenButton:u.filterButton?"0":"1"}),!0)}parseOpen(c){if(this.parser)return this.parser.parseOpen(c),!0;const{attributes:u}=c;switch(c.name){case this.tag:return this.model={filterButton:u.hiddenButton==="0"},!0;default:if(this.parser=this.map[c.name],this.parser)return this.parseOpen(c),!0;throw new Error("Unexpected xml node in parseOpen: "+JSON.stringify(c))}}parseText(){}parseClose(c){return this.parser?(this.parser.parseClose(c)||(this.parser=void 0),!0):c===this.tag?(this.model.customFilters=this.map.customFilters.model,!1):!0}}},{"../base-xform":32,"../list-xform":71,"./custom-filter-xform":138,"./filter-xform":140}],140:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"filter"}render(o,a){o.leafNode(this.tag,{val:a.val})}parseOpen(o){return o.name===this.tag&&(this.model={val:o.attributes.val},!0)}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],141:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"tableColumn"}prepare(o,a){o.id=a.index+1}render(o,a){return o.leafNode(this.tag,{id:a.id.toString(),name:a.name,totalsRowLabel:a.totalsRowLabel,totalsRowFunction:a.totalsRowFunction,dxfId:a.dxfId}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:a}=o;return this.model={name:a.name,totalsRowLabel:a.totalsRowLabel,totalsRowFunction:a.totalsRowFunction,dxfId:a.dxfId},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],142:[function(r,n,i){const s=r("../base-xform");n.exports=class extends s{get tag(){return"tableStyleInfo"}render(o,a){return o.leafNode(this.tag,{name:a.theme?a.theme:void 0,showFirstColumn:a.showFirstColumn?"1":"0",showLastColumn:a.showLastColumn?"1":"0",showRowStripes:a.showRowStripes?"1":"0",showColumnStripes:a.showColumnStripes?"1":"0"}),!0}parseOpen(o){if(o.name===this.tag){const{attributes:a}=o;return this.model={theme:a.name?a.name:null,showFirstColumn:a.showFirstColumn==="1",showLastColumn:a.showLastColumn==="1",showRowStripes:a.showRowStripes==="1",showColumnStripes:a.showColumnStripes==="1"},!0}return!1}parseText(){}parseClose(){return!1}}},{"../base-xform":32}],143:[function(r,n,i){const s=r("../../../utils/xml-stream"),o=r("../base-xform"),a=r("../list-xform"),l=r("./auto-filter-xform"),c=r("./table-column-xform"),u=r("./table-style-info-xform");class h extends o{constructor(){super(),this.map={autoFilter:new l,tableColumns:new a({tag:"tableColumns",count:!0,empty:!0,childXform:new c}),tableStyleInfo:new u}}prepare(f,m){this.map.autoFilter.prepare(f),this.map.tableColumns.prepare(f.columns,m)}get tag(){return"table"}render(f,m){f.openXml(s.StdDocAttributes),f.openNode(this.tag,{...h.TABLE_ATTRIBUTES,id:m.id,name:m.name,displayName:m.displayName||m.name,ref:m.tableRef,totalsRowCount:m.totalsRow?"1":void 0,totalsRowShown:m.totalsRow?void 0:"1",headerRowCount:m.headerRow?"1":"0"}),this.map.autoFilter.render(f,m),this.map.tableColumns.render(f,m.columns),this.map.tableStyleInfo.render(f,m.style),f.closeNode()}parseOpen(f){if(this.parser)return this.parser.parseOpen(f),!0;const{name:m,attributes:v}=f;return m===this.tag?(this.reset(),this.model={name:v.name,displayName:v.displayName||v.name,tableRef:v.ref,totalsRow:v.totalsRowCount==="1",headerRow:v.headerRowCount==="1"}):(this.parser=this.map[f.name],this.parser&&this.parser.parseOpen(f)),!0}parseText(f){this.parser&&this.parser.parseText(f)}parseClose(f){return this.parser?(this.parser.parseClose(f)||(this.parser=void 0),!0):f===this.tag?(this.model.columns=this.map.tableColumns.model,this.map.autoFilter.model&&(this.model.autoFilterRef=this.map.autoFilter.model.autoFilterRef,this.map.autoFilter.model.columns.forEach((m,v)=>{this.model.columns[v].filterButton=m.filterButton})),this.model.style=this.map.tableStyleInfo.model,!1):!0}reconcile(f,m){f.columns.forEach(v=>{v.dxfId!==void 0&&(v.style=m.styles.getDxfStyle(v.dxfId))})}}h.TABLE_ATTRIBUTES={xmlns:"http://schemas.openxmlformats.org/spreadsheetml/2006/main","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","mc:Ignorable":"xr xr3","xmlns:xr":"http://schemas.microsoft.com/office/spreadsheetml/2014/revision","xmlns:xr3":"http://schemas.microsoft.com/office/spreadsheetml/2016/revision3"},n.exports=h},{"../../../utils/xml-stream":28,"../base-xform":32,"../list-xform":71,"./auto-filter-xform":137,"./table-column-xform":141,"./table-style-info-xform":142}],144:[function(r,n,i){(function(s,o){(function(){const a=r("fs"),l=r("jszip"),{PassThrough:c}=r("readable-stream"),u=r("../utils/zip-stream"),h=r("../utils/stream-buf"),d=r("../utils/utils"),f=r("../utils/xml-stream"),{bufferToString:m}=r("../utils/browser-buffer-decode"),v=r("./xform/style/styles-xform"),g=r("./xform/core/core-xform"),w=r("./xform/strings/shared-strings-xform"),y=r("./xform/core/relationships-xform"),C=r("./xform/core/content-types-xform"),k=r("./xform/core/app-xform"),F=r("./xform/book/workbook-xform"),I=r("./xform/sheet/worksheet-xform"),N=r("./xform/drawing/drawing-xform"),j=r("./xform/table/table-xform"),L=r("./xform/comment/comments-xform"),W=r("./xform/comment/vml-notes-xform"),K=r("./xml/theme1");class z{constructor(B){this.workbook=B}async readFile(B,R){if(!await d.fs.exists(B))throw new Error("File not found: "+B);const S=a.createReadStream(B);try{const _=await this.read(S,R);return S.close(),_}catch(_){throw S.close(),_}}parseRels(B){return new y().parseStream(B)}parseWorkbook(B){return new F().parseStream(B)}parseSharedStrings(B){return new w().parseStream(B)}reconcile(B,R){const S=new F,_=new I(R),T=new N,E=new j;S.reconcile(B);const D={media:B.media,mediaIndex:B.mediaIndex};Object.keys(B.drawings).forEach(q=>{const X=B.drawings[q],Q=B.drawingRels[q];Q&&(D.rels=Q.reduce((G,ee)=>(G[ee.Id]=ee,G),{}),(X.anchors||[]).forEach(G=>{const ee=G.picture&&G.picture.hyperlinks;ee&&D.rels[ee.rId]&&(ee.hyperlink=D.rels[ee.rId].Target,delete ee.rId)}),T.reconcile(X,D))});const O={styles:B.styles};Object.values(B.tables).forEach(q=>{E.reconcile(q,O)});const P={styles:B.styles,sharedStrings:B.sharedStrings,media:B.media,mediaIndex:B.mediaIndex,date1904:B.properties&&B.properties.date1904,drawings:B.drawings,comments:B.comments,tables:B.tables,vmlDrawings:B.vmlDrawings};B.worksheets.forEach(q=>{q.relationships=B.worksheetRels[q.sheetNo],_.reconcile(q,P)}),delete B.worksheetHash,delete B.worksheetRels,delete B.globalRels,delete B.sharedStrings,delete B.workbookRels,delete B.sheetDefs,delete B.styles,delete B.mediaIndex,delete B.drawings,delete B.drawingRels,delete B.vmlDrawings}async _processWorksheetEntry(B,R,S,_,T){const E=new I(_),D=await E.parseStream(B);D.sheetNo=S,R.worksheetHash[T]=D,R.worksheets.push(D)}async _processCommentEntry(B,R,S){const _=new L,T=await _.parseStream(B);R.comments[`../${S}.xml`]=T}async _processTableEntry(B,R,S){const _=new j,T=await _.parseStream(B);R.tables[`../tables/${S}.xml`]=T}async _processWorksheetRelsEntry(B,R,S){const _=new y,T=await _.parseStream(B);R.worksheetRels[S]=T}async _processMediaEntry(B,R,S){const _=S.lastIndexOf(".");if(_>=1){const T=S.substr(_+1),E=S.substr(0,_);await new Promise((D,O)=>{const P=new h;P.on("finish",()=>{R.mediaIndex[S]=R.media.length,R.mediaIndex[E]=R.media.length;const q={type:"image",name:E,extension:T,buffer:P.toBuffer()};R.media.push(q),D()}),B.on("error",q=>{O(q)}),B.pipe(P)})}}async _processDrawingEntry(B,R,S){const _=new N,T=await _.parseStream(B);R.drawings[S]=T}async _processDrawingRelsEntry(B,R,S){const _=new y,T=await _.parseStream(B);R.drawingRels[S]=T}async _processVmlDrawingEntry(B,R,S){const _=new W,T=await _.parseStream(B);R.vmlDrawings[`../drawings/${S}.vml`]=T}async _processThemeEntry(B,R,S){await new Promise((_,T)=>{const E=new h;B.on("error",T),E.on("error",T),E.on("finish",()=>{R.themes[S]=E.read().toString(),_()}),B.pipe(E)})}createInputStream(){throw new Error("`XLSX#createInputStream` is deprecated. You should use `XLSX#read` instead. This method will be removed in version 5.0. Please follow upgrade instruction: https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md")}async read(B,R){!B[Symbol.asyncIterator]&&B.pipe&&(B=B.pipe(new c));const S=[];for await(const _ of B)S.push(_);return this.load(o.concat(S),R)}async load(B,R){let S;S=R&&R.base64?o.from(B.toString(),"base64"):B;const _={worksheets:[],worksheetHash:{},worksheetRels:[],themes:{},media:[],mediaIndex:{},drawings:{},drawingRels:{},comments:{},tables:{},vmlDrawings:{}},T=await l.loadAsync(S);for(const E of Object.values(T.files))if(!E.dir){let D,O=E.name;if(O[0]==="/"&&(O=O.substr(1)),O.match(/xl\/media\//)||O.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/))D=new c,D.write(await E.async("nodebuffer"));else{let P;D=new c({writableObjectMode:!0,readableObjectMode:!0}),P=s.browser?m(await E.async("nodebuffer")):await E.async("string");const q=16384;for(let X=0;X<P.length;X+=q)D.write(P.substring(X,X+q))}switch(D.end(),O){case"_rels/.rels":_.globalRels=await this.parseRels(D);break;case"xl/workbook.xml":{const P=await this.parseWorkbook(D);_.sheets=P.sheets,_.definedNames=P.definedNames,_.views=P.views,_.properties=P.properties,_.calcProperties=P.calcProperties;break}case"xl/_rels/workbook.xml.rels":_.workbookRels=await this.parseRels(D);break;case"xl/sharedStrings.xml":_.sharedStrings=new w,await _.sharedStrings.parseStream(D);break;case"xl/styles.xml":_.styles=new v,await _.styles.parseStream(D);break;case"docProps/app.xml":{const P=new k,q=await P.parseStream(D);_.company=q.company,_.manager=q.manager;break}case"docProps/core.xml":{const P=new g,q=await P.parseStream(D);Object.assign(_,q);break}default:{let P=O.match(/xl\/worksheets\/sheet(\d+)[.]xml/);if(P){await this._processWorksheetEntry(D,_,P[1],R,O);break}if(P=O.match(/xl\/worksheets\/_rels\/sheet(\d+)[.]xml.rels/),P){await this._processWorksheetRelsEntry(D,_,P[1]);break}if(P=O.match(/xl\/theme\/([a-zA-Z0-9]+)[.]xml/),P){await this._processThemeEntry(D,_,P[1]);break}if(P=O.match(/xl\/media\/([a-zA-Z0-9]+[.][a-zA-Z0-9]{3,4})$/),P){await this._processMediaEntry(D,_,P[1]);break}if(P=O.match(/xl\/drawings\/([a-zA-Z0-9]+)[.]xml/),P){await this._processDrawingEntry(D,_,P[1]);break}if(P=O.match(/xl\/(comments\d+)[.]xml/),P){await this._processCommentEntry(D,_,P[1]);break}if(P=O.match(/xl\/tables\/(table\d+)[.]xml/),P){await this._processTableEntry(D,_,P[1]);break}if(P=O.match(/xl\/drawings\/_rels\/([a-zA-Z0-9]+)[.]xml[.]rels/),P){await this._processDrawingRelsEntry(D,_,P[1]);break}if(P=O.match(/xl\/drawings\/(vmlDrawing\d+)[.]vml/),P){await this._processVmlDrawingEntry(D,_,P[1]);break}}}}return this.reconcile(_,R),this.workbook.model=_,this.workbook}async addMedia(B,R){await Promise.all(R.media.map(async S=>{if(S.type==="image"){const _=`xl/media/${S.name}.${S.extension}`;if(S.filename){const T=await(function(E,D){return new Promise((O,P)=>{a.readFile(E,D,(q,X)=>{q?P(q):O(X)})})})(S.filename);return B.append(T,{name:_})}if(S.buffer)return B.append(S.buffer,{name:_});if(S.base64){const T=S.base64,E=T.substring(T.indexOf(",")+1);return B.append(E,{name:_,base64:!0})}}throw new Error("Unsupported media")}))}addDrawings(B,R){const S=new N,_=new y;R.worksheets.forEach(T=>{const{drawing:E}=T;if(E){S.prepare(E,{});let D=S.toXml(E);B.append(D,{name:`xl/drawings/${E.name}.xml`}),D=_.toXml(E.rels),B.append(D,{name:`xl/drawings/_rels/${E.name}.xml.rels`})}})}addTables(B,R){const S=new j;R.worksheets.forEach(_=>{const{tables:T}=_;T.forEach(E=>{S.prepare(E,{});const D=S.toXml(E);B.append(D,{name:"xl/tables/"+E.target})})})}async addContentTypes(B,R){const S=new C().toXml(R);B.append(S,{name:"[Content_Types].xml"})}async addApp(B,R){const S=new k().toXml(R);B.append(S,{name:"docProps/app.xml"})}async addCore(B,R){const S=new g;B.append(S.toXml(R),{name:"docProps/core.xml"})}async addThemes(B,R){const S=R.themes||{theme1:K};Object.keys(S).forEach(_=>{const T=S[_],E=`xl/theme/${_}.xml`;B.append(T,{name:E})})}async addOfficeRels(B){const R=new y().toXml([{Id:"rId1",Type:z.RelType.OfficeDocument,Target:"xl/workbook.xml"},{Id:"rId2",Type:z.RelType.CoreProperties,Target:"docProps/core.xml"},{Id:"rId3",Type:z.RelType.ExtenderProperties,Target:"docProps/app.xml"}]);B.append(R,{name:"_rels/.rels"})}async addWorkbookRels(B,R){let S=1;const _=[{Id:"rId"+S++,Type:z.RelType.Styles,Target:"styles.xml"},{Id:"rId"+S++,Type:z.RelType.Theme,Target:"theme/theme1.xml"}];R.sharedStrings.count&&_.push({Id:"rId"+S++,Type:z.RelType.SharedStrings,Target:"sharedStrings.xml"}),R.worksheets.forEach(E=>{E.rId="rId"+S++,_.push({Id:E.rId,Type:z.RelType.Worksheet,Target:`worksheets/sheet${E.id}.xml`})});const T=new y().toXml(_);B.append(T,{name:"xl/_rels/workbook.xml.rels"})}async addSharedStrings(B,R){R.sharedStrings&&R.sharedStrings.count&&B.append(R.sharedStrings.xml,{name:"xl/sharedStrings.xml"})}async addStyles(B,R){const{xml:S}=R.styles;S&&B.append(S,{name:"xl/styles.xml"})}async addWorkbook(B,R){const S=new F;B.append(S.toXml(R),{name:"xl/workbook.xml"})}async addWorksheets(B,R){const S=new I,_=new y,T=new L,E=new W;R.worksheets.forEach(D=>{let O=new f;S.render(O,D),B.append(O.xml,{name:`xl/worksheets/sheet${D.id}.xml`}),D.rels&&D.rels.length&&(O=new f,_.render(O,D.rels),B.append(O.xml,{name:`xl/worksheets/_rels/sheet${D.id}.xml.rels`})),D.comments.length>0&&(O=new f,T.render(O,D),B.append(O.xml,{name:`xl/comments${D.id}.xml`}),O=new f,E.render(O,D),B.append(O.xml,{name:`xl/drawings/vmlDrawing${D.id}.vml`}))})}_finalize(B){return new Promise((R,S)=>{B.on("finish",()=>{R(this)}),B.on("error",S),B.finalize()})}prepareModel(B,R){B.creator=B.creator||"ExcelJS",B.lastModifiedBy=B.lastModifiedBy||"ExcelJS",B.created=B.created||new Date,B.modified=B.modified||new Date,B.useSharedStrings=R.useSharedStrings===void 0||R.useSharedStrings,B.useStyles=R.useStyles===void 0||R.useStyles,B.sharedStrings=new w,B.styles=B.useStyles?new v(!0):new v.Mock;const S=new F,_=new I;S.prepare(B);const T={sharedStrings:B.sharedStrings,styles:B.styles,date1904:B.properties.date1904,drawingsCount:0,media:B.media};T.drawings=B.drawings=[],T.commentRefs=B.commentRefs=[];let E=0;B.tables=[],B.worksheets.forEach(D=>{D.tables.forEach(O=>{E++,O.target=`table${E}.xml`,O.id=E,B.tables.push(O)}),_.prepare(D,T)})}async write(B,R){R=R||{};const{model:S}=this.workbook,_=new u.ZipWriter(R.zip);return _.pipe(B),this.prepareModel(S,R),await this.addContentTypes(_,S),await this.addOfficeRels(_,S),await this.addWorkbookRels(_,S),await this.addWorksheets(_,S),await this.addSharedStrings(_,S),await this.addDrawings(_,S),await this.addTables(_,S),await Promise.all([this.addThemes(_,S),this.addStyles(_,S)]),await this.addMedia(_,S),await Promise.all([this.addApp(_,S),this.addCore(_,S)]),await this.addWorkbook(_,S),this._finalize(_)}writeFile(B,R){const S=a.createWriteStream(B);return new Promise((_,T)=>{S.on("finish",()=>{_()}),S.on("error",E=>{T(E)}),this.write(S,R).then(()=>{S.end()}).catch(E=>{T(E)})})}async writeBuffer(B){const R=new h;return await this.write(R,B),R.read()}}z.RelType=r("./rel-type"),n.exports=z}).call(this)}).call(this,r("_process"),r("buffer").Buffer)},{"../utils/browser-buffer-decode":16,"../utils/stream-buf":24,"../utils/utils":27,"../utils/xml-stream":28,"../utils/zip-stream":29,"./rel-type":31,"./xform/book/workbook-xform":38,"./xform/comment/comments-xform":40,"./xform/comment/vml-notes-xform":45,"./xform/core/app-xform":51,"./xform/core/content-types-xform":52,"./xform/core/core-xform":53,"./xform/core/relationships-xform":55,"./xform/drawing/drawing-xform":62,"./xform/sheet/worksheet-xform":115,"./xform/strings/shared-strings-xform":124,"./xform/style/styles-xform":135,"./xform/table/table-xform":143,"./xml/theme1":145,_process:467,buffer:220,fs:216,jszip:441,"readable-stream":491}],145:[function(r,n,i){n.exports=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme"> <a:themeElements> <a:clrScheme name="Office"> <a:dk1> <a:sysClr val="windowText" lastClr="000000"/> </a:dk1> <a:lt1> <a:sysClr val="window" lastClr="FFFFFF"/> </a:lt1> <a:dk2> <a:srgbClr val="1F497D"/> </a:dk2> <a:lt2> <a:srgbClr val="EEECE1"/> </a:lt2> <a:accent1> <a:srgbClr val="4F81BD"/> </a:accent1> <a:accent2> <a:srgbClr val="C0504D"/> </a:accent2> <a:accent3> <a:srgbClr val="9BBB59"/> </a:accent3> <a:accent4> <a:srgbClr val="8064A2"/> </a:accent4> <a:accent5> <a:srgbClr val="4BACC6"/> </a:accent5> <a:accent6> <a:srgbClr val="F79646"/> </a:accent6> <a:hlink> <a:srgbClr val="0000FF"/> </a:hlink> <a:folHlink> <a:srgbClr val="800080"/> </a:folHlink> </a:clrScheme> <a:fontScheme name="Office"> <a:majorFont> <a:latin typeface="Cambria"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Times New Roman"/> <a:font script="Hebr" typeface="Times New Roman"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="MoolBoran"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Times New Roman"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:majorFont> <a:minorFont> <a:latin typeface="Calibri"/> <a:ea typeface=""/> <a:cs typeface=""/> <a:font script="Jpan" typeface=" "/> <a:font script="Hang" typeface=" "/> <a:font script="Hans" typeface=""/> <a:font script="Hant" typeface=""/> <a:font script="Arab" typeface="Arial"/> <a:font script="Hebr" typeface="Arial"/> <a:font script="Thai" typeface="Tahoma"/> <a:font script="Ethi" typeface="Nyala"/> <a:font script="Beng" typeface="Vrinda"/> <a:font script="Gujr" typeface="Shruti"/> <a:font script="Khmr" typeface="DaunPenh"/> <a:font script="Knda" typeface="Tunga"/> <a:font script="Guru" typeface="Raavi"/> <a:font script="Cans" typeface="Euphemia"/> <a:font script="Cher" typeface="Plantagenet Cherokee"/> <a:font script="Yiii" typeface="Microsoft Yi Baiti"/> <a:font script="Tibt" typeface="Microsoft Himalaya"/> <a:font script="Thaa" typeface="MV Boli"/> <a:font script="Deva" typeface="Mangal"/> <a:font script="Telu" typeface="Gautami"/> <a:font script="Taml" typeface="Latha"/> <a:font script="Syrc" typeface="Estrangelo Edessa"/> <a:font script="Orya" typeface="Kalinga"/> <a:font script="Mlym" typeface="Kartika"/> <a:font script="Laoo" typeface="DokChampa"/> <a:font script="Sinh" typeface="Iskoola Pota"/> <a:font script="Mong" typeface="Mongolian Baiti"/> <a:font script="Viet" typeface="Arial"/> <a:font script="Uigh" typeface="Microsoft Uighur"/> <a:font script="Geor" typeface="Sylfaen"/> </a:minorFont> </a:fontScheme> <a:fmtScheme name="Office"> <a:fillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="35000"> <a:schemeClr val="phClr"> <a:tint val="37000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="15000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="1"/> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="100000"/> <a:shade val="100000"/> <a:satMod val="130000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:tint val="50000"/> <a:shade val="100000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:lin ang="16200000" scaled="0"/> </a:gradFill> </a:fillStyleLst> <a:lnStyleLst> <a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"> <a:shade val="95000"/> <a:satMod val="105000"/> </a:schemeClr> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> <a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:prstDash val="solid"/> </a:ln> </a:lnStyleLst> <a:effectStyleLst> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="38000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> </a:effectStyle> <a:effectStyle> <a:effectLst> <a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"> <a:srgbClr val="000000"> <a:alpha val="35000"/> </a:srgbClr> </a:outerShdw> </a:effectLst> <a:scene3d> <a:camera prst="orthographicFront"> <a:rot lat="0" lon="0" rev="0"/> </a:camera> <a:lightRig rig="threePt" dir="t"> <a:rot lat="0" lon="0" rev="1200000"/> </a:lightRig> </a:scene3d> <a:sp3d> <a:bevelT w="63500" h="25400"/> </a:sp3d> </a:effectStyle> </a:effectStyleLst> <a:bgFillStyleLst> <a:solidFill> <a:schemeClr val="phClr"/> </a:solidFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="40000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="40000"> <a:schemeClr val="phClr"> <a:tint val="45000"/> <a:shade val="99000"/> <a:satMod val="350000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="20000"/> <a:satMod val="255000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="-80000" r="50000" b="180000"/> </a:path> </a:gradFill> <a:gradFill rotWithShape="1"> <a:gsLst> <a:gs pos="0"> <a:schemeClr val="phClr"> <a:tint val="80000"/> <a:satMod val="300000"/> </a:schemeClr> </a:gs> <a:gs pos="100000"> <a:schemeClr val="phClr"> <a:shade val="30000"/> <a:satMod val="200000"/> </a:schemeClr> </a:gs> </a:gsLst> <a:path path="circle"> <a:fillToRect l="50000" t="50000" r="50000" b="50000"/> </a:path> </a:gradFill> </a:bgFillStyleLst> </a:fmtScheme> </a:themeElements> <a:objectDefaults> <a:spDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="1"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="3"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="2"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="lt1"/> </a:fontRef> </a:style> </a:spDef> <a:lnDef> <a:spPr/> <a:bodyPr/> <a:lstStyle/> <a:style> <a:lnRef idx="2"> <a:schemeClr val="accent1"/> </a:lnRef> <a:fillRef idx="0"> <a:schemeClr val="accent1"/> </a:fillRef> <a:effectRef idx="1"> <a:schemeClr val="accent1"/> </a:effectRef> <a:fontRef idx="minor"> <a:schemeClr val="tx1"/> </a:fontRef> </a:style> </a:lnDef> </a:objectDefaults> <a:extraClrSchemeLst/> </a:theme>`},{}],146:[function(r,n,i){(function(s){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.CsvFormatterStream=void 0;const o=r("stream"),a=r("./formatter");class l extends o.Transform{constructor(u){super({writableObjectMode:u.objectMode}),this.hasWrittenBOM=!1,this.formatterOptions=u,this.rowFormatter=new a.RowFormatter(u),this.hasWrittenBOM=!u.writeBOM}transform(u){return this.rowFormatter.rowTransform=u,this}_transform(u,h,d){let f=!1;try{this.hasWrittenBOM||(this.push(this.formatterOptions.BOM),this.hasWrittenBOM=!0),this.rowFormatter.format(u,(m,v)=>m?(f=!0,d(m)):(v&&v.forEach(g=>{this.push(s.from(g,"utf8"))}),f=!0,d()))}catch(m){if(f)throw m;d(m)}}_flush(u){this.rowFormatter.finish((h,d)=>h?u(h):(d&&d.forEach(f=>{this.push(s.from(f,"utf8"))}),u()))}}i.CsvFormatterStream=l}).call(this)}).call(this,r("buffer").Buffer)},{"./formatter":150,buffer:220,stream:505}],147:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FormatterOptions=void 0,i.FormatterOptions=class{constructor(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};var o;this.objectMode=!0,this.delimiter=",",this.rowDelimiter=`
`,this.quote='"',this.escape=this.quote,this.quoteColumns=!1,this.quoteHeaders=this.quoteColumns,this.headers=null,this.includeEndRowDelimiter=!1,this.writeBOM=!1,this.BOM="\uFEFF",this.alwaysWriteHeaders=!1,Object.assign(this,s||{}),s?.quoteHeaders===void 0&&(this.quoteHeaders=this.quoteColumns),s?.quote===!0?this.quote='"':s?.quote===!1&&(this.quote=""),typeof s?.escape!="string"&&(this.escape=this.quote),this.shouldWriteHeaders=!!this.headers&&((o=s.writeHeaders)===null||o===void 0||o),this.headers=Array.isArray(this.headers)?this.headers:null,this.escapedQuote=`${this.escape}${this.quote}`}}},{}],148:[function(r,n,i){var s=function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(i,"__esModule",{value:!0}),i.FieldFormatter=void 0;const o=s(r("lodash.isboolean")),a=s(r("lodash.isnil")),l=s(r("lodash.escaperegexp"));i.FieldFormatter=class{constructor(c){this._headers=null,this.formatterOptions=c,c.headers!==null&&(this.headers=c.headers),this.REPLACE_REGEXP=new RegExp(c.quote,"g");const u=`[${c.delimiter}${l.default(c.rowDelimiter)}|\r|
]`;this.ESCAPE_REGEXP=new RegExp(u)}set headers(c){this._headers=c}shouldQuote(c,u){const h=u?this.formatterOptions.quoteHeaders:this.formatterOptions.quoteColumns;return o.default(h)?h:Array.isArray(h)?h[c]:this._headers!==null&&h[this._headers[c]]}format(c,u,h){const d=(""+(a.default(c)?"":c)).replace(/\0/g,""),{formatterOptions:f}=this;return f.quote!==""&&d.indexOf(f.quote)!==-1?this.quoteField(d.replace(this.REPLACE_REGEXP,f.escapedQuote)):d.search(this.ESCAPE_REGEXP)!==-1||this.shouldQuote(u,h)?this.quoteField(d):d}quoteField(c){const{quote:u}=this.formatterOptions;return`${u}${c}${u}`}}},{"lodash.escaperegexp":442,"lodash.isboolean":444,"lodash.isnil":447}],149:[function(r,n,i){var s=function(h){return h&&h.__esModule?h:{default:h}};Object.defineProperty(i,"__esModule",{value:!0}),i.RowFormatter=void 0;const o=s(r("lodash.isfunction")),a=s(r("lodash.isequal")),l=r("./FieldFormatter"),c=r("../types");class u{constructor(d){this.rowCount=0,this.formatterOptions=d,this.fieldFormatter=new l.FieldFormatter(d),this.headers=d.headers,this.shouldWriteHeaders=d.shouldWriteHeaders,this.hasWrittenHeaders=!1,this.headers!==null&&(this.fieldFormatter.headers=this.headers),d.transform&&(this.rowTransform=d.transform)}static isRowHashArray(d){return!!Array.isArray(d)&&Array.isArray(d[0])&&d[0].length===2}static isRowArray(d){return Array.isArray(d)&&!this.isRowHashArray(d)}static gatherHeaders(d){return u.isRowHashArray(d)?d.map(f=>f[0]):Array.isArray(d)?d:Object.keys(d)}static createTransform(d){return c.isSyncTransform(d)?(f,m)=>{let v=null;try{v=d(f)}catch(g){return m(g)}return m(null,v)}:(f,m)=>{d(f,m)}}set rowTransform(d){if(!o.default(d))throw new TypeError("The transform should be a function");this._rowTransform=u.createTransform(d)}format(d,f){this.callTransformer(d,(m,v)=>{if(m)return f(m);if(!d)return f(null);const g=[];if(v){const{shouldFormatColumns:w,headers:y}=this.checkHeaders(v);if(this.shouldWriteHeaders&&y&&!this.hasWrittenHeaders&&(g.push(this.formatColumns(y,!0)),this.hasWrittenHeaders=!0),w){const C=this.gatherColumns(v);g.push(this.formatColumns(C,!1))}}return f(null,g)})}finish(d){const f=[];if(this.formatterOptions.alwaysWriteHeaders&&this.rowCount===0){if(!this.headers)return d(new Error("`alwaysWriteHeaders` option is set to true but `headers` option not provided."));f.push(this.formatColumns(this.headers,!0))}return this.formatterOptions.includeEndRowDelimiter&&f.push(this.formatterOptions.rowDelimiter),d(null,f)}checkHeaders(d){if(this.headers)return{shouldFormatColumns:!0,headers:this.headers};const f=u.gatherHeaders(d);return this.headers=f,this.fieldFormatter.headers=f,this.shouldWriteHeaders?{shouldFormatColumns:!a.default(f,d),headers:f}:{shouldFormatColumns:!0,headers:null}}gatherColumns(d){if(this.headers===null)throw new Error("Headers is currently null");return Array.isArray(d)?u.isRowHashArray(d)?this.headers.map((f,m)=>{const v=d[m];return v?v[1]:""}):u.isRowArray(d)&&!this.shouldWriteHeaders?d:this.headers.map((f,m)=>d[m]):this.headers.map(f=>d[f])}callTransformer(d,f){return this._rowTransform?this._rowTransform(d,f):f(null,d)}formatColumns(d,f){const m=d.map((g,w)=>this.fieldFormatter.format(g,w,f)).join(this.formatterOptions.delimiter),{rowCount:v}=this;return this.rowCount+=1,v?[this.formatterOptions.rowDelimiter,m].join(""):m}}i.RowFormatter=u},{"../types":152,"./FieldFormatter":148,"lodash.isequal":445,"lodash.isfunction":446}],150:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.FieldFormatter=i.RowFormatter=void 0;var s=r("./RowFormatter");Object.defineProperty(i,"RowFormatter",{enumerable:!0,get:function(){return s.RowFormatter}});var o=r("./FieldFormatter");Object.defineProperty(i,"FieldFormatter",{enumerable:!0,get:function(){return o.FieldFormatter}})},{"./FieldFormatter":148,"./RowFormatter":149}],151:[function(r,n,i){(function(s){(function(){var o=Object.create?function(w,y,C,k){k===void 0&&(k=C),Object.defineProperty(w,k,{enumerable:!0,get:function(){return y[C]}})}:function(w,y,C,k){k===void 0&&(k=C),w[k]=y[C]},a=Object.create?function(w,y){Object.defineProperty(w,"default",{enumerable:!0,value:y})}:function(w,y){w.default=y},l=function(w){if(w&&w.__esModule)return w;var y={};if(w!=null)for(var C in w)C!=="default"&&Object.prototype.hasOwnProperty.call(w,C)&&o(y,w,C);return a(y,w),y},c=function(w,y){for(var C in w)C==="default"||Object.prototype.hasOwnProperty.call(y,C)||o(y,w,C)};Object.defineProperty(i,"__esModule",{value:!0}),i.writeToPath=i.writeToString=i.writeToBuffer=i.writeToStream=i.write=i.format=i.FormatterOptions=i.CsvFormatterStream=void 0;const u=r("util"),h=r("stream"),d=l(r("fs")),f=r("./FormatterOptions"),m=r("./CsvFormatterStream");c(r("./types"),i);var v=r("./CsvFormatterStream");Object.defineProperty(i,"CsvFormatterStream",{enumerable:!0,get:function(){return v.CsvFormatterStream}});var g=r("./FormatterOptions");Object.defineProperty(i,"FormatterOptions",{enumerable:!0,get:function(){return g.FormatterOptions}}),i.format=w=>new m.CsvFormatterStream(new f.FormatterOptions(w)),i.write=(w,y)=>{const C=i.format(y),k=u.promisify((F,I)=>{C.write(F,void 0,I)});return w.reduce((F,I)=>F.then(()=>k(I)),Promise.resolve()).then(()=>C.end()).catch(F=>{C.emit("error",F)}),C},i.writeToStream=(w,y,C)=>i.write(y,C).pipe(w),i.writeToBuffer=function(w){let y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const C=[],k=new h.Writable({write(F,I,N){C.push(F),N()}});return new Promise((F,I)=>{k.on("error",I).on("finish",()=>F(s.concat(C))),i.write(w,y).pipe(k)})},i.writeToString=(w,y)=>i.writeToBuffer(w,y).then(C=>C.toString()),i.writeToPath=(w,y,C)=>{const k=d.createWriteStream(w,{encoding:"utf8"});return i.write(y,C).pipe(k)}}).call(this)}).call(this,r("buffer").Buffer)},{"./CsvFormatterStream":146,"./FormatterOptions":147,"./types":152,buffer:220,fs:216,stream:505,util:527}],152:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.isSyncTransform=void 0,i.isSyncTransform=s=>s.length===1},{}],153:[function(r,n,i){(function(s){(function(){Object.defineProperty(i,"__esModule",{value:!0}),i.CsvParserStream=void 0;const o=r("string_decoder"),a=r("stream"),l=r("./transforms"),c=r("./parser");class u extends a.Transform{constructor(d){super({objectMode:d.objectMode}),this.lines="",this.rowCount=0,this.parsedRowCount=0,this.parsedLineCount=0,this.endEmitted=!1,this.headersEmitted=!1,this.parserOptions=d,this.parser=new c.Parser(d),this.headerTransformer=new l.HeaderTransformer(d),this.decoder=new o.StringDecoder(d.encoding),this.rowTransformerValidator=new l.RowTransformerValidator}get hasHitRowLimit(){return this.parserOptions.limitRows&&this.rowCount>=this.parserOptions.maxRows}get shouldEmitRows(){return this.parsedRowCount>this.parserOptions.skipRows}get shouldSkipLine(){return this.parsedLineCount<=this.parserOptions.skipLines}transform(d){return this.rowTransformerValidator.rowTransform=d,this}validate(d){return this.rowTransformerValidator.rowValidator=d,this}emit(d){if(d==="end")return this.endEmitted||(this.endEmitted=!0,super.emit("end",this.rowCount)),!1;for(var f=arguments.length,m=new Array(f>1?f-1:0),v=1;v<f;v++)m[v-1]=arguments[v];return super.emit(d,...m)}_transform(d,f,m){if(this.hasHitRowLimit)return m();const v=u.wrapDoneCallback(m);try{const{lines:g}=this,w=g+this.decoder.write(d),y=this.parse(w,!0);return this.processRows(y,v)}catch(g){return v(g)}}_flush(d){const f=u.wrapDoneCallback(d);if(this.hasHitRowLimit)return f();try{const m=this.lines+this.decoder.end(),v=this.parse(m,!1);return this.processRows(v,f)}catch(m){return f(m)}}parse(d,f){if(!d)return[];const{line:m,rows:v}=this.parser.parse(d,f);return this.lines=m,v}processRows(d,f){const m=d.length,v=g=>{const w=k=>k?f(k):g%100!=0?v(g+1):void s(()=>v(g+1));if(this.checkAndEmitHeaders(),g>=m||this.hasHitRowLimit)return f();if(this.parsedLineCount+=1,this.shouldSkipLine)return w();const y=d[g];this.rowCount+=1,this.parsedRowCount+=1;const C=this.rowCount;return this.transformRow(y,(k,F)=>{if(k)return this.rowCount-=1,w(k);if(!F)return w(new Error("expected transform result"));if(F.isValid){if(F.row)return this.pushRow(F.row,w)}else this.emit("data-invalid",F.row,C,F.reason);return w()})};v(0)}transformRow(d,f){try{this.headerTransformer.transform(d,(m,v)=>m?f(m):v?v.isValid?v.row?this.shouldEmitRows?this.rowTransformerValidator.transformAndValidate(v.row,f):this.skipRow(f):(this.rowCount-=1,this.parsedRowCount-=1,f(null,{row:null,isValid:!0})):this.shouldEmitRows?f(null,{isValid:!1,row:d}):this.skipRow(f):f(new Error("Expected result from header transform")))}catch(m){f(m)}}checkAndEmitHeaders(){!this.headersEmitted&&this.headerTransformer.headers&&(this.headersEmitted=!0,this.emit("headers",this.headerTransformer.headers))}skipRow(d){return this.rowCount-=1,d(null,{row:null,isValid:!0})}pushRow(d,f){try{this.parserOptions.objectMode?this.push(d):this.push(JSON.stringify(d)),f()}catch(m){f(m)}}static wrapDoneCallback(d){let f=!1;return function(m){if(m){if(f)throw m;return f=!0,void d(m)}for(var v=arguments.length,g=new Array(v>1?v-1:0),w=1;w<v;w++)g[w-1]=arguments[w];d(...g)}}}i.CsvParserStream=u}).call(this)}).call(this,r("timers").setImmediate)},{"./parser":165,"./transforms":168,stream:505,string_decoder:218,timers:523}],154:[function(r,n,i){var s=function(l){return l&&l.__esModule?l:{default:l}};Object.defineProperty(i,"__esModule",{value:!0}),i.ParserOptions=void 0;const o=s(r("lodash.escaperegexp")),a=s(r("lodash.isnil"));i.ParserOptions=class{constructor(l){var c;if(this.objectMode=!0,this.delimiter=",",this.ignoreEmpty=!1,this.quote='"',this.escape=null,this.escapeChar=this.quote,this.comment=null,this.supportsComments=!1,this.ltrim=!1,this.rtrim=!1,this.trim=!1,this.headers=null,this.renameHeaders=!1,this.strictColumnHandling=!1,this.discardUnmappedColumns=!1,this.carriageReturn="\r",this.encoding="utf8",this.limitRows=!1,this.maxRows=0,this.skipLines=0,this.skipRows=0,Object.assign(this,l||{}),this.delimiter.length>1)throw new Error("delimiter option must be one character long");this.escapedDelimiter=o.default(this.delimiter),this.escapeChar=(c=this.escape)!==null&&c!==void 0?c:this.quote,this.supportsComments=!a.default(this.comment),this.NEXT_TOKEN_REGEXP=new RegExp(`([^\\s]|\\r\\n|\\n|\\r|${this.escapedDelimiter})`),this.maxRows>0&&(this.limitRows=!0)}}},{"lodash.escaperegexp":442,"lodash.isnil":447}],155:[function(r,n,i){var s=Object.create?function(v,g,w,y){y===void 0&&(y=w),Object.defineProperty(v,y,{enumerable:!0,get:function(){return g[w]}})}:function(v,g,w,y){y===void 0&&(y=w),v[y]=g[w]},o=Object.create?function(v,g){Object.defineProperty(v,"default",{enumerable:!0,value:g})}:function(v,g){v.default=g},a=function(v){if(v&&v.__esModule)return v;var g={};if(v!=null)for(var w in v)w!=="default"&&Object.prototype.hasOwnProperty.call(v,w)&&s(g,v,w);return o(g,v),g},l=function(v,g){for(var w in v)w==="default"||Object.prototype.hasOwnProperty.call(g,w)||s(g,v,w)};Object.defineProperty(i,"__esModule",{value:!0}),i.parseString=i.parseFile=i.parseStream=i.parse=i.ParserOptions=i.CsvParserStream=void 0;const c=a(r("fs")),u=r("stream"),h=r("./ParserOptions"),d=r("./CsvParserStream");l(r("./types"),i);var f=r("./CsvParserStream");Object.defineProperty(i,"CsvParserStream",{enumerable:!0,get:function(){return f.CsvParserStream}});var m=r("./ParserOptions");Object.defineProperty(i,"ParserOptions",{enumerable:!0,get:function(){return m.ParserOptions}}),i.parse=v=>new d.CsvParserStream(new h.ParserOptions(v)),i.parseStream=(v,g)=>v.pipe(new d.CsvParserStream(new h.ParserOptions(g))),i.parseFile=function(v){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return c.createReadStream(v).pipe(new d.CsvParserStream(new h.ParserOptions(g)))},i.parseString=(v,g)=>{const w=new u.Readable;return w.push(v),w.push(null),w.pipe(new d.CsvParserStream(new h.ParserOptions(g)))}},{"./CsvParserStream":153,"./ParserOptions":154,"./types":169,fs:216,stream:505}],156:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Parser=void 0;const s=r("./Scanner"),o=r("./RowParser"),a=r("./Token");class l{constructor(u){this.parserOptions=u,this.rowParser=new o.RowParser(this.parserOptions)}static removeBOM(u){return u&&u.charCodeAt(0)===65279?u.slice(1):u}parse(u,h){const d=new s.Scanner({line:l.removeBOM(u),parserOptions:this.parserOptions,hasMoreData:h});return this.parserOptions.supportsComments?this.parseWithComments(d):this.parseWithoutComments(d)}parseWithoutComments(u){const h=[];let d=!0;for(;d;)d=this.parseRow(u,h);return{line:u.line,rows:h}}parseWithComments(u){const{parserOptions:h}=this,d=[];for(let f=u.nextCharacterToken;f!==null;f=u.nextCharacterToken)if(a.Token.isTokenComment(f,h)){if(u.advancePastLine()===null)return{line:u.lineFromCursor,rows:d};if(!u.hasMoreCharacters)return{line:u.lineFromCursor,rows:d};u.truncateToCursor()}else if(!this.parseRow(u,d))break;return{line:u.line,rows:d}}parseRow(u,h){if(!u.nextNonSpaceToken)return!1;const d=this.rowParser.parse(u);return d!==null&&(this.parserOptions.ignoreEmpty&&o.RowParser.isEmptyRow(d)||h.push(d),!0)}}i.Parser=l},{"./RowParser":157,"./Scanner":158,"./Token":159}],157:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.RowParser=void 0;const s=r("./column"),o=r("./Token");i.RowParser=class{constructor(a){this.parserOptions=a,this.columnParser=new s.ColumnParser(a)}static isEmptyRow(a){return a.join("").replace(/\s+/g,"")===""}parse(a){const{parserOptions:l}=this,{hasMoreData:c}=a,u=a,h=[];let d=this.getStartToken(u,h);for(;d;){if(o.Token.isTokenRowDelimiter(d))return u.advancePastToken(d),!u.hasMoreCharacters&&o.Token.isTokenCarriageReturn(d,l)&&c?null:(u.truncateToCursor(),h);if(!this.shouldSkipColumnParse(u,d,h)){const f=this.columnParser.parse(u);if(f===null)return null;h.push(f)}d=u.nextNonSpaceToken}return c?null:(u.truncateToCursor(),h)}getStartToken(a,l){const c=a.nextNonSpaceToken;return c!==null&&o.Token.isTokenDelimiter(c,this.parserOptions)?(l.push(""),a.nextNonSpaceToken):c}shouldSkipColumnParse(a,l,c){const{parserOptions:u}=this;if(o.Token.isTokenDelimiter(l,u)){a.advancePastToken(l);const h=a.nextCharacterToken;if(!a.hasMoreCharacters||h!==null&&o.Token.isTokenRowDelimiter(h)||h!==null&&o.Token.isTokenDelimiter(h,u))return c.push(""),!0}return!1}}},{"./Token":159,"./column":164}],158:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Scanner=void 0;const s=r("./Token"),o=/((?:\r\n)|\n|\r)/;i.Scanner=class{constructor(a){this.cursor=0,this.line=a.line,this.lineLength=this.line.length,this.parserOptions=a.parserOptions,this.hasMoreData=a.hasMoreData,this.cursor=a.cursor||0}get hasMoreCharacters(){return this.lineLength>this.cursor}get nextNonSpaceToken(){const{lineFromCursor:a}=this,l=this.parserOptions.NEXT_TOKEN_REGEXP;if(a.search(l)===-1)return null;const c=l.exec(a);if(c==null)return null;const u=c[1],h=this.cursor+(c.index||0);return new s.Token({token:u,startCursor:h,endCursor:h+u.length-1})}get nextCharacterToken(){const{cursor:a,lineLength:l}=this;return l<=a?null:new s.Token({token:this.line[a],startCursor:a,endCursor:a})}get lineFromCursor(){return this.line.substr(this.cursor)}advancePastLine(){const a=o.exec(this.lineFromCursor);return a?(this.cursor+=(a.index||0)+a[0].length,this):this.hasMoreData?null:(this.cursor=this.lineLength,this)}advanceTo(a){return this.cursor=a,this}advanceToToken(a){return this.cursor=a.startCursor,this}advancePastToken(a){return this.cursor=a.endCursor+1,this}truncateToCursor(){return this.line=this.lineFromCursor,this.lineLength=this.line.length,this.cursor=0,this}}},{"./Token":159}],159:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.Token=void 0,i.Token=class{constructor(s){this.token=s.token,this.startCursor=s.startCursor,this.endCursor=s.endCursor}static isTokenRowDelimiter(s){const o=s.token;return o==="\r"||o===`
`||o===`\r
`}static isTokenCarriageReturn(s,o){return s.token===o.carriageReturn}static isTokenComment(s,o){return o.supportsComments&&!!s&&s.token===o.comment}static isTokenEscapeCharacter(s,o){return s.token===o.escapeChar}static isTokenQuote(s,o){return s.token===o.quote}static isTokenDelimiter(s,o){return s.token===o.delimiter}}},{}],160:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ColumnFormatter=void 0,i.ColumnFormatter=class{constructor(s){s.trim?this.format=o=>o.trim():s.ltrim?this.format=o=>o.trimLeft():s.rtrim?this.format=o=>o.trimRight():this.format=o=>o}}},{}],161:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ColumnParser=void 0;const s=r("./NonQuotedColumnParser"),o=r("./QuotedColumnParser"),a=r("../Token");i.ColumnParser=class{constructor(l){this.parserOptions=l,this.quotedColumnParser=new o.QuotedColumnParser(l),this.nonQuotedColumnParser=new s.NonQuotedColumnParser(l)}parse(l){const{nextNonSpaceToken:c}=l;return c!==null&&a.Token.isTokenQuote(c,this.parserOptions)?(l.advanceToToken(c),this.quotedColumnParser.parse(l)):this.nonQuotedColumnParser.parse(l)}}},{"../Token":159,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],162:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.NonQuotedColumnParser=void 0;const s=r("./ColumnFormatter"),o=r("../Token");i.NonQuotedColumnParser=class{constructor(a){this.parserOptions=a,this.columnFormatter=new s.ColumnFormatter(a)}parse(a){if(!a.hasMoreCharacters)return null;const{parserOptions:l}=this,c=[];let u=a.nextCharacterToken;for(;u&&!o.Token.isTokenDelimiter(u,l)&&!o.Token.isTokenRowDelimiter(u);u=a.nextCharacterToken)c.push(u.token),a.advancePastToken(u);return this.columnFormatter.format(c.join(""))}}},{"../Token":159,"./ColumnFormatter":160}],163:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.QuotedColumnParser=void 0;const s=r("./ColumnFormatter"),o=r("../Token");i.QuotedColumnParser=class{constructor(a){this.parserOptions=a,this.columnFormatter=new s.ColumnFormatter(a)}parse(a){if(!a.hasMoreCharacters)return null;const l=a.cursor,{foundClosingQuote:c,col:u}=this.gatherDataBetweenQuotes(a);if(!c){if(a.advanceTo(l),!a.hasMoreData)throw new Error(`Parse Error: missing closing: '${this.parserOptions.quote||""}' in line: at '${a.lineFromCursor.replace(/[\r\n]/g,"\\n'")}'`);return null}return this.checkForMalformedColumn(a),u}gatherDataBetweenQuotes(a){const{parserOptions:l}=this;let c=!1,u=!1;const h=[];let d=a.nextCharacterToken;for(;!u&&d!==null;d=a.nextCharacterToken){const f=o.Token.isTokenQuote(d,l);if(!c&&f)c=!0;else if(c)if(o.Token.isTokenEscapeCharacter(d,l)){a.advancePastToken(d);const m=a.nextCharacterToken;m!==null&&(o.Token.isTokenQuote(m,l)||o.Token.isTokenEscapeCharacter(m,l))?(h.push(m.token),d=m):f?u=!0:h.push(d.token)}else f?u=!0:h.push(d.token);a.advancePastToken(d)}return{col:this.columnFormatter.format(h.join("")),foundClosingQuote:u}}checkForMalformedColumn(a){const{parserOptions:l}=this,{nextNonSpaceToken:c}=a;if(c){const u=o.Token.isTokenDelimiter(c,l),h=o.Token.isTokenRowDelimiter(c);if(!u&&!h){const d=a.lineFromCursor.substr(0,10).replace(/[\r\n]/g,"\\n'");throw new Error(`Parse Error: expected: '${l.escapedDelimiter}' OR new line got: '${c.token}'. at '${d}`)}a.advanceToToken(c)}else a.hasMoreData||a.advancePastLine()}}},{"../Token":159,"./ColumnFormatter":160}],164:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.ColumnFormatter=i.QuotedColumnParser=i.NonQuotedColumnParser=i.ColumnParser=void 0;var s=r("./ColumnParser");Object.defineProperty(i,"ColumnParser",{enumerable:!0,get:function(){return s.ColumnParser}});var o=r("./NonQuotedColumnParser");Object.defineProperty(i,"NonQuotedColumnParser",{enumerable:!0,get:function(){return o.NonQuotedColumnParser}});var a=r("./QuotedColumnParser");Object.defineProperty(i,"QuotedColumnParser",{enumerable:!0,get:function(){return a.QuotedColumnParser}});var l=r("./ColumnFormatter");Object.defineProperty(i,"ColumnFormatter",{enumerable:!0,get:function(){return l.ColumnFormatter}})},{"./ColumnFormatter":160,"./ColumnParser":161,"./NonQuotedColumnParser":162,"./QuotedColumnParser":163}],165:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.QuotedColumnParser=i.NonQuotedColumnParser=i.ColumnParser=i.Token=i.Scanner=i.RowParser=i.Parser=void 0;var s=r("./Parser");Object.defineProperty(i,"Parser",{enumerable:!0,get:function(){return s.Parser}});var o=r("./RowParser");Object.defineProperty(i,"RowParser",{enumerable:!0,get:function(){return o.RowParser}});var a=r("./Scanner");Object.defineProperty(i,"Scanner",{enumerable:!0,get:function(){return a.Scanner}});var l=r("./Token");Object.defineProperty(i,"Token",{enumerable:!0,get:function(){return l.Token}});var c=r("./column");Object.defineProperty(i,"ColumnParser",{enumerable:!0,get:function(){return c.ColumnParser}}),Object.defineProperty(i,"NonQuotedColumnParser",{enumerable:!0,get:function(){return c.NonQuotedColumnParser}}),Object.defineProperty(i,"QuotedColumnParser",{enumerable:!0,get:function(){return c.QuotedColumnParser}})},{"./Parser":156,"./RowParser":157,"./Scanner":158,"./Token":159,"./column":164}],166:[function(r,n,i){var s=function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(i,"__esModule",{value:!0}),i.HeaderTransformer=void 0;const o=s(r("lodash.isundefined")),a=s(r("lodash.isfunction")),l=s(r("lodash.uniq")),c=s(r("lodash.groupby"));i.HeaderTransformer=class{constructor(u){this.headers=null,this.receivedHeaders=!1,this.shouldUseFirstRow=!1,this.processedFirstRow=!1,this.headersLength=0,this.parserOptions=u,u.headers===!0?this.shouldUseFirstRow=!0:Array.isArray(u.headers)?this.setHeaders(u.headers):a.default(u.headers)&&(this.headersTransform=u.headers)}transform(u,h){return this.shouldMapRow(u)?h(null,this.processRow(u)):h(null,{row:null,isValid:!0})}shouldMapRow(u){const{parserOptions:h}=this;if(!this.headersTransform&&h.renameHeaders&&!this.processedFirstRow){if(!this.receivedHeaders)throw new Error("Error renaming headers: new headers must be provided in an array");return this.processedFirstRow=!0,!1}if(!this.receivedHeaders&&Array.isArray(u)){if(this.headersTransform)this.setHeaders(this.headersTransform(u));else{if(!this.shouldUseFirstRow)return!0;this.setHeaders(u)}return!1}return!0}processRow(u){if(!this.headers)return{row:u,isValid:!0};const{parserOptions:h}=this;if(!h.discardUnmappedColumns&&u.length>this.headersLength){if(!h.strictColumnHandling)throw new Error(`Unexpected Error: column header mismatch expected: ${this.headersLength} columns got: ${u.length}`);return{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}}return h.strictColumnHandling&&u.length<this.headersLength?{row:u,isValid:!1,reason:`Column header mismatch expected: ${this.headersLength} columns got: ${u.length}`}:{row:this.mapHeaders(u),isValid:!0}}mapHeaders(u){const h={},{headers:d,headersLength:f}=this;for(let m=0;m<f;m+=1){const v=d[m];if(!o.default(v)){const g=u[m];o.default(g)?h[v]="":h[v]=g}}return h}setHeaders(u){var h;const d=u.filter(f=>!!f);if(l.default(d).length!==d.length){const f=c.default(d),m=Object.keys(f).filter(v=>f[v].length>1);throw new Error("Duplicate headers found "+JSON.stringify(m))}this.headers=u,this.receivedHeaders=!0,this.headersLength=((h=this.headers)===null||h===void 0?void 0:h.length)||0}}},{"lodash.groupby":443,"lodash.isfunction":446,"lodash.isundefined":448,"lodash.uniq":449}],167:[function(r,n,i){var s=function(c){return c&&c.__esModule?c:{default:c}};Object.defineProperty(i,"__esModule",{value:!0}),i.RowTransformerValidator=void 0;const o=s(r("lodash.isfunction")),a=r("../types");class l{constructor(){this._rowTransform=null,this._rowValidator=null}static createTransform(u){return a.isSyncTransform(u)?(h,d)=>{let f=null;try{f=u(h)}catch(m){return d(m)}return d(null,f)}:u}static createValidator(u){return a.isSyncValidate(u)?(h,d)=>{d(null,{row:h,isValid:u(h)})}:(h,d)=>{u(h,(f,m,v)=>f?d(f):d(null,m?{row:h,isValid:m,reason:v}:{row:h,isValid:!1,reason:v}))}}set rowTransform(u){if(!o.default(u))throw new TypeError("The transform should be a function");this._rowTransform=l.createTransform(u)}set rowValidator(u){if(!o.default(u))throw new TypeError("The validate should be a function");this._rowValidator=l.createValidator(u)}transformAndValidate(u,h){return this.callTransformer(u,(d,f)=>d?h(d):f?this.callValidator(f,(m,v)=>m?h(m):v&&!v.isValid?h(null,{row:f,isValid:!1,reason:v.reason}):h(null,{row:f,isValid:!0})):h(null,{row:null,isValid:!0}))}callTransformer(u,h){return this._rowTransform?this._rowTransform(u,h):h(null,u)}callValidator(u,h){return this._rowValidator?this._rowValidator(u,h):h(null,{row:u,isValid:!0})}}i.RowTransformerValidator=l},{"../types":169,"lodash.isfunction":446}],168:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.HeaderTransformer=i.RowTransformerValidator=void 0;var s=r("./RowTransformerValidator");Object.defineProperty(i,"RowTransformerValidator",{enumerable:!0,get:function(){return s.RowTransformerValidator}});var o=r("./HeaderTransformer");Object.defineProperty(i,"HeaderTransformer",{enumerable:!0,get:function(){return o.HeaderTransformer}})},{"./HeaderTransformer":166,"./RowTransformerValidator":167}],169:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.isSyncValidate=i.isSyncTransform=void 0,i.isSyncTransform=s=>s.length===1,i.isSyncValidate=s=>s.length===1},{}],170:[function(r,n,i){const s=i;s.bignum=r("bn.js"),s.define=r("./asn1/api").define,s.base=r("./asn1/base"),s.constants=r("./asn1/constants"),s.decoders=r("./asn1/decoders"),s.encoders=r("./asn1/encoders")},{"./asn1/api":171,"./asn1/base":173,"./asn1/constants":177,"./asn1/decoders":179,"./asn1/encoders":182,"bn.js":184}],171:[function(r,n,i){const s=r("./encoders"),o=r("./decoders"),a=r("inherits");function l(c,u){this.name=c,this.body=u,this.decoders={},this.encoders={}}i.define=function(c,u){return new l(c,u)},l.prototype._createNamed=function(c){const u=this.name;function h(d){this._initNamed(d,u)}return a(h,c),h.prototype._initNamed=function(d,f){c.call(this,d,f)},new h(this)},l.prototype._getDecoder=function(c){return c=c||"der",this.decoders.hasOwnProperty(c)||(this.decoders[c]=this._createNamed(o[c])),this.decoders[c]},l.prototype.decode=function(c,u,h){return this._getDecoder(u).decode(c,h)},l.prototype._getEncoder=function(c){return c=c||"der",this.encoders.hasOwnProperty(c)||(this.encoders[c]=this._createNamed(s[c])),this.encoders[c]},l.prototype.encode=function(c,u,h){return this._getEncoder(u).encode(c,h)}},{"./decoders":179,"./encoders":182,inherits:440}],172:[function(r,n,i){const s=r("inherits"),o=r("../base/reporter").Reporter,a=r("safer-buffer").Buffer;function l(u,h){o.call(this,h),a.isBuffer(u)?(this.base=u,this.offset=0,this.length=u.length):this.error("Input not Buffer")}function c(u,h){if(Array.isArray(u))this.length=0,this.value=u.map((function(d){return c.isEncoderBuffer(d)||(d=new c(d,h)),this.length+=d.length,d}),this);else if(typeof u=="number"){if(!(0<=u&&u<=255))return h.error("non-byte EncoderBuffer value");this.value=u,this.length=1}else if(typeof u=="string")this.value=u,this.length=a.byteLength(u);else{if(!a.isBuffer(u))return h.error("Unsupported type: "+typeof u);this.value=u,this.length=u.length}}s(l,o),i.DecoderBuffer=l,l.isDecoderBuffer=function(u){return u instanceof l?!0:typeof u=="object"&&a.isBuffer(u.base)&&u.constructor.name==="DecoderBuffer"&&typeof u.offset=="number"&&typeof u.length=="number"&&typeof u.save=="function"&&typeof u.restore=="function"&&typeof u.isEmpty=="function"&&typeof u.readUInt8=="function"&&typeof u.skip=="function"&&typeof u.raw=="function"},l.prototype.save=function(){return{offset:this.offset,reporter:o.prototype.save.call(this)}},l.prototype.restore=function(u){const h=new l(this.base);return h.offset=u.offset,h.length=this.offset,this.offset=u.offset,o.prototype.restore.call(this,u.reporter),h},l.prototype.isEmpty=function(){return this.offset===this.length},l.prototype.readUInt8=function(u){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(u||"DecoderBuffer overrun")},l.prototype.skip=function(u,h){if(!(this.offset+u<=this.length))return this.error(h||"DecoderBuffer overrun");const d=new l(this.base);return d._reporterState=this._reporterState,d.offset=this.offset,d.length=this.offset+u,this.offset+=u,d},l.prototype.raw=function(u){return this.base.slice(u?u.offset:this.offset,this.length)},i.EncoderBuffer=c,c.isEncoderBuffer=function(u){return u instanceof c?!0:typeof u=="object"&&u.constructor.name==="EncoderBuffer"&&typeof u.length=="number"&&typeof u.join=="function"},c.prototype.join=function(u,h){return u||(u=a.alloc(this.length)),h||(h=0),this.length===0||(Array.isArray(this.value)?this.value.forEach((function(d){d.join(u,h),h+=d.length})):(typeof this.value=="number"?u[h]=this.value:typeof this.value=="string"?u.write(this.value,h):a.isBuffer(this.value)&&this.value.copy(u,h),h+=this.length)),u}},{"../base/reporter":175,inherits:440,"safer-buffer":495}],173:[function(r,n,i){const s=i;s.Reporter=r("./reporter").Reporter,s.DecoderBuffer=r("./buffer").DecoderBuffer,s.EncoderBuffer=r("./buffer").EncoderBuffer,s.Node=r("./node")},{"./buffer":172,"./node":174,"./reporter":175}],174:[function(r,n,i){const s=r("../base/reporter").Reporter,o=r("../base/buffer").EncoderBuffer,a=r("../base/buffer").DecoderBuffer,l=r("minimalistic-assert"),c=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(c);function h(f,m,v){const g={};this._baseState=g,g.name=v,g.enc=f,g.parent=m||null,g.children=null,g.tag=null,g.args=null,g.reverseArgs=null,g.choice=null,g.optional=!1,g.any=!1,g.obj=!1,g.use=null,g.useDecoder=null,g.key=null,g.default=null,g.explicit=null,g.implicit=null,g.contains=null,g.parent||(g.children=[],this._wrap())}n.exports=h;const d=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];h.prototype.clone=function(){const f=this._baseState,m={};d.forEach((function(g){m[g]=f[g]}));const v=new this.constructor(m.parent);return v._baseState=m,v},h.prototype._wrap=function(){const f=this._baseState;u.forEach((function(m){this[m]=function(){const v=new this.constructor(this);return f.children.push(v),v[m].apply(v,arguments)}}),this)},h.prototype._init=function(f){const m=this._baseState;l(m.parent===null),f.call(this),m.children=m.children.filter((function(v){return v._baseState.parent===this}),this),l.equal(m.children.length,1,"Root node can have only one child")},h.prototype._useArgs=function(f){const m=this._baseState,v=f.filter((function(g){return g instanceof this.constructor}),this);f=f.filter((function(g){return!(g instanceof this.constructor)}),this),v.length!==0&&(l(m.children===null),m.children=v,v.forEach((function(g){g._baseState.parent=this}),this)),f.length!==0&&(l(m.args===null),m.args=f,m.reverseArgs=f.map((function(g){if(typeof g!="object"||g.constructor!==Object)return g;const w={};return Object.keys(g).forEach((function(y){y==(0|y)&&(y|=0);const C=g[y];w[C]=y})),w})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(f){h.prototype[f]=function(){const m=this._baseState;throw new Error(f+" not implemented for encoding: "+m.enc)}})),c.forEach((function(f){h.prototype[f]=function(){const m=this._baseState,v=Array.prototype.slice.call(arguments);return l(m.tag===null),m.tag=f,this._useArgs(v),this}})),h.prototype.use=function(f){l(f);const m=this._baseState;return l(m.use===null),m.use=f,this},h.prototype.optional=function(){return this._baseState.optional=!0,this},h.prototype.def=function(f){const m=this._baseState;return l(m.default===null),m.default=f,m.optional=!0,this},h.prototype.explicit=function(f){const m=this._baseState;return l(m.explicit===null&&m.implicit===null),m.explicit=f,this},h.prototype.implicit=function(f){const m=this._baseState;return l(m.explicit===null&&m.implicit===null),m.implicit=f,this},h.prototype.obj=function(){const f=this._baseState,m=Array.prototype.slice.call(arguments);return f.obj=!0,m.length!==0&&this._useArgs(m),this},h.prototype.key=function(f){const m=this._baseState;return l(m.key===null),m.key=f,this},h.prototype.any=function(){return this._baseState.any=!0,this},h.prototype.choice=function(f){const m=this._baseState;return l(m.choice===null),m.choice=f,this._useArgs(Object.keys(f).map((function(v){return f[v]}))),this},h.prototype.contains=function(f){const m=this._baseState;return l(m.use===null),m.contains=f,this},h.prototype._decode=function(f,m){const v=this._baseState;if(v.parent===null)return f.wrapResult(v.children[0]._decode(f,m));let g,w=v.default,y=!0,C=null;if(v.key!==null&&(C=f.enterKey(v.key)),v.optional){let k=null;if(v.explicit!==null?k=v.explicit:v.implicit!==null?k=v.implicit:v.tag!==null&&(k=v.tag),k!==null||v.any){if(y=this._peekTag(f,k,v.any),f.isError(y))return y}else{const F=f.save();try{v.choice===null?this._decodeGeneric(v.tag,f,m):this._decodeChoice(f,m),y=!0}catch{y=!1}f.restore(F)}}if(v.obj&&y&&(g=f.enterObject()),y){if(v.explicit!==null){const F=this._decodeTag(f,v.explicit);if(f.isError(F))return F;f=F}const k=f.offset;if(v.use===null&&v.choice===null){let F;v.any&&(F=f.save());const I=this._decodeTag(f,v.implicit!==null?v.implicit:v.tag,v.any);if(f.isError(I))return I;v.any?w=f.raw(F):f=I}if(m&&m.track&&v.tag!==null&&m.track(f.path(),k,f.length,"tagged"),m&&m.track&&v.tag!==null&&m.track(f.path(),f.offset,f.length,"content"),v.any||(w=v.choice===null?this._decodeGeneric(v.tag,f,m):this._decodeChoice(f,m)),f.isError(w))return w;if(v.any||v.choice!==null||v.children===null||v.children.forEach((function(F){F._decode(f,m)})),v.contains&&(v.tag==="octstr"||v.tag==="bitstr")){const F=new a(w);w=this._getUse(v.contains,f._reporterState.obj)._decode(F,m)}}return v.obj&&y&&(w=f.leaveObject(g)),v.key===null||w===null&&y!==!0?C!==null&&f.exitKey(C):f.leaveKey(C,v.key,w),w},h.prototype._decodeGeneric=function(f,m,v){const g=this._baseState;return f==="seq"||f==="set"?null:f==="seqof"||f==="setof"?this._decodeList(m,f,g.args[0],v):/str$/.test(f)?this._decodeStr(m,f,v):f==="objid"&&g.args?this._decodeObjid(m,g.args[0],g.args[1],v):f==="objid"?this._decodeObjid(m,null,null,v):f==="gentime"||f==="utctime"?this._decodeTime(m,f,v):f==="null_"?this._decodeNull(m,v):f==="bool"?this._decodeBool(m,v):f==="objDesc"?this._decodeStr(m,f,v):f==="int"||f==="enum"?this._decodeInt(m,g.args&&g.args[0],v):g.use!==null?this._getUse(g.use,m._reporterState.obj)._decode(m,v):m.error("unknown tag: "+f)},h.prototype._getUse=function(f,m){const v=this._baseState;return v.useDecoder=this._use(f,m),l(v.useDecoder._baseState.parent===null),v.useDecoder=v.useDecoder._baseState.children[0],v.implicit!==v.useDecoder._baseState.implicit&&(v.useDecoder=v.useDecoder.clone(),v.useDecoder._baseState.implicit=v.implicit),v.useDecoder},h.prototype._decodeChoice=function(f,m){const v=this._baseState;let g=null,w=!1;return Object.keys(v.choice).some((function(y){const C=f.save(),k=v.choice[y];try{const F=k._decode(f,m);if(f.isError(F))return!1;g={type:y,value:F},w=!0}catch{return f.restore(C),!1}return!0}),this),w?g:f.error("Choice not matched")},h.prototype._createEncoderBuffer=function(f){return new o(f,this.reporter)},h.prototype._encode=function(f,m,v){const g=this._baseState;if(g.default!==null&&g.default===f)return;const w=this._encodeValue(f,m,v);return w===void 0||this._skipDefault(w,m,v)?void 0:w},h.prototype._encodeValue=function(f,m,v){const g=this._baseState;if(g.parent===null)return g.children[0]._encode(f,m||new s);let w=null;if(this.reporter=m,g.optional&&f===void 0){if(g.default===null)return;f=g.default}let y=null,C=!1;if(g.any)w=this._createEncoderBuffer(f);else if(g.choice)w=this._encodeChoice(f,m);else if(g.contains)y=this._getUse(g.contains,v)._encode(f,m),C=!0;else if(g.children)y=g.children.map((function(k){if(k._baseState.tag==="null_")return k._encode(null,m,f);if(k._baseState.key===null)return m.error("Child should have a key");const F=m.enterKey(k._baseState.key);if(typeof f!="object")return m.error("Child expected, but input is not object");const I=k._encode(f[k._baseState.key],m,f);return m.leaveKey(F),I}),this).filter((function(k){return k})),y=this._createEncoderBuffer(y);else if(g.tag==="seqof"||g.tag==="setof"){if(!g.args||g.args.length!==1)return m.error("Too many args for : "+g.tag);if(!Array.isArray(f))return m.error("seqof/setof, but data is not Array");const k=this.clone();k._baseState.implicit=null,y=this._createEncoderBuffer(f.map((function(F){const I=this._baseState;return this._getUse(I.args[0],f)._encode(F,m)}),k))}else g.use!==null?w=this._getUse(g.use,v)._encode(f,m):(y=this._encodePrimitive(g.tag,f),C=!0);if(!g.any&&g.choice===null){const k=g.implicit!==null?g.implicit:g.tag,F=g.implicit===null?"universal":"context";k===null?g.use===null&&m.error("Tag could be omitted only for .use()"):g.use===null&&(w=this._encodeComposite(k,C,F,y))}return g.explicit!==null&&(w=this._encodeComposite(g.explicit,!1,"context",w)),w},h.prototype._encodeChoice=function(f,m){const v=this._baseState,g=v.choice[f.type];return g||l(!1,f.type+" not found in "+JSON.stringify(Object.keys(v.choice))),g._encode(f.value,m)},h.prototype._encodePrimitive=function(f,m){const v=this._baseState;if(/str$/.test(f))return this._encodeStr(m,f);if(f==="objid"&&v.args)return this._encodeObjid(m,v.reverseArgs[0],v.args[1]);if(f==="objid")return this._encodeObjid(m,null,null);if(f==="gentime"||f==="utctime")return this._encodeTime(m,f);if(f==="null_")return this._encodeNull();if(f==="int"||f==="enum")return this._encodeInt(m,v.args&&v.reverseArgs[0]);if(f==="bool")return this._encodeBool(m);if(f==="objDesc")return this._encodeStr(m,f);throw new Error("Unsupported tag: "+f)},h.prototype._isNumstr=function(f){return/^[0-9 ]*$/.test(f)},h.prototype._isPrintstr=function(f){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(f)}},{"../base/buffer":172,"../base/reporter":175,"minimalistic-assert":453}],175:[function(r,n,i){const s=r("inherits");function o(l){this._reporterState={obj:null,path:[],options:l||{},errors:[]}}function a(l,c){this.path=l,this.rethrow(c)}i.Reporter=o,o.prototype.isError=function(l){return l instanceof a},o.prototype.save=function(){const l=this._reporterState;return{obj:l.obj,pathLen:l.path.length}},o.prototype.restore=function(l){const c=this._reporterState;c.obj=l.obj,c.path=c.path.slice(0,l.pathLen)},o.prototype.enterKey=function(l){return this._reporterState.path.push(l)},o.prototype.exitKey=function(l){const c=this._reporterState;c.path=c.path.slice(0,l-1)},o.prototype.leaveKey=function(l,c,u){const h=this._reporterState;this.exitKey(l),h.obj!==null&&(h.obj[c]=u)},o.prototype.path=function(){return this._reporterState.path.join("/")},o.prototype.enterObject=function(){const l=this._reporterState,c=l.obj;return l.obj={},c},o.prototype.leaveObject=function(l){const c=this._reporterState,u=c.obj;return c.obj=l,u},o.prototype.error=function(l){let c;const u=this._reporterState,h=l instanceof a;if(c=h?l:new a(u.path.map((function(d){return"["+JSON.stringify(d)+"]"})).join(""),l.message||l,l.stack),!u.options.partial)throw c;return h||u.errors.push(c),c},o.prototype.wrapResult=function(l){const c=this._reporterState;return c.options.partial?{result:this.isError(l)?null:l,errors:c.errors}:l},s(a,Error),a.prototype.rethrow=function(l){if(this.message=l+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,a),!this.stack)try{throw new Error(this.message)}catch(c){this.stack=c.stack}return this}},{inherits:440}],176:[function(r,n,i){function s(o){const a={};return Object.keys(o).forEach((function(l){(0|l)==l&&(l|=0);const c=o[l];a[c]=l})),a}i.tagClass={0:"universal",1:"application",2:"context",3:"private"},i.tagClassByName=s(i.tagClass),i.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"},i.tagByName=s(i.tag)},{}],177:[function(r,n,i){const s=i;s._reverse=function(o){const a={};return Object.keys(o).forEach((function(l){(0|l)==l&&(l|=0);const c=o[l];a[c]=l})),a},s.der=r("./der")},{"./der":176}],178:[function(r,n,i){const s=r("inherits"),o=r("bn.js"),a=r("../base/buffer").DecoderBuffer,l=r("../base/node"),c=r("../constants/der");function u(m){this.enc="der",this.name=m.name,this.entity=m,this.tree=new h,this.tree._init(m.body)}function h(m){l.call(this,"der",m)}function d(m,v){let g=m.readUInt8(v);if(m.isError(g))return g;const w=c.tagClass[g>>6],y=(32&g)==0;if((31&g)==31){let C=g;for(g=0;(128&C)==128;){if(C=m.readUInt8(v),m.isError(C))return C;g<<=7,g|=127&C}}else g&=31;return{cls:w,primitive:y,tag:g,tagStr:c.tag[g]}}function f(m,v,g){let w=m.readUInt8(g);if(m.isError(w))return w;if(!v&&w===128)return null;if((128&w)==0)return w;const y=127&w;if(y>4)return m.error("length octect is too long");w=0;for(let C=0;C<y;C++){w<<=8;const k=m.readUInt8(g);if(m.isError(k))return k;w|=k}return w}n.exports=u,u.prototype.decode=function(m,v){return a.isDecoderBuffer(m)||(m=new a(m,v)),this.tree._decode(m,v)},s(h,l),h.prototype._peekTag=function(m,v,g){if(m.isEmpty())return!1;const w=m.save(),y=d(m,'Failed to peek tag: "'+v+'"');return m.isError(y)?y:(m.restore(w),y.tag===v||y.tagStr===v||y.tagStr+"of"===v||g)},h.prototype._decodeTag=function(m,v,g){const w=d(m,'Failed to decode tag of "'+v+'"');if(m.isError(w))return w;let y=f(m,w.primitive,'Failed to get length of "'+v+'"');if(m.isError(y))return y;if(!g&&w.tag!==v&&w.tagStr!==v&&w.tagStr+"of"!==v)return m.error('Failed to match tag: "'+v+'"');if(w.primitive||y!==null)return m.skip(y,'Failed to match body of: "'+v+'"');const C=m.save(),k=this._skipUntilEnd(m,'Failed to skip indefinite length body: "'+this.tag+'"');return m.isError(k)?k:(y=m.offset-C.offset,m.restore(C),m.skip(y,'Failed to match body of: "'+v+'"'))},h.prototype._skipUntilEnd=function(m,v){for(;;){const g=d(m,v);if(m.isError(g))return g;const w=f(m,g.primitive,v);if(m.isError(w))return w;let y;if(y=g.primitive||w!==null?m.skip(w):this._skipUntilEnd(m,v),m.isError(y))return y;if(g.tagStr==="end")break}},h.prototype._decodeList=function(m,v,g,w){const y=[];for(;!m.isEmpty();){const C=this._peekTag(m,"end");if(m.isError(C))return C;const k=g.decode(m,"der",w);if(m.isError(k)&&C)break;y.push(k)}return y},h.prototype._decodeStr=function(m,v){if(v==="bitstr"){const g=m.readUInt8();return m.isError(g)?g:{unused:g,data:m.raw()}}if(v==="bmpstr"){const g=m.raw();if(g.length%2==1)return m.error("Decoding of string type: bmpstr length mismatch");let w="";for(let y=0;y<g.length/2;y++)w+=String.fromCharCode(g.readUInt16BE(2*y));return w}if(v==="numstr"){const g=m.raw().toString("ascii");return this._isNumstr(g)?g:m.error("Decoding of string type: numstr unsupported characters")}if(v==="octstr"||v==="objDesc")return m.raw();if(v==="printstr"){const g=m.raw().toString("ascii");return this._isPrintstr(g)?g:m.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(v)?m.raw().toString():m.error("Decoding of string type: "+v+" unsupported")},h.prototype._decodeObjid=function(m,v,g){let w;const y=[];let C=0,k=0;for(;!m.isEmpty();)k=m.readUInt8(),C<<=7,C|=127&k,(128&k)==0&&(y.push(C),C=0);128&k&&y.push(C);const F=y[0]/40|0,I=y[0]%40;if(w=g?y:[F,I].concat(y.slice(1)),v){let N=v[w.join(" ")];N===void 0&&(N=v[w.join(".")]),N!==void 0&&(w=N)}return w},h.prototype._decodeTime=function(m,v){const g=m.raw().toString();let w,y,C,k,F,I;if(v==="gentime")w=0|g.slice(0,4),y=0|g.slice(4,6),C=0|g.slice(6,8),k=0|g.slice(8,10),F=0|g.slice(10,12),I=0|g.slice(12,14);else{if(v!=="utctime")return m.error("Decoding "+v+" time is not supported yet");w=0|g.slice(0,2),y=0|g.slice(2,4),C=0|g.slice(4,6),k=0|g.slice(6,8),F=0|g.slice(8,10),I=0|g.slice(10,12),w=w<70?2e3+w:1900+w}return Date.UTC(w,y-1,C,k,F,I,0)},h.prototype._decodeNull=function(){return null},h.prototype._decodeBool=function(m){const v=m.readUInt8();return m.isError(v)?v:v!==0},h.prototype._decodeInt=function(m,v){const g=m.raw();let w=new o(g);return v&&(w=v[w.toString(10)]||w),w},h.prototype._use=function(m,v){return typeof m=="function"&&(m=m(v)),m._getDecoder("der").tree}},{"../base/buffer":172,"../base/node":174,"../constants/der":176,"bn.js":184,inherits:440}],179:[function(r,n,i){const s=i;s.der=r("./der"),s.pem=r("./pem")},{"./der":178,"./pem":180}],180:[function(r,n,i){const s=r("inherits"),o=r("safer-buffer").Buffer,a=r("./der");function l(c){a.call(this,c),this.enc="pem"}s(l,a),n.exports=l,l.prototype.decode=function(c,u){const h=c.toString().split(/[\r\n]+/g),d=u.label.toUpperCase(),f=/^-----(BEGIN|END) ([^-]+)-----$/;let m=-1,v=-1;for(let y=0;y<h.length;y++){const C=h[y].match(f);if(C!==null&&C[2]===d){if(m!==-1){if(C[1]!=="END")break;v=y;break}if(C[1]!=="BEGIN")break;m=y}}if(m===-1||v===-1)throw new Error("PEM section not found for: "+d);const g=h.slice(m+1,v).join("");g.replace(/[^a-z0-9+/=]+/gi,"");const w=o.from(g,"base64");return a.prototype.decode.call(this,w,u)}},{"./der":178,inherits:440,"safer-buffer":495}],181:[function(r,n,i){const s=r("inherits"),o=r("safer-buffer").Buffer,a=r("../base/node"),l=r("../constants/der");function c(d){this.enc="der",this.name=d.name,this.entity=d,this.tree=new u,this.tree._init(d.body)}function u(d){a.call(this,"der",d)}function h(d){return d<10?"0"+d:d}n.exports=c,c.prototype.encode=function(d,f){return this.tree._encode(d,f).join()},s(u,a),u.prototype._encodeComposite=function(d,f,m,v){const g=(function(C,k,F,I){let N;if(C==="seqof"?C="seq":C==="setof"&&(C="set"),l.tagByName.hasOwnProperty(C))N=l.tagByName[C];else{if(typeof C!="number"||(0|C)!==C)return I.error("Unknown tag: "+C);N=C}return N>=31?I.error("Multi-octet tag encoding unsupported"):(k||(N|=32),N|=l.tagClassByName[F||"universal"]<<6,N)})(d,f,m,this.reporter);if(v.length<128){const C=o.alloc(2);return C[0]=g,C[1]=v.length,this._createEncoderBuffer([C,v])}let w=1;for(let C=v.length;C>=256;C>>=8)w++;const y=o.alloc(2+w);y[0]=g,y[1]=128|w;for(let C=1+w,k=v.length;k>0;C--,k>>=8)y[C]=255&k;return this._createEncoderBuffer([y,v])},u.prototype._encodeStr=function(d,f){if(f==="bitstr")return this._createEncoderBuffer([0|d.unused,d.data]);if(f==="bmpstr"){const m=o.alloc(2*d.length);for(let v=0;v<d.length;v++)m.writeUInt16BE(d.charCodeAt(v),2*v);return this._createEncoderBuffer(m)}return f==="numstr"?this._isNumstr(d)?this._createEncoderBuffer(d):this.reporter.error("Encoding of string type: numstr supports only digits and space"):f==="printstr"?this._isPrintstr(d)?this._createEncoderBuffer(d):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(f)||f==="objDesc"?this._createEncoderBuffer(d):this.reporter.error("Encoding of string type: "+f+" unsupported")},u.prototype._encodeObjid=function(d,f,m){if(typeof d=="string"){if(!f)return this.reporter.error("string objid given, but no values map found");if(!f.hasOwnProperty(d))return this.reporter.error("objid not found in values map");d=f[d].split(/[\s.]+/g);for(let y=0;y<d.length;y++)d[y]|=0}else if(Array.isArray(d)){d=d.slice();for(let y=0;y<d.length;y++)d[y]|=0}if(!Array.isArray(d))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(d));if(!m){if(d[1]>=40)return this.reporter.error("Second objid identifier OOB");d.splice(0,2,40*d[0]+d[1])}let v=0;for(let y=0;y<d.length;y++){let C=d[y];for(v++;C>=128;C>>=7)v++}const g=o.alloc(v);let w=g.length-1;for(let y=d.length-1;y>=0;y--){let C=d[y];for(g[w--]=127&C;(C>>=7)>0;)g[w--]=128|127&C}return this._createEncoderBuffer(g)},u.prototype._encodeTime=function(d,f){let m;const v=new Date(d);return f==="gentime"?m=[h(v.getUTCFullYear()),h(v.getUTCMonth()+1),h(v.getUTCDate()),h(v.getUTCHours()),h(v.getUTCMinutes()),h(v.getUTCSeconds()),"Z"].join(""):f==="utctime"?m=[h(v.getUTCFullYear()%100),h(v.getUTCMonth()+1),h(v.getUTCDate()),h(v.getUTCHours()),h(v.getUTCMinutes()),h(v.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+f+" time is not supported yet"),this._encodeStr(m,"octstr")},u.prototype._encodeNull=function(){return this._createEncoderBuffer("")},u.prototype._encodeInt=function(d,f){if(typeof d=="string"){if(!f)return this.reporter.error("String int or enum given, but no values map");if(!f.hasOwnProperty(d))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(d));d=f[d]}if(typeof d!="number"&&!o.isBuffer(d)){const g=d.toArray();!d.sign&&128&g[0]&&g.unshift(0),d=o.from(g)}if(o.isBuffer(d)){let g=d.length;d.length===0&&g++;const w=o.alloc(g);return d.copy(w),d.length===0&&(w[0]=0),this._createEncoderBuffer(w)}if(d<128)return this._createEncoderBuffer(d);if(d<256)return this._createEncoderBuffer([0,d]);let m=1;for(let g=d;g>=256;g>>=8)m++;const v=new Array(m);for(let g=v.length-1;g>=0;g--)v[g]=255&d,d>>=8;return 128&v[0]&&v.unshift(0),this._createEncoderBuffer(o.from(v))},u.prototype._encodeBool=function(d){return this._createEncoderBuffer(d?255:0)},u.prototype._use=function(d,f){return typeof d=="function"&&(d=d(f)),d._getEncoder("der").tree},u.prototype._skipDefault=function(d,f,m){const v=this._baseState;let g;if(v.default===null)return!1;const w=d.join();if(v.defaultBuffer===void 0&&(v.defaultBuffer=this._encodeValue(v.default,f,m).join()),w.length!==v.defaultBuffer.length)return!1;for(g=0;g<w.length;g++)if(w[g]!==v.defaultBuffer[g])return!1;return!0}},{"../base/node":174,"../constants/der":176,inherits:440,"safer-buffer":495}],182:[function(r,n,i){const s=i;s.der=r("./der"),s.pem=r("./pem")},{"./der":181,"./pem":183}],183:[function(r,n,i){const s=r("inherits"),o=r("./der");function a(l){o.call(this,l),this.enc="pem"}s(a,o),n.exports=a,a.prototype.encode=function(l,c){const u=o.prototype.encode.call(this,l).toString("base64"),h=["-----BEGIN "+c.label+"-----"];for(let d=0;d<u.length;d+=64)h.push(u.slice(d,d+64));return h.push("-----END "+c.label+"-----"),h.join(`
`)}},{"./der":181,inherits:440}],184:[function(r,n,i){(function(s,o){function a(M,B){if(!M)throw new Error(B||"Assertion failed")}function l(M,B){M.super_=B;var R=function(){};R.prototype=B.prototype,M.prototype=new R,M.prototype.constructor=M}function c(M,B,R){if(c.isBN(M))return M;this.negative=0,this.words=null,this.length=0,this.red=null,M!==null&&(B!=="le"&&B!=="be"||(R=B,B=10),this._init(M||0,B||10,R||"be"))}var u;typeof s=="object"?s.exports=c:(void 0).BN=c,c.BN=c,c.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:r("buffer").Buffer}catch{}function h(M,B){var R=M.charCodeAt(B);return R>=65&&R<=70?R-55:R>=97&&R<=102?R-87:R-48&15}function d(M,B,R){var S=h(M,R);return R-1>=B&&(S|=h(M,R-1)<<4),S}function f(M,B,R,S){for(var _=0,T=Math.min(M.length,R),E=B;E<T;E++){var D=M.charCodeAt(E)-48;_*=S,_+=D>=49?D-49+10:D>=17?D-17+10:D}return _}c.isBN=function(M){return M instanceof c||M!==null&&typeof M=="object"&&M.constructor.wordSize===c.wordSize&&Array.isArray(M.words)},c.max=function(M,B){return M.cmp(B)>0?M:B},c.min=function(M,B){return M.cmp(B)<0?M:B},c.prototype._init=function(M,B,R){if(typeof M=="number")return this._initNumber(M,B,R);if(typeof M=="object")return this._initArray(M,B,R);B==="hex"&&(B=16),a(B===(0|B)&&B>=2&&B<=36);var S=0;(M=M.toString().replace(/\s+/g,""))[0]==="-"&&(S++,this.negative=1),S<M.length&&(B===16?this._parseHex(M,S,R):(this._parseBase(M,B,S),R==="le"&&this._initArray(this.toArray(),B,R)))},c.prototype._initNumber=function(M,B,R){M<0&&(this.negative=1,M=-M),M<67108864?(this.words=[67108863&M],this.length=1):M<4503599627370496?(this.words=[67108863&M,M/67108864&67108863],this.length=2):(a(M<9007199254740992),this.words=[67108863&M,M/67108864&67108863,1],this.length=3),R==="le"&&this._initArray(this.toArray(),B,R)},c.prototype._initArray=function(M,B,R){if(a(typeof M.length=="number"),M.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(M.length/3),this.words=new Array(this.length);for(var S=0;S<this.length;S++)this.words[S]=0;var _,T,E=0;if(R==="be")for(S=M.length-1,_=0;S>=0;S-=3)T=M[S]|M[S-1]<<8|M[S-2]<<16,this.words[_]|=T<<E&67108863,this.words[_+1]=T>>>26-E&67108863,(E+=24)>=26&&(E-=26,_++);else if(R==="le")for(S=0,_=0;S<M.length;S+=3)T=M[S]|M[S+1]<<8|M[S+2]<<16,this.words[_]|=T<<E&67108863,this.words[_+1]=T>>>26-E&67108863,(E+=24)>=26&&(E-=26,_++);return this.strip()},c.prototype._parseHex=function(M,B,R){this.length=Math.ceil((M.length-B)/6),this.words=new Array(this.length);for(var S=0;S<this.length;S++)this.words[S]=0;var _,T=0,E=0;if(R==="be")for(S=M.length-1;S>=B;S-=2)_=d(M,B,S)<<T,this.words[E]|=67108863&_,T>=18?(T-=18,E+=1,this.words[E]|=_>>>26):T+=8;else for(S=(M.length-B)%2==0?B+1:B;S<M.length;S+=2)_=d(M,B,S)<<T,this.words[E]|=67108863&_,T>=18?(T-=18,E+=1,this.words[E]|=_>>>26):T+=8;this.strip()},c.prototype._parseBase=function(M,B,R){this.words=[0],this.length=1;for(var S=0,_=1;_<=67108863;_*=B)S++;S--,_=_/B|0;for(var T=M.length-R,E=T%S,D=Math.min(T,T-E)+R,O=0,P=R;P<D;P+=S)O=f(M,P,P+S,B),this.imuln(_),this.words[0]+O<67108864?this.words[0]+=O:this._iaddn(O);if(E!==0){var q=1;for(O=f(M,P,M.length,B),P=0;P<E;P++)q*=B;this.imuln(q),this.words[0]+O<67108864?this.words[0]+=O:this._iaddn(O)}this.strip()},c.prototype.copy=function(M){M.words=new Array(this.length);for(var B=0;B<this.length;B++)M.words[B]=this.words[B];M.length=this.length,M.negative=this.negative,M.red=this.red},c.prototype.clone=function(){var M=new c(null);return this.copy(M),M},c.prototype._expand=function(M){for(;this.length<M;)this.words[this.length++]=0;return this},c.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},c.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},c.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var m=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],g=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function w(M,B,R){R.negative=B.negative^M.negative;var S=M.length+B.length|0;R.length=S,S=S-1|0;var _=0|M.words[0],T=0|B.words[0],E=_*T,D=67108863&E,O=E/67108864|0;R.words[0]=D;for(var P=1;P<S;P++){for(var q=O>>>26,X=67108863&O,Q=Math.min(P,B.length-1),G=Math.max(0,P-M.length+1);G<=Q;G++){var ee=P-G|0;q+=(E=(_=0|M.words[ee])*(T=0|B.words[G])+X)/67108864|0,X=67108863&E}R.words[P]=0|X,O=0|q}return O!==0?R.words[P]=0|O:R.length--,R.strip()}c.prototype.toString=function(M,B){var R;if(B=0|B||1,(M=M||10)===16||M==="hex"){R="";for(var S=0,_=0,T=0;T<this.length;T++){var E=this.words[T],D=(16777215&(E<<S|_)).toString(16);R=(_=E>>>24-S&16777215)!==0||T!==this.length-1?m[6-D.length]+D+R:D+R,(S+=2)>=26&&(S-=26,T--)}for(_!==0&&(R=_.toString(16)+R);R.length%B!=0;)R="0"+R;return this.negative!==0&&(R="-"+R),R}if(M===(0|M)&&M>=2&&M<=36){var O=v[M],P=g[M];R="";var q=this.clone();for(q.negative=0;!q.isZero();){var X=q.modn(P).toString(M);R=(q=q.idivn(P)).isZero()?X+R:m[O-X.length]+X+R}for(this.isZero()&&(R="0"+R);R.length%B!=0;)R="0"+R;return this.negative!==0&&(R="-"+R),R}a(!1,"Base should be between 2 and 36")},c.prototype.toNumber=function(){var M=this.words[0];return this.length===2?M+=67108864*this.words[1]:this.length===3&&this.words[2]===1?M+=4503599627370496+67108864*this.words[1]:this.length>2&&a(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-M:M},c.prototype.toJSON=function(){return this.toString(16)},c.prototype.toBuffer=function(M,B){return a(u!==void 0),this.toArrayLike(u,M,B)},c.prototype.toArray=function(M,B){return this.toArrayLike(Array,M,B)},c.prototype.toArrayLike=function(M,B,R){var S=this.byteLength(),_=R||Math.max(1,S);a(S<=_,"byte array longer than desired length"),a(_>0,"Requested array length <= 0"),this.strip();var T,E,D=B==="le",O=new M(_),P=this.clone();if(D){for(E=0;!P.isZero();E++)T=P.andln(255),P.iushrn(8),O[E]=T;for(;E<_;E++)O[E]=0}else{for(E=0;E<_-S;E++)O[E]=0;for(E=0;!P.isZero();E++)T=P.andln(255),P.iushrn(8),O[_-E-1]=T}return O},Math.clz32?c.prototype._countBits=function(M){return 32-Math.clz32(M)}:c.prototype._countBits=function(M){var B=M,R=0;return B>=4096&&(R+=13,B>>>=13),B>=64&&(R+=7,B>>>=7),B>=8&&(R+=4,B>>>=4),B>=2&&(R+=2,B>>>=2),R+B},c.prototype._zeroBits=function(M){if(M===0)return 26;var B=M,R=0;return(8191&B)==0&&(R+=13,B>>>=13),(127&B)==0&&(R+=7,B>>>=7),(15&B)==0&&(R+=4,B>>>=4),(3&B)==0&&(R+=2,B>>>=2),(1&B)==0&&R++,R},c.prototype.bitLength=function(){var M=this.words[this.length-1],B=this._countBits(M);return 26*(this.length-1)+B},c.prototype.zeroBits=function(){if(this.isZero())return 0;for(var M=0,B=0;B<this.length;B++){var R=this._zeroBits(this.words[B]);if(M+=R,R!==26)break}return M},c.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},c.prototype.toTwos=function(M){return this.negative!==0?this.abs().inotn(M).iaddn(1):this.clone()},c.prototype.fromTwos=function(M){return this.testn(M-1)?this.notn(M).iaddn(1).ineg():this.clone()},c.prototype.isNeg=function(){return this.negative!==0},c.prototype.neg=function(){return this.clone().ineg()},c.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},c.prototype.iuor=function(M){for(;this.length<M.length;)this.words[this.length++]=0;for(var B=0;B<M.length;B++)this.words[B]=this.words[B]|M.words[B];return this.strip()},c.prototype.ior=function(M){return a((this.negative|M.negative)==0),this.iuor(M)},c.prototype.or=function(M){return this.length>M.length?this.clone().ior(M):M.clone().ior(this)},c.prototype.uor=function(M){return this.length>M.length?this.clone().iuor(M):M.clone().iuor(this)},c.prototype.iuand=function(M){var B;B=this.length>M.length?M:this;for(var R=0;R<B.length;R++)this.words[R]=this.words[R]&M.words[R];return this.length=B.length,this.strip()},c.prototype.iand=function(M){return a((this.negative|M.negative)==0),this.iuand(M)},c.prototype.and=function(M){return this.length>M.length?this.clone().iand(M):M.clone().iand(this)},c.prototype.uand=function(M){return this.length>M.length?this.clone().iuand(M):M.clone().iuand(this)},c.prototype.iuxor=function(M){var B,R;this.length>M.length?(B=this,R=M):(B=M,R=this);for(var S=0;S<R.length;S++)this.words[S]=B.words[S]^R.words[S];if(this!==B)for(;S<B.length;S++)this.words[S]=B.words[S];return this.length=B.length,this.strip()},c.prototype.ixor=function(M){return a((this.negative|M.negative)==0),this.iuxor(M)},c.prototype.xor=function(M){return this.length>M.length?this.clone().ixor(M):M.clone().ixor(this)},c.prototype.uxor=function(M){return this.length>M.length?this.clone().iuxor(M):M.clone().iuxor(this)},c.prototype.inotn=function(M){a(typeof M=="number"&&M>=0);var B=0|Math.ceil(M/26),R=M%26;this._expand(B),R>0&&B--;for(var S=0;S<B;S++)this.words[S]=67108863&~this.words[S];return R>0&&(this.words[S]=~this.words[S]&67108863>>26-R),this.strip()},c.prototype.notn=function(M){return this.clone().inotn(M)},c.prototype.setn=function(M,B){a(typeof M=="number"&&M>=0);var R=M/26|0,S=M%26;return this._expand(R+1),this.words[R]=B?this.words[R]|1<<S:this.words[R]&~(1<<S),this.strip()},c.prototype.iadd=function(M){var B,R,S;if(this.negative!==0&&M.negative===0)return this.negative=0,B=this.isub(M),this.negative^=1,this._normSign();if(this.negative===0&&M.negative!==0)return M.negative=0,B=this.isub(M),M.negative=1,B._normSign();this.length>M.length?(R=this,S=M):(R=M,S=this);for(var _=0,T=0;T<S.length;T++)B=(0|R.words[T])+(0|S.words[T])+_,this.words[T]=67108863&B,_=B>>>26;for(;_!==0&&T<R.length;T++)B=(0|R.words[T])+_,this.words[T]=67108863&B,_=B>>>26;if(this.length=R.length,_!==0)this.words[this.length]=_,this.length++;else if(R!==this)for(;T<R.length;T++)this.words[T]=R.words[T];return this},c.prototype.add=function(M){var B;return M.negative!==0&&this.negative===0?(M.negative=0,B=this.sub(M),M.negative^=1,B):M.negative===0&&this.negative!==0?(this.negative=0,B=M.sub(this),this.negative=1,B):this.length>M.length?this.clone().iadd(M):M.clone().iadd(this)},c.prototype.isub=function(M){if(M.negative!==0){M.negative=0;var B=this.iadd(M);return M.negative=1,B._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(M),this.negative=1,this._normSign();var R,S,_=this.cmp(M);if(_===0)return this.negative=0,this.length=1,this.words[0]=0,this;_>0?(R=this,S=M):(R=M,S=this);for(var T=0,E=0;E<S.length;E++)T=(B=(0|R.words[E])-(0|S.words[E])+T)>>26,this.words[E]=67108863&B;for(;T!==0&&E<R.length;E++)T=(B=(0|R.words[E])+T)>>26,this.words[E]=67108863&B;if(T===0&&E<R.length&&R!==this)for(;E<R.length;E++)this.words[E]=R.words[E];return this.length=Math.max(this.length,E),R!==this&&(this.negative=1),this.strip()},c.prototype.sub=function(M){return this.clone().isub(M)};var y=function(M,B,R){var S,_,T,E=M.words,D=B.words,O=R.words,P=0,q=0|E[0],X=8191&q,Q=q>>>13,G=0|E[1],ee=8191&G,V=G>>>13,H=0|E[2],Z=8191&H,ie=H>>>13,te=0|E[3],oe=8191&te,ue=te>>>13,Ce=0|E[4],ye=8191&Ce,ne=Ce>>>13,me=0|E[5],ve=8191&me,Te=me>>>13,xe=0|E[6],Fe=8191&xe,Ge=xe>>>13,Ve=0|E[7],Ye=8191&Ve,ut=Ve>>>13,ht=0|E[8],be=8191&ht,ze=ht>>>13,we=0|E[9],Ee=8191&we,Ie=we>>>13,Pe=0|D[0],De=8191&Pe,Ze=Pe>>>13,pt=0|D[1],yt=8191&pt,Pt=pt>>>13,$t=0|D[2],Ct=8191&$t,It=$t>>>13,Ut=0|D[3],_t=8191&Ut,sr=Ut>>>13,Jt=0|D[4],Tt=8191&Jt,nr=Jt>>>13,vr=0|D[5],At=8191&vr,fr=vr>>>13,yr=0|D[6],Ot=8191&yr,ke=yr>>>13,He=0|D[7],Xe=8191&He,se=He>>>13,pe=0|D[8],le=8191&pe,de=pe>>>13,fe=0|D[9],ge=8191&fe,Re=fe>>>13;R.negative=M.negative^B.negative,R.length=19;var je=(P+(S=Math.imul(X,De))|0)+((8191&(_=(_=Math.imul(X,Ze))+Math.imul(Q,De)|0))<<13)|0;P=((T=Math.imul(Q,Ze))+(_>>>13)|0)+(je>>>26)|0,je&=67108863,S=Math.imul(ee,De),_=(_=Math.imul(ee,Ze))+Math.imul(V,De)|0,T=Math.imul(V,Ze);var Me=(P+(S=S+Math.imul(X,yt)|0)|0)+((8191&(_=(_=_+Math.imul(X,Pt)|0)+Math.imul(Q,yt)|0))<<13)|0;P=((T=T+Math.imul(Q,Pt)|0)+(_>>>13)|0)+(Me>>>26)|0,Me&=67108863,S=Math.imul(Z,De),_=(_=Math.imul(Z,Ze))+Math.imul(ie,De)|0,T=Math.imul(ie,Ze),S=S+Math.imul(ee,yt)|0,_=(_=_+Math.imul(ee,Pt)|0)+Math.imul(V,yt)|0,T=T+Math.imul(V,Pt)|0;var Be=(P+(S=S+Math.imul(X,Ct)|0)|0)+((8191&(_=(_=_+Math.imul(X,It)|0)+Math.imul(Q,Ct)|0))<<13)|0;P=((T=T+Math.imul(Q,It)|0)+(_>>>13)|0)+(Be>>>26)|0,Be&=67108863,S=Math.imul(oe,De),_=(_=Math.imul(oe,Ze))+Math.imul(ue,De)|0,T=Math.imul(ue,Ze),S=S+Math.imul(Z,yt)|0,_=(_=_+Math.imul(Z,Pt)|0)+Math.imul(ie,yt)|0,T=T+Math.imul(ie,Pt)|0,S=S+Math.imul(ee,Ct)|0,_=(_=_+Math.imul(ee,It)|0)+Math.imul(V,Ct)|0,T=T+Math.imul(V,It)|0;var Oe=(P+(S=S+Math.imul(X,_t)|0)|0)+((8191&(_=(_=_+Math.imul(X,sr)|0)+Math.imul(Q,_t)|0))<<13)|0;P=((T=T+Math.imul(Q,sr)|0)+(_>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,S=Math.imul(ye,De),_=(_=Math.imul(ye,Ze))+Math.imul(ne,De)|0,T=Math.imul(ne,Ze),S=S+Math.imul(oe,yt)|0,_=(_=_+Math.imul(oe,Pt)|0)+Math.imul(ue,yt)|0,T=T+Math.imul(ue,Pt)|0,S=S+Math.imul(Z,Ct)|0,_=(_=_+Math.imul(Z,It)|0)+Math.imul(ie,Ct)|0,T=T+Math.imul(ie,It)|0,S=S+Math.imul(ee,_t)|0,_=(_=_+Math.imul(ee,sr)|0)+Math.imul(V,_t)|0,T=T+Math.imul(V,sr)|0;var nt=(P+(S=S+Math.imul(X,Tt)|0)|0)+((8191&(_=(_=_+Math.imul(X,nr)|0)+Math.imul(Q,Tt)|0))<<13)|0;P=((T=T+Math.imul(Q,nr)|0)+(_>>>13)|0)+(nt>>>26)|0,nt&=67108863,S=Math.imul(ve,De),_=(_=Math.imul(ve,Ze))+Math.imul(Te,De)|0,T=Math.imul(Te,Ze),S=S+Math.imul(ye,yt)|0,_=(_=_+Math.imul(ye,Pt)|0)+Math.imul(ne,yt)|0,T=T+Math.imul(ne,Pt)|0,S=S+Math.imul(oe,Ct)|0,_=(_=_+Math.imul(oe,It)|0)+Math.imul(ue,Ct)|0,T=T+Math.imul(ue,It)|0,S=S+Math.imul(Z,_t)|0,_=(_=_+Math.imul(Z,sr)|0)+Math.imul(ie,_t)|0,T=T+Math.imul(ie,sr)|0,S=S+Math.imul(ee,Tt)|0,_=(_=_+Math.imul(ee,nr)|0)+Math.imul(V,Tt)|0,T=T+Math.imul(V,nr)|0;var ct=(P+(S=S+Math.imul(X,At)|0)|0)+((8191&(_=(_=_+Math.imul(X,fr)|0)+Math.imul(Q,At)|0))<<13)|0;P=((T=T+Math.imul(Q,fr)|0)+(_>>>13)|0)+(ct>>>26)|0,ct&=67108863,S=Math.imul(Fe,De),_=(_=Math.imul(Fe,Ze))+Math.imul(Ge,De)|0,T=Math.imul(Ge,Ze),S=S+Math.imul(ve,yt)|0,_=(_=_+Math.imul(ve,Pt)|0)+Math.imul(Te,yt)|0,T=T+Math.imul(Te,Pt)|0,S=S+Math.imul(ye,Ct)|0,_=(_=_+Math.imul(ye,It)|0)+Math.imul(ne,Ct)|0,T=T+Math.imul(ne,It)|0,S=S+Math.imul(oe,_t)|0,_=(_=_+Math.imul(oe,sr)|0)+Math.imul(ue,_t)|0,T=T+Math.imul(ue,sr)|0,S=S+Math.imul(Z,Tt)|0,_=(_=_+Math.imul(Z,nr)|0)+Math.imul(ie,Tt)|0,T=T+Math.imul(ie,nr)|0,S=S+Math.imul(ee,At)|0,_=(_=_+Math.imul(ee,fr)|0)+Math.imul(V,At)|0,T=T+Math.imul(V,fr)|0;var ft=(P+(S=S+Math.imul(X,Ot)|0)|0)+((8191&(_=(_=_+Math.imul(X,ke)|0)+Math.imul(Q,Ot)|0))<<13)|0;P=((T=T+Math.imul(Q,ke)|0)+(_>>>13)|0)+(ft>>>26)|0,ft&=67108863,S=Math.imul(Ye,De),_=(_=Math.imul(Ye,Ze))+Math.imul(ut,De)|0,T=Math.imul(ut,Ze),S=S+Math.imul(Fe,yt)|0,_=(_=_+Math.imul(Fe,Pt)|0)+Math.imul(Ge,yt)|0,T=T+Math.imul(Ge,Pt)|0,S=S+Math.imul(ve,Ct)|0,_=(_=_+Math.imul(ve,It)|0)+Math.imul(Te,Ct)|0,T=T+Math.imul(Te,It)|0,S=S+Math.imul(ye,_t)|0,_=(_=_+Math.imul(ye,sr)|0)+Math.imul(ne,_t)|0,T=T+Math.imul(ne,sr)|0,S=S+Math.imul(oe,Tt)|0,_=(_=_+Math.imul(oe,nr)|0)+Math.imul(ue,Tt)|0,T=T+Math.imul(ue,nr)|0,S=S+Math.imul(Z,At)|0,_=(_=_+Math.imul(Z,fr)|0)+Math.imul(ie,At)|0,T=T+Math.imul(ie,fr)|0,S=S+Math.imul(ee,Ot)|0,_=(_=_+Math.imul(ee,ke)|0)+Math.imul(V,Ot)|0,T=T+Math.imul(V,ke)|0;var ce=(P+(S=S+Math.imul(X,Xe)|0)|0)+((8191&(_=(_=_+Math.imul(X,se)|0)+Math.imul(Q,Xe)|0))<<13)|0;P=((T=T+Math.imul(Q,se)|0)+(_>>>13)|0)+(ce>>>26)|0,ce&=67108863,S=Math.imul(be,De),_=(_=Math.imul(be,Ze))+Math.imul(ze,De)|0,T=Math.imul(ze,Ze),S=S+Math.imul(Ye,yt)|0,_=(_=_+Math.imul(Ye,Pt)|0)+Math.imul(ut,yt)|0,T=T+Math.imul(ut,Pt)|0,S=S+Math.imul(Fe,Ct)|0,_=(_=_+Math.imul(Fe,It)|0)+Math.imul(Ge,Ct)|0,T=T+Math.imul(Ge,It)|0,S=S+Math.imul(ve,_t)|0,_=(_=_+Math.imul(ve,sr)|0)+Math.imul(Te,_t)|0,T=T+Math.imul(Te,sr)|0,S=S+Math.imul(ye,Tt)|0,_=(_=_+Math.imul(ye,nr)|0)+Math.imul(ne,Tt)|0,T=T+Math.imul(ne,nr)|0,S=S+Math.imul(oe,At)|0,_=(_=_+Math.imul(oe,fr)|0)+Math.imul(ue,At)|0,T=T+Math.imul(ue,fr)|0,S=S+Math.imul(Z,Ot)|0,_=(_=_+Math.imul(Z,ke)|0)+Math.imul(ie,Ot)|0,T=T+Math.imul(ie,ke)|0,S=S+Math.imul(ee,Xe)|0,_=(_=_+Math.imul(ee,se)|0)+Math.imul(V,Xe)|0,T=T+Math.imul(V,se)|0;var Se=(P+(S=S+Math.imul(X,le)|0)|0)+((8191&(_=(_=_+Math.imul(X,de)|0)+Math.imul(Q,le)|0))<<13)|0;P=((T=T+Math.imul(Q,de)|0)+(_>>>13)|0)+(Se>>>26)|0,Se&=67108863,S=Math.imul(Ee,De),_=(_=Math.imul(Ee,Ze))+Math.imul(Ie,De)|0,T=Math.imul(Ie,Ze),S=S+Math.imul(be,yt)|0,_=(_=_+Math.imul(be,Pt)|0)+Math.imul(ze,yt)|0,T=T+Math.imul(ze,Pt)|0,S=S+Math.imul(Ye,Ct)|0,_=(_=_+Math.imul(Ye,It)|0)+Math.imul(ut,Ct)|0,T=T+Math.imul(ut,It)|0,S=S+Math.imul(Fe,_t)|0,_=(_=_+Math.imul(Fe,sr)|0)+Math.imul(Ge,_t)|0,T=T+Math.imul(Ge,sr)|0,S=S+Math.imul(ve,Tt)|0,_=(_=_+Math.imul(ve,nr)|0)+Math.imul(Te,Tt)|0,T=T+Math.imul(Te,nr)|0,S=S+Math.imul(ye,At)|0,_=(_=_+Math.imul(ye,fr)|0)+Math.imul(ne,At)|0,T=T+Math.imul(ne,fr)|0,S=S+Math.imul(oe,Ot)|0,_=(_=_+Math.imul(oe,ke)|0)+Math.imul(ue,Ot)|0,T=T+Math.imul(ue,ke)|0,S=S+Math.imul(Z,Xe)|0,_=(_=_+Math.imul(Z,se)|0)+Math.imul(ie,Xe)|0,T=T+Math.imul(ie,se)|0,S=S+Math.imul(ee,le)|0,_=(_=_+Math.imul(ee,de)|0)+Math.imul(V,le)|0,T=T+Math.imul(V,de)|0;var Le=(P+(S=S+Math.imul(X,ge)|0)|0)+((8191&(_=(_=_+Math.imul(X,Re)|0)+Math.imul(Q,ge)|0))<<13)|0;P=((T=T+Math.imul(Q,Re)|0)+(_>>>13)|0)+(Le>>>26)|0,Le&=67108863,S=Math.imul(Ee,yt),_=(_=Math.imul(Ee,Pt))+Math.imul(Ie,yt)|0,T=Math.imul(Ie,Pt),S=S+Math.imul(be,Ct)|0,_=(_=_+Math.imul(be,It)|0)+Math.imul(ze,Ct)|0,T=T+Math.imul(ze,It)|0,S=S+Math.imul(Ye,_t)|0,_=(_=_+Math.imul(Ye,sr)|0)+Math.imul(ut,_t)|0,T=T+Math.imul(ut,sr)|0,S=S+Math.imul(Fe,Tt)|0,_=(_=_+Math.imul(Fe,nr)|0)+Math.imul(Ge,Tt)|0,T=T+Math.imul(Ge,nr)|0,S=S+Math.imul(ve,At)|0,_=(_=_+Math.imul(ve,fr)|0)+Math.imul(Te,At)|0,T=T+Math.imul(Te,fr)|0,S=S+Math.imul(ye,Ot)|0,_=(_=_+Math.imul(ye,ke)|0)+Math.imul(ne,Ot)|0,T=T+Math.imul(ne,ke)|0,S=S+Math.imul(oe,Xe)|0,_=(_=_+Math.imul(oe,se)|0)+Math.imul(ue,Xe)|0,T=T+Math.imul(ue,se)|0,S=S+Math.imul(Z,le)|0,_=(_=_+Math.imul(Z,de)|0)+Math.imul(ie,le)|0,T=T+Math.imul(ie,de)|0;var Qe=(P+(S=S+Math.imul(ee,ge)|0)|0)+((8191&(_=(_=_+Math.imul(ee,Re)|0)+Math.imul(V,ge)|0))<<13)|0;P=((T=T+Math.imul(V,Re)|0)+(_>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,S=Math.imul(Ee,Ct),_=(_=Math.imul(Ee,It))+Math.imul(Ie,Ct)|0,T=Math.imul(Ie,It),S=S+Math.imul(be,_t)|0,_=(_=_+Math.imul(be,sr)|0)+Math.imul(ze,_t)|0,T=T+Math.imul(ze,sr)|0,S=S+Math.imul(Ye,Tt)|0,_=(_=_+Math.imul(Ye,nr)|0)+Math.imul(ut,Tt)|0,T=T+Math.imul(ut,nr)|0,S=S+Math.imul(Fe,At)|0,_=(_=_+Math.imul(Fe,fr)|0)+Math.imul(Ge,At)|0,T=T+Math.imul(Ge,fr)|0,S=S+Math.imul(ve,Ot)|0,_=(_=_+Math.imul(ve,ke)|0)+Math.imul(Te,Ot)|0,T=T+Math.imul(Te,ke)|0,S=S+Math.imul(ye,Xe)|0,_=(_=_+Math.imul(ye,se)|0)+Math.imul(ne,Xe)|0,T=T+Math.imul(ne,se)|0,S=S+Math.imul(oe,le)|0,_=(_=_+Math.imul(oe,de)|0)+Math.imul(ue,le)|0,T=T+Math.imul(ue,de)|0;var gt=(P+(S=S+Math.imul(Z,ge)|0)|0)+((8191&(_=(_=_+Math.imul(Z,Re)|0)+Math.imul(ie,ge)|0))<<13)|0;P=((T=T+Math.imul(ie,Re)|0)+(_>>>13)|0)+(gt>>>26)|0,gt&=67108863,S=Math.imul(Ee,_t),_=(_=Math.imul(Ee,sr))+Math.imul(Ie,_t)|0,T=Math.imul(Ie,sr),S=S+Math.imul(be,Tt)|0,_=(_=_+Math.imul(be,nr)|0)+Math.imul(ze,Tt)|0,T=T+Math.imul(ze,nr)|0,S=S+Math.imul(Ye,At)|0,_=(_=_+Math.imul(Ye,fr)|0)+Math.imul(ut,At)|0,T=T+Math.imul(ut,fr)|0,S=S+Math.imul(Fe,Ot)|0,_=(_=_+Math.imul(Fe,ke)|0)+Math.imul(Ge,Ot)|0,T=T+Math.imul(Ge,ke)|0,S=S+Math.imul(ve,Xe)|0,_=(_=_+Math.imul(ve,se)|0)+Math.imul(Te,Xe)|0,T=T+Math.imul(Te,se)|0,S=S+Math.imul(ye,le)|0,_=(_=_+Math.imul(ye,de)|0)+Math.imul(ne,le)|0,T=T+Math.imul(ne,de)|0;var ot=(P+(S=S+Math.imul(oe,ge)|0)|0)+((8191&(_=(_=_+Math.imul(oe,Re)|0)+Math.imul(ue,ge)|0))<<13)|0;P=((T=T+Math.imul(ue,Re)|0)+(_>>>13)|0)+(ot>>>26)|0,ot&=67108863,S=Math.imul(Ee,Tt),_=(_=Math.imul(Ee,nr))+Math.imul(Ie,Tt)|0,T=Math.imul(Ie,nr),S=S+Math.imul(be,At)|0,_=(_=_+Math.imul(be,fr)|0)+Math.imul(ze,At)|0,T=T+Math.imul(ze,fr)|0,S=S+Math.imul(Ye,Ot)|0,_=(_=_+Math.imul(Ye,ke)|0)+Math.imul(ut,Ot)|0,T=T+Math.imul(ut,ke)|0,S=S+Math.imul(Fe,Xe)|0,_=(_=_+Math.imul(Fe,se)|0)+Math.imul(Ge,Xe)|0,T=T+Math.imul(Ge,se)|0,S=S+Math.imul(ve,le)|0,_=(_=_+Math.imul(ve,de)|0)+Math.imul(Te,le)|0,T=T+Math.imul(Te,de)|0;var dt=(P+(S=S+Math.imul(ye,ge)|0)|0)+((8191&(_=(_=_+Math.imul(ye,Re)|0)+Math.imul(ne,ge)|0))<<13)|0;P=((T=T+Math.imul(ne,Re)|0)+(_>>>13)|0)+(dt>>>26)|0,dt&=67108863,S=Math.imul(Ee,At),_=(_=Math.imul(Ee,fr))+Math.imul(Ie,At)|0,T=Math.imul(Ie,fr),S=S+Math.imul(be,Ot)|0,_=(_=_+Math.imul(be,ke)|0)+Math.imul(ze,Ot)|0,T=T+Math.imul(ze,ke)|0,S=S+Math.imul(Ye,Xe)|0,_=(_=_+Math.imul(Ye,se)|0)+Math.imul(ut,Xe)|0,T=T+Math.imul(ut,se)|0,S=S+Math.imul(Fe,le)|0,_=(_=_+Math.imul(Fe,de)|0)+Math.imul(Ge,le)|0,T=T+Math.imul(Ge,de)|0;var Kt=(P+(S=S+Math.imul(ve,ge)|0)|0)+((8191&(_=(_=_+Math.imul(ve,Re)|0)+Math.imul(Te,ge)|0))<<13)|0;P=((T=T+Math.imul(Te,Re)|0)+(_>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,S=Math.imul(Ee,Ot),_=(_=Math.imul(Ee,ke))+Math.imul(Ie,Ot)|0,T=Math.imul(Ie,ke),S=S+Math.imul(be,Xe)|0,_=(_=_+Math.imul(be,se)|0)+Math.imul(ze,Xe)|0,T=T+Math.imul(ze,se)|0,S=S+Math.imul(Ye,le)|0,_=(_=_+Math.imul(Ye,de)|0)+Math.imul(ut,le)|0,T=T+Math.imul(ut,de)|0;var Nt=(P+(S=S+Math.imul(Fe,ge)|0)|0)+((8191&(_=(_=_+Math.imul(Fe,Re)|0)+Math.imul(Ge,ge)|0))<<13)|0;P=((T=T+Math.imul(Ge,Re)|0)+(_>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,S=Math.imul(Ee,Xe),_=(_=Math.imul(Ee,se))+Math.imul(Ie,Xe)|0,T=Math.imul(Ie,se),S=S+Math.imul(be,le)|0,_=(_=_+Math.imul(be,de)|0)+Math.imul(ze,le)|0,T=T+Math.imul(ze,de)|0;var Lt=(P+(S=S+Math.imul(Ye,ge)|0)|0)+((8191&(_=(_=_+Math.imul(Ye,Re)|0)+Math.imul(ut,ge)|0))<<13)|0;P=((T=T+Math.imul(ut,Re)|0)+(_>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,S=Math.imul(Ee,le),_=(_=Math.imul(Ee,de))+Math.imul(Ie,le)|0,T=Math.imul(Ie,de);var kt=(P+(S=S+Math.imul(be,ge)|0)|0)+((8191&(_=(_=_+Math.imul(be,Re)|0)+Math.imul(ze,ge)|0))<<13)|0;P=((T=T+Math.imul(ze,Re)|0)+(_>>>13)|0)+(kt>>>26)|0,kt&=67108863;var qt=(P+(S=Math.imul(Ee,ge))|0)+((8191&(_=(_=Math.imul(Ee,Re))+Math.imul(Ie,ge)|0))<<13)|0;return P=((T=Math.imul(Ie,Re))+(_>>>13)|0)+(qt>>>26)|0,qt&=67108863,O[0]=je,O[1]=Me,O[2]=Be,O[3]=Oe,O[4]=nt,O[5]=ct,O[6]=ft,O[7]=ce,O[8]=Se,O[9]=Le,O[10]=Qe,O[11]=gt,O[12]=ot,O[13]=dt,O[14]=Kt,O[15]=Nt,O[16]=Lt,O[17]=kt,O[18]=qt,P!==0&&(O[19]=P,R.length++),R};function C(M,B,R){return new k().mulp(M,B,R)}function k(M,B){this.x=M,this.y=B}Math.imul||(y=w),c.prototype.mulTo=function(M,B){var R=this.length+M.length;return this.length===10&&M.length===10?y(this,M,B):R<63?w(this,M,B):R<1024?(function(S,_,T){T.negative=_.negative^S.negative,T.length=S.length+_.length;for(var E=0,D=0,O=0;O<T.length-1;O++){var P=D;D=0;for(var q=67108863&E,X=Math.min(O,_.length-1),Q=Math.max(0,O-S.length+1);Q<=X;Q++){var G=O-Q,ee=(0|S.words[G])*(0|_.words[Q]),V=67108863&ee;q=67108863&(V=V+q|0),D+=(P=(P=P+(ee/67108864|0)|0)+(V>>>26)|0)>>>26,P&=67108863}T.words[O]=q,E=P,P=D}return E!==0?T.words[O]=E:T.length--,T.strip()})(this,M,B):C(this,M,B)},k.prototype.makeRBT=function(M){for(var B=new Array(M),R=c.prototype._countBits(M)-1,S=0;S<M;S++)B[S]=this.revBin(S,R,M);return B},k.prototype.revBin=function(M,B,R){if(M===0||M===R-1)return M;for(var S=0,_=0;_<B;_++)S|=(1&M)<<B-_-1,M>>=1;return S},k.prototype.permute=function(M,B,R,S,_,T){for(var E=0;E<T;E++)S[E]=B[M[E]],_[E]=R[M[E]]},k.prototype.transform=function(M,B,R,S,_,T){this.permute(T,M,B,R,S,_);for(var E=1;E<_;E<<=1)for(var D=E<<1,O=Math.cos(2*Math.PI/D),P=Math.sin(2*Math.PI/D),q=0;q<_;q+=D)for(var X=O,Q=P,G=0;G<E;G++){var ee=R[q+G],V=S[q+G],H=R[q+G+E],Z=S[q+G+E],ie=X*H-Q*Z;Z=X*Z+Q*H,H=ie,R[q+G]=ee+H,S[q+G]=V+Z,R[q+G+E]=ee-H,S[q+G+E]=V-Z,G!==D&&(ie=O*X-P*Q,Q=O*Q+P*X,X=ie)}},k.prototype.guessLen13b=function(M,B){var R=1|Math.max(B,M),S=1&R,_=0;for(R=R/2|0;R;R>>>=1)_++;return 1<<_+1+S},k.prototype.conjugate=function(M,B,R){if(!(R<=1))for(var S=0;S<R/2;S++){var _=M[S];M[S]=M[R-S-1],M[R-S-1]=_,_=B[S],B[S]=-B[R-S-1],B[R-S-1]=-_}},k.prototype.normalize13b=function(M,B){for(var R=0,S=0;S<B/2;S++){var _=8192*Math.round(M[2*S+1]/B)+Math.round(M[2*S]/B)+R;M[S]=67108863&_,R=_<67108864?0:_/67108864|0}return M},k.prototype.convert13b=function(M,B,R,S){for(var _=0,T=0;T<B;T++)_+=0|M[T],R[2*T]=8191&_,_>>>=13,R[2*T+1]=8191&_,_>>>=13;for(T=2*B;T<S;++T)R[T]=0;a(_===0),a((-8192&_)==0)},k.prototype.stub=function(M){for(var B=new Array(M),R=0;R<M;R++)B[R]=0;return B},k.prototype.mulp=function(M,B,R){var S=2*this.guessLen13b(M.length,B.length),_=this.makeRBT(S),T=this.stub(S),E=new Array(S),D=new Array(S),O=new Array(S),P=new Array(S),q=new Array(S),X=new Array(S),Q=R.words;Q.length=S,this.convert13b(M.words,M.length,E,S),this.convert13b(B.words,B.length,P,S),this.transform(E,T,D,O,S,_),this.transform(P,T,q,X,S,_);for(var G=0;G<S;G++){var ee=D[G]*q[G]-O[G]*X[G];O[G]=D[G]*X[G]+O[G]*q[G],D[G]=ee}return this.conjugate(D,O,S),this.transform(D,O,Q,T,S,_),this.conjugate(Q,T,S),this.normalize13b(Q,S),R.negative=M.negative^B.negative,R.length=M.length+B.length,R.strip()},c.prototype.mul=function(M){var B=new c(null);return B.words=new Array(this.length+M.length),this.mulTo(M,B)},c.prototype.mulf=function(M){var B=new c(null);return B.words=new Array(this.length+M.length),C(this,M,B)},c.prototype.imul=function(M){return this.clone().mulTo(M,this)},c.prototype.imuln=function(M){a(typeof M=="number"),a(M<67108864);for(var B=0,R=0;R<this.length;R++){var S=(0|this.words[R])*M,_=(67108863&S)+(67108863&B);B>>=26,B+=S/67108864|0,B+=_>>>26,this.words[R]=67108863&_}return B!==0&&(this.words[R]=B,this.length++),this},c.prototype.muln=function(M){return this.clone().imuln(M)},c.prototype.sqr=function(){return this.mul(this)},c.prototype.isqr=function(){return this.imul(this.clone())},c.prototype.pow=function(M){var B=(function(T){for(var E=new Array(T.bitLength()),D=0;D<E.length;D++){var O=D/26|0,P=D%26;E[D]=(T.words[O]&1<<P)>>>P}return E})(M);if(B.length===0)return new c(1);for(var R=this,S=0;S<B.length&&B[S]===0;S++,R=R.sqr());if(++S<B.length)for(var _=R.sqr();S<B.length;S++,_=_.sqr())B[S]!==0&&(R=R.mul(_));return R},c.prototype.iushln=function(M){a(typeof M=="number"&&M>=0);var B,R=M%26,S=(M-R)/26,_=67108863>>>26-R<<26-R;if(R!==0){var T=0;for(B=0;B<this.length;B++){var E=this.words[B]&_,D=(0|this.words[B])-E<<R;this.words[B]=D|T,T=E>>>26-R}T&&(this.words[B]=T,this.length++)}if(S!==0){for(B=this.length-1;B>=0;B--)this.words[B+S]=this.words[B];for(B=0;B<S;B++)this.words[B]=0;this.length+=S}return this.strip()},c.prototype.ishln=function(M){return a(this.negative===0),this.iushln(M)},c.prototype.iushrn=function(M,B,R){var S;a(typeof M=="number"&&M>=0),S=B?(B-B%26)/26:0;var _=M%26,T=Math.min((M-_)/26,this.length),E=67108863^67108863>>>_<<_,D=R;if(S-=T,S=Math.max(0,S),D){for(var O=0;O<T;O++)D.words[O]=this.words[O];D.length=T}if(T!==0)if(this.length>T)for(this.length-=T,O=0;O<this.length;O++)this.words[O]=this.words[O+T];else this.words[0]=0,this.length=1;var P=0;for(O=this.length-1;O>=0&&(P!==0||O>=S);O--){var q=0|this.words[O];this.words[O]=P<<26-_|q>>>_,P=q&E}return D&&P!==0&&(D.words[D.length++]=P),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},c.prototype.ishrn=function(M,B,R){return a(this.negative===0),this.iushrn(M,B,R)},c.prototype.shln=function(M){return this.clone().ishln(M)},c.prototype.ushln=function(M){return this.clone().iushln(M)},c.prototype.shrn=function(M){return this.clone().ishrn(M)},c.prototype.ushrn=function(M){return this.clone().iushrn(M)},c.prototype.testn=function(M){a(typeof M=="number"&&M>=0);var B=M%26,R=(M-B)/26,S=1<<B;return!(this.length<=R)&&!!(this.words[R]&S)},c.prototype.imaskn=function(M){a(typeof M=="number"&&M>=0);var B=M%26,R=(M-B)/26;if(a(this.negative===0,"imaskn works only with positive numbers"),this.length<=R)return this;if(B!==0&&R++,this.length=Math.min(R,this.length),B!==0){var S=67108863^67108863>>>B<<B;this.words[this.length-1]&=S}return this.strip()},c.prototype.maskn=function(M){return this.clone().imaskn(M)},c.prototype.iaddn=function(M){return a(typeof M=="number"),a(M<67108864),M<0?this.isubn(-M):this.negative!==0?this.length===1&&(0|this.words[0])<M?(this.words[0]=M-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(M),this.negative=1,this):this._iaddn(M)},c.prototype._iaddn=function(M){this.words[0]+=M;for(var B=0;B<this.length&&this.words[B]>=67108864;B++)this.words[B]-=67108864,B===this.length-1?this.words[B+1]=1:this.words[B+1]++;return this.length=Math.max(this.length,B+1),this},c.prototype.isubn=function(M){if(a(typeof M=="number"),a(M<67108864),M<0)return this.iaddn(-M);if(this.negative!==0)return this.negative=0,this.iaddn(M),this.negative=1,this;if(this.words[0]-=M,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var B=0;B<this.length&&this.words[B]<0;B++)this.words[B]+=67108864,this.words[B+1]-=1;return this.strip()},c.prototype.addn=function(M){return this.clone().iaddn(M)},c.prototype.subn=function(M){return this.clone().isubn(M)},c.prototype.iabs=function(){return this.negative=0,this},c.prototype.abs=function(){return this.clone().iabs()},c.prototype._ishlnsubmul=function(M,B,R){var S,_,T=M.length+R;this._expand(T);var E=0;for(S=0;S<M.length;S++){_=(0|this.words[S+R])+E;var D=(0|M.words[S])*B;E=((_-=67108863&D)>>26)-(D/67108864|0),this.words[S+R]=67108863&_}for(;S<this.length-R;S++)E=(_=(0|this.words[S+R])+E)>>26,this.words[S+R]=67108863&_;if(E===0)return this.strip();for(a(E===-1),E=0,S=0;S<this.length;S++)E=(_=-(0|this.words[S])+E)>>26,this.words[S]=67108863&_;return this.negative=1,this.strip()},c.prototype._wordDiv=function(M,B){var R=(this.length,M.length),S=this.clone(),_=M,T=0|_.words[_.length-1];(R=26-this._countBits(T))!==0&&(_=_.ushln(R),S.iushln(R),T=0|_.words[_.length-1]);var E,D=S.length-_.length;if(B!=="mod"){(E=new c(null)).length=D+1,E.words=new Array(E.length);for(var O=0;O<E.length;O++)E.words[O]=0}var P=S.clone()._ishlnsubmul(_,1,D);P.negative===0&&(S=P,E&&(E.words[D]=1));for(var q=D-1;q>=0;q--){var X=67108864*(0|S.words[_.length+q])+(0|S.words[_.length+q-1]);for(X=Math.min(X/T|0,67108863),S._ishlnsubmul(_,X,q);S.negative!==0;)X--,S.negative=0,S._ishlnsubmul(_,1,q),S.isZero()||(S.negative^=1);E&&(E.words[q]=X)}return E&&E.strip(),S.strip(),B!=="div"&&R!==0&&S.iushrn(R),{div:E||null,mod:S}},c.prototype.divmod=function(M,B,R){return a(!M.isZero()),this.isZero()?{div:new c(0),mod:new c(0)}:this.negative!==0&&M.negative===0?(T=this.neg().divmod(M,B),B!=="mod"&&(S=T.div.neg()),B!=="div"&&(_=T.mod.neg(),R&&_.negative!==0&&_.iadd(M)),{div:S,mod:_}):this.negative===0&&M.negative!==0?(T=this.divmod(M.neg(),B),B!=="mod"&&(S=T.div.neg()),{div:S,mod:T.mod}):(this.negative&M.negative)!=0?(T=this.neg().divmod(M.neg(),B),B!=="div"&&(_=T.mod.neg(),R&&_.negative!==0&&_.isub(M)),{div:T.div,mod:_}):M.length>this.length||this.cmp(M)<0?{div:new c(0),mod:this}:M.length===1?B==="div"?{div:this.divn(M.words[0]),mod:null}:B==="mod"?{div:null,mod:new c(this.modn(M.words[0]))}:{div:this.divn(M.words[0]),mod:new c(this.modn(M.words[0]))}:this._wordDiv(M,B);var S,_,T},c.prototype.div=function(M){return this.divmod(M,"div",!1).div},c.prototype.mod=function(M){return this.divmod(M,"mod",!1).mod},c.prototype.umod=function(M){return this.divmod(M,"mod",!0).mod},c.prototype.divRound=function(M){var B=this.divmod(M);if(B.mod.isZero())return B.div;var R=B.div.negative!==0?B.mod.isub(M):B.mod,S=M.ushrn(1),_=M.andln(1),T=R.cmp(S);return T<0||_===1&&T===0?B.div:B.div.negative!==0?B.div.isubn(1):B.div.iaddn(1)},c.prototype.modn=function(M){a(M<=67108863);for(var B=(1<<26)%M,R=0,S=this.length-1;S>=0;S--)R=(B*R+(0|this.words[S]))%M;return R},c.prototype.idivn=function(M){a(M<=67108863);for(var B=0,R=this.length-1;R>=0;R--){var S=(0|this.words[R])+67108864*B;this.words[R]=S/M|0,B=S%M}return this.strip()},c.prototype.divn=function(M){return this.clone().idivn(M)},c.prototype.egcd=function(M){a(M.negative===0),a(!M.isZero());var B=this,R=M.clone();B=B.negative!==0?B.umod(M):B.clone();for(var S=new c(1),_=new c(0),T=new c(0),E=new c(1),D=0;B.isEven()&&R.isEven();)B.iushrn(1),R.iushrn(1),++D;for(var O=R.clone(),P=B.clone();!B.isZero();){for(var q=0,X=1;(B.words[0]&X)==0&&q<26;++q,X<<=1);if(q>0)for(B.iushrn(q);q-- >0;)(S.isOdd()||_.isOdd())&&(S.iadd(O),_.isub(P)),S.iushrn(1),_.iushrn(1);for(var Q=0,G=1;(R.words[0]&G)==0&&Q<26;++Q,G<<=1);if(Q>0)for(R.iushrn(Q);Q-- >0;)(T.isOdd()||E.isOdd())&&(T.iadd(O),E.isub(P)),T.iushrn(1),E.iushrn(1);B.cmp(R)>=0?(B.isub(R),S.isub(T),_.isub(E)):(R.isub(B),T.isub(S),E.isub(_))}return{a:T,b:E,gcd:R.iushln(D)}},c.prototype._invmp=function(M){a(M.negative===0),a(!M.isZero());var B=this,R=M.clone();B=B.negative!==0?B.umod(M):B.clone();for(var S,_=new c(1),T=new c(0),E=R.clone();B.cmpn(1)>0&&R.cmpn(1)>0;){for(var D=0,O=1;(B.words[0]&O)==0&&D<26;++D,O<<=1);if(D>0)for(B.iushrn(D);D-- >0;)_.isOdd()&&_.iadd(E),_.iushrn(1);for(var P=0,q=1;(R.words[0]&q)==0&&P<26;++P,q<<=1);if(P>0)for(R.iushrn(P);P-- >0;)T.isOdd()&&T.iadd(E),T.iushrn(1);B.cmp(R)>=0?(B.isub(R),_.isub(T)):(R.isub(B),T.isub(_))}return(S=B.cmpn(1)===0?_:T).cmpn(0)<0&&S.iadd(M),S},c.prototype.gcd=function(M){if(this.isZero())return M.abs();if(M.isZero())return this.abs();var B=this.clone(),R=M.clone();B.negative=0,R.negative=0;for(var S=0;B.isEven()&&R.isEven();S++)B.iushrn(1),R.iushrn(1);for(;;){for(;B.isEven();)B.iushrn(1);for(;R.isEven();)R.iushrn(1);var _=B.cmp(R);if(_<0){var T=B;B=R,R=T}else if(_===0||R.cmpn(1)===0)break;B.isub(R)}return R.iushln(S)},c.prototype.invm=function(M){return this.egcd(M).a.umod(M)},c.prototype.isEven=function(){return(1&this.words[0])==0},c.prototype.isOdd=function(){return(1&this.words[0])==1},c.prototype.andln=function(M){return this.words[0]&M},c.prototype.bincn=function(M){a(typeof M=="number");var B=M%26,R=(M-B)/26,S=1<<B;if(this.length<=R)return this._expand(R+1),this.words[R]|=S,this;for(var _=S,T=R;_!==0&&T<this.length;T++){var E=0|this.words[T];_=(E+=_)>>>26,E&=67108863,this.words[T]=E}return _!==0&&(this.words[T]=_,this.length++),this},c.prototype.isZero=function(){return this.length===1&&this.words[0]===0},c.prototype.cmpn=function(M){var B,R=M<0;if(this.negative!==0&&!R)return-1;if(this.negative===0&&R)return 1;if(this.strip(),this.length>1)B=1;else{R&&(M=-M),a(M<=67108863,"Number is too big");var S=0|this.words[0];B=S===M?0:S<M?-1:1}return this.negative!==0?0|-B:B},c.prototype.cmp=function(M){if(this.negative!==0&&M.negative===0)return-1;if(this.negative===0&&M.negative!==0)return 1;var B=this.ucmp(M);return this.negative!==0?0|-B:B},c.prototype.ucmp=function(M){if(this.length>M.length)return 1;if(this.length<M.length)return-1;for(var B=0,R=this.length-1;R>=0;R--){var S=0|this.words[R],_=0|M.words[R];if(S!==_){S<_?B=-1:S>_&&(B=1);break}}return B},c.prototype.gtn=function(M){return this.cmpn(M)===1},c.prototype.gt=function(M){return this.cmp(M)===1},c.prototype.gten=function(M){return this.cmpn(M)>=0},c.prototype.gte=function(M){return this.cmp(M)>=0},c.prototype.ltn=function(M){return this.cmpn(M)===-1},c.prototype.lt=function(M){return this.cmp(M)===-1},c.prototype.lten=function(M){return this.cmpn(M)<=0},c.prototype.lte=function(M){return this.cmp(M)<=0},c.prototype.eqn=function(M){return this.cmpn(M)===0},c.prototype.eq=function(M){return this.cmp(M)===0},c.red=function(M){return new K(M)},c.prototype.toRed=function(M){return a(!this.red,"Already a number in reduction context"),a(this.negative===0,"red works only with positives"),M.convertTo(this)._forceRed(M)},c.prototype.fromRed=function(){return a(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},c.prototype._forceRed=function(M){return this.red=M,this},c.prototype.forceRed=function(M){return a(!this.red,"Already a number in reduction context"),this._forceRed(M)},c.prototype.redAdd=function(M){return a(this.red,"redAdd works only with red numbers"),this.red.add(this,M)},c.prototype.redIAdd=function(M){return a(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,M)},c.prototype.redSub=function(M){return a(this.red,"redSub works only with red numbers"),this.red.sub(this,M)},c.prototype.redISub=function(M){return a(this.red,"redISub works only with red numbers"),this.red.isub(this,M)},c.prototype.redShl=function(M){return a(this.red,"redShl works only with red numbers"),this.red.shl(this,M)},c.prototype.redMul=function(M){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,M),this.red.mul(this,M)},c.prototype.redIMul=function(M){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,M),this.red.imul(this,M)},c.prototype.redSqr=function(){return a(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},c.prototype.redISqr=function(){return a(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},c.prototype.redSqrt=function(){return a(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},c.prototype.redInvm=function(){return a(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},c.prototype.redNeg=function(){return a(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},c.prototype.redPow=function(M){return a(this.red&&!M.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,M)};var F={k256:null,p224:null,p192:null,p25519:null};function I(M,B){this.name=M,this.p=new c(B,16),this.n=this.p.bitLength(),this.k=new c(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function N(){I.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function j(){I.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function L(){I.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function W(){I.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function K(M){if(typeof M=="string"){var B=c._prime(M);this.m=B.p,this.prime=B}else a(M.gtn(1),"modulus must be greater than 1"),this.m=M,this.prime=null}function z(M){K.call(this,M),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new c(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}I.prototype._tmp=function(){var M=new c(null);return M.words=new Array(Math.ceil(this.n/13)),M},I.prototype.ireduce=function(M){var B,R=M;do this.split(R,this.tmp),B=(R=(R=this.imulK(R)).iadd(this.tmp)).bitLength();while(B>this.n);var S=B<this.n?-1:R.ucmp(this.p);return S===0?(R.words[0]=0,R.length=1):S>0?R.isub(this.p):R.strip!==void 0?R.strip():R._strip(),R},I.prototype.split=function(M,B){M.iushrn(this.n,0,B)},I.prototype.imulK=function(M){return M.imul(this.k)},l(N,I),N.prototype.split=function(M,B){for(var R=Math.min(M.length,9),S=0;S<R;S++)B.words[S]=M.words[S];if(B.length=R,M.length<=9)return M.words[0]=0,void(M.length=1);var _=M.words[9];for(B.words[B.length++]=4194303&_,S=10;S<M.length;S++){var T=0|M.words[S];M.words[S-10]=(4194303&T)<<4|_>>>22,_=T}_>>>=22,M.words[S-10]=_,_===0&&M.length>10?M.length-=10:M.length-=9},N.prototype.imulK=function(M){M.words[M.length]=0,M.words[M.length+1]=0,M.length+=2;for(var B=0,R=0;R<M.length;R++){var S=0|M.words[R];B+=977*S,M.words[R]=67108863&B,B=64*S+(B/67108864|0)}return M.words[M.length-1]===0&&(M.length--,M.words[M.length-1]===0&&M.length--),M},l(j,I),l(L,I),l(W,I),W.prototype.imulK=function(M){for(var B=0,R=0;R<M.length;R++){var S=19*(0|M.words[R])+B,_=67108863&S;S>>>=26,M.words[R]=_,B=S}return B!==0&&(M.words[M.length++]=B),M},c._prime=function(M){if(F[M])return F[M];var B;if(M==="k256")B=new N;else if(M==="p224")B=new j;else if(M==="p192")B=new L;else{if(M!=="p25519")throw new Error("Unknown prime "+M);B=new W}return F[M]=B,B},K.prototype._verify1=function(M){a(M.negative===0,"red works only with positives"),a(M.red,"red works only with red numbers")},K.prototype._verify2=function(M,B){a((M.negative|B.negative)==0,"red works only with positives"),a(M.red&&M.red===B.red,"red works only with red numbers")},K.prototype.imod=function(M){return this.prime?this.prime.ireduce(M)._forceRed(this):M.umod(this.m)._forceRed(this)},K.prototype.neg=function(M){return M.isZero()?M.clone():this.m.sub(M)._forceRed(this)},K.prototype.add=function(M,B){this._verify2(M,B);var R=M.add(B);return R.cmp(this.m)>=0&&R.isub(this.m),R._forceRed(this)},K.prototype.iadd=function(M,B){this._verify2(M,B);var R=M.iadd(B);return R.cmp(this.m)>=0&&R.isub(this.m),R},K.prototype.sub=function(M,B){this._verify2(M,B);var R=M.sub(B);return R.cmpn(0)<0&&R.iadd(this.m),R._forceRed(this)},K.prototype.isub=function(M,B){this._verify2(M,B);var R=M.isub(B);return R.cmpn(0)<0&&R.iadd(this.m),R},K.prototype.shl=function(M,B){return this._verify1(M),this.imod(M.ushln(B))},K.prototype.imul=function(M,B){return this._verify2(M,B),this.imod(M.imul(B))},K.prototype.mul=function(M,B){return this._verify2(M,B),this.imod(M.mul(B))},K.prototype.isqr=function(M){return this.imul(M,M.clone())},K.prototype.sqr=function(M){return this.mul(M,M)},K.prototype.sqrt=function(M){if(M.isZero())return M.clone();var B=this.m.andln(3);if(a(B%2==1),B===3){var R=this.m.add(new c(1)).iushrn(2);return this.pow(M,R)}for(var S=this.m.subn(1),_=0;!S.isZero()&&S.andln(1)===0;)_++,S.iushrn(1);a(!S.isZero());var T=new c(1).toRed(this),E=T.redNeg(),D=this.m.subn(1).iushrn(1),O=this.m.bitLength();for(O=new c(2*O*O).toRed(this);this.pow(O,D).cmp(E)!==0;)O.redIAdd(E);for(var P=this.pow(O,S),q=this.pow(M,S.addn(1).iushrn(1)),X=this.pow(M,S),Q=_;X.cmp(T)!==0;){for(var G=X,ee=0;G.cmp(T)!==0;ee++)G=G.redSqr();a(ee<Q);var V=this.pow(P,new c(1).iushln(Q-ee-1));q=q.redMul(V),P=V.redSqr(),X=X.redMul(P),Q=ee}return q},K.prototype.invm=function(M){var B=M._invmp(this.m);return B.negative!==0?(B.negative=0,this.imod(B).redNeg()):this.imod(B)},K.prototype.pow=function(M,B){if(B.isZero())return new c(1).toRed(this);if(B.cmpn(1)===0)return M.clone();var R=new Array(16);R[0]=new c(1).toRed(this),R[1]=M;for(var S=2;S<R.length;S++)R[S]=this.mul(R[S-1],M);var _=R[0],T=0,E=0,D=B.bitLength()%26;for(D===0&&(D=26),S=B.length-1;S>=0;S--){for(var O=B.words[S],P=D-1;P>=0;P--){var q=O>>P&1;_!==R[0]&&(_=this.sqr(_)),q!==0||T!==0?(T<<=1,T|=q,(++E===4||S===0&&P===0)&&(_=this.mul(_,R[T]),E=0,T=0)):E=0}D=26}return _},K.prototype.convertTo=function(M){var B=M.umod(this.m);return B===M?B.clone():B},K.prototype.convertFrom=function(M){var B=M.clone();return B.red=null,B},c.mont=function(M){return new z(M)},l(z,K),z.prototype.convertTo=function(M){return this.imod(M.ushln(this.shift))},z.prototype.convertFrom=function(M){var B=this.imod(M.mul(this.rinv));return B.red=null,B},z.prototype.imul=function(M,B){if(M.isZero()||B.isZero())return M.words[0]=0,M.length=1,M;var R=M.imul(B),S=R.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),_=R.isub(S).iushrn(this.shift),T=_;return _.cmp(this.m)>=0?T=_.isub(this.m):_.cmpn(0)<0&&(T=_.iadd(this.m)),T._forceRed(this)},z.prototype.mul=function(M,B){if(M.isZero()||B.isZero())return new c(0)._forceRed(this);var R=M.mul(B),S=R.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),_=R.isub(S).iushrn(this.shift),T=_;return _.cmp(this.m)>=0?T=_.isub(this.m):_.cmpn(0)<0&&(T=_.iadd(this.m)),T._forceRed(this)},z.prototype.invm=function(M){return this.imod(M._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],185:[function(r,n,i){i.byteLength=function(f){var m=h(f),v=m[0],g=m[1];return 3*(v+g)/4-g},i.toByteArray=function(f){var m,v,g=h(f),w=g[0],y=g[1],C=new a((function(I,N,j){return 3*(N+j)/4-j})(0,w,y)),k=0,F=y>0?w-4:w;for(v=0;v<F;v+=4)m=o[f.charCodeAt(v)]<<18|o[f.charCodeAt(v+1)]<<12|o[f.charCodeAt(v+2)]<<6|o[f.charCodeAt(v+3)],C[k++]=m>>16&255,C[k++]=m>>8&255,C[k++]=255&m;return y===2&&(m=o[f.charCodeAt(v)]<<2|o[f.charCodeAt(v+1)]>>4,C[k++]=255&m),y===1&&(m=o[f.charCodeAt(v)]<<10|o[f.charCodeAt(v+1)]<<4|o[f.charCodeAt(v+2)]>>2,C[k++]=m>>8&255,C[k++]=255&m),C},i.fromByteArray=function(f){for(var m,v=f.length,g=v%3,w=[],y=0,C=v-g;y<C;y+=16383)w.push(d(f,y,y+16383>C?C:y+16383));return g===1?(m=f[v-1],w.push(s[m>>2]+s[m<<4&63]+"==")):g===2&&(m=(f[v-2]<<8)+f[v-1],w.push(s[m>>10]+s[m>>4&63]+s[m<<2&63]+"=")),w.join("")};for(var s=[],o=[],a=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,u=l.length;c<u;++c)s[c]=l[c],o[l.charCodeAt(c)]=c;function h(f){var m=f.length;if(m%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=f.indexOf("=");return v===-1&&(v=m),[v,v===m?0:4-v%4]}function d(f,m,v){for(var g,w,y=[],C=m;C<v;C+=3)g=(f[C]<<16&16711680)+(f[C+1]<<8&65280)+(255&f[C+2]),y.push(s[(w=g)>>18&63]+s[w>>12&63]+s[w>>6&63]+s[63&w]);return y.join("")}o[45]=62,o[95]=63},{}],186:[function(r,n,i){(function(s,o){function a(R,S){if(!R)throw new Error(S||"Assertion failed")}function l(R,S){R.super_=S;var _=function(){};_.prototype=S.prototype,R.prototype=new _,R.prototype.constructor=R}function c(R,S,_){if(c.isBN(R))return R;this.negative=0,this.words=null,this.length=0,this.red=null,R!==null&&(S!=="le"&&S!=="be"||(_=S,S=10),this._init(R||0,S||10,_||"be"))}var u;typeof s=="object"?s.exports=c:(void 0).BN=c,c.BN=c,c.wordSize=26;try{u=typeof window<"u"&&window.Buffer!==void 0?window.Buffer:r("buffer").Buffer}catch{}function h(R,S){var _=R.charCodeAt(S);return _>=48&&_<=57?_-48:_>=65&&_<=70?_-55:_>=97&&_<=102?_-87:void a(!1,"Invalid character in "+R)}function d(R,S,_){var T=h(R,_);return _-1>=S&&(T|=h(R,_-1)<<4),T}function f(R,S,_,T){for(var E=0,D=0,O=Math.min(R.length,_),P=S;P<O;P++){var q=R.charCodeAt(P)-48;E*=T,D=q>=49?q-49+10:q>=17?q-17+10:q,a(q>=0&&D<T,"Invalid character"),E+=D}return E}function m(R,S){R.words=S.words,R.length=S.length,R.negative=S.negative,R.red=S.red}if(c.isBN=function(R){return R instanceof c||R!==null&&typeof R=="object"&&R.constructor.wordSize===c.wordSize&&Array.isArray(R.words)},c.max=function(R,S){return R.cmp(S)>0?R:S},c.min=function(R,S){return R.cmp(S)<0?R:S},c.prototype._init=function(R,S,_){if(typeof R=="number")return this._initNumber(R,S,_);if(typeof R=="object")return this._initArray(R,S,_);S==="hex"&&(S=16),a(S===(0|S)&&S>=2&&S<=36);var T=0;(R=R.toString().replace(/\s+/g,""))[0]==="-"&&(T++,this.negative=1),T<R.length&&(S===16?this._parseHex(R,T,_):(this._parseBase(R,S,T),_==="le"&&this._initArray(this.toArray(),S,_)))},c.prototype._initNumber=function(R,S,_){R<0&&(this.negative=1,R=-R),R<67108864?(this.words=[67108863&R],this.length=1):R<4503599627370496?(this.words=[67108863&R,R/67108864&67108863],this.length=2):(a(R<9007199254740992),this.words=[67108863&R,R/67108864&67108863,1],this.length=3),_==="le"&&this._initArray(this.toArray(),S,_)},c.prototype._initArray=function(R,S,_){if(a(typeof R.length=="number"),R.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(R.length/3),this.words=new Array(this.length);for(var T=0;T<this.length;T++)this.words[T]=0;var E,D,O=0;if(_==="be")for(T=R.length-1,E=0;T>=0;T-=3)D=R[T]|R[T-1]<<8|R[T-2]<<16,this.words[E]|=D<<O&67108863,this.words[E+1]=D>>>26-O&67108863,(O+=24)>=26&&(O-=26,E++);else if(_==="le")for(T=0,E=0;T<R.length;T+=3)D=R[T]|R[T+1]<<8|R[T+2]<<16,this.words[E]|=D<<O&67108863,this.words[E+1]=D>>>26-O&67108863,(O+=24)>=26&&(O-=26,E++);return this._strip()},c.prototype._parseHex=function(R,S,_){this.length=Math.ceil((R.length-S)/6),this.words=new Array(this.length);for(var T=0;T<this.length;T++)this.words[T]=0;var E,D=0,O=0;if(_==="be")for(T=R.length-1;T>=S;T-=2)E=d(R,S,T)<<D,this.words[O]|=67108863&E,D>=18?(D-=18,O+=1,this.words[O]|=E>>>26):D+=8;else for(T=(R.length-S)%2==0?S+1:S;T<R.length;T+=2)E=d(R,S,T)<<D,this.words[O]|=67108863&E,D>=18?(D-=18,O+=1,this.words[O]|=E>>>26):D+=8;this._strip()},c.prototype._parseBase=function(R,S,_){this.words=[0],this.length=1;for(var T=0,E=1;E<=67108863;E*=S)T++;T--,E=E/S|0;for(var D=R.length-_,O=D%T,P=Math.min(D,D-O)+_,q=0,X=_;X<P;X+=T)q=f(R,X,X+T,S),this.imuln(E),this.words[0]+q<67108864?this.words[0]+=q:this._iaddn(q);if(O!==0){var Q=1;for(q=f(R,X,R.length,S),X=0;X<O;X++)Q*=S;this.imuln(Q),this.words[0]+q<67108864?this.words[0]+=q:this._iaddn(q)}this._strip()},c.prototype.copy=function(R){R.words=new Array(this.length);for(var S=0;S<this.length;S++)R.words[S]=this.words[S];R.length=this.length,R.negative=this.negative,R.red=this.red},c.prototype._move=function(R){m(R,this)},c.prototype.clone=function(){var R=new c(null);return this.copy(R),R},c.prototype._expand=function(R){for(;this.length<R;)this.words[this.length++]=0;return this},c.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},c.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{c.prototype[Symbol.for("nodejs.util.inspect.custom")]=v}catch{c.prototype.inspect=v}else c.prototype.inspect=v;function v(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var g=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],w=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];c.prototype.toString=function(R,S){var _;if(S=0|S||1,(R=R||10)===16||R==="hex"){_="";for(var T=0,E=0,D=0;D<this.length;D++){var O=this.words[D],P=(16777215&(O<<T|E)).toString(16);E=O>>>24-T&16777215,(T+=2)>=26&&(T-=26,D--),_=E!==0||D!==this.length-1?g[6-P.length]+P+_:P+_}for(E!==0&&(_=E.toString(16)+_);_.length%S!=0;)_="0"+_;return this.negative!==0&&(_="-"+_),_}if(R===(0|R)&&R>=2&&R<=36){var q=w[R],X=y[R];_="";var Q=this.clone();for(Q.negative=0;!Q.isZero();){var G=Q.modrn(X).toString(R);_=(Q=Q.idivn(X)).isZero()?G+_:g[q-G.length]+G+_}for(this.isZero()&&(_="0"+_);_.length%S!=0;)_="0"+_;return this.negative!==0&&(_="-"+_),_}a(!1,"Base should be between 2 and 36")},c.prototype.toNumber=function(){var R=this.words[0];return this.length===2?R+=67108864*this.words[1]:this.length===3&&this.words[2]===1?R+=4503599627370496+67108864*this.words[1]:this.length>2&&a(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-R:R},c.prototype.toJSON=function(){return this.toString(16,2)},u&&(c.prototype.toBuffer=function(R,S){return this.toArrayLike(u,R,S)}),c.prototype.toArray=function(R,S){return this.toArrayLike(Array,R,S)};function C(R,S,_){_.negative=S.negative^R.negative;var T=R.length+S.length|0;_.length=T,T=T-1|0;var E=0|R.words[0],D=0|S.words[0],O=E*D,P=67108863&O,q=O/67108864|0;_.words[0]=P;for(var X=1;X<T;X++){for(var Q=q>>>26,G=67108863&q,ee=Math.min(X,S.length-1),V=Math.max(0,X-R.length+1);V<=ee;V++){var H=X-V|0;Q+=(O=(E=0|R.words[H])*(D=0|S.words[V])+G)/67108864|0,G=67108863&O}_.words[X]=0|G,q=0|Q}return q!==0?_.words[X]=0|q:_.length--,_._strip()}c.prototype.toArrayLike=function(R,S,_){this._strip();var T=this.byteLength(),E=_||Math.max(1,T);a(T<=E,"byte array longer than desired length"),a(E>0,"Requested array length <= 0");var D=(function(O,P){return O.allocUnsafe?O.allocUnsafe(P):new O(P)})(R,E);return this["_toArrayLike"+(S==="le"?"LE":"BE")](D,T),D},c.prototype._toArrayLikeLE=function(R,S){for(var _=0,T=0,E=0,D=0;E<this.length;E++){var O=this.words[E]<<D|T;R[_++]=255&O,_<R.length&&(R[_++]=O>>8&255),_<R.length&&(R[_++]=O>>16&255),D===6?(_<R.length&&(R[_++]=O>>24&255),T=0,D=0):(T=O>>>24,D+=2)}if(_<R.length)for(R[_++]=T;_<R.length;)R[_++]=0},c.prototype._toArrayLikeBE=function(R,S){for(var _=R.length-1,T=0,E=0,D=0;E<this.length;E++){var O=this.words[E]<<D|T;R[_--]=255&O,_>=0&&(R[_--]=O>>8&255),_>=0&&(R[_--]=O>>16&255),D===6?(_>=0&&(R[_--]=O>>24&255),T=0,D=0):(T=O>>>24,D+=2)}if(_>=0)for(R[_--]=T;_>=0;)R[_--]=0},Math.clz32?c.prototype._countBits=function(R){return 32-Math.clz32(R)}:c.prototype._countBits=function(R){var S=R,_=0;return S>=4096&&(_+=13,S>>>=13),S>=64&&(_+=7,S>>>=7),S>=8&&(_+=4,S>>>=4),S>=2&&(_+=2,S>>>=2),_+S},c.prototype._zeroBits=function(R){if(R===0)return 26;var S=R,_=0;return(8191&S)==0&&(_+=13,S>>>=13),(127&S)==0&&(_+=7,S>>>=7),(15&S)==0&&(_+=4,S>>>=4),(3&S)==0&&(_+=2,S>>>=2),(1&S)==0&&_++,_},c.prototype.bitLength=function(){var R=this.words[this.length-1],S=this._countBits(R);return 26*(this.length-1)+S},c.prototype.zeroBits=function(){if(this.isZero())return 0;for(var R=0,S=0;S<this.length;S++){var _=this._zeroBits(this.words[S]);if(R+=_,_!==26)break}return R},c.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},c.prototype.toTwos=function(R){return this.negative!==0?this.abs().inotn(R).iaddn(1):this.clone()},c.prototype.fromTwos=function(R){return this.testn(R-1)?this.notn(R).iaddn(1).ineg():this.clone()},c.prototype.isNeg=function(){return this.negative!==0},c.prototype.neg=function(){return this.clone().ineg()},c.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},c.prototype.iuor=function(R){for(;this.length<R.length;)this.words[this.length++]=0;for(var S=0;S<R.length;S++)this.words[S]=this.words[S]|R.words[S];return this._strip()},c.prototype.ior=function(R){return a((this.negative|R.negative)==0),this.iuor(R)},c.prototype.or=function(R){return this.length>R.length?this.clone().ior(R):R.clone().ior(this)},c.prototype.uor=function(R){return this.length>R.length?this.clone().iuor(R):R.clone().iuor(this)},c.prototype.iuand=function(R){var S;S=this.length>R.length?R:this;for(var _=0;_<S.length;_++)this.words[_]=this.words[_]&R.words[_];return this.length=S.length,this._strip()},c.prototype.iand=function(R){return a((this.negative|R.negative)==0),this.iuand(R)},c.prototype.and=function(R){return this.length>R.length?this.clone().iand(R):R.clone().iand(this)},c.prototype.uand=function(R){return this.length>R.length?this.clone().iuand(R):R.clone().iuand(this)},c.prototype.iuxor=function(R){var S,_;this.length>R.length?(S=this,_=R):(S=R,_=this);for(var T=0;T<_.length;T++)this.words[T]=S.words[T]^_.words[T];if(this!==S)for(;T<S.length;T++)this.words[T]=S.words[T];return this.length=S.length,this._strip()},c.prototype.ixor=function(R){return a((this.negative|R.negative)==0),this.iuxor(R)},c.prototype.xor=function(R){return this.length>R.length?this.clone().ixor(R):R.clone().ixor(this)},c.prototype.uxor=function(R){return this.length>R.length?this.clone().iuxor(R):R.clone().iuxor(this)},c.prototype.inotn=function(R){a(typeof R=="number"&&R>=0);var S=0|Math.ceil(R/26),_=R%26;this._expand(S),_>0&&S--;for(var T=0;T<S;T++)this.words[T]=67108863&~this.words[T];return _>0&&(this.words[T]=~this.words[T]&67108863>>26-_),this._strip()},c.prototype.notn=function(R){return this.clone().inotn(R)},c.prototype.setn=function(R,S){a(typeof R=="number"&&R>=0);var _=R/26|0,T=R%26;return this._expand(_+1),this.words[_]=S?this.words[_]|1<<T:this.words[_]&~(1<<T),this._strip()},c.prototype.iadd=function(R){var S,_,T;if(this.negative!==0&&R.negative===0)return this.negative=0,S=this.isub(R),this.negative^=1,this._normSign();if(this.negative===0&&R.negative!==0)return R.negative=0,S=this.isub(R),R.negative=1,S._normSign();this.length>R.length?(_=this,T=R):(_=R,T=this);for(var E=0,D=0;D<T.length;D++)S=(0|_.words[D])+(0|T.words[D])+E,this.words[D]=67108863&S,E=S>>>26;for(;E!==0&&D<_.length;D++)S=(0|_.words[D])+E,this.words[D]=67108863&S,E=S>>>26;if(this.length=_.length,E!==0)this.words[this.length]=E,this.length++;else if(_!==this)for(;D<_.length;D++)this.words[D]=_.words[D];return this},c.prototype.add=function(R){var S;return R.negative!==0&&this.negative===0?(R.negative=0,S=this.sub(R),R.negative^=1,S):R.negative===0&&this.negative!==0?(this.negative=0,S=R.sub(this),this.negative=1,S):this.length>R.length?this.clone().iadd(R):R.clone().iadd(this)},c.prototype.isub=function(R){if(R.negative!==0){R.negative=0;var S=this.iadd(R);return R.negative=1,S._normSign()}if(this.negative!==0)return this.negative=0,this.iadd(R),this.negative=1,this._normSign();var _,T,E=this.cmp(R);if(E===0)return this.negative=0,this.length=1,this.words[0]=0,this;E>0?(_=this,T=R):(_=R,T=this);for(var D=0,O=0;O<T.length;O++)D=(S=(0|_.words[O])-(0|T.words[O])+D)>>26,this.words[O]=67108863&S;for(;D!==0&&O<_.length;O++)D=(S=(0|_.words[O])+D)>>26,this.words[O]=67108863&S;if(D===0&&O<_.length&&_!==this)for(;O<_.length;O++)this.words[O]=_.words[O];return this.length=Math.max(this.length,O),_!==this&&(this.negative=1),this._strip()},c.prototype.sub=function(R){return this.clone().isub(R)};var k=function(R,S,_){var T,E,D,O=R.words,P=S.words,q=_.words,X=0,Q=0|O[0],G=8191&Q,ee=Q>>>13,V=0|O[1],H=8191&V,Z=V>>>13,ie=0|O[2],te=8191&ie,oe=ie>>>13,ue=0|O[3],Ce=8191&ue,ye=ue>>>13,ne=0|O[4],me=8191&ne,ve=ne>>>13,Te=0|O[5],xe=8191&Te,Fe=Te>>>13,Ge=0|O[6],Ve=8191&Ge,Ye=Ge>>>13,ut=0|O[7],ht=8191&ut,be=ut>>>13,ze=0|O[8],we=8191&ze,Ee=ze>>>13,Ie=0|O[9],Pe=8191&Ie,De=Ie>>>13,Ze=0|P[0],pt=8191&Ze,yt=Ze>>>13,Pt=0|P[1],$t=8191&Pt,Ct=Pt>>>13,It=0|P[2],Ut=8191&It,_t=It>>>13,sr=0|P[3],Jt=8191&sr,Tt=sr>>>13,nr=0|P[4],vr=8191&nr,At=nr>>>13,fr=0|P[5],yr=8191&fr,Ot=fr>>>13,ke=0|P[6],He=8191&ke,Xe=ke>>>13,se=0|P[7],pe=8191&se,le=se>>>13,de=0|P[8],fe=8191&de,ge=de>>>13,Re=0|P[9],je=8191&Re,Me=Re>>>13;_.negative=R.negative^S.negative,_.length=19;var Be=(X+(T=Math.imul(G,pt))|0)+((8191&(E=(E=Math.imul(G,yt))+Math.imul(ee,pt)|0))<<13)|0;X=((D=Math.imul(ee,yt))+(E>>>13)|0)+(Be>>>26)|0,Be&=67108863,T=Math.imul(H,pt),E=(E=Math.imul(H,yt))+Math.imul(Z,pt)|0,D=Math.imul(Z,yt);var Oe=(X+(T=T+Math.imul(G,$t)|0)|0)+((8191&(E=(E=E+Math.imul(G,Ct)|0)+Math.imul(ee,$t)|0))<<13)|0;X=((D=D+Math.imul(ee,Ct)|0)+(E>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,T=Math.imul(te,pt),E=(E=Math.imul(te,yt))+Math.imul(oe,pt)|0,D=Math.imul(oe,yt),T=T+Math.imul(H,$t)|0,E=(E=E+Math.imul(H,Ct)|0)+Math.imul(Z,$t)|0,D=D+Math.imul(Z,Ct)|0;var nt=(X+(T=T+Math.imul(G,Ut)|0)|0)+((8191&(E=(E=E+Math.imul(G,_t)|0)+Math.imul(ee,Ut)|0))<<13)|0;X=((D=D+Math.imul(ee,_t)|0)+(E>>>13)|0)+(nt>>>26)|0,nt&=67108863,T=Math.imul(Ce,pt),E=(E=Math.imul(Ce,yt))+Math.imul(ye,pt)|0,D=Math.imul(ye,yt),T=T+Math.imul(te,$t)|0,E=(E=E+Math.imul(te,Ct)|0)+Math.imul(oe,$t)|0,D=D+Math.imul(oe,Ct)|0,T=T+Math.imul(H,Ut)|0,E=(E=E+Math.imul(H,_t)|0)+Math.imul(Z,Ut)|0,D=D+Math.imul(Z,_t)|0;var ct=(X+(T=T+Math.imul(G,Jt)|0)|0)+((8191&(E=(E=E+Math.imul(G,Tt)|0)+Math.imul(ee,Jt)|0))<<13)|0;X=((D=D+Math.imul(ee,Tt)|0)+(E>>>13)|0)+(ct>>>26)|0,ct&=67108863,T=Math.imul(me,pt),E=(E=Math.imul(me,yt))+Math.imul(ve,pt)|0,D=Math.imul(ve,yt),T=T+Math.imul(Ce,$t)|0,E=(E=E+Math.imul(Ce,Ct)|0)+Math.imul(ye,$t)|0,D=D+Math.imul(ye,Ct)|0,T=T+Math.imul(te,Ut)|0,E=(E=E+Math.imul(te,_t)|0)+Math.imul(oe,Ut)|0,D=D+Math.imul(oe,_t)|0,T=T+Math.imul(H,Jt)|0,E=(E=E+Math.imul(H,Tt)|0)+Math.imul(Z,Jt)|0,D=D+Math.imul(Z,Tt)|0;var ft=(X+(T=T+Math.imul(G,vr)|0)|0)+((8191&(E=(E=E+Math.imul(G,At)|0)+Math.imul(ee,vr)|0))<<13)|0;X=((D=D+Math.imul(ee,At)|0)+(E>>>13)|0)+(ft>>>26)|0,ft&=67108863,T=Math.imul(xe,pt),E=(E=Math.imul(xe,yt))+Math.imul(Fe,pt)|0,D=Math.imul(Fe,yt),T=T+Math.imul(me,$t)|0,E=(E=E+Math.imul(me,Ct)|0)+Math.imul(ve,$t)|0,D=D+Math.imul(ve,Ct)|0,T=T+Math.imul(Ce,Ut)|0,E=(E=E+Math.imul(Ce,_t)|0)+Math.imul(ye,Ut)|0,D=D+Math.imul(ye,_t)|0,T=T+Math.imul(te,Jt)|0,E=(E=E+Math.imul(te,Tt)|0)+Math.imul(oe,Jt)|0,D=D+Math.imul(oe,Tt)|0,T=T+Math.imul(H,vr)|0,E=(E=E+Math.imul(H,At)|0)+Math.imul(Z,vr)|0,D=D+Math.imul(Z,At)|0;var ce=(X+(T=T+Math.imul(G,yr)|0)|0)+((8191&(E=(E=E+Math.imul(G,Ot)|0)+Math.imul(ee,yr)|0))<<13)|0;X=((D=D+Math.imul(ee,Ot)|0)+(E>>>13)|0)+(ce>>>26)|0,ce&=67108863,T=Math.imul(Ve,pt),E=(E=Math.imul(Ve,yt))+Math.imul(Ye,pt)|0,D=Math.imul(Ye,yt),T=T+Math.imul(xe,$t)|0,E=(E=E+Math.imul(xe,Ct)|0)+Math.imul(Fe,$t)|0,D=D+Math.imul(Fe,Ct)|0,T=T+Math.imul(me,Ut)|0,E=(E=E+Math.imul(me,_t)|0)+Math.imul(ve,Ut)|0,D=D+Math.imul(ve,_t)|0,T=T+Math.imul(Ce,Jt)|0,E=(E=E+Math.imul(Ce,Tt)|0)+Math.imul(ye,Jt)|0,D=D+Math.imul(ye,Tt)|0,T=T+Math.imul(te,vr)|0,E=(E=E+Math.imul(te,At)|0)+Math.imul(oe,vr)|0,D=D+Math.imul(oe,At)|0,T=T+Math.imul(H,yr)|0,E=(E=E+Math.imul(H,Ot)|0)+Math.imul(Z,yr)|0,D=D+Math.imul(Z,Ot)|0;var Se=(X+(T=T+Math.imul(G,He)|0)|0)+((8191&(E=(E=E+Math.imul(G,Xe)|0)+Math.imul(ee,He)|0))<<13)|0;X=((D=D+Math.imul(ee,Xe)|0)+(E>>>13)|0)+(Se>>>26)|0,Se&=67108863,T=Math.imul(ht,pt),E=(E=Math.imul(ht,yt))+Math.imul(be,pt)|0,D=Math.imul(be,yt),T=T+Math.imul(Ve,$t)|0,E=(E=E+Math.imul(Ve,Ct)|0)+Math.imul(Ye,$t)|0,D=D+Math.imul(Ye,Ct)|0,T=T+Math.imul(xe,Ut)|0,E=(E=E+Math.imul(xe,_t)|0)+Math.imul(Fe,Ut)|0,D=D+Math.imul(Fe,_t)|0,T=T+Math.imul(me,Jt)|0,E=(E=E+Math.imul(me,Tt)|0)+Math.imul(ve,Jt)|0,D=D+Math.imul(ve,Tt)|0,T=T+Math.imul(Ce,vr)|0,E=(E=E+Math.imul(Ce,At)|0)+Math.imul(ye,vr)|0,D=D+Math.imul(ye,At)|0,T=T+Math.imul(te,yr)|0,E=(E=E+Math.imul(te,Ot)|0)+Math.imul(oe,yr)|0,D=D+Math.imul(oe,Ot)|0,T=T+Math.imul(H,He)|0,E=(E=E+Math.imul(H,Xe)|0)+Math.imul(Z,He)|0,D=D+Math.imul(Z,Xe)|0;var Le=(X+(T=T+Math.imul(G,pe)|0)|0)+((8191&(E=(E=E+Math.imul(G,le)|0)+Math.imul(ee,pe)|0))<<13)|0;X=((D=D+Math.imul(ee,le)|0)+(E>>>13)|0)+(Le>>>26)|0,Le&=67108863,T=Math.imul(we,pt),E=(E=Math.imul(we,yt))+Math.imul(Ee,pt)|0,D=Math.imul(Ee,yt),T=T+Math.imul(ht,$t)|0,E=(E=E+Math.imul(ht,Ct)|0)+Math.imul(be,$t)|0,D=D+Math.imul(be,Ct)|0,T=T+Math.imul(Ve,Ut)|0,E=(E=E+Math.imul(Ve,_t)|0)+Math.imul(Ye,Ut)|0,D=D+Math.imul(Ye,_t)|0,T=T+Math.imul(xe,Jt)|0,E=(E=E+Math.imul(xe,Tt)|0)+Math.imul(Fe,Jt)|0,D=D+Math.imul(Fe,Tt)|0,T=T+Math.imul(me,vr)|0,E=(E=E+Math.imul(me,At)|0)+Math.imul(ve,vr)|0,D=D+Math.imul(ve,At)|0,T=T+Math.imul(Ce,yr)|0,E=(E=E+Math.imul(Ce,Ot)|0)+Math.imul(ye,yr)|0,D=D+Math.imul(ye,Ot)|0,T=T+Math.imul(te,He)|0,E=(E=E+Math.imul(te,Xe)|0)+Math.imul(oe,He)|0,D=D+Math.imul(oe,Xe)|0,T=T+Math.imul(H,pe)|0,E=(E=E+Math.imul(H,le)|0)+Math.imul(Z,pe)|0,D=D+Math.imul(Z,le)|0;var Qe=(X+(T=T+Math.imul(G,fe)|0)|0)+((8191&(E=(E=E+Math.imul(G,ge)|0)+Math.imul(ee,fe)|0))<<13)|0;X=((D=D+Math.imul(ee,ge)|0)+(E>>>13)|0)+(Qe>>>26)|0,Qe&=67108863,T=Math.imul(Pe,pt),E=(E=Math.imul(Pe,yt))+Math.imul(De,pt)|0,D=Math.imul(De,yt),T=T+Math.imul(we,$t)|0,E=(E=E+Math.imul(we,Ct)|0)+Math.imul(Ee,$t)|0,D=D+Math.imul(Ee,Ct)|0,T=T+Math.imul(ht,Ut)|0,E=(E=E+Math.imul(ht,_t)|0)+Math.imul(be,Ut)|0,D=D+Math.imul(be,_t)|0,T=T+Math.imul(Ve,Jt)|0,E=(E=E+Math.imul(Ve,Tt)|0)+Math.imul(Ye,Jt)|0,D=D+Math.imul(Ye,Tt)|0,T=T+Math.imul(xe,vr)|0,E=(E=E+Math.imul(xe,At)|0)+Math.imul(Fe,vr)|0,D=D+Math.imul(Fe,At)|0,T=T+Math.imul(me,yr)|0,E=(E=E+Math.imul(me,Ot)|0)+Math.imul(ve,yr)|0,D=D+Math.imul(ve,Ot)|0,T=T+Math.imul(Ce,He)|0,E=(E=E+Math.imul(Ce,Xe)|0)+Math.imul(ye,He)|0,D=D+Math.imul(ye,Xe)|0,T=T+Math.imul(te,pe)|0,E=(E=E+Math.imul(te,le)|0)+Math.imul(oe,pe)|0,D=D+Math.imul(oe,le)|0,T=T+Math.imul(H,fe)|0,E=(E=E+Math.imul(H,ge)|0)+Math.imul(Z,fe)|0,D=D+Math.imul(Z,ge)|0;var gt=(X+(T=T+Math.imul(G,je)|0)|0)+((8191&(E=(E=E+Math.imul(G,Me)|0)+Math.imul(ee,je)|0))<<13)|0;X=((D=D+Math.imul(ee,Me)|0)+(E>>>13)|0)+(gt>>>26)|0,gt&=67108863,T=Math.imul(Pe,$t),E=(E=Math.imul(Pe,Ct))+Math.imul(De,$t)|0,D=Math.imul(De,Ct),T=T+Math.imul(we,Ut)|0,E=(E=E+Math.imul(we,_t)|0)+Math.imul(Ee,Ut)|0,D=D+Math.imul(Ee,_t)|0,T=T+Math.imul(ht,Jt)|0,E=(E=E+Math.imul(ht,Tt)|0)+Math.imul(be,Jt)|0,D=D+Math.imul(be,Tt)|0,T=T+Math.imul(Ve,vr)|0,E=(E=E+Math.imul(Ve,At)|0)+Math.imul(Ye,vr)|0,D=D+Math.imul(Ye,At)|0,T=T+Math.imul(xe,yr)|0,E=(E=E+Math.imul(xe,Ot)|0)+Math.imul(Fe,yr)|0,D=D+Math.imul(Fe,Ot)|0,T=T+Math.imul(me,He)|0,E=(E=E+Math.imul(me,Xe)|0)+Math.imul(ve,He)|0,D=D+Math.imul(ve,Xe)|0,T=T+Math.imul(Ce,pe)|0,E=(E=E+Math.imul(Ce,le)|0)+Math.imul(ye,pe)|0,D=D+Math.imul(ye,le)|0,T=T+Math.imul(te,fe)|0,E=(E=E+Math.imul(te,ge)|0)+Math.imul(oe,fe)|0,D=D+Math.imul(oe,ge)|0;var ot=(X+(T=T+Math.imul(H,je)|0)|0)+((8191&(E=(E=E+Math.imul(H,Me)|0)+Math.imul(Z,je)|0))<<13)|0;X=((D=D+Math.imul(Z,Me)|0)+(E>>>13)|0)+(ot>>>26)|0,ot&=67108863,T=Math.imul(Pe,Ut),E=(E=Math.imul(Pe,_t))+Math.imul(De,Ut)|0,D=Math.imul(De,_t),T=T+Math.imul(we,Jt)|0,E=(E=E+Math.imul(we,Tt)|0)+Math.imul(Ee,Jt)|0,D=D+Math.imul(Ee,Tt)|0,T=T+Math.imul(ht,vr)|0,E=(E=E+Math.imul(ht,At)|0)+Math.imul(be,vr)|0,D=D+Math.imul(be,At)|0,T=T+Math.imul(Ve,yr)|0,E=(E=E+Math.imul(Ve,Ot)|0)+Math.imul(Ye,yr)|0,D=D+Math.imul(Ye,Ot)|0,T=T+Math.imul(xe,He)|0,E=(E=E+Math.imul(xe,Xe)|0)+Math.imul(Fe,He)|0,D=D+Math.imul(Fe,Xe)|0,T=T+Math.imul(me,pe)|0,E=(E=E+Math.imul(me,le)|0)+Math.imul(ve,pe)|0,D=D+Math.imul(ve,le)|0,T=T+Math.imul(Ce,fe)|0,E=(E=E+Math.imul(Ce,ge)|0)+Math.imul(ye,fe)|0,D=D+Math.imul(ye,ge)|0;var dt=(X+(T=T+Math.imul(te,je)|0)|0)+((8191&(E=(E=E+Math.imul(te,Me)|0)+Math.imul(oe,je)|0))<<13)|0;X=((D=D+Math.imul(oe,Me)|0)+(E>>>13)|0)+(dt>>>26)|0,dt&=67108863,T=Math.imul(Pe,Jt),E=(E=Math.imul(Pe,Tt))+Math.imul(De,Jt)|0,D=Math.imul(De,Tt),T=T+Math.imul(we,vr)|0,E=(E=E+Math.imul(we,At)|0)+Math.imul(Ee,vr)|0,D=D+Math.imul(Ee,At)|0,T=T+Math.imul(ht,yr)|0,E=(E=E+Math.imul(ht,Ot)|0)+Math.imul(be,yr)|0,D=D+Math.imul(be,Ot)|0,T=T+Math.imul(Ve,He)|0,E=(E=E+Math.imul(Ve,Xe)|0)+Math.imul(Ye,He)|0,D=D+Math.imul(Ye,Xe)|0,T=T+Math.imul(xe,pe)|0,E=(E=E+Math.imul(xe,le)|0)+Math.imul(Fe,pe)|0,D=D+Math.imul(Fe,le)|0,T=T+Math.imul(me,fe)|0,E=(E=E+Math.imul(me,ge)|0)+Math.imul(ve,fe)|0,D=D+Math.imul(ve,ge)|0;var Kt=(X+(T=T+Math.imul(Ce,je)|0)|0)+((8191&(E=(E=E+Math.imul(Ce,Me)|0)+Math.imul(ye,je)|0))<<13)|0;X=((D=D+Math.imul(ye,Me)|0)+(E>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,T=Math.imul(Pe,vr),E=(E=Math.imul(Pe,At))+Math.imul(De,vr)|0,D=Math.imul(De,At),T=T+Math.imul(we,yr)|0,E=(E=E+Math.imul(we,Ot)|0)+Math.imul(Ee,yr)|0,D=D+Math.imul(Ee,Ot)|0,T=T+Math.imul(ht,He)|0,E=(E=E+Math.imul(ht,Xe)|0)+Math.imul(be,He)|0,D=D+Math.imul(be,Xe)|0,T=T+Math.imul(Ve,pe)|0,E=(E=E+Math.imul(Ve,le)|0)+Math.imul(Ye,pe)|0,D=D+Math.imul(Ye,le)|0,T=T+Math.imul(xe,fe)|0,E=(E=E+Math.imul(xe,ge)|0)+Math.imul(Fe,fe)|0,D=D+Math.imul(Fe,ge)|0;var Nt=(X+(T=T+Math.imul(me,je)|0)|0)+((8191&(E=(E=E+Math.imul(me,Me)|0)+Math.imul(ve,je)|0))<<13)|0;X=((D=D+Math.imul(ve,Me)|0)+(E>>>13)|0)+(Nt>>>26)|0,Nt&=67108863,T=Math.imul(Pe,yr),E=(E=Math.imul(Pe,Ot))+Math.imul(De,yr)|0,D=Math.imul(De,Ot),T=T+Math.imul(we,He)|0,E=(E=E+Math.imul(we,Xe)|0)+Math.imul(Ee,He)|0,D=D+Math.imul(Ee,Xe)|0,T=T+Math.imul(ht,pe)|0,E=(E=E+Math.imul(ht,le)|0)+Math.imul(be,pe)|0,D=D+Math.imul(be,le)|0,T=T+Math.imul(Ve,fe)|0,E=(E=E+Math.imul(Ve,ge)|0)+Math.imul(Ye,fe)|0,D=D+Math.imul(Ye,ge)|0;var Lt=(X+(T=T+Math.imul(xe,je)|0)|0)+((8191&(E=(E=E+Math.imul(xe,Me)|0)+Math.imul(Fe,je)|0))<<13)|0;X=((D=D+Math.imul(Fe,Me)|0)+(E>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,T=Math.imul(Pe,He),E=(E=Math.imul(Pe,Xe))+Math.imul(De,He)|0,D=Math.imul(De,Xe),T=T+Math.imul(we,pe)|0,E=(E=E+Math.imul(we,le)|0)+Math.imul(Ee,pe)|0,D=D+Math.imul(Ee,le)|0,T=T+Math.imul(ht,fe)|0,E=(E=E+Math.imul(ht,ge)|0)+Math.imul(be,fe)|0,D=D+Math.imul(be,ge)|0;var kt=(X+(T=T+Math.imul(Ve,je)|0)|0)+((8191&(E=(E=E+Math.imul(Ve,Me)|0)+Math.imul(Ye,je)|0))<<13)|0;X=((D=D+Math.imul(Ye,Me)|0)+(E>>>13)|0)+(kt>>>26)|0,kt&=67108863,T=Math.imul(Pe,pe),E=(E=Math.imul(Pe,le))+Math.imul(De,pe)|0,D=Math.imul(De,le),T=T+Math.imul(we,fe)|0,E=(E=E+Math.imul(we,ge)|0)+Math.imul(Ee,fe)|0,D=D+Math.imul(Ee,ge)|0;var qt=(X+(T=T+Math.imul(ht,je)|0)|0)+((8191&(E=(E=E+Math.imul(ht,Me)|0)+Math.imul(be,je)|0))<<13)|0;X=((D=D+Math.imul(be,Me)|0)+(E>>>13)|0)+(qt>>>26)|0,qt&=67108863,T=Math.imul(Pe,fe),E=(E=Math.imul(Pe,ge))+Math.imul(De,fe)|0,D=Math.imul(De,ge);var br=(X+(T=T+Math.imul(we,je)|0)|0)+((8191&(E=(E=E+Math.imul(we,Me)|0)+Math.imul(Ee,je)|0))<<13)|0;X=((D=D+Math.imul(Ee,Me)|0)+(E>>>13)|0)+(br>>>26)|0,br&=67108863;var or=(X+(T=Math.imul(Pe,je))|0)+((8191&(E=(E=Math.imul(Pe,Me))+Math.imul(De,je)|0))<<13)|0;return X=((D=Math.imul(De,Me))+(E>>>13)|0)+(or>>>26)|0,or&=67108863,q[0]=Be,q[1]=Oe,q[2]=nt,q[3]=ct,q[4]=ft,q[5]=ce,q[6]=Se,q[7]=Le,q[8]=Qe,q[9]=gt,q[10]=ot,q[11]=dt,q[12]=Kt,q[13]=Nt,q[14]=Lt,q[15]=kt,q[16]=qt,q[17]=br,q[18]=or,X!==0&&(q[19]=X,_.length++),_};function F(R,S,_){_.negative=S.negative^R.negative,_.length=R.length+S.length;for(var T=0,E=0,D=0;D<_.length-1;D++){var O=E;E=0;for(var P=67108863&T,q=Math.min(D,S.length-1),X=Math.max(0,D-R.length+1);X<=q;X++){var Q=D-X,G=(0|R.words[Q])*(0|S.words[X]),ee=67108863&G;P=67108863&(ee=ee+P|0),E+=(O=(O=O+(G/67108864|0)|0)+(ee>>>26)|0)>>>26,O&=67108863}_.words[D]=P,T=O,O=E}return T!==0?_.words[D]=T:_.length--,_._strip()}function I(R,S,_){return F(R,S,_)}Math.imul||(k=C),c.prototype.mulTo=function(R,S){var _=this.length+R.length;return this.length===10&&R.length===10?k(this,R,S):_<63?C(this,R,S):_<1024?F(this,R,S):I(this,R,S)},c.prototype.mul=function(R){var S=new c(null);return S.words=new Array(this.length+R.length),this.mulTo(R,S)},c.prototype.mulf=function(R){var S=new c(null);return S.words=new Array(this.length+R.length),I(this,R,S)},c.prototype.imul=function(R){return this.clone().mulTo(R,this)},c.prototype.imuln=function(R){var S=R<0;S&&(R=-R),a(typeof R=="number"),a(R<67108864);for(var _=0,T=0;T<this.length;T++){var E=(0|this.words[T])*R,D=(67108863&E)+(67108863&_);_>>=26,_+=E/67108864|0,_+=D>>>26,this.words[T]=67108863&D}return _!==0&&(this.words[T]=_,this.length++),S?this.ineg():this},c.prototype.muln=function(R){return this.clone().imuln(R)},c.prototype.sqr=function(){return this.mul(this)},c.prototype.isqr=function(){return this.imul(this.clone())},c.prototype.pow=function(R){var S=(function(D){for(var O=new Array(D.bitLength()),P=0;P<O.length;P++){var q=P/26|0,X=P%26;O[P]=D.words[q]>>>X&1}return O})(R);if(S.length===0)return new c(1);for(var _=this,T=0;T<S.length&&S[T]===0;T++,_=_.sqr());if(++T<S.length)for(var E=_.sqr();T<S.length;T++,E=E.sqr())S[T]!==0&&(_=_.mul(E));return _},c.prototype.iushln=function(R){a(typeof R=="number"&&R>=0);var S,_=R%26,T=(R-_)/26,E=67108863>>>26-_<<26-_;if(_!==0){var D=0;for(S=0;S<this.length;S++){var O=this.words[S]&E,P=(0|this.words[S])-O<<_;this.words[S]=P|D,D=O>>>26-_}D&&(this.words[S]=D,this.length++)}if(T!==0){for(S=this.length-1;S>=0;S--)this.words[S+T]=this.words[S];for(S=0;S<T;S++)this.words[S]=0;this.length+=T}return this._strip()},c.prototype.ishln=function(R){return a(this.negative===0),this.iushln(R)},c.prototype.iushrn=function(R,S,_){var T;a(typeof R=="number"&&R>=0),T=S?(S-S%26)/26:0;var E=R%26,D=Math.min((R-E)/26,this.length),O=67108863^67108863>>>E<<E,P=_;if(T-=D,T=Math.max(0,T),P){for(var q=0;q<D;q++)P.words[q]=this.words[q];P.length=D}if(D!==0)if(this.length>D)for(this.length-=D,q=0;q<this.length;q++)this.words[q]=this.words[q+D];else this.words[0]=0,this.length=1;var X=0;for(q=this.length-1;q>=0&&(X!==0||q>=T);q--){var Q=0|this.words[q];this.words[q]=X<<26-E|Q>>>E,X=Q&O}return P&&X!==0&&(P.words[P.length++]=X),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},c.prototype.ishrn=function(R,S,_){return a(this.negative===0),this.iushrn(R,S,_)},c.prototype.shln=function(R){return this.clone().ishln(R)},c.prototype.ushln=function(R){return this.clone().iushln(R)},c.prototype.shrn=function(R){return this.clone().ishrn(R)},c.prototype.ushrn=function(R){return this.clone().iushrn(R)},c.prototype.testn=function(R){a(typeof R=="number"&&R>=0);var S=R%26,_=(R-S)/26,T=1<<S;return!(this.length<=_)&&!!(this.words[_]&T)},c.prototype.imaskn=function(R){a(typeof R=="number"&&R>=0);var S=R%26,_=(R-S)/26;if(a(this.negative===0,"imaskn works only with positive numbers"),this.length<=_)return this;if(S!==0&&_++,this.length=Math.min(_,this.length),S!==0){var T=67108863^67108863>>>S<<S;this.words[this.length-1]&=T}return this._strip()},c.prototype.maskn=function(R){return this.clone().imaskn(R)},c.prototype.iaddn=function(R){return a(typeof R=="number"),a(R<67108864),R<0?this.isubn(-R):this.negative!==0?this.length===1&&(0|this.words[0])<=R?(this.words[0]=R-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(R),this.negative=1,this):this._iaddn(R)},c.prototype._iaddn=function(R){this.words[0]+=R;for(var S=0;S<this.length&&this.words[S]>=67108864;S++)this.words[S]-=67108864,S===this.length-1?this.words[S+1]=1:this.words[S+1]++;return this.length=Math.max(this.length,S+1),this},c.prototype.isubn=function(R){if(a(typeof R=="number"),a(R<67108864),R<0)return this.iaddn(-R);if(this.negative!==0)return this.negative=0,this.iaddn(R),this.negative=1,this;if(this.words[0]-=R,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var S=0;S<this.length&&this.words[S]<0;S++)this.words[S]+=67108864,this.words[S+1]-=1;return this._strip()},c.prototype.addn=function(R){return this.clone().iaddn(R)},c.prototype.subn=function(R){return this.clone().isubn(R)},c.prototype.iabs=function(){return this.negative=0,this},c.prototype.abs=function(){return this.clone().iabs()},c.prototype._ishlnsubmul=function(R,S,_){var T,E,D=R.length+_;this._expand(D);var O=0;for(T=0;T<R.length;T++){E=(0|this.words[T+_])+O;var P=(0|R.words[T])*S;O=((E-=67108863&P)>>26)-(P/67108864|0),this.words[T+_]=67108863&E}for(;T<this.length-_;T++)O=(E=(0|this.words[T+_])+O)>>26,this.words[T+_]=67108863&E;if(O===0)return this._strip();for(a(O===-1),O=0,T=0;T<this.length;T++)O=(E=-(0|this.words[T])+O)>>26,this.words[T]=67108863&E;return this.negative=1,this._strip()},c.prototype._wordDiv=function(R,S){var _=(this.length,R.length),T=this.clone(),E=R,D=0|E.words[E.length-1];(_=26-this._countBits(D))!==0&&(E=E.ushln(_),T.iushln(_),D=0|E.words[E.length-1]);var O,P=T.length-E.length;if(S!=="mod"){(O=new c(null)).length=P+1,O.words=new Array(O.length);for(var q=0;q<O.length;q++)O.words[q]=0}var X=T.clone()._ishlnsubmul(E,1,P);X.negative===0&&(T=X,O&&(O.words[P]=1));for(var Q=P-1;Q>=0;Q--){var G=67108864*(0|T.words[E.length+Q])+(0|T.words[E.length+Q-1]);for(G=Math.min(G/D|0,67108863),T._ishlnsubmul(E,G,Q);T.negative!==0;)G--,T.negative=0,T._ishlnsubmul(E,1,Q),T.isZero()||(T.negative^=1);O&&(O.words[Q]=G)}return O&&O._strip(),T._strip(),S!=="div"&&_!==0&&T.iushrn(_),{div:O||null,mod:T}},c.prototype.divmod=function(R,S,_){return a(!R.isZero()),this.isZero()?{div:new c(0),mod:new c(0)}:this.negative!==0&&R.negative===0?(D=this.neg().divmod(R,S),S!=="mod"&&(T=D.div.neg()),S!=="div"&&(E=D.mod.neg(),_&&E.negative!==0&&E.iadd(R)),{div:T,mod:E}):this.negative===0&&R.negative!==0?(D=this.divmod(R.neg(),S),S!=="mod"&&(T=D.div.neg()),{div:T,mod:D.mod}):(this.negative&R.negative)!=0?(D=this.neg().divmod(R.neg(),S),S!=="div"&&(E=D.mod.neg(),_&&E.negative!==0&&E.isub(R)),{div:D.div,mod:E}):R.length>this.length||this.cmp(R)<0?{div:new c(0),mod:this}:R.length===1?S==="div"?{div:this.divn(R.words[0]),mod:null}:S==="mod"?{div:null,mod:new c(this.modrn(R.words[0]))}:{div:this.divn(R.words[0]),mod:new c(this.modrn(R.words[0]))}:this._wordDiv(R,S);var T,E,D},c.prototype.div=function(R){return this.divmod(R,"div",!1).div},c.prototype.mod=function(R){return this.divmod(R,"mod",!1).mod},c.prototype.umod=function(R){return this.divmod(R,"mod",!0).mod},c.prototype.divRound=function(R){var S=this.divmod(R);if(S.mod.isZero())return S.div;var _=S.div.negative!==0?S.mod.isub(R):S.mod,T=R.ushrn(1),E=R.andln(1),D=_.cmp(T);return D<0||E===1&&D===0?S.div:S.div.negative!==0?S.div.isubn(1):S.div.iaddn(1)},c.prototype.modrn=function(R){var S=R<0;S&&(R=-R),a(R<=67108863);for(var _=(1<<26)%R,T=0,E=this.length-1;E>=0;E--)T=(_*T+(0|this.words[E]))%R;return S?-T:T},c.prototype.modn=function(R){return this.modrn(R)},c.prototype.idivn=function(R){var S=R<0;S&&(R=-R),a(R<=67108863);for(var _=0,T=this.length-1;T>=0;T--){var E=(0|this.words[T])+67108864*_;this.words[T]=E/R|0,_=E%R}return this._strip(),S?this.ineg():this},c.prototype.divn=function(R){return this.clone().idivn(R)},c.prototype.egcd=function(R){a(R.negative===0),a(!R.isZero());var S=this,_=R.clone();S=S.negative!==0?S.umod(R):S.clone();for(var T=new c(1),E=new c(0),D=new c(0),O=new c(1),P=0;S.isEven()&&_.isEven();)S.iushrn(1),_.iushrn(1),++P;for(var q=_.clone(),X=S.clone();!S.isZero();){for(var Q=0,G=1;(S.words[0]&G)==0&&Q<26;++Q,G<<=1);if(Q>0)for(S.iushrn(Q);Q-- >0;)(T.isOdd()||E.isOdd())&&(T.iadd(q),E.isub(X)),T.iushrn(1),E.iushrn(1);for(var ee=0,V=1;(_.words[0]&V)==0&&ee<26;++ee,V<<=1);if(ee>0)for(_.iushrn(ee);ee-- >0;)(D.isOdd()||O.isOdd())&&(D.iadd(q),O.isub(X)),D.iushrn(1),O.iushrn(1);S.cmp(_)>=0?(S.isub(_),T.isub(D),E.isub(O)):(_.isub(S),D.isub(T),O.isub(E))}return{a:D,b:O,gcd:_.iushln(P)}},c.prototype._invmp=function(R){a(R.negative===0),a(!R.isZero());var S=this,_=R.clone();S=S.negative!==0?S.umod(R):S.clone();for(var T,E=new c(1),D=new c(0),O=_.clone();S.cmpn(1)>0&&_.cmpn(1)>0;){for(var P=0,q=1;(S.words[0]&q)==0&&P<26;++P,q<<=1);if(P>0)for(S.iushrn(P);P-- >0;)E.isOdd()&&E.iadd(O),E.iushrn(1);for(var X=0,Q=1;(_.words[0]&Q)==0&&X<26;++X,Q<<=1);if(X>0)for(_.iushrn(X);X-- >0;)D.isOdd()&&D.iadd(O),D.iushrn(1);S.cmp(_)>=0?(S.isub(_),E.isub(D)):(_.isub(S),D.isub(E))}return(T=S.cmpn(1)===0?E:D).cmpn(0)<0&&T.iadd(R),T},c.prototype.gcd=function(R){if(this.isZero())return R.abs();if(R.isZero())return this.abs();var S=this.clone(),_=R.clone();S.negative=0,_.negative=0;for(var T=0;S.isEven()&&_.isEven();T++)S.iushrn(1),_.iushrn(1);for(;;){for(;S.isEven();)S.iushrn(1);for(;_.isEven();)_.iushrn(1);var E=S.cmp(_);if(E<0){var D=S;S=_,_=D}else if(E===0||_.cmpn(1)===0)break;S.isub(_)}return _.iushln(T)},c.prototype.invm=function(R){return this.egcd(R).a.umod(R)},c.prototype.isEven=function(){return(1&this.words[0])==0},c.prototype.isOdd=function(){return(1&this.words[0])==1},c.prototype.andln=function(R){return this.words[0]&R},c.prototype.bincn=function(R){a(typeof R=="number");var S=R%26,_=(R-S)/26,T=1<<S;if(this.length<=_)return this._expand(_+1),this.words[_]|=T,this;for(var E=T,D=_;E!==0&&D<this.length;D++){var O=0|this.words[D];E=(O+=E)>>>26,O&=67108863,this.words[D]=O}return E!==0&&(this.words[D]=E,this.length++),this},c.prototype.isZero=function(){return this.length===1&&this.words[0]===0},c.prototype.cmpn=function(R){var S,_=R<0;if(this.negative!==0&&!_)return-1;if(this.negative===0&&_)return 1;if(this._strip(),this.length>1)S=1;else{_&&(R=-R),a(R<=67108863,"Number is too big");var T=0|this.words[0];S=T===R?0:T<R?-1:1}return this.negative!==0?0|-S:S},c.prototype.cmp=function(R){if(this.negative!==0&&R.negative===0)return-1;if(this.negative===0&&R.negative!==0)return 1;var S=this.ucmp(R);return this.negative!==0?0|-S:S},c.prototype.ucmp=function(R){if(this.length>R.length)return 1;if(this.length<R.length)return-1;for(var S=0,_=this.length-1;_>=0;_--){var T=0|this.words[_],E=0|R.words[_];if(T!==E){T<E?S=-1:T>E&&(S=1);break}}return S},c.prototype.gtn=function(R){return this.cmpn(R)===1},c.prototype.gt=function(R){return this.cmp(R)===1},c.prototype.gten=function(R){return this.cmpn(R)>=0},c.prototype.gte=function(R){return this.cmp(R)>=0},c.prototype.ltn=function(R){return this.cmpn(R)===-1},c.prototype.lt=function(R){return this.cmp(R)===-1},c.prototype.lten=function(R){return this.cmpn(R)<=0},c.prototype.lte=function(R){return this.cmp(R)<=0},c.prototype.eqn=function(R){return this.cmpn(R)===0},c.prototype.eq=function(R){return this.cmp(R)===0},c.red=function(R){return new M(R)},c.prototype.toRed=function(R){return a(!this.red,"Already a number in reduction context"),a(this.negative===0,"red works only with positives"),R.convertTo(this)._forceRed(R)},c.prototype.fromRed=function(){return a(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},c.prototype._forceRed=function(R){return this.red=R,this},c.prototype.forceRed=function(R){return a(!this.red,"Already a number in reduction context"),this._forceRed(R)},c.prototype.redAdd=function(R){return a(this.red,"redAdd works only with red numbers"),this.red.add(this,R)},c.prototype.redIAdd=function(R){return a(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,R)},c.prototype.redSub=function(R){return a(this.red,"redSub works only with red numbers"),this.red.sub(this,R)},c.prototype.redISub=function(R){return a(this.red,"redISub works only with red numbers"),this.red.isub(this,R)},c.prototype.redShl=function(R){return a(this.red,"redShl works only with red numbers"),this.red.shl(this,R)},c.prototype.redMul=function(R){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,R),this.red.mul(this,R)},c.prototype.redIMul=function(R){return a(this.red,"redMul works only with red numbers"),this.red._verify2(this,R),this.red.imul(this,R)},c.prototype.redSqr=function(){return a(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},c.prototype.redISqr=function(){return a(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},c.prototype.redSqrt=function(){return a(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},c.prototype.redInvm=function(){return a(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},c.prototype.redNeg=function(){return a(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},c.prototype.redPow=function(R){return a(this.red&&!R.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,R)};var N={k256:null,p224:null,p192:null,p25519:null};function j(R,S){this.name=R,this.p=new c(S,16),this.n=this.p.bitLength(),this.k=new c(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function L(){j.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function W(){j.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function K(){j.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function z(){j.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function M(R){if(typeof R=="string"){var S=c._prime(R);this.m=S.p,this.prime=S}else a(R.gtn(1),"modulus must be greater than 1"),this.m=R,this.prime=null}function B(R){M.call(this,R),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new c(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}j.prototype._tmp=function(){var R=new c(null);return R.words=new Array(Math.ceil(this.n/13)),R},j.prototype.ireduce=function(R){var S,_=R;do this.split(_,this.tmp),S=(_=(_=this.imulK(_)).iadd(this.tmp)).bitLength();while(S>this.n);var T=S<this.n?-1:_.ucmp(this.p);return T===0?(_.words[0]=0,_.length=1):T>0?_.isub(this.p):_.strip!==void 0?_.strip():_._strip(),_},j.prototype.split=function(R,S){R.iushrn(this.n,0,S)},j.prototype.imulK=function(R){return R.imul(this.k)},l(L,j),L.prototype.split=function(R,S){for(var _=Math.min(R.length,9),T=0;T<_;T++)S.words[T]=R.words[T];if(S.length=_,R.length<=9)return R.words[0]=0,void(R.length=1);var E=R.words[9];for(S.words[S.length++]=4194303&E,T=10;T<R.length;T++){var D=0|R.words[T];R.words[T-10]=(4194303&D)<<4|E>>>22,E=D}E>>>=22,R.words[T-10]=E,E===0&&R.length>10?R.length-=10:R.length-=9},L.prototype.imulK=function(R){R.words[R.length]=0,R.words[R.length+1]=0,R.length+=2;for(var S=0,_=0;_<R.length;_++){var T=0|R.words[_];S+=977*T,R.words[_]=67108863&S,S=64*T+(S/67108864|0)}return R.words[R.length-1]===0&&(R.length--,R.words[R.length-1]===0&&R.length--),R},l(W,j),l(K,j),l(z,j),z.prototype.imulK=function(R){for(var S=0,_=0;_<R.length;_++){var T=19*(0|R.words[_])+S,E=67108863&T;T>>>=26,R.words[_]=E,S=T}return S!==0&&(R.words[R.length++]=S),R},c._prime=function(R){if(N[R])return N[R];var S;if(R==="k256")S=new L;else if(R==="p224")S=new W;else if(R==="p192")S=new K;else{if(R!=="p25519")throw new Error("Unknown prime "+R);S=new z}return N[R]=S,S},M.prototype._verify1=function(R){a(R.negative===0,"red works only with positives"),a(R.red,"red works only with red numbers")},M.prototype._verify2=function(R,S){a((R.negative|S.negative)==0,"red works only with positives"),a(R.red&&R.red===S.red,"red works only with red numbers")},M.prototype.imod=function(R){return this.prime?this.prime.ireduce(R)._forceRed(this):(m(R,R.umod(this.m)._forceRed(this)),R)},M.prototype.neg=function(R){return R.isZero()?R.clone():this.m.sub(R)._forceRed(this)},M.prototype.add=function(R,S){this._verify2(R,S);var _=R.add(S);return _.cmp(this.m)>=0&&_.isub(this.m),_._forceRed(this)},M.prototype.iadd=function(R,S){this._verify2(R,S);var _=R.iadd(S);return _.cmp(this.m)>=0&&_.isub(this.m),_},M.prototype.sub=function(R,S){this._verify2(R,S);var _=R.sub(S);return _.cmpn(0)<0&&_.iadd(this.m),_._forceRed(this)},M.prototype.isub=function(R,S){this._verify2(R,S);var _=R.isub(S);return _.cmpn(0)<0&&_.iadd(this.m),_},M.prototype.shl=function(R,S){return this._verify1(R),this.imod(R.ushln(S))},M.prototype.imul=function(R,S){return this._verify2(R,S),this.imod(R.imul(S))},M.prototype.mul=function(R,S){return this._verify2(R,S),this.imod(R.mul(S))},M.prototype.isqr=function(R){return this.imul(R,R.clone())},M.prototype.sqr=function(R){return this.mul(R,R)},M.prototype.sqrt=function(R){if(R.isZero())return R.clone();var S=this.m.andln(3);if(a(S%2==1),S===3){var _=this.m.add(new c(1)).iushrn(2);return this.pow(R,_)}for(var T=this.m.subn(1),E=0;!T.isZero()&&T.andln(1)===0;)E++,T.iushrn(1);a(!T.isZero());var D=new c(1).toRed(this),O=D.redNeg(),P=this.m.subn(1).iushrn(1),q=this.m.bitLength();for(q=new c(2*q*q).toRed(this);this.pow(q,P).cmp(O)!==0;)q.redIAdd(O);for(var X=this.pow(q,T),Q=this.pow(R,T.addn(1).iushrn(1)),G=this.pow(R,T),ee=E;G.cmp(D)!==0;){for(var V=G,H=0;V.cmp(D)!==0;H++)V=V.redSqr();a(H<ee);var Z=this.pow(X,new c(1).iushln(ee-H-1));Q=Q.redMul(Z),X=Z.redSqr(),G=G.redMul(X),ee=H}return Q},M.prototype.invm=function(R){var S=R._invmp(this.m);return S.negative!==0?(S.negative=0,this.imod(S).redNeg()):this.imod(S)},M.prototype.pow=function(R,S){if(S.isZero())return new c(1).toRed(this);if(S.cmpn(1)===0)return R.clone();var _=new Array(16);_[0]=new c(1).toRed(this),_[1]=R;for(var T=2;T<_.length;T++)_[T]=this.mul(_[T-1],R);var E=_[0],D=0,O=0,P=S.bitLength()%26;for(P===0&&(P=26),T=S.length-1;T>=0;T--){for(var q=S.words[T],X=P-1;X>=0;X--){var Q=q>>X&1;E!==_[0]&&(E=this.sqr(E)),Q!==0||D!==0?(D<<=1,D|=Q,(++O===4||T===0&&X===0)&&(E=this.mul(E,_[D]),O=0,D=0)):O=0}P=26}return E},M.prototype.convertTo=function(R){var S=R.umod(this.m);return S===R?S.clone():S},M.prototype.convertFrom=function(R){var S=R.clone();return S.red=null,S},c.mont=function(R){return new B(R)},l(B,M),B.prototype.convertTo=function(R){return this.imod(R.ushln(this.shift))},B.prototype.convertFrom=function(R){var S=this.imod(R.mul(this.rinv));return S.red=null,S},B.prototype.imul=function(R,S){if(R.isZero()||S.isZero())return R.words[0]=0,R.length=1,R;var _=R.imul(S),T=_.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=_.isub(T).iushrn(this.shift),D=E;return E.cmp(this.m)>=0?D=E.isub(this.m):E.cmpn(0)<0&&(D=E.iadd(this.m)),D._forceRed(this)},B.prototype.mul=function(R,S){if(R.isZero()||S.isZero())return new c(0)._forceRed(this);var _=R.mul(S),T=_.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),E=_.isub(T).iushrn(this.shift),D=E;return E.cmp(this.m)>=0?D=E.isub(this.m):E.cmpn(0)<0&&(D=E.iadd(this.m)),D._forceRed(this)},B.prototype.invm=function(R){return this.imod(R._invmp(this.m).mul(this.r2))._forceRed(this)}})(n===void 0||n)},{buffer:188}],187:[function(r,n,i){var s;function o(l){this.rand=l}if(n.exports=function(l){return s||(s=new o(null)),s.generate(l)},n.exports.Rand=o,o.prototype.generate=function(l){return this._rand(l)},o.prototype._rand=function(l){if(this.rand.getBytes)return this.rand.getBytes(l);for(var c=new Uint8Array(l),u=0;u<c.length;u++)c[u]=this.rand.getByte();return c},typeof self=="object")self.crypto&&self.crypto.getRandomValues?o.prototype._rand=function(l){var c=new Uint8Array(l);return self.crypto.getRandomValues(c),c}:self.msCrypto&&self.msCrypto.getRandomValues?o.prototype._rand=function(l){var c=new Uint8Array(l);return self.msCrypto.getRandomValues(c),c}:typeof window=="object"&&(o.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var a=r("crypto");if(typeof a.randomBytes!="function")throw new Error("Not supported");o.prototype._rand=function(l){return a.randomBytes(l)}}catch{}},{crypto:188}],188:[function(r,n,i){},{}],189:[function(r,n,i){var s=r("safe-buffer").Buffer;function o(d){s.isBuffer(d)||(d=s.from(d));for(var f=d.length/4|0,m=new Array(f),v=0;v<f;v++)m[v]=d.readUInt32BE(4*v);return m}function a(d){for(;0<d.length;d++)d[0]=0}function l(d,f,m,v,g){for(var w,y,C,k,F=m[0],I=m[1],N=m[2],j=m[3],L=d[0]^f[0],W=d[1]^f[1],K=d[2]^f[2],z=d[3]^f[3],M=4,B=1;B<g;B++)w=F[L>>>24]^I[W>>>16&255]^N[K>>>8&255]^j[255&z]^f[M++],y=F[W>>>24]^I[K>>>16&255]^N[z>>>8&255]^j[255&L]^f[M++],C=F[K>>>24]^I[z>>>16&255]^N[L>>>8&255]^j[255&W]^f[M++],k=F[z>>>24]^I[L>>>16&255]^N[W>>>8&255]^j[255&K]^f[M++],L=w,W=y,K=C,z=k;return w=(v[L>>>24]<<24|v[W>>>16&255]<<16|v[K>>>8&255]<<8|v[255&z])^f[M++],y=(v[W>>>24]<<24|v[K>>>16&255]<<16|v[z>>>8&255]<<8|v[255&L])^f[M++],C=(v[K>>>24]<<24|v[z>>>16&255]<<16|v[L>>>8&255]<<8|v[255&W])^f[M++],k=(v[z>>>24]<<24|v[L>>>16&255]<<16|v[W>>>8&255]<<8|v[255&K])^f[M++],[w>>>=0,y>>>=0,C>>>=0,k>>>=0]}var c=[0,1,2,4,8,16,32,64,128,27,54],u=(function(){for(var d=new Array(256),f=0;f<256;f++)d[f]=f<128?f<<1:f<<1^283;for(var m=[],v=[],g=[[],[],[],[]],w=[[],[],[],[]],y=0,C=0,k=0;k<256;++k){var F=C^C<<1^C<<2^C<<3^C<<4;F=F>>>8^255&F^99,m[y]=F,v[F]=y;var I=d[y],N=d[I],j=d[N],L=257*d[F]^16843008*F;g[0][y]=L<<24|L>>>8,g[1][y]=L<<16|L>>>16,g[2][y]=L<<8|L>>>24,g[3][y]=L,L=16843009*j^65537*N^257*I^16843008*y,w[0][F]=L<<24|L>>>8,w[1][F]=L<<16|L>>>16,w[2][F]=L<<8|L>>>24,w[3][F]=L,y===0?y=C=1:(y=I^d[d[d[j^I]]],C^=d[d[C]])}return{SBOX:m,INV_SBOX:v,SUB_MIX:g,INV_SUB_MIX:w}})();function h(d){this._key=o(d),this._reset()}h.blockSize=16,h.keySize=32,h.prototype.blockSize=h.blockSize,h.prototype.keySize=h.keySize,h.prototype._reset=function(){for(var d=this._key,f=d.length,m=f+6,v=4*(m+1),g=[],w=0;w<f;w++)g[w]=d[w];for(w=f;w<v;w++){var y=g[w-1];w%f==0?(y=y<<8|y>>>24,y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y],y^=c[w/f|0]<<24):f>6&&w%f==4&&(y=u.SBOX[y>>>24]<<24|u.SBOX[y>>>16&255]<<16|u.SBOX[y>>>8&255]<<8|u.SBOX[255&y]),g[w]=g[w-f]^y}for(var C=[],k=0;k<v;k++){var F=v-k,I=g[F-(k%4?0:4)];C[k]=k<4||F<=4?I:u.INV_SUB_MIX[0][u.SBOX[I>>>24]]^u.INV_SUB_MIX[1][u.SBOX[I>>>16&255]]^u.INV_SUB_MIX[2][u.SBOX[I>>>8&255]]^u.INV_SUB_MIX[3][u.SBOX[255&I]]}this._nRounds=m,this._keySchedule=g,this._invKeySchedule=C},h.prototype.encryptBlockRaw=function(d){return l(d=o(d),this._keySchedule,u.SUB_MIX,u.SBOX,this._nRounds)},h.prototype.encryptBlock=function(d){var f=this.encryptBlockRaw(d),m=s.allocUnsafe(16);return m.writeUInt32BE(f[0],0),m.writeUInt32BE(f[1],4),m.writeUInt32BE(f[2],8),m.writeUInt32BE(f[3],12),m},h.prototype.decryptBlock=function(d){var f=(d=o(d))[1];d[1]=d[3],d[3]=f;var m=l(d,this._invKeySchedule,u.INV_SUB_MIX,u.INV_SBOX,this._nRounds),v=s.allocUnsafe(16);return v.writeUInt32BE(m[0],0),v.writeUInt32BE(m[3],4),v.writeUInt32BE(m[2],8),v.writeUInt32BE(m[1],12),v},h.prototype.scrub=function(){a(this._keySchedule),a(this._invKeySchedule),a(this._key)},n.exports.AES=h},{"safe-buffer":494}],190:[function(r,n,i){var s=r("./aes"),o=r("safe-buffer").Buffer,a=r("cipher-base"),l=r("inherits"),c=r("./ghash"),u=r("buffer-xor"),h=r("./incr32");function d(f,m,v,g){a.call(this);var w=o.alloc(4,0);this._cipher=new s.AES(m);var y=this._cipher.encryptBlock(w);this._ghash=new c(y),v=(function(C,k,F){if(k.length===12)return C._finID=o.concat([k,o.from([0,0,0,1])]),o.concat([k,o.from([0,0,0,2])]);var I=new c(F),N=k.length,j=N%16;I.update(k),j&&(j=16-j,I.update(o.alloc(j,0))),I.update(o.alloc(8,0));var L=8*N,W=o.alloc(8);W.writeUIntBE(L,0,8),I.update(W),C._finID=I.state;var K=o.from(C._finID);return h(K),K})(this,v,y),this._prev=o.from(v),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=g,this._alen=0,this._len=0,this._mode=f,this._authTag=null,this._called=!1}l(d,a),d.prototype._update=function(f){if(!this._called&&this._alen){var m=16-this._alen%16;m<16&&(m=o.alloc(m,0),this._ghash.update(m))}this._called=!0;var v=this._mode.encrypt(this,f);return this._decrypt?this._ghash.update(f):this._ghash.update(v),this._len+=f.length,v},d.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var f=u(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&(function(m,v){var g=0;m.length!==v.length&&g++;for(var w=Math.min(m.length,v.length),y=0;y<w;++y)g+=m[y]^v[y];return g})(f,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=f,this._cipher.scrub()},d.prototype.getAuthTag=function(){if(this._decrypt||!o.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},d.prototype.setAuthTag=function(f){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=f},d.prototype.setAAD=function(f){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(f),this._alen+=f.length},n.exports=d},{"./aes":189,"./ghash":194,"./incr32":195,"buffer-xor":219,"cipher-base":221,inherits:440,"safe-buffer":494}],191:[function(r,n,i){var s=r("./encrypter"),o=r("./decrypter"),a=r("./modes/list.json");i.createCipher=i.Cipher=s.createCipher,i.createCipheriv=i.Cipheriv=s.createCipheriv,i.createDecipher=i.Decipher=o.createDecipher,i.createDecipheriv=i.Decipheriv=o.createDecipheriv,i.listCiphers=i.getCiphers=function(){return Object.keys(a)}},{"./decrypter":192,"./encrypter":193,"./modes/list.json":203}],192:[function(r,n,i){var s=r("./authCipher"),o=r("safe-buffer").Buffer,a=r("./modes"),l=r("./streamCipher"),c=r("cipher-base"),u=r("./aes"),h=r("evp_bytestokey");function d(v,g,w){c.call(this),this._cache=new f,this._last=void 0,this._cipher=new u.AES(g),this._prev=o.from(w),this._mode=v,this._autopadding=!0}function f(){this.cache=o.allocUnsafe(0)}function m(v,g,w){var y=a[v.toLowerCase()];if(!y)throw new TypeError("invalid suite type");if(typeof w=="string"&&(w=o.from(w)),y.mode!=="GCM"&&w.length!==y.iv)throw new TypeError("invalid iv length "+w.length);if(typeof g=="string"&&(g=o.from(g)),g.length!==y.key/8)throw new TypeError("invalid key length "+g.length);return y.type==="stream"?new l(y.module,g,w,!0):y.type==="auth"?new s(y.module,g,w,!0):new d(y.module,g,w)}r("inherits")(d,c),d.prototype._update=function(v){var g,w;this._cache.add(v);for(var y=[];g=this._cache.get(this._autopadding);)w=this._mode.decrypt(this,g),y.push(w);return o.concat(y)},d.prototype._final=function(){var v=this._cache.flush();if(this._autopadding)return(function(g){var w=g[15];if(w<1||w>16)throw new Error("unable to decrypt data");for(var y=-1;++y<w;)if(g[y+(16-w)]!==w)throw new Error("unable to decrypt data");if(w!==16)return g.slice(0,16-w)})(this._mode.decrypt(this,v));if(v)throw new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(v){return this._autopadding=!!v,this},f.prototype.add=function(v){this.cache=o.concat([this.cache,v])},f.prototype.get=function(v){var g;if(v){if(this.cache.length>16)return g=this.cache.slice(0,16),this.cache=this.cache.slice(16),g}else if(this.cache.length>=16)return g=this.cache.slice(0,16),this.cache=this.cache.slice(16),g;return null},f.prototype.flush=function(){if(this.cache.length)return this.cache},i.createDecipher=function(v,g){var w=a[v.toLowerCase()];if(!w)throw new TypeError("invalid suite type");var y=h(g,!1,w.key,w.iv);return m(v,y.key,y.iv)},i.createDecipheriv=m},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],193:[function(r,n,i){var s=r("./modes"),o=r("./authCipher"),a=r("safe-buffer").Buffer,l=r("./streamCipher"),c=r("cipher-base"),u=r("./aes"),h=r("evp_bytestokey");function d(g,w,y){c.call(this),this._cache=new m,this._cipher=new u.AES(w),this._prev=a.from(y),this._mode=g,this._autopadding=!0}r("inherits")(d,c),d.prototype._update=function(g){var w,y;this._cache.add(g);for(var C=[];w=this._cache.get();)y=this._mode.encrypt(this,w),C.push(y);return a.concat(C)};var f=a.alloc(16,16);function m(){this.cache=a.allocUnsafe(0)}function v(g,w,y){var C=s[g.toLowerCase()];if(!C)throw new TypeError("invalid suite type");if(typeof w=="string"&&(w=a.from(w)),w.length!==C.key/8)throw new TypeError("invalid key length "+w.length);if(typeof y=="string"&&(y=a.from(y)),C.mode!=="GCM"&&y.length!==C.iv)throw new TypeError("invalid iv length "+y.length);return C.type==="stream"?new l(C.module,w,y):C.type==="auth"?new o(C.module,w,y):new d(C.module,w,y)}d.prototype._final=function(){var g=this._cache.flush();if(this._autopadding)return g=this._mode.encrypt(this,g),this._cipher.scrub(),g;if(!g.equals(f))throw this._cipher.scrub(),new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(g){return this._autopadding=!!g,this},m.prototype.add=function(g){this.cache=a.concat([this.cache,g])},m.prototype.get=function(){if(this.cache.length>15){var g=this.cache.slice(0,16);return this.cache=this.cache.slice(16),g}return null},m.prototype.flush=function(){for(var g=16-this.cache.length,w=a.allocUnsafe(g),y=-1;++y<g;)w.writeUInt8(g,y);return a.concat([this.cache,w])},i.createCipheriv=v,i.createCipher=function(g,w){var y=s[g.toLowerCase()];if(!y)throw new TypeError("invalid suite type");var C=h(w,!1,y.key,y.iv);return v(g,C.key,C.iv)}},{"./aes":189,"./authCipher":190,"./modes":202,"./streamCipher":205,"cipher-base":221,evp_bytestokey:423,inherits:440,"safe-buffer":494}],194:[function(r,n,i){var s=r("safe-buffer").Buffer,o=s.alloc(16,0);function a(c){var u=s.allocUnsafe(16);return u.writeUInt32BE(c[0]>>>0,0),u.writeUInt32BE(c[1]>>>0,4),u.writeUInt32BE(c[2]>>>0,8),u.writeUInt32BE(c[3]>>>0,12),u}function l(c){this.h=c,this.state=s.alloc(16,0),this.cache=s.allocUnsafe(0)}l.prototype.ghash=function(c){for(var u=-1;++u<c.length;)this.state[u]^=c[u];this._multiply()},l.prototype._multiply=function(){for(var c,u,h,d=[(c=this.h).readUInt32BE(0),c.readUInt32BE(4),c.readUInt32BE(8),c.readUInt32BE(12)],f=[0,0,0,0],m=-1;++m<128;){for((this.state[~~(m/8)]&1<<7-m%8)!=0&&(f[0]^=d[0],f[1]^=d[1],f[2]^=d[2],f[3]^=d[3]),h=(1&d[3])!=0,u=3;u>0;u--)d[u]=d[u]>>>1|(1&d[u-1])<<31;d[0]=d[0]>>>1,h&&(d[0]=d[0]^225<<24)}this.state=a(f)},l.prototype.update=function(c){var u;for(this.cache=s.concat([this.cache,c]);this.cache.length>=16;)u=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(u)},l.prototype.final=function(c,u){return this.cache.length&&this.ghash(s.concat([this.cache,o],16)),this.ghash(a([0,c,0,u])),this.state},n.exports=l},{"safe-buffer":494}],195:[function(r,n,i){n.exports=function(s){for(var o,a=s.length;a--;){if((o=s.readUInt8(a))!==255){o++,s.writeUInt8(o,a);break}s.writeUInt8(0,a)}}},{}],196:[function(r,n,i){var s=r("buffer-xor");i.encrypt=function(o,a){var l=s(a,o._prev);return o._prev=o._cipher.encryptBlock(l),o._prev},i.decrypt=function(o,a){var l=o._prev;o._prev=a;var c=o._cipher.decryptBlock(a);return s(c,l)}},{"buffer-xor":219}],197:[function(r,n,i){var s=r("safe-buffer").Buffer,o=r("buffer-xor");function a(l,c,u){var h=c.length,d=o(c,l._cache);return l._cache=l._cache.slice(h),l._prev=s.concat([l._prev,u?c:d]),d}i.encrypt=function(l,c,u){for(var h,d=s.allocUnsafe(0);c.length;){if(l._cache.length===0&&(l._cache=l._cipher.encryptBlock(l._prev),l._prev=s.allocUnsafe(0)),!(l._cache.length<=c.length)){d=s.concat([d,a(l,c,u)]);break}h=l._cache.length,d=s.concat([d,a(l,c.slice(0,h),u)]),c=c.slice(h)}return d}},{"buffer-xor":219,"safe-buffer":494}],198:[function(r,n,i){var s=r("safe-buffer").Buffer;function o(l,c,u){for(var h,d,f=-1,m=0;++f<8;)h=c&1<<7-f?128:0,m+=(128&(d=l._cipher.encryptBlock(l._prev)[0]^h))>>f%8,l._prev=a(l._prev,u?h:d);return m}function a(l,c){var u=l.length,h=-1,d=s.allocUnsafe(l.length);for(l=s.concat([l,s.from([c])]);++h<u;)d[h]=l[h]<<1|l[h+1]>>7;return d}i.encrypt=function(l,c,u){for(var h=c.length,d=s.allocUnsafe(h),f=-1;++f<h;)d[f]=o(l,c[f],u);return d}},{"safe-buffer":494}],199:[function(r,n,i){var s=r("safe-buffer").Buffer;function o(a,l,c){var u=a._cipher.encryptBlock(a._prev)[0]^l;return a._prev=s.concat([a._prev.slice(1),s.from([c?l:u])]),u}i.encrypt=function(a,l,c){for(var u=l.length,h=s.allocUnsafe(u),d=-1;++d<u;)h[d]=o(a,l[d],c);return h}},{"safe-buffer":494}],200:[function(r,n,i){var s=r("buffer-xor"),o=r("safe-buffer").Buffer,a=r("../incr32");function l(c){var u=c._cipher.encryptBlockRaw(c._prev);return a(c._prev),u}i.encrypt=function(c,u){var h=Math.ceil(u.length/16),d=c._cache.length;c._cache=o.concat([c._cache,o.allocUnsafe(16*h)]);for(var f=0;f<h;f++){var m=l(c),v=d+16*f;c._cache.writeUInt32BE(m[0],v+0),c._cache.writeUInt32BE(m[1],v+4),c._cache.writeUInt32BE(m[2],v+8),c._cache.writeUInt32BE(m[3],v+12)}var g=c._cache.slice(0,u.length);return c._cache=c._cache.slice(u.length),s(u,g)}},{"../incr32":195,"buffer-xor":219,"safe-buffer":494}],201:[function(r,n,i){i.encrypt=function(s,o){return s._cipher.encryptBlock(o)},i.decrypt=function(s,o){return s._cipher.decryptBlock(o)}},{}],202:[function(r,n,i){var s={ECB:r("./ecb"),CBC:r("./cbc"),CFB:r("./cfb"),CFB8:r("./cfb8"),CFB1:r("./cfb1"),OFB:r("./ofb"),CTR:r("./ctr"),GCM:r("./ctr")},o=r("./list.json");for(var a in o)o[a].module=s[o[a].mode];n.exports=o},{"./cbc":196,"./cfb":197,"./cfb1":198,"./cfb8":199,"./ctr":200,"./ecb":201,"./list.json":203,"./ofb":204}],203:[function(r,n,i){n.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}},{}],204:[function(r,n,i){(function(s){(function(){var o=r("buffer-xor");function a(l){return l._prev=l._cipher.encryptBlock(l._prev),l._prev}i.encrypt=function(l,c){for(;l._cache.length<c.length;)l._cache=s.concat([l._cache,a(l)]);var u=l._cache.slice(0,c.length);return l._cache=l._cache.slice(c.length),o(c,u)}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220,"buffer-xor":219}],205:[function(r,n,i){var s=r("./aes"),o=r("safe-buffer").Buffer,a=r("cipher-base");function l(c,u,h,d){a.call(this),this._cipher=new s.AES(u),this._prev=o.from(h),this._cache=o.allocUnsafe(0),this._secCache=o.allocUnsafe(0),this._decrypt=d,this._mode=c}r("inherits")(l,a),l.prototype._update=function(c){return this._mode.encrypt(this,c,this._decrypt)},l.prototype._final=function(){this._cipher.scrub()},n.exports=l},{"./aes":189,"cipher-base":221,inherits:440,"safe-buffer":494}],206:[function(r,n,i){var s=r("browserify-des"),o=r("browserify-aes/browser"),a=r("browserify-aes/modes"),l=r("browserify-des/modes"),c=r("evp_bytestokey");function u(d,f,m){if(d=d.toLowerCase(),a[d])return o.createCipheriv(d,f,m);if(l[d])return new s({key:f,iv:m,mode:d});throw new TypeError("invalid suite type")}function h(d,f,m){if(d=d.toLowerCase(),a[d])return o.createDecipheriv(d,f,m);if(l[d])return new s({key:f,iv:m,mode:d,decrypt:!0});throw new TypeError("invalid suite type")}i.createCipher=i.Cipher=function(d,f){var m,v;if(d=d.toLowerCase(),a[d])m=a[d].key,v=a[d].iv;else{if(!l[d])throw new TypeError("invalid suite type");m=8*l[d].key,v=l[d].iv}var g=c(f,!1,m,v);return u(d,g.key,g.iv)},i.createCipheriv=i.Cipheriv=u,i.createDecipher=i.Decipher=function(d,f){var m,v;if(d=d.toLowerCase(),a[d])m=a[d].key,v=a[d].iv;else{if(!l[d])throw new TypeError("invalid suite type");m=8*l[d].key,v=l[d].iv}var g=c(f,!1,m,v);return h(d,g.key,g.iv)},i.createDecipheriv=i.Decipheriv=h,i.listCiphers=i.getCiphers=function(){return Object.keys(l).concat(o.getCiphers())}},{"browserify-aes/browser":191,"browserify-aes/modes":202,"browserify-des":207,"browserify-des/modes":208,evp_bytestokey:423}],207:[function(r,n,i){var s=r("cipher-base"),o=r("des.js"),a=r("inherits"),l=r("safe-buffer").Buffer,c={"des-ede3-cbc":o.CBC.instantiate(o.EDE),"des-ede3":o.EDE,"des-ede-cbc":o.CBC.instantiate(o.EDE),"des-ede":o.EDE,"des-cbc":o.CBC.instantiate(o.DES),"des-ecb":o.DES};function u(h){s.call(this);var d,f=h.mode.toLowerCase(),m=c[f];d=h.decrypt?"decrypt":"encrypt";var v=h.key;l.isBuffer(v)||(v=l.from(v)),f!=="des-ede"&&f!=="des-ede-cbc"||(v=l.concat([v,v.slice(0,8)]));var g=h.iv;l.isBuffer(g)||(g=l.from(g)),this._des=m.create({key:v,iv:g,type:d})}c.des=c["des-cbc"],c.des3=c["des-ede3-cbc"],n.exports=u,a(u,s),u.prototype._update=function(h){return l.from(this._des.update(h))},u.prototype._final=function(){return l.from(this._des.final())}},{"cipher-base":221,"des.js":394,inherits:440,"safe-buffer":494}],208:[function(r,n,i){i["des-ecb"]={key:8,iv:0},i["des-cbc"]=i.des={key:8,iv:8},i["des-ede3-cbc"]=i.des3={key:24,iv:8},i["des-ede3"]={key:24,iv:0},i["des-ede-cbc"]={key:16,iv:8},i["des-ede"]={key:16,iv:0}},{}],209:[function(r,n,i){(function(s){(function(){var o=r("bn.js"),a=r("randombytes");function l(u){var h,d=u.modulus.byteLength();do h=new o(a(d));while(h.cmp(u.modulus)>=0||!h.umod(u.prime1)||!h.umod(u.prime2));return h}function c(u,h){var d=(function(N){var j=l(N);return{blinder:j.toRed(o.mont(N.modulus)).redPow(new o(N.publicExponent)).fromRed(),unblinder:j.invm(N.modulus)}})(h),f=h.modulus.byteLength(),m=new o(u).mul(d.blinder).umod(h.modulus),v=m.toRed(o.mont(h.prime1)),g=m.toRed(o.mont(h.prime2)),w=h.coefficient,y=h.prime1,C=h.prime2,k=v.redPow(h.exponent1).fromRed(),F=g.redPow(h.exponent2).fromRed(),I=k.isub(F).imul(w).umod(y).imul(C);return F.iadd(I).imul(d.unblinder).umod(h.modulus).toArrayLike(s,"be",f)}c.getr=l,n.exports=c}).call(this)}).call(this,r("buffer").Buffer)},{"bn.js":186,buffer:220,randombytes:475}],210:[function(r,n,i){n.exports=r("./browser/algorithms.json")},{"./browser/algorithms.json":211}],211:[function(r,n,i){n.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}},{}],212:[function(r,n,i){n.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}},{}],213:[function(r,n,i){var s=r("safe-buffer").Buffer,o=r("create-hash"),a=r("readable-stream"),l=r("inherits"),c=r("./sign"),u=r("./verify"),h=r("./algorithms.json");function d(g){a.Writable.call(this);var w=h[g];if(!w)throw new Error("Unknown message digest");this._hashType=w.hash,this._hash=o(w.hash),this._tag=w.id,this._signType=w.sign}function f(g){a.Writable.call(this);var w=h[g];if(!w)throw new Error("Unknown message digest");this._hash=o(w.hash),this._tag=w.id,this._signType=w.sign}function m(g){return new d(g)}function v(g){return new f(g)}Object.keys(h).forEach((function(g){h[g].id=s.from(h[g].id,"hex"),h[g.toLowerCase()]=h[g]})),l(d,a.Writable),d.prototype._write=function(g,w,y){this._hash.update(g),y()},d.prototype.update=function(g,w){return typeof g=="string"&&(g=s.from(g,w)),this._hash.update(g),this},d.prototype.sign=function(g,w){this.end();var y=this._hash.digest(),C=c(y,g,this._hashType,this._signType,this._tag);return w?C.toString(w):C},l(f,a.Writable),f.prototype._write=function(g,w,y){this._hash.update(g),y()},f.prototype.update=function(g,w){return typeof g=="string"&&(g=s.from(g,w)),this._hash.update(g),this},f.prototype.verify=function(g,w,y){typeof w=="string"&&(w=s.from(w,y)),this.end();var C=this._hash.digest();return u(w,C,g,this._signType,this._tag)},n.exports={Sign:m,Verify:v,createSign:m,createVerify:v}},{"./algorithms.json":211,"./sign":214,"./verify":215,"create-hash":386,inherits:440,"readable-stream":491,"safe-buffer":494}],214:[function(r,n,i){var s=r("safe-buffer").Buffer,o=r("create-hmac"),a=r("browserify-rsa"),l=r("elliptic").ec,c=r("bn.js"),u=r("parse-asn1"),h=r("./curves.json");function d(g,w,y,C){if((g=s.from(g.toArray())).length<w.byteLength()){var k=s.alloc(w.byteLength()-g.length);g=s.concat([k,g])}var F=y.length,I=(function(L,W){L=(L=f(L,W)).mod(W);var K=s.from(L.toArray());if(K.length<W.byteLength()){var z=s.alloc(W.byteLength()-K.length);K=s.concat([z,K])}return K})(y,w),N=s.alloc(F);N.fill(1);var j=s.alloc(F);return j=o(C,j).update(N).update(s.from([0])).update(g).update(I).digest(),N=o(C,j).update(N).digest(),{k:j=o(C,j).update(N).update(s.from([1])).update(g).update(I).digest(),v:N=o(C,j).update(N).digest()}}function f(g,w){var y=new c(g),C=(g.length<<3)-w.bitLength();return C>0&&y.ishrn(C),y}function m(g,w,y){var C,k;do{for(C=s.alloc(0);8*C.length<g.bitLength();)w.v=o(y,w.k).update(w.v).digest(),C=s.concat([C,w.v]);k=f(C,g),w.k=o(y,w.k).update(w.v).update(s.from([0])).digest(),w.v=o(y,w.k).update(w.v).digest()}while(k.cmp(g)!==-1);return k}function v(g,w,y,C){return g.toRed(c.mont(y)).redPow(w).fromRed().mod(C)}n.exports=function(g,w,y,C,k){var F=u(w);if(F.curve){if(C!=="ecdsa"&&C!=="ecdsa/rsa")throw new Error("wrong private key type");return(function(L,W){var K=h[W.curve.join(".")];if(!K)throw new Error("unknown curve "+W.curve.join("."));var z=new l(K).keyFromPrivate(W.privateKey).sign(L);return s.from(z.toDER())})(g,F)}if(F.type==="dsa"){if(C!=="dsa")throw new Error("wrong private key type");return(function(L,W,K){for(var z,M=W.params.priv_key,B=W.params.p,R=W.params.q,S=W.params.g,_=new c(0),T=f(L,R).mod(R),E=!1,D=d(M,R,L,K);E===!1;)z=m(R,D,K),_=v(S,z,B,R),(E=z.invm(R).imul(T.add(M.mul(_))).mod(R)).cmpn(0)===0&&(E=!1,_=new c(0));return(function(O,P){O=O.toArray(),P=P.toArray(),128&O[0]&&(O=[0].concat(O)),128&P[0]&&(P=[0].concat(P));var q=[48,O.length+P.length+4,2,O.length];return q=q.concat(O,[2,P.length],P),s.from(q)})(_,E)})(g,F,y)}if(C!=="rsa"&&C!=="ecdsa/rsa")throw new Error("wrong private key type");g=s.concat([k,g]);for(var I=F.modulus.byteLength(),N=[0,1];g.length+N.length+1<I;)N.push(255);N.push(0);for(var j=-1;++j<g.length;)N.push(g[j]);return a(N,F)},n.exports.getKey=d,n.exports.makeKey=m},{"./curves.json":212,"bn.js":186,"browserify-rsa":209,"create-hmac":388,elliptic:405,"parse-asn1":459,"safe-buffer":494}],215:[function(r,n,i){var s=r("safe-buffer").Buffer,o=r("bn.js"),a=r("elliptic").ec,l=r("parse-asn1"),c=r("./curves.json");function u(h,d){if(h.cmpn(0)<=0)throw new Error("invalid sig");if(h.cmp(d)>=d)throw new Error("invalid sig")}n.exports=function(h,d,f,m,v){var g=l(f);if(g.type==="ec"){if(m!=="ecdsa"&&m!=="ecdsa/rsa")throw new Error("wrong public key type");return(function(N,j,L){var W=c[L.data.algorithm.curve.join(".")];if(!W)throw new Error("unknown curve "+L.data.algorithm.curve.join("."));var K=new a(W),z=L.data.subjectPrivateKey.data;return K.verify(j,N,z)})(h,d,g)}if(g.type==="dsa"){if(m!=="dsa")throw new Error("wrong public key type");return(function(N,j,L){var W=L.data.p,K=L.data.q,z=L.data.g,M=L.data.pub_key,B=l.signature.decode(N,"der"),R=B.s,S=B.r;u(R,K),u(S,K);var _=o.mont(W),T=R.invm(K);return z.toRed(_).redPow(new o(j).mul(T).mod(K)).fromRed().mul(M.toRed(_).redPow(S.mul(T).mod(K)).fromRed()).mod(W).mod(K).cmp(S)===0})(h,d,g)}if(m!=="rsa"&&m!=="ecdsa/rsa")throw new Error("wrong public key type");d=s.concat([v,d]);for(var w=g.modulus.byteLength(),y=[1],C=0;d.length+y.length+2<w;)y.push(255),C++;y.push(0);for(var k=-1;++k<d.length;)y.push(d[k]);y=s.from(y);var F=o.mont(g.modulus);h=(h=new o(h).toRed(F)).redPow(new o(g.publicExponent)),h=s.from(h.fromRed().toArray());var I=C<8?1:0;for(w=Math.min(h.length,y.length),h.length!==y.length&&(I=1),k=-1;++k<w;)I|=h[k]^y[k];return I===0}},{"./curves.json":212,"bn.js":186,elliptic:405,"parse-asn1":459,"safe-buffer":494}],216:[function(r,n,i){},{}],217:[function(r,n,i){var s=r("buffer"),o=s.Buffer;function a(c,u){for(var h in c)u[h]=c[h]}function l(c,u,h){return o(c,u,h)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?n.exports=s:(a(s,i),i.Buffer=l),a(o,l),l.from=function(c,u,h){if(typeof c=="number")throw new TypeError("Argument must not be a number");return o(c,u,h)},l.alloc=function(c,u,h){if(typeof c!="number")throw new TypeError("Argument must be a number");var d=o(c);return u!==void 0?typeof h=="string"?d.fill(u,h):d.fill(u):d.fill(0),d},l.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return o(c)},l.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return s.SlowBuffer(c)}},{buffer:220}],218:[function(r,n,i){var s=r("safe-buffer").Buffer,o=s.isEncoding||function(g){switch((g=""+g)&&g.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function a(g){var w;switch(this.encoding=(function(y){var C=(function(k){if(!k)return"utf8";for(var F;;)switch(k){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return k;default:if(F)return;k=(""+k).toLowerCase(),F=!0}})(y);if(typeof C!="string"&&(s.isEncoding===o||!o(y)))throw new Error("Unknown encoding: "+y);return C||y})(g),this.encoding){case"utf16le":this.text=u,this.end=h,w=4;break;case"utf8":this.fillLast=c,w=4;break;case"base64":this.text=d,this.end=f,w=3;break;default:return this.write=m,void(this.end=v)}this.lastNeed=0,this.lastTotal=0,this.lastChar=s.allocUnsafe(w)}function l(g){return g<=127?0:g>>5==6?2:g>>4==14?3:g>>3==30?4:g>>6==2?-1:-2}function c(g){var w=this.lastTotal-this.lastNeed,y=(function(C,k,F){if((192&k[0])!=128)return C.lastNeed=0,"";if(C.lastNeed>1&&k.length>1){if((192&k[1])!=128)return C.lastNeed=1,"";if(C.lastNeed>2&&k.length>2&&(192&k[2])!=128)return C.lastNeed=2,""}})(this,g);return y!==void 0?y:this.lastNeed<=g.length?(g.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(g.copy(this.lastChar,w,0,g.length),void(this.lastNeed-=g.length))}function u(g,w){if((g.length-w)%2==0){var y=g.toString("utf16le",w);if(y){var C=y.charCodeAt(y.length-1);if(C>=55296&&C<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1],y.slice(0,-1)}return y}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=g[g.length-1],g.toString("utf16le",w,g.length-1)}function h(g){var w=g&&g.length?this.write(g):"";if(this.lastNeed){var y=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,y)}return w}function d(g,w){var y=(g.length-w)%3;return y===0?g.toString("base64",w):(this.lastNeed=3-y,this.lastTotal=3,y===1?this.lastChar[0]=g[g.length-1]:(this.lastChar[0]=g[g.length-2],this.lastChar[1]=g[g.length-1]),g.toString("base64",w,g.length-y))}function f(g){var w=g&&g.length?this.write(g):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function m(g){return g.toString(this.encoding)}function v(g){return g&&g.length?this.write(g):""}i.StringDecoder=a,a.prototype.write=function(g){if(g.length===0)return"";var w,y;if(this.lastNeed){if((w=this.fillLast(g))===void 0)return"";y=this.lastNeed,this.lastNeed=0}else y=0;return y<g.length?w?w+this.text(g,y):this.text(g,y):w||""},a.prototype.end=function(g){var w=g&&g.length?this.write(g):"";return this.lastNeed?w+"":w},a.prototype.text=function(g,w){var y=(function(k,F,I){var N=F.length-1;if(N<I)return 0;var j=l(F[N]);return j>=0?(j>0&&(k.lastNeed=j-1),j):--N<I||j===-2?0:(j=l(F[N]))>=0?(j>0&&(k.lastNeed=j-2),j):--N<I||j===-2?0:(j=l(F[N]))>=0?(j>0&&(j===2?j=0:k.lastNeed=j-3),j):0})(this,g,w);if(!this.lastNeed)return g.toString("utf8",w);this.lastTotal=y;var C=g.length-(y-this.lastNeed);return g.copy(this.lastChar,0,C),g.toString("utf8",w,C)},a.prototype.fillLast=function(g){if(this.lastNeed<=g.length)return g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);g.copy(this.lastChar,this.lastTotal-this.lastNeed,0,g.length),this.lastNeed-=g.length}},{"safe-buffer":217}],219:[function(r,n,i){(function(s){(function(){n.exports=function(o,a){for(var l=Math.min(o.length,a.length),c=new s(l),u=0;u<l;++u)c[u]=o[u]^a[u];return c}}).call(this)}).call(this,r("buffer").Buffer)},{buffer:220}],220:[function(r,n,i){(function(s){(function(){var o=r("base64-js"),a=r("ieee754");i.Buffer=c,i.SlowBuffer=function(V){return+V!=V&&(V=0),c.alloc(+V)},i.INSPECT_MAX_BYTES=50;function l(V){if(V>2147483647)throw new RangeError('The value "'+V+'" is invalid for option "size"');var H=new Uint8Array(V);return H.__proto__=c.prototype,H}function c(V,H,Z){if(typeof V=="number"){if(typeof H=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return d(V)}return u(V,H,Z)}function u(V,H,Z){if(typeof V=="string")return(function(oe,ue){if(typeof ue=="string"&&ue!==""||(ue="utf8"),!c.isEncoding(ue))throw new TypeError("Unknown encoding: "+ue);var Ce=0|v(oe,ue),ye=l(Ce),ne=ye.write(oe,ue);return ne!==Ce&&(ye=ye.slice(0,ne)),ye})(V,H);if(ArrayBuffer.isView(V))return f(V);if(V==null)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V);if(G(V,ArrayBuffer)||V&&G(V.buffer,ArrayBuffer))return(function(oe,ue,Ce){if(ue<0||oe.byteLength<ue)throw new RangeError('"offset" is outside of buffer bounds');if(oe.byteLength<ue+(Ce||0))throw new RangeError('"length" is outside of buffer bounds');var ye;return ye=ue===void 0&&Ce===void 0?new Uint8Array(oe):Ce===void 0?new Uint8Array(oe,ue):new Uint8Array(oe,ue,Ce),ye.__proto__=c.prototype,ye})(V,H,Z);if(typeof V=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var ie=V.valueOf&&V.valueOf();if(ie!=null&&ie!==V)return c.from(ie,H,Z);var te=(function(oe){if(c.isBuffer(oe)){var ue=0|m(oe.length),Ce=l(ue);return Ce.length===0||oe.copy(Ce,0,0,ue),Ce}if(oe.length!==void 0)return typeof oe.length!="number"||ee(oe.length)?l(0):f(oe);if(oe.type==="Buffer"&&Array.isArray(oe.data))return f(oe.data)})(V);if(te)return te;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof V[Symbol.toPrimitive]=="function")return c.from(V[Symbol.toPrimitive]("string"),H,Z);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof V)}function h(V){if(typeof V!="number")throw new TypeError('"size" argument must be of type number');if(V<0)throw new RangeError('The value "'+V+'" is invalid for option "size"')}function d(V){return h(V),l(V<0?0:0|m(V))}function f(V){for(var H=V.length<0?0:0|m(V.length),Z=l(H),ie=0;ie<H;ie+=1)Z[ie]=255&V[ie];return Z}function m(V){if(V>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|V}function v(V,H){if(c.isBuffer(V))return V.length;if(ArrayBuffer.isView(V)||G(V,ArrayBuffer))return V.byteLength;if(typeof V!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof V);var Z=V.length,ie=arguments.length>2&&arguments[2]===!0;if(!ie&&Z===0)return 0;for(var te=!1;;)switch(H){case"ascii":case"latin1":case"binary":return Z;case"utf8":case"utf-8":return q(V).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*Z;case"hex":return Z>>>1;case"base64":return X(V).length;default:if(te)return ie?-1:q(V).length;H=(""+H).toLowerCase(),te=!0}}function g(V,H,Z){var ie=!1;if((H===void 0||H<0)&&(H=0),H>this.length||((Z===void 0||Z>this.length)&&(Z=this.length),Z<=0)||(Z>>>=0)<=(H>>>=0))return"";for(V||(V="utf8");;)switch(V){case"hex":return B(this,H,Z);case"utf8":case"utf-8":return K(this,H,Z);case"ascii":return z(this,H,Z);case"latin1":case"binary":return M(this,H,Z);case"base64":return W(this,H,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,H,Z);default:if(ie)throw new TypeError("Unknown encoding: "+V);V=(V+"").toLowerCase(),ie=!0}}function w(V,H,Z){var ie=V[H];V[H]=V[Z],V[Z]=ie}function y(V,H,Z,ie,te){if(V.length===0)return-1;if(typeof Z=="string"?(ie=Z,Z=0):Z>2147483647?Z=2147483647:Z<-2147483648&&(Z=-2147483648),ee(Z=+Z)&&(Z=te?0:V.length-1),Z<0&&(Z=V.length+Z),Z>=V.length){if(te)return-1;Z=V.length-1}else if(Z<0){if(!te)return-1;Z=0}if(typeof H=="string"&&(H=c.from(H,ie)),c.isBuffer(H))return H.length===0?-1:C(V,H,Z,ie,te);if(typeof H=="number")return H&=255,typeof Uint8Array.prototype.indexOf=="function"?te?Uint8Array.prototype.indexOf.call(V,H,Z):Uint8Array.prototype.lastIndexOf.call(V,H,Z):C(V,[H],Z,ie,te);throw new TypeError("val must be string, number or Buffer")}function C(V,H,Z,ie,te){var oe,ue=1,Ce=V.length,ye=H.length;if(ie!==void 0&&((ie=String(ie).toLowerCase())==="ucs2"||ie==="ucs-2"||ie==="utf16le"||ie==="utf-16le")){if(V.length<2||H.length<2)return-1;ue=2,Ce/=2,ye/=2,Z/=2}function ne(xe,Fe){return ue===1?xe[Fe]:xe.readUInt16BE(Fe*ue)}if(te){var me=-1;for(oe=Z;oe<Ce;oe++)if(ne(V,oe)===ne(H,me===-1?0:oe-me)){if(me===-1&&(me=oe),oe-me+1===ye)return me*ue}else me!==-1&&(oe-=oe-me),me=-1}else for(Z+ye>Ce&&(Z=Ce-ye),oe=Z;oe>=0;oe--){for(var ve=!0,Te=0;Te<ye;Te++)if(ne(V,oe+Te)!==ne(H,Te)){ve=!1;break}if(ve)return oe}return-1}function k(V,H,Z,ie){Z=Number(Z)||0;var te=V.length-Z;ie?(ie=Number(ie))>te&&(ie=te):ie=te;var oe=H.length;ie>oe/2&&(ie=oe/2);for(var ue=0;ue<ie;++ue){var Ce=parseInt(H.substr(2*ue,2),16);if(ee(Ce))return ue;V[Z+ue]=Ce}return ue}function F(V,H,Z,ie){return Q(q(H,V.length-Z),V,Z,ie)}function I(V,H,Z,ie){return Q((function(te){for(var oe=[],ue=0;ue<te.length;++ue)oe.push(255&te.charCodeAt(ue));return oe})(H),V,Z,ie)}function N(V,H,Z,ie){return I(V,H,Z,ie)}function j(V,H,Z,ie){return Q(X(H),V,Z,ie)}function L(V,H,Z,ie){return Q((function(te,oe){for(var ue,Ce,ye,ne=[],me=0;me<te.length&&!((oe-=2)<0);++me)ue=te.charCodeAt(me),Ce=ue>>8,ye=ue%256,ne.push(ye),ne.push(Ce);return ne})(H,V.length-Z),V,Z,ie)}function W(V,H,Z){return H===0&&Z===V.length?o.fromByteArray(V):o.fromByteArray(V.slice(H,Z))}function K(V,H,Z){Z=Math.min(V.length,Z);for(var ie=[],te=H;te<Z;){var oe,ue,Ce,ye,ne=V[te],me=null,ve=ne>239?4:ne>223?3:ne>191?2:1;if(te+ve<=Z)switch(ve){case 1:ne<128&&(me=ne);break;case 2:(192&(oe=V[te+1]))==128&&(ye=(31&ne)<<6|63&oe)>127&&(me=ye);break;case 3:oe=V[te+1],ue=V[te+2],(192&oe)==128&&(192&ue)==128&&(ye=(15&ne)<<12|(63&oe)<<6|63&ue)>2047&&(ye<55296||ye>57343)&&(me=ye);break;case 4:oe=V[te+1],ue=V[te+2],Ce=V[te+3],(192&oe)==128&&(192&ue)==128&&(192&Ce)==128&&(ye=(15&ne)<<18|(63&oe)<<12|(63&ue)<<6|63&Ce)>65535&&ye<1114112&&(me=ye)}me===null?(me=65533,ve=1):me>65535&&(me-=65536,ie.push(me>>>10&1023|55296),me=56320|1023&me),ie.push(me),te+=ve}return(function(Te){var xe=Te.length;if(xe<=4096)return String.fromCharCode.apply(String,Te);for(var Fe="",Ge=0;Ge<xe;)Fe+=String.fromCharCode.apply(String,Te.slice(Ge,Ge+=4096));return Fe})(ie)}i.kMaxLength=2147483647,c.TYPED_ARRAY_SUPPORT=(function(){try{var V=new Uint8Array(1);return V.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},V.foo()===42}catch{return!1}})(),c.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),typeof Symbol<"u"&&Symbol.species!=null&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0,enumerable:!1,writable:!1}),c.poolSize=8192,c.from=function(V,H,Z){return u(V,H,Z)},c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,c.alloc=function(V,H,Z){return(function(ie,te,oe){return h(ie),ie<=0?l(ie):te!==void 0?typeof oe=="string"?l(ie).fill(te,oe):l(ie).fill(te):l(ie)})(V,H,Z)},c.allocUnsafe=function(V){return d(V)},c.allocUnsafeSlow=function(V){return d(V)},c.isBuffer=function(V){return V!=null&&V._isBuffer===!0&&V!==c.prototype},c.compare=function(V,H){if(G(V,Uint8Array)&&(V=c.from(V,V.offset,V.byteLength)),G(H,Uint8Array)&&(H=c.from(H,H.offset,H.byteLength)),!c.isBuffer(V)||!c.isBuffer(H))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(V===H)return 0;for(var Z=V.length,ie=H.length,te=0,oe=Math.min(Z,ie);te<oe;++te)if(V[te]!==H[te]){Z=V[te],ie=H[te];break}return Z<ie?-1:ie<Z?1:0},c.isEncoding=function(V){switch(String(V).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(V,H){if(!Array.isArray(V))throw new TypeError('"list" argument must be an Array of Buffers');if(V.length===0)return c.alloc(0);var Z;if(H===void 0)for(H=0,Z=0;Z<V.length;++Z)H+=V[Z].length;var ie=c.allocUnsafe(H),te=0;for(Z=0;Z<V.length;++Z){var oe=V[Z];if(G(oe,Uint8Array)&&(oe=c.from(oe)),!c.isBuffer(oe))throw new TypeError('"list" argument must be an Array of Buffers');oe.copy(ie,te),te+=oe.length}return ie},c.byteLength=v,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var V=this.length;if(V%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var H=0;H<V;H+=2)w(this,H,H+1);return this},c.prototype.swap32=function(){var V=this.length;if(V%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var H=0;H<V;H+=4)w(this,H,H+3),w(this,H+1,H+2);return this},c.prototype.swap64=function(){var V=this.length;if(V%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var H=0;H<V;H+=8)w(this,H,H+7),w(this,H+1,H+6),w(this,H+2,H+5),w(this,H+3,H+4);return this},c.prototype.toString=function(){var V=this.length;return V===0?"":arguments.length===0?K(this,0,V):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(V){if(!c.isBuffer(V))throw new TypeError("Argument must be a Buffer");return this===V||c.compare(this,V)===0},c.prototype.inspect=function(){var V="",H=i.INSPECT_MAX_BYTES;return V=this.toString("hex",0,H).replace(/(.{2})/g,"$1 ").trim(),this.length>H&&(V+=" ... "),"<Buffer "+V+">"},c.prototype.compare=function(V,H,Z,ie,te){if(G(V,Uint8Array)&&(V=c.from(V,V.offset,V.byteLength)),!c.isBuffer(V))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof V);if(H===void 0&&(H=0),Z===void 0&&(Z=V?V.length:0),ie===void 0&&(ie=0),te===void 0&&(te=this.length),H<0||Z>V.length||ie<0||te>this.length)throw new RangeError("out of range index");if(ie>=te&&H>=Z)return 0;if(ie>=te)return-1;if(H>=Z)return 1;if(this===V)return 0;for(var oe=(te>>>=0)-(ie>>>=0),ue=(Z>>>=0)-(H>>>=0),Ce=Math.min(oe,ue),ye=this.slice(ie,te),ne=V.slice(H,Z),me=0;me<Ce;++me)if(ye[me]!==ne[me]){oe=ye[me],ue=ne[me];break}return oe<ue?-1:ue<oe?1:0},c.prototype.includes=function(V,H,Z){return this.indexOf(V,H,Z)!==-1},c.prototype.indexOf=function(V,H,Z){return y(this,V,H,Z,!0)},c.prototype.lastIndexOf=function(V,H,Z){return y(this,V,H,Z,!1)},c.prototype.write=function(V,H,Z,ie){if(H===void 0)ie="utf8",Z=this.length,H=0;else if(Z===void 0&&typeof H=="string")ie=H,Z=this.length,H=0;else{if(!isFinite(H))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");H>>>=0,isFinite(Z)?(Z>>>=0,ie===void 0&&(ie="utf8")):(ie=Z,Z=void 0)}var te=this.length-H;if((Z===void 0||Z>te)&&(Z=te),V.length>0&&(Z<0||H<0)||H>this.length)throw new RangeError("Attempt to write outside buffer bounds");ie||(ie="utf8");for(var oe=!1;;)switch(ie){case"hex":return k(this,V,H,Z);case"utf8":case"utf-8":return F(this,V,H,Z);case"ascii":return I(this,V,H,Z);case"latin1":case"binary":return N(this,V,H,Z);case"base64":return j(this,V,H,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return L(this,V,H,Z);default:if(oe)throw new TypeError("Unknown encoding: "+ie);ie=(""+ie).toLowerCase(),oe=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function z(V,H,Z){var ie="";Z=Math.min(V.length,Z);for(var te=H;te<Z;++te)ie+=String.fromCharCode(127&V[te]);return ie}function M(V,H,Z){var ie="";Z=Math.min(V.length,Z);for(var te=H;te<Z;++te)ie+=String.fromCharCode(V[te]);return ie}function B(V,H,Z){var ie=V.length;(!H||H<0)&&(H=0),(!Z||Z<0||Z>ie)&&(Z=ie);for(var te="",oe=H;oe<Z;++oe)te+=P(V[oe]);return te}function R(V,H,Z){for(var ie=V.slice(H,Z),te="",oe=0;oe<ie.length;oe+=2)te+=String.fromCharCode(ie[oe]+256*ie[oe+1]);return te}function S(V,H,Z){if(V%1!=0||V<0)throw new RangeError("offset is not uint");if(V+H>Z)throw new RangeError("Trying to access beyond buffer length")}function _(V,H,Z,ie,te,oe){if(!c.isBuffer(V))throw new TypeError('"buffer" argument must be a Buffer instance');if(H>te||H<oe)throw new RangeError('"value" argument is out of bounds');if(Z+ie>V.length)throw new RangeError("Index out of range")}function T(V,H,Z,ie,te,oe){if(Z+ie>V.length)throw new RangeError("Index out of range");if(Z<0)throw new RangeError("Index out of range")}function E(V,H,Z,ie,te){return H=+H,Z>>>=0,te||T(V,0,Z,4),a.write(V,H,Z,ie,23,4),Z+4}function D(V,H,Z,ie,te){return H=+H,Z>>>=0,te||T(V,0,Z,8),a.write(V,H,Z,ie,52,8),Z+8}c.prototype.slice=function(V,H){var Z=this.length;(V=~~V)<0?(V+=Z)<0&&(V=0):V>Z&&(V=Z),(H=H===void 0?Z:~~H)<0?(H+=Z)<0&&(H=0):H>Z&&(H=Z),H<V&&(H=V);var ie=this.subarray(V,H);return ie.__proto__=c.prototype,ie},c.prototype.readUIntLE=function(V,H,Z){V>>>=0,H>>>=0,Z||S(V,H,this.length);for(var ie=this[V],te=1,oe=0;++oe<H&&(te*=256);)ie+=this[V+oe]*te;return ie},c.prototype.readUIntBE=function(V,H,Z){V>>>=0,H>>>=0,Z||S(V,H,this.length);for(var ie=this[V+--H],te=1;H>0&&(te*=256);)ie+=this[V+--H]*te;return ie},c.prototype.readUInt8=function(V,H){return V>>>=0,H||S(V,1,this.length),this[V]},c.prototype.readUInt16LE=function(V,H){return V>>>=0,H||S(V,2,this.length),this[V]|this[V+1]<<8},c.prototype.readUInt16BE=function(V,H){return V>>>=0,H||S(V,2,this.length),this[V]<<8|this[V+1]},c.prototype.readUInt32LE=function(V,H){return V>>>=0,H||S(V,4,this.length),(this[V]|this[V+1]<<8|this[V+2]<<16)+16777216*this[V+3]},c.prototype.readUInt32BE=function(V,H){return V>>>=0,H||S(V,4,this.length),16777216*this[V]+(this[V+1]<<16|this[V+2]<<8|this[V+3])},c.prototype.readIntLE=function(V,H,Z){V>>>=0,H>>>=0,Z||S(V,H,this.length);for(var ie=this[V],te=1,oe=0;++oe<H&&(te*=256);)ie+=this[V+oe]*te;return ie>=(te*=128)&&(ie-=Math.pow(2,8*H)),ie},c.prototype.readIntBE=function(V,H,Z){V>>>=0,H>>>=0,Z||S(V,H,this.length);for(var ie=H,te=1,oe=this[V+--ie];ie>0&&(te*=256);)oe+=this[V+--ie]*te;return oe>=(te*=128)&&(oe-=Math.pow(2,8*H)),oe},c.prototype.readInt8=function(V,H){return V>>>=0,H||S(V,1,this.length),128&this[V]?-1*(255-this[V]+1):this[V]},c.prototype.readInt16LE=function(V,H){V>>>=0,H||S(V,2,this.length);var Z=this[V]|this[V+1]<<8;return 32768&Z?4294901760|Z:Z},c.prototype.readInt16BE=function(V,H){V>>>=0,H||S(V,2,this.length);var Z=this[V+1]|this[V]<<8;return 32768&Z?4294901760|Z:Z},c.prototype.readInt32LE=function(V,H){return V>>>=0,H||S(V,4,this.length),this[V]|this[V+1]<<8|this[V+2]<<16|this[V+3]<<24},c.prototype.readInt32BE=function(V,H){return V>>>=0,H||S(V,4,this.length),this[V]<<24|this[V+1]<<16|this[V+2]<<8|this[V+3]},c.prototype.readFloatLE=function(V,H){return V>>>=0,H||S(V,4,this.length),a.read(this,V,!0,23,4)},c.prototype.readFloatBE=function(V,H){return V>>>=0,H||S(V,4,this.length),a.read(this,V,!1,23,4)},c.prototype.readDoubleLE=function(V,H){return V>>>=0,H||S(V,8,this.length),a.read(this,V,!0,52,8)},c.prototype.readDoubleBE=function(V,H){return V>>>=0,H||S(V,8,this.length),a.read(this,V,!1,52,8)},c.prototype.writeUIntLE=function(V,H,Z,ie){V=+V,H>>>=0,Z>>>=0,ie||_(this,V,H,Z,Math.pow(2,8*Z)-1,0);var te=1,oe=0;for(this[H]=255&V;++oe<Z&&(te*=256);)this[H+oe]=V/te&255;return H+Z},c.prototype.writeUIntBE=function(V,H,Z,ie){V=+V,H>>>=0,Z>>>=0,ie||_(this,V,H,Z,Math.pow(2,8*Z)-1,0);var te=Z-1,oe=1;for(this[H+te]=255&V;--te>=0&&(oe*=256);)this[H+te]=V/oe&255;return H+Z},c.prototype.writeUInt8=function(V,H,Z){return V=+V,H>>>=0,Z||_(this,V,H,1,255,0),this[H]=255&V,H+1},c.prototype.writeUInt16LE=function(V,H,Z){return V=+V,H>>>=0,Z||_(this,V,H,2,65535,0),this[H]=255&V,this[H+1]=V>>>8,H+2},c.prototype.writeUInt16BE=function(V,H,Z){return V=+V,H>>>=0,Z||_(this,V,H,2,65535,0),this[H]=V>>>8,this[H+1]=255&V,H+2},c.prototype.writeUInt32LE=function(V,H,Z){return V=+V,H>>>=0,Z||_(this,V,H,4,4294967295,0),this[H+3]=V>>>24,this[H+2]=V>>>16,this[H+1]=V>>>8,this[H]=255&V,H+4},c.prototype.writeUInt32BE=function(V,H,Z){return V=+V,H>>>=0,Z||_(this,V,H,4,4294967295,0),this[H]=V>>>24,this[H+1]=V>>>16,this[H+2]=V>>>8,this[H+3]=255&V,H+4},c.prototype.writeIntLE=function(V,H,Z,ie){if(V=+V,H>>>=0,!ie){var te=Math.pow(2,8*Z-1);_(this,V,H,Z,te-1,-te)}var oe=0,ue=1,Ce=0;for(this[H]=255&V;++oe<Z&&(ue*=256);)V<0&&Ce===0&&this[H+oe-1]!==0&&(Ce=1),this[H+oe]=(V/ue>>0)-Ce&255;return H+Z},c.prototype.writeIntBE=function(V,H,Z,ie){if(V=+V,H>>>=0,!ie){var te=Math.pow(2,8*Z-1);_(this,V,H,Z,te-1,-te)}var oe=Z-1,ue=1,Ce=0;for(this[H+oe]=255&V;--oe>=0&&(ue*=256);)V<0&&Ce===0&&this[H+oe+1]!==0&&(Ce=1),this[H+oe]=(V/ue>>0)-Ce&255;return H+Z},c.prototype.writeInt8=function(V,H,Z){return V=+V,H>>>=0,Z||_(this,V,H,1,127,-128),V<0&&(V=255+V+1),this[H]=255&V,H+1},c.prototype.writeInt16LE=function(V,H,Z){return V=+V,H>>>=0,Z||_(this,V,H,2,32767,-32768),this[H]=255&V,this[H+1]=V>>>8,H+2},c.prototype.writeInt16BE=function(V,H,Z){return V=+V,H>>>=0,Z||_(this,V,H,2,32767,-32768),this[H]=V>>>8,this[H+1]=255&V,H+2},c.prototype.writeInt32LE=function(V,H,Z){return V=+V,H>>>=0,Z||_(this,V,H,4,2147483647,-2147483648),this[H]=255&V,this[H+1]=V>>>8,this[H+2]=V>>>16,this[H+3]=V>>>24,H+4},c.prototype.writeInt32BE=function(V,H,Z){return V=+V,H>>>=0,Z||_(this,V,H,4,2147483647,-2147483648),V<0&&(V=4294967295+V+1),this[H]=V>>>24,this[H+1]=V>>>16,this[H+2]=V>>>8,this[H+3]=255&V,H+4},c.prototype.writeFloatLE=function(V,H,Z){return E(this,V,H,!0,Z)},c.prototype.writeFloatBE=function(V,H,Z){return E(this,V,H,!1,Z)},c.prototype.writeDoubleLE=function(V,H,Z){return D(this,V,H,!0,Z)},c.prototype.writeDoubleBE=function(V,H,Z){return D(this,V,H,!1,Z)},c.prototype.copy=function(V,H,Z,ie){if(!c.isBuffer(V))throw new TypeError("argument should be a Buffer");if(Z||(Z=0),ie||ie===0||(ie=this.length),H>=V.length&&(H=V.length),H||(H=0),ie>0&&ie<Z&&(ie=Z),ie===Z||V.length===0||this.length===0)return 0;if(H<0)throw new RangeError("targetStart out of bounds");if(Z<0||Z>=this.length)throw new RangeError("Index out of range");if(ie<0)throw new RangeError("sourceEnd out of bounds");ie>this.length&&(ie=this.length),V.length-H<ie-Z&&(ie=V.length-H+Z);var te=ie-Z;if(this===V&&typeof Uint8Array.prototype.copyWithin=="function")this.copyWithin(H,Z,ie);else if(this===V&&Z<H&&H<ie)for(var oe=te-1;oe>=0;--oe)V[oe+H]=this[oe+Z];else Uint8Array.prototype.set.call(V,this.subarray(Z,ie),H);return te},c.prototype.fill=function(V,H,Z,ie){if(typeof V=="string"){if(typeof H=="string"?(ie=H,H=0,Z=this.length):typeof Z=="string"&&(ie=Z,Z=this.length),ie!==void 0&&typeof ie!="string")throw new TypeError("encoding must be a string");if(typeof ie=="string"&&!c.isEncoding(ie))throw new TypeError("Unknown encoding: "+ie);if(V.length===1){var te=V.charCodeAt(0);(ie==="utf8"&&te<128||ie==="latin1")&&(V=te)}}else typeof V=="number"&&(V&=255);if(H<0||this.length<H||this.length<Z)throw new RangeError("Out of range index");if(Z<=H)return this;var oe;if(H>>>=0,Z=Z===void 0?this.length:Z>>>0,V||(V=0),typeof V=="number")for(oe=H;oe<Z;++oe)this[oe]=V;else{var ue=c.isBuffer(V)?V:c.from(V,ie),Ce=ue.length;if(Ce===0)throw new TypeError('The value "'+V+'" is invalid for argument "value"');for(oe=0;oe<Z-H;++oe)this[oe+H]=ue[oe%Ce]}return this};var O=/[^+/0-9A-Za-z-_]/g;function P(V){return V<16?"0"+V.toString(16):V.toString(16)}function q(V,H){var Z;H=H||1/0;for(var ie=V.length,te=null,oe=[],ue=0;ue<ie;++ue){if((Z=V.charCodeAt(ue))>55295&&Z<57344){if(!te){if(Z>56319){(H-=3)>-1&&oe.push(239,191,189);continue}if(ue+1===ie){(H-=3)>-1&&oe.push(239,191,189);continue}te=Z;continue}if(Z<56320){(H-=3)>-1&&oe.push(239,191,189),te=Z;continue}Z=65536+(te-55296<<10|Z-56320)}else te&&(H-=3)>-1&&oe.push(239,191,189);if(te=null,Z<128){if((H-=1)<0)break;oe.push(Z)}else if(Z<2048){if((H-=2)<0)break;oe.push(Z>>6|192,63&Z|128)}else if(Z<65536){if((H-=3)<0)break;oe.push(Z>>12|224,Z>>6&63|128,63&Z|128)}else{if(!(Z<1114112))throw new Error("Invalid code point");if((H-=4)<0)break;oe.push(Z>>18|240,Z>>12&63|128,Z>>6&63|128,63&Z|128)}}return oe}function X(V){return o.toByteArray((function(H){if((H=(H=H.split("=")[0]).trim().replace(O,"")).length<2)return"";for(;H.length%4!=0;)H+="=";return H})(V))}function Q(V,H,Z,ie){for(var te=0;te<ie&&!(te+Z>=H.length||te>=V.length);++te)H[te+Z]=V[te];return te}function G(V,H){return V instanceof H||V!=null&&V.constructor!=null&&V.constructor.name!=null&&V.constructor.name===H.name}function ee(V){return V!=V}}).call(this)}).call(this,r("buffer").Buffer)},{"base64-js":185,buffer:220,ieee754:439}],221:[function(r,n,i){var s=r("safe-buffer").Buffer,o=r("stream").Transform,a=r("string_decoder").StringDecoder;function l(c){o.call(this),this.hashMode=typeof c=="string",this.hashMode?this[c]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}r("inherits")(l,o),l.prototype.update=function(c,u,h){typeof c=="string"&&(c=s.from(c,u));var d=this._update(c);return this.hashMode?this:(h&&(d=this._toString(d,h)),d)},l.prototype.setAutoPadding=function(){},l.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},l.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},l.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},l.prototype._transform=function(c,u,h){var d;try{this.hashMode?this._update(c):this.push(this._update(c))}catch(f){d=f}finally{h(d)}},l.prototype._flush=function(c){var u;try{this.push(this.__final())}catch(h){u=h}c(u)},l.prototype._finalOrDigest=function(c){var u=this.__final()||s.alloc(0);return c&&(u=this._toString(u,c,!0)),u},l.prototype._toString=function(c,u,h){if(this._decoder||(this._decoder=new a(u),this._encoding=u),this._encoding!==u)throw new Error("can't switch encodings");var d=this._decoder.write(c);return h&&(d+=this._decoder.end()),d},n.exports=l},{inherits:440,"safe-buffer":494,stream:505,string_decoder:218}],222:[function(r,n,i){var s=r("../internals/is-callable"),o=r("../internals/try-to-string"),a=TypeError;n.exports=function(l){if(s(l))return l;throw new a(o(l)+" is not a function")}},{"../internals/is-callable":285,"../internals/try-to-string":349}],223:[function(r,n,i){var s=r("../internals/is-constructor"),o=r("../internals/try-to-string"),a=TypeError;n.exports=function(l){if(s(l))return l;throw new a(o(l)+" is not a constructor")}},{"../internals/is-constructor":286,"../internals/try-to-string":349}],224:[function(r,n,i){var s=r("../internals/is-callable"),o=String,a=TypeError;n.exports=function(l){if(typeof l=="object"||s(l))return l;throw new a("Can't set "+o(l)+" as a prototype")}},{"../internals/is-callable":285}],225:[function(r,n,i){var s=r("../internals/well-known-symbol"),o=r("../internals/object-create"),a=r("../internals/object-define-property").f,l=s("unscopables"),c=Array.prototype;c[l]===void 0&&a(c,l,{configurable:!0,value:o(null)}),n.exports=function(u){c[l][u]=!0}},{"../internals/object-create":306,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],226:[function(r,n,i){var s=r("../internals/object-is-prototype-of"),o=TypeError;n.exports=function(a,l){if(s(l,a))return a;throw new o("Incorrect invocation")}},{"../internals/object-is-prototype-of":314}],227:[function(r,n,i){var s=r("../internals/is-object"),o=String,a=TypeError;n.exports=function(l){if(s(l))return l;throw new a(o(l)+" is not an object")}},{"../internals/is-object":289}],228:[function(r,n,i){var s=r("../internals/to-indexed-object"),o=r("../internals/to-absolute-index"),a=r("../internals/length-of-array-like"),l=function(c){return function(u,h,d){var f,m=s(u),v=a(m),g=o(d,v);if(c&&h!=h){for(;v>g;)if((f=m[g++])!=f)return!0}else for(;v>g;g++)if((c||g in m)&&m[g]===h)return c||g||0;return!c&&-1}};n.exports={includes:l(!0),indexOf:l(!1)}},{"../internals/length-of-array-like":299,"../internals/to-absolute-index":340,"../internals/to-indexed-object":341}],229:[function(r,n,i){var s=r("../internals/function-bind-context"),o=r("../internals/function-uncurry-this"),a=r("../internals/indexed-object"),l=r("../internals/to-object"),c=r("../internals/length-of-array-like"),u=r("../internals/array-species-create"),h=o([].push),d=function(f){var m=f===1,v=f===2,g=f===3,w=f===4,y=f===6,C=f===7,k=f===5||y;return function(F,I,N,j){for(var L,W,K=l(F),z=a(K),M=s(I,N),B=c(z),R=0,S=j||u,_=m?S(F,B):v||C?S(F,0):void 0;B>R;R++)if((k||R in z)&&(W=M(L=z[R],R,K),f))if(m)_[R]=W;else if(W)switch(f){case 3:return!0;case 5:return L;case 6:return R;case 2:h(_,L)}else switch(f){case 4:return!1;case 7:h(_,L)}return y?-1:g||w?w:_}};n.exports={forEach:d(0),map:d(1),filter:d(2),some:d(3),every:d(4),find:d(5),findIndex:d(6),filterReject:d(7)}},{"../internals/array-species-create":233,"../internals/function-bind-context":262,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/length-of-array-like":299,"../internals/to-object":344}],230:[function(r,n,i){var s=r("../internals/to-absolute-index"),o=r("../internals/length-of-array-like"),a=r("../internals/create-property"),l=Array,c=Math.max;n.exports=function(u,h,d){for(var f=o(u),m=s(h,f),v=s(d===void 0?f:d,f),g=l(c(v-m,0)),w=0;m<v;m++,w++)a(g,w,u[m]);return g.length=w,g}},{"../internals/create-property":243,"../internals/length-of-array-like":299,"../internals/to-absolute-index":340}],231:[function(r,n,i){var s=r("../internals/function-uncurry-this");n.exports=s([].slice)},{"../internals/function-uncurry-this":268}],232:[function(r,n,i){var s=r("../internals/is-array"),o=r("../internals/is-constructor"),a=r("../internals/is-object"),l=r("../internals/well-known-symbol")("species"),c=Array;n.exports=function(u){var h;return s(u)&&(h=u.constructor,(o(h)&&(h===c||s(h.prototype))||a(h)&&(h=h[l])===null)&&(h=void 0)),h===void 0?c:h}},{"../internals/is-array":284,"../internals/is-constructor":286,"../internals/is-object":289,"../internals/well-known-symbol":357}],233:[function(r,n,i){var s=r("../internals/array-species-constructor");n.exports=function(o,a){return new(s(o))(a===0?0:a)}},{"../internals/array-species-constructor":232}],234:[function(r,n,i){var s=r("../internals/well-known-symbol")("iterator"),o=!1;try{var a=0,l={next:function(){return{done:!!a++}},return:function(){o=!0}};l[s]=function(){return this},Array.from(l,(function(){throw 2}))}catch{}n.exports=function(c,u){try{if(!u&&!o)return!1}catch{return!1}var h=!1;try{var d={};d[s]=function(){return{next:function(){return{done:h=!0}}}},c(d)}catch{}return h}},{"../internals/well-known-symbol":357}],235:[function(r,n,i){var s=r("../internals/function-uncurry-this"),o=s({}.toString),a=s("".slice);n.exports=function(l){return a(o(l),8,-1)}},{"../internals/function-uncurry-this":268}],236:[function(r,n,i){var s=r("../internals/to-string-tag-support"),o=r("../internals/is-callable"),a=r("../internals/classof-raw"),l=r("../internals/well-known-symbol")("toStringTag"),c=Object,u=a((function(){return arguments})())==="Arguments";n.exports=s?a:function(h){var d,f,m;return h===void 0?"Undefined":h===null?"Null":typeof(f=(function(v,g){try{return v[g]}catch{}})(d=c(h),l))=="string"?f:u?a(d):(m=a(d))==="Object"&&o(d.callee)?"Arguments":m}},{"../internals/classof-raw":235,"../internals/is-callable":285,"../internals/to-string-tag-support":347,"../internals/well-known-symbol":357}],237:[function(r,n,i){var s=r("../internals/has-own-property"),o=r("../internals/own-keys"),a=r("../internals/object-get-own-property-descriptor"),l=r("../internals/object-define-property");n.exports=function(c,u,h){for(var d=o(u),f=l.f,m=a.f,v=0;v<d.length;v++){var g=d[v];s(c,g)||h&&s(h,g)||f(c,g,m(u,g))}}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/own-keys":321}],238:[function(r,n,i){var s=r("../internals/well-known-symbol")("match");n.exports=function(o){var a=/./;try{"/./"[o](a)}catch{try{return a[s]=!1,"/./"[o](a)}catch{}}return!1}},{"../internals/well-known-symbol":357}],239:[function(r,n,i){var s=r("../internals/fails");n.exports=!s((function(){function o(){}return o.prototype.constructor=null,Object.getPrototypeOf(new o)!==o.prototype}))},{"../internals/fails":260}],240:[function(r,n,i){n.exports=function(s,o){return{value:s,done:o}}},{}],241:[function(r,n,i){var s=r("../internals/descriptors"),o=r("../internals/object-define-property"),a=r("../internals/create-property-descriptor");n.exports=s?function(l,c,u){return o.f(l,c,a(1,u))}:function(l,c,u){return l[c]=u,l}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/object-define-property":308}],242:[function(r,n,i){n.exports=function(s,o){return{enumerable:!(1&s),configurable:!(2&s),writable:!(4&s),value:o}}},{}],243:[function(r,n,i){var s=r("../internals/to-property-key"),o=r("../internals/object-define-property"),a=r("../internals/create-property-descriptor");n.exports=function(l,c,u){var h=s(c);h in l?o.f(l,h,a(0,u)):l[h]=u}},{"../internals/create-property-descriptor":242,"../internals/object-define-property":308,"../internals/to-property-key":346}],244:[function(r,n,i){var s=r("../internals/make-built-in"),o=r("../internals/object-define-property");n.exports=function(a,l,c){return c.get&&s(c.get,l,{getter:!0}),c.set&&s(c.set,l,{setter:!0}),o.f(a,l,c)}},{"../internals/make-built-in":300,"../internals/object-define-property":308}],245:[function(r,n,i){var s=r("../internals/is-callable"),o=r("../internals/object-define-property"),a=r("../internals/make-built-in"),l=r("../internals/define-global-property");n.exports=function(c,u,h,d){d||(d={});var f=d.enumerable,m=d.name!==void 0?d.name:u;if(s(h)&&a(h,m,d),d.global)f?c[u]=h:l(u,h);else{try{d.unsafe?c[u]&&(f=!0):delete c[u]}catch{}f?c[u]=h:o.f(c,u,{value:h,enumerable:!1,configurable:!d.nonConfigurable,writable:!d.nonWritable})}return c}},{"../internals/define-global-property":246,"../internals/is-callable":285,"../internals/make-built-in":300,"../internals/object-define-property":308}],246:[function(r,n,i){var s=r("../internals/global"),o=Object.defineProperty;n.exports=function(a,l){try{o(s,a,{value:l,configurable:!0,writable:!0})}catch{s[a]=l}return l}},{"../internals/global":274}],247:[function(r,n,i){var s=r("../internals/fails");n.exports=!s((function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}))},{"../internals/fails":260}],248:[function(r,n,i){var s=typeof document=="object"&&document.all,o=s===void 0&&s!==void 0;n.exports={all:s,IS_HTMLDDA:o}},{}],249:[function(r,n,i){var s=r("../internals/global"),o=r("../internals/is-object"),a=s.document,l=o(a)&&o(a.createElement);n.exports=function(c){return l?a.createElement(c):{}}},{"../internals/global":274,"../internals/is-object":289}],250:[function(r,n,i){var s=r("../internals/engine-is-deno"),o=r("../internals/engine-is-node");n.exports=!s&&!o&&typeof window=="object"&&typeof document=="object"},{"../internals/engine-is-deno":251,"../internals/engine-is-node":254}],251:[function(r,n,i){n.exports=typeof Deno=="object"&&Deno&&typeof Deno.version=="object"},{}],252:[function(r,n,i){var s=r("../internals/engine-user-agent");n.exports=/ipad|iphone|ipod/i.test(s)&&typeof Pebble<"u"},{"../internals/engine-user-agent":256}],253:[function(r,n,i){var s=r("../internals/engine-user-agent");n.exports=/(?:ipad|iphone|ipod).*applewebkit/i.test(s)},{"../internals/engine-user-agent":256}],254:[function(r,n,i){var s=r("../internals/global"),o=r("../internals/classof-raw");n.exports=o(s.process)==="process"},{"../internals/classof-raw":235,"../internals/global":274}],255:[function(r,n,i){var s=r("../internals/engine-user-agent");n.exports=/web0s(?!.*chrome)/i.test(s)},{"../internals/engine-user-agent":256}],256:[function(r,n,i){n.exports=typeof navigator<"u"&&String(navigator.userAgent)||""},{}],257:[function(r,n,i){var s,o,a=r("../internals/global"),l=r("../internals/engine-user-agent"),c=a.process,u=a.Deno,h=c&&c.versions||u&&u.version,d=h&&h.v8;d&&(o=(s=d.split("."))[0]>0&&s[0]<4?1:+(s[0]+s[1])),!o&&l&&(!(s=l.match(/Edge\/(\d+)/))||s[1]>=74)&&(s=l.match(/Chrome\/(\d+)/))&&(o=+s[1]),n.exports=o},{"../internals/engine-user-agent":256,"../internals/global":274}],258:[function(r,n,i){n.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},{}],259:[function(r,n,i){var s=r("../internals/global"),o=r("../internals/object-get-own-property-descriptor").f,a=r("../internals/create-non-enumerable-property"),l=r("../internals/define-built-in"),c=r("../internals/define-global-property"),u=r("../internals/copy-constructor-properties"),h=r("../internals/is-forced");n.exports=function(d,f){var m,v,g,w,y,C=d.target,k=d.global,F=d.stat;if(m=k?s:F?s[C]||c(C,{}):(s[C]||{}).prototype)for(v in f){if(w=f[v],g=d.dontCallGetSet?(y=o(m,v))&&y.value:m[v],!h(k?v:C+(F?".":"#")+v,d.forced)&&g!==void 0){if(typeof w==typeof g)continue;u(w,g)}(d.sham||g&&g.sham)&&a(w,"sham",!0),l(m,v,w,d)}}},{"../internals/copy-constructor-properties":237,"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/define-global-property":246,"../internals/global":274,"../internals/is-forced":287,"../internals/object-get-own-property-descriptor":309}],260:[function(r,n,i){n.exports=function(s){try{return!!s()}catch{return!0}}},{}],261:[function(r,n,i){var s=r("../internals/function-bind-native"),o=Function.prototype,a=o.apply,l=o.call;n.exports=typeof Reflect=="object"&&Reflect.apply||(s?l.bind(a):function(){return l.apply(a,arguments)})},{"../internals/function-bind-native":263}],262:[function(r,n,i){var s=r("../internals/function-uncurry-this-clause"),o=r("../internals/a-callable"),a=r("../internals/function-bind-native"),l=s(s.bind);n.exports=function(c,u){return o(c),u===void 0?c:a?l(c,u):function(){return c.apply(u,arguments)}}},{"../internals/a-callable":222,"../internals/function-bind-native":263,"../internals/function-uncurry-this-clause":267}],263:[function(r,n,i){var s=r("../internals/fails");n.exports=!s((function(){var o=(function(){}).bind();return typeof o!="function"||o.hasOwnProperty("prototype")}))},{"../internals/fails":260}],264:[function(r,n,i){var s=r("../internals/function-bind-native"),o=Function.prototype.call;n.exports=s?o.bind(o):function(){return o.apply(o,arguments)}},{"../internals/function-bind-native":263}],265:[function(r,n,i){var s=r("../internals/descriptors"),o=r("../internals/has-own-property"),a=Function.prototype,l=s&&Object.getOwnPropertyDescriptor,c=o(a,"name"),u=c&&(function(){}).name==="something",h=c&&(!s||s&&l(a,"name").configurable);n.exports={EXISTS:c,PROPER:u,CONFIGURABLE:h}},{"../internals/descriptors":247,"../internals/has-own-property":275}],266:[function(r,n,i){var s=r("../internals/function-uncurry-this"),o=r("../internals/a-callable");n.exports=function(a,l,c){try{return s(o(Object.getOwnPropertyDescriptor(a,l)[c]))}catch{}}},{"../internals/a-callable":222,"../internals/function-uncurry-this":268}],267:[function(r,n,i){var s=r("../internals/classof-raw"),o=r("../internals/function-uncurry-this");n.exports=function(a){if(s(a)==="Function")return o(a)}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268}],268:[function(r,n,i){var s=r("../internals/function-bind-native"),o=Function.prototype,a=o.call,l=s&&o.bind.bind(a,a);n.exports=s?l:function(c){return function(){return a.apply(c,arguments)}}},{"../internals/function-bind-native":263}],269:[function(r,n,i){var s=r("../internals/global"),o=r("../internals/is-callable"),a=function(l){return o(l)?l:void 0};n.exports=function(l,c){return arguments.length<2?a(s[l]):s[l]&&s[l][c]}},{"../internals/global":274,"../internals/is-callable":285}],270:[function(r,n,i){var s=r("../internals/classof"),o=r("../internals/get-method"),a=r("../internals/is-null-or-undefined"),l=r("../internals/iterators"),c=r("../internals/well-known-symbol")("iterator");n.exports=function(u){if(!a(u))return o(u,c)||o(u,"@@iterator")||l[s(u)]}},{"../internals/classof":236,"../internals/get-method":273,"../internals/is-null-or-undefined":288,"../internals/iterators":298,"../internals/well-known-symbol":357}],271:[function(r,n,i){var s=r("../internals/function-call"),o=r("../internals/a-callable"),a=r("../internals/an-object"),l=r("../internals/try-to-string"),c=r("../internals/get-iterator-method"),u=TypeError;n.exports=function(h,d){var f=arguments.length<2?c(h):d;if(o(f))return a(s(f,h));throw new u(l(h)+" is not iterable")}},{"../internals/a-callable":222,"../internals/an-object":227,"../internals/function-call":264,"../internals/get-iterator-method":270,"../internals/try-to-string":349}],272:[function(r,n,i){var s=r("../internals/function-uncurry-this"),o=r("../internals/is-array"),a=r("../internals/is-callable"),l=r("../internals/classof-raw"),c=r("../internals/to-string"),u=s([].push);n.exports=function(h){if(a(h))return h;if(o(h)){for(var d=h.length,f=[],m=0;m<d;m++){var v=h[m];typeof v=="string"?u(f,v):typeof v!="number"&&l(v)!=="Number"&&l(v)!=="String"||u(f,c(v))}var g=f.length,w=!0;return function(y,C){if(w)return w=!1,C;if(o(this))return C;for(var k=0;k<g;k++)if(f[k]===y)return C}}}},{"../internals/classof-raw":235,"../internals/function-uncurry-this":268,"../internals/is-array":284,"../internals/is-callable":285,"../internals/to-string":348}],273:[function(r,n,i){var s=r("../internals/a-callable"),o=r("../internals/is-null-or-undefined");n.exports=function(a,l){var c=a[l];return o(c)?void 0:s(c)}},{"../internals/a-callable":222,"../internals/is-null-or-undefined":288}],274:[function(r,n,i){(function(s){(function(){var o=function(a){return a&&a.Math===Math&&a};n.exports=o(typeof globalThis=="object"&&globalThis)||o(typeof window=="object"&&window)||o(typeof self=="object"&&self)||o(typeof s=="object"&&s)||(function(){return this})()||this||Function("return this")()}).call(this)}).call(this,typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{}],275:[function(r,n,i){var s=r("../internals/function-uncurry-this"),o=r("../internals/to-object"),a=s({}.hasOwnProperty);n.exports=Object.hasOwn||function(l,c){return a(o(l),c)}},{"../internals/function-uncurry-this":268,"../internals/to-object":344}],276:[function(r,n,i){n.exports={}},{}],277:[function(r,n,i){n.exports=function(s,o){try{arguments.length===1?console.error(s):console.error(s,o)}catch{}}},{}],278:[function(r,n,i){var s=r("../internals/get-built-in");n.exports=s("document","documentElement")},{"../internals/get-built-in":269}],279:[function(r,n,i){var s=r("../internals/descriptors"),o=r("../internals/fails"),a=r("../internals/document-create-element");n.exports=!s&&!o((function(){return Object.defineProperty(a("div"),"a",{get:function(){return 7}}).a!==7}))},{"../internals/descriptors":247,"../internals/document-create-element":249,"../internals/fails":260}],280:[function(r,n,i){var s=r("../internals/function-uncurry-this"),o=r("../internals/fails"),a=r("../internals/classof-raw"),l=Object,c=s("".split);n.exports=o((function(){return!l("z").propertyIsEnumerable(0)}))?function(u){return a(u)==="String"?c(u,""):l(u)}:l},{"../internals/classof-raw":235,"../internals/fails":260,"../internals/function-uncurry-this":268}],281:[function(r,n,i){var s=r("../internals/function-uncurry-this"),o=r("../internals/is-callable"),a=r("../internals/shared-store"),l=s(Function.toString);o(a.inspectSource)||(a.inspectSource=function(c){return l(c)}),n.exports=a.inspectSource},{"../internals/function-uncurry-this":268,"../internals/is-callable":285,"../internals/shared-store":333}],282:[function(r,n,i){var s,o,a,l=r("../internals/weak-map-basic-detection"),c=r("../internals/global"),u=r("../internals/is-object"),h=r("../internals/create-non-enumerable-property"),d=r("../internals/has-own-property"),f=r("../internals/shared-store"),m=r("../internals/shared-key"),v=r("../internals/hidden-keys"),g=c.TypeError,w=c.WeakMap;if(l||f.state){var y=f.state||(f.state=new w);y.get=y.get,y.has=y.has,y.set=y.set,s=function(k,F){if(y.has(k))throw new g("Object already initialized");return F.facade=k,y.set(k,F),F},o=function(k){return y.get(k)||{}},a=function(k){return y.has(k)}}else{var C=m("state");v[C]=!0,s=function(k,F){if(d(k,C))throw new g("Object already initialized");return F.facade=k,h(k,C,F),F},o=function(k){return d(k,C)?k[C]:{}},a=function(k){return d(k,C)}}n.exports={set:s,get:o,has:a,enforce:function(k){return a(k)?o(k):s(k,{})},getterFor:function(k){return function(F){var I;if(!u(F)||(I=o(F)).type!==k)throw new g("Incompatible receiver, "+k+" required");return I}}}},{"../internals/create-non-enumerable-property":241,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/is-object":289,"../internals/shared-key":332,"../internals/shared-store":333,"../internals/weak-map-basic-detection":354}],283:[function(r,n,i){var s=r("../internals/well-known-symbol"),o=r("../internals/iterators"),a=s("iterator"),l=Array.prototype;n.exports=function(c){return c!==void 0&&(o.Array===c||l[a]===c)}},{"../internals/iterators":298,"../internals/well-known-symbol":357}],284:[function(r,n,i){var s=r("../internals/classof-raw");n.exports=Array.isArray||function(o){return s(o)==="Array"}},{"../internals/classof-raw":235}],285:[function(r,n,i){var s=r("../internals/document-all"),o=s.all;n.exports=s.IS_HTMLDDA?function(a){return typeof a=="function"||a===o}:function(a){return typeof a=="function"}},{"../internals/document-all":248}],286:[function(r,n,i){var s=r("../internals/function-uncurry-this"),o=r("../internals/fails"),a=r("../internals/is-callable"),l=r("../internals/classof"),c=r("../internals/get-built-in"),u=r("../internals/inspect-source"),h=function(){},d=[],f=c("Reflect","construct"),m=/^\s*(?:class|function)\b/,v=s(m.exec),g=!m.test(h),w=function(C){if(!a(C))return!1;try{return f(h,d,C),!0}catch{return!1}},y=function(C){if(!a(C))return!1;switch(l(C)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return g||!!v(m,u(C))}catch{return!0}};y.sham=!0,n.exports=!f||o((function(){var C;return w(w.call)||!w(Object)||!w((function(){C=!0}))||C}))?y:w},{"../internals/classof":236,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/inspect-source":281,"../internals/is-callable":285}],287:[function(r,n,i){var s=r("../internals/fails"),o=r("../internals/is-callable"),a=/#|\.prototype\./,l=function(f,m){var v=u[c(f)];return v===d||v!==h&&(o(m)?s(m):!!m)},c=l.normalize=function(f){return String(f).replace(a,".").toLowerCase()},u=l.data={},h=l.NATIVE="N",d=l.POLYFILL="P";n.exports=l},{"../internals/fails":260,"../internals/is-callable":285}],288:[function(r,n,i){n.exports=function(s){return s==null}},{}],289:[function(r,n,i){var s=r("../internals/is-callable"),o=r("../internals/document-all"),a=o.all;n.exports=o.IS_HTMLDDA?function(l){return typeof l=="object"?l!==null:s(l)||l===a}:function(l){return typeof l=="object"?l!==null:s(l)}},{"../internals/document-all":248,"../internals/is-callable":285}],290:[function(r,n,i){n.exports=!1},{}],291:[function(r,n,i){var s=r("../internals/is-object"),o=r("../internals/classof-raw"),a=r("../internals/well-known-symbol")("match");n.exports=function(l){var c;return s(l)&&((c=l[a])!==void 0?!!c:o(l)==="RegExp")}},{"../internals/classof-raw":235,"../internals/is-object":289,"../internals/well-known-symbol":357}],292:[function(r,n,i){var s=r("../internals/get-built-in"),o=r("../internals/is-callable"),a=r("../internals/object-is-prototype-of"),l=r("../internals/use-symbol-as-uid"),c=Object;n.exports=l?function(u){return typeof u=="symbol"}:function(u){var h=s("Symbol");return o(h)&&a(h.prototype,c(u))}},{"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/object-is-prototype-of":314,"../internals/use-symbol-as-uid":351}],293:[function(r,n,i){var s=r("../internals/function-bind-context"),o=r("../internals/function-call"),a=r("../internals/an-object"),l=r("../internals/try-to-string"),c=r("../internals/is-array-iterator-method"),u=r("../internals/length-of-array-like"),h=r("../internals/object-is-prototype-of"),d=r("../internals/get-iterator"),f=r("../internals/get-iterator-method"),m=r("../internals/iterator-close"),v=TypeError,g=function(y,C){this.stopped=y,this.result=C},w=g.prototype;n.exports=function(y,C,k){var F,I,N,j,L,W,K,z=k&&k.that,M=!(!k||!k.AS_ENTRIES),B=!(!k||!k.IS_RECORD),R=!(!k||!k.IS_ITERATOR),S=!(!k||!k.INTERRUPTED),_=s(C,z),T=function(D){return F&&m(F,"normal",D),new g(!0,D)},E=function(D){return M?(a(D),S?_(D[0],D[1],T):_(D[0],D[1])):S?_(D,T):_(D)};if(B)F=y.iterator;else if(R)F=y;else{if(!(I=f(y)))throw new v(l(y)+" is not iterable");if(c(I)){for(N=0,j=u(y);j>N;N++)if((L=E(y[N]))&&h(w,L))return L;return new g(!1)}F=d(y,I)}for(W=B?y.next:F.next;!(K=o(W,F)).done;){try{L=E(K.value)}catch(D){m(F,"throw",D)}if(typeof L=="object"&&L&&h(w,L))return L}return new g(!1)}},{"../internals/an-object":227,"../internals/function-bind-context":262,"../internals/function-call":264,"../internals/get-iterator":271,"../internals/get-iterator-method":270,"../internals/is-array-iterator-method":283,"../internals/iterator-close":294,"../internals/length-of-array-like":299,"../internals/object-is-prototype-of":314,"../internals/try-to-string":349}],294:[function(r,n,i){var s=r("../internals/function-call"),o=r("../internals/an-object"),a=r("../internals/get-method");n.exports=function(l,c,u){var h,d;o(l);try{if(!(h=a(l,"return"))){if(c==="throw")throw u;return u}h=s(h,l)}catch(f){d=!0,h=f}if(c==="throw")throw u;if(d)throw h;return o(h),u}},{"../internals/an-object":227,"../internals/function-call":264,"../internals/get-method":273}],295:[function(r,n,i){var s=r("../internals/iterators-core").IteratorPrototype,o=r("../internals/object-create"),a=r("../internals/create-property-descriptor"),l=r("../internals/set-to-string-tag"),c=r("../internals/iterators"),u=function(){return this};n.exports=function(h,d,f,m){var v=d+" Iterator";return h.prototype=o(s,{next:a(+!m,f)}),l(h,v,!1,!0),c[v]=u,h}},{"../internals/create-property-descriptor":242,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-create":306,"../internals/set-to-string-tag":331}],296:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/function-call"),a=r("../internals/is-pure"),l=r("../internals/function-name"),c=r("../internals/is-callable"),u=r("../internals/iterator-create-constructor"),h=r("../internals/object-get-prototype-of"),d=r("../internals/object-set-prototype-of"),f=r("../internals/set-to-string-tag"),m=r("../internals/create-non-enumerable-property"),v=r("../internals/define-built-in"),g=r("../internals/well-known-symbol"),w=r("../internals/iterators"),y=r("../internals/iterators-core"),C=l.PROPER,k=l.CONFIGURABLE,F=y.IteratorPrototype,I=y.BUGGY_SAFARI_ITERATORS,N=g("iterator"),j=function(){return this};n.exports=function(L,W,K,z,M,B,R){u(K,W,z);var S,_,T,E=function(G){if(G===M&&X)return X;if(!I&&G&&G in P)return P[G];switch(G){case"keys":case"values":case"entries":return function(){return new K(this,G)}}return function(){return new K(this)}},D=W+" Iterator",O=!1,P=L.prototype,q=P[N]||P["@@iterator"]||M&&P[M],X=!I&&q||E(M),Q=W==="Array"&&P.entries||q;if(Q&&(S=h(Q.call(new L)))!==Object.prototype&&S.next&&(a||h(S)===F||(d?d(S,F):c(S[N])||v(S,N,j)),f(S,D,!0,!0),a&&(w[D]=j)),C&&M==="values"&&q&&q.name!=="values"&&(!a&&k?m(P,"name","values"):(O=!0,X=function(){return o(q,this)})),M)if(_={values:E("values"),keys:B?X:E("keys"),entries:E("entries")},R)for(T in _)(I||O||!(T in P))&&v(P,T,_[T]);else s({target:W,proto:!0,forced:I||O},_);return a&&!R||P[N]===X||v(P,N,X,{name:M}),w[W]=X,_}},{"../internals/create-non-enumerable-property":241,"../internals/define-built-in":245,"../internals/export":259,"../internals/function-call":264,"../internals/function-name":265,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/iterator-create-constructor":295,"../internals/iterators":298,"../internals/iterators-core":297,"../internals/object-get-prototype-of":313,"../internals/object-set-prototype-of":318,"../internals/set-to-string-tag":331,"../internals/well-known-symbol":357}],297:[function(r,n,i){var s,o,a,l=r("../internals/fails"),c=r("../internals/is-callable"),u=r("../internals/is-object"),h=r("../internals/object-create"),d=r("../internals/object-get-prototype-of"),f=r("../internals/define-built-in"),m=r("../internals/well-known-symbol"),v=r("../internals/is-pure"),g=m("iterator"),w=!1;[].keys&&("next"in(a=[].keys())?(o=d(d(a)))!==Object.prototype&&(s=o):w=!0),!u(s)||l((function(){var y={};return s[g].call(y)!==y}))?s={}:v&&(s=h(s)),c(s[g])||f(s,g,(function(){return this})),n.exports={IteratorPrototype:s,BUGGY_SAFARI_ITERATORS:w}},{"../internals/define-built-in":245,"../internals/fails":260,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-get-prototype-of":313,"../internals/well-known-symbol":357}],298:[function(r,n,i){arguments[4][276][0].apply(i,arguments)},{dup:276}],299:[function(r,n,i){var s=r("../internals/to-length");n.exports=function(o){return s(o.length)}},{"../internals/to-length":343}],300:[function(r,n,i){var s=r("../internals/function-uncurry-this"),o=r("../internals/fails"),a=r("../internals/is-callable"),l=r("../internals/has-own-property"),c=r("../internals/descriptors"),u=r("../internals/function-name").CONFIGURABLE,h=r("../internals/inspect-source"),d=r("../internals/internal-state"),f=d.enforce,m=d.get,v=String,g=Object.defineProperty,w=s("".slice),y=s("".replace),C=s([].join),k=c&&!o((function(){return g((function(){}),"length",{value:8}).length!==8})),F=String(String).split("String"),I=n.exports=function(N,j,L){w(v(j),0,7)==="Symbol("&&(j="["+y(v(j),/^Symbol\(([^)]*)\)/,"$1")+"]"),L&&L.getter&&(j="get "+j),L&&L.setter&&(j="set "+j),(!l(N,"name")||u&&N.name!==j)&&(c?g(N,"name",{value:j,configurable:!0}):N.name=j),k&&L&&l(L,"arity")&&N.length!==L.arity&&g(N,"length",{value:L.arity});try{L&&l(L,"constructor")&&L.constructor?c&&g(N,"prototype",{writable:!1}):N.prototype&&(N.prototype=void 0)}catch{}var W=f(N);return l(W,"source")||(W.source=C(F,typeof j=="string"?j:"")),N};Function.prototype.toString=I((function(){return a(this)&&m(this).source||h(this)}),"toString")},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-name":265,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/inspect-source":281,"../internals/internal-state":282,"../internals/is-callable":285}],301:[function(r,n,i){var s=Math.ceil,o=Math.floor;n.exports=Math.trunc||function(a){var l=+a;return(l>0?o:s)(l)}},{}],302:[function(r,n,i){var s,o,a,l,c,u=r("../internals/global"),h=r("../internals/function-bind-context"),d=r("../internals/object-get-own-property-descriptor").f,f=r("../internals/task").set,m=r("../internals/queue"),v=r("../internals/engine-is-ios"),g=r("../internals/engine-is-ios-pebble"),w=r("../internals/engine-is-webos-webkit"),y=r("../internals/engine-is-node"),C=u.MutationObserver||u.WebKitMutationObserver,k=u.document,F=u.process,I=u.Promise,N=d(u,"queueMicrotask"),j=N&&N.value;if(!j){var L=new m,W=function(){var K,z;for(y&&(K=F.domain)&&K.exit();z=L.get();)try{z()}catch(M){throw L.head&&s(),M}K&&K.enter()};v||y||w||!C||!k?!g&&I&&I.resolve?((l=I.resolve(void 0)).constructor=I,c=h(l.then,l),s=function(){c(W)}):y?s=function(){F.nextTick(W)}:(f=h(f,u),s=function(){f(W)}):(o=!0,a=k.createTextNode(""),new C(W).observe(a,{characterData:!0}),s=function(){a.data=o=!o}),j=function(K){L.head||s(),L.add(K)}}n.exports=j},{"../internals/engine-is-ios":253,"../internals/engine-is-ios-pebble":252,"../internals/engine-is-node":254,"../internals/engine-is-webos-webkit":255,"../internals/function-bind-context":262,"../internals/global":274,"../internals/object-get-own-property-descriptor":309,"../internals/queue":328,"../internals/task":339}],303:[function(r,n,i){var s=r("../internals/a-callable"),o=TypeError,a=function(l){var c,u;this.promise=new l((function(h,d){if(c!==void 0||u!==void 0)throw new o("Bad Promise constructor");c=h,u=d})),this.resolve=s(c),this.reject=s(u)};n.exports.f=function(l){return new a(l)}},{"../internals/a-callable":222}],304:[function(r,n,i){var s=r("../internals/is-regexp"),o=TypeError;n.exports=function(a){if(s(a))throw new o("The method doesn't accept regular expressions");return a}},{"../internals/is-regexp":291}],305:[function(r,n,i){var s=r("../internals/descriptors"),o=r("../internals/function-uncurry-this"),a=r("../internals/function-call"),l=r("../internals/fails"),c=r("../internals/object-keys"),u=r("../internals/object-get-own-property-symbols"),h=r("../internals/object-property-is-enumerable"),d=r("../internals/to-object"),f=r("../internals/indexed-object"),m=Object.assign,v=Object.defineProperty,g=o([].concat);n.exports=!m||l((function(){if(s&&m({b:1},m(v({},"a",{enumerable:!0,get:function(){v(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var w={},y={},C=Symbol("assign detection");return w[C]=7,"abcdefghijklmnopqrst".split("").forEach((function(k){y[k]=k})),m({},w)[C]!==7||c(m({},y)).join("")!=="abcdefghijklmnopqrst"}))?function(w,y){for(var C=d(w),k=arguments.length,F=1,I=u.f,N=h.f;k>F;)for(var j,L=f(arguments[F++]),W=I?g(c(L),I(L)):c(L),K=W.length,z=0;K>z;)j=W[z++],s&&!a(N,L,j)||(C[j]=L[j]);return C}:m},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/indexed-object":280,"../internals/object-get-own-property-symbols":312,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-object":344}],306:[function(r,n,i){var s,o=r("../internals/an-object"),a=r("../internals/object-define-properties"),l=r("../internals/enum-bug-keys"),c=r("../internals/hidden-keys"),u=r("../internals/html"),h=r("../internals/document-create-element"),d=r("../internals/shared-key"),f=d("IE_PROTO"),m=function(){},v=function(y){return"<script>"+y+"<\/script>"},g=function(y){y.write(v("")),y.close();var C=y.parentWindow.Object;return y=null,C},w=function(){try{s=new ActiveXObject("htmlfile")}catch{}var y,C;w=typeof document<"u"?document.domain&&s?g(s):((C=h("iframe")).style.display="none",u.appendChild(C),C.src="javascript:",(y=C.contentWindow.document).open(),y.write(v("document.F=Object")),y.close(),y.F):g(s);for(var k=l.length;k--;)delete w.prototype[l[k]];return w()};c[f]=!0,n.exports=Object.create||function(y,C){var k;return y!==null?(m.prototype=o(y),k=new m,m.prototype=null,k[f]=y):k=w(),C===void 0?k:a.f(k,C)}},{"../internals/an-object":227,"../internals/document-create-element":249,"../internals/enum-bug-keys":258,"../internals/hidden-keys":276,"../internals/html":278,"../internals/object-define-properties":307,"../internals/shared-key":332}],307:[function(r,n,i){var s=r("../internals/descriptors"),o=r("../internals/v8-prototype-define-bug"),a=r("../internals/object-define-property"),l=r("../internals/an-object"),c=r("../internals/to-indexed-object"),u=r("../internals/object-keys");i.f=s&&!o?Object.defineProperties:function(h,d){l(h);for(var f,m=c(d),v=u(d),g=v.length,w=0;g>w;)a.f(h,f=v[w++],m[f]);return h}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/object-define-property":308,"../internals/object-keys":316,"../internals/to-indexed-object":341,"../internals/v8-prototype-define-bug":352}],308:[function(r,n,i){var s=r("../internals/descriptors"),o=r("../internals/ie8-dom-define"),a=r("../internals/v8-prototype-define-bug"),l=r("../internals/an-object"),c=r("../internals/to-property-key"),u=TypeError,h=Object.defineProperty,d=Object.getOwnPropertyDescriptor;i.f=s?a?function(f,m,v){if(l(f),m=c(m),l(v),typeof f=="function"&&m==="prototype"&&"value"in v&&"writable"in v&&!v.writable){var g=d(f,m);g&&g.writable&&(f[m]=v.value,v={configurable:"configurable"in v?v.configurable:g.configurable,enumerable:"enumerable"in v?v.enumerable:g.enumerable,writable:!1})}return h(f,m,v)}:h:function(f,m,v){if(l(f),m=c(m),l(v),o)try{return h(f,m,v)}catch{}if("get"in v||"set"in v)throw new u("Accessors not supported");return"value"in v&&(f[m]=v.value),f}},{"../internals/an-object":227,"../internals/descriptors":247,"../internals/ie8-dom-define":279,"../internals/to-property-key":346,"../internals/v8-prototype-define-bug":352}],309:[function(r,n,i){var s=r("../internals/descriptors"),o=r("../internals/function-call"),a=r("../internals/object-property-is-enumerable"),l=r("../internals/create-property-descriptor"),c=r("../internals/to-indexed-object"),u=r("../internals/to-property-key"),h=r("../internals/has-own-property"),d=r("../internals/ie8-dom-define"),f=Object.getOwnPropertyDescriptor;i.f=s?f:function(m,v){if(m=c(m),v=u(v),d)try{return f(m,v)}catch{}if(h(m,v))return l(!o(a.f,m,v),m[v])}},{"../internals/create-property-descriptor":242,"../internals/descriptors":247,"../internals/function-call":264,"../internals/has-own-property":275,"../internals/ie8-dom-define":279,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341,"../internals/to-property-key":346}],310:[function(r,n,i){var s=r("../internals/classof-raw"),o=r("../internals/to-indexed-object"),a=r("../internals/object-get-own-property-names").f,l=r("../internals/array-slice-simple"),c=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];n.exports.f=function(u){return c&&s(u)==="Window"?(function(h){try{return a(h)}catch{return l(c)}})(u):a(o(u))}},{"../internals/array-slice-simple":230,"../internals/classof-raw":235,"../internals/object-get-own-property-names":311,"../internals/to-indexed-object":341}],311:[function(r,n,i){var s=r("../internals/object-keys-internal"),o=r("../internals/enum-bug-keys").concat("length","prototype");i.f=Object.getOwnPropertyNames||function(a){return s(a,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],312:[function(r,n,i){i.f=Object.getOwnPropertySymbols},{}],313:[function(r,n,i){var s=r("../internals/has-own-property"),o=r("../internals/is-callable"),a=r("../internals/to-object"),l=r("../internals/shared-key"),c=r("../internals/correct-prototype-getter"),u=l("IE_PROTO"),h=Object,d=h.prototype;n.exports=c?h.getPrototypeOf:function(f){var m=a(f);if(s(m,u))return m[u];var v=m.constructor;return o(v)&&m instanceof v?v.prototype:m instanceof h?d:null}},{"../internals/correct-prototype-getter":239,"../internals/has-own-property":275,"../internals/is-callable":285,"../internals/shared-key":332,"../internals/to-object":344}],314:[function(r,n,i){var s=r("../internals/function-uncurry-this");n.exports=s({}.isPrototypeOf)},{"../internals/function-uncurry-this":268}],315:[function(r,n,i){var s=r("../internals/function-uncurry-this"),o=r("../internals/has-own-property"),a=r("../internals/to-indexed-object"),l=r("../internals/array-includes").indexOf,c=r("../internals/hidden-keys"),u=s([].push);n.exports=function(h,d){var f,m=a(h),v=0,g=[];for(f in m)!o(c,f)&&o(m,f)&&u(g,f);for(;d.length>v;)o(m,f=d[v++])&&(~l(g,f)||u(g,f));return g}},{"../internals/array-includes":228,"../internals/function-uncurry-this":268,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/to-indexed-object":341}],316:[function(r,n,i){var s=r("../internals/object-keys-internal"),o=r("../internals/enum-bug-keys");n.exports=Object.keys||function(a){return s(a,o)}},{"../internals/enum-bug-keys":258,"../internals/object-keys-internal":315}],317:[function(r,n,i){var s={}.propertyIsEnumerable,o=Object.getOwnPropertyDescriptor,a=o&&!s.call({1:2},1);i.f=a?function(l){var c=o(this,l);return!!c&&c.enumerable}:s},{}],318:[function(r,n,i){var s=r("../internals/function-uncurry-this-accessor"),o=r("../internals/an-object"),a=r("../internals/a-possible-prototype");n.exports=Object.setPrototypeOf||("__proto__"in{}?(function(){var l,c=!1,u={};try{(l=s(Object.prototype,"__proto__","set"))(u,[]),c=u instanceof Array}catch{}return function(h,d){return o(h),a(d),c?l(h,d):h.__proto__=d,h}})():void 0)},{"../internals/a-possible-prototype":224,"../internals/an-object":227,"../internals/function-uncurry-this-accessor":266}],319:[function(r,n,i){var s=r("../internals/descriptors"),o=r("../internals/fails"),a=r("../internals/function-uncurry-this"),l=r("../internals/object-get-prototype-of"),c=r("../internals/object-keys"),u=r("../internals/to-indexed-object"),h=a(r("../internals/object-property-is-enumerable").f),d=a([].push),f=s&&o((function(){var v=Object.create(null);return v[2]=2,!h(v,2)})),m=function(v){return function(g){for(var w,y=u(g),C=c(y),k=f&&l(y)===null,F=C.length,I=0,N=[];F>I;)w=C[I++],s&&!(k?w in y:h(y,w))||d(N,v?[w,y[w]]:y[w]);return N}};n.exports={entries:m(!0),values:m(!1)}},{"../internals/descriptors":247,"../internals/fails":260,"../internals/function-uncurry-this":268,"../internals/object-get-prototype-of":313,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/to-indexed-object":341}],320:[function(r,n,i){var s=r("../internals/function-call"),o=r("../internals/is-callable"),a=r("../internals/is-object"),l=TypeError;n.exports=function(c,u){var h,d;if(u==="string"&&o(h=c.toString)&&!a(d=s(h,c))||o(h=c.valueOf)&&!a(d=s(h,c))||u!=="string"&&o(h=c.toString)&&!a(d=s(h,c)))return d;throw new l("Can't convert object to primitive value")}},{"../internals/function-call":264,"../internals/is-callable":285,"../internals/is-object":289}],321:[function(r,n,i){var s=r("../internals/get-built-in"),o=r("../internals/function-uncurry-this"),a=r("../internals/object-get-own-property-names"),l=r("../internals/object-get-own-property-symbols"),c=r("../internals/an-object"),u=o([].concat);n.exports=s("Reflect","ownKeys")||function(h){var d=a.f(c(h)),f=l.f;return f?u(d,f(h)):d}},{"../internals/an-object":227,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-symbols":312}],322:[function(r,n,i){var s=r("../internals/global");n.exports=s},{"../internals/global":274}],323:[function(r,n,i){n.exports=function(s){try{return{error:!1,value:s()}}catch(o){return{error:!0,value:o}}}},{}],324:[function(r,n,i){var s=r("../internals/global"),o=r("../internals/promise-native-constructor"),a=r("../internals/is-callable"),l=r("../internals/is-forced"),c=r("../internals/inspect-source"),u=r("../internals/well-known-symbol"),h=r("../internals/engine-is-browser"),d=r("../internals/engine-is-deno"),f=r("../internals/is-pure"),m=r("../internals/engine-v8-version"),v=o&&o.prototype,g=u("species"),w=!1,y=a(s.PromiseRejectionEvent),C=l("Promise",(function(){var k=c(o),F=k!==String(o);if(!F&&m===66||f&&(!v.catch||!v.finally))return!0;if(!m||m<51||!/native code/.test(k)){var I=new o((function(j){j(1)})),N=function(j){j((function(){}),(function(){}))};if((I.constructor={})[g]=N,!(w=I.then((function(){}))instanceof N))return!0}return!F&&(h||d)&&!y}));n.exports={CONSTRUCTOR:C,REJECTION_EVENT:y,SUBCLASSING:w}},{"../internals/engine-is-browser":250,"../internals/engine-is-deno":251,"../internals/engine-v8-version":257,"../internals/global":274,"../internals/inspect-source":281,"../internals/is-callable":285,"../internals/is-forced":287,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/well-known-symbol":357}],325:[function(r,n,i){var s=r("../internals/global");n.exports=s.Promise},{"../internals/global":274}],326:[function(r,n,i){var s=r("../internals/an-object"),o=r("../internals/is-object"),a=r("../internals/new-promise-capability");n.exports=function(l,c){if(s(l),o(c)&&c.constructor===l)return c;var u=a.f(l);return(0,u.resolve)(c),u.promise}},{"../internals/an-object":227,"../internals/is-object":289,"../internals/new-promise-capability":303}],327:[function(r,n,i){var s=r("../internals/promise-native-constructor"),o=r("../internals/check-correctness-of-iteration"),a=r("../internals/promise-constructor-detection").CONSTRUCTOR;n.exports=a||!o((function(l){s.all(l).then(void 0,(function(){}))}))},{"../internals/check-correctness-of-iteration":234,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],328:[function(r,n,i){var s=function(){this.head=null,this.tail=null};s.prototype={add:function(o){var a={item:o,next:null},l=this.tail;l?l.next=a:this.head=a,this.tail=a},get:function(){var o=this.head;if(o)return(this.head=o.next)===null&&(this.tail=null),o.item}},n.exports=s},{}],329:[function(r,n,i){var s=r("../internals/is-null-or-undefined"),o=TypeError;n.exports=function(a){if(s(a))throw new o("Can't call method on "+a);return a}},{"../internals/is-null-or-undefined":288}],330:[function(r,n,i){var s=r("../internals/get-built-in"),o=r("../internals/define-built-in-accessor"),a=r("../internals/well-known-symbol"),l=r("../internals/descriptors"),c=a("species");n.exports=function(u){var h=s(u);l&&h&&!h[c]&&o(h,c,{configurable:!0,get:function(){return this}})}},{"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],331:[function(r,n,i){var s=r("../internals/object-define-property").f,o=r("../internals/has-own-property"),a=r("../internals/well-known-symbol")("toStringTag");n.exports=function(l,c,u){l&&!u&&(l=l.prototype),l&&!o(l,a)&&s(l,a,{configurable:!0,value:c})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/well-known-symbol":357}],332:[function(r,n,i){var s=r("../internals/shared"),o=r("../internals/uid"),a=s("keys");n.exports=function(l){return a[l]||(a[l]=o(l))}},{"../internals/shared":334,"../internals/uid":350}],333:[function(r,n,i){var s=r("../internals/global"),o=r("../internals/define-global-property"),a=s["__core-js_shared__"]||o("__core-js_shared__",{});n.exports=a},{"../internals/define-global-property":246,"../internals/global":274}],334:[function(r,n,i){var s=r("../internals/is-pure"),o=r("../internals/shared-store");(n.exports=function(a,l){return o[a]||(o[a]=l!==void 0?l:{})})("versions",[]).push({version:"3.33.0",mode:s?"pure":"global",copyright:" 2014-2023 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.33.0/LICENSE",source:"https://github.com/zloirock/core-js"})},{"../internals/is-pure":290,"../internals/shared-store":333}],335:[function(r,n,i){var s=r("../internals/an-object"),o=r("../internals/a-constructor"),a=r("../internals/is-null-or-undefined"),l=r("../internals/well-known-symbol")("species");n.exports=function(c,u){var h,d=s(c).constructor;return d===void 0||a(h=s(d)[l])?u:o(h)}},{"../internals/a-constructor":223,"../internals/an-object":227,"../internals/is-null-or-undefined":288,"../internals/well-known-symbol":357}],336:[function(r,n,i){var s=r("../internals/engine-v8-version"),o=r("../internals/fails"),a=r("../internals/global").String;n.exports=!!Object.getOwnPropertySymbols&&!o((function(){var l=Symbol("symbol detection");return!a(l)||!(Object(l)instanceof Symbol)||!Symbol.sham&&s&&s<41}))},{"../internals/engine-v8-version":257,"../internals/fails":260,"../internals/global":274}],337:[function(r,n,i){var s=r("../internals/function-call"),o=r("../internals/get-built-in"),a=r("../internals/well-known-symbol"),l=r("../internals/define-built-in");n.exports=function(){var c=o("Symbol"),u=c&&c.prototype,h=u&&u.valueOf,d=a("toPrimitive");u&&!u[d]&&l(u,d,(function(f){return s(h,this)}),{arity:1})}},{"../internals/define-built-in":245,"../internals/function-call":264,"../internals/get-built-in":269,"../internals/well-known-symbol":357}],338:[function(r,n,i){var s=r("../internals/symbol-constructor-detection");n.exports=s&&!!Symbol.for&&!!Symbol.keyFor},{"../internals/symbol-constructor-detection":336}],339:[function(r,n,i){var s,o,a,l,c=r("../internals/global"),u=r("../internals/function-apply"),h=r("../internals/function-bind-context"),d=r("../internals/is-callable"),f=r("../internals/has-own-property"),m=r("../internals/fails"),v=r("../internals/html"),g=r("../internals/array-slice"),w=r("../internals/document-create-element"),y=r("../internals/validate-arguments-length"),C=r("../internals/engine-is-ios"),k=r("../internals/engine-is-node"),F=c.setImmediate,I=c.clearImmediate,N=c.process,j=c.Dispatch,L=c.Function,W=c.MessageChannel,K=c.String,z=0,M={};m((function(){s=c.location}));var B=function(T){if(f(M,T)){var E=M[T];delete M[T],E()}},R=function(T){return function(){B(T)}},S=function(T){B(T.data)},_=function(T){c.postMessage(K(T),s.protocol+"//"+s.host)};F&&I||(F=function(T){y(arguments.length,1);var E=d(T)?T:L(T),D=g(arguments,1);return M[++z]=function(){u(E,void 0,D)},o(z),z},I=function(T){delete M[T]},k?o=function(T){N.nextTick(R(T))}:j&&j.now?o=function(T){j.now(R(T))}:W&&!C?(l=(a=new W).port2,a.port1.onmessage=S,o=h(l.postMessage,l)):c.addEventListener&&d(c.postMessage)&&!c.importScripts&&s&&s.protocol!=="file:"&&!m(_)?(o=_,c.addEventListener("message",S,!1)):o="onreadystatechange"in w("script")?function(T){v.appendChild(w("script")).onreadystatechange=function(){v.removeChild(this),B(T)}}:function(T){setTimeout(R(T),0)}),n.exports={set:F,clear:I}},{"../internals/array-slice":231,"../internals/document-create-element":249,"../internals/engine-is-ios":253,"../internals/engine-is-node":254,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-bind-context":262,"../internals/global":274,"../internals/has-own-property":275,"../internals/html":278,"../internals/is-callable":285,"../internals/validate-arguments-length":353}],340:[function(r,n,i){var s=r("../internals/to-integer-or-infinity"),o=Math.max,a=Math.min;n.exports=function(l,c){var u=s(l);return u<0?o(u+c,0):a(u,c)}},{"../internals/to-integer-or-infinity":342}],341:[function(r,n,i){var s=r("../internals/indexed-object"),o=r("../internals/require-object-coercible");n.exports=function(a){return s(o(a))}},{"../internals/indexed-object":280,"../internals/require-object-coercible":329}],342:[function(r,n,i){var s=r("../internals/math-trunc");n.exports=function(o){var a=+o;return a!=a||a===0?0:s(a)}},{"../internals/math-trunc":301}],343:[function(r,n,i){var s=r("../internals/to-integer-or-infinity"),o=Math.min;n.exports=function(a){return a>0?o(s(a),9007199254740991):0}},{"../internals/to-integer-or-infinity":342}],344:[function(r,n,i){var s=r("../internals/require-object-coercible"),o=Object;n.exports=function(a){return o(s(a))}},{"../internals/require-object-coercible":329}],345:[function(r,n,i){var s=r("../internals/function-call"),o=r("../internals/is-object"),a=r("../internals/is-symbol"),l=r("../internals/get-method"),c=r("../internals/ordinary-to-primitive"),u=r("../internals/well-known-symbol"),h=TypeError,d=u("toPrimitive");n.exports=function(f,m){if(!o(f)||a(f))return f;var v,g=l(f,d);if(g){if(m===void 0&&(m="default"),v=s(g,f,m),!o(v)||a(v))return v;throw new h("Can't convert object to primitive value")}return m===void 0&&(m="number"),c(f,m)}},{"../internals/function-call":264,"../internals/get-method":273,"../internals/is-object":289,"../internals/is-symbol":292,"../internals/ordinary-to-primitive":320,"../internals/well-known-symbol":357}],346:[function(r,n,i){var s=r("../internals/to-primitive"),o=r("../internals/is-symbol");n.exports=function(a){var l=s(a,"string");return o(l)?l:l+""}},{"../internals/is-symbol":292,"../internals/to-primitive":345}],347:[function(r,n,i){var s={};s[r("../internals/well-known-symbol")("toStringTag")]="z",n.exports=String(s)==="[object z]"},{"../internals/well-known-symbol":357}],348:[function(r,n,i){var s=r("../internals/classof"),o=String;n.exports=function(a){if(s(a)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return o(a)}},{"../internals/classof":236}],349:[function(r,n,i){var s=String;n.exports=function(o){try{return s(o)}catch{return"Object"}}},{}],350:[function(r,n,i){var s=r("../internals/function-uncurry-this"),o=0,a=Math.random(),l=s(1 .toString);n.exports=function(c){return"Symbol("+(c===void 0?"":c)+")_"+l(++o+a,36)}},{"../internals/function-uncurry-this":268}],351:[function(r,n,i){var s=r("../internals/symbol-constructor-detection");n.exports=s&&!Symbol.sham&&typeof Symbol.iterator=="symbol"},{"../internals/symbol-constructor-detection":336}],352:[function(r,n,i){var s=r("../internals/descriptors"),o=r("../internals/fails");n.exports=s&&o((function(){return Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype!==42}))},{"../internals/descriptors":247,"../internals/fails":260}],353:[function(r,n,i){var s=TypeError;n.exports=function(o,a){if(o<a)throw new s("Not enough arguments");return o}},{}],354:[function(r,n,i){var s=r("../internals/global"),o=r("../internals/is-callable"),a=s.WeakMap;n.exports=o(a)&&/native code/.test(String(a))},{"../internals/global":274,"../internals/is-callable":285}],355:[function(r,n,i){var s=r("../internals/path"),o=r("../internals/has-own-property"),a=r("../internals/well-known-symbol-wrapped"),l=r("../internals/object-define-property").f;n.exports=function(c){var u=s.Symbol||(s.Symbol={});o(u,c)||l(u,c,{value:a.f(c)})}},{"../internals/has-own-property":275,"../internals/object-define-property":308,"../internals/path":322,"../internals/well-known-symbol-wrapped":356}],356:[function(r,n,i){var s=r("../internals/well-known-symbol");i.f=s},{"../internals/well-known-symbol":357}],357:[function(r,n,i){var s=r("../internals/global"),o=r("../internals/shared"),a=r("../internals/has-own-property"),l=r("../internals/uid"),c=r("../internals/symbol-constructor-detection"),u=r("../internals/use-symbol-as-uid"),h=s.Symbol,d=o("wks"),f=u?h.for||h:h&&h.withoutSetter||l;n.exports=function(m){return a(d,m)||(d[m]=c&&a(h,m)?h[m]:f("Symbol."+m)),d[m]}},{"../internals/global":274,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-constructor-detection":336,"../internals/uid":350,"../internals/use-symbol-as-uid":351}],358:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/array-iteration").findIndex,a=r("../internals/add-to-unscopables"),l=!0;"findIndex"in[]&&Array(1).findIndex((function(){l=!1})),s({target:"Array",proto:!0,forced:l},{findIndex:function(c){return o(this,c,arguments.length>1?arguments[1]:void 0)}}),a("findIndex")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],359:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/array-iteration").find,a=r("../internals/add-to-unscopables"),l=!0;"find"in[]&&Array(1).find((function(){l=!1})),s({target:"Array",proto:!0,forced:l},{find:function(c){return o(this,c,arguments.length>1?arguments[1]:void 0)}}),a("find")},{"../internals/add-to-unscopables":225,"../internals/array-iteration":229,"../internals/export":259}],360:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/array-includes").includes,a=r("../internals/fails"),l=r("../internals/add-to-unscopables");s({target:"Array",proto:!0,forced:a((function(){return!Array(1).includes()}))},{includes:function(c){return o(this,c,arguments.length>1?arguments[1]:void 0)}}),l("includes")},{"../internals/add-to-unscopables":225,"../internals/array-includes":228,"../internals/export":259,"../internals/fails":260}],361:[function(r,n,i){var s=r("../internals/to-indexed-object"),o=r("../internals/add-to-unscopables"),a=r("../internals/iterators"),l=r("../internals/internal-state"),c=r("../internals/object-define-property").f,u=r("../internals/iterator-define"),h=r("../internals/create-iter-result-object"),d=r("../internals/is-pure"),f=r("../internals/descriptors"),m=l.set,v=l.getterFor("Array Iterator");n.exports=u(Array,"Array",(function(w,y){m(this,{type:"Array Iterator",target:s(w),index:0,kind:y})}),(function(){var w=v(this),y=w.target,C=w.kind,k=w.index++;if(!y||k>=y.length)return w.target=void 0,h(void 0,!0);switch(C){case"keys":return h(k,!1);case"values":return h(y[k],!1)}return h([k,y[k]],!1)}),"values");var g=a.Arguments=a.Array;if(o("keys"),o("values"),o("entries"),!d&&f&&g.name!=="values")try{c(g,"name",{value:"values"})}catch{}},{"../internals/add-to-unscopables":225,"../internals/create-iter-result-object":240,"../internals/descriptors":247,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/iterator-define":296,"../internals/iterators":298,"../internals/object-define-property":308,"../internals/to-indexed-object":341}],362:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/get-built-in"),a=r("../internals/function-apply"),l=r("../internals/function-call"),c=r("../internals/function-uncurry-this"),u=r("../internals/fails"),h=r("../internals/is-callable"),d=r("../internals/is-symbol"),f=r("../internals/array-slice"),m=r("../internals/get-json-replacer-function"),v=r("../internals/symbol-constructor-detection"),g=String,w=o("JSON","stringify"),y=c(/./.exec),C=c("".charAt),k=c("".charCodeAt),F=c("".replace),I=c(1 .toString),N=/[\uD800-\uDFFF]/g,j=/^[\uD800-\uDBFF]$/,L=/^[\uDC00-\uDFFF]$/,W=!v||u((function(){var B=o("Symbol")("stringify detection");return w([B])!=="[null]"||w({a:B})!=="{}"||w(Object(B))!=="{}"})),K=u((function(){return w("\uDF06\uD834")!=='"\\udf06\\ud834"'||w("\uDEAD")!=='"\\udead"'})),z=function(B,R){var S=f(arguments),_=m(R);if(h(_)||B!==void 0&&!d(B))return S[1]=function(T,E){if(h(_)&&(E=l(_,this,g(T),E)),!d(E))return E},a(w,null,S)},M=function(B,R,S){var _=C(S,R-1),T=C(S,R+1);return y(j,B)&&!y(L,T)||y(L,B)&&!y(j,_)?"\\u"+I(k(B,0),16):B};w&&s({target:"JSON",stat:!0,arity:3,forced:W||K},{stringify:function(B,R,S){var _=f(arguments),T=a(W?z:w,null,_);return K&&typeof T=="string"?F(T,N,M):T}})},{"../internals/array-slice":231,"../internals/export":259,"../internals/fails":260,"../internals/function-apply":261,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/get-built-in":269,"../internals/get-json-replacer-function":272,"../internals/is-callable":285,"../internals/is-symbol":292,"../internals/symbol-constructor-detection":336}],363:[function(r,n,i){r("../internals/export")({target:"Number",stat:!0},{isNaN:function(s){return s!=s}})},{"../internals/export":259}],364:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/object-assign");s({target:"Object",stat:!0,arity:2,forced:Object.assign!==o},{assign:o})},{"../internals/export":259,"../internals/object-assign":305}],365:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/symbol-constructor-detection"),a=r("../internals/fails"),l=r("../internals/object-get-own-property-symbols"),c=r("../internals/to-object");s({target:"Object",stat:!0,forced:!o||a((function(){l.f(1)}))},{getOwnPropertySymbols:function(u){var h=l.f;return h?h(c(u)):[]}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-get-own-property-symbols":312,"../internals/symbol-constructor-detection":336,"../internals/to-object":344}],366:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/to-object"),a=r("../internals/object-keys");s({target:"Object",stat:!0,forced:r("../internals/fails")((function(){a(1)}))},{keys:function(l){return a(o(l))}})},{"../internals/export":259,"../internals/fails":260,"../internals/object-keys":316,"../internals/to-object":344}],367:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/object-to-array").values;s({target:"Object",stat:!0},{values:function(a){return o(a)}})},{"../internals/export":259,"../internals/object-to-array":319}],368:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/function-call"),a=r("../internals/a-callable"),l=r("../internals/new-promise-capability"),c=r("../internals/perform"),u=r("../internals/iterate");s({target:"Promise",stat:!0,forced:r("../internals/promise-statics-incorrect-iteration")},{all:function(h){var d=this,f=l.f(d),m=f.resolve,v=f.reject,g=c((function(){var w=a(d.resolve),y=[],C=0,k=1;u(h,(function(F){var I=C++,N=!1;k++,o(w,d,F).then((function(j){N||(N=!0,y[I]=j,--k||m(y))}),v)})),--k||m(y)}));return g.error&&v(g.value),f.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],369:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/is-pure"),a=r("../internals/promise-constructor-detection").CONSTRUCTOR,l=r("../internals/promise-native-constructor"),c=r("../internals/get-built-in"),u=r("../internals/is-callable"),h=r("../internals/define-built-in"),d=l&&l.prototype;if(s({target:"Promise",proto:!0,forced:a,real:!0},{catch:function(m){return this.then(void 0,m)}}),!o&&u(l)){var f=c("Promise").prototype.catch;d.catch!==f&&h(d,"catch",f,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325}],370:[function(r,n,i){var s,o,a,l=r("../internals/export"),c=r("../internals/is-pure"),u=r("../internals/engine-is-node"),h=r("../internals/global"),d=r("../internals/function-call"),f=r("../internals/define-built-in"),m=r("../internals/object-set-prototype-of"),v=r("../internals/set-to-string-tag"),g=r("../internals/set-species"),w=r("../internals/a-callable"),y=r("../internals/is-callable"),C=r("../internals/is-object"),k=r("../internals/an-instance"),F=r("../internals/species-constructor"),I=r("../internals/task").set,N=r("../internals/microtask"),j=r("../internals/host-report-errors"),L=r("../internals/perform"),W=r("../internals/queue"),K=r("../internals/internal-state"),z=r("../internals/promise-native-constructor"),M=r("../internals/promise-constructor-detection"),B=r("../internals/new-promise-capability"),R=M.CONSTRUCTOR,S=M.REJECTION_EVENT,_=M.SUBCLASSING,T=K.getterFor("Promise"),E=K.set,D=z&&z.prototype,O=z,P=D,q=h.TypeError,X=h.document,Q=h.process,G=B.f,ee=G,V=!!(X&&X.createEvent&&h.dispatchEvent),H=function(ve){var Te;return!(!C(ve)||!y(Te=ve.then))&&Te},Z=function(ve,Te){var xe,Fe,Ge,Ve=Te.value,Ye=Te.state===1,ut=Ye?ve.ok:ve.fail,ht=ve.resolve,be=ve.reject,ze=ve.domain;try{ut?(Ye||(Te.rejection===2&&Ce(Te),Te.rejection=1),ut===!0?xe=Ve:(ze&&ze.enter(),xe=ut(Ve),ze&&(ze.exit(),Ge=!0)),xe===ve.promise?be(new q("Promise-chain cycle")):(Fe=H(xe))?d(Fe,xe,ht,be):ht(xe)):be(Ve)}catch(we){ze&&!Ge&&ze.exit(),be(we)}},ie=function(ve,Te){ve.notified||(ve.notified=!0,N((function(){for(var xe,Fe=ve.reactions;xe=Fe.get();)Z(xe,ve);ve.notified=!1,Te&&!ve.rejection&&oe(ve)})))},te=function(ve,Te,xe){var Fe,Ge;V?((Fe=X.createEvent("Event")).promise=Te,Fe.reason=xe,Fe.initEvent(ve,!1,!0),h.dispatchEvent(Fe)):Fe={promise:Te,reason:xe},!S&&(Ge=h["on"+ve])?Ge(Fe):ve==="unhandledrejection"&&j("Unhandled promise rejection",xe)},oe=function(ve){d(I,h,(function(){var Te,xe=ve.facade,Fe=ve.value;if(ue(ve)&&(Te=L((function(){u?Q.emit("unhandledRejection",Fe,xe):te("unhandledrejection",xe,Fe)})),ve.rejection=u||ue(ve)?2:1,Te.error))throw Te.value}))},ue=function(ve){return ve.rejection!==1&&!ve.parent},Ce=function(ve){d(I,h,(function(){var Te=ve.facade;u?Q.emit("rejectionHandled",Te):te("rejectionhandled",Te,ve.value)}))},ye=function(ve,Te,xe){return function(Fe){ve(Te,Fe,xe)}},ne=function(ve,Te,xe){ve.done||(ve.done=!0,xe&&(ve=xe),ve.value=Te,ve.state=2,ie(ve,!0))},me=function(ve,Te,xe){if(!ve.done){ve.done=!0,xe&&(ve=xe);try{if(ve.facade===Te)throw new q("Promise can't be resolved itself");var Fe=H(Te);Fe?N((function(){var Ge={done:!1};try{d(Fe,Te,ye(me,Ge,ve),ye(ne,Ge,ve))}catch(Ve){ne(Ge,Ve,ve)}})):(ve.value=Te,ve.state=1,ie(ve,!1))}catch(Ge){ne({done:!1},Ge,ve)}}};if(R&&(P=(O=function(ve){k(this,P),w(ve),d(s,this);var Te=T(this);try{ve(ye(me,Te),ye(ne,Te))}catch(xe){ne(Te,xe)}}).prototype,(s=function(ve){E(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:new W,rejection:!1,state:0,value:void 0})}).prototype=f(P,"then",(function(ve,Te){var xe=T(this),Fe=G(F(this,O));return xe.parent=!0,Fe.ok=!y(ve)||ve,Fe.fail=y(Te)&&Te,Fe.domain=u?Q.domain:void 0,xe.state===0?xe.reactions.add(Fe):N((function(){Z(Fe,xe)})),Fe.promise})),o=function(){var ve=new s,Te=T(ve);this.promise=ve,this.resolve=ye(me,Te),this.reject=ye(ne,Te)},B.f=G=function(ve){return ve===O||ve===void 0?new o(ve):ee(ve)},!c&&y(z)&&D!==Object.prototype)){a=D.then,_||f(D,"then",(function(ve,Te){var xe=this;return new O((function(Fe,Ge){d(a,xe,Fe,Ge)})).then(ve,Te)}),{unsafe:!0});try{delete D.constructor}catch{}m&&m(D,P)}l({global:!0,constructor:!0,wrap:!0,forced:R},{Promise:O}),v(O,"Promise",!1,!0),g("Promise")},{"../internals/a-callable":222,"../internals/an-instance":226,"../internals/define-built-in":245,"../internals/engine-is-node":254,"../internals/export":259,"../internals/function-call":264,"../internals/global":274,"../internals/host-report-errors":277,"../internals/internal-state":282,"../internals/is-callable":285,"../internals/is-object":289,"../internals/is-pure":290,"../internals/microtask":302,"../internals/new-promise-capability":303,"../internals/object-set-prototype-of":318,"../internals/perform":323,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/queue":328,"../internals/set-species":330,"../internals/set-to-string-tag":331,"../internals/species-constructor":335,"../internals/task":339}],371:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/is-pure"),a=r("../internals/promise-native-constructor"),l=r("../internals/fails"),c=r("../internals/get-built-in"),u=r("../internals/is-callable"),h=r("../internals/species-constructor"),d=r("../internals/promise-resolve"),f=r("../internals/define-built-in"),m=a&&a.prototype;if(s({target:"Promise",proto:!0,real:!0,forced:!!a&&l((function(){m.finally.call({then:function(){}},(function(){}))}))},{finally:function(g){var w=h(this,c("Promise")),y=u(g);return this.then(y?function(C){return d(w,g()).then((function(){return C}))}:g,y?function(C){return d(w,g()).then((function(){throw C}))}:g)}}),!o&&u(a)){var v=c("Promise").prototype.finally;m.finally!==v&&f(m,"finally",v,{unsafe:!0})}},{"../internals/define-built-in":245,"../internals/export":259,"../internals/fails":260,"../internals/get-built-in":269,"../internals/is-callable":285,"../internals/is-pure":290,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326,"../internals/species-constructor":335}],372:[function(r,n,i){r("../modules/es.promise.constructor"),r("../modules/es.promise.all"),r("../modules/es.promise.catch"),r("../modules/es.promise.race"),r("../modules/es.promise.reject"),r("../modules/es.promise.resolve")},{"../modules/es.promise.all":368,"../modules/es.promise.catch":369,"../modules/es.promise.constructor":370,"../modules/es.promise.race":373,"../modules/es.promise.reject":374,"../modules/es.promise.resolve":375}],373:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/function-call"),a=r("../internals/a-callable"),l=r("../internals/new-promise-capability"),c=r("../internals/perform"),u=r("../internals/iterate");s({target:"Promise",stat:!0,forced:r("../internals/promise-statics-incorrect-iteration")},{race:function(h){var d=this,f=l.f(d),m=f.reject,v=c((function(){var g=a(d.resolve);u(h,(function(w){o(g,d,w).then(f.resolve,m)}))}));return v.error&&m(v.value),f.promise}})},{"../internals/a-callable":222,"../internals/export":259,"../internals/function-call":264,"../internals/iterate":293,"../internals/new-promise-capability":303,"../internals/perform":323,"../internals/promise-statics-incorrect-iteration":327}],374:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/function-call"),a=r("../internals/new-promise-capability");s({target:"Promise",stat:!0,forced:r("../internals/promise-constructor-detection").CONSTRUCTOR},{reject:function(l){var c=a.f(this);return o(c.reject,void 0,l),c.promise}})},{"../internals/export":259,"../internals/function-call":264,"../internals/new-promise-capability":303,"../internals/promise-constructor-detection":324}],375:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/get-built-in"),a=r("../internals/is-pure"),l=r("../internals/promise-native-constructor"),c=r("../internals/promise-constructor-detection").CONSTRUCTOR,u=r("../internals/promise-resolve"),h=o("Promise"),d=a&&!c;s({target:"Promise",stat:!0,forced:a||c},{resolve:function(f){return u(d&&this===h?l:this,f)}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/is-pure":290,"../internals/promise-constructor-detection":324,"../internals/promise-native-constructor":325,"../internals/promise-resolve":326}],376:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/function-uncurry-this"),a=r("../internals/to-absolute-index"),l=RangeError,c=String.fromCharCode,u=String.fromCodePoint,h=o([].join);s({target:"String",stat:!0,arity:1,forced:!!u&&u.length!==1},{fromCodePoint:function(d){for(var f,m=[],v=arguments.length,g=0;v>g;){if(f=+arguments[g++],a(f,1114111)!==f)throw new l(f+" is not a valid code point");m[g]=f<65536?c(f):c(55296+((f-=65536)>>10),f%1024+56320)}return h(m,"")}})},{"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/to-absolute-index":340}],377:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/function-uncurry-this"),a=r("../internals/not-a-regexp"),l=r("../internals/require-object-coercible"),c=r("../internals/to-string"),u=r("../internals/correct-is-regexp-logic"),h=o("".indexOf);s({target:"String",proto:!0,forced:!u("includes")},{includes:function(d){return!!~h(c(l(this)),c(a(d)),arguments.length>1?arguments[1]:void 0)}})},{"../internals/correct-is-regexp-logic":238,"../internals/export":259,"../internals/function-uncurry-this":268,"../internals/not-a-regexp":304,"../internals/require-object-coercible":329,"../internals/to-string":348}],378:[function(r,n,i){r("../internals/well-known-symbol-define")("asyncIterator")},{"../internals/well-known-symbol-define":355}],379:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/global"),a=r("../internals/function-call"),l=r("../internals/function-uncurry-this"),c=r("../internals/is-pure"),u=r("../internals/descriptors"),h=r("../internals/symbol-constructor-detection"),d=r("../internals/fails"),f=r("../internals/has-own-property"),m=r("../internals/object-is-prototype-of"),v=r("../internals/an-object"),g=r("../internals/to-indexed-object"),w=r("../internals/to-property-key"),y=r("../internals/to-string"),C=r("../internals/create-property-descriptor"),k=r("../internals/object-create"),F=r("../internals/object-keys"),I=r("../internals/object-get-own-property-names"),N=r("../internals/object-get-own-property-names-external"),j=r("../internals/object-get-own-property-symbols"),L=r("../internals/object-get-own-property-descriptor"),W=r("../internals/object-define-property"),K=r("../internals/object-define-properties"),z=r("../internals/object-property-is-enumerable"),M=r("../internals/define-built-in"),B=r("../internals/define-built-in-accessor"),R=r("../internals/shared"),S=r("../internals/shared-key"),_=r("../internals/hidden-keys"),T=r("../internals/uid"),E=r("../internals/well-known-symbol"),D=r("../internals/well-known-symbol-wrapped"),O=r("../internals/well-known-symbol-define"),P=r("../internals/symbol-define-to-primitive"),q=r("../internals/set-to-string-tag"),X=r("../internals/internal-state"),Q=r("../internals/array-iteration").forEach,G=S("hidden"),ee=X.set,V=X.getterFor("Symbol"),H=Object.prototype,Z=o.Symbol,ie=Z&&Z.prototype,te=o.RangeError,oe=o.TypeError,ue=o.QObject,Ce=L.f,ye=W.f,ne=N.f,me=z.f,ve=l([].push),Te=R("symbols"),xe=R("op-symbols"),Fe=R("wks"),Ge=!ue||!ue.prototype||!ue.prototype.findChild,Ve=function(Pe,De,Ze){var pt=Ce(H,De);pt&&delete H[De],ye(Pe,De,Ze),pt&&Pe!==H&&ye(H,De,pt)},Ye=u&&d((function(){return k(ye({},"a",{get:function(){return ye(this,"a",{value:7}).a}})).a!==7}))?Ve:ye,ut=function(Pe,De){var Ze=Te[Pe]=k(ie);return ee(Ze,{type:"Symbol",tag:Pe,description:De}),u||(Ze.description=De),Ze},ht=function(Pe,De,Ze){Pe===H&&ht(xe,De,Ze),v(Pe);var pt=w(De);return v(Ze),f(Te,pt)?(Ze.enumerable?(f(Pe,G)&&Pe[G][pt]&&(Pe[G][pt]=!1),Ze=k(Ze,{enumerable:C(0,!1)})):(f(Pe,G)||ye(Pe,G,C(1,{})),Pe[G][pt]=!0),Ye(Pe,pt,Ze)):ye(Pe,pt,Ze)},be=function(Pe,De){v(Pe);var Ze=g(De),pt=F(Ze).concat(Ie(Ze));return Q(pt,(function(yt){u&&!a(ze,Ze,yt)||ht(Pe,yt,Ze[yt])})),Pe},ze=function(Pe){var De=w(Pe),Ze=a(me,this,De);return!(this===H&&f(Te,De)&&!f(xe,De))&&(!(Ze||!f(this,De)||!f(Te,De)||f(this,G)&&this[G][De])||Ze)},we=function(Pe,De){var Ze=g(Pe),pt=w(De);if(Ze!==H||!f(Te,pt)||f(xe,pt)){var yt=Ce(Ze,pt);return!yt||!f(Te,pt)||f(Ze,G)&&Ze[G][pt]||(yt.enumerable=!0),yt}},Ee=function(Pe){var De=ne(g(Pe)),Ze=[];return Q(De,(function(pt){f(Te,pt)||f(_,pt)||ve(Ze,pt)})),Ze},Ie=function(Pe){var De=Pe===H,Ze=ne(De?xe:g(Pe)),pt=[];return Q(Ze,(function(yt){!f(Te,yt)||De&&!f(H,yt)||ve(pt,Te[yt])})),pt};h||(M(ie=(Z=function(){if(m(ie,this))throw new oe("Symbol is not a constructor");var Pe=arguments.length&&arguments[0]!==void 0?y(arguments[0]):void 0,De=T(Pe),Ze=function(pt){this===H&&a(Ze,xe,pt),f(this,G)&&f(this[G],De)&&(this[G][De]=!1);var yt=C(1,pt);try{Ye(this,De,yt)}catch(Pt){if(!(Pt instanceof te))throw Pt;Ve(this,De,yt)}};return u&&Ge&&Ye(H,De,{configurable:!0,set:Ze}),ut(De,Pe)}).prototype,"toString",(function(){return V(this).tag})),M(Z,"withoutSetter",(function(Pe){return ut(T(Pe),Pe)})),z.f=ze,W.f=ht,K.f=be,L.f=we,I.f=N.f=Ee,j.f=Ie,D.f=function(Pe){return ut(E(Pe),Pe)},u&&(B(ie,"description",{configurable:!0,get:function(){return V(this).description}}),c||M(H,"propertyIsEnumerable",ze,{unsafe:!0}))),s({global:!0,constructor:!0,wrap:!0,forced:!h,sham:!h},{Symbol:Z}),Q(F(Fe),(function(Pe){O(Pe)})),s({target:"Symbol",stat:!0,forced:!h},{useSetter:function(){Ge=!0},useSimple:function(){Ge=!1}}),s({target:"Object",stat:!0,forced:!h,sham:!u},{create:function(Pe,De){return De===void 0?k(Pe):be(k(Pe),De)},defineProperty:ht,defineProperties:be,getOwnPropertyDescriptor:we}),s({target:"Object",stat:!0,forced:!h},{getOwnPropertyNames:Ee}),P(),q(Z,"Symbol"),_[G]=!0},{"../internals/an-object":227,"../internals/array-iteration":229,"../internals/create-property-descriptor":242,"../internals/define-built-in":245,"../internals/define-built-in-accessor":244,"../internals/descriptors":247,"../internals/export":259,"../internals/fails":260,"../internals/function-call":264,"../internals/function-uncurry-this":268,"../internals/global":274,"../internals/has-own-property":275,"../internals/hidden-keys":276,"../internals/internal-state":282,"../internals/is-pure":290,"../internals/object-create":306,"../internals/object-define-properties":307,"../internals/object-define-property":308,"../internals/object-get-own-property-descriptor":309,"../internals/object-get-own-property-names":311,"../internals/object-get-own-property-names-external":310,"../internals/object-get-own-property-symbols":312,"../internals/object-is-prototype-of":314,"../internals/object-keys":316,"../internals/object-property-is-enumerable":317,"../internals/set-to-string-tag":331,"../internals/shared":334,"../internals/shared-key":332,"../internals/symbol-constructor-detection":336,"../internals/symbol-define-to-primitive":337,"../internals/to-indexed-object":341,"../internals/to-property-key":346,"../internals/to-string":348,"../internals/uid":350,"../internals/well-known-symbol":357,"../internals/well-known-symbol-define":355,"../internals/well-known-symbol-wrapped":356}],380:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/get-built-in"),a=r("../internals/has-own-property"),l=r("../internals/to-string"),c=r("../internals/shared"),u=r("../internals/symbol-registry-detection"),h=c("string-to-symbol-registry"),d=c("symbol-to-string-registry");s({target:"Symbol",stat:!0,forced:!u},{for:function(f){var m=l(f);if(a(h,m))return h[m];var v=o("Symbol")(m);return h[m]=v,d[v]=m,v}})},{"../internals/export":259,"../internals/get-built-in":269,"../internals/has-own-property":275,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/to-string":348}],381:[function(r,n,i){r("../modules/es.symbol.constructor"),r("../modules/es.symbol.for"),r("../modules/es.symbol.key-for"),r("../modules/es.json.stringify"),r("../modules/es.object.get-own-property-symbols")},{"../modules/es.json.stringify":362,"../modules/es.object.get-own-property-symbols":365,"../modules/es.symbol.constructor":379,"../modules/es.symbol.for":380,"../modules/es.symbol.key-for":382}],382:[function(r,n,i){var s=r("../internals/export"),o=r("../internals/has-own-property"),a=r("../internals/is-symbol"),l=r("../internals/try-to-string"),c=r("../internals/shared"),u=r("../internals/symbol-registry-detection"),h=c("symbol-to-string-registry");s({target:"Symbol",stat:!0,forced:!u},{keyFor:function(d){if(!a(d))throw new TypeError(l(d)+" is not a symbol");if(o(h,d))return h[d]}})},{"../internals/export":259,"../internals/has-own-property":275,"../internals/is-symbol":292,"../internals/shared":334,"../internals/symbol-registry-detection":338,"../internals/try-to-string":349}],383:[function(r,n,i){function s(o){return Object.prototype.toString.call(o)}i.isArray=function(o){return Array.isArray?Array.isArray(o):s(o)==="[object Array]"},i.isBoolean=function(o){return typeof o=="boolean"},i.isNull=function(o){return o===null},i.isNullOrUndefined=function(o){return o==null},i.isNumber=function(o){return typeof o=="number"},i.isString=function(o){return typeof o=="string"},i.isSymbol=function(o){return typeof o=="symbol"},i.isUndefined=function(o){return o===void 0},i.isRegExp=function(o){return s(o)==="[object RegExp]"},i.isObject=function(o){return typeof o=="object"&&o!==null},i.isDate=function(o){return s(o)==="[object Date]"},i.isError=function(o){return s(o)==="[object Error]"||o instanceof Error},i.isFunction=function(o){return typeof o=="function"},i.isPrimitive=function(o){return o===null||typeof o=="boolean"||typeof o=="number"||typeof o=="string"||typeof o=="symbol"||o===void 0},i.isBuffer=r("buffer").Buffer.isBuffer},{buffer:220}],384:[function(r,n,i){(function(s){(function(){var o=r("elliptic"),a=r("bn.js");n.exports=function(h){return new c(h)};var l={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function c(h){this.curveType=l[h],this.curveType||(this.curveType={name:h}),this.curve=new o.ec(this.curveType.name),this.keys=void 0}function u(h,d,f){Array.isArray(h)||(h=h.toArray());var m=new s(h);if(f&&m.length<f){var v=new s(f-m.length);v.fill(0),m=s.concat([v,m])}return d?m.toString(d):m}l.p224=l.secp224r1,l.p256=l.secp256r1=l.prime256v1,l.p192=l.secp192r1=l.prime192v1,l.p384=l.secp384r1,l.p521=l.secp521r1,c.prototype.generateKeys=function(h,d){return this.keys=this.curve.genKeyPair(),this.getPublicKey(h,d)},c.prototype.computeSecret=function(h,d,f){return d=d||"utf8",s.isBuffer(h)||(h=new s(h,d)),u(this.curve.keyFromPublic(h).getPublic().mul(this.keys.getPrivate()).getX(),f,this.curveType.byteLength)},c.prototype.getPublicKey=function(h,d){var f=this.keys.getPublic(d==="compressed",!0);return d==="hybrid"&&(f[f.length-1]%2?f[0]=7:f[0]=6),u(f,h)},c.prototype.getPrivateKey=function(h){return u(this.keys.getPrivate(),h)},c.prototype.setPublicKey=function(h,d){return d=d||"utf8",s.isBuffer(h)||(h=new s(h,d)),this.keys._importPublic(h),this},c.prototype.setPrivateKey=function(h,d){d=d||"utf8",s.isBuffer(h)||(h=new s(h,d));var f=new a(h);return f=f.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(f),this}}).call(this)}).call(this,r("buffer").Buffer)},{"bn.js":385,buffer:220,elliptic:405}],385:[function(r,n,i){arguments[4][184][0].apply(i,arguments)},{buffer:188,dup:184}],386:[function(r,n,i){var s=r("inherits"),o=r("md5.js"),a=r("ripemd160"),l=r("sha.js"),c=r("cipher-base");function u(h){c.call(this,"digest"),this._hash=h}s(u,c),u.prototype._update=function(h){this._hash.update(h)},u.prototype._final=function(){return this._hash.digest()},n.exports=function(h){return(h=h.toLowerCase())==="md5"?new o:h==="rmd160"||h==="ripemd160"?new a:new u(l(h))}},{"cipher-base":221,inherits:440,"md5.js":450,ripemd160:493,"sha.js":498}],387:[function(r,n,i){var s=r("md5.js");n.exports=function(o){return new s().update(o).digest()}},{"md5.js":450}],388:[function(r,n,i){var s=r("inherits"),o=r("./legacy"),a=r("cipher-base"),l=r("safe-buffer").Buffer,c=r("create-hash/md5"),u=r("ripemd160"),h=r("sha.js"),d=l.alloc(128);function f(m,v){a.call(this,"digest"),typeof v=="string"&&(v=l.from(v));var g=m==="sha512"||m==="sha384"?128:64;this._alg=m,this._key=v,v.length>g?v=(m==="rmd160"?new u:h(m)).update(v).digest():v.length<g&&(v=l.concat([v,d],g));for(var w=this._ipad=l.allocUnsafe(g),y=this._opad=l.allocUnsafe(g),C=0;C<g;C++)w[C]=54^v[C],y[C]=92^v[C];this._hash=m==="rmd160"?new u:h(m),this._hash.update(w)}s(f,a),f.prototype._update=function(m){this._hash.update(m)},f.prototype._final=function(){var m=this._hash.digest();return(this._alg==="rmd160"?new u:h(this._alg)).update(this._opad).update(m).digest()},n.exports=function(m,v){return(m=m.toLowerCase())==="rmd160"||m==="ripemd160"?new f("rmd160",v):m==="md5"?new o(c,v):new f(m,v)}},{"./legacy":389,"cipher-base":221,"create-hash/md5":387,inherits:440,ripemd160:493,"safe-buffer":494,"sha.js":498}],389:[function(r,n,i){var s=r("inherits"),o=r("safe-buffer").Buffer,a=r("cipher-base"),l=o.alloc(128);function c(u,h){a.call(this,"digest"),typeof h=="string"&&(h=o.from(h)),this._alg=u,this._key=h,h.length>64?h=u(h):h.length<64&&(h=o.concat([h,l],64));for(var d=this._ipad=o.allocUnsafe(64),f=this._opad=o.allocUnsafe(64),m=0;m<64;m++)d[m]=54^h[m],f[m]=92^h[m];this._hash=[d]}s(c,a),c.prototype._update=function(u){this._hash.push(u)},c.prototype._final=function(){var u=this._alg(o.concat(this._hash));return this._alg(o.concat([this._opad,u]))},n.exports=c},{"cipher-base":221,inherits:440,"safe-buffer":494}],390:[function(r,n,i){i.randomBytes=i.rng=i.pseudoRandomBytes=i.prng=r("randombytes"),i.createHash=i.Hash=r("create-hash"),i.createHmac=i.Hmac=r("create-hmac");var s=r("browserify-sign/algos"),o=Object.keys(s),a=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(o);i.getHashes=function(){return a};var l=r("pbkdf2");i.pbkdf2=l.pbkdf2,i.pbkdf2Sync=l.pbkdf2Sync;var c=r("browserify-cipher");i.Cipher=c.Cipher,i.createCipher=c.createCipher,i.Cipheriv=c.Cipheriv,i.createCipheriv=c.createCipheriv,i.Decipher=c.Decipher,i.createDecipher=c.createDecipher,i.Decipheriv=c.Decipheriv,i.createDecipheriv=c.createDecipheriv,i.getCiphers=c.getCiphers,i.listCiphers=c.listCiphers;var u=r("diffie-hellman");i.DiffieHellmanGroup=u.DiffieHellmanGroup,i.createDiffieHellmanGroup=u.createDiffieHellmanGroup,i.getDiffieHellman=u.getDiffieHellman,i.createDiffieHellman=u.createDiffieHellman,i.DiffieHellman=u.DiffieHellman;var h=r("browserify-sign");i.createSign=h.createSign,i.Sign=h.Sign,i.createVerify=h.createVerify,i.Verify=h.Verify,i.createECDH=r("create-ecdh");var d=r("public-encrypt");i.publicEncrypt=d.publicEncrypt,i.privateEncrypt=d.privateEncrypt,i.publicDecrypt=d.publicDecrypt,i.privateDecrypt=d.privateDecrypt;var f=r("randomfill");i.randomFill=f.randomFill,i.randomFillSync=f.randomFillSync,i.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))},i.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}},{"browserify-cipher":206,"browserify-sign":213,"browserify-sign/algos":210,"create-ecdh":384,"create-hash":386,"create-hmac":388,"diffie-hellman":400,pbkdf2:460,"public-encrypt":468,randombytes:475,randomfill:476}],391:[function(r,n,i){(function(s,o){typeof i=="object"&&n!==void 0?n.exports=o():(s=typeof globalThis<"u"?globalThis:s||self).dayjs=o()})(void 0,(function(){var s=6e4,o=36e5,a="millisecond",l="second",c="minute",u="hour",h="day",d="week",f="month",m="quarter",v="year",g="date",w="Invalid Date",y=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,C=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,k={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(S){var _=["th","st","nd","rd"],T=S%100;return"["+S+(_[(T-20)%10]||_[T]||_[0])+"]"}},F=function(S,_,T){var E=String(S);return!E||E.length>=_?S:""+Array(_+1-E.length).join(T)+S},I={s:F,z:function(S){var _=-S.utcOffset(),T=Math.abs(_),E=Math.floor(T/60),D=T%60;return(_<=0?"+":"-")+F(E,2,"0")+":"+F(D,2,"0")},m:function S(_,T){if(_.date()<T.date())return-S(T,_);var E=12*(T.year()-_.year())+(T.month()-_.month()),D=_.clone().add(E,f),O=T-D<0,P=_.clone().add(E+(O?-1:1),f);return+(-(E+(T-D)/(O?D-P:P-D))||0)},a:function(S){return S<0?Math.ceil(S)||0:Math.floor(S)},p:function(S){return{M:f,y:v,w:d,d:h,D:g,h:u,m:c,s:l,ms:a,Q:m}[S]||String(S||"").toLowerCase().replace(/s$/,"")},u:function(S){return S===void 0}},N="en",j={};j[N]=k;var L="$isDayjsObject",W=function(S){return S instanceof B||!(!S||!S[L])},K=function S(_,T,E){var D;if(!_)return N;if(typeof _=="string"){var O=_.toLowerCase();j[O]&&(D=O),T&&(j[O]=T,D=O);var P=_.split("-");if(!D&&P.length>1)return S(P[0])}else{var q=_.name;j[q]=_,D=q}return!E&&D&&(N=D),D||!E&&N},z=function(S,_){if(W(S))return S.clone();var T=typeof _=="object"?_:{};return T.date=S,T.args=arguments,new B(T)},M=I;M.l=K,M.i=W,M.w=function(S,_){return z(S,{locale:_.$L,utc:_.$u,x:_.$x,$offset:_.$offset})};var B=(function(){function S(T){this.$L=K(T.locale,null,!0),this.parse(T),this.$x=this.$x||T.x||{},this[L]=!0}var _=S.prototype;return _.parse=function(T){this.$d=(function(E){var D=E.date,O=E.utc;if(D===null)return new Date(NaN);if(M.u(D))return new Date;if(D instanceof Date)return new Date(D);if(typeof D=="string"&&!/Z$/i.test(D)){var P=D.match(y);if(P){var q=P[2]-1||0,X=(P[7]||"0").substring(0,3);return O?new Date(Date.UTC(P[1],q,P[3]||1,P[4]||0,P[5]||0,P[6]||0,X)):new Date(P[1],q,P[3]||1,P[4]||0,P[5]||0,P[6]||0,X)}}return new Date(D)})(T),this.init()},_.init=function(){var T=this.$d;this.$y=T.getFullYear(),this.$M=T.getMonth(),this.$D=T.getDate(),this.$W=T.getDay(),this.$H=T.getHours(),this.$m=T.getMinutes(),this.$s=T.getSeconds(),this.$ms=T.getMilliseconds()},_.$utils=function(){return M},_.isValid=function(){return this.$d.toString()!==w},_.isSame=function(T,E){var D=z(T);return this.startOf(E)<=D&&D<=this.endOf(E)},_.isAfter=function(T,E){return z(T)<this.startOf(E)},_.isBefore=function(T,E){return this.endOf(E)<z(T)},_.$g=function(T,E,D){return M.u(T)?this[E]:this.set(D,T)},_.unix=function(){return Math.floor(this.valueOf()/1e3)},_.valueOf=function(){return this.$d.getTime()},_.startOf=function(T,E){var D=this,O=!!M.u(E)||E,P=M.p(T),q=function(ie,te){var oe=M.w(D.$u?Date.UTC(D.$y,te,ie):new Date(D.$y,te,ie),D);return O?oe:oe.endOf(h)},X=function(ie,te){return M.w(D.toDate()[ie].apply(D.toDate("s"),(O?[0,0,0,0]:[23,59,59,999]).slice(te)),D)},Q=this.$W,G=this.$M,ee=this.$D,V="set"+(this.$u?"UTC":"");switch(P){case v:return O?q(1,0):q(31,11);case f:return O?q(1,G):q(0,G+1);case d:var H=this.$locale().weekStart||0,Z=(Q<H?Q+7:Q)-H;return q(O?ee-Z:ee+(6-Z),G);case h:case g:return X(V+"Hours",0);case u:return X(V+"Minutes",1);case c:return X(V+"Seconds",2);case l:return X(V+"Milliseconds",3);default:return this.clone()}},_.endOf=function(T){return this.startOf(T,!1)},_.$set=function(T,E){var D,O=M.p(T),P="set"+(this.$u?"UTC":""),q=(D={},D[h]=P+"Date",D[g]=P+"Date",D[f]=P+"Month",D[v]=P+"FullYear",D[u]=P+"Hours",D[c]=P+"Minutes",D[l]=P+"Seconds",D[a]=P+"Milliseconds",D)[O],X=O===h?this.$D+(E-this.$W):E;if(O===f||O===v){var Q=this.clone().set(g,1);Q.$d[q](X),Q.init(),this.$d=Q.set(g,Math.min(this.$D,Q.daysInMonth())).$d}else q&&this.$d[q](X);return this.init(),this},_.set=function(T,E){return this.clone().$set(T,E)},_.get=function(T){return this[M.p(T)]()},_.add=function(T,E){var D,O=this;T=Number(T);var P=M.p(E),q=function(G){var ee=z(O);return M.w(ee.date(ee.date()+Math.round(G*T)),O)};if(P===f)return this.set(f,this.$M+T);if(P===v)return this.set(v,this.$y+T);if(P===h)return q(1);if(P===d)return q(7);var X=(D={},D[c]=s,D[u]=o,D[l]=1e3,D)[P]||1,Q=this.$d.getTime()+T*X;return M.w(Q,this)},_.subtract=function(T,E){return this.add(-1*T,E)},_.format=function(T){var E=this,D=this.$locale();if(!this.isValid())return D.invalidDate||w;var O=T||"YYYY-MM-DDTHH:mm:ssZ",P=M.z(this),q=this.$H,X=this.$m,Q=this.$M,G=D.weekdays,ee=D.months,V=D.meridiem,H=function(te,oe,ue,Ce){return te&&(te[oe]||te(E,O))||ue[oe].slice(0,Ce)},Z=function(te){return M.s(q%12||12,te,"0")},ie=V||function(te,oe,ue){var Ce=te<12?"AM":"PM";return ue?Ce.toLowerCase():Ce};return O.replace(C,(function(te,oe){return oe||(function(ue){switch(ue){case"YY":return String(E.$y).slice(-2);case"YYYY":return M.s(E.$y,4,"0");case"M":return Q+1;case"MM":return M.s(Q+1,2,"0");case"MMM":return H(D.monthsShort,Q,ee,3);case"MMMM":return H(ee,Q);case"D":return E.$D;case"DD":return M.s(E.$D,2,"0");case"d":return String(E.$W);case"dd":return H(D.weekdaysMin,E.$W,G,2);case"ddd":return H(D.weekdaysShort,E.$W,G,3);case"dddd":return G[E.$W];case"H":return String(q);case"HH":return M.s(q,2,"0");case"h":return Z(1);case"hh":return Z(2);case"a":return ie(q,X,!0);case"A":return ie(q,X,!1);case"m":return String(X);case"mm":return M.s(X,2,"0");case"s":return String(E.$s);case"ss":return M.s(E.$s,2,"0");case"SSS":return M.s(E.$ms,3,"0");case"Z":return P}return null})(te)||P.replace(":","")}))},_.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},_.diff=function(T,E,D){var O,P=this,q=M.p(E),X=z(T),Q=(X.utcOffset()-this.utcOffset())*s,G=this-X,ee=function(){return M.m(P,X)};switch(q){case v:O=ee()/12;break;case f:O=ee();break;case m:O=ee()/3;break;case d:O=(G-Q)/6048e5;break;case h:O=(G-Q)/864e5;break;case u:O=G/o;break;case c:O=G/s;break;case l:O=G/1e3;break;default:O=G}return D?O:M.a(O)},_.daysInMonth=function(){return this.endOf(f).$D},_.$locale=function(){return j[this.$L]},_.locale=function(T,E){if(!T)return this.$L;var D=this.clone(),O=K(T,E,!0);return O&&(D.$L=O),D},_.clone=function(){return M.w(this.$d,this)},_.toDate=function(){return new Date(this.valueOf())},_.toJSON=function(){return this.isValid()?this.toISOString():null},_.toISOString=function(){return this.$d.toISOString()},_.toString=function(){return this.$d.toUTCString()},S})(),R=B.prototype;return z.prototype=R,[["$ms",a],["$s",l],["$m",c],["$H",u],["$W",h],["$M",f],["$y",v],["$D",g]].forEach((function(S){R[S[1]]=function(_){return this.$g(_,S[0],S[1])}})),z.extend=function(S,_){return S.$i||(S(_,B,z),S.$i=!0),z},z.locale=K,z.isDayjs=W,z.unix=function(S){return z(1e3*S)},z.en=j[N],z.Ls=j,z.p={},z}))},{}],392:[function(r,n,i){(function(s,o){typeof i=="object"&&n!==void 0?n.exports=o():(s=typeof globalThis<"u"?globalThis:s||self).dayjs_plugin_customParseFormat=o()})(void 0,(function(){var s={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},o=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,a=/\d\d/,l=/\d\d?/,c=/\d*[^-_:/,()\s\d]+/,u={},h=function(y){return(y=+y)+(y>68?1900:2e3)},d=function(y){return function(C){this[y]=+C}},f=[/[+-]\d\d:?(\d\d)?|Z/,function(y){(this.zone||(this.zone={})).offset=(function(C){if(!C||C==="Z")return 0;var k=C.match(/([+-]|\d\d)/g),F=60*k[1]+(+k[2]||0);return F===0?0:k[0]==="+"?-F:F})(y)}],m=function(y){var C=u[y];return C&&(C.indexOf?C:C.s.concat(C.f))},v=function(y,C){var k,F=u.meridiem;if(F){for(var I=1;I<=24;I+=1)if(y.indexOf(F(I,0,C))>-1){k=I>12;break}}else k=y===(C?"pm":"PM");return k},g={A:[c,function(y){this.afternoon=v(y,!1)}],a:[c,function(y){this.afternoon=v(y,!0)}],S:[/\d/,function(y){this.milliseconds=100*+y}],SS:[a,function(y){this.milliseconds=10*+y}],SSS:[/\d{3}/,function(y){this.milliseconds=+y}],s:[l,d("seconds")],ss:[l,d("seconds")],m:[l,d("minutes")],mm:[l,d("minutes")],H:[l,d("hours")],h:[l,d("hours")],HH:[l,d("hours")],hh:[l,d("hours")],D:[l,d("day")],DD:[a,d("day")],Do:[c,function(y){var C=u.ordinal,k=y.match(/\d+/);if(this.day=k[0],C)for(var F=1;F<=31;F+=1)C(F).replace(/\[|\]/g,"")===y&&(this.day=F)}],M:[l,d("month")],MM:[a,d("month")],MMM:[c,function(y){var C=m("months"),k=(m("monthsShort")||C.map((function(F){return F.slice(0,3)}))).indexOf(y)+1;if(k<1)throw new Error;this.month=k%12||k}],MMMM:[c,function(y){var C=m("months").indexOf(y)+1;if(C<1)throw new Error;this.month=C%12||C}],Y:[/[+-]?\d+/,d("year")],YY:[a,function(y){this.year=h(y)}],YYYY:[/\d{4}/,d("year")],Z:f,ZZ:f};function w(y){var C,k;C=y,k=u&&u.formats;for(var F=(y=C.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,(function(z,M,B){var R=B&&B.toUpperCase();return M||k[B]||s[B]||k[R].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(S,_,T){return _||T.slice(1)}))}))).match(o),I=F.length,N=0;N<I;N+=1){var j=F[N],L=g[j],W=L&&L[0],K=L&&L[1];F[N]=K?{regex:W,parser:K}:j.replace(/^\[|\]$/g,"")}return function(z){for(var M={},B=0,R=0;B<I;B+=1){var S=F[B];if(typeof S=="string")R+=S.length;else{var _=S.regex,T=S.parser,E=z.slice(R),D=_.exec(E)[0];T.call(M,D),z=z.replace(D,"")}}return(function(O){var P=O.afternoon;if(P!==void 0){var q=O.hours;P?q<12&&(O.hours+=12):q===12&&(O.hours=0),delete O.afternoon}})(M),M}}return function(y,C,k){k.p.customParseFormat=!0,y&&y.parseTwoDigitYear&&(h=y.parseTwoDigitYear);var F=C.prototype,I=F.parse;F.parse=function(N){var j=N.date,L=N.utc,W=N.args;this.$u=L;var K=W[1];if(typeof K=="string"){var z=W[2]===!0,M=W[3]===!0,B=z||M,R=W[2];M&&(R=W[2]),u=this.$locale(),!z&&R&&(u=k.Ls[R]),this.$d=(function(E,D,O){try{if(["x","X"].indexOf(D)>-1)return new Date((D==="X"?1e3:1)*E);var P=w(D)(E),q=P.year,X=P.month,Q=P.day,G=P.hours,ee=P.minutes,V=P.seconds,H=P.milliseconds,Z=P.zone,ie=new Date,te=Q||(q||X?1:ie.getDate()),oe=q||ie.getFullYear(),ue=0;q&&!X||(ue=X>0?X-1:ie.getMonth());var Ce=G||0,ye=ee||0,ne=V||0,me=H||0;return Z?new Date(Date.UTC(oe,ue,te,Ce,ye,ne,me+60*Z.offset*1e3)):O?new Date(Date.UTC(oe,ue,te,Ce,ye,ne,me)):new Date(oe,ue,te,Ce,ye,ne,me)}catch{return new Date("")}})(j,K,L),this.init(),R&&R!==!0&&(this.$L=this.locale(R).$L),B&&j!=this.format(K)&&(this.$d=new Date("")),u={}}else if(K instanceof Array)for(var S=K.length,_=1;_<=S;_+=1){W[1]=K[_-1];var T=k.apply(this,W);if(T.isValid()){this.$d=T.$d,this.$L=T.$L,this.init();break}_===S&&(this.$d=new Date(""))}else I.call(this,N)}}}))},{}],393:[function(r,n,i){(function(s,o){typeof i=="object"&&n!==void 0?n.exports=o():(s=typeof globalThis<"u"?globalThis:s||self).dayjs_plugin_utc=o()})(void 0,(function(){var s="minute",o=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(l,c,u){var h=c.prototype;u.utc=function(y){var C={date:y,utc:!0,args:arguments};return new c(C)},h.utc=function(y){var C=u(this.toDate(),{locale:this.$L,utc:!0});return y?C.add(this.utcOffset(),s):C},h.local=function(){return u(this.toDate(),{locale:this.$L,utc:!1})};var d=h.parse;h.parse=function(y){y.utc&&(this.$u=!0),this.$utils().u(y.$offset)||(this.$offset=y.$offset),d.call(this,y)};var f=h.init;h.init=function(){if(this.$u){var y=this.$d;this.$y=y.getUTCFullYear(),this.$M=y.getUTCMonth(),this.$D=y.getUTCDate(),this.$W=y.getUTCDay(),this.$H=y.getUTCHours(),this.$m=y.getUTCMinutes(),this.$s=y.getUTCSeconds(),this.$ms=y.getUTCMilliseconds()}else f.call(this)};var m=h.utcOffset;h.utcOffset=function(y,C){var k=this.$utils().u;if(k(y))return this.$u?0:k(this.$offset)?m.call(this):this.$offset;if(typeof y=="string"&&(y=(function(j){j===void 0&&(j="");var L=j.match(o);if(!L)return null;var W=(""+L[0]).match(a)||["-",0,0],K=W[0],z=60*+W[1]+ +W[2];return z===0?0:K==="+"?z:-z})(y))===null)return this;var F=Math.abs(y)<=16?60*y:y,I=this;if(C)return I.$offset=F,I.$u=y===0,I;if(y!==0){var N=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(I=this.local().add(F+N,s)).$offset=F,I.$x.$localOffset=N}else I=this.utc();return I};var v=h.format;h.format=function(y){var C=y||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return v.call(this,C)},h.valueOf=function(){var y=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*y},h.isUTC=function(){return!!this.$u},h.toISOString=function(){return this.toDate().toISOString()},h.toString=function(){return this.toDate().toUTCString()};var g=h.toDate;h.toDate=function(y){return y==="s"&&this.$offset?u(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():g.call(this)};var w=h.diff;h.diff=function(y,C,k){if(y&&this.$u===y.$u)return w.call(this,y,C,k);var F=this.local(),I=u(y).local();return w.call(F,I,C,k)}}}))},{}],394:[function(r,n,i){i.utils=r("./des/utils"),i.Cipher=r("./des/cipher"),i.DES=r("./des/des"),i.CBC=r("./des/cbc"),i.EDE=r("./des/ede")},{"./des/cbc":395,"./des/cipher":396,"./des/des":397,"./des/ede":398,"./des/utils":399}],395:[function(r,n,i){var s=r("minimalistic-assert"),o=r("inherits"),a={};function l(c){s.equal(c.length,8,"Invalid IV length"),this.iv=new Array(8);for(var u=0;u<this.iv.length;u++)this.iv[u]=c[u]}i.instantiate=function(c){function u(m){c.call(this,m),this._cbcInit()}o(u,c);for(var h=Object.keys(a),d=0;d<h.length;d++){var f=h[d];u.prototype[f]=a[f]}return u.create=function(m){return new u(m)},u},a._cbcInit=function(){var c=new l(this.options.iv);this._cbcState=c},a._update=function(c,u,h,d){var f=this._cbcState,m=this.constructor.super_.prototype,v=f.iv;if(this.type==="encrypt"){for(var g=0;g<this.blockSize;g++)v[g]^=c[u+g];for(m._update.call(this,v,0,h,d),g=0;g<this.blockSize;g++)v[g]=h[d+g]}else{for(m._update.call(this,c,u,h,d),g=0;g<this.blockSize;g++)h[d+g]^=v[g];for(g=0;g<this.blockSize;g++)v[g]=c[u+g]}}},{inherits:440,"minimalistic-assert":453}],396:[function(r,n,i){var s=r("minimalistic-assert");function o(a){this.options=a,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=a.padding!==!1}n.exports=o,o.prototype._init=function(){},o.prototype.update=function(a){return a.length===0?[]:this.type==="decrypt"?this._updateDecrypt(a):this._updateEncrypt(a)},o.prototype._buffer=function(a,l){for(var c=Math.min(this.buffer.length-this.bufferOff,a.length-l),u=0;u<c;u++)this.buffer[this.bufferOff+u]=a[l+u];return this.bufferOff+=c,c},o.prototype._flushBuffer=function(a,l){return this._update(this.buffer,0,a,l),this.bufferOff=0,this.blockSize},o.prototype._updateEncrypt=function(a){var l=0,c=0,u=(this.bufferOff+a.length)/this.blockSize|0,h=new Array(u*this.blockSize);this.bufferOff!==0&&(l+=this._buffer(a,l),this.bufferOff===this.buffer.length&&(c+=this._flushBuffer(h,c)));for(var d=a.length-(a.length-l)%this.blockSize;l<d;l+=this.blockSize)this._update(a,l,h,c),c+=this.blockSize;for(;l<a.length;l++,this.bufferOff++)this.buffer[this.bufferOff]=a[l];return h},o.prototype._updateDecrypt=function(a){for(var l=0,c=0,u=Math.ceil((this.bufferOff+a.length)/this.blockSize)-1,h=new Array(u*this.blockSize);u>0;u--)l+=this._buffer(a,l),c+=this._flushBuffer(h,c);return l+=this._buffer(a,l),h},o.prototype.final=function(a){var l,c;return a&&(l=this.update(a)),c=this.type==="encrypt"?this._finalEncrypt():this._finalDecrypt(),l?l.concat(c):c},o.prototype._pad=function(a,l){if(l===0)return!1;for(;l<a.length;)a[l++]=0;return!0},o.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var a=new Array(this.blockSize);return this._update(this.buffer,0,a,0),a},o.prototype._unpad=function(a){return a},o.prototype._finalDecrypt=function(){s.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var a=new Array(this.blockSize);return this._flushBuffer(a,0),this._unpad(a)}},{"minimalistic-assert":453}],397:[function(r,n,i){var s=r("minimalistic-assert"),o=r("inherits"),a=r("./utils"),l=r("./cipher");function c(){this.tmp=new Array(2),this.keys=null}function u(d){l.call(this,d);var f=new c;this._desState=f,this.deriveKeys(f,d.key)}o(u,l),n.exports=u,u.create=function(d){return new u(d)};var h=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];u.prototype.deriveKeys=function(d,f){d.keys=new Array(32),s.equal(f.length,this.blockSize,"Invalid key length");var m=a.readUInt32BE(f,0),v=a.readUInt32BE(f,4);a.pc1(m,v,d.tmp,0),m=d.tmp[0],v=d.tmp[1];for(var g=0;g<d.keys.length;g+=2){var w=h[g>>>1];m=a.r28shl(m,w),v=a.r28shl(v,w),a.pc2(m,v,d.keys,g)}},u.prototype._update=function(d,f,m,v){var g=this._desState,w=a.readUInt32BE(d,f),y=a.readUInt32BE(d,f+4);a.ip(w,y,g.tmp,0),w=g.tmp[0],y=g.tmp[1],this.type==="encrypt"?this._encrypt(g,w,y,g.tmp,0):this._decrypt(g,w,y,g.tmp,0),w=g.tmp[0],y=g.tmp[1],a.writeUInt32BE(m,w,v),a.writeUInt32BE(m,y,v+4)},u.prototype._pad=function(d,f){if(this.padding===!1)return!1;for(var m=d.length-f,v=f;v<d.length;v++)d[v]=m;return!0},u.prototype._unpad=function(d){if(this.padding===!1)return d;for(var f=d[d.length-1],m=d.length-f;m<d.length;m++)s.equal(d[m],f);return d.slice(0,d.length-f)},u.prototype._encrypt=function(d,f,m,v,g){for(var w=f,y=m,C=0;C<d.keys.length;C+=2){var k=d.keys[C],F=d.keys[C+1];a.expand(y,d.tmp,0),k^=d.tmp[0],F^=d.tmp[1];var I=a.substitute(k,F),N=y;y=(w^a.permute(I))>>>0,w=N}a.rip(y,w,v,g)},u.prototype._decrypt=function(d,f,m,v,g){for(var w=m,y=f,C=d.keys.length-2;C>=0;C-=2){var k=d.keys[C],F=d.keys[C+1];a.expand(w,d.tmp,0),k^=d.tmp[0],F^=d.tmp[1];var I=a.substitute(k,F),N=w;w=(y^a.permute(I))>>>0,y=N}a.rip(w,y,v,g)}},{"./cipher":396,"./utils":399,inherits:440,"minimalistic-assert":453}],398:[function(r,n,i){var s=r("minimalistic-assert"),o=r("inherits"),a=r("./cipher"),l=r("./des");function c(h,d){s.equal(d.length,24,"Invalid key length");var f=d.slice(0,8),m=d.slice(8,16),v=d.slice(16,24);this.ciphers=h==="encrypt"?[l.create({type:"encrypt",key:f}),l.create({type:"decrypt",key:m}),l.create({type:"encrypt",key:v})]:[l.create({type:"decrypt",key:v}),l.create({type:"encrypt",key:m}),l.create({type:"decrypt",key:f})]}function u(h){a.call(this,h);var d=new c(this.type,this.options.key);this._edeState=d}o(u,a),n.exports=u,u.create=function(h){return new u(h)},u.prototype._update=function(h,d,f,m){var v=this._edeState;v.ciphers[0]._update(h,d,f,m),v.ciphers[1]._update(f,m,f,m),v.ciphers[2]._update(f,m,f,m)},u.prototype._pad=l.prototype._pad,u.prototype._unpad=l.prototype._unpad},{"./cipher":396,"./des":397,inherits:440,"minimalistic-assert":453}],399:[function(r,n,i){i.readUInt32BE=function(l,c){return(l[0+c]<<24|l[1+c]<<16|l[2+c]<<8|l[3+c])>>>0},i.writeUInt32BE=function(l,c,u){l[0+u]=c>>>24,l[1+u]=c>>>16&255,l[2+u]=c>>>8&255,l[3+u]=255&c},i.ip=function(l,c,u,h){for(var d=0,f=0,m=6;m>=0;m-=2){for(var v=0;v<=24;v+=8)d<<=1,d|=c>>>v+m&1;for(v=0;v<=24;v+=8)d<<=1,d|=l>>>v+m&1}for(m=6;m>=0;m-=2){for(v=1;v<=25;v+=8)f<<=1,f|=c>>>v+m&1;for(v=1;v<=25;v+=8)f<<=1,f|=l>>>v+m&1}u[h+0]=d>>>0,u[h+1]=f>>>0},i.rip=function(l,c,u,h){for(var d=0,f=0,m=0;m<4;m++)for(var v=24;v>=0;v-=8)d<<=1,d|=c>>>v+m&1,d<<=1,d|=l>>>v+m&1;for(m=4;m<8;m++)for(v=24;v>=0;v-=8)f<<=1,f|=c>>>v+m&1,f<<=1,f|=l>>>v+m&1;u[h+0]=d>>>0,u[h+1]=f>>>0},i.pc1=function(l,c,u,h){for(var d=0,f=0,m=7;m>=5;m--){for(var v=0;v<=24;v+=8)d<<=1,d|=c>>v+m&1;for(v=0;v<=24;v+=8)d<<=1,d|=l>>v+m&1}for(v=0;v<=24;v+=8)d<<=1,d|=c>>v+m&1;for(m=1;m<=3;m++){for(v=0;v<=24;v+=8)f<<=1,f|=c>>v+m&1;for(v=0;v<=24;v+=8)f<<=1,f|=l>>v+m&1}for(v=0;v<=24;v+=8)f<<=1,f|=l>>v+m&1;u[h+0]=d>>>0,u[h+1]=f>>>0},i.r28shl=function(l,c){return l<<c&268435455|l>>>28-c};var s=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];i.pc2=function(l,c,u,h){for(var d=0,f=0,m=s.length>>>1,v=0;v<m;v++)d<<=1,d|=l>>>s[v]&1;for(v=m;v<s.length;v++)f<<=1,f|=c>>>s[v]&1;u[h+0]=d>>>0,u[h+1]=f>>>0},i.expand=function(l,c,u){var h=0,d=0;h=(1&l)<<5|l>>>27;for(var f=23;f>=15;f-=4)h<<=6,h|=l>>>f&63;for(f=11;f>=3;f-=4)d|=l>>>f&63,d<<=6;d|=(31&l)<<1|l>>>31,c[u+0]=h>>>0,c[u+1]=d>>>0};var o=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];i.substitute=function(l,c){for(var u=0,h=0;h<4;h++)u<<=4,u|=o[64*h+(l>>>18-6*h&63)];for(h=0;h<4;h++)u<<=4,u|=o[256+64*h+(c>>>18-6*h&63)];return u>>>0};var a=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];i.permute=function(l){for(var c=0,u=0;u<a.length;u++)c<<=1,c|=l>>>a[u]&1;return c>>>0},i.padSplit=function(l,c,u){for(var h=l.toString(2);h.length<c;)h="0"+h;for(var d=[],f=0;f<c;f+=u)d.push(h.slice(f,f+u));return d.join(" ")}},{}],400:[function(r,n,i){(function(s){(function(){var o=r("./lib/generatePrime"),a=r("./lib/primes.json"),l=r("./lib/dh"),c={binary:!0,hex:!0,base64:!0};i.DiffieHellmanGroup=i.createDiffieHellmanGroup=i.getDiffieHellman=function(u){var h=new s(a[u].prime,"hex"),d=new s(a[u].gen,"hex");return new l(h,d)},i.createDiffieHellman=i.DiffieHellman=function u(h,d,f,m){return s.isBuffer(d)||c[d]===void 0?u(h,"binary",d,f):(d=d||"binary",m=m||"binary",f=f||new s([2]),s.isBuffer(f)||(f=new s(f,m)),typeof h=="number"?new l(o(h,f),f,!0):(s.isBuffer(h)||(h=new s(h,d)),new l(h,f,!0)))}}).call(this)}).call(this,r("buffer").Buffer)},{"./lib/dh":401,"./lib/generatePrime":402,"./lib/primes.json":403,buffer:220}],401:[function(r,n,i){(function(s){(function(){var o=r("bn.js"),a=new(r("miller-rabin")),l=new o(24),c=new o(11),u=new o(10),h=new o(3),d=new o(7),f=r("./generatePrime"),m=r("randombytes");function v(k,F){return F=F||"utf8",s.isBuffer(k)||(k=new s(k,F)),this._pub=new o(k),this}function g(k,F){return F=F||"utf8",s.isBuffer(k)||(k=new s(k,F)),this._priv=new o(k),this}n.exports=y;var w={};function y(k,F,I){this.setGenerator(F),this.__prime=new o(k),this._prime=o.mont(this.__prime),this._primeLen=k.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,I?(this.setPublicKey=v,this.setPrivateKey=g):this._primeCode=8}function C(k,F){var I=new s(k.toArray());return F?I.toString(F):I}Object.defineProperty(y.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=(function(k,F){var I=F.toString("hex"),N=[I,k.toString(16)].join("_");if(N in w)return w[N];var j,L=0;if(k.isEven()||!f.simpleSieve||!f.fermatTest(k)||!a.test(k))return L+=1,L+=I==="02"||I==="05"?8:4,w[N]=L,L;switch(a.test(k.shrn(1))||(L+=2),I){case"02":k.mod(l).cmp(c)&&(L+=8);break;case"05":(j=k.mod(u)).cmp(h)&&j.cmp(d)&&(L+=8);break;default:L+=4}return w[N]=L,L})(this.__prime,this.__gen)),this._primeCode}}),y.prototype.generateKeys=function(){return this._priv||(this._priv=new o(m(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},y.prototype.computeSecret=function(k){var F=(k=(k=new o(k)).toRed(this._prime)).redPow(this._priv).fromRed(),I=new s(F.toArray()),N=this.getPrime();if(I.length<N.length){var j=new s(N.length-I.length);j.fill(0),I=s.concat([j,I])}return I},y.prototype.getPublicKey=function(k){return C(this._pub,k)},y.prototype.getPrivateKey=function(k){return C(this._priv,k)},y.prototype.getPrime=function(k){return C(this.__prime,k)},y.prototype.getGenerator=function(k){return C(this._gen,k)},y.prototype.setGenerator=function(k,F){return F=F||"utf8",s.isBuffer(k)||(k=new s(k,F)),this.__gen=k,this._gen=new o(k),this}}).call(this)}).call(this,r("buffer").Buffer)},{"./generatePrime":402,"bn.js":404,buffer:220,"miller-rabin":451,randombytes:475}],402:[function(r,n,i){var s=r("randombytes");n.exports=k,k.simpleSieve=y,k.fermatTest=C;var o=r("bn.js"),a=new o(24),l=new(r("miller-rabin")),c=new o(1),u=new o(2),h=new o(5),d=(new o(16),new o(8),new o(10)),f=new o(3),m=(new o(7),new o(11)),v=new o(4),g=(new o(12),null);function w(){if(g!==null)return g;var F=[];F[0]=2;for(var I=1,N=3;N<1048576;N+=2){for(var j=Math.ceil(Math.sqrt(N)),L=0;L<I&&F[L]<=j&&N%F[L]!=0;L++);I!==L&&F[L]<=j||(F[I++]=N)}return g=F,F}function y(F){for(var I=w(),N=0;N<I.length;N++)if(F.modn(I[N])===0)return F.cmpn(I[N])===0;return!0}function C(F){var I=o.mont(F);return u.toRed(I).redPow(F.subn(1)).fromRed().cmpn(1)===0}function k(F,I){if(F<16)return new o(I===2||I===5?[140,123]:[140,39]);var N,j;for(I=new o(I);;){for(N=new o(s(Math.ceil(F/8)));N.bitLength()>F;)N.ishrn(1);if(N.isEven()&&N.iadd(c),N.testn(1)||N.iadd(u),I.cmp(u)){if(!I.cmp(h))for(;N.mod(d).cmp(f);)N.iadd(v)}else for(;N.mod(a).cmp(m);)N.iadd(v);if(y(j=N.shrn(1))&&y(N)&&C(j)&&C(N)&&l.test(j)&&l.test(N))return N}}},{"bn.js":404,"miller-rabin":451,randombytes:475}],403:[function(r,n,i){n.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}},{}],404:[function(r,n,i){arguments[4][184][0].apply(i,arguments)},{buffer:188,dup:184}],405:[function(r,n,i){var s=i;s.version=r("../package.json").version,s.utils=r("./elliptic/utils"),s.rand=r("brorand"),s.curve=r("./elliptic/curve"),s.curves=r("./elliptic/curves"),s.ec=r("./elliptic/ec"),s.eddsa=r("./elliptic/eddsa")},{"../package.json":421,"./elliptic/curve":408,"./elliptic/curves":411,"./elliptic/ec":412,"./elliptic/eddsa":415,"./elliptic/utils":419,brorand:187}],406:[function(r,n,i){var s=r("bn.js"),o=r("../utils"),a=o.getNAF,l=o.getJSF,c=o.assert;function u(d,f){this.type=d,this.p=new s(f.p,16),this.red=f.prime?s.red(f.prime):s.mont(this.p),this.zero=new s(0).toRed(this.red),this.one=new s(1).toRed(this.red),this.two=new s(2).toRed(this.red),this.n=f.n&&new s(f.n,16),this.g=f.g&&this.pointFromJSON(f.g,f.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var m=this.n&&this.p.div(this.n);!m||m.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function h(d,f){this.curve=d,this.type=f,this.precomputed=null}n.exports=u,u.prototype.point=function(){throw new Error("Not implemented")},u.prototype.validate=function(){throw new Error("Not implemented")},u.prototype._fixedNafMul=function(d,f){c(d.precomputed);var m=d._getDoubles(),v=a(f,1,this._bitLength),g=(1<<m.step+1)-(m.step%2==0?2:1);g/=3;var w,y,C=[];for(w=0;w<v.length;w+=m.step){y=0;for(var k=w+m.step-1;k>=w;k--)y=(y<<1)+v[k];C.push(y)}for(var F=this.jpoint(null,null,null),I=this.jpoint(null,null,null),N=g;N>0;N--){for(w=0;w<C.length;w++)(y=C[w])===N?I=I.mixedAdd(m.points[w]):y===-N&&(I=I.mixedAdd(m.points[w].neg()));F=F.add(I)}return F.toP()},u.prototype._wnafMul=function(d,f){var m=4,v=d._getNAFPoints(m);m=v.wnd;for(var g=v.points,w=a(f,m,this._bitLength),y=this.jpoint(null,null,null),C=w.length-1;C>=0;C--){for(var k=0;C>=0&&w[C]===0;C--)k++;if(C>=0&&k++,y=y.dblp(k),C<0)break;var F=w[C];c(F!==0),y=d.type==="affine"?F>0?y.mixedAdd(g[F-1>>1]):y.mixedAdd(g[-F-1>>1].neg()):F>0?y.add(g[F-1>>1]):y.add(g[-F-1>>1].neg())}return d.type==="affine"?y.toP():y},u.prototype._wnafMulAdd=function(d,f,m,v,g){var w,y,C,k=this._wnafT1,F=this._wnafT2,I=this._wnafT3,N=0;for(w=0;w<v;w++){var j=(C=f[w])._getNAFPoints(d);k[w]=j.wnd,F[w]=j.points}for(w=v-1;w>=1;w-=2){var L=w-1,W=w;if(k[L]===1&&k[W]===1){var K=[f[L],null,null,f[W]];f[L].y.cmp(f[W].y)===0?(K[1]=f[L].add(f[W]),K[2]=f[L].toJ().mixedAdd(f[W].neg())):f[L].y.cmp(f[W].y.redNeg())===0?(K[1]=f[L].toJ().mixedAdd(f[W]),K[2]=f[L].add(f[W].neg())):(K[1]=f[L].toJ().mixedAdd(f[W]),K[2]=f[L].toJ().mixedAdd(f[W].neg()));var z=[-3,-1,-5,-7,0,7,5,1,3],M=l(m[L],m[W]);for(N=Math.max(M[0].length,N),I[L]=new Array(N),I[W]=new Array(N),y=0;y<N;y++){var B=0|M[0][y],R=0|M[1][y];I[L][y]=z[3*(B+1)+(R+1)],I[W][y]=0,F[L]=K}}else I[L]=a(m[L],k[L],this._bitLength),I[W]=a(m[W],k[W],this._bitLength),N=Math.max(I[L].length,N),N=Math.max(I[W].length,N)}var S=this.jpoint(null,null,null),_=this._wnafT4;for(w=N;w>=0;w--){for(var T=0;w>=0;){var E=!0;for(y=0;y<v;y++)_[y]=0|I[y][w],_[y]!==0&&(E=!1);if(!E)break;T++,w--}if(w>=0&&T++,S=S.dblp(T),w<0)break;for(y=0;y<v;y++){var D=_[y];D!==0&&(D>0?C=F[y][D-1>>1]:D<0&&(C=F[y][-D-1>>1].neg()),S=C.type==="affine"?S.mixedAdd(C):S.add(C))}}for(w=0;w<v;w++)F[w]=null;return g?S:S.toP()},u.BasePoint=h,h.prototype.eq=function(){throw new Error("Not implemented")},h.prototype.validate=function(){return this.curve.validate(this)},u.prototype.decodePoint=function(d,f){d=o.toArray(d,f);var m=this.p.byteLength();if((d[0]===4||d[0]===6||d[0]===7)&&d.length-1==2*m)return d[0]===6?c(d[d.length-1]%2==0):d[0]===7&&c(d[d.length-1]%2==1),this.point(d.slice(1,1+m),d.slice(1+m,1+2*m));if((d[0]===2||d[0]===3)&&d.length-1===m)return this.pointFromX(d.slice(1,1+m),d[0]===3);throw new Error("Unknown point format")},h.prototype.encodeCompressed=function(d){return this.encode(d,!0)},h.prototype._encode=function(d){var f=this.curve.p.byteLength(),m=this.getX().toArray("be",f);return d?[this.getY().isEven()?2:3].concat(m):[4].concat(m,this.getY().toArray("be",f))},h.prototype.encode=function(d,f){return o.encode(this._encode(f),d)},h.prototype.precompute=function(d){if(this.precomputed)return this;var f={doubles:null,naf:null,beta:null};return f.naf=this._getNAFPoints(8),f.doubles=this._getDoubles(4,d),f.beta=this._getBeta(),this.precomputed=f,this},h.prototype._hasDoubles=function(d){if(!this.precomputed)return!1;var f=this.precomputed.doubles;return!!f&&f.points.length>=Math.ceil((d.bitLength()+1)/f.step)},h.prototype._getDoubles=function(d,f){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var m=[this],v=this,g=0;g<f;g+=d){for(var w=0;w<d;w++)v=v.dbl();m.push(v)}return{step:d,points:m}},h.prototype._getNAFPoints=function(d){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var f=[this],m=(1<<d)-1,v=m===1?null:this.dbl(),g=1;g<m;g++)f[g]=f[g-1].add(v);return{wnd:d,points:f}},h.prototype._getBeta=function(){return null},h.prototype.dblp=function(d){for(var f=this,m=0;m<d;m++)f=f.dbl();return f}},{"../utils":419,"bn.js":420}],407:[function(r,n,i){var s=r("../utils"),o=r("bn.js"),a=r("inherits"),l=r("./base"),c=s.assert;function u(d){this.twisted=(0|d.a)!=1,this.mOneA=this.twisted&&(0|d.a)==-1,this.extended=this.mOneA,l.call(this,"edwards",d),this.a=new o(d.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new o(d.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new o(d.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),c(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(0|d.c)==1}function h(d,f,m,v,g){l.BasePoint.call(this,d,"projective"),f===null&&m===null&&v===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new o(f,16),this.y=new o(m,16),this.z=v?new o(v,16):this.curve.one,this.t=g&&new o(g,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}a(u,l),n.exports=u,u.prototype._mulA=function(d){return this.mOneA?d.redNeg():this.a.redMul(d)},u.prototype._mulC=function(d){return this.oneC?d:this.c.redMul(d)},u.prototype.jpoint=function(d,f,m,v){return this.point(d,f,m,v)},u.prototype.pointFromX=function(d,f){(d=new o(d,16)).red||(d=d.toRed(this.red));var m=d.redSqr(),v=this.c2.redSub(this.a.redMul(m)),g=this.one.redSub(this.c2.redMul(this.d).redMul(m)),w=v.redMul(g.redInvm()),y=w.redSqrt();if(y.redSqr().redSub(w).cmp(this.zero)!==0)throw new Error("invalid point");var C=y.fromRed().isOdd();return(f&&!C||!f&&C)&&(y=y.redNeg()),this.point(d,y)},u.prototype.pointFromY=function(d,f){(d=new o(d,16)).red||(d=d.toRed(this.red));var m=d.redSqr(),v=m.redSub(this.c2),g=m.redMul(this.d).redMul(this.c2).redSub(this.a),w=v.redMul(g.redInvm());if(w.cmp(this.zero)===0){if(f)throw new Error("invalid point");return this.point(this.zero,d)}var y=w.redSqrt();if(y.redSqr().redSub(w).cmp(this.zero)!==0)throw new Error("invalid point");return y.fromRed().isOdd()!==f&&(y=y.redNeg()),this.point(y,d)},u.prototype.validate=function(d){if(d.isInfinity())return!0;d.normalize();var f=d.x.redSqr(),m=d.y.redSqr(),v=f.redMul(this.a).redAdd(m),g=this.c2.redMul(this.one.redAdd(this.d.redMul(f).redMul(m)));return v.cmp(g)===0},a(h,l.BasePoint),u.prototype.pointFromJSON=function(d){return h.fromJSON(this,d)},u.prototype.point=function(d,f,m,v){return new h(this,d,f,m,v)},h.fromJSON=function(d,f){return new h(d,f[0],f[1],f[2])},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)},h.prototype._extDbl=function(){var d=this.x.redSqr(),f=this.y.redSqr(),m=this.z.redSqr();m=m.redIAdd(m);var v=this.curve._mulA(d),g=this.x.redAdd(this.y).redSqr().redISub(d).redISub(f),w=v.redAdd(f),y=w.redSub(m),C=v.redSub(f),k=g.redMul(y),F=w.redMul(C),I=g.redMul(C),N=y.redMul(w);return this.curve.point(k,F,N,I)},h.prototype._projDbl=function(){var d,f,m,v,g,w,y=this.x.redAdd(this.y).redSqr(),C=this.x.redSqr(),k=this.y.redSqr();if(this.curve.twisted){var F=(v=this.curve._mulA(C)).redAdd(k);this.zOne?(d=y.redSub(C).redSub(k).redMul(F.redSub(this.curve.two)),f=F.redMul(v.redSub(k)),m=F.redSqr().redSub(F).redSub(F)):(g=this.z.redSqr(),w=F.redSub(g).redISub(g),d=y.redSub(C).redISub(k).redMul(w),f=F.redMul(v.redSub(k)),m=F.redMul(w))}else v=C.redAdd(k),g=this.curve._mulC(this.z).redSqr(),w=v.redSub(g).redSub(g),d=this.curve._mulC(y.redISub(v)).redMul(w),f=this.curve._mulC(v).redMul(C.redISub(k)),m=v.redMul(w);return this.curve.point(d,f,m)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},h.prototype._extAdd=function(d){var f=this.y.redSub(this.x).redMul(d.y.redSub(d.x)),m=this.y.redAdd(this.x).redMul(d.y.redAdd(d.x)),v=this.t.redMul(this.curve.dd).redMul(d.t),g=this.z.redMul(d.z.redAdd(d.z)),w=m.redSub(f),y=g.redSub(v),C=g.redAdd(v),k=m.redAdd(f),F=w.redMul(y),I=C.redMul(k),N=w.redMul(k),j=y.redMul(C);return this.curve.point(F,I,j,N)},h.prototype._projAdd=function(d){var f,m,v=this.z.redMul(d.z),g=v.redSqr(),w=this.x.redMul(d.x),y=this.y.redMul(d.y),C=this.curve.d.redMul(w).redMul(y),k=g.redSub(C),F=g.redAdd(C),I=this.x.redAdd(this.y).redMul(d.x.redAdd(d.y)).redISub(w).redISub(y),N=v.redMul(k).redMul(I);return this.curve.twisted?(f=v.redMul(F).redMul(y.redSub(this.curve._mulA(w))),m=k.redMul(F)):(f=v.redMul(F).redMul(y.redSub(w)),m=this.curve._mulC(k).redMul(F)),this.curve.point(N,f,m)},h.prototype.add=function(d){return this.isInfinity()?d:d.isInfinity()?this:this.curve.extended?this._extAdd(d):this._projAdd(d)},h.prototype.mul=function(d){return this._hasDoubles(d)?this.curve._fixedNafMul(this,d):this.curve._wnafMul(this,d)},h.prototype.mulAdd=function(d,f,m){return this.curve._wnafMulAdd(1,[this,f],[d,m],2,!1)},h.prototype.jmulAdd=function(d,f,m){return this.curve._wnafMulAdd(1,[this,f],[d,m],2,!0)},h.prototype.normalize=function(){if(this.zOne)return this;var d=this.z.redInvm();return this.x=this.x.redMul(d),this.y=this.y.redMul(d),this.t&&(this.t=this.t.redMul(d)),this.z=this.curve.one,this.zOne=!0,this},h.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},h.prototype.getX=function(){return this.normalize(),this.x.fromRed()},h.prototype.getY=function(){return this.normalize(),this.y.fromRed()},h.prototype.eq=function(d){return this===d||this.getX().cmp(d.getX())===0&&this.getY().cmp(d.getY())===0},h.prototype.eqXToP=function(d){var f=d.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(f)===0)return!0;for(var m=d.clone(),v=this.curve.redN.redMul(this.z);;){if(m.iadd(this.curve.n),m.cmp(this.curve.p)>=0)return!1;if(f.redIAdd(v),this.x.cmp(f)===0)return!0}},h.prototype.toP=h.prototype.normalize,h.prototype.mixedAdd=h.prototype.add},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],408:[function(r,n,i){var s=i;s.base=r("./base"),s.short=r("./short"),s.mont=r("./mont"),s.edwards=r("./edwards")},{"./base":406,"./edwards":407,"./mont":409,"./short":410}],409:[function(r,n,i){var s=r("bn.js"),o=r("inherits"),a=r("./base"),l=r("../utils");function c(h){a.call(this,"mont",h),this.a=new s(h.a,16).toRed(this.red),this.b=new s(h.b,16).toRed(this.red),this.i4=new s(4).toRed(this.red).redInvm(),this.two=new s(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function u(h,d,f){a.BasePoint.call(this,h,"projective"),d===null&&f===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new s(d,16),this.z=new s(f,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}o(c,a),n.exports=c,c.prototype.validate=function(h){var d=h.normalize().x,f=d.redSqr(),m=f.redMul(d).redAdd(f.redMul(this.a)).redAdd(d);return m.redSqrt().redSqr().cmp(m)===0},o(u,a.BasePoint),c.prototype.decodePoint=function(h,d){return this.point(l.toArray(h,d),1)},c.prototype.point=function(h,d){return new u(this,h,d)},c.prototype.pointFromJSON=function(h){return u.fromJSON(this,h)},u.prototype.precompute=function(){},u.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},u.fromJSON=function(h,d){return new u(h,d[0],d[1]||h.one)},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return this.z.cmpn(0)===0},u.prototype.dbl=function(){var h=this.x.redAdd(this.z).redSqr(),d=this.x.redSub(this.z).redSqr(),f=h.redSub(d),m=h.redMul(d),v=f.redMul(d.redAdd(this.curve.a24.redMul(f)));return this.curve.point(m,v)},u.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.diffAdd=function(h,d){var f=this.x.redAdd(this.z),m=this.x.redSub(this.z),v=h.x.redAdd(h.z),g=h.x.redSub(h.z).redMul(f),w=v.redMul(m),y=d.z.redMul(g.redAdd(w).redSqr()),C=d.x.redMul(g.redISub(w).redSqr());return this.curve.point(y,C)},u.prototype.mul=function(h){for(var d=h.clone(),f=this,m=this.curve.point(null,null),v=[];d.cmpn(0)!==0;d.iushrn(1))v.push(d.andln(1));for(var g=v.length-1;g>=0;g--)v[g]===0?(f=f.diffAdd(m,this),m=m.dbl()):(m=f.diffAdd(m,this),f=f.dbl());return m},u.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.eq=function(h){return this.getX().cmp(h.getX())===0},u.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],410:[function(r,n,i){var s=r("../utils"),o=r("bn.js"),a=r("inherits"),l=r("./base"),c=s.assert;function u(f){l.call(this,"short",f),this.a=new o(f.a,16).toRed(this.red),this.b=new o(f.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(f),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function h(f,m,v,g){l.BasePoint.call(this,f,"affine"),m===null&&v===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new o(m,16),this.y=new o(v,16),g&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function d(f,m,v,g){l.BasePoint.call(this,f,"jacobian"),m===null&&v===null&&g===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new o(0)):(this.x=new o(m,16),this.y=new o(v,16),this.z=new o(g,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}a(u,l),n.exports=u,u.prototype._getEndomorphism=function(f){if(this.zeroA&&this.g&&this.n&&this.p.modn(3)===1){var m,v;if(f.beta)m=new o(f.beta,16).toRed(this.red);else{var g=this._getEndoRoots(this.p);m=(m=g[0].cmp(g[1])<0?g[0]:g[1]).toRed(this.red)}if(f.lambda)v=new o(f.lambda,16);else{var w=this._getEndoRoots(this.n);this.g.mul(w[0]).x.cmp(this.g.x.redMul(m))===0?v=w[0]:(v=w[1],c(this.g.mul(v).x.cmp(this.g.x.redMul(m))===0))}return{beta:m,lambda:v,basis:f.basis?f.basis.map((function(y){return{a:new o(y.a,16),b:new o(y.b,16)}})):this._getEndoBasis(v)}}},u.prototype._getEndoRoots=function(f){var m=f===this.p?this.red:o.mont(f),v=new o(2).toRed(m).redInvm(),g=v.redNeg(),w=new o(3).toRed(m).redNeg().redSqrt().redMul(v);return[g.redAdd(w).fromRed(),g.redSub(w).fromRed()]},u.prototype._getEndoBasis=function(f){for(var m,v,g,w,y,C,k,F,I,N=this.n.ushrn(Math.floor(this.n.bitLength()/2)),j=f,L=this.n.clone(),W=new o(1),K=new o(0),z=new o(0),M=new o(1),B=0;j.cmpn(0)!==0;){var R=L.div(j);F=L.sub(R.mul(j)),I=z.sub(R.mul(W));var S=M.sub(R.mul(K));if(!g&&F.cmp(N)<0)m=k.neg(),v=W,g=F.neg(),w=I;else if(g&&++B==2)break;k=F,L=j,j=F,z=W,W=I,M=K,K=S}y=F.neg(),C=I;var _=g.sqr().add(w.sqr());return y.sqr().add(C.sqr()).cmp(_)>=0&&(y=m,C=v),g.negative&&(g=g.neg(),w=w.neg()),y.negative&&(y=y.neg(),C=C.neg()),[{a:g,b:w},{a:y,b:C}]},u.prototype._endoSplit=function(f){var m=this.endo.basis,v=m[0],g=m[1],w=g.b.mul(f).divRound(this.n),y=v.b.neg().mul(f).divRound(this.n),C=w.mul(v.a),k=y.mul(g.a),F=w.mul(v.b),I=y.mul(g.b);return{k1:f.sub(C).sub(k),k2:F.add(I).neg()}},u.prototype.pointFromX=function(f,m){(f=new o(f,16)).red||(f=f.toRed(this.red));var v=f.redSqr().redMul(f).redIAdd(f.redMul(this.a)).redIAdd(this.b),g=v.redSqrt();if(g.redSqr().redSub(v).cmp(this.zero)!==0)throw new Error("invalid point");var w=g.fromRed().isOdd();return(m&&!w||!m&&w)&&(g=g.redNeg()),this.point(f,g)},u.prototype.validate=function(f){if(f.inf)return!0;var m=f.x,v=f.y,g=this.a.redMul(m),w=m.redSqr().redMul(m).redIAdd(g).redIAdd(this.b);return v.redSqr().redISub(w).cmpn(0)===0},u.prototype._endoWnafMulAdd=function(f,m,v){for(var g=this._endoWnafT1,w=this._endoWnafT2,y=0;y<f.length;y++){var C=this._endoSplit(m[y]),k=f[y],F=k._getBeta();C.k1.negative&&(C.k1.ineg(),k=k.neg(!0)),C.k2.negative&&(C.k2.ineg(),F=F.neg(!0)),g[2*y]=k,g[2*y+1]=F,w[2*y]=C.k1,w[2*y+1]=C.k2}for(var I=this._wnafMulAdd(1,g,w,2*y,v),N=0;N<2*y;N++)g[N]=null,w[N]=null;return I},a(h,l.BasePoint),u.prototype.point=function(f,m,v){return new h(this,f,m,v)},u.prototype.pointFromJSON=function(f,m){return h.fromJSON(this,f,m)},h.prototype._getBeta=function(){if(this.curve.endo){var f=this.precomputed;if(f&&f.beta)return f.beta;var m=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(f){var v=this.curve,g=function(w){return v.point(w.x.redMul(v.endo.beta),w.y)};f.beta=m,m.precomputed={beta:null,naf:f.naf&&{wnd:f.naf.wnd,points:f.naf.points.map(g)},doubles:f.doubles&&{step:f.doubles.step,points:f.doubles.points.map(g)}}}return m}},h.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},h.fromJSON=function(f,m,v){typeof m=="string"&&(m=JSON.parse(m));var g=f.point(m[0],m[1],v);if(!m[2])return g;function w(C){return f.point(C[0],C[1],v)}var y=m[2];return g.precomputed={beta:null,doubles:y.doubles&&{step:y.doubles.step,points:[g].concat(y.doubles.points.map(w))},naf:y.naf&&{wnd:y.naf.wnd,points:[g].concat(y.naf.points.map(w))}},g},h.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},h.prototype.isInfinity=function(){return this.inf},h.prototype.add=function(f){if(this.inf)return f;if(f.inf)return this;if(this.eq(f))return this.dbl();if(this.neg().eq(f))return this.curve.point(null,null);if(this.x.cmp(f.x)===0)return this.curve.point(null,null);var m=this.y.redSub(f.y);m.cmpn(0)!==0&&(m=m.redMul(this.x.redSub(f.x).redInvm()));var v=m.redSqr().redISub(this.x).redISub(f.x),g=m.redMul(this.x.redSub(v)).redISub(this.y);return this.curve.point(v,g)},h.prototype.dbl=function(){if(this.inf)return this;var f=this.y.redAdd(this.y);if(f.cmpn(0)===0)return this.curve.point(null,null);var m=this.curve.a,v=this.x.redSqr(),g=f.redInvm(),w=v.redAdd(v).redIAdd(v).redIAdd(m).redMul(g),y=w.redSqr().redISub(this.x.redAdd(this.x)),C=w.redMul(this.x.redSub(y)).redISub(this.y);return this.curve.point(y,C)},h.prototype.getX=function(){return this.x.fromRed()},h.prototype.getY=function(){return this.y.fromRed()},h.prototype.mul=function(f){return f=new o(f,16),this.isInfinity()?this:this._hasDoubles(f)?this.curve._fixedNafMul(this,f):this.curve.endo?this.curve._endoWnafMulAdd([this],[f]):this.curve._wnafMul(this,f)},h.prototype.mulAdd=function(f,m,v){var g=[this,m],w=[f,v];return this.curve.endo?this.curve._endoWnafMulAdd(g,w):this.curve._wnafMulAdd(1,g,w,2)},h.prototype.jmulAdd=function(f,m,v){var g=[this,m],w=[f,v];return this.curve.endo?this.curve._endoWnafMulAdd(g,w,!0):this.curve._wnafMulAdd(1,g,w,2,!0)},h.prototype.eq=function(f){return this===f||this.inf===f.inf&&(this.inf||this.x.cmp(f.x)===0&&this.y.cmp(f.y)===0)},h.prototype.neg=function(f){if(this.inf)return this;var m=this.curve.point(this.x,this.y.redNeg());if(f&&this.precomputed){var v=this.precomputed,g=function(w){return w.neg()};m.precomputed={naf:v.naf&&{wnd:v.naf.wnd,points:v.naf.points.map(g)},doubles:v.doubles&&{step:v.doubles.step,points:v.doubles.points.map(g)}}}return m},h.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},a(d,l.BasePoint),u.prototype.jpoint=function(f,m,v){return new d(this,f,m,v)},d.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var f=this.z.redInvm(),m=f.redSqr(),v=this.x.redMul(m),g=this.y.redMul(m).redMul(f);return this.curve.point(v,g)},d.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},d.prototype.add=function(f){if(this.isInfinity())return f;if(f.isInfinity())return this;var m=f.z.redSqr(),v=this.z.redSqr(),g=this.x.redMul(m),w=f.x.redMul(v),y=this.y.redMul(m.redMul(f.z)),C=f.y.redMul(v.redMul(this.z)),k=g.redSub(w),F=y.redSub(C);if(k.cmpn(0)===0)return F.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var I=k.redSqr(),N=I.redMul(k),j=g.redMul(I),L=F.redSqr().redIAdd(N).redISub(j).redISub(j),W=F.redMul(j.redISub(L)).redISub(y.redMul(N)),K=this.z.redMul(f.z).redMul(k);return this.curve.jpoint(L,W,K)},d.prototype.mixedAdd=function(f){if(this.isInfinity())return f.toJ();if(f.isInfinity())return this;var m=this.z.redSqr(),v=this.x,g=f.x.redMul(m),w=this.y,y=f.y.redMul(m).redMul(this.z),C=v.redSub(g),k=w.redSub(y);if(C.cmpn(0)===0)return k.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var F=C.redSqr(),I=F.redMul(C),N=v.redMul(F),j=k.redSqr().redIAdd(I).redISub(N).redISub(N),L=k.redMul(N.redISub(j)).redISub(w.redMul(I)),W=this.z.redMul(C);return this.curve.jpoint(j,L,W)},d.prototype.dblp=function(f){if(f===0)return this;if(this.isInfinity())return this;if(!f)return this.dbl();var m;if(this.curve.zeroA||this.curve.threeA){var v=this;for(m=0;m<f;m++)v=v.dbl();return v}var g=this.curve.a,w=this.curve.tinv,y=this.x,C=this.y,k=this.z,F=k.redSqr().redSqr(),I=C.redAdd(C);for(m=0;m<f;m++){var N=y.redSqr(),j=I.redSqr(),L=j.redSqr(),W=N.redAdd(N).redIAdd(N).redIAdd(g.redMul(F)),K=y.redMul(j),z=W.redSqr().redISub(K.redAdd(K)),M=K.redISub(z),B=W.redMul(M);B=B.redIAdd(B).redISub(L);var R=I.redMul(k);m+1<f&&(F=F.redMul(L)),y=z,k=R,I=B}return this.curve.jpoint(y,I.redMul(w),k)},d.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},d.prototype._zeroDbl=function(){var f,m,v;if(this.zOne){var g=this.x.redSqr(),w=this.y.redSqr(),y=w.redSqr(),C=this.x.redAdd(w).redSqr().redISub(g).redISub(y);C=C.redIAdd(C);var k=g.redAdd(g).redIAdd(g),F=k.redSqr().redISub(C).redISub(C),I=y.redIAdd(y);I=(I=I.redIAdd(I)).redIAdd(I),f=F,m=k.redMul(C.redISub(F)).redISub(I),v=this.y.redAdd(this.y)}else{var N=this.x.redSqr(),j=this.y.redSqr(),L=j.redSqr(),W=this.x.redAdd(j).redSqr().redISub(N).redISub(L);W=W.redIAdd(W);var K=N.redAdd(N).redIAdd(N),z=K.redSqr(),M=L.redIAdd(L);M=(M=M.redIAdd(M)).redIAdd(M),f=z.redISub(W).redISub(W),m=K.redMul(W.redISub(f)).redISub(M),v=(v=this.y.redMul(this.z)).redIAdd(v)}return this.curve.jpoint(f,m,v)},d.prototype._threeDbl=function(){var f,m,v;if(this.zOne){var g=this.x.redSqr(),w=this.y.redSqr(),y=w.redSqr(),C=this.x.redAdd(w).redSqr().redISub(g).redISub(y);C=C.redIAdd(C);var k=g.redAdd(g).redIAdd(g).redIAdd(this.curve.a),F=k.redSqr().redISub(C).redISub(C);f=F;var I=y.redIAdd(y);I=(I=I.redIAdd(I)).redIAdd(I),m=k.redMul(C.redISub(F)).redISub(I),v=this.y.redAdd(this.y)}else{var N=this.z.redSqr(),j=this.y.redSqr(),L=this.x.redMul(j),W=this.x.redSub(N).redMul(this.x.redAdd(N));W=W.redAdd(W).redIAdd(W);var K=L.redIAdd(L),z=(K=K.redIAdd(K)).redAdd(K);f=W.redSqr().redISub(z),v=this.y.redAdd(this.z).redSqr().redISub(j).redISub(N);var M=j.redSqr();M=(M=(M=M.redIAdd(M)).redIAdd(M)).redIAdd(M),m=W.redMul(K.redISub(f)).redISub(M)}return this.curve.jpoint(f,m,v)},d.prototype._dbl=function(){var f=this.curve.a,m=this.x,v=this.y,g=this.z,w=g.redSqr().redSqr(),y=m.redSqr(),C=v.redSqr(),k=y.redAdd(y).redIAdd(y).redIAdd(f.redMul(w)),F=m.redAdd(m),I=(F=F.redIAdd(F)).redMul(C),N=k.redSqr().redISub(I.redAdd(I)),j=I.redISub(N),L=C.redSqr();L=(L=(L=L.redIAdd(L)).redIAdd(L)).redIAdd(L);var W=k.redMul(j).redISub(L),K=v.redAdd(v).redMul(g);return this.curve.jpoint(N,W,K)},d.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var f=this.x.redSqr(),m=this.y.redSqr(),v=this.z.redSqr(),g=m.redSqr(),w=f.redAdd(f).redIAdd(f),y=w.redSqr(),C=this.x.redAdd(m).redSqr().redISub(f).redISub(g),k=(C=(C=(C=C.redIAdd(C)).redAdd(C).redIAdd(C)).redISub(y)).redSqr(),F=g.redIAdd(g);F=(F=(F=F.redIAdd(F)).redIAdd(F)).redIAdd(F);var I=w.redIAdd(C).redSqr().redISub(y).redISub(k).redISub(F),N=m.redMul(I);N=(N=N.redIAdd(N)).redIAdd(N);var j=this.x.redMul(k).redISub(N);j=(j=j.redIAdd(j)).redIAdd(j);var L=this.y.redMul(I.redMul(F.redISub(I)).redISub(C.redMul(k)));L=(L=(L=L.redIAdd(L)).redIAdd(L)).redIAdd(L);var W=this.z.redAdd(C).redSqr().redISub(v).redISub(k);return this.curve.jpoint(j,L,W)},d.prototype.mul=function(f,m){return f=new o(f,m),this.curve._wnafMul(this,f)},d.prototype.eq=function(f){if(f.type==="affine")return this.eq(f.toJ());if(this===f)return!0;var m=this.z.redSqr(),v=f.z.redSqr();if(this.x.redMul(v).redISub(f.x.redMul(m)).cmpn(0)!==0)return!1;var g=m.redMul(this.z),w=v.redMul(f.z);return this.y.redMul(w).redISub(f.y.redMul(g)).cmpn(0)===0},d.prototype.eqXToP=function(f){var m=this.z.redSqr(),v=f.toRed(this.curve.red).redMul(m);if(this.x.cmp(v)===0)return!0;for(var g=f.clone(),w=this.curve.redN.redMul(m);;){if(g.iadd(this.curve.n),g.cmp(this.curve.p)>=0)return!1;if(v.redIAdd(w),this.x.cmp(v)===0)return!0}},d.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},d.prototype.isInfinity=function(){return this.z.cmpn(0)===0}},{"../utils":419,"./base":406,"bn.js":420,inherits:440}],411:[function(r,n,i){var s,o=i,a=r("hash.js"),l=r("./curve"),c=r("./utils").assert;function u(d){d.type==="short"?this.curve=new l.short(d):d.type==="edwards"?this.curve=new l.edwards(d):this.curve=new l.mont(d),this.g=this.curve.g,this.n=this.curve.n,this.hash=d.hash,c(this.g.validate(),"Invalid curve"),c(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function h(d,f){Object.defineProperty(o,d,{configurable:!0,enumerable:!0,get:function(){var m=new u(f);return Object.defineProperty(o,d,{configurable:!0,enumerable:!0,value:m}),m}})}o.PresetCurve=u,h("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:a.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),h("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:a.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),h("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:a.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),h("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:a.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),h("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:a.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),h("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:a.sha256,gRed:!1,g:["9"]}),h("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:a.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{s=r("./precomputed/secp256k1")}catch{s=void 0}h("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:a.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",s]})},{"./curve":408,"./precomputed/secp256k1":418,"./utils":419,"hash.js":426}],412:[function(r,n,i){var s=r("bn.js"),o=r("hmac-drbg"),a=r("../utils"),l=r("../curves"),c=r("brorand"),u=a.assert,h=r("./key"),d=r("./signature");function f(m){if(!(this instanceof f))return new f(m);typeof m=="string"&&(u(Object.prototype.hasOwnProperty.call(l,m),"Unknown curve "+m),m=l[m]),m instanceof l.PresetCurve&&(m={curve:m}),this.curve=m.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=m.curve.g,this.g.precompute(m.curve.n.bitLength()+1),this.hash=m.hash||m.curve.hash}n.exports=f,f.prototype.keyPair=function(m){return new h(this,m)},f.prototype.keyFromPrivate=function(m,v){return h.fromPrivate(this,m,v)},f.prototype.keyFromPublic=function(m,v){return h.fromPublic(this,m,v)},f.prototype.genKeyPair=function(m){m||(m={});for(var v=new o({hash:this.hash,pers:m.pers,persEnc:m.persEnc||"utf8",entropy:m.entropy||c(this.hash.hmacStrength),entropyEnc:m.entropy&&m.entropyEnc||"utf8",nonce:this.n.toArray()}),g=this.n.byteLength(),w=this.n.sub(new s(2));;){var y=new s(v.generate(g));if(!(y.cmp(w)>0))return y.iaddn(1),this.keyFromPrivate(y)}},f.prototype._truncateToN=function(m,v){var g=8*m.byteLength()-this.n.bitLength();return g>0&&(m=m.ushrn(g)),!v&&m.cmp(this.n)>=0?m.sub(this.n):m},f.prototype.sign=function(m,v,g,w){typeof g=="object"&&(w=g,g=null),w||(w={}),v=this.keyFromPrivate(v,g),m=this._truncateToN(new s(m,16));for(var y=this.n.byteLength(),C=v.getPrivate().toArray("be",y),k=m.toArray("be",y),F=new o({hash:this.hash,entropy:C,nonce:k,pers:w.pers,persEnc:w.persEnc||"utf8"}),I=this.n.sub(new s(1)),N=0;;N++){var j=w.k?w.k(N):new s(F.generate(this.n.byteLength()));if(!((j=this._truncateToN(j,!0)).cmpn(1)<=0||j.cmp(I)>=0)){var L=this.g.mul(j);if(!L.isInfinity()){var W=L.getX(),K=W.umod(this.n);if(K.cmpn(0)!==0){var z=j.invm(this.n).mul(K.mul(v.getPrivate()).iadd(m));if((z=z.umod(this.n)).cmpn(0)!==0){var M=(L.getY().isOdd()?1:0)|(W.cmp(K)!==0?2:0);return w.canonical&&z.cmp(this.nh)>0&&(z=this.n.sub(z),M^=1),new d({r:K,s:z,recoveryParam:M})}}}}}},f.prototype.verify=function(m,v,g,w){m=this._truncateToN(new s(m,16)),g=this.keyFromPublic(g,w);var y=(v=new d(v,"hex")).r,C=v.s;if(y.cmpn(1)<0||y.cmp(this.n)>=0||C.cmpn(1)<0||C.cmp(this.n)>=0)return!1;var k,F=C.invm(this.n),I=F.mul(m).umod(this.n),N=F.mul(y).umod(this.n);return this.curve._maxwellTrick?!(k=this.g.jmulAdd(I,g.getPublic(),N)).isInfinity()&&k.eqXToP(y):!(k=this.g.mulAdd(I,g.getPublic(),N)).isInfinity()&&k.getX().umod(this.n).cmp(y)===0},f.prototype.recoverPubKey=function(m,v,g,w){u((3&g)===g,"The recovery param is more than two bits"),v=new d(v,w);var y=this.n,C=new s(m),k=v.r,F=v.s,I=1&g,N=g>>1;if(k.cmp(this.curve.p.umod(this.curve.n))>=0&&N)throw new Error("Unable to find sencond key candinate");k=N?this.curve.pointFromX(k.add(this.curve.n),I):this.curve.pointFromX(k,I);var j=v.r.invm(y),L=y.sub(C).mul(j).umod(y),W=F.mul(j).umod(y);return this.g.mulAdd(L,k,W)},f.prototype.getKeyRecoveryParam=function(m,v,g,w){if((v=new d(v,w)).recoveryParam!==null)return v.recoveryParam;for(var y=0;y<4;y++){var C;try{C=this.recoverPubKey(m,v,y)}catch{continue}if(C.eq(g))return y}throw new Error("Unable to find valid recovery factor")}},{"../curves":411,"../utils":419,"./key":413,"./signature":414,"bn.js":420,brorand:187,"hmac-drbg":438}],413:[function(r,n,i){var s=r("bn.js"),o=r("../utils").assert;function a(l,c){this.ec=l,this.priv=null,this.pub=null,c.priv&&this._importPrivate(c.priv,c.privEnc),c.pub&&this._importPublic(c.pub,c.pubEnc)}n.exports=a,a.fromPublic=function(l,c,u){return c instanceof a?c:new a(l,{pub:c,pubEnc:u})},a.fromPrivate=function(l,c,u){return c instanceof a?c:new a(l,{priv:c,privEnc:u})},a.prototype.validate=function(){var l=this.getPublic();return l.isInfinity()?{result:!1,reason:"Invalid public key"}:l.validate()?l.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},a.prototype.getPublic=function(l,c){return typeof l=="string"&&(c=l,l=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),c?this.pub.encode(c,l):this.pub},a.prototype.getPrivate=function(l){return l==="hex"?this.priv.toString(16,2):this.priv},a.prototype._importPrivate=function(l,c){this.priv=new s(l,c||16),this.priv=this.priv.umod(this.ec.curve.n)},a.prototype._importPublic=function(l,c){if(l.x||l.y)return this.ec.curve.type==="mont"?o(l.x,"Need x coordinate"):this.ec.curve.type!=="short"&&this.ec.curve.type!=="edwards"||o(l.x&&l.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(l.x,l.y));this.pub=this.ec.curve.decodePoint(l,c)},a.prototype.derive=function(l){return l.validate()||o(l.validate(),"public point not validated"),l.mul(this.priv).getX()},a.prototype.sign=function(l,c,u){return this.ec.sign(l,this,c,u)},a.prototype.verify=function(l,c){return this.ec.verify(l,c,this)},a.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},{"../utils":419,"bn.js":420}],414:[function(r,n,i){var s=r("bn.js"),o=r("../utils"),a=o.assert;function l(f,m){if(f instanceof l)return f;this._importDER(f,m)||(a(f.r&&f.s,"Signature without r or s"),this.r=new s(f.r,16),this.s=new s(f.s,16),f.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=f.recoveryParam)}function c(){this.place=0}function u(f,m){var v=f[m.place++];if(!(128&v))return v;var g=15&v;if(g===0||g>4)return!1;for(var w=0,y=0,C=m.place;y<g;y++,C++)w<<=8,w|=f[C],w>>>=0;return!(w<=127)&&(m.place=C,w)}function h(f){for(var m=0,v=f.length-1;!f[m]&&!(128&f[m+1])&&m<v;)m++;return m===0?f:f.slice(m)}function d(f,m){if(m<128)f.push(m);else{var v=1+(Math.log(m)/Math.LN2>>>3);for(f.push(128|v);--v;)f.push(m>>>(v<<3)&255);f.push(m)}}n.exports=l,l.prototype._importDER=function(f,m){f=o.toArray(f,m);var v=new c;if(f[v.place++]!==48)return!1;var g=u(f,v);if(g===!1||g+v.place!==f.length||f[v.place++]!==2)return!1;var w=u(f,v);if(w===!1)return!1;var y=f.slice(v.place,w+v.place);if(v.place+=w,f[v.place++]!==2)return!1;var C=u(f,v);if(C===!1||f.length!==C+v.place)return!1;var k=f.slice(v.place,C+v.place);if(y[0]===0){if(!(128&y[1]))return!1;y=y.slice(1)}if(k[0]===0){if(!(128&k[1]))return!1;k=k.slice(1)}return this.r=new s(y),this.s=new s(k),this.recoveryParam=null,!0},l.prototype.toDER=function(f){var m=this.r.toArray(),v=this.s.toArray();for(128&m[0]&&(m=[0].concat(m)),128&v[0]&&(v=[0].concat(v)),m=h(m),v=h(v);!(v[0]||128&v[1]);)v=v.slice(1);var g=[2];d(g,m.length),(g=g.concat(m)).push(2),d(g,v.length);var w=g.concat(v),y=[48];return d(y,w.length),y=y.concat(w),o.encode(y,f)}},{"../utils":419,"bn.js":420}],415:[function(r,n,i){var s=r("hash.js"),o=r("../curves"),a=r("../utils"),l=a.assert,c=a.parseBytes,u=r("./key"),h=r("./signature");function d(f){if(l(f==="ed25519","only tested with ed25519 so far"),!(this instanceof d))return new d(f);f=o[f].curve,this.curve=f,this.g=f.g,this.g.precompute(f.n.bitLength()+1),this.pointClass=f.point().constructor,this.encodingLength=Math.ceil(f.n.bitLength()/8),this.hash=s.sha512}n.exports=d,d.prototype.sign=function(f,m){f=c(f);var v=this.keyFromSecret(m),g=this.hashInt(v.messagePrefix(),f),w=this.g.mul(g),y=this.encodePoint(w),C=this.hashInt(y,v.pubBytes(),f).mul(v.priv()),k=g.add(C).umod(this.curve.n);return this.makeSignature({R:w,S:k,Rencoded:y})},d.prototype.verify=function(f,m,v){f=c(f),m=this.makeSignature(m);var g=this.keyFromPublic(v),w=this.hashInt(m.Rencoded(),g.pubBytes(),f),y=this.g.mul(m.S());return m.R().add(g.pub().mul(w)).eq(y)},d.prototype.hashInt=function(){for(var f=this.hash(),m=0;m<arguments.length;m++)f.update(arguments[m]);return a.intFromLE(f.digest()).umod(this.curve.n)},d.prototype.keyFromPublic=function(f){return u.fromPublic(this,f)},d.prototype.keyFromSecret=function(f){return u.fromSecret(this,f)},d.prototype.makeSignature=function(f){return f instanceof h?f:new h(this,f)},d.prototype.encodePoint=function(f){var m=f.getY().toArray("le",this.encodingLength);return m[this.encodingLength-1]|=f.getX().isOdd()?128:0,m},d.prototype.decodePoint=function(f){var m=(f=a.parseBytes(f)).length-1,v=f.slice(0,m).concat(-129&f[m]),g=(128&f[m])!=0,w=a.intFromLE(v);return this.curve.pointFromY(w,g)},d.prototype.encodeInt=function(f){return f.toArray("le",this.encodingLength)},d.prototype.decodeInt=function(f){return a.intFromLE(f)},d.prototype.isPoint=function(f){return f instanceof this.pointClass}},{"../curves":411,"../utils":419,"./key":416,"./signature":417,"hash.js":426}],416:[function(r,n,i){var s=r("../utils"),o=s.assert,a=s.parseBytes,l=s.cachedProperty;function c(u,h){this.eddsa=u,this._secret=a(h.secret),u.isPoint(h.pub)?this._pub=h.pub:this._pubBytes=a(h.pub)}c.fromPublic=function(u,h){return h instanceof c?h:new c(u,{pub:h})},c.fromSecret=function(u,h){return h instanceof c?h:new c(u,{secret:h})},c.prototype.secret=function(){return this._secret},l(c,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),l(c,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),l(c,"privBytes",(function(){var u=this.eddsa,h=this.hash(),d=u.encodingLength-1,f=h.slice(0,u.encodingLength);return f[0]&=248,f[d]&=127,f[d]|=64,f})),l(c,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),l(c,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),l(c,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),c.prototype.sign=function(u){return o(this._secret,"KeyPair can only verify"),this.eddsa.sign(u,this)},c.prototype.verify=function(u,h){return this.eddsa.verify(u,h,this)},c.prototype.getSecret=function(u){return o(this._secret,"KeyPair is public only"),s.encode(this.secret(),u)},c.prototype.getPublic=function(u){return s.encode(this.pubBytes(),u)},n.exports=c},{"../utils":419}],417:[function(r,n,i){var s=r("bn.js"),o=r("../utils"),a=o.assert,l=o.cachedProperty,c=o.parseBytes;function u(h,d){this.eddsa=h,typeof d!="object"&&(d=c(d)),Array.isArray(d)&&(d={R:d.slice(0,h.encodingLength),S:d.slice(h.encodingLength)}),a(d.R&&d.S,"Signature without R or S"),h.isPoint(d.R)&&(this._R=d.R),d.S instanceof s&&(this._S=d.S),this._Rencoded=Array.isArray(d.R)?d.R:d.Rencoded,this._Sencoded=Array.isArray(d.S)?d.S:d.Sencoded}l(u,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),l(u,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),l(u,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),l(u,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),u.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},u.prototype.toHex=function(){return o.encode(this.toBytes(),"hex").toUpperCase()},n.exports=u},{"../utils":419,"bn.js":420}],418:[function(r,n,i){n.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},{}],419:[function(r,n,i){var s=i,o=r("bn.js"),a=r("minimalistic-assert"),l=r("minimalistic-crypto-utils");s.assert=a,s.toArray=l.toArray,s.zero2=l.zero2,s.toHex=l.toHex,s.encode=l.encode,s.getNAF=function(c,u,h){var d=new Array(Math.max(c.bitLength(),h)+1);d.fill(0);for(var f=1<<u+1,m=c.clone(),v=0;v<d.length;v++){var g,w=m.andln(f-1);m.isOdd()?(g=w>(f>>1)-1?(f>>1)-w:w,m.isubn(g)):g=0,d[v]=g,m.iushrn(1)}return d},s.getJSF=function(c,u){var h=[[],[]];c=c.clone(),u=u.clone();for(var d,f=0,m=0;c.cmpn(-f)>0||u.cmpn(-m)>0;){var v,g,w=c.andln(3)+f&3,y=u.andln(3)+m&3;w===3&&(w=-1),y===3&&(y=-1),v=(1&w)==0?0:(d=c.andln(7)+f&7)!==3&&d!==5||y!==2?w:-w,h[0].push(v),g=(1&y)==0?0:(d=u.andln(7)+m&7)!==3&&d!==5||w!==2?y:-y,h[1].push(g),2*f===v+1&&(f=1-f),2*m===g+1&&(m=1-m),c.iushrn(1),u.iushrn(1)}return h},s.cachedProperty=function(c,u,h){var d="_"+u;c.prototype[u]=function(){return this[d]!==void 0?this[d]:this[d]=h.call(this)}},s.parseBytes=function(c){return typeof c=="string"?s.toArray(c,"hex"):c},s.intFromLE=function(c){return new o(c,"hex","le")}},{"bn.js":420,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],420:[function(r,n,i){arguments[4][184][0].apply(i,arguments)},{buffer:188,dup:184}],421:[function(r,n,i){n.exports={name:"elliptic",version:"6.5.4",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}},{}],422:[function(r,n,i){var s=Object.create||function(j){var L=function(){};return L.prototype=j,new L},o=Object.keys||function(j){var L=[];for(var W in j)Object.prototype.hasOwnProperty.call(j,W)&&L.push(W);return W},a=Function.prototype.bind||function(j){var L=this;return function(){return L.apply(j,arguments)}};function l(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=s(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}n.exports=l,l.EventEmitter=l,l.prototype._events=void 0,l.prototype._maxListeners=void 0;var c,u=10;try{var h={};Object.defineProperty&&Object.defineProperty(h,"x",{value:0}),c=h.x===0}catch{c=!1}function d(j){return j._maxListeners===void 0?l.defaultMaxListeners:j._maxListeners}function f(j,L,W){if(L)j.call(W);else for(var K=j.length,z=N(j,K),M=0;M<K;++M)z[M].call(W)}function m(j,L,W,K){if(L)j.call(W,K);else for(var z=j.length,M=N(j,z),B=0;B<z;++B)M[B].call(W,K)}function v(j,L,W,K,z){if(L)j.call(W,K,z);else for(var M=j.length,B=N(j,M),R=0;R<M;++R)B[R].call(W,K,z)}function g(j,L,W,K,z,M){if(L)j.call(W,K,z,M);else for(var B=j.length,R=N(j,B),S=0;S<B;++S)R[S].call(W,K,z,M)}function w(j,L,W,K){if(L)j.apply(W,K);else for(var z=j.length,M=N(j,z),B=0;B<z;++B)M[B].apply(W,K)}function y(j,L,W,K){var z,M,B;if(typeof W!="function")throw new TypeError('"listener" argument must be a function');if((M=j._events)?(M.newListener&&(j.emit("newListener",L,W.listener?W.listener:W),M=j._events),B=M[L]):(M=j._events=s(null),j._eventsCount=0),B){if(typeof B=="function"?B=M[L]=K?[W,B]:[B,W]:K?B.unshift(W):B.push(W),!B.warned&&(z=d(j))&&z>0&&B.length>z){B.warned=!0;var R=new Error("Possible EventEmitter memory leak detected. "+B.length+' "'+String(L)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');R.name="MaxListenersExceededWarning",R.emitter=j,R.type=L,R.count=B.length,typeof console=="object"&&console.warn&&console.warn("%s: %s",R.name,R.message)}}else B=M[L]=W,++j._eventsCount;return j}function C(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var j=new Array(arguments.length),L=0;L<j.length;++L)j[L]=arguments[L];this.listener.apply(this.target,j)}}function k(j,L,W){var K={fired:!1,wrapFn:void 0,target:j,type:L,listener:W},z=a.call(C,K);return z.listener=W,K.wrapFn=z,z}function F(j,L,W){var K=j._events;if(!K)return[];var z=K[L];return z?typeof z=="function"?W?[z.listener||z]:[z]:W?(function(M){for(var B=new Array(M.length),R=0;R<B.length;++R)B[R]=M[R].listener||M[R];return B})(z):N(z,z.length):[]}function I(j){var L=this._events;if(L){var W=L[j];if(typeof W=="function")return 1;if(W)return W.length}return 0}function N(j,L){for(var W=new Array(L),K=0;K<L;++K)W[K]=j[K];return W}c?Object.defineProperty(l,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(j){if(typeof j!="number"||j<0||j!=j)throw new TypeError('"defaultMaxListeners" must be a positive number');u=j}}):l.defaultMaxListeners=u,l.prototype.setMaxListeners=function(j){if(typeof j!="number"||j<0||isNaN(j))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=j,this},l.prototype.getMaxListeners=function(){return d(this)},l.prototype.emit=function(j){var L,W,K,z,M,B,R=j==="error";if(B=this._events)R=R&&B.error==null;else if(!R)return!1;if(R){if(arguments.length>1&&(L=arguments[1]),L instanceof Error)throw L;var S=new Error('Unhandled "error" event. ('+L+")");throw S.context=L,S}if(!(W=B[j]))return!1;var _=typeof W=="function";switch(K=arguments.length){case 1:f(W,_,this);break;case 2:m(W,_,this,arguments[1]);break;case 3:v(W,_,this,arguments[1],arguments[2]);break;case 4:g(W,_,this,arguments[1],arguments[2],arguments[3]);break;default:for(z=new Array(K-1),M=1;M<K;M++)z[M-1]=arguments[M];w(W,_,this,z)}return!0},l.prototype.addListener=function(j,L){return y(this,j,L,!1)},l.prototype.on=l.prototype.addListener,l.prototype.prependListener=function(j,L){return y(this,j,L,!0)},l.prototype.once=function(j,L){if(typeof L!="function")throw new TypeError('"listener" argument must be a function');return this.on(j,k(this,j,L)),this},l.prototype.prependOnceListener=function(j,L){if(typeof L!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(j,k(this,j,L)),this},l.prototype.removeListener=function(j,L){var W,K,z,M,B;if(typeof L!="function")throw new TypeError('"listener" argument must be a function');if(!(K=this._events))return this;if(!(W=K[j]))return this;if(W===L||W.listener===L)--this._eventsCount==0?this._events=s(null):(delete K[j],K.removeListener&&this.emit("removeListener",j,W.listener||L));else if(typeof W!="function"){for(z=-1,M=W.length-1;M>=0;M--)if(W[M]===L||W[M].listener===L){B=W[M].listener,z=M;break}if(z<0)return this;z===0?W.shift():(function(R,S){for(var _=S,T=_+1,E=R.length;T<E;_+=1,T+=1)R[_]=R[T];R.pop()})(W,z),W.length===1&&(K[j]=W[0]),K.removeListener&&this.emit("removeListener",j,B||L)}return this},l.prototype.removeAllListeners=function(j){var L,W,K;if(!(W=this._events))return this;if(!W.removeListener)return arguments.length===0?(this._events=s(null),this._eventsCount=0):W[j]&&(--this._eventsCount==0?this._events=s(null):delete W[j]),this;if(arguments.length===0){var z,M=o(W);for(K=0;K<M.length;++K)(z=M[K])!=="removeListener"&&this.removeAllListeners(z);return this.removeAllListeners("removeListener"),this._events=s(null),this._eventsCount=0,this}if(typeof(L=W[j])=="function")this.removeListener(j,L);else if(L)for(K=L.length-1;K>=0;K--)this.removeListener(j,L[K]);return this},l.prototype.listeners=function(j){return F(this,j,!0)},l.prototype.rawListeners=function(j){return F(this,j,!1)},l.listenerCount=function(j,L){return typeof j.listenerCount=="function"?j.listenerCount(L):I.call(j,L)},l.prototype.listenerCount=I,l.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],423:[function(r,n,i){var s=r("safe-buffer").Buffer,o=r("md5.js");n.exports=function(a,l,c,u){if(s.isBuffer(a)||(a=s.from(a,"binary")),l&&(s.isBuffer(l)||(l=s.from(l,"binary")),l.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var h=c/8,d=s.alloc(h),f=s.alloc(u||0),m=s.alloc(0);h>0||u>0;){var v=new o;v.update(m),v.update(a),l&&v.update(l),m=v.digest();var g=0;if(h>0){var w=d.length-h;g=Math.min(h,m.length),m.copy(d,w,0,g),h-=g}if(g<m.length&&u>0){var y=f.length-u,C=Math.min(u,m.length-g);m.copy(f,y,g,g+C),u-=C}}return m.fill(0),{key:d,iv:f}}},{"md5.js":450,"safe-buffer":494}],424:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CsvParserStream=i.ParserOptions=i.parseFile=i.parseStream=i.parseString=i.parse=i.FormatterOptions=i.CsvFormatterStream=i.writeToPath=i.writeToString=i.writeToBuffer=i.writeToStream=i.write=i.format=void 0;var s=r("@fast-csv/format");Object.defineProperty(i,"format",{enumerable:!0,get:function(){return s.format}}),Object.defineProperty(i,"write",{enumerable:!0,get:function(){return s.write}}),Object.defineProperty(i,"writeToStream",{enumerable:!0,get:function(){return s.writeToStream}}),Object.defineProperty(i,"writeToBuffer",{enumerable:!0,get:function(){return s.writeToBuffer}}),Object.defineProperty(i,"writeToString",{enumerable:!0,get:function(){return s.writeToString}}),Object.defineProperty(i,"writeToPath",{enumerable:!0,get:function(){return s.writeToPath}}),Object.defineProperty(i,"CsvFormatterStream",{enumerable:!0,get:function(){return s.CsvFormatterStream}}),Object.defineProperty(i,"FormatterOptions",{enumerable:!0,get:function(){return s.FormatterOptions}});var o=r("@fast-csv/parse");Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return o.parse}}),Object.defineProperty(i,"parseString",{enumerable:!0,get:function(){return o.parseString}}),Object.defineProperty(i,"parseStream",{enumerable:!0,get:function(){return o.parseStream}}),Object.defineProperty(i,"parseFile",{enumerable:!0,get:function(){return o.parseFile}}),Object.defineProperty(i,"ParserOptions",{enumerable:!0,get:function(){return o.ParserOptions}}),Object.defineProperty(i,"CsvParserStream",{enumerable:!0,get:function(){return o.CsvParserStream}})},{"@fast-csv/format":151,"@fast-csv/parse":155}],425:[function(r,n,i){var s=r("safe-buffer").Buffer,o=r("readable-stream").Transform;function a(l){o.call(this),this._block=s.allocUnsafe(l),this._blockSize=l,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}r("inherits")(a,o),a.prototype._transform=function(l,c,u){var h=null;try{this.update(l,c)}catch(d){h=d}u(h)},a.prototype._flush=function(l){var c=null;try{this.push(this.digest())}catch(u){c=u}l(c)},a.prototype.update=function(l,c){if((function(v,g){if(!s.isBuffer(v)&&typeof v!="string")throw new TypeError(g+" must be a string or a buffer")})(l,"Data"),this._finalized)throw new Error("Digest already called");s.isBuffer(l)||(l=s.from(l,c));for(var u=this._block,h=0;this._blockOffset+l.length-h>=this._blockSize;){for(var d=this._blockOffset;d<this._blockSize;)u[d++]=l[h++];this._update(),this._blockOffset=0}for(;h<l.length;)u[this._blockOffset++]=l[h++];for(var f=0,m=8*l.length;m>0;++f)this._length[f]+=m,(m=this._length[f]/4294967296|0)>0&&(this._length[f]-=4294967296*m);return this},a.prototype._update=function(){throw new Error("_update is not implemented")},a.prototype.digest=function(l){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var c=this._digest();l!==void 0&&(c=c.toString(l)),this._block.fill(0),this._blockOffset=0;for(var u=0;u<4;++u)this._length[u]=0;return c},a.prototype._digest=function(){throw new Error("_digest is not implemented")},n.exports=a},{inherits:440,"readable-stream":491,"safe-buffer":494}],426:[function(r,n,i){var s=i;s.utils=r("./hash/utils"),s.common=r("./hash/common"),s.sha=r("./hash/sha"),s.ripemd=r("./hash/ripemd"),s.hmac=r("./hash/hmac"),s.sha1=s.sha.sha1,s.sha256=s.sha.sha256,s.sha224=s.sha.sha224,s.sha384=s.sha.sha384,s.sha512=s.sha.sha512,s.ripemd160=s.ripemd.ripemd160},{"./hash/common":427,"./hash/hmac":428,"./hash/ripemd":429,"./hash/sha":430,"./hash/utils":437}],427:[function(r,n,i){var s=r("./utils"),o=r("minimalistic-assert");function a(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}i.BlockHash=a,a.prototype.update=function(l,c){if(l=s.toArray(l,c),this.pending?this.pending=this.pending.concat(l):this.pending=l,this.pendingTotal+=l.length,this.pending.length>=this._delta8){var u=(l=this.pending).length%this._delta8;this.pending=l.slice(l.length-u,l.length),this.pending.length===0&&(this.pending=null),l=s.join32(l,0,l.length-u,this.endian);for(var h=0;h<l.length;h+=this._delta32)this._update(l,h,h+this._delta32)}return this},a.prototype.digest=function(l){return this.update(this._pad()),o(this.pending===null),this._digest(l)},a.prototype._pad=function(){var l=this.pendingTotal,c=this._delta8,u=c-(l+this.padLength)%c,h=new Array(u+this.padLength);h[0]=128;for(var d=1;d<u;d++)h[d]=0;if(l<<=3,this.endian==="big"){for(var f=8;f<this.padLength;f++)h[d++]=0;h[d++]=0,h[d++]=0,h[d++]=0,h[d++]=0,h[d++]=l>>>24&255,h[d++]=l>>>16&255,h[d++]=l>>>8&255,h[d++]=255&l}else for(h[d++]=255&l,h[d++]=l>>>8&255,h[d++]=l>>>16&255,h[d++]=l>>>24&255,h[d++]=0,h[d++]=0,h[d++]=0,h[d++]=0,f=8;f<this.padLength;f++)h[d++]=0;return h}},{"./utils":437,"minimalistic-assert":453}],428:[function(r,n,i){var s=r("./utils"),o=r("minimalistic-assert");function a(l,c,u){if(!(this instanceof a))return new a(l,c,u);this.Hash=l,this.blockSize=l.blockSize/8,this.outSize=l.outSize/8,this.inner=null,this.outer=null,this._init(s.toArray(c,u))}n.exports=a,a.prototype._init=function(l){l.length>this.blockSize&&(l=new this.Hash().update(l).digest()),o(l.length<=this.blockSize);for(var c=l.length;c<this.blockSize;c++)l.push(0);for(c=0;c<l.length;c++)l[c]^=54;for(this.inner=new this.Hash().update(l),c=0;c<l.length;c++)l[c]^=106;this.outer=new this.Hash().update(l)},a.prototype.update=function(l,c){return this.inner.update(l,c),this},a.prototype.digest=function(l){return this.outer.update(this.inner.digest()),this.outer.digest(l)}},{"./utils":437,"minimalistic-assert":453}],429:[function(r,n,i){var s=r("./utils"),o=r("./common"),a=s.rotl32,l=s.sum32,c=s.sum32_3,u=s.sum32_4,h=o.BlockHash;function d(){if(!(this instanceof d))return new d;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function f(k,F,I,N){return k<=15?F^I^N:k<=31?F&I|~F&N:k<=47?(F|~I)^N:k<=63?F&N|I&~N:F^(I|~N)}function m(k){return k<=15?0:k<=31?1518500249:k<=47?1859775393:k<=63?2400959708:2840853838}function v(k){return k<=15?1352829926:k<=31?1548603684:k<=47?1836072691:k<=63?2053994217:0}s.inherits(d,h),i.ripemd160=d,d.blockSize=512,d.outSize=160,d.hmacStrength=192,d.padLength=64,d.prototype._update=function(k,F){for(var I=this.h[0],N=this.h[1],j=this.h[2],L=this.h[3],W=this.h[4],K=I,z=N,M=j,B=L,R=W,S=0;S<80;S++){var _=l(a(u(I,f(S,N,j,L),k[g[S]+F],m(S)),y[S]),W);I=W,W=L,L=a(j,10),j=N,N=_,_=l(a(u(K,f(79-S,z,M,B),k[w[S]+F],v(S)),C[S]),R),K=R,R=B,B=a(M,10),M=z,z=_}_=c(this.h[1],j,B),this.h[1]=c(this.h[2],L,R),this.h[2]=c(this.h[3],W,K),this.h[3]=c(this.h[4],I,z),this.h[4]=c(this.h[0],N,M),this.h[0]=_},d.prototype._digest=function(k){return k==="hex"?s.toHex32(this.h,"little"):s.split32(this.h,"little")};var g=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],w=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],y=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],C=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},{"./common":427,"./utils":437}],430:[function(r,n,i){i.sha1=r("./sha/1"),i.sha224=r("./sha/224"),i.sha256=r("./sha/256"),i.sha384=r("./sha/384"),i.sha512=r("./sha/512")},{"./sha/1":431,"./sha/224":432,"./sha/256":433,"./sha/384":434,"./sha/512":435}],431:[function(r,n,i){var s=r("../utils"),o=r("../common"),a=r("./common"),l=s.rotl32,c=s.sum32,u=s.sum32_5,h=a.ft_1,d=o.BlockHash,f=[1518500249,1859775393,2400959708,3395469782];function m(){if(!(this instanceof m))return new m;d.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}s.inherits(m,d),n.exports=m,m.blockSize=512,m.outSize=160,m.hmacStrength=80,m.padLength=64,m.prototype._update=function(v,g){for(var w=this.W,y=0;y<16;y++)w[y]=v[g+y];for(;y<w.length;y++)w[y]=l(w[y-3]^w[y-8]^w[y-14]^w[y-16],1);var C=this.h[0],k=this.h[1],F=this.h[2],I=this.h[3],N=this.h[4];for(y=0;y<w.length;y++){var j=~~(y/20),L=u(l(C,5),h(j,k,F,I),N,w[y],f[j]);N=I,I=F,F=l(k,30),k=C,C=L}this.h[0]=c(this.h[0],C),this.h[1]=c(this.h[1],k),this.h[2]=c(this.h[2],F),this.h[3]=c(this.h[3],I),this.h[4]=c(this.h[4],N)},m.prototype._digest=function(v){return v==="hex"?s.toHex32(this.h,"big"):s.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436}],432:[function(r,n,i){var s=r("../utils"),o=r("./256");function a(){if(!(this instanceof a))return new a;o.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}s.inherits(a,o),n.exports=a,a.blockSize=512,a.outSize=224,a.hmacStrength=192,a.padLength=64,a.prototype._digest=function(l){return l==="hex"?s.toHex32(this.h.slice(0,7),"big"):s.split32(this.h.slice(0,7),"big")}},{"../utils":437,"./256":433}],433:[function(r,n,i){var s=r("../utils"),o=r("../common"),a=r("./common"),l=r("minimalistic-assert"),c=s.sum32,u=s.sum32_4,h=s.sum32_5,d=a.ch32,f=a.maj32,m=a.s0_256,v=a.s1_256,g=a.g0_256,w=a.g1_256,y=o.BlockHash,C=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function k(){if(!(this instanceof k))return new k;y.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=C,this.W=new Array(64)}s.inherits(k,y),n.exports=k,k.blockSize=512,k.outSize=256,k.hmacStrength=192,k.padLength=64,k.prototype._update=function(F,I){for(var N=this.W,j=0;j<16;j++)N[j]=F[I+j];for(;j<N.length;j++)N[j]=u(w(N[j-2]),N[j-7],g(N[j-15]),N[j-16]);var L=this.h[0],W=this.h[1],K=this.h[2],z=this.h[3],M=this.h[4],B=this.h[5],R=this.h[6],S=this.h[7];for(l(this.k.length===N.length),j=0;j<N.length;j++){var _=h(S,v(M),d(M,B,R),this.k[j],N[j]),T=c(m(L),f(L,W,K));S=R,R=B,B=M,M=c(z,_),z=K,K=W,W=L,L=c(_,T)}this.h[0]=c(this.h[0],L),this.h[1]=c(this.h[1],W),this.h[2]=c(this.h[2],K),this.h[3]=c(this.h[3],z),this.h[4]=c(this.h[4],M),this.h[5]=c(this.h[5],B),this.h[6]=c(this.h[6],R),this.h[7]=c(this.h[7],S)},k.prototype._digest=function(F){return F==="hex"?s.toHex32(this.h,"big"):s.split32(this.h,"big")}},{"../common":427,"../utils":437,"./common":436,"minimalistic-assert":453}],434:[function(r,n,i){var s=r("../utils"),o=r("./512");function a(){if(!(this instanceof a))return new a;o.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}s.inherits(a,o),n.exports=a,a.blockSize=1024,a.outSize=384,a.hmacStrength=192,a.padLength=128,a.prototype._digest=function(l){return l==="hex"?s.toHex32(this.h.slice(0,12),"big"):s.split32(this.h.slice(0,12),"big")}},{"../utils":437,"./512":435}],435:[function(r,n,i){var s=r("../utils"),o=r("../common"),a=r("minimalistic-assert"),l=s.rotr64_hi,c=s.rotr64_lo,u=s.shr64_hi,h=s.shr64_lo,d=s.sum64,f=s.sum64_hi,m=s.sum64_lo,v=s.sum64_4_hi,g=s.sum64_4_lo,w=s.sum64_5_hi,y=s.sum64_5_lo,C=o.BlockHash,k=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function F(){if(!(this instanceof F))return new F;C.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=k,this.W=new Array(160)}function I(T,E,D,O,P){var q=T&D^~T&P;return q<0&&(q+=4294967296),q}function N(T,E,D,O,P,q){var X=E&O^~E&q;return X<0&&(X+=4294967296),X}function j(T,E,D,O,P){var q=T&D^T&P^D&P;return q<0&&(q+=4294967296),q}function L(T,E,D,O,P,q){var X=E&O^E&q^O&q;return X<0&&(X+=4294967296),X}function W(T,E){var D=l(T,E,28)^l(E,T,2)^l(E,T,7);return D<0&&(D+=4294967296),D}function K(T,E){var D=c(T,E,28)^c(E,T,2)^c(E,T,7);return D<0&&(D+=4294967296),D}function z(T,E){var D=l(T,E,14)^l(T,E,18)^l(E,T,9);return D<0&&(D+=4294967296),D}function M(T,E){var D=c(T,E,14)^c(T,E,18)^c(E,T,9);return D<0&&(D+=4294967296),D}function B(T,E){var D=l(T,E,1)^l(T,E,8)^u(T,E,7);return D<0&&(D+=4294967296),D}function R(T,E){var D=c(T,E,1)^c(T,E,8)^h(T,E,7);return D<0&&(D+=4294967296),D}function S(T,E){var D=l(T,E,19)^l(E,T,29)^u(T,E,6);return D<0&&(D+=4294967296),D}function _(T,E){var D=c(T,E,19)^c(E,T,29)^h(T,E,6);return D<0&&(D+=4294967296),D}s.inherits(F,C),n.exports=F,F.blockSize=1024,F.outSize=512,F.hmacStrength=192,F.padLength=128,F.prototype._prepareBlock=function(T,E){for(var D=this.W,O=0;O<32;O++)D[O]=T[E+O];for(;O<D.length;O+=2){var P=S(D[O-4],D[O-3]),q=_(D[O-4],D[O-3]),X=D[O-14],Q=D[O-13],G=B(D[O-30],D[O-29]),ee=R(D[O-30],D[O-29]),V=D[O-32],H=D[O-31];D[O]=v(P,q,X,Q,G,ee,V,H),D[O+1]=g(P,q,X,Q,G,ee,V,H)}},F.prototype._update=function(T,E){this._prepareBlock(T,E);var D=this.W,O=this.h[0],P=this.h[1],q=this.h[2],X=this.h[3],Q=this.h[4],G=this.h[5],ee=this.h[6],V=this.h[7],H=this.h[8],Z=this.h[9],ie=this.h[10],te=this.h[11],oe=this.h[12],ue=this.h[13],Ce=this.h[14],ye=this.h[15];a(this.k.length===D.length);for(var ne=0;ne<D.length;ne+=2){var me=Ce,ve=ye,Te=z(H,Z),xe=M(H,Z),Fe=I(H,Z,ie,te,oe),Ge=N(H,Z,ie,te,oe,ue),Ve=this.k[ne],Ye=this.k[ne+1],ut=D[ne],ht=D[ne+1],be=w(me,ve,Te,xe,Fe,Ge,Ve,Ye,ut,ht),ze=y(me,ve,Te,xe,Fe,Ge,Ve,Ye,ut,ht);me=W(O,P),ve=K(O,P),Te=j(O,P,q,X,Q),xe=L(O,P,q,X,Q,G);var we=f(me,ve,Te,xe),Ee=m(me,ve,Te,xe);Ce=oe,ye=ue,oe=ie,ue=te,ie=H,te=Z,H=f(ee,V,be,ze),Z=m(V,V,be,ze),ee=Q,V=G,Q=q,G=X,q=O,X=P,O=f(be,ze,we,Ee),P=m(be,ze,we,Ee)}d(this.h,0,O,P),d(this.h,2,q,X),d(this.h,4,Q,G),d(this.h,6,ee,V),d(this.h,8,H,Z),d(this.h,10,ie,te),d(this.h,12,oe,ue),d(this.h,14,Ce,ye)},F.prototype._digest=function(T){return T==="hex"?s.toHex32(this.h,"big"):s.split32(this.h,"big")}},{"../common":427,"../utils":437,"minimalistic-assert":453}],436:[function(r,n,i){var s=r("../utils").rotr32;function o(c,u,h){return c&u^~c&h}function a(c,u,h){return c&u^c&h^u&h}function l(c,u,h){return c^u^h}i.ft_1=function(c,u,h,d){return c===0?o(u,h,d):c===1||c===3?l(u,h,d):c===2?a(u,h,d):void 0},i.ch32=o,i.maj32=a,i.p32=l,i.s0_256=function(c){return s(c,2)^s(c,13)^s(c,22)},i.s1_256=function(c){return s(c,6)^s(c,11)^s(c,25)},i.g0_256=function(c){return s(c,7)^s(c,18)^c>>>3},i.g1_256=function(c){return s(c,17)^s(c,19)^c>>>10}},{"../utils":437}],437:[function(r,n,i){var s=r("minimalistic-assert"),o=r("inherits");function a(h,d){return(64512&h.charCodeAt(d))==55296&&!(d<0||d+1>=h.length)&&(64512&h.charCodeAt(d+1))==56320}function l(h){return(h>>>24|h>>>8&65280|h<<8&16711680|(255&h)<<24)>>>0}function c(h){return h.length===1?"0"+h:h}function u(h){return h.length===7?"0"+h:h.length===6?"00"+h:h.length===5?"000"+h:h.length===4?"0000"+h:h.length===3?"00000"+h:h.length===2?"000000"+h:h.length===1?"0000000"+h:h}i.inherits=o,i.toArray=function(h,d){if(Array.isArray(h))return h.slice();if(!h)return[];var f=[];if(typeof h=="string")if(d){if(d==="hex")for((h=h.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(h="0"+h),v=0;v<h.length;v+=2)f.push(parseInt(h[v]+h[v+1],16))}else for(var m=0,v=0;v<h.length;v++){var g=h.charCodeAt(v);g<128?f[m++]=g:g<2048?(f[m++]=g>>6|192,f[m++]=63&g|128):a(h,v)?(g=65536+((1023&g)<<10)+(1023&h.charCodeAt(++v)),f[m++]=g>>18|240,f[m++]=g>>12&63|128,f[m++]=g>>6&63|128,f[m++]=63&g|128):(f[m++]=g>>12|224,f[m++]=g>>6&63|128,f[m++]=63&g|128)}else for(v=0;v<h.length;v++)f[v]=0|h[v];return f},i.toHex=function(h){for(var d="",f=0;f<h.length;f++)d+=c(h[f].toString(16));return d},i.htonl=l,i.toHex32=function(h,d){for(var f="",m=0;m<h.length;m++){var v=h[m];d==="little"&&(v=l(v)),f+=u(v.toString(16))}return f},i.zero2=c,i.zero8=u,i.join32=function(h,d,f,m){var v=f-d;s(v%4==0);for(var g=new Array(v/4),w=0,y=d;w<g.length;w++,y+=4){var C;C=m==="big"?h[y]<<24|h[y+1]<<16|h[y+2]<<8|h[y+3]:h[y+3]<<24|h[y+2]<<16|h[y+1]<<8|h[y],g[w]=C>>>0}return g},i.split32=function(h,d){for(var f=new Array(4*h.length),m=0,v=0;m<h.length;m++,v+=4){var g=h[m];d==="big"?(f[v]=g>>>24,f[v+1]=g>>>16&255,f[v+2]=g>>>8&255,f[v+3]=255&g):(f[v+3]=g>>>24,f[v+2]=g>>>16&255,f[v+1]=g>>>8&255,f[v]=255&g)}return f},i.rotr32=function(h,d){return h>>>d|h<<32-d},i.rotl32=function(h,d){return h<<d|h>>>32-d},i.sum32=function(h,d){return h+d>>>0},i.sum32_3=function(h,d,f){return h+d+f>>>0},i.sum32_4=function(h,d,f,m){return h+d+f+m>>>0},i.sum32_5=function(h,d,f,m,v){return h+d+f+m+v>>>0},i.sum64=function(h,d,f,m){var v=h[d],g=m+h[d+1]>>>0,w=(g<m?1:0)+f+v;h[d]=w>>>0,h[d+1]=g},i.sum64_hi=function(h,d,f,m){return(d+m>>>0<d?1:0)+h+f>>>0},i.sum64_lo=function(h,d,f,m){return d+m>>>0},i.sum64_4_hi=function(h,d,f,m,v,g,w,y){var C=0,k=d;return C+=(k=k+m>>>0)<d?1:0,C+=(k=k+g>>>0)<g?1:0,h+f+v+w+(C+=(k=k+y>>>0)<y?1:0)>>>0},i.sum64_4_lo=function(h,d,f,m,v,g,w,y){return d+m+g+y>>>0},i.sum64_5_hi=function(h,d,f,m,v,g,w,y,C,k){var F=0,I=d;return F+=(I=I+m>>>0)<d?1:0,F+=(I=I+g>>>0)<g?1:0,F+=(I=I+y>>>0)<y?1:0,h+f+v+w+C+(F+=(I=I+k>>>0)<k?1:0)>>>0},i.sum64_5_lo=function(h,d,f,m,v,g,w,y,C,k){return d+m+g+y+k>>>0},i.rotr64_hi=function(h,d,f){return(d<<32-f|h>>>f)>>>0},i.rotr64_lo=function(h,d,f){return(h<<32-f|d>>>f)>>>0},i.shr64_hi=function(h,d,f){return h>>>f},i.shr64_lo=function(h,d,f){return(h<<32-f|d>>>f)>>>0}},{inherits:440,"minimalistic-assert":453}],438:[function(r,n,i){var s=r("hash.js"),o=r("minimalistic-crypto-utils"),a=r("minimalistic-assert");function l(c){if(!(this instanceof l))return new l(c);this.hash=c.hash,this.predResist=!!c.predResist,this.outLen=this.hash.outSize,this.minEntropy=c.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var u=o.toArray(c.entropy,c.entropyEnc||"hex"),h=o.toArray(c.nonce,c.nonceEnc||"hex"),d=o.toArray(c.pers,c.persEnc||"hex");a(u.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(u,h,d)}n.exports=l,l.prototype._init=function(c,u,h){var d=c.concat(u).concat(h);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var f=0;f<this.V.length;f++)this.K[f]=0,this.V[f]=1;this._update(d),this._reseed=1,this.reseedInterval=281474976710656},l.prototype._hmac=function(){return new s.hmac(this.hash,this.K)},l.prototype._update=function(c){var u=this._hmac().update(this.V).update([0]);c&&(u=u.update(c)),this.K=u.digest(),this.V=this._hmac().update(this.V).digest(),c&&(this.K=this._hmac().update(this.V).update([1]).update(c).digest(),this.V=this._hmac().update(this.V).digest())},l.prototype.reseed=function(c,u,h,d){typeof u!="string"&&(d=h,h=u,u=null),c=o.toArray(c,u),h=o.toArray(h,d),a(c.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(c.concat(h||[])),this._reseed=1},l.prototype.generate=function(c,u,h,d){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof u!="string"&&(d=h,h=u,u=null),h&&(h=o.toArray(h,d||"hex"),this._update(h));for(var f=[];f.length<c;)this.V=this._hmac().update(this.V).digest(),f=f.concat(this.V);var m=f.slice(0,c);return this._update(h),this._reseed++,o.encode(m,u)}},{"hash.js":426,"minimalistic-assert":453,"minimalistic-crypto-utils":454}],439:[function(r,n,i){i.read=function(s,o,a,l,c){var u,h,d=8*c-l-1,f=(1<<d)-1,m=f>>1,v=-7,g=a?c-1:0,w=a?-1:1,y=s[o+g];for(g+=w,u=y&(1<<-v)-1,y>>=-v,v+=d;v>0;u=256*u+s[o+g],g+=w,v-=8);for(h=u&(1<<-v)-1,u>>=-v,v+=l;v>0;h=256*h+s[o+g],g+=w,v-=8);if(u===0)u=1-m;else{if(u===f)return h?NaN:1/0*(y?-1:1);h+=Math.pow(2,l),u-=m}return(y?-1:1)*h*Math.pow(2,u-l)},i.write=function(s,o,a,l,c,u){var h,d,f,m=8*u-c-1,v=(1<<m)-1,g=v>>1,w=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=l?0:u-1,C=l?1:-1,k=o<0||o===0&&1/o<0?1:0;for(o=Math.abs(o),isNaN(o)||o===1/0?(d=isNaN(o)?1:0,h=v):(h=Math.floor(Math.log(o)/Math.LN2),o*(f=Math.pow(2,-h))<1&&(h--,f*=2),(o+=h+g>=1?w/f:w*Math.pow(2,1-g))*f>=2&&(h++,f/=2),h+g>=v?(d=0,h=v):h+g>=1?(d=(o*f-1)*Math.pow(2,c),h+=g):(d=o*Math.pow(2,g-1)*Math.pow(2,c),h=0));c>=8;s[a+y]=255&d,y+=C,d/=256,c-=8);for(h=h<<c|d,m+=c;m>0;s[a+y]=255&h,y+=C,h/=256,m-=8);s[a+y-C]|=128*k}},{}],440:[function(r,n,i){typeof Object.create=="function"?n.exports=function(s,o){o&&(s.super_=o,s.prototype=Object.create(o.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}))}:n.exports=function(s,o){if(o){s.super_=o;var a=function(){};a.prototype=o.prototype,s.prototype=new a,s.prototype.constructor=s}}},{}],441:[function(r,n,i){(function(s,o,a,l,c,u,h,d){(function(){(function(f){typeof i=="object"&&n!==void 0?n.exports=f():(typeof window<"u"?window:o!==void 0?o:typeof self<"u"?self:this).JSZip=f()})((function(){return(function f(m,v,g){function w(k,F){if(!v[k]){if(!m[k]){var I=typeof r=="function"&&r;if(!F&&I)return I(k,!0);if(y)return y(k,!0);var N=new Error("Cannot find module '"+k+"'");throw N.code="MODULE_NOT_FOUND",N}var j=v[k]={exports:{}};m[k][0].call(j.exports,(function(L){return w(m[k][1][L]||L)}),j,j.exports,f,m,v,g)}return v[k].exports}for(var y=typeof r=="function"&&r,C=0;C<g.length;C++)w(g[C]);return w})({1:[function(f,m,v){var g=f("./utils"),w=f("./support"),y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";v.encode=function(C){for(var k,F,I,N,j,L,W,K=[],z=0,M=C.length,B=M,R=g.getTypeOf(C)!=="string";z<C.length;)B=M-z,I=R?(k=C[z++],F=z<M?C[z++]:0,z<M?C[z++]:0):(k=C.charCodeAt(z++),F=z<M?C.charCodeAt(z++):0,z<M?C.charCodeAt(z++):0),N=k>>2,j=(3&k)<<4|F>>4,L=1<B?(15&F)<<2|I>>6:64,W=2<B?63&I:64,K.push(y.charAt(N)+y.charAt(j)+y.charAt(L)+y.charAt(W));return K.join("")},v.decode=function(C){var k,F,I,N,j,L,W=0,K=0,z="data:";if(C.substr(0,z.length)===z)throw new Error("Invalid base64 input, it looks like a data url.");var M,B=3*(C=C.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(C.charAt(C.length-1)===y.charAt(64)&&B--,C.charAt(C.length-2)===y.charAt(64)&&B--,B%1!=0)throw new Error("Invalid base64 input, bad content length.");for(M=w.uint8array?new Uint8Array(0|B):new Array(0|B);W<C.length;)k=y.indexOf(C.charAt(W++))<<2|(N=y.indexOf(C.charAt(W++)))>>4,F=(15&N)<<4|(j=y.indexOf(C.charAt(W++)))>>2,I=(3&j)<<6|(L=y.indexOf(C.charAt(W++))),M[K++]=k,j!==64&&(M[K++]=F),L!==64&&(M[K++]=I);return M}},{"./support":30,"./utils":32}],2:[function(f,m,v){var g=f("./external"),w=f("./stream/DataWorker"),y=f("./stream/Crc32Probe"),C=f("./stream/DataLengthProbe");function k(F,I,N,j,L){this.compressedSize=F,this.uncompressedSize=I,this.crc32=N,this.compression=j,this.compressedContent=L}k.prototype={getContentWorker:function(){var F=new w(g.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new C("data_length")),I=this;return F.on("end",(function(){if(this.streamInfo.data_length!==I.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),F},getCompressedWorker:function(){return new w(g.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},k.createWorkerFrom=function(F,I,N){return F.pipe(new y).pipe(new C("uncompressedSize")).pipe(I.compressWorker(N)).pipe(new C("compressedSize")).withStreamInfo("compression",I)},m.exports=k},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(f,m,v){var g=f("./stream/GenericWorker");v.STORE={magic:"\0\0",compressWorker:function(){return new g("STORE compression")},uncompressWorker:function(){return new g("STORE decompression")}},v.DEFLATE=f("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(f,m,v){var g=f("./utils"),w=(function(){for(var y,C=[],k=0;k<256;k++){y=k;for(var F=0;F<8;F++)y=1&y?3988292384^y>>>1:y>>>1;C[k]=y}return C})();m.exports=function(y,C){return y!==void 0&&y.length?g.getTypeOf(y)!=="string"?(function(k,F,I,N){var j=w,L=0+I;k^=-1;for(var W=0;W<L;W++)k=k>>>8^j[255&(k^F[W])];return-1^k})(0|C,y,y.length):(function(k,F,I,N){var j=w,L=0+I;k^=-1;for(var W=0;W<L;W++)k=k>>>8^j[255&(k^F.charCodeAt(W))];return-1^k})(0|C,y,y.length):0}},{"./utils":32}],5:[function(f,m,v){v.base64=!1,v.binary=!1,v.dir=!1,v.createFolders=!0,v.date=null,v.compression=null,v.compressionOptions=null,v.comment=null,v.unixPermissions=null,v.dosPermissions=null},{}],6:[function(f,m,v){var g;g=typeof Promise<"u"?Promise:f("lie"),m.exports={Promise:g}},{lie:37}],7:[function(f,m,v){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",w=f("pako"),y=f("./utils"),C=f("./stream/GenericWorker"),k=g?"uint8array":"array";function F(I,N){C.call(this,"FlateWorker/"+I),this._pako=null,this._pakoAction=I,this._pakoOptions=N,this.meta={}}v.magic="\b\0",y.inherits(F,C),F.prototype.processChunk=function(I){this.meta=I.meta,this._pako===null&&this._createPako(),this._pako.push(y.transformTo(k,I.data),!1)},F.prototype.flush=function(){C.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},F.prototype.cleanUp=function(){C.prototype.cleanUp.call(this),this._pako=null},F.prototype._createPako=function(){this._pako=new w[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var I=this;this._pako.onData=function(N){I.push({data:N,meta:I.meta})}},v.compressWorker=function(I){return new F("Deflate",I)},v.uncompressWorker=function(){return new F("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(f,m,v){function g(j,L){var W,K="";for(W=0;W<L;W++)K+=String.fromCharCode(255&j),j>>>=8;return K}function w(j,L,W,K,z,M){var B,R,S=j.file,_=j.compression,T=M!==k.utf8encode,E=y.transformTo("string",M(S.name)),D=y.transformTo("string",k.utf8encode(S.name)),O=S.comment,P=y.transformTo("string",M(O)),q=y.transformTo("string",k.utf8encode(O)),X=D.length!==S.name.length,Q=q.length!==O.length,G="",ee="",V="",H=S.dir,Z=S.date,ie={crc32:0,compressedSize:0,uncompressedSize:0};L&&!W||(ie.crc32=j.crc32,ie.compressedSize=j.compressedSize,ie.uncompressedSize=j.uncompressedSize);var te=0;L&&(te|=8),T||!X&&!Q||(te|=2048);var oe=0,ue=0;H&&(oe|=16),z==="UNIX"?(ue=798,oe|=(function(ye,ne){var me=ye;return ye||(me=ne?16893:33204),(65535&me)<<16})(S.unixPermissions,H)):(ue=20,oe|=(function(ye){return 63&(ye||0)})(S.dosPermissions)),B=Z.getUTCHours(),B<<=6,B|=Z.getUTCMinutes(),B<<=5,B|=Z.getUTCSeconds()/2,R=Z.getUTCFullYear()-1980,R<<=4,R|=Z.getUTCMonth()+1,R<<=5,R|=Z.getUTCDate(),X&&(ee=g(1,1)+g(F(E),4)+D,G+="up"+g(ee.length,2)+ee),Q&&(V=g(1,1)+g(F(P),4)+q,G+="uc"+g(V.length,2)+V);var Ce="";return Ce+=`
\0`,Ce+=g(te,2),Ce+=_.magic,Ce+=g(B,2),Ce+=g(R,2),Ce+=g(ie.crc32,4),Ce+=g(ie.compressedSize,4),Ce+=g(ie.uncompressedSize,4),Ce+=g(E.length,2),Ce+=g(G.length,2),{fileRecord:I.LOCAL_FILE_HEADER+Ce+E+G,dirRecord:I.CENTRAL_FILE_HEADER+g(ue,2)+Ce+g(P.length,2)+"\0\0\0\0"+g(oe,4)+g(K,4)+E+G+P}}var y=f("../utils"),C=f("../stream/GenericWorker"),k=f("../utf8"),F=f("../crc32"),I=f("../signature");function N(j,L,W,K){C.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=L,this.zipPlatform=W,this.encodeFileName=K,this.streamFiles=j,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}y.inherits(N,C),N.prototype.push=function(j){var L=j.meta.percent||0,W=this.entriesCount,K=this._sources.length;this.accumulate?this.contentBuffer.push(j):(this.bytesWritten+=j.data.length,C.prototype.push.call(this,{data:j.data,meta:{currentFile:this.currentFile,percent:W?(L+100*(W-K-1))/W:100}}))},N.prototype.openedSource=function(j){this.currentSourceOffset=this.bytesWritten,this.currentFile=j.file.name;var L=this.streamFiles&&!j.file.dir;if(L){var W=w(j,L,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:W.fileRecord,meta:{percent:0}})}else this.accumulate=!0},N.prototype.closedSource=function(j){this.accumulate=!1;var L=this.streamFiles&&!j.file.dir,W=w(j,L,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(W.dirRecord),L)this.push({data:(function(K){return I.DATA_DESCRIPTOR+g(K.crc32,4)+g(K.compressedSize,4)+g(K.uncompressedSize,4)})(j),meta:{percent:100}});else for(this.push({data:W.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},N.prototype.flush=function(){for(var j=this.bytesWritten,L=0;L<this.dirRecords.length;L++)this.push({data:this.dirRecords[L],meta:{percent:100}});var W=this.bytesWritten-j,K=(function(z,M,B,R,S){var _=y.transformTo("string",S(R));return I.CENTRAL_DIRECTORY_END+"\0\0\0\0"+g(z,2)+g(z,2)+g(M,4)+g(B,4)+g(_.length,2)+_})(this.dirRecords.length,W,j,this.zipComment,this.encodeFileName);this.push({data:K,meta:{percent:100}})},N.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},N.prototype.registerPrevious=function(j){this._sources.push(j);var L=this;return j.on("data",(function(W){L.processChunk(W)})),j.on("end",(function(){L.closedSource(L.previous.streamInfo),L._sources.length?L.prepareNextSource():L.end()})),j.on("error",(function(W){L.error(W)})),this},N.prototype.resume=function(){return!!C.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},N.prototype.error=function(j){var L=this._sources;if(!C.prototype.error.call(this,j))return!1;for(var W=0;W<L.length;W++)try{L[W].error(j)}catch{}return!0},N.prototype.lock=function(){C.prototype.lock.call(this);for(var j=this._sources,L=0;L<j.length;L++)j[L].lock()},m.exports=N},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(f,m,v){var g=f("../compressions"),w=f("./ZipFileWorker");v.generateWorker=function(y,C,k){var F=new w(C.streamFiles,k,C.platform,C.encodeFileName),I=0;try{y.forEach((function(N,j){I++;var L=(function(M,B){var R=M||B,S=g[R];if(!S)throw new Error(R+" is not a valid compression method !");return S})(j.options.compression,C.compression),W=j.options.compressionOptions||C.compressionOptions||{},K=j.dir,z=j.date;j._compressWorker(L,W).withStreamInfo("file",{name:N,dir:K,date:z,comment:j.comment||"",unixPermissions:j.unixPermissions,dosPermissions:j.dosPermissions}).pipe(F)})),F.entriesCount=I}catch(N){F.error(N)}return F}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(f,m,v){function g(){if(!(this instanceof g))return new g;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var w=new g;for(var y in this)typeof this[y]!="function"&&(w[y]=this[y]);return w}}(g.prototype=f("./object")).loadAsync=f("./load"),g.support=f("./support"),g.defaults=f("./defaults"),g.version="3.10.1",g.loadAsync=function(w,y){return new g().loadAsync(w,y)},g.external=f("./external"),m.exports=g},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(f,m,v){var g=f("./utils"),w=f("./external"),y=f("./utf8"),C=f("./zipEntries"),k=f("./stream/Crc32Probe"),F=f("./nodejsUtils");function I(N){return new w.Promise((function(j,L){var W=N.decompressed.getContentWorker().pipe(new k);W.on("error",(function(K){L(K)})).on("end",(function(){W.streamInfo.crc32!==N.decompressed.crc32?L(new Error("Corrupted zip : CRC32 mismatch")):j()})).resume()}))}m.exports=function(N,j){var L=this;return j=g.extend(j||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:y.utf8decode}),F.isNode&&F.isStream(N)?w.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):g.prepareContent("the loaded zip file",N,!0,j.optimizedBinaryString,j.base64).then((function(W){var K=new C(j);return K.load(W),K})).then((function(W){var K=[w.Promise.resolve(W)],z=W.files;if(j.checkCRC32)for(var M=0;M<z.length;M++)K.push(I(z[M]));return w.Promise.all(K)})).then((function(W){for(var K=W.shift(),z=K.files,M=0;M<z.length;M++){var B=z[M],R=B.fileNameStr,S=g.resolve(B.fileNameStr);L.file(S,B.decompressed,{binary:!0,optimizedBinaryString:!0,date:B.date,dir:B.dir,comment:B.fileCommentStr.length?B.fileCommentStr:null,unixPermissions:B.unixPermissions,dosPermissions:B.dosPermissions,createFolders:j.createFolders}),B.dir||(L.file(S).unsafeOriginalName=R)}return K.zipComment.length&&(L.comment=K.zipComment),L}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(f,m,v){var g=f("../utils"),w=f("../stream/GenericWorker");function y(C,k){w.call(this,"Nodejs stream input adapter for "+C),this._upstreamEnded=!1,this._bindStream(k)}g.inherits(y,w),y.prototype._bindStream=function(C){var k=this;(this._stream=C).pause(),C.on("data",(function(F){k.push({data:F,meta:{percent:0}})})).on("error",(function(F){k.isPaused?this.generatedError=F:k.error(F)})).on("end",(function(){k.isPaused?k._upstreamEnded=!0:k.end()}))},y.prototype.pause=function(){return!!w.prototype.pause.call(this)&&(this._stream.pause(),!0)},y.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},m.exports=y},{"../stream/GenericWorker":28,"../utils":32}],13:[function(f,m,v){var g=f("readable-stream").Readable;function w(y,C,k){g.call(this,C),this._helper=y;var F=this;y.on("data",(function(I,N){F.push(I)||F._helper.pause(),k&&k(N)})).on("error",(function(I){F.emit("error",I)})).on("end",(function(){F.push(null)}))}f("../utils").inherits(w,g),w.prototype._read=function(){this._helper.resume()},m.exports=w},{"../utils":32,"readable-stream":16}],14:[function(f,m,v){m.exports={isNode:a!==void 0,newBufferFrom:function(g,w){if(a.from&&a.from!==Uint8Array.from)return a.from(g,w);if(typeof g=="number")throw new Error('The "data" argument must not be a number');return new a(g,w)},allocBuffer:function(g){if(a.alloc)return a.alloc(g);var w=new a(g);return w.fill(0),w},isBuffer:function(g){return a.isBuffer(g)},isStream:function(g){return g&&typeof g.on=="function"&&typeof g.pause=="function"&&typeof g.resume=="function"}}},{}],15:[function(f,m,v){function g(S,_,T){var E,D=y.getTypeOf(_),O=y.extend(T||{},F);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(S=z(S)),O.createFolders&&(E=K(S))&&M.call(this,E,!0);var P=D==="string"&&O.binary===!1&&O.base64===!1;T&&T.binary!==void 0||(O.binary=!P),(_ instanceof I&&_.uncompressedSize===0||O.dir||!_||_.length===0)&&(O.base64=!1,O.binary=!0,_="",O.compression="STORE",D="string");var q;q=_ instanceof I||_ instanceof C?_:L.isNode&&L.isStream(_)?new W(S,_):y.prepareContent(S,_,O.binary,O.optimizedBinaryString,O.base64);var X=new N(S,q,O);this.files[S]=X}var w=f("./utf8"),y=f("./utils"),C=f("./stream/GenericWorker"),k=f("./stream/StreamHelper"),F=f("./defaults"),I=f("./compressedObject"),N=f("./zipObject"),j=f("./generate"),L=f("./nodejsUtils"),W=f("./nodejs/NodejsStreamInputAdapter"),K=function(S){S.slice(-1)==="/"&&(S=S.substring(0,S.length-1));var _=S.lastIndexOf("/");return 0<_?S.substring(0,_):""},z=function(S){return S.slice(-1)!=="/"&&(S+="/"),S},M=function(S,_){return _=_!==void 0?_:F.createFolders,S=z(S),this.files[S]||g.call(this,S,null,{dir:!0,createFolders:_}),this.files[S]};function B(S){return Object.prototype.toString.call(S)==="[object RegExp]"}var R={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(S){var _,T,E;for(_ in this.files)E=this.files[_],(T=_.slice(this.root.length,_.length))&&_.slice(0,this.root.length)===this.root&&S(T,E)},filter:function(S){var _=[];return this.forEach((function(T,E){S(T,E)&&_.push(E)})),_},file:function(S,_,T){if(arguments.length!==1)return S=this.root+S,g.call(this,S,_,T),this;if(B(S)){var E=S;return this.filter((function(O,P){return!P.dir&&E.test(O)}))}var D=this.files[this.root+S];return D&&!D.dir?D:null},folder:function(S){if(!S)return this;if(B(S))return this.filter((function(D,O){return O.dir&&S.test(D)}));var _=this.root+S,T=M.call(this,_),E=this.clone();return E.root=T.name,E},remove:function(S){S=this.root+S;var _=this.files[S];if(_||(S.slice(-1)!=="/"&&(S+="/"),_=this.files[S]),_&&!_.dir)delete this.files[S];else for(var T=this.filter((function(D,O){return O.name.slice(0,S.length)===S})),E=0;E<T.length;E++)delete this.files[T[E].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(S){var _,T={};try{if((T=y.extend(S||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:w.utf8encode})).type=T.type.toLowerCase(),T.compression=T.compression.toUpperCase(),T.type==="binarystring"&&(T.type="string"),!T.type)throw new Error("No output type specified.");y.checkSupport(T.type),T.platform!=="darwin"&&T.platform!=="freebsd"&&T.platform!=="linux"&&T.platform!=="sunos"||(T.platform="UNIX"),T.platform==="win32"&&(T.platform="DOS");var E=T.comment||this.comment||"";_=j.generateWorker(this,T,E)}catch(D){(_=new C("error")).error(D)}return new k(_,T.type||"string",T.mimeType)},generateAsync:function(S,_){return this.generateInternalStream(S).accumulate(_)},generateNodeStream:function(S,_){return(S=S||{}).type||(S.type="nodebuffer"),this.generateInternalStream(S).toNodejsStream(_)}};m.exports=R},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(f,m,v){m.exports=f("stream")},{stream:void 0}],17:[function(f,m,v){var g=f("./DataReader");function w(y){g.call(this,y);for(var C=0;C<this.data.length;C++)y[C]=255&y[C]}f("../utils").inherits(w,g),w.prototype.byteAt=function(y){return this.data[this.zero+y]},w.prototype.lastIndexOfSignature=function(y){for(var C=y.charCodeAt(0),k=y.charCodeAt(1),F=y.charCodeAt(2),I=y.charCodeAt(3),N=this.length-4;0<=N;--N)if(this.data[N]===C&&this.data[N+1]===k&&this.data[N+2]===F&&this.data[N+3]===I)return N-this.zero;return-1},w.prototype.readAndCheckSignature=function(y){var C=y.charCodeAt(0),k=y.charCodeAt(1),F=y.charCodeAt(2),I=y.charCodeAt(3),N=this.readData(4);return C===N[0]&&k===N[1]&&F===N[2]&&I===N[3]},w.prototype.readData=function(y){if(this.checkOffset(y),y===0)return[];var C=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,C},m.exports=w},{"../utils":32,"./DataReader":18}],18:[function(f,m,v){var g=f("../utils");function w(y){this.data=y,this.length=y.length,this.index=0,this.zero=0}w.prototype={checkOffset:function(y){this.checkIndex(this.index+y)},checkIndex:function(y){if(this.length<this.zero+y||y<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+y+"). Corrupted zip ?")},setIndex:function(y){this.checkIndex(y),this.index=y},skip:function(y){this.setIndex(this.index+y)},byteAt:function(){},readInt:function(y){var C,k=0;for(this.checkOffset(y),C=this.index+y-1;C>=this.index;C--)k=(k<<8)+this.byteAt(C);return this.index+=y,k},readString:function(y){return g.transformTo("string",this.readData(y))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var y=this.readInt(4);return new Date(Date.UTC(1980+(y>>25&127),(y>>21&15)-1,y>>16&31,y>>11&31,y>>5&63,(31&y)<<1))}},m.exports=w},{"../utils":32}],19:[function(f,m,v){var g=f("./Uint8ArrayReader");function w(y){g.call(this,y)}f("../utils").inherits(w,g),w.prototype.readData=function(y){this.checkOffset(y);var C=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,C},m.exports=w},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(f,m,v){var g=f("./DataReader");function w(y){g.call(this,y)}f("../utils").inherits(w,g),w.prototype.byteAt=function(y){return this.data.charCodeAt(this.zero+y)},w.prototype.lastIndexOfSignature=function(y){return this.data.lastIndexOf(y)-this.zero},w.prototype.readAndCheckSignature=function(y){return y===this.readData(4)},w.prototype.readData=function(y){this.checkOffset(y);var C=this.data.slice(this.zero+this.index,this.zero+this.index+y);return this.index+=y,C},m.exports=w},{"../utils":32,"./DataReader":18}],21:[function(f,m,v){var g=f("./ArrayReader");function w(y){g.call(this,y)}f("../utils").inherits(w,g),w.prototype.readData=function(y){if(this.checkOffset(y),y===0)return new Uint8Array(0);var C=this.data.subarray(this.zero+this.index,this.zero+this.index+y);return this.index+=y,C},m.exports=w},{"../utils":32,"./ArrayReader":17}],22:[function(f,m,v){var g=f("../utils"),w=f("../support"),y=f("./ArrayReader"),C=f("./StringReader"),k=f("./NodeBufferReader"),F=f("./Uint8ArrayReader");m.exports=function(I){var N=g.getTypeOf(I);return g.checkSupport(N),N!=="string"||w.uint8array?N==="nodebuffer"?new k(I):w.uint8array?new F(g.transformTo("uint8array",I)):new y(g.transformTo("array",I)):new C(I)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(f,m,v){v.LOCAL_FILE_HEADER="PK",v.CENTRAL_FILE_HEADER="PK",v.CENTRAL_DIRECTORY_END="PK",v.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",v.ZIP64_CENTRAL_DIRECTORY_END="PK",v.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(f,m,v){var g=f("./GenericWorker"),w=f("../utils");function y(C){g.call(this,"ConvertWorker to "+C),this.destType=C}w.inherits(y,g),y.prototype.processChunk=function(C){this.push({data:w.transformTo(this.destType,C.data),meta:C.meta})},m.exports=y},{"../utils":32,"./GenericWorker":28}],25:[function(f,m,v){var g=f("./GenericWorker"),w=f("../crc32");function y(){g.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}f("../utils").inherits(y,g),y.prototype.processChunk=function(C){this.streamInfo.crc32=w(C.data,this.streamInfo.crc32||0),this.push(C)},m.exports=y},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(f,m,v){var g=f("../utils"),w=f("./GenericWorker");function y(C){w.call(this,"DataLengthProbe for "+C),this.propName=C,this.withStreamInfo(C,0)}g.inherits(y,w),y.prototype.processChunk=function(C){if(C){var k=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=k+C.data.length}w.prototype.processChunk.call(this,C)},m.exports=y},{"../utils":32,"./GenericWorker":28}],27:[function(f,m,v){var g=f("../utils"),w=f("./GenericWorker");function y(C){w.call(this,"DataWorker");var k=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,C.then((function(F){k.dataIsReady=!0,k.data=F,k.max=F&&F.length||0,k.type=g.getTypeOf(F),k.isPaused||k._tickAndRepeat()}),(function(F){k.error(F)}))}g.inherits(y,w),y.prototype.cleanUp=function(){w.prototype.cleanUp.call(this),this.data=null},y.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,g.delay(this._tickAndRepeat,[],this)),!0)},y.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(g.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},y.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var C=null,k=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":C=this.data.substring(this.index,k);break;case"uint8array":C=this.data.subarray(this.index,k);break;case"array":case"nodebuffer":C=this.data.slice(this.index,k)}return this.index=k,this.push({data:C,meta:{percent:this.max?this.index/this.max*100:0}})},m.exports=y},{"../utils":32,"./GenericWorker":28}],28:[function(f,m,v){function g(w){this.name=w||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}g.prototype={push:function(w){this.emit("data",w)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(w){this.emit("error",w)}return!0},error:function(w){return!this.isFinished&&(this.isPaused?this.generatedError=w:(this.isFinished=!0,this.emit("error",w),this.previous&&this.previous.error(w),this.cleanUp()),!0)},on:function(w,y){return this._listeners[w].push(y),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(w,y){if(this._listeners[w])for(var C=0;C<this._listeners[w].length;C++)this._listeners[w][C].call(this,y)},pipe:function(w){return w.registerPrevious(this)},registerPrevious:function(w){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=w.streamInfo,this.mergeStreamInfo(),this.previous=w;var y=this;return w.on("data",(function(C){y.processChunk(C)})),w.on("end",(function(){y.end()})),w.on("error",(function(C){y.error(C)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var w=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),w=!0),this.previous&&this.previous.resume(),!w},flush:function(){},processChunk:function(w){this.push(w)},withStreamInfo:function(w,y){return this.extraStreamInfo[w]=y,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var w in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,w)&&(this.streamInfo[w]=this.extraStreamInfo[w])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var w="Worker "+this.name;return this.previous?this.previous+" -> "+w:w}},m.exports=g},{}],29:[function(f,m,v){var g=f("../utils"),w=f("./ConvertWorker"),y=f("./GenericWorker"),C=f("../base64"),k=f("../support"),F=f("../external"),I=null;if(k.nodestream)try{I=f("../nodejs/NodejsStreamOutputAdapter")}catch{}function N(j,L,W){var K=L;switch(L){case"blob":case"arraybuffer":K="uint8array";break;case"base64":K="string"}try{this._internalType=K,this._outputType=L,this._mimeType=W,g.checkSupport(K),this._worker=j.pipe(new w(K)),j.lock()}catch(z){this._worker=new y("error"),this._worker.error(z)}}N.prototype={accumulate:function(j){return(function(L,W){return new F.Promise((function(K,z){var M=[],B=L._internalType,R=L._outputType,S=L._mimeType;L.on("data",(function(_,T){M.push(_),W&&W(T)})).on("error",(function(_){M=[],z(_)})).on("end",(function(){try{var _=(function(T,E,D){switch(T){case"blob":return g.newBlob(g.transformTo("arraybuffer",E),D);case"base64":return C.encode(E);default:return g.transformTo(T,E)}})(R,(function(T,E){var D,O=0,P=null,q=0;for(D=0;D<E.length;D++)q+=E[D].length;switch(T){case"string":return E.join("");case"array":return Array.prototype.concat.apply([],E);case"uint8array":for(P=new Uint8Array(q),D=0;D<E.length;D++)P.set(E[D],O),O+=E[D].length;return P;case"nodebuffer":return a.concat(E);default:throw new Error("concat : unsupported type '"+T+"'")}})(B,M),S);K(_)}catch(T){z(T)}M=[]})).resume()}))})(this,j)},on:function(j,L){var W=this;return j==="data"?this._worker.on(j,(function(K){L.call(W,K.data,K.meta)})):this._worker.on(j,(function(){g.delay(L,arguments,W)})),this},resume:function(){return g.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(j){if(g.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new I(this,{objectMode:this._outputType!=="nodebuffer"},j)}},m.exports=N},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(f,m,v){if(v.base64=!0,v.array=!0,v.string=!0,v.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",v.nodebuffer=a!==void 0,v.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")v.blob=!1;else{var g=new ArrayBuffer(0);try{v.blob=new Blob([g],{type:"application/zip"}).size===0}catch{try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);w.append(g),v.blob=w.getBlob("application/zip").size===0}catch{v.blob=!1}}}try{v.nodestream=!!f("readable-stream").Readable}catch{v.nodestream=!1}},{"readable-stream":16}],31:[function(f,m,v){for(var g=f("./utils"),w=f("./support"),y=f("./nodejsUtils"),C=f("./stream/GenericWorker"),k=new Array(256),F=0;F<256;F++)k[F]=252<=F?6:248<=F?5:240<=F?4:224<=F?3:192<=F?2:1;function I(){C.call(this,"utf-8 decode"),this.leftOver=null}function N(){C.call(this,"utf-8 encode")}k[254]=k[254]=1,v.utf8encode=function(j){return w.nodebuffer?y.newBufferFrom(j,"utf-8"):(function(L){var W,K,z,M,B,R=L.length,S=0;for(M=0;M<R;M++)(64512&(K=L.charCodeAt(M)))==55296&&M+1<R&&(64512&(z=L.charCodeAt(M+1)))==56320&&(K=65536+(K-55296<<10)+(z-56320),M++),S+=K<128?1:K<2048?2:K<65536?3:4;for(W=w.uint8array?new Uint8Array(S):new Array(S),M=B=0;B<S;M++)(64512&(K=L.charCodeAt(M)))==55296&&M+1<R&&(64512&(z=L.charCodeAt(M+1)))==56320&&(K=65536+(K-55296<<10)+(z-56320),M++),K<128?W[B++]=K:(K<2048?W[B++]=192|K>>>6:(K<65536?W[B++]=224|K>>>12:(W[B++]=240|K>>>18,W[B++]=128|K>>>12&63),W[B++]=128|K>>>6&63),W[B++]=128|63&K);return W})(j)},v.utf8decode=function(j){return w.nodebuffer?g.transformTo("nodebuffer",j).toString("utf-8"):(function(L){var W,K,z,M,B=L.length,R=new Array(2*B);for(W=K=0;W<B;)if((z=L[W++])<128)R[K++]=z;else if(4<(M=k[z]))R[K++]=65533,W+=M-1;else{for(z&=M===2?31:M===3?15:7;1<M&&W<B;)z=z<<6|63&L[W++],M--;1<M?R[K++]=65533:z<65536?R[K++]=z:(z-=65536,R[K++]=55296|z>>10&1023,R[K++]=56320|1023&z)}return R.length!==K&&(R.subarray?R=R.subarray(0,K):R.length=K),g.applyFromCharCode(R)})(j=g.transformTo(w.uint8array?"uint8array":"array",j))},g.inherits(I,C),I.prototype.processChunk=function(j){var L=g.transformTo(w.uint8array?"uint8array":"array",j.data);if(this.leftOver&&this.leftOver.length){if(w.uint8array){var W=L;(L=new Uint8Array(W.length+this.leftOver.length)).set(this.leftOver,0),L.set(W,this.leftOver.length)}else L=this.leftOver.concat(L);this.leftOver=null}var K=(function(M,B){var R;for((B=B||M.length)>M.length&&(B=M.length),R=B-1;0<=R&&(192&M[R])==128;)R--;return R<0||R===0?B:R+k[M[R]]>B?R:B})(L),z=L;K!==L.length&&(w.uint8array?(z=L.subarray(0,K),this.leftOver=L.subarray(K,L.length)):(z=L.slice(0,K),this.leftOver=L.slice(K,L.length))),this.push({data:v.utf8decode(z),meta:j.meta})},I.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:v.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},v.Utf8DecodeWorker=I,g.inherits(N,C),N.prototype.processChunk=function(j){this.push({data:v.utf8encode(j.data),meta:j.meta})},v.Utf8EncodeWorker=N},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(f,m,v){var g=f("./support"),w=f("./base64"),y=f("./nodejsUtils"),C=f("./external");function k(W){return W}function F(W,K){for(var z=0;z<W.length;++z)K[z]=255&W.charCodeAt(z);return K}f("setimmediate"),v.newBlob=function(W,K){v.checkSupport("blob");try{return new Blob([W],{type:K})}catch{try{var z=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return z.append(W),z.getBlob(K)}catch{throw new Error("Bug : can't construct the Blob.")}}};var I={stringifyByChunk:function(W,K,z){var M=[],B=0,R=W.length;if(R<=z)return String.fromCharCode.apply(null,W);for(;B<R;)K==="array"||K==="nodebuffer"?M.push(String.fromCharCode.apply(null,W.slice(B,Math.min(B+z,R)))):M.push(String.fromCharCode.apply(null,W.subarray(B,Math.min(B+z,R)))),B+=z;return M.join("")},stringifyByChar:function(W){for(var K="",z=0;z<W.length;z++)K+=String.fromCharCode(W[z]);return K},applyCanBeUsed:{uint8array:(function(){try{return g.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}})(),nodebuffer:(function(){try{return g.nodebuffer&&String.fromCharCode.apply(null,y.allocBuffer(1)).length===1}catch{return!1}})()}};function N(W){var K=65536,z=v.getTypeOf(W),M=!0;if(z==="uint8array"?M=I.applyCanBeUsed.uint8array:z==="nodebuffer"&&(M=I.applyCanBeUsed.nodebuffer),M)for(;1<K;)try{return I.stringifyByChunk(W,z,K)}catch{K=Math.floor(K/2)}return I.stringifyByChar(W)}function j(W,K){for(var z=0;z<W.length;z++)K[z]=W[z];return K}v.applyFromCharCode=N;var L={};L.string={string:k,array:function(W){return F(W,new Array(W.length))},arraybuffer:function(W){return L.string.uint8array(W).buffer},uint8array:function(W){return F(W,new Uint8Array(W.length))},nodebuffer:function(W){return F(W,y.allocBuffer(W.length))}},L.array={string:N,array:k,arraybuffer:function(W){return new Uint8Array(W).buffer},uint8array:function(W){return new Uint8Array(W)},nodebuffer:function(W){return y.newBufferFrom(W)}},L.arraybuffer={string:function(W){return N(new Uint8Array(W))},array:function(W){return j(new Uint8Array(W),new Array(W.byteLength))},arraybuffer:k,uint8array:function(W){return new Uint8Array(W)},nodebuffer:function(W){return y.newBufferFrom(new Uint8Array(W))}},L.uint8array={string:N,array:function(W){return j(W,new Array(W.length))},arraybuffer:function(W){return W.buffer},uint8array:k,nodebuffer:function(W){return y.newBufferFrom(W)}},L.nodebuffer={string:N,array:function(W){return j(W,new Array(W.length))},arraybuffer:function(W){return L.nodebuffer.uint8array(W).buffer},uint8array:function(W){return j(W,new Uint8Array(W.length))},nodebuffer:k},v.transformTo=function(W,K){if(K=K||"",!W)return K;v.checkSupport(W);var z=v.getTypeOf(K);return L[z][W](K)},v.resolve=function(W){for(var K=W.split("/"),z=[],M=0;M<K.length;M++){var B=K[M];B==="."||B===""&&M!==0&&M!==K.length-1||(B===".."?z.pop():z.push(B))}return z.join("/")},v.getTypeOf=function(W){return typeof W=="string"?"string":Object.prototype.toString.call(W)==="[object Array]"?"array":g.nodebuffer&&y.isBuffer(W)?"nodebuffer":g.uint8array&&W instanceof Uint8Array?"uint8array":g.arraybuffer&&W instanceof ArrayBuffer?"arraybuffer":void 0},v.checkSupport=function(W){if(!g[W.toLowerCase()])throw new Error(W+" is not supported by this platform")},v.MAX_VALUE_16BITS=65535,v.MAX_VALUE_32BITS=-1,v.pretty=function(W){var K,z,M="";for(z=0;z<(W||"").length;z++)M+="\\x"+((K=W.charCodeAt(z))<16?"0":"")+K.toString(16).toUpperCase();return M},v.delay=function(W,K,z){d((function(){W.apply(z||null,K||[])}))},v.inherits=function(W,K){function z(){}z.prototype=K.prototype,W.prototype=new z},v.extend=function(){var W,K,z={};for(W=0;W<arguments.length;W++)for(K in arguments[W])Object.prototype.hasOwnProperty.call(arguments[W],K)&&z[K]===void 0&&(z[K]=arguments[W][K]);return z},v.prepareContent=function(W,K,z,M,B){return C.Promise.resolve(K).then((function(R){return g.blob&&(R instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(R))!==-1)&&typeof FileReader<"u"?new C.Promise((function(S,_){var T=new FileReader;T.onload=function(E){S(E.target.result)},T.onerror=function(E){_(E.target.error)},T.readAsArrayBuffer(R)})):R})).then((function(R){var S=v.getTypeOf(R);return S?(S==="arraybuffer"?R=v.transformTo("uint8array",R):S==="string"&&(B?R=w.decode(R):z&&M!==!0&&(R=(function(_){return F(_,g.uint8array?new Uint8Array(_.length):new Array(_.length))})(R))),R):C.Promise.reject(new Error("Can't read the data of '"+W+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(f,m,v){var g=f("./reader/readerFor"),w=f("./utils"),y=f("./signature"),C=f("./zipEntry"),k=f("./support");function F(I){this.files=[],this.loadOptions=I}F.prototype={checkSignature:function(I){if(!this.reader.readAndCheckSignature(I)){this.reader.index-=4;var N=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+w.pretty(N)+", expected "+w.pretty(I)+")")}},isSignature:function(I,N){var j=this.reader.index;this.reader.setIndex(I);var L=this.reader.readString(4)===N;return this.reader.setIndex(j),L},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var I=this.reader.readData(this.zipCommentLength),N=k.uint8array?"uint8array":"array",j=w.transformTo(N,I);this.zipComment=this.loadOptions.decodeFileName(j)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var I,N,j,L=this.zip64EndOfCentralSize-44;0<L;)I=this.reader.readInt(2),N=this.reader.readInt(4),j=this.reader.readData(N),this.zip64ExtensibleData[I]={id:I,length:N,value:j}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var I,N;for(I=0;I<this.files.length;I++)N=this.files[I],this.reader.setIndex(N.localHeaderOffset),this.checkSignature(y.LOCAL_FILE_HEADER),N.readLocalPart(this.reader),N.handleUTF8(),N.processAttributes()},readCentralDir:function(){var I;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(y.CENTRAL_FILE_HEADER);)(I=new C({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(I);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var I=this.reader.lastIndexOfSignature(y.CENTRAL_DIRECTORY_END);if(I<0)throw this.isSignature(0,y.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(I);var N=I;if(this.checkSignature(y.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===w.MAX_VALUE_16BITS||this.diskWithCentralDirStart===w.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===w.MAX_VALUE_16BITS||this.centralDirRecords===w.MAX_VALUE_16BITS||this.centralDirSize===w.MAX_VALUE_32BITS||this.centralDirOffset===w.MAX_VALUE_32BITS){if(this.zip64=!0,(I=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(I),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,y.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(y.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var j=this.centralDirOffset+this.centralDirSize;this.zip64&&(j+=20,j+=12+this.zip64EndOfCentralSize);var L=N-j;if(0<L)this.isSignature(N,y.CENTRAL_FILE_HEADER)||(this.reader.zero=L);else if(L<0)throw new Error("Corrupted zip: missing "+Math.abs(L)+" bytes.")},prepareReader:function(I){this.reader=g(I)},load:function(I){this.prepareReader(I),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},m.exports=F},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(f,m,v){var g=f("./reader/readerFor"),w=f("./utils"),y=f("./compressedObject"),C=f("./crc32"),k=f("./utf8"),F=f("./compressions"),I=f("./support");function N(j,L){this.options=j,this.loadOptions=L}N.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(j){var L,W;if(j.skip(22),this.fileNameLength=j.readInt(2),W=j.readInt(2),this.fileName=j.readData(this.fileNameLength),j.skip(W),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((L=(function(K){for(var z in F)if(Object.prototype.hasOwnProperty.call(F,z)&&F[z].magic===K)return F[z];return null})(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+w.pretty(this.compressionMethod)+" unknown (inner file : "+w.transformTo("string",this.fileName)+")");this.decompressed=new y(this.compressedSize,this.uncompressedSize,this.crc32,L,j.readData(this.compressedSize))},readCentralPart:function(j){this.versionMadeBy=j.readInt(2),j.skip(2),this.bitFlag=j.readInt(2),this.compressionMethod=j.readString(2),this.date=j.readDate(),this.crc32=j.readInt(4),this.compressedSize=j.readInt(4),this.uncompressedSize=j.readInt(4);var L=j.readInt(2);if(this.extraFieldsLength=j.readInt(2),this.fileCommentLength=j.readInt(2),this.diskNumberStart=j.readInt(2),this.internalFileAttributes=j.readInt(2),this.externalFileAttributes=j.readInt(4),this.localHeaderOffset=j.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");j.skip(L),this.readExtraFields(j),this.parseZIP64ExtraField(j),this.fileComment=j.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var j=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),j==0&&(this.dosPermissions=63&this.externalFileAttributes),j==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var j=g(this.extraFields[1].value);this.uncompressedSize===w.MAX_VALUE_32BITS&&(this.uncompressedSize=j.readInt(8)),this.compressedSize===w.MAX_VALUE_32BITS&&(this.compressedSize=j.readInt(8)),this.localHeaderOffset===w.MAX_VALUE_32BITS&&(this.localHeaderOffset=j.readInt(8)),this.diskNumberStart===w.MAX_VALUE_32BITS&&(this.diskNumberStart=j.readInt(4))}},readExtraFields:function(j){var L,W,K,z=j.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});j.index+4<z;)L=j.readInt(2),W=j.readInt(2),K=j.readData(W),this.extraFields[L]={id:L,length:W,value:K};j.setIndex(z)},handleUTF8:function(){var j=I.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=k.utf8decode(this.fileName),this.fileCommentStr=k.utf8decode(this.fileComment);else{var L=this.findExtraFieldUnicodePath();if(L!==null)this.fileNameStr=L;else{var W=w.transformTo(j,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(W)}var K=this.findExtraFieldUnicodeComment();if(K!==null)this.fileCommentStr=K;else{var z=w.transformTo(j,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(z)}}},findExtraFieldUnicodePath:function(){var j=this.extraFields[28789];if(j){var L=g(j.value);return L.readInt(1)!==1||C(this.fileName)!==L.readInt(4)?null:k.utf8decode(L.readData(j.length-5))}return null},findExtraFieldUnicodeComment:function(){var j=this.extraFields[25461];if(j){var L=g(j.value);return L.readInt(1)!==1||C(this.fileComment)!==L.readInt(4)?null:k.utf8decode(L.readData(j.length-5))}return null}},m.exports=N},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(f,m,v){function g(L,W,K){this.name=L,this.dir=K.dir,this.date=K.date,this.comment=K.comment,this.unixPermissions=K.unixPermissions,this.dosPermissions=K.dosPermissions,this._data=W,this._dataBinary=K.binary,this.options={compression:K.compression,compressionOptions:K.compressionOptions}}var w=f("./stream/StreamHelper"),y=f("./stream/DataWorker"),C=f("./utf8"),k=f("./compressedObject"),F=f("./stream/GenericWorker");g.prototype={internalStream:function(L){var W=null,K="string";try{if(!L)throw new Error("No output type specified.");var z=(K=L.toLowerCase())==="string"||K==="text";K!=="binarystring"&&K!=="text"||(K="string"),W=this._decompressWorker();var M=!this._dataBinary;M&&!z&&(W=W.pipe(new C.Utf8EncodeWorker)),!M&&z&&(W=W.pipe(new C.Utf8DecodeWorker))}catch(B){(W=new F("error")).error(B)}return new w(W,K,"")},async:function(L,W){return this.internalStream(L).accumulate(W)},nodeStream:function(L,W){return this.internalStream(L||"nodebuffer").toNodejsStream(W)},_compressWorker:function(L,W){if(this._data instanceof k&&this._data.compression.magic===L.magic)return this._data.getCompressedWorker();var K=this._decompressWorker();return this._dataBinary||(K=K.pipe(new C.Utf8EncodeWorker)),k.createWorkerFrom(K,L,W)},_decompressWorker:function(){return this._data instanceof k?this._data.getContentWorker():this._data instanceof F?this._data:new y(this._data)}};for(var I=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],N=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},j=0;j<I.length;j++)g.prototype[I[j]]=N;m.exports=g},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(f,m,v){(function(g){var w,y,C=g.MutationObserver||g.WebKitMutationObserver;if(C){var k=0,F=new C(L),I=g.document.createTextNode("");F.observe(I,{characterData:!0}),w=function(){I.data=k=++k%2}}else if(g.setImmediate||g.MessageChannel===void 0)w="document"in g&&"onreadystatechange"in g.document.createElement("script")?function(){var W=g.document.createElement("script");W.onreadystatechange=function(){L(),W.onreadystatechange=null,W.parentNode.removeChild(W),W=null},g.document.documentElement.appendChild(W)}:function(){setTimeout(L,0)};else{var N=new g.MessageChannel;N.port1.onmessage=L,w=function(){N.port2.postMessage(0)}}var j=[];function L(){var W,K;y=!0;for(var z=j.length;z;){for(K=j,j=[],W=-1;++W<z;)K[W]();z=j.length}y=!1}m.exports=function(W){j.push(W)!==1||y||w()}}).call(this,o!==void 0?o:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(f,m,v){var g=f("immediate");function w(){}var y={},C=["REJECTED"],k=["FULFILLED"],F=["PENDING"];function I(z){if(typeof z!="function")throw new TypeError("resolver must be a function");this.state=F,this.queue=[],this.outcome=void 0,z!==w&&W(this,z)}function N(z,M,B){this.promise=z,typeof M=="function"&&(this.onFulfilled=M,this.callFulfilled=this.otherCallFulfilled),typeof B=="function"&&(this.onRejected=B,this.callRejected=this.otherCallRejected)}function j(z,M,B){g((function(){var R;try{R=M(B)}catch(S){return y.reject(z,S)}R===z?y.reject(z,new TypeError("Cannot resolve promise with itself")):y.resolve(z,R)}))}function L(z){var M=z&&z.then;if(z&&(typeof z=="object"||typeof z=="function")&&typeof M=="function")return function(){M.apply(z,arguments)}}function W(z,M){var B=!1;function R(T){B||(B=!0,y.reject(z,T))}function S(T){B||(B=!0,y.resolve(z,T))}var _=K((function(){M(S,R)}));_.status==="error"&&R(_.value)}function K(z,M){var B={};try{B.value=z(M),B.status="success"}catch(R){B.status="error",B.value=R}return B}(m.exports=I).prototype.finally=function(z){if(typeof z!="function")return this;var M=this.constructor;return this.then((function(B){return M.resolve(z()).then((function(){return B}))}),(function(B){return M.resolve(z()).then((function(){throw B}))}))},I.prototype.catch=function(z){return this.then(null,z)},I.prototype.then=function(z,M){if(typeof z!="function"&&this.state===k||typeof M!="function"&&this.state===C)return this;var B=new this.constructor(w);return this.state!==F?j(B,this.state===k?z:M,this.outcome):this.queue.push(new N(B,z,M)),B},N.prototype.callFulfilled=function(z){y.resolve(this.promise,z)},N.prototype.otherCallFulfilled=function(z){j(this.promise,this.onFulfilled,z)},N.prototype.callRejected=function(z){y.reject(this.promise,z)},N.prototype.otherCallRejected=function(z){j(this.promise,this.onRejected,z)},y.resolve=function(z,M){var B=K(L,M);if(B.status==="error")return y.reject(z,B.value);var R=B.value;if(R)W(z,R);else{z.state=k,z.outcome=M;for(var S=-1,_=z.queue.length;++S<_;)z.queue[S].callFulfilled(M)}return z},y.reject=function(z,M){z.state=C,z.outcome=M;for(var B=-1,R=z.queue.length;++B<R;)z.queue[B].callRejected(M);return z},I.resolve=function(z){return z instanceof this?z:y.resolve(new this(w),z)},I.reject=function(z){var M=new this(w);return y.reject(M,z)},I.all=function(z){var M=this;if(Object.prototype.toString.call(z)!=="[object Array]")return this.reject(new TypeError("must be an array"));var B=z.length,R=!1;if(!B)return this.resolve([]);for(var S=new Array(B),_=0,T=-1,E=new this(w);++T<B;)D(z[T],T);return E;function D(O,P){M.resolve(O).then((function(q){S[P]=q,++_!==B||R||(R=!0,y.resolve(E,S))}),(function(q){R||(R=!0,y.reject(E,q))}))}},I.race=function(z){if(Object.prototype.toString.call(z)!=="[object Array]")return this.reject(new TypeError("must be an array"));var M=z.length,B=!1;if(!M)return this.resolve([]);for(var R,S=-1,_=new this(w);++S<M;)R=z[S],this.resolve(R).then((function(T){B||(B=!0,y.resolve(_,T))}),(function(T){B||(B=!0,y.reject(_,T))}));return _}},{immediate:36}],38:[function(f,m,v){var g={};(0,f("./lib/utils/common").assign)(g,f("./lib/deflate"),f("./lib/inflate"),f("./lib/zlib/constants")),m.exports=g},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(f,m,v){var g=f("./zlib/deflate"),w=f("./utils/common"),y=f("./utils/strings"),C=f("./zlib/messages"),k=f("./zlib/zstream"),F=Object.prototype.toString;function I(j){if(!(this instanceof I))return new I(j);this.options=w.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},j||{});var L=this.options;L.raw&&0<L.windowBits?L.windowBits=-L.windowBits:L.gzip&&0<L.windowBits&&L.windowBits<16&&(L.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new k,this.strm.avail_out=0;var W=g.deflateInit2(this.strm,L.level,L.method,L.windowBits,L.memLevel,L.strategy);if(W!==0)throw new Error(C[W]);if(L.header&&g.deflateSetHeader(this.strm,L.header),L.dictionary){var K;if(K=typeof L.dictionary=="string"?y.string2buf(L.dictionary):F.call(L.dictionary)==="[object ArrayBuffer]"?new Uint8Array(L.dictionary):L.dictionary,(W=g.deflateSetDictionary(this.strm,K))!==0)throw new Error(C[W]);this._dict_set=!0}}function N(j,L){var W=new I(L);if(W.push(j,!0),W.err)throw W.msg||C[W.err];return W.result}I.prototype.push=function(j,L){var W,K,z=this.strm,M=this.options.chunkSize;if(this.ended)return!1;K=L===~~L?L:L===!0?4:0,typeof j=="string"?z.input=y.string2buf(j):F.call(j)==="[object ArrayBuffer]"?z.input=new Uint8Array(j):z.input=j,z.next_in=0,z.avail_in=z.input.length;do{if(z.avail_out===0&&(z.output=new w.Buf8(M),z.next_out=0,z.avail_out=M),(W=g.deflate(z,K))!==1&&W!==0)return this.onEnd(W),!(this.ended=!0);z.avail_out!==0&&(z.avail_in!==0||K!==4&&K!==2)||(this.options.to==="string"?this.onData(y.buf2binstring(w.shrinkBuf(z.output,z.next_out))):this.onData(w.shrinkBuf(z.output,z.next_out)))}while((0<z.avail_in||z.avail_out===0)&&W!==1);return K===4?(W=g.deflateEnd(this.strm),this.onEnd(W),this.ended=!0,W===0):K!==2||(this.onEnd(0),!(z.avail_out=0))},I.prototype.onData=function(j){this.chunks.push(j)},I.prototype.onEnd=function(j){j===0&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=w.flattenChunks(this.chunks)),this.chunks=[],this.err=j,this.msg=this.strm.msg},v.Deflate=I,v.deflate=N,v.deflateRaw=function(j,L){return(L=L||{}).raw=!0,N(j,L)},v.gzip=function(j,L){return(L=L||{}).gzip=!0,N(j,L)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(f,m,v){var g=f("./zlib/inflate"),w=f("./utils/common"),y=f("./utils/strings"),C=f("./zlib/constants"),k=f("./zlib/messages"),F=f("./zlib/zstream"),I=f("./zlib/gzheader"),N=Object.prototype.toString;function j(W){if(!(this instanceof j))return new j(W);this.options=w.assign({chunkSize:16384,windowBits:0,to:""},W||{});var K=this.options;K.raw&&0<=K.windowBits&&K.windowBits<16&&(K.windowBits=-K.windowBits,K.windowBits===0&&(K.windowBits=-15)),!(0<=K.windowBits&&K.windowBits<16)||W&&W.windowBits||(K.windowBits+=32),15<K.windowBits&&K.windowBits<48&&(15&K.windowBits)==0&&(K.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new F,this.strm.avail_out=0;var z=g.inflateInit2(this.strm,K.windowBits);if(z!==C.Z_OK)throw new Error(k[z]);this.header=new I,g.inflateGetHeader(this.strm,this.header)}function L(W,K){var z=new j(K);if(z.push(W,!0),z.err)throw z.msg||k[z.err];return z.result}j.prototype.push=function(W,K){var z,M,B,R,S,_,T=this.strm,E=this.options.chunkSize,D=this.options.dictionary,O=!1;if(this.ended)return!1;M=K===~~K?K:K===!0?C.Z_FINISH:C.Z_NO_FLUSH,typeof W=="string"?T.input=y.binstring2buf(W):N.call(W)==="[object ArrayBuffer]"?T.input=new Uint8Array(W):T.input=W,T.next_in=0,T.avail_in=T.input.length;do{if(T.avail_out===0&&(T.output=new w.Buf8(E),T.next_out=0,T.avail_out=E),(z=g.inflate(T,C.Z_NO_FLUSH))===C.Z_NEED_DICT&&D&&(_=typeof D=="string"?y.string2buf(D):N.call(D)==="[object ArrayBuffer]"?new Uint8Array(D):D,z=g.inflateSetDictionary(this.strm,_)),z===C.Z_BUF_ERROR&&O===!0&&(z=C.Z_OK,O=!1),z!==C.Z_STREAM_END&&z!==C.Z_OK)return this.onEnd(z),!(this.ended=!0);T.next_out&&(T.avail_out!==0&&z!==C.Z_STREAM_END&&(T.avail_in!==0||M!==C.Z_FINISH&&M!==C.Z_SYNC_FLUSH)||(this.options.to==="string"?(B=y.utf8border(T.output,T.next_out),R=T.next_out-B,S=y.buf2string(T.output,B),T.next_out=R,T.avail_out=E-R,R&&w.arraySet(T.output,T.output,B,R,0),this.onData(S)):this.onData(w.shrinkBuf(T.output,T.next_out)))),T.avail_in===0&&T.avail_out===0&&(O=!0)}while((0<T.avail_in||T.avail_out===0)&&z!==C.Z_STREAM_END);return z===C.Z_STREAM_END&&(M=C.Z_FINISH),M===C.Z_FINISH?(z=g.inflateEnd(this.strm),this.onEnd(z),this.ended=!0,z===C.Z_OK):M!==C.Z_SYNC_FLUSH||(this.onEnd(C.Z_OK),!(T.avail_out=0))},j.prototype.onData=function(W){this.chunks.push(W)},j.prototype.onEnd=function(W){W===C.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=w.flattenChunks(this.chunks)),this.chunks=[],this.err=W,this.msg=this.strm.msg},v.Inflate=j,v.inflate=L,v.inflateRaw=function(W,K){return(K=K||{}).raw=!0,L(W,K)},v.ungzip=L},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(f,m,v){var g=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";v.assign=function(C){for(var k=Array.prototype.slice.call(arguments,1);k.length;){var F=k.shift();if(F){if(typeof F!="object")throw new TypeError(F+"must be non-object");for(var I in F)F.hasOwnProperty(I)&&(C[I]=F[I])}}return C},v.shrinkBuf=function(C,k){return C.length===k?C:C.subarray?C.subarray(0,k):(C.length=k,C)};var w={arraySet:function(C,k,F,I,N){if(k.subarray&&C.subarray)C.set(k.subarray(F,F+I),N);else for(var j=0;j<I;j++)C[N+j]=k[F+j]},flattenChunks:function(C){var k,F,I,N,j,L;for(k=I=0,F=C.length;k<F;k++)I+=C[k].length;for(L=new Uint8Array(I),k=N=0,F=C.length;k<F;k++)j=C[k],L.set(j,N),N+=j.length;return L}},y={arraySet:function(C,k,F,I,N){for(var j=0;j<I;j++)C[N+j]=k[F+j]},flattenChunks:function(C){return[].concat.apply([],C)}};v.setTyped=function(C){C?(v.Buf8=Uint8Array,v.Buf16=Uint16Array,v.Buf32=Int32Array,v.assign(v,w)):(v.Buf8=Array,v.Buf16=Array,v.Buf32=Array,v.assign(v,y))},v.setTyped(g)},{}],42:[function(f,m,v){var g=f("./common"),w=!0,y=!0;try{String.fromCharCode.apply(null,[0])}catch{w=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{y=!1}for(var C=new g.Buf8(256),k=0;k<256;k++)C[k]=252<=k?6:248<=k?5:240<=k?4:224<=k?3:192<=k?2:1;function F(I,N){if(N<65537&&(I.subarray&&y||!I.subarray&&w))return String.fromCharCode.apply(null,g.shrinkBuf(I,N));for(var j="",L=0;L<N;L++)j+=String.fromCharCode(I[L]);return j}C[254]=C[254]=1,v.string2buf=function(I){var N,j,L,W,K,z=I.length,M=0;for(W=0;W<z;W++)(64512&(j=I.charCodeAt(W)))==55296&&W+1<z&&(64512&(L=I.charCodeAt(W+1)))==56320&&(j=65536+(j-55296<<10)+(L-56320),W++),M+=j<128?1:j<2048?2:j<65536?3:4;for(N=new g.Buf8(M),W=K=0;K<M;W++)(64512&(j=I.charCodeAt(W)))==55296&&W+1<z&&(64512&(L=I.charCodeAt(W+1)))==56320&&(j=65536+(j-55296<<10)+(L-56320),W++),j<128?N[K++]=j:(j<2048?N[K++]=192|j>>>6:(j<65536?N[K++]=224|j>>>12:(N[K++]=240|j>>>18,N[K++]=128|j>>>12&63),N[K++]=128|j>>>6&63),N[K++]=128|63&j);return N},v.buf2binstring=function(I){return F(I,I.length)},v.binstring2buf=function(I){for(var N=new g.Buf8(I.length),j=0,L=N.length;j<L;j++)N[j]=I.charCodeAt(j);return N},v.buf2string=function(I,N){var j,L,W,K,z=N||I.length,M=new Array(2*z);for(j=L=0;j<z;)if((W=I[j++])<128)M[L++]=W;else if(4<(K=C[W]))M[L++]=65533,j+=K-1;else{for(W&=K===2?31:K===3?15:7;1<K&&j<z;)W=W<<6|63&I[j++],K--;1<K?M[L++]=65533:W<65536?M[L++]=W:(W-=65536,M[L++]=55296|W>>10&1023,M[L++]=56320|1023&W)}return F(M,L)},v.utf8border=function(I,N){var j;for((N=N||I.length)>I.length&&(N=I.length),j=N-1;0<=j&&(192&I[j])==128;)j--;return j<0||j===0?N:j+C[I[j]]>N?j:N}},{"./common":41}],43:[function(f,m,v){m.exports=function(g,w,y,C){for(var k=65535&g|0,F=g>>>16&65535|0,I=0;y!==0;){for(y-=I=2e3<y?2e3:y;F=F+(k=k+w[C++]|0)|0,--I;);k%=65521,F%=65521}return k|F<<16|0}},{}],44:[function(f,m,v){m.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(f,m,v){var g=(function(){for(var w,y=[],C=0;C<256;C++){w=C;for(var k=0;k<8;k++)w=1&w?3988292384^w>>>1:w>>>1;y[C]=w}return y})();m.exports=function(w,y,C,k){var F=g,I=k+C;w^=-1;for(var N=k;N<I;N++)w=w>>>8^F[255&(w^y[N])];return-1^w}},{}],46:[function(f,m,v){var g,w=f("../utils/common"),y=f("./trees"),C=f("./adler32"),k=f("./crc32"),F=f("./messages"),I=-2,N=258,j=262,L=113;function W(G,ee){return G.msg=F[ee],ee}function K(G){return(G<<1)-(4<G?9:0)}function z(G){for(var ee=G.length;0<=--ee;)G[ee]=0}function M(G){var ee=G.state,V=ee.pending;V>G.avail_out&&(V=G.avail_out),V!==0&&(w.arraySet(G.output,ee.pending_buf,ee.pending_out,V,G.next_out),G.next_out+=V,ee.pending_out+=V,G.total_out+=V,G.avail_out-=V,ee.pending-=V,ee.pending===0&&(ee.pending_out=0))}function B(G,ee){y._tr_flush_block(G,0<=G.block_start?G.block_start:-1,G.strstart-G.block_start,ee),G.block_start=G.strstart,M(G.strm)}function R(G,ee){G.pending_buf[G.pending++]=ee}function S(G,ee){G.pending_buf[G.pending++]=ee>>>8&255,G.pending_buf[G.pending++]=255&ee}function _(G,ee){var V,H,Z=G.max_chain_length,ie=G.strstart,te=G.prev_length,oe=G.nice_match,ue=G.strstart>G.w_size-j?G.strstart-(G.w_size-j):0,Ce=G.window,ye=G.w_mask,ne=G.prev,me=G.strstart+N,ve=Ce[ie+te-1],Te=Ce[ie+te];G.prev_length>=G.good_match&&(Z>>=2),oe>G.lookahead&&(oe=G.lookahead);do if(Ce[(V=ee)+te]===Te&&Ce[V+te-1]===ve&&Ce[V]===Ce[ie]&&Ce[++V]===Ce[ie+1]){ie+=2,V++;do;while(Ce[++ie]===Ce[++V]&&Ce[++ie]===Ce[++V]&&Ce[++ie]===Ce[++V]&&Ce[++ie]===Ce[++V]&&Ce[++ie]===Ce[++V]&&Ce[++ie]===Ce[++V]&&Ce[++ie]===Ce[++V]&&Ce[++ie]===Ce[++V]&&ie<me);if(H=N-(me-ie),ie=me-N,te<H){if(G.match_start=ee,oe<=(te=H))break;ve=Ce[ie+te-1],Te=Ce[ie+te]}}while((ee=ne[ee&ye])>ue&&--Z!=0);return te<=G.lookahead?te:G.lookahead}function T(G){var ee,V,H,Z,ie,te,oe,ue,Ce,ye,ne=G.w_size;do{if(Z=G.window_size-G.lookahead-G.strstart,G.strstart>=ne+(ne-j)){for(w.arraySet(G.window,G.window,ne,ne,0),G.match_start-=ne,G.strstart-=ne,G.block_start-=ne,ee=V=G.hash_size;H=G.head[--ee],G.head[ee]=ne<=H?H-ne:0,--V;);for(ee=V=ne;H=G.prev[--ee],G.prev[ee]=ne<=H?H-ne:0,--V;);Z+=ne}if(G.strm.avail_in===0)break;if(te=G.strm,oe=G.window,ue=G.strstart+G.lookahead,ye=void 0,(Ce=Z)<(ye=te.avail_in)&&(ye=Ce),V=ye===0?0:(te.avail_in-=ye,w.arraySet(oe,te.input,te.next_in,ye,ue),te.state.wrap===1?te.adler=C(te.adler,oe,ye,ue):te.state.wrap===2&&(te.adler=k(te.adler,oe,ye,ue)),te.next_in+=ye,te.total_in+=ye,ye),G.lookahead+=V,G.lookahead+G.insert>=3)for(ie=G.strstart-G.insert,G.ins_h=G.window[ie],G.ins_h=(G.ins_h<<G.hash_shift^G.window[ie+1])&G.hash_mask;G.insert&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[ie+3-1])&G.hash_mask,G.prev[ie&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=ie,ie++,G.insert--,!(G.lookahead+G.insert<3)););}while(G.lookahead<j&&G.strm.avail_in!==0)}function E(G,ee){for(var V,H;;){if(G.lookahead<j){if(T(G),G.lookahead<j&&ee===0)return 1;if(G.lookahead===0)break}if(V=0,G.lookahead>=3&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),V!==0&&G.strstart-V<=G.w_size-j&&(G.match_length=_(G,V)),G.match_length>=3)if(H=y._tr_tally(G,G.strstart-G.match_start,G.match_length-3),G.lookahead-=G.match_length,G.match_length<=G.max_lazy_match&&G.lookahead>=3){for(G.match_length--;G.strstart++,G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart,--G.match_length!=0;);G.strstart++}else G.strstart+=G.match_length,G.match_length=0,G.ins_h=G.window[G.strstart],G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+1])&G.hash_mask;else H=y._tr_tally(G,0,G.window[G.strstart]),G.lookahead--,G.strstart++;if(H&&(B(G,!1),G.strm.avail_out===0))return 1}return G.insert=G.strstart<2?G.strstart:2,ee===4?(B(G,!0),G.strm.avail_out===0?3:4):G.last_lit&&(B(G,!1),G.strm.avail_out===0)?1:2}function D(G,ee){for(var V,H,Z;;){if(G.lookahead<j){if(T(G),G.lookahead<j&&ee===0)return 1;if(G.lookahead===0)break}if(V=0,G.lookahead>=3&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),G.prev_length=G.match_length,G.prev_match=G.match_start,G.match_length=2,V!==0&&G.prev_length<G.max_lazy_match&&G.strstart-V<=G.w_size-j&&(G.match_length=_(G,V),G.match_length<=5&&(G.strategy===1||G.match_length===3&&4096<G.strstart-G.match_start)&&(G.match_length=2)),G.prev_length>=3&&G.match_length<=G.prev_length){for(Z=G.strstart+G.lookahead-3,H=y._tr_tally(G,G.strstart-1-G.prev_match,G.prev_length-3),G.lookahead-=G.prev_length-1,G.prev_length-=2;++G.strstart<=Z&&(G.ins_h=(G.ins_h<<G.hash_shift^G.window[G.strstart+3-1])&G.hash_mask,V=G.prev[G.strstart&G.w_mask]=G.head[G.ins_h],G.head[G.ins_h]=G.strstart),--G.prev_length!=0;);if(G.match_available=0,G.match_length=2,G.strstart++,H&&(B(G,!1),G.strm.avail_out===0))return 1}else if(G.match_available){if((H=y._tr_tally(G,0,G.window[G.strstart-1]))&&B(G,!1),G.strstart++,G.lookahead--,G.strm.avail_out===0)return 1}else G.match_available=1,G.strstart++,G.lookahead--}return G.match_available&&(H=y._tr_tally(G,0,G.window[G.strstart-1]),G.match_available=0),G.insert=G.strstart<2?G.strstart:2,ee===4?(B(G,!0),G.strm.avail_out===0?3:4):G.last_lit&&(B(G,!1),G.strm.avail_out===0)?1:2}function O(G,ee,V,H,Z){this.good_length=G,this.max_lazy=ee,this.nice_length=V,this.max_chain=H,this.func=Z}function P(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new w.Buf16(1146),this.dyn_dtree=new w.Buf16(122),this.bl_tree=new w.Buf16(78),z(this.dyn_ltree),z(this.dyn_dtree),z(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new w.Buf16(16),this.heap=new w.Buf16(573),z(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new w.Buf16(573),z(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function q(G){var ee;return G&&G.state?(G.total_in=G.total_out=0,G.data_type=2,(ee=G.state).pending=0,ee.pending_out=0,ee.wrap<0&&(ee.wrap=-ee.wrap),ee.status=ee.wrap?42:L,G.adler=ee.wrap===2?0:1,ee.last_flush=0,y._tr_init(ee),0):W(G,I)}function X(G){var ee=q(G);return ee===0&&(function(V){V.window_size=2*V.w_size,z(V.head),V.max_lazy_match=g[V.level].max_lazy,V.good_match=g[V.level].good_length,V.nice_match=g[V.level].nice_length,V.max_chain_length=g[V.level].max_chain,V.strstart=0,V.block_start=0,V.lookahead=0,V.insert=0,V.match_length=V.prev_length=2,V.match_available=0,V.ins_h=0})(G.state),ee}function Q(G,ee,V,H,Z,ie){if(!G)return I;var te=1;if(ee===-1&&(ee=6),H<0?(te=0,H=-H):15<H&&(te=2,H-=16),Z<1||9<Z||V!==8||H<8||15<H||ee<0||9<ee||ie<0||4<ie)return W(G,I);H===8&&(H=9);var oe=new P;return(G.state=oe).strm=G,oe.wrap=te,oe.gzhead=null,oe.w_bits=H,oe.w_size=1<<oe.w_bits,oe.w_mask=oe.w_size-1,oe.hash_bits=Z+7,oe.hash_size=1<<oe.hash_bits,oe.hash_mask=oe.hash_size-1,oe.hash_shift=~~((oe.hash_bits+3-1)/3),oe.window=new w.Buf8(2*oe.w_size),oe.head=new w.Buf16(oe.hash_size),oe.prev=new w.Buf16(oe.w_size),oe.lit_bufsize=1<<Z+6,oe.pending_buf_size=4*oe.lit_bufsize,oe.pending_buf=new w.Buf8(oe.pending_buf_size),oe.d_buf=1*oe.lit_bufsize,oe.l_buf=3*oe.lit_bufsize,oe.level=ee,oe.strategy=ie,oe.method=V,X(G)}g=[new O(0,0,0,0,(function(G,ee){var V=65535;for(V>G.pending_buf_size-5&&(V=G.pending_buf_size-5);;){if(G.lookahead<=1){if(T(G),G.lookahead===0&&ee===0)return 1;if(G.lookahead===0)break}G.strstart+=G.lookahead,G.lookahead=0;var H=G.block_start+V;if((G.strstart===0||G.strstart>=H)&&(G.lookahead=G.strstart-H,G.strstart=H,B(G,!1),G.strm.avail_out===0)||G.strstart-G.block_start>=G.w_size-j&&(B(G,!1),G.strm.avail_out===0))return 1}return G.insert=0,ee===4?(B(G,!0),G.strm.avail_out===0?3:4):(G.strstart>G.block_start&&(B(G,!1),G.strm.avail_out),1)})),new O(4,4,8,4,E),new O(4,5,16,8,E),new O(4,6,32,32,E),new O(4,4,16,16,D),new O(8,16,32,32,D),new O(8,16,128,128,D),new O(8,32,128,256,D),new O(32,128,258,1024,D),new O(32,258,258,4096,D)],v.deflateInit=function(G,ee){return Q(G,ee,8,15,8,0)},v.deflateInit2=Q,v.deflateReset=X,v.deflateResetKeep=q,v.deflateSetHeader=function(G,ee){return G&&G.state?G.state.wrap!==2?I:(G.state.gzhead=ee,0):I},v.deflate=function(G,ee){var V,H,Z,ie;if(!G||!G.state||5<ee||ee<0)return G?W(G,I):I;if(H=G.state,!G.output||!G.input&&G.avail_in!==0||H.status===666&&ee!==4)return W(G,G.avail_out===0?-5:I);if(H.strm=G,V=H.last_flush,H.last_flush=ee,H.status===42)if(H.wrap===2)G.adler=0,R(H,31),R(H,139),R(H,8),H.gzhead?(R(H,(H.gzhead.text?1:0)+(H.gzhead.hcrc?2:0)+(H.gzhead.extra?4:0)+(H.gzhead.name?8:0)+(H.gzhead.comment?16:0)),R(H,255&H.gzhead.time),R(H,H.gzhead.time>>8&255),R(H,H.gzhead.time>>16&255),R(H,H.gzhead.time>>24&255),R(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),R(H,255&H.gzhead.os),H.gzhead.extra&&H.gzhead.extra.length&&(R(H,255&H.gzhead.extra.length),R(H,H.gzhead.extra.length>>8&255)),H.gzhead.hcrc&&(G.adler=k(G.adler,H.pending_buf,H.pending,0)),H.gzindex=0,H.status=69):(R(H,0),R(H,0),R(H,0),R(H,0),R(H,0),R(H,H.level===9?2:2<=H.strategy||H.level<2?4:0),R(H,3),H.status=L);else{var te=8+(H.w_bits-8<<4)<<8;te|=(2<=H.strategy||H.level<2?0:H.level<6?1:H.level===6?2:3)<<6,H.strstart!==0&&(te|=32),te+=31-te%31,H.status=L,S(H,te),H.strstart!==0&&(S(H,G.adler>>>16),S(H,65535&G.adler)),G.adler=1}if(H.status===69)if(H.gzhead.extra){for(Z=H.pending;H.gzindex<(65535&H.gzhead.extra.length)&&(H.pending!==H.pending_buf_size||(H.gzhead.hcrc&&H.pending>Z&&(G.adler=k(G.adler,H.pending_buf,H.pending-Z,Z)),M(G),Z=H.pending,H.pending!==H.pending_buf_size));)R(H,255&H.gzhead.extra[H.gzindex]),H.gzindex++;H.gzhead.hcrc&&H.pending>Z&&(G.adler=k(G.adler,H.pending_buf,H.pending-Z,Z)),H.gzindex===H.gzhead.extra.length&&(H.gzindex=0,H.status=73)}else H.status=73;if(H.status===73)if(H.gzhead.name){Z=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>Z&&(G.adler=k(G.adler,H.pending_buf,H.pending-Z,Z)),M(G),Z=H.pending,H.pending===H.pending_buf_size)){ie=1;break}ie=H.gzindex<H.gzhead.name.length?255&H.gzhead.name.charCodeAt(H.gzindex++):0,R(H,ie)}while(ie!==0);H.gzhead.hcrc&&H.pending>Z&&(G.adler=k(G.adler,H.pending_buf,H.pending-Z,Z)),ie===0&&(H.gzindex=0,H.status=91)}else H.status=91;if(H.status===91)if(H.gzhead.comment){Z=H.pending;do{if(H.pending===H.pending_buf_size&&(H.gzhead.hcrc&&H.pending>Z&&(G.adler=k(G.adler,H.pending_buf,H.pending-Z,Z)),M(G),Z=H.pending,H.pending===H.pending_buf_size)){ie=1;break}ie=H.gzindex<H.gzhead.comment.length?255&H.gzhead.comment.charCodeAt(H.gzindex++):0,R(H,ie)}while(ie!==0);H.gzhead.hcrc&&H.pending>Z&&(G.adler=k(G.adler,H.pending_buf,H.pending-Z,Z)),ie===0&&(H.status=103)}else H.status=103;if(H.status===103&&(H.gzhead.hcrc?(H.pending+2>H.pending_buf_size&&M(G),H.pending+2<=H.pending_buf_size&&(R(H,255&G.adler),R(H,G.adler>>8&255),G.adler=0,H.status=L)):H.status=L),H.pending!==0){if(M(G),G.avail_out===0)return H.last_flush=-1,0}else if(G.avail_in===0&&K(ee)<=K(V)&&ee!==4)return W(G,-5);if(H.status===666&&G.avail_in!==0)return W(G,-5);if(G.avail_in!==0||H.lookahead!==0||ee!==0&&H.status!==666){var oe=H.strategy===2?(function(ue,Ce){for(var ye;;){if(ue.lookahead===0&&(T(ue),ue.lookahead===0)){if(Ce===0)return 1;break}if(ue.match_length=0,ye=y._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++,ye&&(B(ue,!1),ue.strm.avail_out===0))return 1}return ue.insert=0,Ce===4?(B(ue,!0),ue.strm.avail_out===0?3:4):ue.last_lit&&(B(ue,!1),ue.strm.avail_out===0)?1:2})(H,ee):H.strategy===3?(function(ue,Ce){for(var ye,ne,me,ve,Te=ue.window;;){if(ue.lookahead<=N){if(T(ue),ue.lookahead<=N&&Ce===0)return 1;if(ue.lookahead===0)break}if(ue.match_length=0,ue.lookahead>=3&&0<ue.strstart&&(ne=Te[me=ue.strstart-1])===Te[++me]&&ne===Te[++me]&&ne===Te[++me]){ve=ue.strstart+N;do;while(ne===Te[++me]&&ne===Te[++me]&&ne===Te[++me]&&ne===Te[++me]&&ne===Te[++me]&&ne===Te[++me]&&ne===Te[++me]&&ne===Te[++me]&&me<ve);ue.match_length=N-(ve-me),ue.match_length>ue.lookahead&&(ue.match_length=ue.lookahead)}if(ue.match_length>=3?(ye=y._tr_tally(ue,1,ue.match_length-3),ue.lookahead-=ue.match_length,ue.strstart+=ue.match_length,ue.match_length=0):(ye=y._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++),ye&&(B(ue,!1),ue.strm.avail_out===0))return 1}return ue.insert=0,Ce===4?(B(ue,!0),ue.strm.avail_out===0?3:4):ue.last_lit&&(B(ue,!1),ue.strm.avail_out===0)?1:2})(H,ee):g[H.level].func(H,ee);if(oe!==3&&oe!==4||(H.status=666),oe===1||oe===3)return G.avail_out===0&&(H.last_flush=-1),0;if(oe===2&&(ee===1?y._tr_align(H):ee!==5&&(y._tr_stored_block(H,0,0,!1),ee===3&&(z(H.head),H.lookahead===0&&(H.strstart=0,H.block_start=0,H.insert=0))),M(G),G.avail_out===0))return H.last_flush=-1,0}return ee!==4?0:H.wrap<=0?1:(H.wrap===2?(R(H,255&G.adler),R(H,G.adler>>8&255),R(H,G.adler>>16&255),R(H,G.adler>>24&255),R(H,255&G.total_in),R(H,G.total_in>>8&255),R(H,G.total_in>>16&255),R(H,G.total_in>>24&255)):(S(H,G.adler>>>16),S(H,65535&G.adler)),M(G),0<H.wrap&&(H.wrap=-H.wrap),H.pending!==0?0:1)},v.deflateEnd=function(G){var ee;return G&&G.state?(ee=G.state.status)!==42&&ee!==69&&ee!==73&&ee!==91&&ee!==103&&ee!==L&&ee!==666?W(G,I):(G.state=null,ee===L?W(G,-3):0):I},v.deflateSetDictionary=function(G,ee){var V,H,Z,ie,te,oe,ue,Ce,ye=ee.length;if(!G||!G.state||(ie=(V=G.state).wrap)===2||ie===1&&V.status!==42||V.lookahead)return I;for(ie===1&&(G.adler=C(G.adler,ee,ye,0)),V.wrap=0,ye>=V.w_size&&(ie===0&&(z(V.head),V.strstart=0,V.block_start=0,V.insert=0),Ce=new w.Buf8(V.w_size),w.arraySet(Ce,ee,ye-V.w_size,V.w_size,0),ee=Ce,ye=V.w_size),te=G.avail_in,oe=G.next_in,ue=G.input,G.avail_in=ye,G.next_in=0,G.input=ee,T(V);V.lookahead>=3;){for(H=V.strstart,Z=V.lookahead-2;V.ins_h=(V.ins_h<<V.hash_shift^V.window[H+3-1])&V.hash_mask,V.prev[H&V.w_mask]=V.head[V.ins_h],V.head[V.ins_h]=H,H++,--Z;);V.strstart=H,V.lookahead=2,T(V)}return V.strstart+=V.lookahead,V.block_start=V.strstart,V.insert=V.lookahead,V.lookahead=0,V.match_length=V.prev_length=2,V.match_available=0,G.next_in=oe,G.input=ue,G.avail_in=te,V.wrap=ie,0},v.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(f,m,v){m.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(f,m,v){m.exports=function(g,w){var y,C,k,F,I,N,j,L,W,K,z,M,B,R,S,_,T,E,D,O,P,q,X,Q,G;y=g.state,C=g.next_in,Q=g.input,k=C+(g.avail_in-5),F=g.next_out,G=g.output,I=F-(w-g.avail_out),N=F+(g.avail_out-257),j=y.dmax,L=y.wsize,W=y.whave,K=y.wnext,z=y.window,M=y.hold,B=y.bits,R=y.lencode,S=y.distcode,_=(1<<y.lenbits)-1,T=(1<<y.distbits)-1;e:do{B<15&&(M+=Q[C++]<<B,B+=8,M+=Q[C++]<<B,B+=8),E=R[M&_];t:for(;;){if(M>>>=D=E>>>24,B-=D,(D=E>>>16&255)==0)G[F++]=65535&E;else{if(!(16&D)){if((64&D)==0){E=R[(65535&E)+(M&(1<<D)-1)];continue t}if(32&D){y.mode=12;break e}g.msg="invalid literal/length code",y.mode=30;break e}O=65535&E,(D&=15)&&(B<D&&(M+=Q[C++]<<B,B+=8),O+=M&(1<<D)-1,M>>>=D,B-=D),B<15&&(M+=Q[C++]<<B,B+=8,M+=Q[C++]<<B,B+=8),E=S[M&T];r:for(;;){if(M>>>=D=E>>>24,B-=D,!(16&(D=E>>>16&255))){if((64&D)==0){E=S[(65535&E)+(M&(1<<D)-1)];continue r}g.msg="invalid distance code",y.mode=30;break e}if(P=65535&E,B<(D&=15)&&(M+=Q[C++]<<B,(B+=8)<D&&(M+=Q[C++]<<B,B+=8)),j<(P+=M&(1<<D)-1)){g.msg="invalid distance too far back",y.mode=30;break e}if(M>>>=D,B-=D,(D=F-I)<P){if(W<(D=P-D)&&y.sane){g.msg="invalid distance too far back",y.mode=30;break e}if(X=z,(q=0)===K){if(q+=L-D,D<O){for(O-=D;G[F++]=z[q++],--D;);q=F-P,X=G}}else if(K<D){if(q+=L+K-D,(D-=K)<O){for(O-=D;G[F++]=z[q++],--D;);if(q=0,K<O){for(O-=D=K;G[F++]=z[q++],--D;);q=F-P,X=G}}}else if(q+=K-D,D<O){for(O-=D;G[F++]=z[q++],--D;);q=F-P,X=G}for(;2<O;)G[F++]=X[q++],G[F++]=X[q++],G[F++]=X[q++],O-=3;O&&(G[F++]=X[q++],1<O&&(G[F++]=X[q++]))}else{for(q=F-P;G[F++]=G[q++],G[F++]=G[q++],G[F++]=G[q++],2<(O-=3););O&&(G[F++]=G[q++],1<O&&(G[F++]=G[q++]))}break}}break}}while(C<k&&F<N);C-=O=B>>3,M&=(1<<(B-=O<<3))-1,g.next_in=C,g.next_out=F,g.avail_in=C<k?k-C+5:5-(C-k),g.avail_out=F<N?N-F+257:257-(F-N),y.hold=M,y.bits=B}},{}],49:[function(f,m,v){var g=f("../utils/common"),w=f("./adler32"),y=f("./crc32"),C=f("./inffast"),k=f("./inftrees"),F=-2;function I(_){return(_>>>24&255)+(_>>>8&65280)+((65280&_)<<8)+((255&_)<<24)}function N(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new g.Buf16(320),this.work=new g.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function j(_){var T;return _&&_.state?(T=_.state,_.total_in=_.total_out=T.total=0,_.msg="",T.wrap&&(_.adler=1&T.wrap),T.mode=1,T.last=0,T.havedict=0,T.dmax=32768,T.head=null,T.hold=0,T.bits=0,T.lencode=T.lendyn=new g.Buf32(852),T.distcode=T.distdyn=new g.Buf32(592),T.sane=1,T.back=-1,0):F}function L(_){var T;return _&&_.state?((T=_.state).wsize=0,T.whave=0,T.wnext=0,j(_)):F}function W(_,T){var E,D;return _&&_.state?(D=_.state,T<0?(E=0,T=-T):(E=1+(T>>4),T<48&&(T&=15)),T&&(T<8||15<T)?F:(D.window!==null&&D.wbits!==T&&(D.window=null),D.wrap=E,D.wbits=T,L(_))):F}function K(_,T){var E,D;return _?(D=new N,(_.state=D).window=null,(E=W(_,T))!==0&&(_.state=null),E):F}var z,M,B=!0;function R(_){if(B){var T;for(z=new g.Buf32(512),M=new g.Buf32(32),T=0;T<144;)_.lens[T++]=8;for(;T<256;)_.lens[T++]=9;for(;T<280;)_.lens[T++]=7;for(;T<288;)_.lens[T++]=8;for(k(1,_.lens,0,288,z,0,_.work,{bits:9}),T=0;T<32;)_.lens[T++]=5;k(2,_.lens,0,32,M,0,_.work,{bits:5}),B=!1}_.lencode=z,_.lenbits=9,_.distcode=M,_.distbits=5}function S(_,T,E,D){var O,P=_.state;return P.window===null&&(P.wsize=1<<P.wbits,P.wnext=0,P.whave=0,P.window=new g.Buf8(P.wsize)),D>=P.wsize?(g.arraySet(P.window,T,E-P.wsize,P.wsize,0),P.wnext=0,P.whave=P.wsize):(D<(O=P.wsize-P.wnext)&&(O=D),g.arraySet(P.window,T,E-D,O,P.wnext),(D-=O)?(g.arraySet(P.window,T,E-D,D,0),P.wnext=D,P.whave=P.wsize):(P.wnext+=O,P.wnext===P.wsize&&(P.wnext=0),P.whave<P.wsize&&(P.whave+=O))),0}v.inflateReset=L,v.inflateReset2=W,v.inflateResetKeep=j,v.inflateInit=function(_){return K(_,15)},v.inflateInit2=K,v.inflate=function(_,T){var E,D,O,P,q,X,Q,G,ee,V,H,Z,ie,te,oe,ue,Ce,ye,ne,me,ve,Te,xe,Fe,Ge=0,Ve=new g.Buf8(4),Ye=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!_||!_.state||!_.output||!_.input&&_.avail_in!==0)return F;(E=_.state).mode===12&&(E.mode=13),q=_.next_out,O=_.output,Q=_.avail_out,P=_.next_in,D=_.input,X=_.avail_in,G=E.hold,ee=E.bits,V=X,H=Q,Te=0;e:for(;;)switch(E.mode){case 1:if(E.wrap===0){E.mode=13;break}for(;ee<16;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}if(2&E.wrap&&G===35615){Ve[E.check=0]=255&G,Ve[1]=G>>>8&255,E.check=y(E.check,Ve,2,0),ee=G=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&G)<<8)+(G>>8))%31){_.msg="incorrect header check",E.mode=30;break}if((15&G)!=8){_.msg="unknown compression method",E.mode=30;break}if(ee-=4,ve=8+(15&(G>>>=4)),E.wbits===0)E.wbits=ve;else if(ve>E.wbits){_.msg="invalid window size",E.mode=30;break}E.dmax=1<<ve,_.adler=E.check=1,E.mode=512&G?10:12,ee=G=0;break;case 2:for(;ee<16;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}if(E.flags=G,(255&E.flags)!=8){_.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){_.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=G>>8&1),512&E.flags&&(Ve[0]=255&G,Ve[1]=G>>>8&255,E.check=y(E.check,Ve,2,0)),ee=G=0,E.mode=3;case 3:for(;ee<32;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}E.head&&(E.head.time=G),512&E.flags&&(Ve[0]=255&G,Ve[1]=G>>>8&255,Ve[2]=G>>>16&255,Ve[3]=G>>>24&255,E.check=y(E.check,Ve,4,0)),ee=G=0,E.mode=4;case 4:for(;ee<16;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}E.head&&(E.head.xflags=255&G,E.head.os=G>>8),512&E.flags&&(Ve[0]=255&G,Ve[1]=G>>>8&255,E.check=y(E.check,Ve,2,0)),ee=G=0,E.mode=5;case 5:if(1024&E.flags){for(;ee<16;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}E.length=G,E.head&&(E.head.extra_len=G),512&E.flags&&(Ve[0]=255&G,Ve[1]=G>>>8&255,E.check=y(E.check,Ve,2,0)),ee=G=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(X<(Z=E.length)&&(Z=X),Z&&(E.head&&(ve=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),g.arraySet(E.head.extra,D,P,Z,ve)),512&E.flags&&(E.check=y(E.check,D,Z,P)),X-=Z,P+=Z,E.length-=Z),E.length))break e;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(X===0)break e;for(Z=0;ve=D[P+Z++],E.head&&ve&&E.length<65536&&(E.head.name+=String.fromCharCode(ve)),ve&&Z<X;);if(512&E.flags&&(E.check=y(E.check,D,Z,P)),X-=Z,P+=Z,ve)break e}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(X===0)break e;for(Z=0;ve=D[P+Z++],E.head&&ve&&E.length<65536&&(E.head.comment+=String.fromCharCode(ve)),ve&&Z<X;);if(512&E.flags&&(E.check=y(E.check,D,Z,P)),X-=Z,P+=Z,ve)break e}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;ee<16;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}if(G!==(65535&E.check)){_.msg="header crc mismatch",E.mode=30;break}ee=G=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),_.adler=E.check=0,E.mode=12;break;case 10:for(;ee<32;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}_.adler=E.check=I(G),ee=G=0,E.mode=11;case 11:if(E.havedict===0)return _.next_out=q,_.avail_out=Q,_.next_in=P,_.avail_in=X,E.hold=G,E.bits=ee,2;_.adler=E.check=1,E.mode=12;case 12:if(T===5||T===6)break e;case 13:if(E.last){G>>>=7&ee,ee-=7&ee,E.mode=27;break}for(;ee<3;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}switch(E.last=1&G,ee-=1,3&(G>>>=1)){case 0:E.mode=14;break;case 1:if(R(E),E.mode=20,T!==6)break;G>>>=2,ee-=2;break e;case 2:E.mode=17;break;case 3:_.msg="invalid block type",E.mode=30}G>>>=2,ee-=2;break;case 14:for(G>>>=7&ee,ee-=7&ee;ee<32;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}if((65535&G)!=(G>>>16^65535)){_.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&G,ee=G=0,E.mode=15,T===6)break e;case 15:E.mode=16;case 16:if(Z=E.length){if(X<Z&&(Z=X),Q<Z&&(Z=Q),Z===0)break e;g.arraySet(O,D,P,Z,q),X-=Z,P+=Z,Q-=Z,q+=Z,E.length-=Z;break}E.mode=12;break;case 17:for(;ee<14;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}if(E.nlen=257+(31&G),G>>>=5,ee-=5,E.ndist=1+(31&G),G>>>=5,ee-=5,E.ncode=4+(15&G),G>>>=4,ee-=4,286<E.nlen||30<E.ndist){_.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;ee<3;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}E.lens[Ye[E.have++]]=7&G,G>>>=3,ee-=3}for(;E.have<19;)E.lens[Ye[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,xe={bits:E.lenbits},Te=k(0,E.lens,0,19,E.lencode,0,E.work,xe),E.lenbits=xe.bits,Te){_.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;ue=(Ge=E.lencode[G&(1<<E.lenbits)-1])>>>16&255,Ce=65535&Ge,!((oe=Ge>>>24)<=ee);){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}if(Ce<16)G>>>=oe,ee-=oe,E.lens[E.have++]=Ce;else{if(Ce===16){for(Fe=oe+2;ee<Fe;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}if(G>>>=oe,ee-=oe,E.have===0){_.msg="invalid bit length repeat",E.mode=30;break}ve=E.lens[E.have-1],Z=3+(3&G),G>>>=2,ee-=2}else if(Ce===17){for(Fe=oe+3;ee<Fe;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}ee-=oe,ve=0,Z=3+(7&(G>>>=oe)),G>>>=3,ee-=3}else{for(Fe=oe+7;ee<Fe;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}ee-=oe,ve=0,Z=11+(127&(G>>>=oe)),G>>>=7,ee-=7}if(E.have+Z>E.nlen+E.ndist){_.msg="invalid bit length repeat",E.mode=30;break}for(;Z--;)E.lens[E.have++]=ve}}if(E.mode===30)break;if(E.lens[256]===0){_.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,xe={bits:E.lenbits},Te=k(1,E.lens,0,E.nlen,E.lencode,0,E.work,xe),E.lenbits=xe.bits,Te){_.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,xe={bits:E.distbits},Te=k(2,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,xe),E.distbits=xe.bits,Te){_.msg="invalid distances set",E.mode=30;break}if(E.mode=20,T===6)break e;case 20:E.mode=21;case 21:if(6<=X&&258<=Q){_.next_out=q,_.avail_out=Q,_.next_in=P,_.avail_in=X,E.hold=G,E.bits=ee,C(_,H),q=_.next_out,O=_.output,Q=_.avail_out,P=_.next_in,D=_.input,X=_.avail_in,G=E.hold,ee=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;ue=(Ge=E.lencode[G&(1<<E.lenbits)-1])>>>16&255,Ce=65535&Ge,!((oe=Ge>>>24)<=ee);){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}if(ue&&(240&ue)==0){for(ye=oe,ne=ue,me=Ce;ue=(Ge=E.lencode[me+((G&(1<<ye+ne)-1)>>ye)])>>>16&255,Ce=65535&Ge,!(ye+(oe=Ge>>>24)<=ee);){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}G>>>=ye,ee-=ye,E.back+=ye}if(G>>>=oe,ee-=oe,E.back+=oe,E.length=Ce,ue===0){E.mode=26;break}if(32&ue){E.back=-1,E.mode=12;break}if(64&ue){_.msg="invalid literal/length code",E.mode=30;break}E.extra=15&ue,E.mode=22;case 22:if(E.extra){for(Fe=E.extra;ee<Fe;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}E.length+=G&(1<<E.extra)-1,G>>>=E.extra,ee-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;ue=(Ge=E.distcode[G&(1<<E.distbits)-1])>>>16&255,Ce=65535&Ge,!((oe=Ge>>>24)<=ee);){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}if((240&ue)==0){for(ye=oe,ne=ue,me=Ce;ue=(Ge=E.distcode[me+((G&(1<<ye+ne)-1)>>ye)])>>>16&255,Ce=65535&Ge,!(ye+(oe=Ge>>>24)<=ee);){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}G>>>=ye,ee-=ye,E.back+=ye}if(G>>>=oe,ee-=oe,E.back+=oe,64&ue){_.msg="invalid distance code",E.mode=30;break}E.offset=Ce,E.extra=15&ue,E.mode=24;case 24:if(E.extra){for(Fe=E.extra;ee<Fe;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}E.offset+=G&(1<<E.extra)-1,G>>>=E.extra,ee-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){_.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if(Q===0)break e;if(Z=H-Q,E.offset>Z){if((Z=E.offset-Z)>E.whave&&E.sane){_.msg="invalid distance too far back",E.mode=30;break}ie=Z>E.wnext?(Z-=E.wnext,E.wsize-Z):E.wnext-Z,Z>E.length&&(Z=E.length),te=E.window}else te=O,ie=q-E.offset,Z=E.length;for(Q<Z&&(Z=Q),Q-=Z,E.length-=Z;O[q++]=te[ie++],--Z;);E.length===0&&(E.mode=21);break;case 26:if(Q===0)break e;O[q++]=E.length,Q--,E.mode=21;break;case 27:if(E.wrap){for(;ee<32;){if(X===0)break e;X--,G|=D[P++]<<ee,ee+=8}if(H-=Q,_.total_out+=H,E.total+=H,H&&(_.adler=E.check=E.flags?y(E.check,O,H,q-H):w(E.check,O,H,q-H)),H=Q,(E.flags?G:I(G))!==E.check){_.msg="incorrect data check",E.mode=30;break}ee=G=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;ee<32;){if(X===0)break e;X--,G+=D[P++]<<ee,ee+=8}if(G!==(4294967295&E.total)){_.msg="incorrect length check",E.mode=30;break}ee=G=0}E.mode=29;case 29:Te=1;break e;case 30:Te=-3;break e;case 31:return-4;default:return F}return _.next_out=q,_.avail_out=Q,_.next_in=P,_.avail_in=X,E.hold=G,E.bits=ee,(E.wsize||H!==_.avail_out&&E.mode<30&&(E.mode<27||T!==4))&&S(_,_.output,_.next_out,H-_.avail_out)?(E.mode=31,-4):(V-=_.avail_in,H-=_.avail_out,_.total_in+=V,_.total_out+=H,E.total+=H,E.wrap&&H&&(_.adler=E.check=E.flags?y(E.check,O,H,_.next_out-H):w(E.check,O,H,_.next_out-H)),_.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(V==0&&H===0||T===4)&&Te===0&&(Te=-5),Te)},v.inflateEnd=function(_){if(!_||!_.state)return F;var T=_.state;return T.window&&(T.window=null),_.state=null,0},v.inflateGetHeader=function(_,T){var E;return _&&_.state?(2&(E=_.state).wrap)==0?F:((E.head=T).done=!1,0):F},v.inflateSetDictionary=function(_,T){var E,D=T.length;return _&&_.state?(E=_.state).wrap!==0&&E.mode!==11?F:E.mode===11&&w(1,T,D,0)!==E.check?-3:S(_,T,D,D)?(E.mode=31,-4):(E.havedict=1,0):F},v.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(f,m,v){var g=f("../utils/common"),w=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],y=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],C=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],k=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];m.exports=function(F,I,N,j,L,W,K,z){var M,B,R,S,_,T,E,D,O,P=z.bits,q=0,X=0,Q=0,G=0,ee=0,V=0,H=0,Z=0,ie=0,te=0,oe=null,ue=0,Ce=new g.Buf16(16),ye=new g.Buf16(16),ne=null,me=0;for(q=0;q<=15;q++)Ce[q]=0;for(X=0;X<j;X++)Ce[I[N+X]]++;for(ee=P,G=15;1<=G&&Ce[G]===0;G--);if(G<ee&&(ee=G),G===0)return L[W++]=20971520,L[W++]=20971520,z.bits=1,0;for(Q=1;Q<G&&Ce[Q]===0;Q++);for(ee<Q&&(ee=Q),q=Z=1;q<=15;q++)if(Z<<=1,(Z-=Ce[q])<0)return-1;if(0<Z&&(F===0||G!==1))return-1;for(ye[1]=0,q=1;q<15;q++)ye[q+1]=ye[q]+Ce[q];for(X=0;X<j;X++)I[N+X]!==0&&(K[ye[I[N+X]]++]=X);if(T=F===0?(oe=ne=K,19):F===1?(oe=w,ue-=257,ne=y,me-=257,256):(oe=C,ne=k,-1),q=Q,_=W,H=X=te=0,R=-1,S=(ie=1<<(V=ee))-1,F===1&&852<ie||F===2&&592<ie)return 1;for(;;){for(E=q-H,O=K[X]<T?(D=0,K[X]):K[X]>T?(D=ne[me+K[X]],oe[ue+K[X]]):(D=96,0),M=1<<q-H,Q=B=1<<V;L[_+(te>>H)+(B-=M)]=E<<24|D<<16|O|0,B!==0;);for(M=1<<q-1;te&M;)M>>=1;if(M!==0?(te&=M-1,te+=M):te=0,X++,--Ce[q]==0){if(q===G)break;q=I[N+K[X]]}if(ee<q&&(te&S)!==R){for(H===0&&(H=ee),_+=Q,Z=1<<(V=q-H);V+H<G&&!((Z-=Ce[V+H])<=0);)V++,Z<<=1;if(ie+=1<<V,F===1&&852<ie||F===2&&592<ie)return 1;L[R=te&S]=ee<<24|V<<16|_-W|0}}return te!==0&&(L[_+te]=q-H<<24|64<<16|0),z.bits=ee,0}},{"../utils/common":41}],51:[function(f,m,v){m.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(f,m,v){var g=f("../utils/common");function w(ne){for(var me=ne.length;0<=--me;)ne[me]=0}var y=256,C=286,k=30,F=15,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=new Array(576);w(W);var K=new Array(60);w(K);var z=new Array(512);w(z);var M=new Array(256);w(M);var B=new Array(29);w(B);var R,S,_,T=new Array(k);function E(ne,me,ve,Te,xe){this.static_tree=ne,this.extra_bits=me,this.extra_base=ve,this.elems=Te,this.max_length=xe,this.has_stree=ne&&ne.length}function D(ne,me){this.dyn_tree=ne,this.max_code=0,this.stat_desc=me}function O(ne){return ne<256?z[ne]:z[256+(ne>>>7)]}function P(ne,me){ne.pending_buf[ne.pending++]=255&me,ne.pending_buf[ne.pending++]=me>>>8&255}function q(ne,me,ve){ne.bi_valid>16-ve?(ne.bi_buf|=me<<ne.bi_valid&65535,P(ne,ne.bi_buf),ne.bi_buf=me>>16-ne.bi_valid,ne.bi_valid+=ve-16):(ne.bi_buf|=me<<ne.bi_valid&65535,ne.bi_valid+=ve)}function X(ne,me,ve){q(ne,ve[2*me],ve[2*me+1])}function Q(ne,me){for(var ve=0;ve|=1&ne,ne>>>=1,ve<<=1,0<--me;);return ve>>>1}function G(ne,me,ve){var Te,xe,Fe=new Array(16),Ge=0;for(Te=1;Te<=F;Te++)Fe[Te]=Ge=Ge+ve[Te-1]<<1;for(xe=0;xe<=me;xe++){var Ve=ne[2*xe+1];Ve!==0&&(ne[2*xe]=Q(Fe[Ve]++,Ve))}}function ee(ne){var me;for(me=0;me<C;me++)ne.dyn_ltree[2*me]=0;for(me=0;me<k;me++)ne.dyn_dtree[2*me]=0;for(me=0;me<19;me++)ne.bl_tree[2*me]=0;ne.dyn_ltree[512]=1,ne.opt_len=ne.static_len=0,ne.last_lit=ne.matches=0}function V(ne){8<ne.bi_valid?P(ne,ne.bi_buf):0<ne.bi_valid&&(ne.pending_buf[ne.pending++]=ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0}function H(ne,me,ve,Te){var xe=2*me,Fe=2*ve;return ne[xe]<ne[Fe]||ne[xe]===ne[Fe]&&Te[me]<=Te[ve]}function Z(ne,me,ve){for(var Te=ne.heap[ve],xe=ve<<1;xe<=ne.heap_len&&(xe<ne.heap_len&&H(me,ne.heap[xe+1],ne.heap[xe],ne.depth)&&xe++,!H(me,Te,ne.heap[xe],ne.depth));)ne.heap[ve]=ne.heap[xe],ve=xe,xe<<=1;ne.heap[ve]=Te}function ie(ne,me,ve){var Te,xe,Fe,Ge,Ve=0;if(ne.last_lit!==0)for(;Te=ne.pending_buf[ne.d_buf+2*Ve]<<8|ne.pending_buf[ne.d_buf+2*Ve+1],xe=ne.pending_buf[ne.l_buf+Ve],Ve++,Te===0?X(ne,xe,me):(X(ne,(Fe=M[xe])+y+1,me),(Ge=I[Fe])!==0&&q(ne,xe-=B[Fe],Ge),X(ne,Fe=O(--Te),ve),(Ge=N[Fe])!==0&&q(ne,Te-=T[Fe],Ge)),Ve<ne.last_lit;);X(ne,256,me)}function te(ne,me){var ve,Te,xe,Fe=me.dyn_tree,Ge=me.stat_desc.static_tree,Ve=me.stat_desc.has_stree,Ye=me.stat_desc.elems,ut=-1;for(ne.heap_len=0,ne.heap_max=573,ve=0;ve<Ye;ve++)Fe[2*ve]!==0?(ne.heap[++ne.heap_len]=ut=ve,ne.depth[ve]=0):Fe[2*ve+1]=0;for(;ne.heap_len<2;)Fe[2*(xe=ne.heap[++ne.heap_len]=ut<2?++ut:0)]=1,ne.depth[xe]=0,ne.opt_len--,Ve&&(ne.static_len-=Ge[2*xe+1]);for(me.max_code=ut,ve=ne.heap_len>>1;1<=ve;ve--)Z(ne,Fe,ve);for(xe=Ye;ve=ne.heap[1],ne.heap[1]=ne.heap[ne.heap_len--],Z(ne,Fe,1),Te=ne.heap[1],ne.heap[--ne.heap_max]=ve,ne.heap[--ne.heap_max]=Te,Fe[2*xe]=Fe[2*ve]+Fe[2*Te],ne.depth[xe]=(ne.depth[ve]>=ne.depth[Te]?ne.depth[ve]:ne.depth[Te])+1,Fe[2*ve+1]=Fe[2*Te+1]=xe,ne.heap[1]=xe++,Z(ne,Fe,1),2<=ne.heap_len;);ne.heap[--ne.heap_max]=ne.heap[1],(function(ht,be){var ze,we,Ee,Ie,Pe,De,Ze=be.dyn_tree,pt=be.max_code,yt=be.stat_desc.static_tree,Pt=be.stat_desc.has_stree,$t=be.stat_desc.extra_bits,Ct=be.stat_desc.extra_base,It=be.stat_desc.max_length,Ut=0;for(Ie=0;Ie<=F;Ie++)ht.bl_count[Ie]=0;for(Ze[2*ht.heap[ht.heap_max]+1]=0,ze=ht.heap_max+1;ze<573;ze++)It<(Ie=Ze[2*Ze[2*(we=ht.heap[ze])+1]+1]+1)&&(Ie=It,Ut++),Ze[2*we+1]=Ie,pt<we||(ht.bl_count[Ie]++,Pe=0,Ct<=we&&(Pe=$t[we-Ct]),De=Ze[2*we],ht.opt_len+=De*(Ie+Pe),Pt&&(ht.static_len+=De*(yt[2*we+1]+Pe)));if(Ut!==0){do{for(Ie=It-1;ht.bl_count[Ie]===0;)Ie--;ht.bl_count[Ie]--,ht.bl_count[Ie+1]+=2,ht.bl_count[It]--,Ut-=2}while(0<Ut);for(Ie=It;Ie!==0;Ie--)for(we=ht.bl_count[Ie];we!==0;)pt<(Ee=ht.heap[--ze])||(Ze[2*Ee+1]!==Ie&&(ht.opt_len+=(Ie-Ze[2*Ee+1])*Ze[2*Ee],Ze[2*Ee+1]=Ie),we--)}})(ne,me),G(Fe,ut,ne.bl_count)}function oe(ne,me,ve){var Te,xe,Fe=-1,Ge=me[1],Ve=0,Ye=7,ut=4;for(Ge===0&&(Ye=138,ut=3),me[2*(ve+1)+1]=65535,Te=0;Te<=ve;Te++)xe=Ge,Ge=me[2*(Te+1)+1],++Ve<Ye&&xe===Ge||(Ve<ut?ne.bl_tree[2*xe]+=Ve:xe!==0?(xe!==Fe&&ne.bl_tree[2*xe]++,ne.bl_tree[32]++):Ve<=10?ne.bl_tree[34]++:ne.bl_tree[36]++,Fe=xe,ut=(Ve=0)===Ge?(Ye=138,3):xe===Ge?(Ye=6,3):(Ye=7,4))}function ue(ne,me,ve){var Te,xe,Fe=-1,Ge=me[1],Ve=0,Ye=7,ut=4;for(Ge===0&&(Ye=138,ut=3),Te=0;Te<=ve;Te++)if(xe=Ge,Ge=me[2*(Te+1)+1],!(++Ve<Ye&&xe===Ge)){if(Ve<ut)for(;X(ne,xe,ne.bl_tree),--Ve!=0;);else xe!==0?(xe!==Fe&&(X(ne,xe,ne.bl_tree),Ve--),X(ne,16,ne.bl_tree),q(ne,Ve-3,2)):Ve<=10?(X(ne,17,ne.bl_tree),q(ne,Ve-3,3)):(X(ne,18,ne.bl_tree),q(ne,Ve-11,7));Fe=xe,ut=(Ve=0)===Ge?(Ye=138,3):xe===Ge?(Ye=6,3):(Ye=7,4)}}w(T);var Ce=!1;function ye(ne,me,ve,Te){q(ne,0+(Te?1:0),3),(function(xe,Fe,Ge,Ve){V(xe),P(xe,Ge),P(xe,~Ge),g.arraySet(xe.pending_buf,xe.window,Fe,Ge,xe.pending),xe.pending+=Ge})(ne,me,ve)}v._tr_init=function(ne){Ce||((function(){var me,ve,Te,xe,Fe,Ge=new Array(16);for(xe=Te=0;xe<28;xe++)for(B[xe]=Te,me=0;me<1<<I[xe];me++)M[Te++]=xe;for(M[Te-1]=xe,xe=Fe=0;xe<16;xe++)for(T[xe]=Fe,me=0;me<1<<N[xe];me++)z[Fe++]=xe;for(Fe>>=7;xe<k;xe++)for(T[xe]=Fe<<7,me=0;me<1<<N[xe]-7;me++)z[256+Fe++]=xe;for(ve=0;ve<=F;ve++)Ge[ve]=0;for(me=0;me<=143;)W[2*me+1]=8,me++,Ge[8]++;for(;me<=255;)W[2*me+1]=9,me++,Ge[9]++;for(;me<=279;)W[2*me+1]=7,me++,Ge[7]++;for(;me<=287;)W[2*me+1]=8,me++,Ge[8]++;for(G(W,287,Ge),me=0;me<k;me++)K[2*me+1]=5,K[2*me]=Q(me,5);R=new E(W,I,257,C,F),S=new E(K,N,0,k,F),_=new E(new Array(0),j,0,19,7)})(),Ce=!0),ne.l_desc=new D(ne.dyn_ltree,R),ne.d_desc=new D(ne.dyn_dtree,S),ne.bl_desc=new D(ne.bl_tree,_),ne.bi_buf=0,ne.bi_valid=0,ee(ne)},v._tr_stored_block=ye,v._tr_flush_block=function(ne,me,ve,Te){var xe,Fe,Ge=0;0<ne.level?(ne.strm.data_type===2&&(ne.strm.data_type=(function(Ve){var Ye,ut=4093624447;for(Ye=0;Ye<=31;Ye++,ut>>>=1)if(1&ut&&Ve.dyn_ltree[2*Ye]!==0)return 0;if(Ve.dyn_ltree[18]!==0||Ve.dyn_ltree[20]!==0||Ve.dyn_ltree[26]!==0)return 1;for(Ye=32;Ye<y;Ye++)if(Ve.dyn_ltree[2*Ye]!==0)return 1;return 0})(ne)),te(ne,ne.l_desc),te(ne,ne.d_desc),Ge=(function(Ve){var Ye;for(oe(Ve,Ve.dyn_ltree,Ve.l_desc.max_code),oe(Ve,Ve.dyn_dtree,Ve.d_desc.max_code),te(Ve,Ve.bl_desc),Ye=18;3<=Ye&&Ve.bl_tree[2*L[Ye]+1]===0;Ye--);return Ve.opt_len+=3*(Ye+1)+5+5+4,Ye})(ne),xe=ne.opt_len+3+7>>>3,(Fe=ne.static_len+3+7>>>3)<=xe&&(xe=Fe)):xe=Fe=ve+5,ve+4<=xe&&me!==-1?ye(ne,me,ve,Te):ne.strategy===4||Fe===xe?(q(ne,2+(Te?1:0),3),ie(ne,W,K)):(q(ne,4+(Te?1:0),3),(function(Ve,Ye,ut,ht){var be;for(q(Ve,Ye-257,5),q(Ve,ut-1,5),q(Ve,ht-4,4),be=0;be<ht;be++)q(Ve,Ve.bl_tree[2*L[be]+1],3);ue(Ve,Ve.dyn_ltree,Ye-1),ue(Ve,Ve.dyn_dtree,ut-1)})(ne,ne.l_desc.max_code+1,ne.d_desc.max_code+1,Ge+1),ie(ne,ne.dyn_ltree,ne.dyn_dtree)),ee(ne),Te&&V(ne)},v._tr_tally=function(ne,me,ve){return ne.pending_buf[ne.d_buf+2*ne.last_lit]=me>>>8&255,ne.pending_buf[ne.d_buf+2*ne.last_lit+1]=255&me,ne.pending_buf[ne.l_buf+ne.last_lit]=255&ve,ne.last_lit++,me===0?ne.dyn_ltree[2*ve]++:(ne.matches++,me--,ne.dyn_ltree[2*(M[ve]+y+1)]++,ne.dyn_dtree[2*O(me)]++),ne.last_lit===ne.lit_bufsize-1},v._tr_align=function(ne){q(ne,2,3),X(ne,256,W),(function(me){me.bi_valid===16?(P(me,me.bi_buf),me.bi_buf=0,me.bi_valid=0):8<=me.bi_valid&&(me.pending_buf[me.pending++]=255&me.bi_buf,me.bi_buf>>=8,me.bi_valid-=8)})(ne)}},{"../utils/common":41}],53:[function(f,m,v){m.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(f,m,v){(function(g){(function(w,y){if(!w.setImmediate){var C,k,F,I,N=1,j={},L=!1,W=w.document,K=Object.getPrototypeOf&&Object.getPrototypeOf(w);K=K&&K.setTimeout?K:w,C={}.toString.call(w.process)==="[object process]"?function(R){s.nextTick((function(){M(R)}))}:(function(){if(w.postMessage&&!w.importScripts){var R=!0,S=w.onmessage;return w.onmessage=function(){R=!1},w.postMessage("","*"),w.onmessage=S,R}})()?(I="setImmediate$"+Math.random()+"$",w.addEventListener?w.addEventListener("message",B,!1):w.attachEvent("onmessage",B),function(R){w.postMessage(I+R,"*")}):w.MessageChannel?((F=new MessageChannel).port1.onmessage=function(R){M(R.data)},function(R){F.port2.postMessage(R)}):W&&"onreadystatechange"in W.createElement("script")?(k=W.documentElement,function(R){var S=W.createElement("script");S.onreadystatechange=function(){M(R),S.onreadystatechange=null,k.removeChild(S),S=null},k.appendChild(S)}):function(R){setTimeout(M,0,R)},K.setImmediate=function(R){typeof R!="function"&&(R=new Function(""+R));for(var S=new Array(arguments.length-1),_=0;_<S.length;_++)S[_]=arguments[_+1];var T={callback:R,args:S};return j[N]=T,C(N),N++},K.clearImmediate=z}function z(R){delete j[R]}function M(R){if(L)setTimeout(M,0,R);else{var S=j[R];if(S){L=!0;try{(function(_){var T=_.callback,E=_.args;switch(E.length){case 0:T();break;case 1:T(E[0]);break;case 2:T(E[0],E[1]);break;case 3:T(E[0],E[1],E[2]);break;default:T.apply(void 0,E)}})(S)}finally{z(R),L=!1}}}}function B(R){R.source===w&&typeof R.data=="string"&&R.data.indexOf(I)===0&&M(+R.data.slice(I.length))}})(typeof self>"u"?g===void 0?this:g:self)}).call(this,o!==void 0?o:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)}))}).call(this)}).call(this,r("_process"),typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],r("timers").setImmediate)},{_process:467,buffer:220,timers:523}],442:[function(r,n,i){(function(s){(function(){var o=/[\\^$.*+?()[\]{}|]/g,a=RegExp(o.source),l=typeof s=="object"&&s&&s.Object===Object&&s,c=typeof self=="object"&&self&&self.Object===Object&&self,u=l||c||Function("return this")(),h=Object.prototype.toString,d=u.Symbol,f=d?d.prototype:void 0,m=f?f.toString:void 0;function v(g){if(typeof g=="string")return g;if((function(y){return typeof y=="symbol"||(function(C){return!!C&&typeof C=="object"})(y)&&h.call(y)=="[object Symbol]"})(g))return m?m.call(g):"";var w=g+"";return w=="0"&&1/g==-1/0?"-0":w}n.exports=function(g){var w;return(g=(w=g)==null?"":v(w))&&a.test(g)?g.replace(o,"\\$&"):g}}).call(this)}).call(this,typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{}],443:[function(r,n,i){(function(s){(function(){var o="[object Arguments]",a="[object Map]",l="[object Object]",c="[object Set]",u=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,h=/^\w*$/,d=/^\./,f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,m=/\\(\\)?/g,v=/^\[object .+?Constructor\]$/,g=/^(?:0|[1-9]\d*)$/,w={};w["[object Float32Array]"]=w["[object Float64Array]"]=w["[object Int8Array]"]=w["[object Int16Array]"]=w["[object Int32Array]"]=w["[object Uint8Array]"]=w["[object Uint8ClampedArray]"]=w["[object Uint16Array]"]=w["[object Uint32Array]"]=!0,w[o]=w["[object Array]"]=w["[object ArrayBuffer]"]=w["[object Boolean]"]=w["[object DataView]"]=w["[object Date]"]=w["[object Error]"]=w["[object Function]"]=w[a]=w["[object Number]"]=w[l]=w["[object RegExp]"]=w[c]=w["[object String]"]=w["[object WeakMap]"]=!1;var y=typeof s=="object"&&s&&s.Object===Object&&s,C=typeof self=="object"&&self&&self.Object===Object&&self,k=y||C||Function("return this")(),F=typeof i=="object"&&i&&!i.nodeType&&i,I=F&&typeof n=="object"&&n&&!n.nodeType&&n,N=I&&I.exports===F&&y.process,j=(function(){try{return N&&N.binding("util")}catch{}})(),L=j&&j.isTypedArray;function W(ce,Se,Le,Qe){for(var gt=-1,ot=ce?ce.length:0;++gt<ot;){var dt=ce[gt];Se(Qe,dt,Le(dt),ce)}return Qe}function K(ce,Se){for(var Le=-1,Qe=ce?ce.length:0;++Le<Qe;)if(Se(ce[Le],Le,ce))return!0;return!1}function z(ce){var Se=!1;if(ce!=null&&typeof ce.toString!="function")try{Se=!!(ce+"")}catch{}return Se}function M(ce){var Se=-1,Le=Array(ce.size);return ce.forEach((function(Qe,gt){Le[++Se]=[gt,Qe]})),Le}function B(ce){var Se=-1,Le=Array(ce.size);return ce.forEach((function(Qe){Le[++Se]=Qe})),Le}var R,S,_,T=Array.prototype,E=Function.prototype,D=Object.prototype,O=k["__core-js_shared__"],P=(R=/[^.]+$/.exec(O&&O.keys&&O.keys.IE_PROTO||""))?"Symbol(src)_1."+R:"",q=E.toString,X=D.hasOwnProperty,Q=D.toString,G=RegExp("^"+q.call(X).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ee=k.Symbol,V=k.Uint8Array,H=D.propertyIsEnumerable,Z=T.splice,ie=(S=Object.keys,_=Object,function(ce){return S(_(ce))}),te=Tt(k,"DataView"),oe=Tt(k,"Map"),ue=Tt(k,"Promise"),Ce=Tt(k,"Set"),ye=Tt(k,"WeakMap"),ne=Tt(Object,"create"),me=He(te),ve=He(oe),Te=He(ue),xe=He(Ce),Fe=He(ye),Ge=ee?ee.prototype:void 0,Ve=Ge?Ge.valueOf:void 0,Ye=Ge?Ge.toString:void 0;function ut(ce){var Se=-1,Le=ce?ce.length:0;for(this.clear();++Se<Le;){var Qe=ce[Se];this.set(Qe[0],Qe[1])}}function ht(ce){var Se=-1,Le=ce?ce.length:0;for(this.clear();++Se<Le;){var Qe=ce[Se];this.set(Qe[0],Qe[1])}}function be(ce){var Se=-1,Le=ce?ce.length:0;for(this.clear();++Se<Le;){var Qe=ce[Se];this.set(Qe[0],Qe[1])}}function ze(ce){var Se=-1,Le=ce?ce.length:0;for(this.__data__=new be;++Se<Le;)this.add(ce[Se])}function we(ce){this.__data__=new ht(ce)}function Ee(ce,Se){var Le=fe(ce)||de(ce)?(function(dt,Kt){for(var Nt=-1,Lt=Array(dt);++Nt<dt;)Lt[Nt]=Kt(Nt);return Lt})(ce.length,String):[],Qe=Le.length,gt=!!Qe;for(var ot in ce)!X.call(ce,ot)||gt&&(ot=="length"||vr(ot,Qe))||Le.push(ot);return Le}function Ie(ce,Se){for(var Le=ce.length;Le--;)if(le(ce[Le][0],Se))return Le;return-1}function Pe(ce,Se,Le,Qe){return Ze(ce,(function(gt,ot,dt){Se(Qe,gt,Le(gt),dt)})),Qe}ut.prototype.clear=function(){this.__data__=ne?ne(null):{}},ut.prototype.delete=function(ce){return this.has(ce)&&delete this.__data__[ce]},ut.prototype.get=function(ce){var Se=this.__data__;if(ne){var Le=Se[ce];return Le==="__lodash_hash_undefined__"?void 0:Le}return X.call(Se,ce)?Se[ce]:void 0},ut.prototype.has=function(ce){var Se=this.__data__;return ne?Se[ce]!==void 0:X.call(Se,ce)},ut.prototype.set=function(ce,Se){return this.__data__[ce]=ne&&Se===void 0?"__lodash_hash_undefined__":Se,this},ht.prototype.clear=function(){this.__data__=[]},ht.prototype.delete=function(ce){var Se=this.__data__,Le=Ie(Se,ce);return!(Le<0)&&(Le==Se.length-1?Se.pop():Z.call(Se,Le,1),!0)},ht.prototype.get=function(ce){var Se=this.__data__,Le=Ie(Se,ce);return Le<0?void 0:Se[Le][1]},ht.prototype.has=function(ce){return Ie(this.__data__,ce)>-1},ht.prototype.set=function(ce,Se){var Le=this.__data__,Qe=Ie(Le,ce);return Qe<0?Le.push([ce,Se]):Le[Qe][1]=Se,this},be.prototype.clear=function(){this.__data__={hash:new ut,map:new(oe||ht),string:new ut}},be.prototype.delete=function(ce){return Jt(this,ce).delete(ce)},be.prototype.get=function(ce){return Jt(this,ce).get(ce)},be.prototype.has=function(ce){return Jt(this,ce).has(ce)},be.prototype.set=function(ce,Se){return Jt(this,ce).set(ce,Se),this},ze.prototype.add=ze.prototype.push=function(ce){return this.__data__.set(ce,"__lodash_hash_undefined__"),this},ze.prototype.has=function(ce){return this.__data__.has(ce)},we.prototype.clear=function(){this.__data__=new ht},we.prototype.delete=function(ce){return this.__data__.delete(ce)},we.prototype.get=function(ce){return this.__data__.get(ce)},we.prototype.has=function(ce){return this.__data__.has(ce)},we.prototype.set=function(ce,Se){var Le=this.__data__;if(Le instanceof ht){var Qe=Le.__data__;if(!oe||Qe.length<199)return Qe.push([ce,Se]),this;Le=this.__data__=new be(Qe)}return Le.set(ce,Se),this};var De,Ze=(De=function(ce,Se){return ce&&pt(ce,Se,ct)},function(ce,Se){if(ce==null)return ce;if(!ge(ce))return De(ce,Se);for(var Le=ce.length,Qe=-1,gt=Object(ce);++Qe<Le&&Se(gt[Qe],Qe,gt)!==!1;);return ce}),pt=(function(ce){return function(Se,Le,Qe){for(var gt=-1,ot=Object(Se),dt=Qe(Se),Kt=dt.length;Kt--;){var Nt=dt[++gt];if(Le(ot[Nt],Nt,ot)===!1)break}return Se}})();function yt(ce,Se){for(var Le=0,Qe=(Se=At(Se,ce)?[Se]:_t(Se)).length;ce!=null&&Le<Qe;)ce=ce[ke(Se[Le++])];return Le&&Le==Qe?ce:void 0}function Pt(ce,Se){return ce!=null&&Se in Object(ce)}function $t(ce,Se,Le,Qe,gt){return ce===Se||(ce==null||Se==null||!Me(ce)&&!Be(Se)?ce!=ce&&Se!=Se:(function(ot,dt,Kt,Nt,Lt,kt){var qt=fe(ot),br=fe(dt),or="[object Array]",pr="[object Array]";qt||(or=(or=nr(ot))==o?l:or),br||(pr=(pr=nr(dt))==o?l:pr);var gn=or==l&&!z(ot),$n=pr==l&&!z(dt),bi=or==pr;if(bi&&!gn)return kt||(kt=new we),qt||nt(ot)?sr(ot,dt,Kt,Nt,Lt,kt):(function(Cr,cr,ss,Ei,_l,ii,si){switch(ss){case"[object DataView]":if(Cr.byteLength!=cr.byteLength||Cr.byteOffset!=cr.byteOffset)return!1;Cr=Cr.buffer,cr=cr.buffer;case"[object ArrayBuffer]":return!(Cr.byteLength!=cr.byteLength||!Ei(new V(Cr),new V(cr)));case"[object Boolean]":case"[object Date]":case"[object Number]":return le(+Cr,+cr);case"[object Error]":return Cr.name==cr.name&&Cr.message==cr.message;case"[object RegExp]":case"[object String]":return Cr==cr+"";case a:var Qs=M;case c:var wa=2&ii;if(Qs||(Qs=B),Cr.size!=cr.size&&!wa)return!1;var El=si.get(Cr);if(El)return El==cr;ii|=1,si.set(Cr,cr);var eo=sr(Qs(Cr),Qs(cr),Ei,_l,ii,si);return si.delete(Cr),eo;case"[object Symbol]":if(Ve)return Ve.call(Cr)==Ve.call(cr)}return!1})(ot,dt,or,Kt,Nt,Lt,kt);if(!(2&Lt)){var Js=gn&&X.call(ot,"__wrapped__"),Ds=$n&&X.call(dt,"__wrapped__");if(Js||Ds){var ba=Js?ot.value():ot,Pn=Ds?dt.value():dt;return kt||(kt=new we),Kt(ba,Pn,Nt,Lt,kt)}}return bi?(kt||(kt=new we),(function(Cr,cr,ss,Ei,_l,ii){var si=2&_l,Qs=ct(Cr),wa=Qs.length,El=ct(cr).length;if(wa!=El&&!si)return!1;for(var eo=wa;eo--;){var to=Qs[eo];if(!(si?to in cr:X.call(cr,to)))return!1}var ip=ii.get(Cr);if(ip&&ii.get(cr))return ip==cr;var Fo=!0;ii.set(Cr,cr),ii.set(cr,Cr);for(var Gi=si;++eo<wa;){to=Qs[eo];var ya=Cr[to],Ca=cr[to];if(Ei)var Mo=si?Ei(Ca,ya,to,cr,Cr,ii):Ei(ya,Ca,to,Cr,cr,ii);if(!(Mo===void 0?ya===Ca||ss(ya,Ca,Ei,_l,ii):Mo)){Fo=!1;break}Gi||(Gi=to=="constructor")}if(Fo&&!Gi){var Ps=Cr.constructor,Tl=cr.constructor;Ps==Tl||!("constructor"in Cr)||!("constructor"in cr)||typeof Ps=="function"&&Ps instanceof Ps&&typeof Tl=="function"&&Tl instanceof Tl||(Fo=!1)}return ii.delete(Cr),ii.delete(cr),Fo})(ot,dt,Kt,Nt,Lt,kt)):!1})(ce,Se,$t,Le,Qe,gt))}function Ct(ce){return!(!Me(ce)||(function(Se){return!!P&&P in Se})(ce))&&(Re(ce)||z(ce)?G:v).test(He(ce))}function It(ce){return typeof ce=="function"?ce:ce==null?ft:typeof ce=="object"?fe(ce)?(function(Qe,gt){return At(Qe)&&fr(gt)?yr(ke(Qe),gt):function(ot){var dt=(function(Kt,Nt,Lt){var kt=Kt==null?void 0:yt(Kt,Nt);return kt===void 0?Lt:kt})(ot,Qe);return dt===void 0&&dt===gt?(function(Kt,Nt){return Kt!=null&&(function(Lt,kt,qt){kt=At(kt,Lt)?[kt]:_t(kt);for(var br,or=-1,pr=kt.length;++or<pr;){var gn=ke(kt[or]);if(!(br=Lt!=null&&qt(Lt,gn)))break;Lt=Lt[gn]}return br||!!(pr=Lt?Lt.length:0)&&je(pr)&&vr(gn,pr)&&(fe(Lt)||de(Lt))})(Kt,Nt,Pt)})(ot,Qe):$t(gt,dt,void 0,3)}})(ce[0],ce[1]):(function(Qe){var gt=(function(ot){for(var dt=ct(ot),Kt=dt.length;Kt--;){var Nt=dt[Kt],Lt=ot[Nt];dt[Kt]=[Nt,Lt,fr(Lt)]}return dt})(Qe);return gt.length==1&&gt[0][2]?yr(gt[0][0],gt[0][1]):function(ot){return ot===Qe||(function(dt,Kt,Nt,Lt){var kt=Nt.length,qt=kt;if(dt==null)return!qt;for(dt=Object(dt);kt--;){var br=Nt[kt];if(br[2]?br[1]!==dt[br[0]]:!(br[0]in dt))return!1}for(;++kt<qt;){var or=(br=Nt[kt])[0],pr=dt[or],gn=br[1];if(br[2]){if(pr===void 0&&!(or in dt))return!1}else{var $n=new we,bi;if(!(bi===void 0?$t(gn,pr,Lt,3,$n):bi))return!1}}return!0})(ot,Qe,gt)}})(ce):At(Se=ce)?(Le=ke(Se),function(Qe){return Qe?.[Le]}):(function(Qe){return function(gt){return yt(gt,Qe)}})(Se);var Se,Le}function Ut(ce){if(Le=(Se=ce)&&Se.constructor,Qe=typeof Le=="function"&&Le.prototype||D,Se!==Qe)return ie(ce);var Se,Le,Qe,gt=[];for(var ot in Object(ce))X.call(ce,ot)&&ot!="constructor"&&gt.push(ot);return gt}function _t(ce){return fe(ce)?ce:Ot(ce)}function sr(ce,Se,Le,Qe,gt,ot){var dt=2&gt,Kt=ce.length,Nt=Se.length;if(Kt!=Nt&&!(dt&&Nt>Kt))return!1;var Lt=ot.get(ce);if(Lt&&ot.get(Se))return Lt==Se;var kt=-1,qt=!0,br=1&gt?new ze:void 0;for(ot.set(ce,Se),ot.set(Se,ce);++kt<Kt;){var or=ce[kt],pr=Se[kt];if(Qe)var gn=dt?Qe(pr,or,kt,Se,ce,ot):Qe(or,pr,kt,ce,Se,ot);if(gn!==void 0){if(gn)continue;qt=!1;break}if(br){if(!K(Se,(function($n,bi){if(!br.has(bi)&&(or===$n||Le(or,$n,Qe,gt,ot)))return br.add(bi)}))){qt=!1;break}}else if(or!==pr&&!Le(or,pr,Qe,gt,ot)){qt=!1;break}}return ot.delete(ce),ot.delete(Se),qt}function Jt(ce,Se){var Le,Qe,gt=ce.__data__;return((Qe=typeof(Le=Se))=="string"||Qe=="number"||Qe=="symbol"||Qe=="boolean"?Le!=="__proto__":Le===null)?gt[typeof Se=="string"?"string":"hash"]:gt.map}function Tt(ce,Se){var Le=(function(Qe,gt){return Qe?.[gt]})(ce,Se);return Ct(Le)?Le:void 0}var nr=function(ce){return Q.call(ce)};function vr(ce,Se){return!!(Se=Se??9007199254740991)&&(typeof ce=="number"||g.test(ce))&&ce>-1&&ce%1==0&&ce<Se}function At(ce,Se){if(fe(ce))return!1;var Le=typeof ce;return!(Le!="number"&&Le!="symbol"&&Le!="boolean"&&ce!=null&&!Oe(ce))||h.test(ce)||!u.test(ce)||Se!=null&&ce in Object(Se)}function fr(ce){return ce==ce&&!Me(ce)}function yr(ce,Se){return function(Le){return Le!=null&&Le[ce]===Se&&(Se!==void 0||ce in Object(Le))}}(te&&nr(new te(new ArrayBuffer(1)))!="[object DataView]"||oe&&nr(new oe)!=a||ue&&nr(ue.resolve())!="[object Promise]"||Ce&&nr(new Ce)!=c||ye&&nr(new ye)!="[object WeakMap]")&&(nr=function(ce){var Se=Q.call(ce),Le=Se==l?ce.constructor:void 0,Qe=Le?He(Le):void 0;if(Qe)switch(Qe){case me:return"[object DataView]";case ve:return a;case Te:return"[object Promise]";case xe:return c;case Fe:return"[object WeakMap]"}return Se});var Ot=pe((function(ce){var Se;ce=(Se=ce)==null?"":(function(Qe){if(typeof Qe=="string")return Qe;if(Oe(Qe))return Ye?Ye.call(Qe):"";var gt=Qe+"";return gt=="0"&&1/Qe==-1/0?"-0":gt})(Se);var Le=[];return d.test(ce)&&Le.push(""),ce.replace(f,(function(Qe,gt,ot,dt){Le.push(ot?dt.replace(m,"$1"):gt||Qe)})),Le}));function ke(ce){if(typeof ce=="string"||Oe(ce))return ce;var Se=ce+"";return Se=="0"&&1/ce==-1/0?"-0":Se}function He(ce){if(ce!=null){try{return q.call(ce)}catch{}try{return ce+""}catch{}}return""}var Xe,se=(Xe=function(ce,Se,Le){X.call(ce,Le)?ce[Le].push(Se):ce[Le]=[Se]},function(ce,Se){var Le=fe(ce)?W:Pe,Qe={};return Le(ce,Xe,It(Se),Qe)});function pe(ce,Se){if(typeof ce!="function"||Se&&typeof Se!="function")throw new TypeError("Expected a function");var Le=function(){var Qe=arguments,gt=Se?Se.apply(this,Qe):Qe[0],ot=Le.cache;if(ot.has(gt))return ot.get(gt);var dt=ce.apply(this,Qe);return Le.cache=ot.set(gt,dt),dt};return Le.cache=new(pe.Cache||be),Le}function le(ce,Se){return ce===Se||ce!=ce&&Se!=Se}function de(ce){return(function(Se){return Be(Se)&&ge(Se)})(ce)&&X.call(ce,"callee")&&(!H.call(ce,"callee")||Q.call(ce)==o)}pe.Cache=be;var fe=Array.isArray;function ge(ce){return ce!=null&&je(ce.length)&&!Re(ce)}function Re(ce){var Se=Me(ce)?Q.call(ce):"";return Se=="[object Function]"||Se=="[object GeneratorFunction]"}function je(ce){return typeof ce=="number"&&ce>-1&&ce%1==0&&ce<=9007199254740991}function Me(ce){var Se=typeof ce;return!!ce&&(Se=="object"||Se=="function")}function Be(ce){return!!ce&&typeof ce=="object"}function Oe(ce){return typeof ce=="symbol"||Be(ce)&&Q.call(ce)=="[object Symbol]"}var nt=L?(function(ce){return function(Se){return ce(Se)}})(L):function(ce){return Be(ce)&&je(ce.length)&&!!w[Q.call(ce)]};function ct(ce){return ge(ce)?Ee(ce):Ut(ce)}function ft(ce){return ce}n.exports=se}).call(this)}).call(this,typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{}],444:[function(r,n,i){var s=Object.prototype.toString;n.exports=function(o){return o===!0||o===!1||(function(a){return!!a&&typeof a=="object"})(o)&&s.call(o)=="[object Boolean]"}},{}],445:[function(r,n,i){(function(s){(function(){var o="[object Arguments]",a="[object Map]",l="[object Object]",c="[object Set]",u=/^\[object .+?Constructor\]$/,h=/^(?:0|[1-9]\d*)$/,d={};d["[object Float32Array]"]=d["[object Float64Array]"]=d["[object Int8Array]"]=d["[object Int16Array]"]=d["[object Int32Array]"]=d["[object Uint8Array]"]=d["[object Uint8ClampedArray]"]=d["[object Uint16Array]"]=d["[object Uint32Array]"]=!0,d[o]=d["[object Array]"]=d["[object ArrayBuffer]"]=d["[object Boolean]"]=d["[object DataView]"]=d["[object Date]"]=d["[object Error]"]=d["[object Function]"]=d[a]=d["[object Number]"]=d[l]=d["[object RegExp]"]=d[c]=d["[object String]"]=d["[object WeakMap]"]=!1;var f=typeof s=="object"&&s&&s.Object===Object&&s,m=typeof self=="object"&&self&&self.Object===Object&&self,v=f||m||Function("return this")(),g=typeof i=="object"&&i&&!i.nodeType&&i,w=g&&typeof n=="object"&&n&&!n.nodeType&&n,y=w&&w.exports===g,C=y&&f.process,k=(function(){try{return C&&C.binding&&C.binding("util")}catch{}})(),F=k&&k.isTypedArray;function I(ke,He){for(var Xe=-1,se=ke==null?0:ke.length;++Xe<se;)if(He(ke[Xe],Xe,ke))return!0;return!1}function N(ke){var He=-1,Xe=Array(ke.size);return ke.forEach((function(se,pe){Xe[++He]=[pe,se]})),Xe}function j(ke){var He=-1,Xe=Array(ke.size);return ke.forEach((function(se){Xe[++He]=se})),Xe}var L,W,K,z=Array.prototype,M=Function.prototype,B=Object.prototype,R=v["__core-js_shared__"],S=M.toString,_=B.hasOwnProperty,T=(L=/[^.]+$/.exec(R&&R.keys&&R.keys.IE_PROTO||""))?"Symbol(src)_1."+L:"",E=B.toString,D=RegExp("^"+S.call(_).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),O=y?v.Buffer:void 0,P=v.Symbol,q=v.Uint8Array,X=B.propertyIsEnumerable,Q=z.splice,G=P?P.toStringTag:void 0,ee=Object.getOwnPropertySymbols,V=O?O.isBuffer:void 0,H=(W=Object.keys,K=Object,function(ke){return W(K(ke))}),Z=Pt(v,"DataView"),ie=Pt(v,"Map"),te=Pt(v,"Promise"),oe=Pt(v,"Set"),ue=Pt(v,"WeakMap"),Ce=Pt(Object,"create"),ye=Ut(Z),ne=Ut(ie),me=Ut(te),ve=Ut(oe),Te=Ut(ue),xe=P?P.prototype:void 0,Fe=xe?xe.valueOf:void 0;function Ge(ke){var He=-1,Xe=ke==null?0:ke.length;for(this.clear();++He<Xe;){var se=ke[He];this.set(se[0],se[1])}}function Ve(ke){var He=-1,Xe=ke==null?0:ke.length;for(this.clear();++He<Xe;){var se=ke[He];this.set(se[0],se[1])}}function Ye(ke){var He=-1,Xe=ke==null?0:ke.length;for(this.clear();++He<Xe;){var se=ke[He];this.set(se[0],se[1])}}function ut(ke){var He=-1,Xe=ke==null?0:ke.length;for(this.__data__=new Ye;++He<Xe;)this.add(ke[He])}function ht(ke){var He=this.__data__=new Ve(ke);this.size=He.size}function be(ke,He){var Xe=Jt(ke),se=!Xe&&sr(ke),pe=!Xe&&!se&&Tt(ke),le=!Xe&&!se&&!pe&&yr(ke),de=Xe||se||pe||le,fe=de?(function(je,Me){for(var Be=-1,Oe=Array(je);++Be<je;)Oe[Be]=Me(Be);return Oe})(ke.length,String):[],ge=fe.length;for(var Re in ke)!_.call(ke,Re)||de&&(Re=="length"||pe&&(Re=="offset"||Re=="parent")||le&&(Re=="buffer"||Re=="byteLength"||Re=="byteOffset")||It(Re,ge))||fe.push(Re);return fe}function ze(ke,He){for(var Xe=ke.length;Xe--;)if(_t(ke[Xe][0],He))return Xe;return-1}function we(ke){return ke==null?ke===void 0?"[object Undefined]":"[object Null]":G&&G in Object(ke)?(function(He){var Xe=_.call(He,G),se=He[G];try{He[G]=void 0;var pe=!0}catch{}var le=E.call(He);return pe&&(Xe?He[G]=se:delete He[G]),le})(ke):(function(He){return E.call(He)})(ke)}function Ee(ke){return fr(ke)&&we(ke)==o}function Ie(ke,He,Xe,se,pe){return ke===He||(ke==null||He==null||!fr(ke)&&!fr(He)?ke!=ke&&He!=He:(function(le,de,fe,ge,Re,je){var Me=Jt(le),Be=Jt(de),Oe=Me?"[object Array]":Ct(le),nt=Be?"[object Array]":Ct(de),ct=(Oe=Oe==o?l:Oe)==l,ft=(nt=nt==o?l:nt)==l,ce=Oe==nt;if(ce&&Tt(le)){if(!Tt(de))return!1;Me=!0,ct=!1}if(ce&&!ct)return je||(je=new ht),Me||yr(le)?Ze(le,de,fe,ge,Re,je):(function(ot,dt,Kt,Nt,Lt,kt,qt){switch(Kt){case"[object DataView]":if(ot.byteLength!=dt.byteLength||ot.byteOffset!=dt.byteOffset)return!1;ot=ot.buffer,dt=dt.buffer;case"[object ArrayBuffer]":return!(ot.byteLength!=dt.byteLength||!kt(new q(ot),new q(dt)));case"[object Boolean]":case"[object Date]":case"[object Number]":return _t(+ot,+dt);case"[object Error]":return ot.name==dt.name&&ot.message==dt.message;case"[object RegExp]":case"[object String]":return ot==dt+"";case a:var br=N;case c:var or=1&Nt;if(br||(br=j),ot.size!=dt.size&&!or)return!1;var pr=qt.get(ot);if(pr)return pr==dt;Nt|=2,qt.set(ot,dt);var gn=Ze(br(ot),br(dt),Nt,Lt,kt,qt);return qt.delete(ot),gn;case"[object Symbol]":if(Fe)return Fe.call(ot)==Fe.call(dt)}return!1})(le,de,Oe,fe,ge,Re,je);if(!(1&fe)){var Se=ct&&_.call(le,"__wrapped__"),Le=ft&&_.call(de,"__wrapped__");if(Se||Le){var Qe=Se?le.value():le,gt=Le?de.value():de;return je||(je=new ht),Re(Qe,gt,fe,ge,je)}}return ce?(je||(je=new ht),(function(ot,dt,Kt,Nt,Lt,kt){var qt=1&Kt,br=pt(ot),or=br.length,pr=pt(dt).length;if(or!=pr&&!qt)return!1;for(var gn=or;gn--;){var $n=br[gn];if(!(qt?$n in dt:_.call(dt,$n)))return!1}var bi=kt.get(ot);if(bi&&kt.get(dt))return bi==dt;var Js=!0;kt.set(ot,dt),kt.set(dt,ot);for(var Ds=qt;++gn<or;){$n=br[gn];var ba=ot[$n],Pn=dt[$n];if(Nt)var Cr=qt?Nt(Pn,ba,$n,dt,ot,kt):Nt(ba,Pn,$n,ot,dt,kt);if(!(Cr===void 0?ba===Pn||Lt(ba,Pn,Kt,Nt,kt):Cr)){Js=!1;break}Ds||(Ds=$n=="constructor")}if(Js&&!Ds){var cr=ot.constructor,ss=dt.constructor;cr==ss||!("constructor"in ot)||!("constructor"in dt)||typeof cr=="function"&&cr instanceof cr&&typeof ss=="function"&&ss instanceof ss||(Js=!1)}return kt.delete(ot),kt.delete(dt),Js})(le,de,fe,ge,Re,je)):!1})(ke,He,Xe,se,Ie,pe))}function Pe(ke){return!(!At(ke)||(function(He){return!!T&&T in He})(ke))&&(nr(ke)?D:u).test(Ut(ke))}function De(ke){if(Xe=(He=ke)&&He.constructor,se=typeof Xe=="function"&&Xe.prototype||B,He!==se)return H(ke);var He,Xe,se,pe=[];for(var le in Object(ke))_.call(ke,le)&&le!="constructor"&&pe.push(le);return pe}function Ze(ke,He,Xe,se,pe,le){var de=1&Xe,fe=ke.length,ge=He.length;if(fe!=ge&&!(de&&ge>fe))return!1;var Re=le.get(ke);if(Re&&le.get(He))return Re==He;var je=-1,Me=!0,Be=2&Xe?new ut:void 0;for(le.set(ke,He),le.set(He,ke);++je<fe;){var Oe=ke[je],nt=He[je];if(se)var ct=de?se(nt,Oe,je,He,ke,le):se(Oe,nt,je,ke,He,le);if(ct!==void 0){if(ct)continue;Me=!1;break}if(Be){if(!I(He,(function(ft,ce){if(Se=ce,!Be.has(Se)&&(Oe===ft||pe(Oe,ft,Xe,se,le)))return Be.push(ce);var Se}))){Me=!1;break}}else if(Oe!==nt&&!pe(Oe,nt,Xe,se,le)){Me=!1;break}}return le.delete(ke),le.delete(He),Me}function pt(ke){return(function(He,Xe,se){var pe=Xe(He);return Jt(He)?pe:(function(le,de){for(var fe=-1,ge=de.length,Re=le.length;++fe<ge;)le[Re+fe]=de[fe];return le})(pe,se(He))})(ke,Ot,$t)}function yt(ke,He){var Xe,se,pe=ke.__data__;return((se=typeof(Xe=He))=="string"||se=="number"||se=="symbol"||se=="boolean"?Xe!=="__proto__":Xe===null)?pe[typeof He=="string"?"string":"hash"]:pe.map}function Pt(ke,He){var Xe=(function(se,pe){return se?.[pe]})(ke,He);return Pe(Xe)?Xe:void 0}Ge.prototype.clear=function(){this.__data__=Ce?Ce(null):{},this.size=0},Ge.prototype.delete=function(ke){var He=this.has(ke)&&delete this.__data__[ke];return this.size-=He?1:0,He},Ge.prototype.get=function(ke){var He=this.__data__;if(Ce){var Xe=He[ke];return Xe==="__lodash_hash_undefined__"?void 0:Xe}return _.call(He,ke)?He[ke]:void 0},Ge.prototype.has=function(ke){var He=this.__data__;return Ce?He[ke]!==void 0:_.call(He,ke)},Ge.prototype.set=function(ke,He){var Xe=this.__data__;return this.size+=this.has(ke)?0:1,Xe[ke]=Ce&&He===void 0?"__lodash_hash_undefined__":He,this},Ve.prototype.clear=function(){this.__data__=[],this.size=0},Ve.prototype.delete=function(ke){var He=this.__data__,Xe=ze(He,ke);return!(Xe<0)&&(Xe==He.length-1?He.pop():Q.call(He,Xe,1),--this.size,!0)},Ve.prototype.get=function(ke){var He=this.__data__,Xe=ze(He,ke);return Xe<0?void 0:He[Xe][1]},Ve.prototype.has=function(ke){return ze(this.__data__,ke)>-1},Ve.prototype.set=function(ke,He){var Xe=this.__data__,se=ze(Xe,ke);return se<0?(++this.size,Xe.push([ke,He])):Xe[se][1]=He,this},Ye.prototype.clear=function(){this.size=0,this.__data__={hash:new Ge,map:new(ie||Ve),string:new Ge}},Ye.prototype.delete=function(ke){var He=yt(this,ke).delete(ke);return this.size-=He?1:0,He},Ye.prototype.get=function(ke){return yt(this,ke).get(ke)},Ye.prototype.has=function(ke){return yt(this,ke).has(ke)},Ye.prototype.set=function(ke,He){var Xe=yt(this,ke),se=Xe.size;return Xe.set(ke,He),this.size+=Xe.size==se?0:1,this},ut.prototype.add=ut.prototype.push=function(ke){return this.__data__.set(ke,"__lodash_hash_undefined__"),this},ut.prototype.has=function(ke){return this.__data__.has(ke)},ht.prototype.clear=function(){this.__data__=new Ve,this.size=0},ht.prototype.delete=function(ke){var He=this.__data__,Xe=He.delete(ke);return this.size=He.size,Xe},ht.prototype.get=function(ke){return this.__data__.get(ke)},ht.prototype.has=function(ke){return this.__data__.has(ke)},ht.prototype.set=function(ke,He){var Xe=this.__data__;if(Xe instanceof Ve){var se=Xe.__data__;if(!ie||se.length<199)return se.push([ke,He]),this.size=++Xe.size,this;Xe=this.__data__=new Ye(se)}return Xe.set(ke,He),this.size=Xe.size,this};var $t=ee?function(ke){return ke==null?[]:(ke=Object(ke),(function(He,Xe){for(var se=-1,pe=He==null?0:He.length,le=0,de=[];++se<pe;){var fe=He[se];Xe(fe,se,He)&&(de[le++]=fe)}return de})(ee(ke),(function(He){return X.call(ke,He)})))}:function(){return[]},Ct=we;function It(ke,He){return!!(He=He??9007199254740991)&&(typeof ke=="number"||h.test(ke))&&ke>-1&&ke%1==0&&ke<He}function Ut(ke){if(ke!=null){try{return S.call(ke)}catch{}try{return ke+""}catch{}}return""}function _t(ke,He){return ke===He||ke!=ke&&He!=He}(Z&&Ct(new Z(new ArrayBuffer(1)))!="[object DataView]"||ie&&Ct(new ie)!=a||te&&Ct(te.resolve())!="[object Promise]"||oe&&Ct(new oe)!=c||ue&&Ct(new ue)!="[object WeakMap]")&&(Ct=function(ke){var He=we(ke),Xe=He==l?ke.constructor:void 0,se=Xe?Ut(Xe):"";if(se)switch(se){case ye:return"[object DataView]";case ne:return a;case me:return"[object Promise]";case ve:return c;case Te:return"[object WeakMap]"}return He});var sr=Ee((function(){return arguments})())?Ee:function(ke){return fr(ke)&&_.call(ke,"callee")&&!X.call(ke,"callee")},Jt=Array.isArray,Tt=V||function(){return!1};function nr(ke){if(!At(ke))return!1;var He=we(ke);return He=="[object Function]"||He=="[object GeneratorFunction]"||He=="[object AsyncFunction]"||He=="[object Proxy]"}function vr(ke){return typeof ke=="number"&&ke>-1&&ke%1==0&&ke<=9007199254740991}function At(ke){var He=typeof ke;return ke!=null&&(He=="object"||He=="function")}function fr(ke){return ke!=null&&typeof ke=="object"}var yr=F?(function(ke){return function(He){return ke(He)}})(F):function(ke){return fr(ke)&&vr(ke.length)&&!!d[we(ke)]};function Ot(ke){return(He=ke)!=null&&vr(He.length)&&!nr(He)?be(ke):De(ke);var He}n.exports=function(ke,He){return Ie(ke,He)}}).call(this)}).call(this,typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{}],446:[function(r,n,i){(function(s){(function(){var o=typeof s=="object"&&s&&s.Object===Object&&s,a=typeof self=="object"&&self&&self.Object===Object&&self,l=o||a||Function("return this")(),c=Object.prototype,u=c.hasOwnProperty,h=c.toString,d=l.Symbol,f=d?d.toStringTag:void 0;function m(v){return v==null?v===void 0?"[object Undefined]":"[object Null]":f&&f in Object(v)?(function(g){var w=u.call(g,f),y=g[f];try{g[f]=void 0;var C=!0}catch{}var k=h.call(g);return C&&(w?g[f]=y:delete g[f]),k})(v):(function(g){return h.call(g)})(v)}n.exports=function(v){if(!(function(w){var y=typeof w;return w!=null&&(y=="object"||y=="function")})(v))return!1;var g=m(v);return g=="[object Function]"||g=="[object GeneratorFunction]"||g=="[object AsyncFunction]"||g=="[object Proxy]"}}).call(this)}).call(this,typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{}],447:[function(r,n,i){n.exports=function(s){return s==null}},{}],448:[function(r,n,i){n.exports=function(s){return s===void 0}},{}],449:[function(r,n,i){(function(s){(function(){var o=/^\[object .+?Constructor\]$/,a=typeof s=="object"&&s&&s.Object===Object&&s,l=typeof self=="object"&&self&&self.Object===Object&&self,c=a||l||Function("return this")();function u(P,q){return!!(P&&P.length)&&(function(X,Q,G){if(Q!=Q)return(function(H,Z,ie,te){for(var oe=H.length,ue=ie+-1;++ue<oe;)if(Z(H[ue],ue,H))return ue;return-1})(X,h,G);for(var ee=G-1,V=X.length;++ee<V;)if(X[ee]===Q)return ee;return-1})(P,q,0)>-1}function h(P){return P!=P}function d(P,q){return P.has(q)}function f(P){var q=-1,X=Array(P.size);return P.forEach((function(Q){X[++q]=Q})),X}var m,v=Array.prototype,g=Function.prototype,w=Object.prototype,y=c["__core-js_shared__"],C=(m=/[^.]+$/.exec(y&&y.keys&&y.keys.IE_PROTO||""))?"Symbol(src)_1."+m:"",k=g.toString,F=w.hasOwnProperty,I=w.toString,N=RegExp("^"+k.call(F).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),j=v.splice,L=D(c,"Map"),W=D(c,"Set"),K=D(Object,"create");function z(P){var q=-1,X=P?P.length:0;for(this.clear();++q<X;){var Q=P[q];this.set(Q[0],Q[1])}}function M(P){var q=-1,X=P?P.length:0;for(this.clear();++q<X;){var Q=P[q];this.set(Q[0],Q[1])}}function B(P){var q=-1,X=P?P.length:0;for(this.clear();++q<X;){var Q=P[q];this.set(Q[0],Q[1])}}function R(P){var q=-1,X=P?P.length:0;for(this.__data__=new B;++q<X;)this.add(P[q])}function S(P,q){for(var X,Q,G=P.length;G--;)if((X=P[G][0])===(Q=q)||X!=X&&Q!=Q)return G;return-1}function _(P){return!(!O(P)||(q=P,C&&C in q))&&((function(X){var Q=O(X)?I.call(X):"";return Q=="[object Function]"||Q=="[object GeneratorFunction]"})(P)||(function(X){var Q=!1;if(X!=null&&typeof X.toString!="function")try{Q=!!(X+"")}catch{}return Q})(P)?N:o).test((function(X){if(X!=null){try{return k.call(X)}catch{}try{return X+""}catch{}}return""})(P));var q}z.prototype.clear=function(){this.__data__=K?K(null):{}},z.prototype.delete=function(P){return this.has(P)&&delete this.__data__[P]},z.prototype.get=function(P){var q=this.__data__;if(K){var X=q[P];return X==="__lodash_hash_undefined__"?void 0:X}return F.call(q,P)?q[P]:void 0},z.prototype.has=function(P){var q=this.__data__;return K?q[P]!==void 0:F.call(q,P)},z.prototype.set=function(P,q){return this.__data__[P]=K&&q===void 0?"__lodash_hash_undefined__":q,this},M.prototype.clear=function(){this.__data__=[]},M.prototype.delete=function(P){var q=this.__data__,X=S(q,P);return!(X<0)&&(X==q.length-1?q.pop():j.call(q,X,1),!0)},M.prototype.get=function(P){var q=this.__data__,X=S(q,P);return X<0?void 0:q[X][1]},M.prototype.has=function(P){return S(this.__data__,P)>-1},M.prototype.set=function(P,q){var X=this.__data__,Q=S(X,P);return Q<0?X.push([P,q]):X[Q][1]=q,this},B.prototype.clear=function(){this.__data__={hash:new z,map:new(L||M),string:new z}},B.prototype.delete=function(P){return E(this,P).delete(P)},B.prototype.get=function(P){return E(this,P).get(P)},B.prototype.has=function(P){return E(this,P).has(P)},B.prototype.set=function(P,q){return E(this,P).set(P,q),this},R.prototype.add=R.prototype.push=function(P){return this.__data__.set(P,"__lodash_hash_undefined__"),this},R.prototype.has=function(P){return this.__data__.has(P)};var T=W&&1/f(new W([,-0]))[1]==1/0?function(P){return new W(P)}:function(){};function E(P,q){var X,Q,G=P.__data__;return((Q=typeof(X=q))=="string"||Q=="number"||Q=="symbol"||Q=="boolean"?X!=="__proto__":X===null)?G[typeof q=="string"?"string":"hash"]:G.map}function D(P,q){var X=(function(Q,G){return Q?.[G]})(P,q);return _(X)?X:void 0}function O(P){var q=typeof P;return!!P&&(q=="object"||q=="function")}n.exports=function(P){return P&&P.length?(function(q,X,Q){var G=-1,ee=u,V=q.length,H=!0,Z=[],ie=Z;if(V>=200){var te=T(q);if(te)return f(te);H=!1,ee=d,ie=new R}else ie=Z;e:for(;++G<V;){var oe=q[G],ue=oe;if(oe=oe!==0?oe:0,H&&ue==ue){for(var Ce=ie.length;Ce--;)if(ie[Ce]===ue)continue e;Z.push(oe)}else ee(ie,ue,Q)||(ie!==Z&&ie.push(ue),Z.push(oe))}return Z})(P):[]}}).call(this)}).call(this,typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{}],450:[function(r,n,i){var s=r("inherits"),o=r("hash-base"),a=r("safe-buffer").Buffer,l=new Array(16);function c(){o.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function u(v,g){return v<<g|v>>>32-g}function h(v,g,w,y,C,k,F){return u(v+(g&w|~g&y)+C+k|0,F)+g|0}function d(v,g,w,y,C,k,F){return u(v+(g&y|w&~y)+C+k|0,F)+g|0}function f(v,g,w,y,C,k,F){return u(v+(g^w^y)+C+k|0,F)+g|0}function m(v,g,w,y,C,k,F){return u(v+(w^(g|~y))+C+k|0,F)+g|0}s(c,o),c.prototype._update=function(){for(var v=l,g=0;g<16;++g)v[g]=this._block.readInt32LE(4*g);var w=this._a,y=this._b,C=this._c,k=this._d;w=h(w,y,C,k,v[0],3614090360,7),k=h(k,w,y,C,v[1],3905402710,12),C=h(C,k,w,y,v[2],606105819,17),y=h(y,C,k,w,v[3],3250441966,22),w=h(w,y,C,k,v[4],4118548399,7),k=h(k,w,y,C,v[5],1200080426,12),C=h(C,k,w,y,v[6],2821735955,17),y=h(y,C,k,w,v[7],4249261313,22),w=h(w,y,C,k,v[8],1770035416,7),k=h(k,w,y,C,v[9],2336552879,12),C=h(C,k,w,y,v[10],4294925233,17),y=h(y,C,k,w,v[11],2304563134,22),w=h(w,y,C,k,v[12],1804603682,7),k=h(k,w,y,C,v[13],4254626195,12),C=h(C,k,w,y,v[14],2792965006,17),w=d(w,y=h(y,C,k,w,v[15],1236535329,22),C,k,v[1],4129170786,5),k=d(k,w,y,C,v[6],3225465664,9),C=d(C,k,w,y,v[11],643717713,14),y=d(y,C,k,w,v[0],3921069994,20),w=d(w,y,C,k,v[5],3593408605,5),k=d(k,w,y,C,v[10],38016083,9),C=d(C,k,w,y,v[15],3634488961,14),y=d(y,C,k,w,v[4],3889429448,20),w=d(w,y,C,k,v[9],568446438,5),k=d(k,w,y,C,v[14],3275163606,9),C=d(C,k,w,y,v[3],4107603335,14),y=d(y,C,k,w,v[8],1163531501,20),w=d(w,y,C,k,v[13],2850285829,5),k=d(k,w,y,C,v[2],4243563512,9),C=d(C,k,w,y,v[7],1735328473,14),w=f(w,y=d(y,C,k,w,v[12],2368359562,20),C,k,v[5],4294588738,4),k=f(k,w,y,C,v[8],2272392833,11),C=f(C,k,w,y,v[11],1839030562,16),y=f(y,C,k,w,v[14],4259657740,23),w=f(w,y,C,k,v[1],2763975236,4),k=f(k,w,y,C,v[4],1272893353,11),C=f(C,k,w,y,v[7],4139469664,16),y=f(y,C,k,w,v[10],3200236656,23),w=f(w,y,C,k,v[13],681279174,4),k=f(k,w,y,C,v[0],3936430074,11),C=f(C,k,w,y,v[3],3572445317,16),y=f(y,C,k,w,v[6],76029189,23),w=f(w,y,C,k,v[9],3654602809,4),k=f(k,w,y,C,v[12],3873151461,11),C=f(C,k,w,y,v[15],530742520,16),w=m(w,y=f(y,C,k,w,v[2],3299628645,23),C,k,v[0],4096336452,6),k=m(k,w,y,C,v[7],1126891415,10),C=m(C,k,w,y,v[14],2878612391,15),y=m(y,C,k,w,v[5],4237533241,21),w=m(w,y,C,k,v[12],1700485571,6),k=m(k,w,y,C,v[3],2399980690,10),C=m(C,k,w,y,v[10],4293915773,15),y=m(y,C,k,w,v[1],2240044497,21),w=m(w,y,C,k,v[8],1873313359,6),k=m(k,w,y,C,v[15],4264355552,10),C=m(C,k,w,y,v[6],2734768916,15),y=m(y,C,k,w,v[13],1309151649,21),w=m(w,y,C,k,v[4],4149444226,6),k=m(k,w,y,C,v[11],3174756917,10),C=m(C,k,w,y,v[2],718787259,15),y=m(y,C,k,w,v[9],3951481745,21),this._a=this._a+w|0,this._b=this._b+y|0,this._c=this._c+C|0,this._d=this._d+k|0},c.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var v=a.allocUnsafe(16);return v.writeInt32LE(this._a,0),v.writeInt32LE(this._b,4),v.writeInt32LE(this._c,8),v.writeInt32LE(this._d,12),v},n.exports=c},{"hash-base":425,inherits:440,"safe-buffer":494}],451:[function(r,n,i){var s=r("bn.js"),o=r("brorand");function a(l){this.rand=l||new o.Rand}n.exports=a,a.create=function(l){return new a(l)},a.prototype._randbelow=function(l){var c=l.bitLength(),u=Math.ceil(c/8);do var h=new s(this.rand.generate(u));while(h.cmp(l)>=0);return h},a.prototype._randrange=function(l,c){var u=c.sub(l);return l.add(this._randbelow(u))},a.prototype.test=function(l,c,u){var h=l.bitLength(),d=s.mont(l),f=new s(1).toRed(d);c||(c=Math.max(1,h/48|0));for(var m=l.subn(1),v=0;!m.testn(v);v++);for(var g=l.shrn(v),w=m.toRed(d);c>0;c--){var y=this._randrange(new s(2),m);u&&u(y);var C=y.toRed(d).redPow(g);if(C.cmp(f)!==0&&C.cmp(w)!==0){for(var k=1;k<v;k++){if((C=C.redSqr()).cmp(f)===0)return!1;if(C.cmp(w)===0)break}if(k===v)return!1}}return!0},a.prototype.getDivisor=function(l,c){var u=l.bitLength(),h=s.mont(l),d=new s(1).toRed(h);c||(c=Math.max(1,u/48|0));for(var f=l.subn(1),m=0;!f.testn(m);m++);for(var v=l.shrn(m),g=f.toRed(h);c>0;c--){var w=this._randrange(new s(2),f),y=l.gcd(w);if(y.cmpn(1)!==0)return y;var C=w.toRed(h).redPow(v);if(C.cmp(d)!==0&&C.cmp(g)!==0){for(var k=1;k<m;k++){if((C=C.redSqr()).cmp(d)===0)return C.fromRed().subn(1).gcd(l);if(C.cmp(g)===0)break}if(k===m)return(C=C.redSqr()).fromRed().subn(1).gcd(l)}}return!1}},{"bn.js":452,brorand:187}],452:[function(r,n,i){arguments[4][184][0].apply(i,arguments)},{buffer:188,dup:184}],453:[function(r,n,i){function s(o,a){if(!o)throw new Error(a||"Assertion failed")}n.exports=s,s.equal=function(o,a,l){if(o!=a)throw new Error(l||"Assertion failed: "+o+" != "+a)}},{}],454:[function(r,n,i){var s=i;function o(l){return l.length===1?"0"+l:l}function a(l){for(var c="",u=0;u<l.length;u++)c+=o(l[u].toString(16));return c}s.toArray=function(l,c){if(Array.isArray(l))return l.slice();if(!l)return[];var u=[];if(typeof l!="string"){for(var h=0;h<l.length;h++)u[h]=0|l[h];return u}if(c==="hex")for((l=l.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(l="0"+l),h=0;h<l.length;h+=2)u.push(parseInt(l[h]+l[h+1],16));else for(h=0;h<l.length;h++){var d=l.charCodeAt(h),f=d>>8,m=255&d;f?u.push(f,m):u.push(m)}return u},s.zero2=o,s.toHex=a,s.encode=function(l,c){return c==="hex"?a(l):l}},{}],455:[function(r,n,i){n.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}},{}],456:[function(r,n,i){var s=r("asn1.js");i.certificate=r("./certificate");var o=s.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));i.RSAPrivateKey=o;var a=s.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));i.RSAPublicKey=a;var l=s.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(c),this.key("subjectPublicKey").bitstr())}));i.PublicKey=l;var c=s.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),u=s.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(c),this.key("subjectPrivateKey").octstr())}));i.PrivateKey=u;var h=s.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));i.EncryptedPrivateKey=h;var d=s.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));i.DSAPrivateKey=d,i.DSAparam=s.define("DSAparam",(function(){this.int()}));var f=s.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(m),this.key("publicKey").optional().explicit(1).bitstr())}));i.ECPrivateKey=f;var m=s.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));i.signature=s.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))},{"./certificate":457,"asn1.js":170}],457:[function(r,n,i){var s=r("asn1.js"),o=s.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),a=s.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),l=s.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())})),c=s.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(l),this.key("subjectPublicKey").bitstr())})),u=s.define("RelativeDistinguishedName",(function(){this.setof(a)})),h=s.define("RDNSequence",(function(){this.seqof(u)})),d=s.define("Name",(function(){this.choice({rdnSequence:this.use(h)})})),f=s.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(o),this.key("notAfter").use(o))})),m=s.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),v=s.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(l),this.key("issuer").use(d),this.key("validity").use(f),this.key("subject").use(d),this.key("subjectPublicKeyInfo").use(c),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(m).optional())})),g=s.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(v),this.key("signatureAlgorithm").use(l),this.key("signatureValue").bitstr())}));n.exports=g},{"asn1.js":170}],458:[function(r,n,i){var s=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,o=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,a=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,l=r("evp_bytestokey"),c=r("browserify-aes"),u=r("safe-buffer").Buffer;n.exports=function(h,d){var f,m=h.toString(),v=m.match(s);if(v){var g="aes"+v[1],w=u.from(v[2],"hex"),y=u.from(v[3].replace(/[\r\n]/g,""),"base64"),C=l(d,w.slice(0,8),parseInt(v[1],10)).key,k=[],F=c.createDecipheriv(g,C,w);k.push(F.update(y)),k.push(F.final()),f=u.concat(k)}else{var I=m.match(a);f=u.from(I[2].replace(/[\r\n]/g,""),"base64")}return{tag:m.match(o)[1],data:f}}},{"browserify-aes":191,evp_bytestokey:423,"safe-buffer":494}],459:[function(r,n,i){var s=r("./asn1"),o=r("./aesid.json"),a=r("./fixProc"),l=r("browserify-aes"),c=r("pbkdf2"),u=r("safe-buffer").Buffer;function h(d){var f;typeof d!="object"||u.isBuffer(d)||(f=d.passphrase,d=d.key),typeof d=="string"&&(d=u.from(d));var m,v,g=a(d,f),w=g.tag,y=g.data;switch(w){case"CERTIFICATE":v=s.certificate.decode(y,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(v||(v=s.PublicKey.decode(y,"der")),m=v.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return s.RSAPublicKey.decode(v.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return v.subjectPrivateKey=v.subjectPublicKey,{type:"ec",data:v};case"1.2.840.10040.4.1":return v.algorithm.params.pub_key=s.DSAparam.decode(v.subjectPublicKey.data,"der"),{type:"dsa",data:v.algorithm.params};default:throw new Error("unknown key id "+m)}case"ENCRYPTED PRIVATE KEY":y=(function(C,k){var F=C.algorithm.decrypt.kde.kdeparams.salt,I=parseInt(C.algorithm.decrypt.kde.kdeparams.iters.toString(),10),N=o[C.algorithm.decrypt.cipher.algo.join(".")],j=C.algorithm.decrypt.cipher.iv,L=C.subjectPrivateKey,W=parseInt(N.split("-")[1],10)/8,K=c.pbkdf2Sync(k,F,I,W,"sha1"),z=l.createDecipheriv(N,K,j),M=[];return M.push(z.update(L)),M.push(z.final()),u.concat(M)})(y=s.EncryptedPrivateKey.decode(y,"der"),f);case"PRIVATE KEY":switch(m=(v=s.PrivateKey.decode(y,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return s.RSAPrivateKey.decode(v.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:v.algorithm.curve,privateKey:s.ECPrivateKey.decode(v.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return v.algorithm.params.priv_key=s.DSAparam.decode(v.subjectPrivateKey,"der"),{type:"dsa",params:v.algorithm.params};default:throw new Error("unknown key id "+m)}case"RSA PUBLIC KEY":return s.RSAPublicKey.decode(y,"der");case"RSA PRIVATE KEY":return s.RSAPrivateKey.decode(y,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:s.DSAPrivateKey.decode(y,"der")};case"EC PRIVATE KEY":return{curve:(y=s.ECPrivateKey.decode(y,"der")).parameters.value,privateKey:y.privateKey};default:throw new Error("unknown key type "+w)}}n.exports=h,h.signature=s.signature},{"./aesid.json":455,"./asn1":456,"./fixProc":458,"browserify-aes":191,pbkdf2:460,"safe-buffer":494}],460:[function(r,n,i){i.pbkdf2=r("./lib/async"),i.pbkdf2Sync=r("./lib/sync")},{"./lib/async":461,"./lib/sync":464}],461:[function(r,n,i){(function(s){(function(){var o,a,l=r("safe-buffer").Buffer,c=r("./precondition"),u=r("./default-encoding"),h=r("./sync"),d=r("./to-buffer"),f=s.crypto&&s.crypto.subtle,m={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},v=[];function g(){return a||(a=s.process&&s.process.nextTick?s.process.nextTick:s.queueMicrotask?s.queueMicrotask:s.setImmediate?s.setImmediate:s.setTimeout)}function w(y,C,k,F,I){return f.importKey("raw",y,{name:"PBKDF2"},!1,["deriveBits"]).then((function(N){return f.deriveBits({name:"PBKDF2",salt:C,iterations:k,hash:{name:I}},N,F<<3)})).then((function(N){return l.from(N)}))}n.exports=function(y,C,k,F,I,N){typeof I=="function"&&(N=I,I=void 0);var j=m[(I=I||"sha1").toLowerCase()];if(j&&typeof s.Promise=="function"){if(c(k,F),y=d(y,u,"Password"),C=d(C,u,"Salt"),typeof N!="function")throw new Error("No callback provided to pbkdf2");(function(L,W){L.then((function(K){g()((function(){W(null,K)}))}),(function(K){g()((function(){W(K)}))}))})((function(L){if(s.process&&!s.process.browser||!f||!f.importKey||!f.deriveBits)return Promise.resolve(!1);if(v[L]!==void 0)return v[L];var W=w(o=o||l.alloc(8),o,10,128,L).then((function(){return!0})).catch((function(){return!1}));return v[L]=W,W})(j).then((function(L){return L?w(y,C,k,F,j):h(y,C,k,F,I)})),N)}else g()((function(){var L;try{L=h(y,C,k,F,I)}catch(W){return N(W)}N(null,L)}))}}).call(this)}).call(this,typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{"./default-encoding":462,"./precondition":463,"./sync":464,"./to-buffer":465,"safe-buffer":494}],462:[function(r,n,i){(function(s,o){(function(){var a;o.process&&o.process.browser?a="utf-8":o.process&&o.process.version?a=parseInt(s.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary":a="utf-8",n.exports=a}).call(this)}).call(this,r("_process"),typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467}],463:[function(r,n,i){var s=Math.pow(2,30)-1;n.exports=function(o,a){if(typeof o!="number")throw new TypeError("Iterations not a number");if(o<0)throw new TypeError("Bad iterations");if(typeof a!="number")throw new TypeError("Key length not a number");if(a<0||a>s||a!=a)throw new TypeError("Bad key length")}},{}],464:[function(r,n,i){var s=r("create-hash/md5"),o=r("ripemd160"),a=r("sha.js"),l=r("safe-buffer").Buffer,c=r("./precondition"),u=r("./default-encoding"),h=r("./to-buffer"),d=l.alloc(128),f={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function m(v,g,w){var y=(function(j){function L(W){return a(j).update(W).digest()}return j==="rmd160"||j==="ripemd160"?function(W){return new o().update(W).digest()}:j==="md5"?s:L})(v),C=v==="sha512"||v==="sha384"?128:64;g.length>C?g=y(g):g.length<C&&(g=l.concat([g,d],C));for(var k=l.allocUnsafe(C+f[v]),F=l.allocUnsafe(C+f[v]),I=0;I<C;I++)k[I]=54^g[I],F[I]=92^g[I];var N=l.allocUnsafe(C+w+4);k.copy(N,0,0,C),this.ipad1=N,this.ipad2=k,this.opad=F,this.alg=v,this.blocksize=C,this.hash=y,this.size=f[v]}m.prototype.run=function(v,g){return v.copy(g,this.blocksize),this.hash(g).copy(this.opad,this.blocksize),this.hash(this.opad)},n.exports=function(v,g,w,y,C){c(w,y);var k=new m(C=C||"sha1",v=h(v,u,"Password"),(g=h(g,u,"Salt")).length),F=l.allocUnsafe(y),I=l.allocUnsafe(g.length+4);g.copy(I,0,0,g.length);for(var N=0,j=f[C],L=Math.ceil(y/j),W=1;W<=L;W++){I.writeUInt32BE(W,g.length);for(var K=k.run(I,k.ipad1),z=K,M=1;M<w;M++){z=k.run(z,k.ipad2);for(var B=0;B<j;B++)K[B]^=z[B]}K.copy(F,N),N+=j}return F}},{"./default-encoding":462,"./precondition":463,"./to-buffer":465,"create-hash/md5":387,ripemd160:493,"safe-buffer":494,"sha.js":498}],465:[function(r,n,i){var s=r("safe-buffer").Buffer;n.exports=function(o,a,l){if(s.isBuffer(o))return o;if(typeof o=="string")return s.from(o,a);if(ArrayBuffer.isView(o))return s.from(o.buffer);throw new TypeError(l+" must be a string, a Buffer, a typed array or a DataView")}},{"safe-buffer":494}],466:[function(r,n,i){(function(s){(function(){s===void 0||!s.version||s.version.indexOf("v0.")===0||s.version.indexOf("v1.")===0&&s.version.indexOf("v1.8.")!==0?n.exports={nextTick:function(o,a,l,c){if(typeof o!="function")throw new TypeError('"callback" argument must be a function');var u,h,d=arguments.length;switch(d){case 0:case 1:return s.nextTick(o);case 2:return s.nextTick((function(){o.call(null,a)}));case 3:return s.nextTick((function(){o.call(null,a,l)}));case 4:return s.nextTick((function(){o.call(null,a,l,c)}));default:for(u=new Array(d-1),h=0;h<u.length;)u[h++]=arguments[h];return s.nextTick((function(){o.apply(null,u)}))}}}:n.exports=s}).call(this)}).call(this,r("_process"))},{_process:467}],467:[function(r,n,i){var s,o,a=n.exports={};function l(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function u(C){if(s===setTimeout)return setTimeout(C,0);if((s===l||!s)&&setTimeout)return s=setTimeout,setTimeout(C,0);try{return s(C,0)}catch{try{return s.call(null,C,0)}catch{return s.call(this,C,0)}}}(function(){try{s=typeof setTimeout=="function"?setTimeout:l}catch{s=l}try{o=typeof clearTimeout=="function"?clearTimeout:c}catch{o=c}})();var h,d=[],f=!1,m=-1;function v(){f&&h&&(f=!1,h.length?d=h.concat(d):m=-1,d.length&&g())}function g(){if(!f){var C=u(v);f=!0;for(var k=d.length;k;){for(h=d,d=[];++m<k;)h&&h[m].run();m=-1,k=d.length}h=null,f=!1,(function(F){if(o===clearTimeout)return clearTimeout(F);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(F);try{o(F)}catch{try{return o.call(null,F)}catch{return o.call(this,F)}}})(C)}}function w(C,k){this.fun=C,this.array=k}function y(){}a.nextTick=function(C){var k=new Array(arguments.length-1);if(arguments.length>1)for(var F=1;F<arguments.length;F++)k[F-1]=arguments[F];d.push(new w(C,k)),d.length!==1||f||u(g)},w.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=y,a.addListener=y,a.once=y,a.off=y,a.removeListener=y,a.removeAllListeners=y,a.emit=y,a.prependListener=y,a.prependOnceListener=y,a.listeners=function(C){return[]},a.binding=function(C){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(C){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],468:[function(r,n,i){i.publicEncrypt=r("./publicEncrypt"),i.privateDecrypt=r("./privateDecrypt"),i.privateEncrypt=function(s,o){return i.publicEncrypt(s,o,!0)},i.publicDecrypt=function(s,o){return i.privateDecrypt(s,o,!0)}},{"./privateDecrypt":471,"./publicEncrypt":472}],469:[function(r,n,i){var s=r("create-hash"),o=r("safe-buffer").Buffer;function a(l){var c=o.allocUnsafe(4);return c.writeUInt32BE(l,0),c}n.exports=function(l,c){for(var u,h=o.alloc(0),d=0;h.length<c;)u=a(d++),h=o.concat([h,s("sha1").update(l).update(u).digest()]);return h.slice(0,c)}},{"create-hash":386,"safe-buffer":494}],470:[function(r,n,i){arguments[4][184][0].apply(i,arguments)},{buffer:188,dup:184}],471:[function(r,n,i){var s=r("parse-asn1"),o=r("./mgf"),a=r("./xor"),l=r("bn.js"),c=r("browserify-rsa"),u=r("create-hash"),h=r("./withPublic"),d=r("safe-buffer").Buffer;n.exports=function(f,m,v){var g;g=f.padding?f.padding:v?1:4;var w,y=s(f),C=y.modulus.byteLength();if(m.length>C||new l(m).cmp(y.modulus)>=0)throw new Error("decryption error");w=v?h(new l(m),y):c(m,y);var k=d.alloc(C-w.length);if(w=d.concat([k,w],C),g===4)return(function(F,I){var N=F.modulus.byteLength(),j=u("sha1").update(d.alloc(0)).digest(),L=j.length;if(I[0]!==0)throw new Error("decryption error");var W=I.slice(1,L+1),K=I.slice(L+1),z=a(W,o(K,L)),M=a(K,o(z,N-L-1));if((function(R,S){R=d.from(R),S=d.from(S);var _=0,T=R.length;R.length!==S.length&&(_++,T=Math.min(R.length,S.length));for(var E=-1;++E<T;)_+=R[E]^S[E];return _})(j,M.slice(0,L)))throw new Error("decryption error");for(var B=L;M[B]===0;)B++;if(M[B++]!==1)throw new Error("decryption error");return M.slice(B)})(y,w);if(g===1)return(function(F,I,N){for(var j=I.slice(0,2),L=2,W=0;I[L++]!==0;)if(L>=I.length){W++;break}var K=I.slice(2,L-1);if((j.toString("hex")!=="0002"&&!N||j.toString("hex")!=="0001"&&N)&&W++,K.length<8&&W++,W)throw new Error("decryption error");return I.slice(L)})(0,w,v);if(g===3)return w;throw new Error("unknown padding")}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,"safe-buffer":494}],472:[function(r,n,i){var s=r("parse-asn1"),o=r("randombytes"),a=r("create-hash"),l=r("./mgf"),c=r("./xor"),u=r("bn.js"),h=r("./withPublic"),d=r("browserify-rsa"),f=r("safe-buffer").Buffer;n.exports=function(m,v,g){var w;w=m.padding?m.padding:g?1:4;var y,C=s(m);if(w===4)y=(function(k,F){var I=k.modulus.byteLength(),N=F.length,j=a("sha1").update(f.alloc(0)).digest(),L=j.length,W=2*L;if(N>I-W-2)throw new Error("message too long");var K=f.alloc(I-N-W-2),z=I-L-1,M=o(L),B=c(f.concat([j,K,f.alloc(1,1),F],z),l(M,z)),R=c(M,l(B,L));return new u(f.concat([f.alloc(1),R,B],I))})(C,v);else if(w===1)y=(function(k,F,I){var N,j=F.length,L=k.modulus.byteLength();if(j>L-11)throw new Error("message too long");return N=I?f.alloc(L-j-3,255):(function(W){for(var K,z=f.allocUnsafe(W),M=0,B=o(2*W),R=0;M<W;)R===B.length&&(B=o(2*W),R=0),(K=B[R++])&&(z[M++]=K);return z})(L-j-3),new u(f.concat([f.from([0,I?1:2]),N,f.alloc(1),F],L))})(C,v,g);else{if(w!==3)throw new Error("unknown padding");if((y=new u(v)).cmp(C.modulus)>=0)throw new Error("data too long for modulus")}return g?d(y,C):h(y,C)}},{"./mgf":469,"./withPublic":473,"./xor":474,"bn.js":470,"browserify-rsa":209,"create-hash":386,"parse-asn1":459,randombytes:475,"safe-buffer":494}],473:[function(r,n,i){var s=r("bn.js"),o=r("safe-buffer").Buffer;n.exports=function(a,l){return o.from(a.toRed(s.mont(l.modulus)).redPow(new s(l.publicExponent)).fromRed().toArray())}},{"bn.js":470,"safe-buffer":494}],474:[function(r,n,i){n.exports=function(s,o){for(var a=s.length,l=-1;++l<a;)s[l]^=o[l];return s}},{}],475:[function(r,n,i){(function(s,o){(function(){var a=r("safe-buffer").Buffer,l=o.crypto||o.msCrypto;l&&l.getRandomValues?n.exports=function(c,u){if(c>4294967295)throw new RangeError("requested too many random bytes");var h=a.allocUnsafe(c);if(c>0)if(c>65536)for(var d=0;d<c;d+=65536)l.getRandomValues(h.slice(d,d+65536));else l.getRandomValues(h);return typeof u=="function"?s.nextTick((function(){u(null,h)})):h}:n.exports=function(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}}).call(this)}).call(this,r("_process"),typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,"safe-buffer":494}],476:[function(r,n,i){(function(s,o){(function(){function a(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var l=r("safe-buffer"),c=r("randombytes"),u=l.Buffer,h=l.kMaxLength,d=o.crypto||o.msCrypto,f=Math.pow(2,32)-1;function m(w,y){if(typeof w!="number"||w!=w)throw new TypeError("offset must be a number");if(w>f||w<0)throw new TypeError("offset must be a uint32");if(w>h||w>y)throw new RangeError("offset out of range")}function v(w,y,C){if(typeof w!="number"||w!=w)throw new TypeError("size must be a number");if(w>f||w<0)throw new TypeError("size must be a uint32");if(w+y>C||w>h)throw new RangeError("buffer too small")}function g(w,y,C,k){if(s.browser){var F=w.buffer,I=new Uint8Array(F,y,C);return d.getRandomValues(I),k?void s.nextTick((function(){k(null,w)})):w}if(!k)return c(C).copy(w,y),w;c(C,(function(N,j){if(N)return k(N);j.copy(w,y),k(null,w)}))}d&&d.getRandomValues||!s.browser?(i.randomFill=function(w,y,C,k){if(!(u.isBuffer(w)||w instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof y=="function")k=y,y=0,C=w.length;else if(typeof C=="function")k=C,C=w.length-y;else if(typeof k!="function")throw new TypeError('"cb" argument must be a function');return m(y,w.length),v(C,y,w.length),g(w,y,C,k)},i.randomFillSync=function(w,y,C){if(y===void 0&&(y=0),!(u.isBuffer(w)||w instanceof o.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return m(y,w.length),C===void 0&&(C=w.length-y),v(C,y,w.length),g(w,y,C)}):(i.randomFill=a,i.randomFillSync=a)}).call(this)}).call(this,r("_process"),typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{_process:467,randombytes:475,"safe-buffer":494}],477:[function(r,n,i){var s={};function o(l,c,u){u||(u=Error);var h=(function(d){var f,m;function v(g,w,y){return d.call(this,(function(C,k,F){return typeof c=="string"?c:c(C,k,F)})(g,w,y))||this}return m=d,(f=v).prototype=Object.create(m.prototype),f.prototype.constructor=f,f.__proto__=m,v})(u);h.prototype.name=u.name,h.prototype.code=l,s[l]=h}function a(l,c){if(Array.isArray(l)){var u=l.length;return l=l.map((function(h){return String(h)})),u>2?"one of ".concat(c," ").concat(l.slice(0,u-1).join(", "),", or ")+l[u-1]:u===2?"one of ".concat(c," ").concat(l[0]," or ").concat(l[1]):"of ".concat(c," ").concat(l[0])}return"of ".concat(c," ").concat(String(l))}o("ERR_INVALID_OPT_VALUE",(function(l,c){return'The value "'+c+'" is invalid for option "'+l+'"'}),TypeError),o("ERR_INVALID_ARG_TYPE",(function(l,c,u){var h,d,f;if(typeof c=="string"&&(d="not ",c.substr(0,d.length)===d)?(h="must not be",c=c.replace(/^not /,"")):h="must be",(function(v,g,w){return(w===void 0||w>v.length)&&(w=v.length),v.substring(w-g.length,w)===g})(l," argument"))f="The ".concat(l," ").concat(h," ").concat(a(c,"type"));else{var m=(function(v,g,w){return typeof w!="number"&&(w=0),!(w+g.length>v.length)&&v.indexOf(g,w)!==-1})(l,".")?"property":"argument";f='The "'.concat(l,'" ').concat(m," ").concat(h," ").concat(a(c,"type"))}return f+=". Received type ".concat(typeof u)}),TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",(function(l){return"The "+l+" method is not implemented"})),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",(function(l){return"Cannot call "+l+" after a stream was destroyed"})),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",(function(l){return"Unknown encoding: "+l}),TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),n.exports.codes=s},{}],478:[function(r,n,i){(function(s){(function(){var o=Object.keys||function(v){var g=[];for(var w in v)g.push(w);return g};n.exports=d;var a=r("./_stream_readable"),l=r("./_stream_writable");r("inherits")(d,a);for(var c=o(l.prototype),u=0;u<c.length;u++){var h=c[u];d.prototype[h]||(d.prototype[h]=l.prototype[h])}function d(v){if(!(this instanceof d))return new d(v);a.call(this,v),l.call(this,v),this.allowHalfOpen=!0,v&&(v.readable===!1&&(this.readable=!1),v.writable===!1&&(this.writable=!1),v.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",f)))}function f(){this._writableState.ended||s.nextTick(m,this)}function m(v){v.end()}Object.defineProperty(d.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(d.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(d.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(d.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(v){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=v,this._writableState.destroyed=v)}})}).call(this)}).call(this,r("_process"))},{"./_stream_readable":480,"./_stream_writable":482,_process:467,inherits:440}],479:[function(r,n,i){n.exports=o;var s=r("./_stream_transform");function o(a){if(!(this instanceof o))return new o(a);s.call(this,a)}r("inherits")(o,s),o.prototype._transform=function(a,l,c){c(null,a)}},{"./_stream_transform":481,inherits:440}],480:[function(r,n,i){(function(s,o){(function(){var a;n.exports=z,z.ReadableState=K,r("events").EventEmitter;var l=function(V,H){return V.listeners(H).length},c=r("./internal/streams/stream"),u=r("buffer").Buffer,h=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},d,f=r("util");d=f&&f.debuglog?f.debuglog("stream"):function(){};var m,v,g,w=r("./internal/streams/buffer_list"),y=r("./internal/streams/destroy"),C=r("./internal/streams/state").getHighWaterMark,k=r("../errors").codes,F=k.ERR_INVALID_ARG_TYPE,I=k.ERR_STREAM_PUSH_AFTER_EOF,N=k.ERR_METHOD_NOT_IMPLEMENTED,j=k.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r("inherits")(z,c);var L=y.errorOrDestroy,W=["error","close","destroy","pause","resume"];function K(V,H,Z){a=a||r("./_stream_duplex"),V=V||{},typeof Z!="boolean"&&(Z=H instanceof a),this.objectMode=!!V.objectMode,Z&&(this.objectMode=this.objectMode||!!V.readableObjectMode),this.highWaterMark=C(this,V,"readableHighWaterMark",Z),this.buffer=new w,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=V.emitClose!==!1,this.autoDestroy=!!V.autoDestroy,this.destroyed=!1,this.defaultEncoding=V.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,V.encoding&&(m||(m=r("string_decoder/").StringDecoder),this.decoder=new m(V.encoding),this.encoding=V.encoding)}function z(V){if(a=a||r("./_stream_duplex"),!(this instanceof z))return new z(V);var H=this instanceof a;this._readableState=new K(V,this,H),this.readable=!0,V&&(typeof V.read=="function"&&(this._read=V.read),typeof V.destroy=="function"&&(this._destroy=V.destroy)),c.call(this)}function M(V,H,Z,ie,te){d("readableAddChunk",H);var oe,ue=V._readableState;if(H===null)ue.reading=!1,(function(Ce,ye){if(d("onEofChunk"),!ye.ended){if(ye.decoder){var ne=ye.decoder.end();ne&&ne.length&&(ye.buffer.push(ne),ye.length+=ye.objectMode?1:ne.length)}ye.ended=!0,ye.sync?S(Ce):(ye.needReadable=!1,ye.emittedReadable||(ye.emittedReadable=!0,_(Ce)))}})(V,ue);else if(te||(oe=(function(Ce,ye){var ne;me=ye,u.isBuffer(me)||me instanceof h||typeof ye=="string"||ye===void 0||Ce.objectMode||(ne=new F("chunk",["string","Buffer","Uint8Array"],ye));var me;return ne})(ue,H)),oe)L(V,oe);else if(ue.objectMode||H&&H.length>0)if(typeof H=="string"||ue.objectMode||Object.getPrototypeOf(H)===u.prototype||(H=(function(Ce){return u.from(Ce)})(H)),ie)ue.endEmitted?L(V,new j):B(V,ue,H,!0);else if(ue.ended)L(V,new I);else{if(ue.destroyed)return!1;ue.reading=!1,ue.decoder&&!Z?(H=ue.decoder.write(H),ue.objectMode||H.length!==0?B(V,ue,H,!1):T(V,ue)):B(V,ue,H,!1)}else ie||(ue.reading=!1,T(V,ue));return!ue.ended&&(ue.length<ue.highWaterMark||ue.length===0)}function B(V,H,Z,ie){H.flowing&&H.length===0&&!H.sync?(H.awaitDrain=0,V.emit("data",Z)):(H.length+=H.objectMode?1:Z.length,ie?H.buffer.unshift(Z):H.buffer.push(Z),H.needReadable&&S(V)),T(V,H)}Object.defineProperty(z.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(V){this._readableState&&(this._readableState.destroyed=V)}}),z.prototype.destroy=y.destroy,z.prototype._undestroy=y.undestroy,z.prototype._destroy=function(V,H){H(V)},z.prototype.push=function(V,H){var Z,ie=this._readableState;return ie.objectMode?Z=!0:typeof V=="string"&&((H=H||ie.defaultEncoding)!==ie.encoding&&(V=u.from(V,H),H=""),Z=!0),M(this,V,H,!1,Z)},z.prototype.unshift=function(V){return M(this,V,null,!0,!1)},z.prototype.isPaused=function(){return this._readableState.flowing===!1},z.prototype.setEncoding=function(V){m||(m=r("string_decoder/").StringDecoder);var H=new m(V);this._readableState.decoder=H,this._readableState.encoding=this._readableState.decoder.encoding;for(var Z=this._readableState.buffer.head,ie="";Z!==null;)ie+=H.write(Z.data),Z=Z.next;return this._readableState.buffer.clear(),ie!==""&&this._readableState.buffer.push(ie),this._readableState.length=ie.length,this};function R(V,H){return V<=0||H.length===0&&H.ended?0:H.objectMode?1:V!=V?H.flowing&&H.length?H.buffer.head.data.length:H.length:(V>H.highWaterMark&&(H.highWaterMark=(function(Z){return Z>=1073741824?Z=1073741824:(Z--,Z|=Z>>>1,Z|=Z>>>2,Z|=Z>>>4,Z|=Z>>>8,Z|=Z>>>16,Z++),Z})(V)),V<=H.length?V:H.ended?H.length:(H.needReadable=!0,0))}function S(V){var H=V._readableState;d("emitReadable",H.needReadable,H.emittedReadable),H.needReadable=!1,H.emittedReadable||(d("emitReadable",H.flowing),H.emittedReadable=!0,s.nextTick(_,V))}function _(V){var H=V._readableState;d("emitReadable_",H.destroyed,H.length,H.ended),H.destroyed||!H.length&&!H.ended||(V.emit("readable"),H.emittedReadable=!1),H.needReadable=!H.flowing&&!H.ended&&H.length<=H.highWaterMark,q(V)}function T(V,H){H.readingMore||(H.readingMore=!0,s.nextTick(E,V,H))}function E(V,H){for(;!H.reading&&!H.ended&&(H.length<H.highWaterMark||H.flowing&&H.length===0);){var Z=H.length;if(d("maybeReadMore read 0"),V.read(0),Z===H.length)break}H.readingMore=!1}function D(V){var H=V._readableState;H.readableListening=V.listenerCount("readable")>0,H.resumeScheduled&&!H.paused?H.flowing=!0:V.listenerCount("data")>0&&V.resume()}function O(V){d("readable nexttick read 0"),V.read(0)}function P(V,H){d("resume",H.reading),H.reading||V.read(0),H.resumeScheduled=!1,V.emit("resume"),q(V),H.flowing&&!H.reading&&V.read(0)}function q(V){var H=V._readableState;for(d("flow",H.flowing);H.flowing&&V.read()!==null;);}function X(V,H){return H.length===0?null:(H.objectMode?Z=H.buffer.shift():!V||V>=H.length?(Z=H.decoder?H.buffer.join(""):H.buffer.length===1?H.buffer.first():H.buffer.concat(H.length),H.buffer.clear()):Z=H.buffer.consume(V,H.decoder),Z);var Z}function Q(V){var H=V._readableState;d("endReadable",H.endEmitted),H.endEmitted||(H.ended=!0,s.nextTick(G,H,V))}function G(V,H){if(d("endReadableNT",V.endEmitted,V.length),!V.endEmitted&&V.length===0&&(V.endEmitted=!0,H.readable=!1,H.emit("end"),V.autoDestroy)){var Z=H._writableState;(!Z||Z.autoDestroy&&Z.finished)&&H.destroy()}}function ee(V,H){for(var Z=0,ie=V.length;Z<ie;Z++)if(V[Z]===H)return Z;return-1}z.prototype.read=function(V){d("read",V),V=parseInt(V,10);var H=this._readableState,Z=V;if(V!==0&&(H.emittedReadable=!1),V===0&&H.needReadable&&((H.highWaterMark!==0?H.length>=H.highWaterMark:H.length>0)||H.ended))return d("read: emitReadable",H.length,H.ended),H.length===0&&H.ended?Q(this):S(this),null;if((V=R(V,H))===0&&H.ended)return H.length===0&&Q(this),null;var ie,te=H.needReadable;return d("need readable",te),(H.length===0||H.length-V<H.highWaterMark)&&d("length less than watermark",te=!0),H.ended||H.reading?d("reading or ended",te=!1):te&&(d("do read"),H.reading=!0,H.sync=!0,H.length===0&&(H.needReadable=!0),this._read(H.highWaterMark),H.sync=!1,H.reading||(V=R(Z,H))),(ie=V>0?X(V,H):null)===null?(H.needReadable=H.length<=H.highWaterMark,V=0):(H.length-=V,H.awaitDrain=0),H.length===0&&(H.ended||(H.needReadable=!0),Z!==V&&H.ended&&Q(this)),ie!==null&&this.emit("data",ie),ie},z.prototype._read=function(V){L(this,new N("_read()"))},z.prototype.pipe=function(V,H){var Z=this,ie=this._readableState;switch(ie.pipesCount){case 0:ie.pipes=V;break;case 1:ie.pipes=[ie.pipes,V];break;default:ie.pipes.push(V)}ie.pipesCount+=1,d("pipe count=%d opts=%j",ie.pipesCount,H);var te=(!H||H.end!==!1)&&V!==s.stdout&&V!==s.stderr?ue:xe;function oe(Fe,Ge){d("onunpipe"),Fe===Z&&Ge&&Ge.hasUnpiped===!1&&(Ge.hasUnpiped=!0,d("cleanup"),V.removeListener("close",ve),V.removeListener("finish",Te),V.removeListener("drain",Ce),V.removeListener("error",me),V.removeListener("unpipe",oe),Z.removeListener("end",ue),Z.removeListener("end",xe),Z.removeListener("data",ne),ye=!0,!ie.awaitDrain||V._writableState&&!V._writableState.needDrain||Ce())}function ue(){d("onend"),V.end()}ie.endEmitted?s.nextTick(te):Z.once("end",te),V.on("unpipe",oe);var Ce=(function(Fe){return function(){var Ge=Fe._readableState;d("pipeOnDrain",Ge.awaitDrain),Ge.awaitDrain&&Ge.awaitDrain--,Ge.awaitDrain===0&&l(Fe,"data")&&(Ge.flowing=!0,q(Fe))}})(Z);V.on("drain",Ce);var ye=!1;function ne(Fe){d("ondata");var Ge=V.write(Fe);d("dest.write",Ge),Ge===!1&&((ie.pipesCount===1&&ie.pipes===V||ie.pipesCount>1&&ee(ie.pipes,V)!==-1)&&!ye&&(d("false write response, pause",ie.awaitDrain),ie.awaitDrain++),Z.pause())}function me(Fe){d("onerror",Fe),xe(),V.removeListener("error",me),l(V,"error")===0&&L(V,Fe)}function ve(){V.removeListener("finish",Te),xe()}function Te(){d("onfinish"),V.removeListener("close",ve),xe()}function xe(){d("unpipe"),Z.unpipe(V)}return Z.on("data",ne),(function(Fe,Ge,Ve){if(typeof Fe.prependListener=="function")return Fe.prependListener(Ge,Ve);Fe._events&&Fe._events[Ge]?Array.isArray(Fe._events[Ge])?Fe._events[Ge].unshift(Ve):Fe._events[Ge]=[Ve,Fe._events[Ge]]:Fe.on(Ge,Ve)})(V,"error",me),V.once("close",ve),V.once("finish",Te),V.emit("pipe",Z),ie.flowing||(d("pipe resume"),Z.resume()),V},z.prototype.unpipe=function(V){var H=this._readableState,Z={hasUnpiped:!1};if(H.pipesCount===0)return this;if(H.pipesCount===1)return V&&V!==H.pipes||(V||(V=H.pipes),H.pipes=null,H.pipesCount=0,H.flowing=!1,V&&V.emit("unpipe",this,Z)),this;if(!V){var ie=H.pipes,te=H.pipesCount;H.pipes=null,H.pipesCount=0,H.flowing=!1;for(var oe=0;oe<te;oe++)ie[oe].emit("unpipe",this,{hasUnpiped:!1});return this}var ue=ee(H.pipes,V);return ue===-1||(H.pipes.splice(ue,1),H.pipesCount-=1,H.pipesCount===1&&(H.pipes=H.pipes[0]),V.emit("unpipe",this,Z)),this},z.prototype.on=function(V,H){var Z=c.prototype.on.call(this,V,H),ie=this._readableState;return V==="data"?(ie.readableListening=this.listenerCount("readable")>0,ie.flowing!==!1&&this.resume()):V==="readable"&&(ie.endEmitted||ie.readableListening||(ie.readableListening=ie.needReadable=!0,ie.flowing=!1,ie.emittedReadable=!1,d("on readable",ie.length,ie.reading),ie.length?S(this):ie.reading||s.nextTick(O,this))),Z},z.prototype.addListener=z.prototype.on,z.prototype.removeListener=function(V,H){var Z=c.prototype.removeListener.call(this,V,H);return V==="readable"&&s.nextTick(D,this),Z},z.prototype.removeAllListeners=function(V){var H=c.prototype.removeAllListeners.apply(this,arguments);return V!=="readable"&&V!==void 0||s.nextTick(D,this),H},z.prototype.resume=function(){var V=this._readableState;return V.flowing||(d("resume"),V.flowing=!V.readableListening,(function(H,Z){Z.resumeScheduled||(Z.resumeScheduled=!0,s.nextTick(P,H,Z))})(this,V)),V.paused=!1,this},z.prototype.pause=function(){return d("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(d("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},z.prototype.wrap=function(V){var H=this,Z=this._readableState,ie=!1;for(var te in V.on("end",(function(){if(d("wrapped end"),Z.decoder&&!Z.ended){var ue=Z.decoder.end();ue&&ue.length&&H.push(ue)}H.push(null)})),V.on("data",(function(ue){d("wrapped data"),Z.decoder&&(ue=Z.decoder.write(ue)),Z.objectMode&&ue==null||(Z.objectMode||ue&&ue.length)&&(H.push(ue)||(ie=!0,V.pause()))})),V)this[te]===void 0&&typeof V[te]=="function"&&(this[te]=(function(ue){return function(){return V[ue].apply(V,arguments)}})(te));for(var oe=0;oe<W.length;oe++)V.on(W[oe],this.emit.bind(this,W[oe]));return this._read=function(ue){d("wrapped _read",ue),ie&&(ie=!1,V.resume())},this},typeof Symbol=="function"&&(z.prototype[Symbol.asyncIterator]=function(){return v===void 0&&(v=r("./internal/streams/async_iterator")),v(this)}),Object.defineProperty(z.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(z.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(z.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(V){this._readableState&&(this._readableState.flowing=V)}}),z._fromList=X,Object.defineProperty(z.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),typeof Symbol=="function"&&(z.from=function(V,H){return g===void 0&&(g=r("./internal/streams/from")),g(z,V,H)})}).call(this)}).call(this,r("_process"),typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/async_iterator":483,"./internal/streams/buffer_list":484,"./internal/streams/destroy":485,"./internal/streams/from":487,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,events:422,inherits:440,"string_decoder/":522,util:188}],481:[function(r,n,i){n.exports=d;var s=r("../errors").codes,o=s.ERR_METHOD_NOT_IMPLEMENTED,a=s.ERR_MULTIPLE_CALLBACK,l=s.ERR_TRANSFORM_ALREADY_TRANSFORMING,c=s.ERR_TRANSFORM_WITH_LENGTH_0,u=r("./_stream_duplex");function h(v,g){var w=this._transformState;w.transforming=!1;var y=w.writecb;if(y===null)return this.emit("error",new a);w.writechunk=null,w.writecb=null,g!=null&&this.push(g),y(v);var C=this._readableState;C.reading=!1,(C.needReadable||C.length<C.highWaterMark)&&this._read(C.highWaterMark)}function d(v){if(!(this instanceof d))return new d(v);u.call(this,v),this._transformState={afterTransform:h.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,v&&(typeof v.transform=="function"&&(this._transform=v.transform),typeof v.flush=="function"&&(this._flush=v.flush)),this.on("prefinish",f)}function f(){var v=this;typeof this._flush!="function"||this._readableState.destroyed?m(this,null,null):this._flush((function(g,w){m(v,g,w)}))}function m(v,g,w){if(g)return v.emit("error",g);if(w!=null&&v.push(w),v._writableState.length)throw new c;if(v._transformState.transforming)throw new l;return v.push(null)}r("inherits")(d,u),d.prototype.push=function(v,g){return this._transformState.needTransform=!1,u.prototype.push.call(this,v,g)},d.prototype._transform=function(v,g,w){w(new o("_transform()"))},d.prototype._write=function(v,g,w){var y=this._transformState;if(y.writecb=w,y.writechunk=v,y.writeencoding=g,!y.transforming){var C=this._readableState;(y.needTransform||C.needReadable||C.length<C.highWaterMark)&&this._read(C.highWaterMark)}},d.prototype._read=function(v){var g=this._transformState;g.writechunk===null||g.transforming?g.needTransform=!0:(g.transforming=!0,this._transform(g.writechunk,g.writeencoding,g.afterTransform))},d.prototype._destroy=function(v,g){u.prototype._destroy.call(this,v,(function(w){g(w)}))}},{"../errors":477,"./_stream_duplex":478,inherits:440}],482:[function(r,n,i){(function(s,o){(function(){function a(E){var D=this;this.next=null,this.entry=null,this.finish=function(){(function(O,P,q){var X=O.entry;for(O.entry=null;X;){var Q=X.callback;P.pendingcb--,Q(q),X=X.next}P.corkedRequestsFree.next=O})(D,E)}}var l;n.exports=z,z.WritableState=K;var c={deprecate:r("util-deprecate")},u=r("./internal/streams/stream"),h=r("buffer").Buffer,d=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},f,m=r("./internal/streams/destroy"),v=r("./internal/streams/state").getHighWaterMark,g=r("../errors").codes,w=g.ERR_INVALID_ARG_TYPE,y=g.ERR_METHOD_NOT_IMPLEMENTED,C=g.ERR_MULTIPLE_CALLBACK,k=g.ERR_STREAM_CANNOT_PIPE,F=g.ERR_STREAM_DESTROYED,I=g.ERR_STREAM_NULL_VALUES,N=g.ERR_STREAM_WRITE_AFTER_END,j=g.ERR_UNKNOWN_ENCODING,L=m.errorOrDestroy;function W(){}function K(E,D,O){l=l||r("./_stream_duplex"),E=E||{},typeof O!="boolean"&&(O=D instanceof l),this.objectMode=!!E.objectMode,O&&(this.objectMode=this.objectMode||!!E.writableObjectMode),this.highWaterMark=v(this,E,"writableHighWaterMark",O),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var P=E.decodeStrings===!1;this.decodeStrings=!P,this.defaultEncoding=E.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(q){(function(X,Q){var G=X._writableState,ee=G.sync,V=G.writecb;if(typeof V!="function")throw new C;if((function(Z){Z.writing=!1,Z.writecb=null,Z.length-=Z.writelen,Z.writelen=0})(G),Q)(function(Z,ie,te,oe,ue){--ie.pendingcb,te?(s.nextTick(ue,oe),s.nextTick(T,Z,ie),Z._writableState.errorEmitted=!0,L(Z,oe)):(ue(oe),Z._writableState.errorEmitted=!0,L(Z,oe),T(Z,ie))})(X,G,ee,Q,V);else{var H=S(G)||X.destroyed;H||G.corked||G.bufferProcessing||!G.bufferedRequest||R(X,G),ee?s.nextTick(B,X,G,H,V):B(X,G,H,V)}})(D,q)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=E.emitClose!==!1,this.autoDestroy=!!E.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function z(E){var D=this instanceof(l=l||r("./_stream_duplex"));if(!D&&!f.call(z,this))return new z(E);this._writableState=new K(E,this,D),this.writable=!0,E&&(typeof E.write=="function"&&(this._write=E.write),typeof E.writev=="function"&&(this._writev=E.writev),typeof E.destroy=="function"&&(this._destroy=E.destroy),typeof E.final=="function"&&(this._final=E.final)),u.call(this)}function M(E,D,O,P,q,X,Q){D.writelen=P,D.writecb=Q,D.writing=!0,D.sync=!0,D.destroyed?D.onwrite(new F("write")):O?E._writev(q,D.onwrite):E._write(q,X,D.onwrite),D.sync=!1}function B(E,D,O,P){O||(function(q,X){X.length===0&&X.needDrain&&(X.needDrain=!1,q.emit("drain"))})(E,D),D.pendingcb--,P(),T(E,D)}function R(E,D){D.bufferProcessing=!0;var O=D.bufferedRequest;if(E._writev&&O&&O.next){var P=D.bufferedRequestCount,q=new Array(P),X=D.corkedRequestsFree;X.entry=O;for(var Q=0,G=!0;O;)q[Q]=O,O.isBuf||(G=!1),O=O.next,Q+=1;q.allBuffers=G,M(E,D,!0,D.length,q,"",X.finish),D.pendingcb++,D.lastBufferedRequest=null,X.next?(D.corkedRequestsFree=X.next,X.next=null):D.corkedRequestsFree=new a(D),D.bufferedRequestCount=0}else{for(;O;){var ee=O.chunk,V=O.encoding,H=O.callback;if(M(E,D,!1,D.objectMode?1:ee.length,ee,V,H),O=O.next,D.bufferedRequestCount--,D.writing)break}O===null&&(D.lastBufferedRequest=null)}D.bufferedRequest=O,D.bufferProcessing=!1}function S(E){return E.ending&&E.length===0&&E.bufferedRequest===null&&!E.finished&&!E.writing}function _(E,D){E._final((function(O){D.pendingcb--,O&&L(E,O),D.prefinished=!0,E.emit("prefinish"),T(E,D)}))}function T(E,D){var O=S(D);if(O&&((function(q,X){X.prefinished||X.finalCalled||(typeof q._final!="function"||X.destroyed?(X.prefinished=!0,q.emit("prefinish")):(X.pendingcb++,X.finalCalled=!0,s.nextTick(_,q,X)))})(E,D),D.pendingcb===0&&(D.finished=!0,E.emit("finish"),D.autoDestroy))){var P=E._readableState;(!P||P.autoDestroy&&P.endEmitted)&&E.destroy()}return O}r("inherits")(z,u),K.prototype.getBuffer=function(){for(var E=this.bufferedRequest,D=[];E;)D.push(E),E=E.next;return D},(function(){try{Object.defineProperty(K.prototype,"buffer",{get:c.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(z,Symbol.hasInstance,{value:function(E){return!!f.call(this,E)||this===z&&E&&E._writableState instanceof K}})):f=function(E){return E instanceof this},z.prototype.pipe=function(){L(this,new k)},z.prototype.write=function(E,D,O){var P,q=this._writableState,X=!1,Q=!q.objectMode&&(P=E,h.isBuffer(P)||P instanceof d);return Q&&!h.isBuffer(E)&&(E=(function(G){return h.from(G)})(E)),typeof D=="function"&&(O=D,D=null),Q?D="buffer":D||(D=q.defaultEncoding),typeof O!="function"&&(O=W),q.ending?(function(G,ee){var V=new N;L(G,V),s.nextTick(ee,V)})(this,O):(Q||(function(G,ee,V,H){var Z;return V===null?Z=new I:typeof V=="string"||ee.objectMode||(Z=new w("chunk",["string","Buffer"],V)),!Z||(L(G,Z),s.nextTick(H,Z),!1)})(this,q,E,O))&&(q.pendingcb++,X=(function(G,ee,V,H,Z,ie){if(!V){var te=(function(ye,ne,me){return ye.objectMode||ye.decodeStrings===!1||typeof ne!="string"||(ne=h.from(ne,me)),ne})(ee,H,Z);H!==te&&(V=!0,Z="buffer",H=te)}var oe=ee.objectMode?1:H.length;ee.length+=oe;var ue=ee.length<ee.highWaterMark;if(ue||(ee.needDrain=!0),ee.writing||ee.corked){var Ce=ee.lastBufferedRequest;ee.lastBufferedRequest={chunk:H,encoding:Z,isBuf:V,callback:ie,next:null},Ce?Ce.next=ee.lastBufferedRequest:ee.bufferedRequest=ee.lastBufferedRequest,ee.bufferedRequestCount+=1}else M(G,ee,!1,oe,H,Z,ie);return ue})(this,q,Q,E,D,O)),X},z.prototype.cork=function(){this._writableState.corked++},z.prototype.uncork=function(){var E=this._writableState;E.corked&&(E.corked--,E.writing||E.corked||E.bufferProcessing||!E.bufferedRequest||R(this,E))},z.prototype.setDefaultEncoding=function(E){if(typeof E=="string"&&(E=E.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((E+"").toLowerCase())>-1))throw new j(E);return this._writableState.defaultEncoding=E,this},Object.defineProperty(z.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(z.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),z.prototype._write=function(E,D,O){O(new y("_write()"))},z.prototype._writev=null,z.prototype.end=function(E,D,O){var P=this._writableState;return typeof E=="function"?(O=E,E=null,D=null):typeof D=="function"&&(O=D,D=null),E!=null&&this.write(E,D),P.corked&&(P.corked=1,this.uncork()),P.ending||(function(q,X,Q){X.ending=!0,T(q,X),Q&&(X.finished?s.nextTick(Q):q.once("finish",Q)),X.ended=!0,q.writable=!1})(this,P,O),this},Object.defineProperty(z.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(z.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(E){this._writableState&&(this._writableState.destroyed=E)}}),z.prototype.destroy=m.destroy,z.prototype._undestroy=m.undestroy,z.prototype._destroy=function(E,D){D(E)}}).call(this)}).call(this,r("_process"),typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{"../errors":477,"./_stream_duplex":478,"./internal/streams/destroy":485,"./internal/streams/state":489,"./internal/streams/stream":490,_process:467,buffer:220,inherits:440,"util-deprecate":524}],483:[function(r,n,i){(function(s){(function(){var o;function a(F,I,N){return(I=(function(j){var L=(function(W,K){if(typeof W!="object"||W===null)return W;var z=W[Symbol.toPrimitive];if(z!==void 0){var M=z.call(W,K);if(typeof M!="object")return M;throw new TypeError("@@toPrimitive must return a primitive value.")}return(K==="string"?String:Number)(W)})(j,"string");return typeof L=="symbol"?L:String(L)})(I))in F?Object.defineProperty(F,I,{value:N,enumerable:!0,configurable:!0,writable:!0}):F[I]=N,F}var l=r("./end-of-stream"),c=Symbol("lastResolve"),u=Symbol("lastReject"),h=Symbol("error"),d=Symbol("ended"),f=Symbol("lastPromise"),m=Symbol("handlePromise"),v=Symbol("stream");function g(F,I){return{value:F,done:I}}function w(F){var I=F[c];if(I!==null){var N=F[v].read();N!==null&&(F[f]=null,F[c]=null,F[u]=null,I(g(N,!1)))}}function y(F){s.nextTick(w,F)}var C=Object.getPrototypeOf((function(){})),k=Object.setPrototypeOf((a(o={get stream(){return this[v]},next:function(){var F=this,I=this[h];if(I!==null)return Promise.reject(I);if(this[d])return Promise.resolve(g(void 0,!0));if(this[v].destroyed)return new Promise((function(W,K){s.nextTick((function(){F[h]?K(F[h]):W(g(void 0,!0))}))}));var N,j=this[f];if(j)N=new Promise((function(W,K){return function(z,M){W.then((function(){K[d]?z(g(void 0,!0)):K[m](z,M)}),M)}})(j,this));else{var L=this[v].read();if(L!==null)return Promise.resolve(g(L,!1));N=new Promise(this[m])}return this[f]=N,N}},Symbol.asyncIterator,(function(){return this})),a(o,"return",(function(){var F=this;return new Promise((function(I,N){F[v].destroy(null,(function(j){j?N(j):I(g(void 0,!0))}))}))})),o),C);n.exports=function(F){var I,N=Object.create(k,(a(I={},v,{value:F,writable:!0}),a(I,c,{value:null,writable:!0}),a(I,u,{value:null,writable:!0}),a(I,h,{value:null,writable:!0}),a(I,d,{value:F._readableState.endEmitted,writable:!0}),a(I,m,{value:function(j,L){var W=N[v].read();W?(N[f]=null,N[c]=null,N[u]=null,j(g(W,!1))):(N[c]=j,N[u]=L)},writable:!0}),I));return N[f]=null,l(F,(function(j){if(j&&j.code!=="ERR_STREAM_PREMATURE_CLOSE"){var L=N[u];return L!==null&&(N[f]=null,N[c]=null,N[u]=null,L(j)),void(N[h]=j)}var W=N[c];W!==null&&(N[f]=null,N[c]=null,N[u]=null,W(g(void 0,!0))),N[d]=!0})),F.on("readable",y.bind(null,N)),N}}).call(this)}).call(this,r("_process"))},{"./end-of-stream":486,_process:467}],484:[function(r,n,i){function s(f,m){var v=Object.keys(f);if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(f);m&&(g=g.filter((function(w){return Object.getOwnPropertyDescriptor(f,w).enumerable}))),v.push.apply(v,g)}return v}function o(f){for(var m=1;m<arguments.length;m++){var v=arguments[m]!=null?arguments[m]:{};m%2?s(Object(v),!0).forEach((function(g){a(f,g,v[g])})):Object.getOwnPropertyDescriptors?Object.defineProperties(f,Object.getOwnPropertyDescriptors(v)):s(Object(v)).forEach((function(g){Object.defineProperty(f,g,Object.getOwnPropertyDescriptor(v,g))}))}return f}function a(f,m,v){return(m=c(m))in f?Object.defineProperty(f,m,{value:v,enumerable:!0,configurable:!0,writable:!0}):f[m]=v,f}function l(f,m){for(var v=0;v<m.length;v++){var g=m[v];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,c(g.key),g)}}function c(f){var m=(function(v,g){if(typeof v!="object"||v===null)return v;var w=v[Symbol.toPrimitive];if(w!==void 0){var y=w.call(v,g);if(typeof y!="object")return y;throw new TypeError("@@toPrimitive must return a primitive value.")}return(g==="string"?String:Number)(v)})(f,"string");return typeof m=="symbol"?m:String(m)}var u=r("buffer").Buffer,h=r("util").inspect,d=h&&h.custom||"inspect";n.exports=(function(){function f(){(function(g,w){if(!(g instanceof w))throw new TypeError("Cannot call a class as a function")})(this,f),this.head=null,this.tail=null,this.length=0}var m,v;return m=f,(v=[{key:"push",value:function(g){var w={data:g,next:null};this.length>0?this.tail.next=w:this.head=w,this.tail=w,++this.length}},{key:"unshift",value:function(g){var w={data:g,next:this.head};this.length===0&&(this.tail=w),this.head=w,++this.length}},{key:"shift",value:function(){if(this.length!==0){var g=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,g}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(g){if(this.length===0)return"";for(var w=this.head,y=""+w.data;w=w.next;)y+=g+w.data;return y}},{key:"concat",value:function(g){if(this.length===0)return u.alloc(0);for(var w,y,C,k=u.allocUnsafe(g>>>0),F=this.head,I=0;F;)w=F.data,y=k,C=I,u.prototype.copy.call(w,y,C),I+=F.data.length,F=F.next;return k}},{key:"consume",value:function(g,w){var y;return g<this.head.data.length?(y=this.head.data.slice(0,g),this.head.data=this.head.data.slice(g)):y=g===this.head.data.length?this.shift():w?this._getString(g):this._getBuffer(g),y}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(g){var w=this.head,y=1,C=w.data;for(g-=C.length;w=w.next;){var k=w.data,F=g>k.length?k.length:g;if(F===k.length?C+=k:C+=k.slice(0,g),(g-=F)==0){F===k.length?(++y,w.next?this.head=w.next:this.head=this.tail=null):(this.head=w,w.data=k.slice(F));break}++y}return this.length-=y,C}},{key:"_getBuffer",value:function(g){var w=u.allocUnsafe(g),y=this.head,C=1;for(y.data.copy(w),g-=y.data.length;y=y.next;){var k=y.data,F=g>k.length?k.length:g;if(k.copy(w,w.length-g,0,F),(g-=F)==0){F===k.length?(++C,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=k.slice(F));break}++C}return this.length-=C,w}},{key:d,value:function(g,w){return h(this,o(o({},w),{},{depth:0,customInspect:!1}))}}])&&l(m.prototype,v),Object.defineProperty(m,"prototype",{writable:!1}),f})()},{buffer:220,util:188}],485:[function(r,n,i){(function(s){(function(){function o(c,u){l(c,u),a(c)}function a(c){c._writableState&&!c._writableState.emitClose||c._readableState&&!c._readableState.emitClose||c.emit("close")}function l(c,u){c.emit("error",u)}n.exports={destroy:function(c,u){var h=this,d=this._readableState&&this._readableState.destroyed,f=this._writableState&&this._writableState.destroyed;return d||f?(u?u(c):c&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,s.nextTick(l,this,c)):s.nextTick(l,this,c)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(c||null,(function(m){!u&&m?h._writableState?h._writableState.errorEmitted?s.nextTick(a,h):(h._writableState.errorEmitted=!0,s.nextTick(o,h,m)):s.nextTick(o,h,m):u?(s.nextTick(a,h),u(m)):s.nextTick(a,h)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(c,u){var h=c._readableState,d=c._writableState;h&&h.autoDestroy||d&&d.autoDestroy?c.destroy(u):c.emit("error",u)}}}).call(this)}).call(this,r("_process"))},{_process:467}],486:[function(r,n,i){var s=r("../../../errors").codes.ERR_STREAM_PREMATURE_CLOSE;function o(){}n.exports=function a(l,c,u){if(typeof c=="function")return a(l,null,c);c||(c={}),u=(function(F){var I=!1;return function(){if(!I){I=!0;for(var N=arguments.length,j=new Array(N),L=0;L<N;L++)j[L]=arguments[L];F.apply(this,j)}}})(u||o);var h=c.readable||c.readable!==!1&&l.readable,d=c.writable||c.writable!==!1&&l.writable,f=function(){l.writable||v()},m=l._writableState&&l._writableState.finished,v=function(){d=!1,m=!0,h||u.call(l)},g=l._readableState&&l._readableState.endEmitted,w=function(){h=!1,g=!0,d||u.call(l)},y=function(F){u.call(l,F)},C=function(){var F;return h&&!g?(l._readableState&&l._readableState.ended||(F=new s),u.call(l,F)):d&&!m?(l._writableState&&l._writableState.ended||(F=new s),u.call(l,F)):void 0},k=function(){l.req.on("finish",v)};return(function(F){return F.setHeader&&typeof F.abort=="function"})(l)?(l.on("complete",v),l.on("abort",C),l.req?k():l.on("request",k)):d&&!l._writableState&&(l.on("end",f),l.on("close",f)),l.on("end",w),l.on("finish",v),c.error!==!1&&l.on("error",y),l.on("close",C),function(){l.removeListener("complete",v),l.removeListener("abort",C),l.removeListener("request",k),l.req&&l.req.removeListener("finish",v),l.removeListener("end",f),l.removeListener("close",f),l.removeListener("finish",v),l.removeListener("end",w),l.removeListener("error",y),l.removeListener("close",C)}}},{"../../../errors":477}],487:[function(r,n,i){n.exports=function(){throw new Error("Readable.from is not available in the browser")}},{}],488:[function(r,n,i){var s,o=r("../../../errors").codes,a=o.ERR_MISSING_ARGS,l=o.ERR_STREAM_DESTROYED;function c(m){if(m)throw m}function u(m,v,g,w){w=(function(k){var F=!1;return function(){F||(F=!0,k.apply(void 0,arguments))}})(w);var y=!1;m.on("close",(function(){y=!0})),s===void 0&&(s=r("./end-of-stream")),s(m,{readable:v,writable:g},(function(k){if(k)return w(k);y=!0,w()}));var C=!1;return function(k){if(!y&&!C)return C=!0,(function(F){return F.setHeader&&typeof F.abort=="function"})(m)?m.abort():typeof m.destroy=="function"?m.destroy():void w(k||new l("pipe"))}}function h(m){m()}function d(m,v){return m.pipe(v)}function f(m){return m.length?typeof m[m.length-1]!="function"?c:m.pop():c}n.exports=function(){for(var m=arguments.length,v=new Array(m),g=0;g<m;g++)v[g]=arguments[g];var w,y=f(v);if(Array.isArray(v[0])&&(v=v[0]),v.length<2)throw new a("streams");var C=v.map((function(k,F){var I=F<v.length-1;return u(k,I,F>0,(function(N){w||(w=N),N&&C.forEach(h),I||(C.forEach(h),y(w))}))}));return v.reduce(d)}},{"../../../errors":477,"./end-of-stream":486}],489:[function(r,n,i){var s=r("../../../errors").codes.ERR_INVALID_OPT_VALUE;n.exports={getHighWaterMark:function(o,a,l,c){var u=(function(h,d,f){return h.highWaterMark!=null?h.highWaterMark:d?h[f]:null})(a,c,l);if(u!=null){if(!isFinite(u)||Math.floor(u)!==u||u<0)throw new s(c?l:"highWaterMark",u);return Math.floor(u)}return o.objectMode?16:16384}}},{"../../../errors":477}],490:[function(r,n,i){n.exports=r("events").EventEmitter},{events:422}],491:[function(r,n,i){(i=n.exports=r("./lib/_stream_readable.js")).Stream=i,i.Readable=i,i.Writable=r("./lib/_stream_writable.js"),i.Duplex=r("./lib/_stream_duplex.js"),i.Transform=r("./lib/_stream_transform.js"),i.PassThrough=r("./lib/_stream_passthrough.js"),i.finished=r("./lib/internal/streams/end-of-stream.js"),i.pipeline=r("./lib/internal/streams/pipeline.js")},{"./lib/_stream_duplex.js":478,"./lib/_stream_passthrough.js":479,"./lib/_stream_readable.js":480,"./lib/_stream_transform.js":481,"./lib/_stream_writable.js":482,"./lib/internal/streams/end-of-stream.js":486,"./lib/internal/streams/pipeline.js":488}],492:[function(r,n,i){var s=(function(o){var a=Object.prototype,l=a.hasOwnProperty,c=Object.defineProperty||function(T,E,D){T[E]=D.value},u=typeof Symbol=="function"?Symbol:{},h=u.iterator||"@@iterator",d=u.asyncIterator||"@@asyncIterator",f=u.toStringTag||"@@toStringTag";function m(T,E,D){return Object.defineProperty(T,E,{value:D,enumerable:!0,configurable:!0,writable:!0}),T[E]}try{m({},"")}catch{m=function(E,D,O){return E[D]=O}}function v(T,E,D,O){var P=E&&E.prototype instanceof y?E:y,q=Object.create(P.prototype),X=new R(O||[]);return c(q,"_invoke",{value:K(T,D,X)}),q}function g(T,E,D){try{return{type:"normal",arg:T.call(E,D)}}catch(O){return{type:"throw",arg:O}}}o.wrap=v;var w={};function y(){}function C(){}function k(){}var F={};m(F,h,(function(){return this}));var I=Object.getPrototypeOf,N=I&&I(I(S([])));N&&N!==a&&l.call(N,h)&&(F=N);var j=k.prototype=y.prototype=Object.create(F);function L(T){["next","throw","return"].forEach((function(E){m(T,E,(function(D){return this._invoke(E,D)}))}))}function W(T,E){var D;c(this,"_invoke",{value:function(O,P){function q(){return new E((function(X,Q){(function G(ee,V,H,Z){var ie=g(T[ee],T,V);if(ie.type!=="throw"){var te=ie.arg,oe=te.value;return oe&&typeof oe=="object"&&l.call(oe,"__await")?E.resolve(oe.__await).then((function(ue){G("next",ue,H,Z)}),(function(ue){G("throw",ue,H,Z)})):E.resolve(oe).then((function(ue){te.value=ue,H(te)}),(function(ue){return G("throw",ue,H,Z)}))}Z(ie.arg)})(O,P,X,Q)}))}return D=D?D.then(q,q):q()}})}function K(T,E,D){var O="suspendedStart";return function(P,q){if(O==="executing")throw new Error("Generator is already running");if(O==="completed"){if(P==="throw")throw q;return _()}for(D.method=P,D.arg=q;;){var X=D.delegate;if(X){var Q=z(X,D);if(Q){if(Q===w)continue;return Q}}if(D.method==="next")D.sent=D._sent=D.arg;else if(D.method==="throw"){if(O==="suspendedStart")throw O="completed",D.arg;D.dispatchException(D.arg)}else D.method==="return"&&D.abrupt("return",D.arg);O="executing";var G=g(T,E,D);if(G.type==="normal"){if(O=D.done?"completed":"suspendedYield",G.arg===w)continue;return{value:G.arg,done:D.done}}G.type==="throw"&&(O="completed",D.method="throw",D.arg=G.arg)}}}function z(T,E){var D=E.method,O=T.iterator[D];if(O===void 0)return E.delegate=null,D==="throw"&&T.iterator.return&&(E.method="return",E.arg=void 0,z(T,E),E.method==="throw")||D!=="return"&&(E.method="throw",E.arg=new TypeError("The iterator does not provide a '"+D+"' method")),w;var P=g(O,T.iterator,E.arg);if(P.type==="throw")return E.method="throw",E.arg=P.arg,E.delegate=null,w;var q=P.arg;return q?q.done?(E[T.resultName]=q.value,E.next=T.nextLoc,E.method!=="return"&&(E.method="next",E.arg=void 0),E.delegate=null,w):q:(E.method="throw",E.arg=new TypeError("iterator result is not an object"),E.delegate=null,w)}function M(T){var E={tryLoc:T[0]};1 in T&&(E.catchLoc=T[1]),2 in T&&(E.finallyLoc=T[2],E.afterLoc=T[3]),this.tryEntries.push(E)}function B(T){var E=T.completion||{};E.type="normal",delete E.arg,T.completion=E}function R(T){this.tryEntries=[{tryLoc:"root"}],T.forEach(M,this),this.reset(!0)}function S(T){if(T){var E=T[h];if(E)return E.call(T);if(typeof T.next=="function")return T;if(!isNaN(T.length)){var D=-1,O=function P(){for(;++D<T.length;)if(l.call(T,D))return P.value=T[D],P.done=!1,P;return P.value=void 0,P.done=!0,P};return O.next=O}}return{next:_}}function _(){return{value:void 0,done:!0}}return C.prototype=k,c(j,"constructor",{value:k,configurable:!0}),c(k,"constructor",{value:C,configurable:!0}),C.displayName=m(k,f,"GeneratorFunction"),o.isGeneratorFunction=function(T){var E=typeof T=="function"&&T.constructor;return!!E&&(E===C||(E.displayName||E.name)==="GeneratorFunction")},o.mark=function(T){return Object.setPrototypeOf?Object.setPrototypeOf(T,k):(T.__proto__=k,m(T,f,"GeneratorFunction")),T.prototype=Object.create(j),T},o.awrap=function(T){return{__await:T}},L(W.prototype),m(W.prototype,d,(function(){return this})),o.AsyncIterator=W,o.async=function(T,E,D,O,P){P===void 0&&(P=Promise);var q=new W(v(T,E,D,O),P);return o.isGeneratorFunction(E)?q:q.next().then((function(X){return X.done?X.value:q.next()}))},L(j),m(j,f,"Generator"),m(j,h,(function(){return this})),m(j,"toString",(function(){return"[object Generator]"})),o.keys=function(T){var E=Object(T),D=[];for(var O in E)D.push(O);return D.reverse(),function P(){for(;D.length;){var q=D.pop();if(q in E)return P.value=q,P.done=!1,P}return P.done=!0,P}},o.values=S,R.prototype={constructor:R,reset:function(T){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(B),!T)for(var E in this)E.charAt(0)==="t"&&l.call(this,E)&&!isNaN(+E.slice(1))&&(this[E]=void 0)},stop:function(){this.done=!0;var T=this.tryEntries[0].completion;if(T.type==="throw")throw T.arg;return this.rval},dispatchException:function(T){if(this.done)throw T;var E=this;function D(G,ee){return q.type="throw",q.arg=T,E.next=G,ee&&(E.method="next",E.arg=void 0),!!ee}for(var O=this.tryEntries.length-1;O>=0;--O){var P=this.tryEntries[O],q=P.completion;if(P.tryLoc==="root")return D("end");if(P.tryLoc<=this.prev){var X=l.call(P,"catchLoc"),Q=l.call(P,"finallyLoc");if(X&&Q){if(this.prev<P.catchLoc)return D(P.catchLoc,!0);if(this.prev<P.finallyLoc)return D(P.finallyLoc)}else if(X){if(this.prev<P.catchLoc)return D(P.catchLoc,!0)}else{if(!Q)throw new Error("try statement without catch or finally");if(this.prev<P.finallyLoc)return D(P.finallyLoc)}}}},abrupt:function(T,E){for(var D=this.tryEntries.length-1;D>=0;--D){var O=this.tryEntries[D];if(O.tryLoc<=this.prev&&l.call(O,"finallyLoc")&&this.prev<O.finallyLoc){var P=O;break}}P&&(T==="break"||T==="continue")&&P.tryLoc<=E&&E<=P.finallyLoc&&(P=null);var q=P?P.completion:{};return q.type=T,q.arg=E,P?(this.method="next",this.next=P.finallyLoc,w):this.complete(q)},complete:function(T,E){if(T.type==="throw")throw T.arg;return T.type==="break"||T.type==="continue"?this.next=T.arg:T.type==="return"?(this.rval=this.arg=T.arg,this.method="return",this.next="end"):T.type==="normal"&&E&&(this.next=E),w},finish:function(T){for(var E=this.tryEntries.length-1;E>=0;--E){var D=this.tryEntries[E];if(D.finallyLoc===T)return this.complete(D.completion,D.afterLoc),B(D),w}},catch:function(T){for(var E=this.tryEntries.length-1;E>=0;--E){var D=this.tryEntries[E];if(D.tryLoc===T){var O=D.completion;if(O.type==="throw"){var P=O.arg;B(D)}return P}}throw new Error("illegal catch attempt")},delegateYield:function(T,E,D){return this.delegate={iterator:S(T),resultName:E,nextLoc:D},this.method==="next"&&(this.arg=void 0),w}},o})(typeof n=="object"?n.exports:{});try{regeneratorRuntime=s}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=s:Function("r","regeneratorRuntime = r")(s)}},{}],493:[function(r,n,i){var s=r("buffer").Buffer,o=r("inherits"),a=r("hash-base"),l=new Array(16),c=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],u=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],h=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],d=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],f=[0,1518500249,1859775393,2400959708,2840853838],m=[1352829926,1548603684,1836072691,2053994217,0];function v(){a.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function g(I,N){return I<<N|I>>>32-N}function w(I,N,j,L,W,K,z,M){return g(I+(N^j^L)+K+z|0,M)+W|0}function y(I,N,j,L,W,K,z,M){return g(I+(N&j|~N&L)+K+z|0,M)+W|0}function C(I,N,j,L,W,K,z,M){return g(I+((N|~j)^L)+K+z|0,M)+W|0}function k(I,N,j,L,W,K,z,M){return g(I+(N&L|j&~L)+K+z|0,M)+W|0}function F(I,N,j,L,W,K,z,M){return g(I+(N^(j|~L))+K+z|0,M)+W|0}o(v,a),v.prototype._update=function(){for(var I=l,N=0;N<16;++N)I[N]=this._block.readInt32LE(4*N);for(var j=0|this._a,L=0|this._b,W=0|this._c,K=0|this._d,z=0|this._e,M=0|this._a,B=0|this._b,R=0|this._c,S=0|this._d,_=0|this._e,T=0;T<80;T+=1){var E,D;T<16?(E=w(j,L,W,K,z,I[c[T]],f[0],h[T]),D=F(M,B,R,S,_,I[u[T]],m[0],d[T])):T<32?(E=y(j,L,W,K,z,I[c[T]],f[1],h[T]),D=k(M,B,R,S,_,I[u[T]],m[1],d[T])):T<48?(E=C(j,L,W,K,z,I[c[T]],f[2],h[T]),D=C(M,B,R,S,_,I[u[T]],m[2],d[T])):T<64?(E=k(j,L,W,K,z,I[c[T]],f[3],h[T]),D=y(M,B,R,S,_,I[u[T]],m[3],d[T])):(E=F(j,L,W,K,z,I[c[T]],f[4],h[T]),D=w(M,B,R,S,_,I[u[T]],m[4],d[T])),j=z,z=K,K=g(W,10),W=L,L=E,M=_,_=S,S=g(R,10),R=B,B=D}var O=this._b+W+S|0;this._b=this._c+K+_|0,this._c=this._d+z+M|0,this._d=this._e+j+B|0,this._e=this._a+L+R|0,this._a=O},v.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var I=s.alloc?s.alloc(20):new s(20);return I.writeInt32LE(this._a,0),I.writeInt32LE(this._b,4),I.writeInt32LE(this._c,8),I.writeInt32LE(this._d,12),I.writeInt32LE(this._e,16),I},n.exports=v},{buffer:220,"hash-base":425,inherits:440}],494:[function(r,n,i){var s=r("buffer"),o=s.Buffer;function a(c,u){for(var h in c)u[h]=c[h]}function l(c,u,h){return o(c,u,h)}o.from&&o.alloc&&o.allocUnsafe&&o.allocUnsafeSlow?n.exports=s:(a(s,i),i.Buffer=l),l.prototype=Object.create(o.prototype),a(o,l),l.from=function(c,u,h){if(typeof c=="number")throw new TypeError("Argument must not be a number");return o(c,u,h)},l.alloc=function(c,u,h){if(typeof c!="number")throw new TypeError("Argument must be a number");var d=o(c);return u!==void 0?typeof h=="string"?d.fill(u,h):d.fill(u):d.fill(0),d},l.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return o(c)},l.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return s.SlowBuffer(c)}},{buffer:220}],495:[function(r,n,i){(function(s){(function(){var o,a=r("buffer"),l=a.Buffer,c={};for(o in a)a.hasOwnProperty(o)&&o!=="SlowBuffer"&&o!=="Buffer"&&(c[o]=a[o]);var u=c.Buffer={};for(o in l)l.hasOwnProperty(o)&&o!=="allocUnsafe"&&o!=="allocUnsafeSlow"&&(u[o]=l[o]);if(c.Buffer.prototype=l.prototype,u.from&&u.from!==Uint8Array.from||(u.from=function(h,d,f){if(typeof h=="number")throw new TypeError('The "value" argument must not be of type number. Received type '+typeof h);if(h&&h.length===void 0)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof h);return l(h,d,f)}),u.alloc||(u.alloc=function(h,d,f){if(typeof h!="number")throw new TypeError('The "size" argument must be of type number. Received type '+typeof h);if(h<0||h>=2*(1<<30))throw new RangeError('The value "'+h+'" is invalid for option "size"');var m=l(h);return d&&d.length!==0?typeof f=="string"?m.fill(d,f):m.fill(d):m.fill(0),m}),!c.kStringMaxLength)try{c.kStringMaxLength=s.binding("buffer").kStringMaxLength}catch{}c.constants||(c.constants={MAX_LENGTH:c.kMaxLength},c.kStringMaxLength&&(c.constants.MAX_STRING_LENGTH=c.kStringMaxLength)),n.exports=c}).call(this)}).call(this,r("_process"))},{_process:467,buffer:220}],496:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0});const s=r("xmlchars/xml/1.0/ed5"),o=r("xmlchars/xml/1.1/ed2"),a=r("xmlchars/xmlns/1.0/ed3");var l=s.isS,c=s.isChar,u=s.isNameStartChar,h=s.isNameChar,d=s.S_LIST,f=s.NAME_RE,m=o.isChar,v=a.isNCNameStartChar,g=a.isNCNameChar,w=a.NC_NAME_RE;const y="http://www.w3.org/XML/1998/namespace",C="http://www.w3.org/2000/xmlns/",k={__proto__:null,xml:y,xmlns:C},F={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},I=S=>S===34||S===39,N=[34,39],j=[...N,91,62],L=[...N,60,93],W=[61,63,...d],K=[...d,62,38,60];function z(S,_,T){switch(_){case"xml":T!==y&&S.fail(`xml prefix must be bound to ${y}.`);break;case"xmlns":T!==C&&S.fail(`xmlns prefix must be bound to ${C}.`)}switch(T){case C:S.fail(_===""?`the default namespace may not be set to ${T}.`:`may not assign a prefix (even "xmlns") to the URI ${C}.`);break;case y:switch(_){case"xml":break;case"":S.fail(`the default namespace may not be set to ${T}.`);break;default:S.fail("may not assign the xml namespace to another prefix.")}}}const M=S=>w.test(S),B=S=>f.test(S);i.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const R={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};i.SaxesParser=class{constructor(S){this.opt=S??{},this.fragmentOpt=!!this.opt.fragment;const _=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=this.opt.position!==!1,this.fileName=this.opt.fileName,_){this.nameStartCheck=v,this.nameCheck=g,this.isName=M,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},k);const T=this.opt.additionalNamespaces;T!=null&&((function(E,D){for(const O of Object.keys(D))z(E,O,D[O])})(this,T),Object.assign(this.ns,T))}else this.nameStartCheck=u,this.nameCheck=h,this.isName=B,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var S;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:_}=this;this.state=_?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=_,this.xmlDeclPossible=!_,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:T}=this.opt;if(T===void 0){if(this.opt.forceXMLVersion===!0)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");T="1.0"}this.setXMLVersion(T),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(F),(S=this.readyHandler)===null||S===void 0||S.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(S,_){this[R[S]]=_}off(S){this[R[S]]=void 0}makeError(S){var _;let T=(_=this.fileName)!==null&&_!==void 0?_:"";return this.trackPosition&&(T.length>0&&(T+=":"),T+=`${this.line}:${this.column}`),T.length>0&&(T+=": "),new Error(T+S)}fail(S){const _=this.makeError(S),T=this.errorHandler;if(T===void 0)throw _;return T(_),this}write(S){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let _=!1;S===null?(_=!0,S=""):typeof S=="object"&&(S=S.toString()),this.carriedFromPrevious!==void 0&&(S=`${this.carriedFromPrevious}${S}`,this.carriedFromPrevious=void 0);let T=S.length;const E=S.charCodeAt(T-1);!_&&(E===13||E>=55296&&E<=56319)&&(this.carriedFromPrevious=S[T-1],T--,S=S.slice(0,T));const{stateTable:D}=this;for(this.chunk=S,this.i=0;this.i<T;)D[this.state].call(this);return this.chunkPosition+=T,_?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:S,i:_}=this;if(this.prevI=_,this.i=_+1,_>=S.length)return-1;const T=S.charCodeAt(_);if(this.column++,T<55296){if(T>=32||T===9)return T;switch(T){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return S.charCodeAt(_+1)===10&&(this.i=_+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),T}}if(T>56319)return T>=57344&&T<=65533||this.fail("disallowed character."),T;const E=65536+1024*(T-55296)+(S.charCodeAt(_+1)-56320);return this.i=_+2,E>1114111&&this.fail("disallowed character."),E}getCode11(){const{chunk:S,i:_}=this;if(this.prevI=_,this.i=_+1,_>=S.length)return-1;const T=S.charCodeAt(_);if(this.column++,T<55296){if(T>31&&T<127||T>159&&T!==8232||T===9)return T;switch(T){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{const D=S.charCodeAt(_+1);D!==10&&D!==133||(this.i=_+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),T}}if(T>56319)return T>=57344&&T<=65533||this.fail("disallowed character."),T;const E=65536+1024*(T-55296)+(S.charCodeAt(_+1)-56320);return this.i=_+2,E>1114111&&this.fail("disallowed character."),E}getCodeNorm(){const S=this.getCode();return S===-2?10:S}unget(){this.i=this.prevI,this.column--}captureTo(S){let{i:_}=this;const{chunk:T}=this;for(;;){const E=this.getCode(),D=E===-2,O=D?10:E;if(O===-1||S.includes(O))return this.text+=T.slice(_,this.prevI),O;D&&(this.text+=T.slice(_,this.prevI)+`
`,_=this.i)}}captureToChar(S){let{i:_}=this;const{chunk:T}=this;for(;;){let E=this.getCode();switch(E){case-2:this.text+=T.slice(_,this.prevI)+`
`,_=this.i,E=10;break;case-1:return this.text+=T.slice(_),!1}if(E===S)return this.text+=T.slice(_,this.prevI),!0}}captureNameChars(){const{chunk:S,i:_}=this;for(;;){const T=this.getCode();if(T===-1)return this.name+=S.slice(_),-1;if(!h(T))return this.name+=S.slice(_,this.prevI),T===-2?10:T}}skipSpaces(){for(;;){const S=this.getCodeNorm();if(S===-1||!l(S))return S}}setXMLVersion(S){this.currentXMLVersion=S,S==="1.0"?(this.isChar=c,this.getCode=this.getCode10):(this.isChar=m,this.getCode=this.getCode11)}sBegin(){this.chunk.charCodeAt(0)===65279&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const S=this.i,_=this.skipSpaces();switch(this.prevI!==S&&(this.xmlDeclPossible=!1),_){case 60:if(this.state=15,this.text.length!==0)throw new Error("no-empty text at start");break;case-1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var S;const _=this.captureTo(j);switch(_){case 62:(S=this.doctypeHandler)===null||S===void 0||S.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case-1:break;default:this.text+=String.fromCodePoint(_),_===91?this.state=4:I(_)&&(this.state=3,this.q=_)}}sDoctypeQuote(){const S=this.q;this.captureToChar(S)&&(this.text+=String.fromCodePoint(S),this.q=null,this.state=2)}sDTD(){const S=this.captureTo(L);S!==-1&&(this.text+=String.fromCodePoint(S),S===93?this.state=2:S===60?this.state=6:I(S)&&(this.state=5,this.q=S))}sDTDQuoted(){const S=this.q;this.captureToChar(S)&&(this.text+=String.fromCodePoint(S),this.state=4,this.q=null)}sDTDOpenWaka(){const S=this.getCodeNorm();switch(this.text+=String.fromCodePoint(S),S){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const S=String.fromCodePoint(this.getCodeNorm()),_=this.openWakaBang+=S;this.text+=S,_!=="-"&&(this.state=_==="--"?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const S=this.getCodeNorm();this.text+=String.fromCodePoint(S),this.state=S===45?10:8}sDTDCommentEnded(){const S=this.getCodeNorm();this.text+=String.fromCodePoint(S),S===62?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const S=this.getCodeNorm();this.text+=String.fromCodePoint(S),S===62&&(this.state=4)}sText(){this.tags.length!==0?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:S}=this;const{chunk:_}=this;e:for(;;)switch(this.getCode()){case-2:this.entity+=_.slice(S,this.prevI)+`
`,S=this.i;break;case 59:{const{entityReturnState:T}=this,E=this.entity+_.slice(S,this.prevI);let D;this.state=T,E===""?(this.fail("empty entity name."),D="&;"):(D=this.parseEntity(E),this.entity=""),T===13&&this.textHandler===void 0||(this.text+=D);break e}case-1:this.entity+=_.slice(S);break e}}sOpenWaka(){const S=this.getCode();if(u(S))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(S){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var S;const _=this.getCodeNorm();_===45?(this.state=19,(S=this.commentHandler)===null||S===void 0||S.call(this,this.text),this.text=""):(this.text+="-"+String.fromCodePoint(_),this.state=17)}sCommentEnded(){const S=this.getCodeNorm();S!==62?(this.fail("malformed comment."),this.text+="--"+String.fromCodePoint(S),this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){const S=this.getCodeNorm();S===93?this.state=22:(this.text+="]"+String.fromCodePoint(S),this.state=20)}sCDataEnding2(){var S;const _=this.getCodeNorm();switch(_){case 62:(S=this.cdataHandler)===null||S===void 0||S.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+="]]"+String.fromCodePoint(_),this.state=20}}sPIFirstChar(){const S=this.getCodeNorm();this.nameStartCheck(S)?(this.piTarget+=String.fromCodePoint(S),this.state=24):S===63||l(S)?(this.fail("processing instruction without a target."),this.state=S===63?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(S),this.state=24)}sPIRest(){const{chunk:S,i:_}=this;for(;;){const T=this.getCodeNorm();if(T===-1)return void(this.piTarget+=S.slice(_));if(!this.nameCheck(T)){this.piTarget+=S.slice(_,this.prevI);const E=T===63;E||l(T)?this.piTarget==="xml"?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=E?33:27):this.state=E?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(T));break}}}sPIBody(){if(this.text.length===0){const S=this.getCodeNorm();S===63?this.state=26:l(S)||(this.text=String.fromCodePoint(S))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var S;const _=this.getCodeNorm();if(_===62){const{piTarget:T}=this;T.toLowerCase()==="xml"&&this.fail("the XML declaration must appear at the start of the document."),(S=this.piHandler)===null||S===void 0||S.call(this,{target:T,body:this.text}),this.piTarget=this.text="",this.state=13}else _===63?this.text+="?":(this.text+="?"+String.fromCodePoint(_),this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const S=this.skipSpaces();S!==63?S!==-1&&(this.state=28,this.name=String.fromCodePoint(S)):this.state=33}sXMLDeclName(){const S=this.captureTo(W);if(S===63)return this.state=33,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(l(S)||S===61){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail("expected one of "+this.xmlDeclExpects.join(", "))}this.state=S===61?30:29}}sXMLDeclEq(){const S=this.getCodeNorm();if(S===63)return this.state=33,void this.fail("XML declaration is incomplete.");l(S)||(S!==61&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const S=this.getCodeNorm();if(S===63)return this.state=33,void this.fail("XML declaration is incomplete.");l(S)||(I(S)?this.q=S:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const S=this.captureTo([this.q,63]);if(S===63)return this.state=33,this.text="",void this.fail("XML declaration is incomplete.");if(S===-1)return;const _=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const T=_;this.xmlDecl.version=T,/^1\.[0-9]+$/.test(T)?this.opt.forceXMLVersion||this.setXMLVersion(T):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(_)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=_;break;case"standalone":_!=="yes"&&_!=="no"&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=_}this.name="",this.state=32}sXMLDeclSeparator(){const S=this.getCodeNorm();S!==63?(l(S)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=33}sXMLDeclEnding(){var S;this.getCodeNorm()===62?(this.piTarget!=="xml"?this.fail("processing instructions are not allowed before root."):this.name!=="version"&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),(S=this.xmldeclHandler)===null||S===void 0||S.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var S;const _=this.captureNameChars();if(_===-1)return;const T=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=T.ns=Object.create(null)),(S=this.openTagStartHandler)===null||S===void 0||S.call(this,T),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),_){case 62:this.openTag();break;case 47:this.state=35;break;default:l(_)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===62?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const S=this.skipSpaces();S!==-1&&(u(S)?(this.unget(),this.state=37):S===62?this.openTag():S===47?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const S=this.captureNameChars();S===61?this.state=39:l(S)?this.state=38:S===62?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):S!==-1&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const S=this.skipSpaces();switch(S){case-1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",S===62?this.openTag():u(S)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const S=this.getCodeNorm();I(S)?(this.q=S,this.state=40):l(S)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:S,chunk:_}=this;let{i:T}=this;for(;;)switch(this.getCode()){case S:return this.pushAttrib(this.name,this.text+_.slice(T,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=_.slice(T,this.prevI),this.state=14,void(this.entityReturnState=40);case 10:case-2:case 9:this.text+=_.slice(T,this.prevI)+" ",T=this.i;break;case 60:return this.text+=_.slice(T,this.prevI),void this.fail("disallowed character.");case-1:return void(this.text+=_.slice(T))}}sAttribValueClosed(){const S=this.getCodeNorm();l(S)?this.state=36:S===62?this.openTag():S===47?this.state=35:u(S)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const S=this.captureTo(K);switch(S){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case-1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",S===62?this.openTag():this.state=36}}sCloseTag(){const S=this.captureNameChars();S===62?this.closeTag():l(S)?this.state=44:S!==-1&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case-1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:S,forbiddenState:_}=this;const{chunk:T,textHandler:E}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,E!==void 0){const{text:D}=this,O=T.slice(S,this.prevI);D.length!==0?(E(D+O),this.text=""):O.length!==0&&E(O)}_=0;break e;case 38:this.state=14,this.entityReturnState=13,E!==void 0&&(this.text+=T.slice(S,this.prevI)),_=0;break e;case 93:switch(_){case 0:_=1;break;case 1:_=2;break;case 2:break;default:throw new Error("impossible state")}break;case 62:_===2&&this.fail('the string "]]>" is disallowed in char data.'),_=0;break;case-2:E!==void 0&&(this.text+=T.slice(S,this.prevI)+`
`),S=this.i,_=0;break;case-1:E!==void 0&&(this.text+=T.slice(S));break e;default:_=0}this.forbiddenState=_}handleTextOutsideRoot(){let{i:S}=this;const{chunk:_,textHandler:T}=this;let E=!1;e:for(;;){const D=this.getCode();switch(D){case 60:if(this.state=15,T!==void 0){const{text:O}=this,P=_.slice(S,this.prevI);O.length!==0?(T(O+P),this.text=""):P.length!==0&&T(P)}break e;case 38:this.state=14,this.entityReturnState=13,T!==void 0&&(this.text+=_.slice(S,this.prevI)),E=!0;break e;case-2:T!==void 0&&(this.text+=_.slice(S,this.prevI)+`
`),S=this.i;break;case-1:T!==void 0&&(this.text+=_.slice(S));break e;default:l(D)||(E=!0)}}E&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(S,_){var T;const{prefix:E,local:D}=this.qname(S),O={name:S,prefix:E,local:D,value:_};if(this.attribList.push(O),(T=this.attributeHandler)===null||T===void 0||T.call(this,O),E==="xmlns"){const P=_.trim();this.currentXMLVersion==="1.0"&&P===""&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[D]=P,z(this,D,P)}else if(S==="xmlns"){const P=_.trim();this.topNS[""]=P,z(this,"",P)}}pushAttribPlain(S,_){var T;const E={name:S,value:_};this.attribList.push(E),(T=this.attributeHandler)===null||T===void 0||T.call(this,E)}end(){var S,_;this.sawRoot||this.fail("document must contain a root element.");const{tags:T}=this;for(;T.length>0;){const D=T.pop();this.fail("unclosed tag: "+D.name)}this.state!==0&&this.state!==13&&this.fail("unexpected end.");const{text:E}=this;return E.length!==0&&((S=this.textHandler)===null||S===void 0||S.call(this,E),this.text=""),this._closed=!0,(_=this.endHandler)===null||_===void 0||_.call(this),this._init(),this}resolve(S){var _,T;let E=this.topNS[S];if(E!==void 0)return E;const{tags:D}=this;for(let O=D.length-1;O>=0;O--)if(E=D[O].ns[S],E!==void 0)return E;return E=this.ns[S],E!==void 0?E:(T=(_=this.opt).resolvePrefix)===null||T===void 0?void 0:T.call(_,S)}qname(S){const _=S.indexOf(":");if(_===-1)return{prefix:"",local:S};const T=S.slice(_+1),E=S.slice(0,_);return(E===""||T===""||T.includes(":"))&&this.fail(`malformed name: ${S}.`),{prefix:E,local:T}}processAttribsNS(){var S;const{attribList:_}=this,T=this.tag;{const{prefix:O,local:P}=this.qname(T.name);T.prefix=O,T.local=P;const q=T.uri=(S=this.resolve(O))!==null&&S!==void 0?S:"";O!==""&&(O==="xmlns"&&this.fail('tags may not have "xmlns" as prefix.'),q===""&&(this.fail(`unbound namespace prefix: ${JSON.stringify(O)}.`),T.uri=O))}if(_.length===0)return;const{attributes:E}=T,D=new Set;for(const O of _){const{name:P,prefix:q,local:X}=O;let Q,G;q===""?(Q=P==="xmlns"?C:"",G=P):(Q=this.resolve(q),Q===void 0&&(this.fail(`unbound namespace prefix: ${JSON.stringify(q)}.`),Q=q),G=`{${Q}}${X}`),D.has(G)&&this.fail(`duplicate attribute: ${G}.`),D.add(G),O.uri=Q,E[P]=O}this.attribList=[]}processAttribsPlain(){const{attribList:S}=this,_=this.tag.attributes;for(const{name:T,value:E}of S)_[T]!==void 0&&this.fail(`duplicate attribute: ${T}.`),_[T]=E;this.attribList=[]}openTag(){var S;this.processAttribs();const{tags:_}=this,T=this.tag;T.isSelfClosing=!1,(S=this.openTagHandler)===null||S===void 0||S.call(this,T),_.push(T),this.state=13,this.name=""}openSelfClosingTag(){var S,_,T;this.processAttribs();const{tags:E}=this,D=this.tag;D.isSelfClosing=!0,(S=this.openTagHandler)===null||S===void 0||S.call(this,D),(_=this.closeTagHandler)===null||_===void 0||_.call(this,D),(this.tag=(T=E[E.length-1])!==null&&T!==void 0?T:null)===null&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){const{tags:S,name:_}=this;if(this.state=13,this.name="",_==="")return this.fail("weird empty close tag."),void(this.text+="</>");const T=this.closeTagHandler;let E=S.length;for(;E-- >0;){const D=this.tag=S.pop();if(this.topNS=D.ns,T?.(D),D.name===_)break;this.fail("unexpected close tag.")}E===0?this.closedRoot=!0:E<0&&(this.fail(`unmatched closing tag: ${_}.`),this.text+=`</${_}>`)}parseEntity(S){if(S[0]!=="#"){const T=this.ENTITIES[S];return T!==void 0?T:(this.fail(this.isName(S)?"undefined entity.":"disallowed character in entity name."),`&${S};`)}let _=NaN;return S[1]==="x"&&/^#x[0-9a-f]+$/i.test(S)?_=parseInt(S.slice(2),16):/^#[0-9]+$/.test(S)&&(_=parseInt(S.slice(1),10)),this.isChar(_)?String.fromCodePoint(_):(this.fail("malformed character entity."),`&${S};`)}}},{"xmlchars/xml/1.0/ed5":543,"xmlchars/xml/1.1/ed2":544,"xmlchars/xmlns/1.0/ed3":545}],497:[function(r,n,i){var s=r("safe-buffer").Buffer;function o(a,l){this._block=s.alloc(a),this._finalSize=l,this._blockSize=a,this._len=0}o.prototype.update=function(a,l){typeof a=="string"&&(l=l||"utf8",a=s.from(a,l));for(var c=this._block,u=this._blockSize,h=a.length,d=this._len,f=0;f<h;){for(var m=d%u,v=Math.min(h-f,u-m),g=0;g<v;g++)c[m+g]=a[f+g];f+=v,(d+=v)%u==0&&this._update(c)}return this._len+=h,this},o.prototype.digest=function(a){var l=this._len%this._blockSize;this._block[l]=128,this._block.fill(0,l+1),l>=this._finalSize&&(this._update(this._block),this._block.fill(0));var c=8*this._len;if(c<=4294967295)this._block.writeUInt32BE(c,this._blockSize-4);else{var u=(4294967295&c)>>>0,h=(c-u)/4294967296;this._block.writeUInt32BE(h,this._blockSize-8),this._block.writeUInt32BE(u,this._blockSize-4)}this._update(this._block);var d=this._hash();return a?d.toString(a):d},o.prototype._update=function(){throw new Error("_update must be implemented by subclass")},n.exports=o},{"safe-buffer":494}],498:[function(r,n,i){var s=n.exports=function(o){o=o.toLowerCase();var a=s[o];if(!a)throw new Error(o+" is not supported (we accept pull requests)");return new a};s.sha=r("./sha"),s.sha1=r("./sha1"),s.sha224=r("./sha224"),s.sha256=r("./sha256"),s.sha384=r("./sha384"),s.sha512=r("./sha512")},{"./sha":499,"./sha1":500,"./sha224":501,"./sha256":502,"./sha384":503,"./sha512":504}],499:[function(r,n,i){var s=r("inherits"),o=r("./hash"),a=r("safe-buffer").Buffer,l=[1518500249,1859775393,-1894007588,-899497514],c=new Array(80);function u(){this.init(),this._w=c,o.call(this,64,56)}function h(f){return f<<30|f>>>2}function d(f,m,v,g){return f===0?m&v|~m&g:f===2?m&v|m&g|v&g:m^v^g}s(u,o),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(f){for(var m,v=this._w,g=0|this._a,w=0|this._b,y=0|this._c,C=0|this._d,k=0|this._e,F=0;F<16;++F)v[F]=f.readInt32BE(4*F);for(;F<80;++F)v[F]=v[F-3]^v[F-8]^v[F-14]^v[F-16];for(var I=0;I<80;++I){var N=~~(I/20),j=0|((m=g)<<5|m>>>27)+d(N,w,y,C)+k+v[I]+l[N];k=C,C=y,y=h(w),w=g,g=j}this._a=g+this._a|0,this._b=w+this._b|0,this._c=y+this._c|0,this._d=C+this._d|0,this._e=k+this._e|0},u.prototype._hash=function(){var f=a.allocUnsafe(20);return f.writeInt32BE(0|this._a,0),f.writeInt32BE(0|this._b,4),f.writeInt32BE(0|this._c,8),f.writeInt32BE(0|this._d,12),f.writeInt32BE(0|this._e,16),f},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],500:[function(r,n,i){var s=r("inherits"),o=r("./hash"),a=r("safe-buffer").Buffer,l=[1518500249,1859775393,-1894007588,-899497514],c=new Array(80);function u(){this.init(),this._w=c,o.call(this,64,56)}function h(m){return m<<5|m>>>27}function d(m){return m<<30|m>>>2}function f(m,v,g,w){return m===0?v&g|~v&w:m===2?v&g|v&w|g&w:v^g^w}s(u,o),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(m){for(var v,g=this._w,w=0|this._a,y=0|this._b,C=0|this._c,k=0|this._d,F=0|this._e,I=0;I<16;++I)g[I]=m.readInt32BE(4*I);for(;I<80;++I)g[I]=(v=g[I-3]^g[I-8]^g[I-14]^g[I-16])<<1|v>>>31;for(var N=0;N<80;++N){var j=~~(N/20),L=h(w)+f(j,y,C,k)+F+g[N]+l[j]|0;F=k,k=C,C=d(y),y=w,w=L}this._a=w+this._a|0,this._b=y+this._b|0,this._c=C+this._c|0,this._d=k+this._d|0,this._e=F+this._e|0},u.prototype._hash=function(){var m=a.allocUnsafe(20);return m.writeInt32BE(0|this._a,0),m.writeInt32BE(0|this._b,4),m.writeInt32BE(0|this._c,8),m.writeInt32BE(0|this._d,12),m.writeInt32BE(0|this._e,16),m},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],501:[function(r,n,i){var s=r("inherits"),o=r("./sha256"),a=r("./hash"),l=r("safe-buffer").Buffer,c=new Array(64);function u(){this.init(),this._w=c,a.call(this,64,56)}s(u,o),u.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},u.prototype._hash=function(){var h=l.allocUnsafe(28);return h.writeInt32BE(this._a,0),h.writeInt32BE(this._b,4),h.writeInt32BE(this._c,8),h.writeInt32BE(this._d,12),h.writeInt32BE(this._e,16),h.writeInt32BE(this._f,20),h.writeInt32BE(this._g,24),h},n.exports=u},{"./hash":497,"./sha256":502,inherits:440,"safe-buffer":494}],502:[function(r,n,i){var s=r("inherits"),o=r("./hash"),a=r("safe-buffer").Buffer,l=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],c=new Array(64);function u(){this.init(),this._w=c,o.call(this,64,56)}function h(g,w,y){return y^g&(w^y)}function d(g,w,y){return g&w|y&(g|w)}function f(g){return(g>>>2|g<<30)^(g>>>13|g<<19)^(g>>>22|g<<10)}function m(g){return(g>>>6|g<<26)^(g>>>11|g<<21)^(g>>>25|g<<7)}function v(g){return(g>>>7|g<<25)^(g>>>18|g<<14)^g>>>3}s(u,o),u.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},u.prototype._update=function(g){for(var w,y=this._w,C=0|this._a,k=0|this._b,F=0|this._c,I=0|this._d,N=0|this._e,j=0|this._f,L=0|this._g,W=0|this._h,K=0;K<16;++K)y[K]=g.readInt32BE(4*K);for(;K<64;++K)y[K]=0|(((w=y[K-2])>>>17|w<<15)^(w>>>19|w<<13)^w>>>10)+y[K-7]+v(y[K-15])+y[K-16];for(var z=0;z<64;++z){var M=W+m(N)+h(N,j,L)+l[z]+y[z]|0,B=f(C)+d(C,k,F)|0;W=L,L=j,j=N,N=I+M|0,I=F,F=k,k=C,C=M+B|0}this._a=C+this._a|0,this._b=k+this._b|0,this._c=F+this._c|0,this._d=I+this._d|0,this._e=N+this._e|0,this._f=j+this._f|0,this._g=L+this._g|0,this._h=W+this._h|0},u.prototype._hash=function(){var g=a.allocUnsafe(32);return g.writeInt32BE(this._a,0),g.writeInt32BE(this._b,4),g.writeInt32BE(this._c,8),g.writeInt32BE(this._d,12),g.writeInt32BE(this._e,16),g.writeInt32BE(this._f,20),g.writeInt32BE(this._g,24),g.writeInt32BE(this._h,28),g},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],503:[function(r,n,i){var s=r("inherits"),o=r("./sha512"),a=r("./hash"),l=r("safe-buffer").Buffer,c=new Array(160);function u(){this.init(),this._w=c,a.call(this,128,112)}s(u,o),u.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},u.prototype._hash=function(){var h=l.allocUnsafe(48);function d(f,m,v){h.writeInt32BE(f,v),h.writeInt32BE(m,v+4)}return d(this._ah,this._al,0),d(this._bh,this._bl,8),d(this._ch,this._cl,16),d(this._dh,this._dl,24),d(this._eh,this._el,32),d(this._fh,this._fl,40),h},n.exports=u},{"./hash":497,"./sha512":504,inherits:440,"safe-buffer":494}],504:[function(r,n,i){var s=r("inherits"),o=r("./hash"),a=r("safe-buffer").Buffer,l=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],c=new Array(160);function u(){this.init(),this._w=c,o.call(this,128,112)}function h(k,F,I){return I^k&(F^I)}function d(k,F,I){return k&F|I&(k|F)}function f(k,F){return(k>>>28|F<<4)^(F>>>2|k<<30)^(F>>>7|k<<25)}function m(k,F){return(k>>>14|F<<18)^(k>>>18|F<<14)^(F>>>9|k<<23)}function v(k,F){return(k>>>1|F<<31)^(k>>>8|F<<24)^k>>>7}function g(k,F){return(k>>>1|F<<31)^(k>>>8|F<<24)^(k>>>7|F<<25)}function w(k,F){return(k>>>19|F<<13)^(F>>>29|k<<3)^k>>>6}function y(k,F){return(k>>>19|F<<13)^(F>>>29|k<<3)^(k>>>6|F<<26)}function C(k,F){return k>>>0<F>>>0?1:0}s(u,o),u.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},u.prototype._update=function(k){for(var F=this._w,I=0|this._ah,N=0|this._bh,j=0|this._ch,L=0|this._dh,W=0|this._eh,K=0|this._fh,z=0|this._gh,M=0|this._hh,B=0|this._al,R=0|this._bl,S=0|this._cl,_=0|this._dl,T=0|this._el,E=0|this._fl,D=0|this._gl,O=0|this._hl,P=0;P<32;P+=2)F[P]=k.readInt32BE(4*P),F[P+1]=k.readInt32BE(4*P+4);for(;P<160;P+=2){var q=F[P-30],X=F[P-30+1],Q=v(q,X),G=g(X,q),ee=w(q=F[P-4],X=F[P-4+1]),V=y(X,q),H=F[P-14],Z=F[P-14+1],ie=F[P-32],te=F[P-32+1],oe=G+Z|0,ue=Q+H+C(oe,G)|0;ue=(ue=ue+ee+C(oe=oe+V|0,V)|0)+ie+C(oe=oe+te|0,te)|0,F[P]=ue,F[P+1]=oe}for(var Ce=0;Ce<160;Ce+=2){ue=F[Ce],oe=F[Ce+1];var ye=d(I,N,j),ne=d(B,R,S),me=f(I,B),ve=f(B,I),Te=m(W,T),xe=m(T,W),Fe=l[Ce],Ge=l[Ce+1],Ve=h(W,K,z),Ye=h(T,E,D),ut=O+xe|0,ht=M+Te+C(ut,O)|0;ht=(ht=(ht=ht+Ve+C(ut=ut+Ye|0,Ye)|0)+Fe+C(ut=ut+Ge|0,Ge)|0)+ue+C(ut=ut+oe|0,oe)|0;var be=ve+ne|0,ze=me+ye+C(be,ve)|0;M=z,O=D,z=K,D=E,K=W,E=T,W=L+ht+C(T=_+ut|0,_)|0,L=j,_=S,j=N,S=R,N=I,R=B,I=ht+ze+C(B=ut+be|0,ut)|0}this._al=this._al+B|0,this._bl=this._bl+R|0,this._cl=this._cl+S|0,this._dl=this._dl+_|0,this._el=this._el+T|0,this._fl=this._fl+E|0,this._gl=this._gl+D|0,this._hl=this._hl+O|0,this._ah=this._ah+I+C(this._al,B)|0,this._bh=this._bh+N+C(this._bl,R)|0,this._ch=this._ch+j+C(this._cl,S)|0,this._dh=this._dh+L+C(this._dl,_)|0,this._eh=this._eh+W+C(this._el,T)|0,this._fh=this._fh+K+C(this._fl,E)|0,this._gh=this._gh+z+C(this._gl,D)|0,this._hh=this._hh+M+C(this._hl,O)|0},u.prototype._hash=function(){var k=a.allocUnsafe(64);function F(I,N,j){k.writeInt32BE(I,j),k.writeInt32BE(N,j+4)}return F(this._ah,this._al,0),F(this._bh,this._bl,8),F(this._ch,this._cl,16),F(this._dh,this._dl,24),F(this._eh,this._el,32),F(this._fh,this._fl,40),F(this._gh,this._gl,48),F(this._hh,this._hl,56),k},n.exports=u},{"./hash":497,inherits:440,"safe-buffer":494}],505:[function(r,n,i){n.exports=o;var s=r("events").EventEmitter;function o(){s.call(this)}r("inherits")(o,s),o.Readable=r("readable-stream/readable.js"),o.Writable=r("readable-stream/writable.js"),o.Duplex=r("readable-stream/duplex.js"),o.Transform=r("readable-stream/transform.js"),o.PassThrough=r("readable-stream/passthrough.js"),o.Stream=o,o.prototype.pipe=function(a,l){var c=this;function u(w){a.writable&&a.write(w)===!1&&c.pause&&c.pause()}function h(){c.readable&&c.resume&&c.resume()}c.on("data",u),a.on("drain",h),a._isStdio||l&&l.end===!1||(c.on("end",f),c.on("close",m));var d=!1;function f(){d||(d=!0,a.end())}function m(){d||(d=!0,typeof a.destroy=="function"&&a.destroy())}function v(w){if(g(),s.listenerCount(this,"error")===0)throw w}function g(){c.removeListener("data",u),a.removeListener("drain",h),c.removeListener("end",f),c.removeListener("close",m),c.removeListener("error",v),a.removeListener("error",v),c.removeListener("end",g),c.removeListener("close",g),a.removeListener("close",g)}return c.on("error",v),a.on("error",v),c.on("end",g),c.on("close",g),a.on("close",g),a.emit("pipe",c),a}},{events:422,inherits:440,"readable-stream/duplex.js":507,"readable-stream/passthrough.js":516,"readable-stream/readable.js":517,"readable-stream/transform.js":518,"readable-stream/writable.js":519}],506:[function(r,n,i){var s={}.toString;n.exports=Array.isArray||function(o){return s.call(o)=="[object Array]"}},{}],507:[function(r,n,i){n.exports=r("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":508}],508:[function(r,n,i){var s=r("process-nextick-args"),o=Object.keys||function(g){var w=[];for(var y in g)w.push(y);return w};n.exports=f;var a=Object.create(r("core-util-is"));a.inherits=r("inherits");var l=r("./_stream_readable"),c=r("./_stream_writable");a.inherits(f,l);for(var u=o(c.prototype),h=0;h<u.length;h++){var d=u[h];f.prototype[d]||(f.prototype[d]=c.prototype[d])}function f(g){if(!(this instanceof f))return new f(g);l.call(this,g),c.call(this,g),g&&g.readable===!1&&(this.readable=!1),g&&g.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,g&&g.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",m)}function m(){this.allowHalfOpen||this._writableState.ended||s.nextTick(v,this)}function v(g){g.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._writableState!==void 0&&this._readableState.destroyed&&this._writableState.destroyed},set:function(g){this._readableState!==void 0&&this._writableState!==void 0&&(this._readableState.destroyed=g,this._writableState.destroyed=g)}}),f.prototype._destroy=function(g,w){this.push(null),this.end(),s.nextTick(w,g)}},{"./_stream_readable":510,"./_stream_writable":512,"core-util-is":383,inherits:440,"process-nextick-args":466}],509:[function(r,n,i){n.exports=a;var s=r("./_stream_transform"),o=Object.create(r("core-util-is"));function a(l){if(!(this instanceof a))return new a(l);s.call(this,l)}o.inherits=r("inherits"),o.inherits(a,s),a.prototype._transform=function(l,c,u){u(null,l)}},{"./_stream_transform":511,"core-util-is":383,inherits:440}],510:[function(r,n,i){(function(s,o){(function(){var a=r("process-nextick-args");n.exports=I;var l,c=r("isarray");I.ReadableState=F,r("events").EventEmitter;var u=function(O,P){return O.listeners(P).length},h=r("./internal/streams/stream"),d=r("safe-buffer").Buffer,f=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},m=Object.create(r("core-util-is"));m.inherits=r("inherits");var v=r("util"),g=void 0;g=v&&v.debuglog?v.debuglog("stream"):function(){};var w,y=r("./internal/streams/BufferList"),C=r("./internal/streams/destroy");m.inherits(I,h);var k=["error","close","destroy","pause","resume"];function F(O,P){O=O||{};var q=P instanceof(l=l||r("./_stream_duplex"));this.objectMode=!!O.objectMode,q&&(this.objectMode=this.objectMode||!!O.readableObjectMode);var X=O.highWaterMark,Q=O.readableHighWaterMark,G=this.objectMode?16:16384;this.highWaterMark=X||X===0?X:q&&(Q||Q===0)?Q:G,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=O.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,O.encoding&&(w||(w=r("string_decoder/").StringDecoder),this.decoder=new w(O.encoding),this.encoding=O.encoding)}function I(O){if(l=l||r("./_stream_duplex"),!(this instanceof I))return new I(O);this._readableState=new F(O,this),this.readable=!0,O&&(typeof O.read=="function"&&(this._read=O.read),typeof O.destroy=="function"&&(this._destroy=O.destroy)),h.call(this)}function N(O,P,q,X,Q){var G,ee=O._readableState;return P===null?(ee.reading=!1,(function(V,H){if(!H.ended){if(H.decoder){var Z=H.decoder.end();Z&&Z.length&&(H.buffer.push(Z),H.length+=H.objectMode?1:Z.length)}H.ended=!0,W(V)}})(O,ee)):(Q||(G=(function(V,H){var Z;ie=H,d.isBuffer(ie)||ie instanceof f||typeof H=="string"||H===void 0||V.objectMode||(Z=new TypeError("Invalid non-string/buffer chunk"));var ie;return Z})(ee,P)),G?O.emit("error",G):ee.objectMode||P&&P.length>0?(typeof P=="string"||ee.objectMode||Object.getPrototypeOf(P)===d.prototype||(P=(function(V){return d.from(V)})(P)),X?ee.endEmitted?O.emit("error",new Error("stream.unshift() after end event")):j(O,ee,P,!0):ee.ended?O.emit("error",new Error("stream.push() after EOF")):(ee.reading=!1,ee.decoder&&!q?(P=ee.decoder.write(P),ee.objectMode||P.length!==0?j(O,ee,P,!1):z(O,ee)):j(O,ee,P,!1))):X||(ee.reading=!1)),(function(V){return!V.ended&&(V.needReadable||V.length<V.highWaterMark||V.length===0)})(ee)}function j(O,P,q,X){P.flowing&&P.length===0&&!P.sync?(O.emit("data",q),O.read(0)):(P.length+=P.objectMode?1:q.length,X?P.buffer.unshift(q):P.buffer.push(q),P.needReadable&&W(O)),z(O,P)}Object.defineProperty(I.prototype,"destroyed",{get:function(){return this._readableState!==void 0&&this._readableState.destroyed},set:function(O){this._readableState&&(this._readableState.destroyed=O)}}),I.prototype.destroy=C.destroy,I.prototype._undestroy=C.undestroy,I.prototype._destroy=function(O,P){this.push(null),P(O)},I.prototype.push=function(O,P){var q,X=this._readableState;return X.objectMode?q=!0:typeof O=="string"&&((P=P||X.defaultEncoding)!==X.encoding&&(O=d.from(O,P),P=""),q=!0),N(this,O,P,!1,q)},I.prototype.unshift=function(O){return N(this,O,null,!0,!1)},I.prototype.isPaused=function(){return this._readableState.flowing===!1},I.prototype.setEncoding=function(O){return w||(w=r("string_decoder/").StringDecoder),this._readableState.decoder=new w(O),this._readableState.encoding=O,this};function L(O,P){return O<=0||P.length===0&&P.ended?0:P.objectMode?1:O!=O?P.flowing&&P.length?P.buffer.head.data.length:P.length:(O>P.highWaterMark&&(P.highWaterMark=(function(q){return q>=8388608?q=8388608:(q--,q|=q>>>1,q|=q>>>2,q|=q>>>4,q|=q>>>8,q|=q>>>16,q++),q})(O)),O<=P.length?O:P.ended?P.length:(P.needReadable=!0,0))}function W(O){var P=O._readableState;P.needReadable=!1,P.emittedReadable||(g("emitReadable",P.flowing),P.emittedReadable=!0,P.sync?a.nextTick(K,O):K(O))}function K(O){g("emit readable"),O.emit("readable"),S(O)}function z(O,P){P.readingMore||(P.readingMore=!0,a.nextTick(M,O,P))}function M(O,P){for(var q=P.length;!P.reading&&!P.flowing&&!P.ended&&P.length<P.highWaterMark&&(g("maybeReadMore read 0"),O.read(0),q!==P.length);)q=P.length;P.readingMore=!1}function B(O){g("readable nexttick read 0"),O.read(0)}function R(O,P){P.reading||(g("resume read 0"),O.read(0)),P.resumeScheduled=!1,P.awaitDrain=0,O.emit("resume"),S(O),P.flowing&&!P.reading&&O.read(0)}function S(O){var P=O._readableState;for(g("flow",P.flowing);P.flowing&&O.read()!==null;);}function _(O,P){return P.length===0?null:(P.objectMode?q=P.buffer.shift():!O||O>=P.length?(q=P.decoder?P.buffer.join(""):P.buffer.length===1?P.buffer.head.data:P.buffer.concat(P.length),P.buffer.clear()):q=(function(X,Q,G){var ee;return X<Q.head.data.length?(ee=Q.head.data.slice(0,X),Q.head.data=Q.head.data.slice(X)):ee=X===Q.head.data.length?Q.shift():G?(function(V,H){var Z=H.head,ie=1,te=Z.data;for(V-=te.length;Z=Z.next;){var oe=Z.data,ue=V>oe.length?oe.length:V;if(ue===oe.length?te+=oe:te+=oe.slice(0,V),(V-=ue)===0){ue===oe.length?(++ie,Z.next?H.head=Z.next:H.head=H.tail=null):(H.head=Z,Z.data=oe.slice(ue));break}++ie}return H.length-=ie,te})(X,Q):(function(V,H){var Z=d.allocUnsafe(V),ie=H.head,te=1;for(ie.data.copy(Z),V-=ie.data.length;ie=ie.next;){var oe=ie.data,ue=V>oe.length?oe.length:V;if(oe.copy(Z,Z.length-V,0,ue),(V-=ue)===0){ue===oe.length?(++te,ie.next?H.head=ie.next:H.head=H.tail=null):(H.head=ie,ie.data=oe.slice(ue));break}++te}return H.length-=te,Z})(X,Q),ee})(O,P.buffer,P.decoder),q);var q}function T(O){var P=O._readableState;if(P.length>0)throw new Error('"endReadable()" called on non-empty stream');P.endEmitted||(P.ended=!0,a.nextTick(E,P,O))}function E(O,P){O.endEmitted||O.length!==0||(O.endEmitted=!0,P.readable=!1,P.emit("end"))}function D(O,P){for(var q=0,X=O.length;q<X;q++)if(O[q]===P)return q;return-1}I.prototype.read=function(O){g("read",O),O=parseInt(O,10);var P=this._readableState,q=O;if(O!==0&&(P.emittedReadable=!1),O===0&&P.needReadable&&(P.length>=P.highWaterMark||P.ended))return g("read: emitReadable",P.length,P.ended),P.length===0&&P.ended?T(this):W(this),null;if((O=L(O,P))===0&&P.ended)return P.length===0&&T(this),null;var X,Q=P.needReadable;return g("need readable",Q),(P.length===0||P.length-O<P.highWaterMark)&&g("length less than watermark",Q=!0),P.ended||P.reading?g("reading or ended",Q=!1):Q&&(g("do read"),P.reading=!0,P.sync=!0,P.length===0&&(P.needReadable=!0),this._read(P.highWaterMark),P.sync=!1,P.reading||(O=L(q,P))),(X=O>0?_(O,P):null)===null?(P.needReadable=!0,O=0):P.length-=O,P.length===0&&(P.ended||(P.needReadable=!0),q!==O&&P.ended&&T(this)),X!==null&&this.emit("data",X),X},I.prototype._read=function(O){this.emit("error",new Error("_read() is not implemented"))},I.prototype.pipe=function(O,P){var q=this,X=this._readableState;switch(X.pipesCount){case 0:X.pipes=O;break;case 1:X.pipes=[X.pipes,O];break;default:X.pipes.push(O)}X.pipesCount+=1,g("pipe count=%d opts=%j",X.pipesCount,P);var Q=(!P||P.end!==!1)&&O!==s.stdout&&O!==s.stderr?ee:Ce;function G(ye,ne){g("onunpipe"),ye===q&&ne&&ne.hasUnpiped===!1&&(ne.hasUnpiped=!0,g("cleanup"),O.removeListener("close",oe),O.removeListener("finish",ue),O.removeListener("drain",V),O.removeListener("error",te),O.removeListener("unpipe",G),q.removeListener("end",ee),q.removeListener("end",Ce),q.removeListener("data",ie),H=!0,!X.awaitDrain||O._writableState&&!O._writableState.needDrain||V())}function ee(){g("onend"),O.end()}X.endEmitted?a.nextTick(Q):q.once("end",Q),O.on("unpipe",G);var V=(function(ye){return function(){var ne=ye._readableState;g("pipeOnDrain",ne.awaitDrain),ne.awaitDrain&&ne.awaitDrain--,ne.awaitDrain===0&&u(ye,"data")&&(ne.flowing=!0,S(ye))}})(q);O.on("drain",V);var H=!1,Z=!1;function ie(ye){g("ondata"),Z=!1,O.write(ye)!==!1||Z||((X.pipesCount===1&&X.pipes===O||X.pipesCount>1&&D(X.pipes,O)!==-1)&&!H&&(g("false write response, pause",X.awaitDrain),X.awaitDrain++,Z=!0),q.pause())}function te(ye){g("onerror",ye),Ce(),O.removeListener("error",te),u(O,"error")===0&&O.emit("error",ye)}function oe(){O.removeListener("finish",ue),Ce()}function ue(){g("onfinish"),O.removeListener("close",oe),Ce()}function Ce(){g("unpipe"),q.unpipe(O)}return q.on("data",ie),(function(ye,ne,me){if(typeof ye.prependListener=="function")return ye.prependListener(ne,me);ye._events&&ye._events[ne]?c(ye._events[ne])?ye._events[ne].unshift(me):ye._events[ne]=[me,ye._events[ne]]:ye.on(ne,me)})(O,"error",te),O.once("close",oe),O.once("finish",ue),O.emit("pipe",q),X.flowing||(g("pipe resume"),q.resume()),O},I.prototype.unpipe=function(O){var P=this._readableState,q={hasUnpiped:!1};if(P.pipesCount===0)return this;if(P.pipesCount===1)return O&&O!==P.pipes||(O||(O=P.pipes),P.pipes=null,P.pipesCount=0,P.flowing=!1,O&&O.emit("unpipe",this,q)),this;if(!O){var X=P.pipes,Q=P.pipesCount;P.pipes=null,P.pipesCount=0,P.flowing=!1;for(var G=0;G<Q;G++)X[G].emit("unpipe",this,{hasUnpiped:!1});return this}var ee=D(P.pipes,O);return ee===-1||(P.pipes.splice(ee,1),P.pipesCount-=1,P.pipesCount===1&&(P.pipes=P.pipes[0]),O.emit("unpipe",this,q)),this},I.prototype.on=function(O,P){var q=h.prototype.on.call(this,O,P);if(O==="data")this._readableState.flowing!==!1&&this.resume();else if(O==="readable"){var X=this._readableState;X.endEmitted||X.readableListening||(X.readableListening=X.needReadable=!0,X.emittedReadable=!1,X.reading?X.length&&W(this):a.nextTick(B,this))}return q},I.prototype.addListener=I.prototype.on,I.prototype.resume=function(){var O=this._readableState;return O.flowing||(g("resume"),O.flowing=!0,(function(P,q){q.resumeScheduled||(q.resumeScheduled=!0,a.nextTick(R,P,q))})(this,O)),this},I.prototype.pause=function(){return g("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(g("pause"),this._readableState.flowing=!1,this.emit("pause")),this},I.prototype.wrap=function(O){var P=this,q=this._readableState,X=!1;for(var Q in O.on("end",(function(){if(g("wrapped end"),q.decoder&&!q.ended){var ee=q.decoder.end();ee&&ee.length&&P.push(ee)}P.push(null)})),O.on("data",(function(ee){g("wrapped data"),q.decoder&&(ee=q.decoder.write(ee)),q.objectMode&&ee==null||(q.objectMode||ee&&ee.length)&&(P.push(ee)||(X=!0,O.pause()))})),O)this[Q]===void 0&&typeof O[Q]=="function"&&(this[Q]=(function(ee){return function(){return O[ee].apply(O,arguments)}})(Q));for(var G=0;G<k.length;G++)O.on(k[G],this.emit.bind(this,k[G]));return this._read=function(ee){g("wrapped _read",ee),X&&(X=!1,O.resume())},this},Object.defineProperty(I.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),I._fromList=_}).call(this)}).call(this,r("_process"),typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{"./_stream_duplex":508,"./internal/streams/BufferList":513,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,events:422,inherits:440,isarray:506,"process-nextick-args":466,"safe-buffer":520,"string_decoder/":521,util:188}],511:[function(r,n,i){n.exports=l;var s=r("./_stream_duplex"),o=Object.create(r("core-util-is"));function a(h,d){var f=this._transformState;f.transforming=!1;var m=f.writecb;if(!m)return this.emit("error",new Error("write callback called multiple times"));f.writechunk=null,f.writecb=null,d!=null&&this.push(d),m(h);var v=this._readableState;v.reading=!1,(v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}function l(h){if(!(this instanceof l))return new l(h);s.call(this,h),this._transformState={afterTransform:a.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,h&&(typeof h.transform=="function"&&(this._transform=h.transform),typeof h.flush=="function"&&(this._flush=h.flush)),this.on("prefinish",c)}function c(){var h=this;typeof this._flush=="function"?this._flush((function(d,f){u(h,d,f)})):u(this,null,null)}function u(h,d,f){if(d)return h.emit("error",d);if(f!=null&&h.push(f),h._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(h._transformState.transforming)throw new Error("Calling transform done when still transforming");return h.push(null)}o.inherits=r("inherits"),o.inherits(l,s),l.prototype.push=function(h,d){return this._transformState.needTransform=!1,s.prototype.push.call(this,h,d)},l.prototype._transform=function(h,d,f){throw new Error("_transform() is not implemented")},l.prototype._write=function(h,d,f){var m=this._transformState;if(m.writecb=f,m.writechunk=h,m.writeencoding=d,!m.transforming){var v=this._readableState;(m.needTransform||v.needReadable||v.length<v.highWaterMark)&&this._read(v.highWaterMark)}},l.prototype._read=function(h){var d=this._transformState;d.writechunk!==null&&d.writecb&&!d.transforming?(d.transforming=!0,this._transform(d.writechunk,d.writeencoding,d.afterTransform)):d.needTransform=!0},l.prototype._destroy=function(h,d){var f=this;s.prototype._destroy.call(this,h,(function(m){d(m),f.emit("close")}))}},{"./_stream_duplex":508,"core-util-is":383,inherits:440}],512:[function(r,n,i){(function(s,o,a){(function(){var l=r("process-nextick-args");function c(z){var M=this;this.next=null,this.entry=null,this.finish=function(){(function(B,R,S){var _=B.entry;for(B.entry=null;_;){var T=_.callback;R.pendingcb--,T(S),_=_.next}R.corkedRequestsFree.next=B})(M,z)}}n.exports=F;var u,h=!s.browser&&["v0.10","v0.9."].indexOf(s.version.slice(0,5))>-1?a:l.nextTick;F.WritableState=k;var d=Object.create(r("core-util-is"));d.inherits=r("inherits");var f={deprecate:r("util-deprecate")},m=r("./internal/streams/stream"),v=r("safe-buffer").Buffer,g=(o!==void 0?o:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){},w,y=r("./internal/streams/destroy");function C(){}function k(z,M){u=u||r("./_stream_duplex"),z=z||{};var B=M instanceof u;this.objectMode=!!z.objectMode,B&&(this.objectMode=this.objectMode||!!z.writableObjectMode);var R=z.highWaterMark,S=z.writableHighWaterMark,_=this.objectMode?16:16384;this.highWaterMark=R||R===0?R:B&&(S||S===0)?S:_,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var T=z.decodeStrings===!1;this.decodeStrings=!T,this.defaultEncoding=z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(E){(function(D,O){var P=D._writableState,q=P.sync,X=P.writecb;if((function(G){G.writing=!1,G.writecb=null,G.length-=G.writelen,G.writelen=0})(P),O)(function(G,ee,V,H,Z){--ee.pendingcb,V?(l.nextTick(Z,H),l.nextTick(K,G,ee),G._writableState.errorEmitted=!0,G.emit("error",H)):(Z(H),G._writableState.errorEmitted=!0,G.emit("error",H),K(G,ee))})(D,P,q,O,X);else{var Q=L(P);Q||P.corked||P.bufferProcessing||!P.bufferedRequest||j(D,P),q?h(N,D,P,Q,X):N(D,P,Q,X)}})(M,E)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new c(this)}function F(z){if(u=u||r("./_stream_duplex"),!(w.call(F,this)||this instanceof u))return new F(z);this._writableState=new k(z,this),this.writable=!0,z&&(typeof z.write=="function"&&(this._write=z.write),typeof z.writev=="function"&&(this._writev=z.writev),typeof z.destroy=="function"&&(this._destroy=z.destroy),typeof z.final=="function"&&(this._final=z.final)),m.call(this)}function I(z,M,B,R,S,_,T){M.writelen=R,M.writecb=T,M.writing=!0,M.sync=!0,B?z._writev(S,M.onwrite):z._write(S,_,M.onwrite),M.sync=!1}function N(z,M,B,R){B||(function(S,_){_.length===0&&_.needDrain&&(_.needDrain=!1,S.emit("drain"))})(z,M),M.pendingcb--,R(),K(z,M)}function j(z,M){M.bufferProcessing=!0;var B=M.bufferedRequest;if(z._writev&&B&&B.next){var R=M.bufferedRequestCount,S=new Array(R),_=M.corkedRequestsFree;_.entry=B;for(var T=0,E=!0;B;)S[T]=B,B.isBuf||(E=!1),B=B.next,T+=1;S.allBuffers=E,I(z,M,!0,M.length,S,"",_.finish),M.pendingcb++,M.lastBufferedRequest=null,_.next?(M.corkedRequestsFree=_.next,_.next=null):M.corkedRequestsFree=new c(M),M.bufferedRequestCount=0}else{for(;B;){var D=B.chunk,O=B.encoding,P=B.callback;if(I(z,M,!1,M.objectMode?1:D.length,D,O,P),B=B.next,M.bufferedRequestCount--,M.writing)break}B===null&&(M.lastBufferedRequest=null)}M.bufferedRequest=B,M.bufferProcessing=!1}function L(z){return z.ending&&z.length===0&&z.bufferedRequest===null&&!z.finished&&!z.writing}function W(z,M){z._final((function(B){M.pendingcb--,B&&z.emit("error",B),M.prefinished=!0,z.emit("prefinish"),K(z,M)}))}function K(z,M){var B=L(M);return B&&((function(R,S){S.prefinished||S.finalCalled||(typeof R._final=="function"?(S.pendingcb++,S.finalCalled=!0,l.nextTick(W,R,S)):(S.prefinished=!0,R.emit("prefinish")))})(z,M),M.pendingcb===0&&(M.finished=!0,z.emit("finish"))),B}d.inherits(F,m),k.prototype.getBuffer=function(){for(var z=this.bufferedRequest,M=[];z;)M.push(z),z=z.next;return M},(function(){try{Object.defineProperty(k.prototype,"buffer",{get:f.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})(),typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(w=Function.prototype[Symbol.hasInstance],Object.defineProperty(F,Symbol.hasInstance,{value:function(z){return!!w.call(this,z)||this===F&&z&&z._writableState instanceof k}})):w=function(z){return z instanceof this},F.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},F.prototype.write=function(z,M,B){var R,S=this._writableState,_=!1,T=!S.objectMode&&(R=z,v.isBuffer(R)||R instanceof g);return T&&!v.isBuffer(z)&&(z=(function(E){return v.from(E)})(z)),typeof M=="function"&&(B=M,M=null),T?M="buffer":M||(M=S.defaultEncoding),typeof B!="function"&&(B=C),S.ended?(function(E,D){var O=new Error("write after end");E.emit("error",O),l.nextTick(D,O)})(this,B):(T||(function(E,D,O,P){var q=!0,X=!1;return O===null?X=new TypeError("May not write null values to stream"):typeof O=="string"||O===void 0||D.objectMode||(X=new TypeError("Invalid non-string/buffer chunk")),X&&(E.emit("error",X),l.nextTick(P,X),q=!1),q})(this,S,z,B))&&(S.pendingcb++,_=(function(E,D,O,P,q,X){if(!O){var Q=(function(H,Z,ie){return H.objectMode||H.decodeStrings===!1||typeof Z!="string"||(Z=v.from(Z,ie)),Z})(D,P,q);P!==Q&&(O=!0,q="buffer",P=Q)}var G=D.objectMode?1:P.length;D.length+=G;var ee=D.length<D.highWaterMark;if(ee||(D.needDrain=!0),D.writing||D.corked){var V=D.lastBufferedRequest;D.lastBufferedRequest={chunk:P,encoding:q,isBuf:O,callback:X,next:null},V?V.next=D.lastBufferedRequest:D.bufferedRequest=D.lastBufferedRequest,D.bufferedRequestCount+=1}else I(E,D,!1,G,P,q,X);return ee})(this,S,T,z,M,B)),_},F.prototype.cork=function(){this._writableState.corked++},F.prototype.uncork=function(){var z=this._writableState;z.corked&&(z.corked--,z.writing||z.corked||z.bufferProcessing||!z.bufferedRequest||j(this,z))},F.prototype.setDefaultEncoding=function(z){if(typeof z=="string"&&(z=z.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((z+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+z);return this._writableState.defaultEncoding=z,this},Object.defineProperty(F.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),F.prototype._write=function(z,M,B){B(new Error("_write() is not implemented"))},F.prototype._writev=null,F.prototype.end=function(z,M,B){var R=this._writableState;typeof z=="function"?(B=z,z=null,M=null):typeof M=="function"&&(B=M,M=null),z!=null&&this.write(z,M),R.corked&&(R.corked=1,this.uncork()),R.ending||(function(S,_,T){_.ending=!0,K(S,_),T&&(_.finished?l.nextTick(T):S.once("finish",T)),_.ended=!0,S.writable=!1})(this,R,B)},Object.defineProperty(F.prototype,"destroyed",{get:function(){return this._writableState!==void 0&&this._writableState.destroyed},set:function(z){this._writableState&&(this._writableState.destroyed=z)}}),F.prototype.destroy=y.destroy,F.prototype._undestroy=y.undestroy,F.prototype._destroy=function(z,M){this.end(),M(z)}}).call(this)}).call(this,r("_process"),typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{},r("timers").setImmediate)},{"./_stream_duplex":508,"./internal/streams/destroy":514,"./internal/streams/stream":515,_process:467,"core-util-is":383,inherits:440,"process-nextick-args":466,"safe-buffer":520,timers:523,"util-deprecate":524}],513:[function(r,n,i){var s=r("safe-buffer").Buffer,o=r("util");n.exports=(function(){function a(){(function(l,c){if(!(l instanceof c))throw new TypeError("Cannot call a class as a function")})(this,a),this.head=null,this.tail=null,this.length=0}return a.prototype.push=function(l){var c={data:l,next:null};this.length>0?this.tail.next=c:this.head=c,this.tail=c,++this.length},a.prototype.unshift=function(l){var c={data:l,next:this.head};this.length===0&&(this.tail=c),this.head=c,++this.length},a.prototype.shift=function(){if(this.length!==0){var l=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,l}},a.prototype.clear=function(){this.head=this.tail=null,this.length=0},a.prototype.join=function(l){if(this.length===0)return"";for(var c=this.head,u=""+c.data;c=c.next;)u+=l+c.data;return u},a.prototype.concat=function(l){if(this.length===0)return s.alloc(0);for(var c,u,h,d=s.allocUnsafe(l>>>0),f=this.head,m=0;f;)c=f.data,u=d,h=m,c.copy(u,h),m+=f.data.length,f=f.next;return d},a})(),o&&o.inspect&&o.inspect.custom&&(n.exports.prototype[o.inspect.custom]=function(){var a=o.inspect({length:this.length});return this.constructor.name+" "+a})},{"safe-buffer":520,util:188}],514:[function(r,n,i){var s=r("process-nextick-args");function o(a,l){a.emit("error",l)}n.exports={destroy:function(a,l){var c=this,u=this._readableState&&this._readableState.destroyed,h=this._writableState&&this._writableState.destroyed;return u||h?(l?l(a):a&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,s.nextTick(o,this,a)):s.nextTick(o,this,a)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(a||null,(function(d){!l&&d?c._writableState?c._writableState.errorEmitted||(c._writableState.errorEmitted=!0,s.nextTick(o,c,d)):s.nextTick(o,c,d):l&&l(d)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}},{"process-nextick-args":466}],515:[function(r,n,i){arguments[4][490][0].apply(i,arguments)},{dup:490,events:422}],516:[function(r,n,i){n.exports=r("./readable").PassThrough},{"./readable":517}],517:[function(r,n,i){(i=n.exports=r("./lib/_stream_readable.js")).Stream=i,i.Readable=i,i.Writable=r("./lib/_stream_writable.js"),i.Duplex=r("./lib/_stream_duplex.js"),i.Transform=r("./lib/_stream_transform.js"),i.PassThrough=r("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":508,"./lib/_stream_passthrough.js":509,"./lib/_stream_readable.js":510,"./lib/_stream_transform.js":511,"./lib/_stream_writable.js":512}],518:[function(r,n,i){n.exports=r("./readable").Transform},{"./readable":517}],519:[function(r,n,i){n.exports=r("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":512}],520:[function(r,n,i){arguments[4][217][0].apply(i,arguments)},{buffer:220,dup:217}],521:[function(r,n,i){arguments[4][218][0].apply(i,arguments)},{dup:218,"safe-buffer":520}],522:[function(r,n,i){arguments[4][218][0].apply(i,arguments)},{dup:218,"safe-buffer":494}],523:[function(r,n,i){(function(s,o){(function(){var a=r("process/browser.js").nextTick,l=Function.prototype.apply,c=Array.prototype.slice,u={},h=0;function d(f,m){this._id=f,this._clearFn=m}i.setTimeout=function(){return new d(l.call(setTimeout,window,arguments),clearTimeout)},i.setInterval=function(){return new d(l.call(setInterval,window,arguments),clearInterval)},i.clearTimeout=i.clearInterval=function(f){f.close()},d.prototype.unref=d.prototype.ref=function(){},d.prototype.close=function(){this._clearFn.call(window,this._id)},i.enroll=function(f,m){clearTimeout(f._idleTimeoutId),f._idleTimeout=m},i.unenroll=function(f){clearTimeout(f._idleTimeoutId),f._idleTimeout=-1},i._unrefActive=i.active=function(f){clearTimeout(f._idleTimeoutId);var m=f._idleTimeout;m>=0&&(f._idleTimeoutId=setTimeout((function(){f._onTimeout&&f._onTimeout()}),m))},i.setImmediate=typeof s=="function"?s:function(f){var m=h++,v=!(arguments.length<2)&&c.call(arguments,1);return u[m]=!0,a((function(){u[m]&&(v?f.apply(null,v):f.call(null),i.clearImmediate(m))})),m},i.clearImmediate=typeof o=="function"?o:function(f){delete u[f]}}).call(this)}).call(this,r("timers").setImmediate,r("timers").clearImmediate)},{"process/browser.js":467,timers:523}],524:[function(r,n,i){(function(s){(function(){function o(a){try{if(!s.localStorage)return!1}catch{return!1}var l=s.localStorage[a];return l!=null&&String(l).toLowerCase()==="true"}n.exports=function(a,l){if(o("noDeprecation"))return a;var c=!1;return function(){if(!c){if(o("throwDeprecation"))throw new Error(l);o("traceDeprecation")?console.trace(l):console.warn(l),c=!0}return a.apply(this,arguments)}}}).call(this)}).call(this,typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{}],525:[function(r,n,i){typeof Object.create=="function"?n.exports=function(s,o){s.super_=o,s.prototype=Object.create(o.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}})}:n.exports=function(s,o){s.super_=o;var a=function(){};a.prototype=o.prototype,s.prototype=new a,s.prototype.constructor=s}},{}],526:[function(r,n,i){n.exports=function(s){return s&&typeof s=="object"&&typeof s.copy=="function"&&typeof s.fill=="function"&&typeof s.readUInt8=="function"}},{}],527:[function(r,n,i){(function(s,o){(function(){var a=/%[sdj%]/g;i.format=function(S){if(!k(S)){for(var _=[],T=0;T<arguments.length;T++)_.push(u(arguments[T]));return _.join(" ")}T=1;for(var E=arguments,D=E.length,O=String(S).replace(a,(function(q){if(q==="%%")return"%";if(T>=D)return q;switch(q){case"%s":return String(E[T++]);case"%d":return Number(E[T++]);case"%j":try{return JSON.stringify(E[T++])}catch{return"[Circular]"}default:return q}})),P=E[T];T<D;P=E[++T])y(P)||!N(P)?O+=" "+P:O+=" "+u(P);return O},i.deprecate=function(S,_){if(F(o.process))return function(){return i.deprecate(S,_).apply(this,arguments)};if(s.noDeprecation===!0)return S;var T=!1;return function(){if(!T){if(s.throwDeprecation)throw new Error(_);s.traceDeprecation?console.trace(_):console.error(_),T=!0}return S.apply(this,arguments)}};var l,c={};function u(S,_){var T={seen:[],stylize:d};return arguments.length>=3&&(T.depth=arguments[2]),arguments.length>=4&&(T.colors=arguments[3]),w(_)?T.showHidden=_:_&&i._extend(T,_),F(T.showHidden)&&(T.showHidden=!1),F(T.depth)&&(T.depth=2),F(T.colors)&&(T.colors=!1),F(T.customInspect)&&(T.customInspect=!0),T.colors&&(T.stylize=h),f(T,S,T.depth)}function h(S,_){var T=u.styles[_];return T?"\x1B["+u.colors[T][0]+"m"+S+"\x1B["+u.colors[T][1]+"m":S}function d(S,_){return S}function f(S,_,T){if(S.customInspect&&_&&W(_.inspect)&&_.inspect!==i.inspect&&(!_.constructor||_.constructor.prototype!==_)){var E=_.inspect(T,S);return k(E)||(E=f(S,E,T)),E}var D=(function(V,H){if(F(H))return V.stylize("undefined","undefined");if(k(H)){var Z="'"+JSON.stringify(H).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return V.stylize(Z,"string")}if(C(H))return V.stylize(""+H,"number");if(w(H))return V.stylize(""+H,"boolean");if(y(H))return V.stylize("null","null")})(S,_);if(D)return D;var O=Object.keys(_),P=(function(V){var H={};return V.forEach((function(Z,ie){H[Z]=!0})),H})(O);if(S.showHidden&&(O=Object.getOwnPropertyNames(_)),L(_)&&(O.indexOf("message")>=0||O.indexOf("description")>=0))return m(_);if(O.length===0){if(W(_)){var q=_.name?": "+_.name:"";return S.stylize("[Function"+q+"]","special")}if(I(_))return S.stylize(RegExp.prototype.toString.call(_),"regexp");if(j(_))return S.stylize(Date.prototype.toString.call(_),"date");if(L(_))return m(_)}var X,Q="",G=!1,ee=["{","}"];return g(_)&&(G=!0,ee=["[","]"]),W(_)&&(Q=" [Function"+(_.name?": "+_.name:"")+"]"),I(_)&&(Q=" "+RegExp.prototype.toString.call(_)),j(_)&&(Q=" "+Date.prototype.toUTCString.call(_)),L(_)&&(Q=" "+m(_)),O.length!==0||G&&_.length!=0?T<0?I(_)?S.stylize(RegExp.prototype.toString.call(_),"regexp"):S.stylize("[Object]","special"):(S.seen.push(_),X=G?(function(V,H,Z,ie,te){for(var oe=[],ue=0,Ce=H.length;ue<Ce;++ue)R(H,String(ue))?oe.push(v(V,H,Z,ie,String(ue),!0)):oe.push("");return te.forEach((function(ye){ye.match(/^\d+$/)||oe.push(v(V,H,Z,ie,ye,!0))})),oe})(S,_,T,P,O):O.map((function(V){return v(S,_,T,P,V,G)})),S.seen.pop(),(function(V,H,Z){return V.reduce((function(ie,te){return te.indexOf(`
`)>=0,ie+te.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?Z[0]+(H===""?"":H+`
 `)+" "+V.join(`,
  `)+" "+Z[1]:Z[0]+H+" "+V.join(", ")+" "+Z[1]})(X,Q,ee)):ee[0]+Q+ee[1]}function m(S){return"["+Error.prototype.toString.call(S)+"]"}function v(S,_,T,E,D,O){var P,q,X;if((X=Object.getOwnPropertyDescriptor(_,D)||{value:_[D]}).get?q=X.set?S.stylize("[Getter/Setter]","special"):S.stylize("[Getter]","special"):X.set&&(q=S.stylize("[Setter]","special")),R(E,D)||(P="["+D+"]"),q||(S.seen.indexOf(X.value)<0?(q=y(T)?f(S,X.value,null):f(S,X.value,T-1)).indexOf(`
`)>-1&&(q=O?q.split(`
`).map((function(Q){return"  "+Q})).join(`
`).substr(2):`
`+q.split(`
`).map((function(Q){return"   "+Q})).join(`
`)):q=S.stylize("[Circular]","special")),F(P)){if(O&&D.match(/^\d+$/))return q;(P=JSON.stringify(""+D)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(P=P.substr(1,P.length-2),P=S.stylize(P,"name")):(P=P.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),P=S.stylize(P,"string"))}return P+": "+q}function g(S){return Array.isArray(S)}function w(S){return typeof S=="boolean"}function y(S){return S===null}function C(S){return typeof S=="number"}function k(S){return typeof S=="string"}function F(S){return S===void 0}function I(S){return N(S)&&K(S)==="[object RegExp]"}function N(S){return typeof S=="object"&&S!==null}function j(S){return N(S)&&K(S)==="[object Date]"}function L(S){return N(S)&&(K(S)==="[object Error]"||S instanceof Error)}function W(S){return typeof S=="function"}function K(S){return Object.prototype.toString.call(S)}function z(S){return S<10?"0"+S.toString(10):S.toString(10)}i.debuglog=function(S){if(F(l)&&(l=s.env.NODE_DEBUG||""),S=S.toUpperCase(),!c[S])if(new RegExp("\\b"+S+"\\b","i").test(l)){var _=s.pid;c[S]=function(){var T=i.format.apply(i,arguments);console.error("%s %d: %s",S,_,T)}}else c[S]=function(){};return c[S]},i.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},i.isArray=g,i.isBoolean=w,i.isNull=y,i.isNullOrUndefined=function(S){return S==null},i.isNumber=C,i.isString=k,i.isSymbol=function(S){return typeof S=="symbol"},i.isUndefined=F,i.isRegExp=I,i.isObject=N,i.isDate=j,i.isError=L,i.isFunction=W,i.isPrimitive=function(S){return S===null||typeof S=="boolean"||typeof S=="number"||typeof S=="string"||typeof S=="symbol"||S===void 0},i.isBuffer=r("./support/isBuffer");var M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function B(){var S=new Date,_=[z(S.getHours()),z(S.getMinutes()),z(S.getSeconds())].join(":");return[S.getDate(),M[S.getMonth()],_].join(" ")}function R(S,_){return Object.prototype.hasOwnProperty.call(S,_)}i.log=function(){console.log("%s - %s",B(),i.format.apply(i,arguments))},i.inherits=r("inherits"),i._extend=function(S,_){if(!_||!N(_))return S;for(var T=Object.keys(_),E=T.length;E--;)S[T[E]]=_[T[E]];return S}}).call(this)}).call(this,r("_process"),typeof ir<"u"?ir:typeof self<"u"?self:typeof window<"u"?window:{})},{"./support/isBuffer":526,_process:467,inherits:525}],528:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),Object.defineProperty(i,"v1",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(i,"v3",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(i,"v4",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(i,"v5",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(i,"NIL",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(i,"version",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(i,"validate",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(i,"stringify",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(i,"parse",{enumerable:!0,get:function(){return f.default}});var s=m(r("./v1.js")),o=m(r("./v3.js")),a=m(r("./v4.js")),l=m(r("./v5.js")),c=m(r("./nil.js")),u=m(r("./version.js")),h=m(r("./validate.js")),d=m(r("./stringify.js")),f=m(r("./parse.js"));function m(v){return v&&v.__esModule?v:{default:v}}},{"./nil.js":530,"./parse.js":531,"./stringify.js":535,"./v1.js":536,"./v3.js":537,"./v4.js":539,"./v5.js":540,"./validate.js":541,"./version.js":542}],529:[function(r,n,i){function s(f){return 14+(f+64>>>9<<4)+1}function o(f,m){const v=(65535&f)+(65535&m);return(f>>16)+(m>>16)+(v>>16)<<16|65535&v}function a(f,m,v,g,w,y){return o((C=o(o(m,f),o(g,y)))<<(k=w)|C>>>32-k,v);var C,k}function l(f,m,v,g,w,y,C){return a(m&v|~m&g,f,m,w,y,C)}function c(f,m,v,g,w,y,C){return a(m&g|v&~g,f,m,w,y,C)}function u(f,m,v,g,w,y,C){return a(m^v^g,f,m,w,y,C)}function h(f,m,v,g,w,y,C){return a(v^(m|~g),f,m,w,y,C)}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var d=function(f){if(typeof f=="string"){const m=unescape(encodeURIComponent(f));f=new Uint8Array(m.length);for(let v=0;v<m.length;++v)f[v]=m.charCodeAt(v)}return(function(m){const v=[],g=32*m.length;for(let w=0;w<g;w+=8){const y=m[w>>5]>>>w%32&255,C=parseInt("0123456789abcdef".charAt(y>>>4&15)+"0123456789abcdef".charAt(15&y),16);v.push(C)}return v})((function(m,v){m[v>>5]|=128<<v%32,m[s(v)-1]=v;let g=1732584193,w=-271733879,y=-1732584194,C=271733878;for(let k=0;k<m.length;k+=16){const F=g,I=w,N=y,j=C;g=l(g,w,y,C,m[k],7,-680876936),C=l(C,g,w,y,m[k+1],12,-389564586),y=l(y,C,g,w,m[k+2],17,606105819),w=l(w,y,C,g,m[k+3],22,-1044525330),g=l(g,w,y,C,m[k+4],7,-176418897),C=l(C,g,w,y,m[k+5],12,1200080426),y=l(y,C,g,w,m[k+6],17,-1473231341),w=l(w,y,C,g,m[k+7],22,-45705983),g=l(g,w,y,C,m[k+8],7,1770035416),C=l(C,g,w,y,m[k+9],12,-1958414417),y=l(y,C,g,w,m[k+10],17,-42063),w=l(w,y,C,g,m[k+11],22,-1990404162),g=l(g,w,y,C,m[k+12],7,1804603682),C=l(C,g,w,y,m[k+13],12,-40341101),y=l(y,C,g,w,m[k+14],17,-1502002290),w=l(w,y,C,g,m[k+15],22,1236535329),g=c(g,w,y,C,m[k+1],5,-165796510),C=c(C,g,w,y,m[k+6],9,-1069501632),y=c(y,C,g,w,m[k+11],14,643717713),w=c(w,y,C,g,m[k],20,-373897302),g=c(g,w,y,C,m[k+5],5,-701558691),C=c(C,g,w,y,m[k+10],9,38016083),y=c(y,C,g,w,m[k+15],14,-660478335),w=c(w,y,C,g,m[k+4],20,-405537848),g=c(g,w,y,C,m[k+9],5,568446438),C=c(C,g,w,y,m[k+14],9,-1019803690),y=c(y,C,g,w,m[k+3],14,-187363961),w=c(w,y,C,g,m[k+8],20,1163531501),g=c(g,w,y,C,m[k+13],5,-1444681467),C=c(C,g,w,y,m[k+2],9,-51403784),y=c(y,C,g,w,m[k+7],14,1735328473),w=c(w,y,C,g,m[k+12],20,-1926607734),g=u(g,w,y,C,m[k+5],4,-378558),C=u(C,g,w,y,m[k+8],11,-2022574463),y=u(y,C,g,w,m[k+11],16,1839030562),w=u(w,y,C,g,m[k+14],23,-35309556),g=u(g,w,y,C,m[k+1],4,-1530992060),C=u(C,g,w,y,m[k+4],11,1272893353),y=u(y,C,g,w,m[k+7],16,-155497632),w=u(w,y,C,g,m[k+10],23,-1094730640),g=u(g,w,y,C,m[k+13],4,681279174),C=u(C,g,w,y,m[k],11,-358537222),y=u(y,C,g,w,m[k+3],16,-722521979),w=u(w,y,C,g,m[k+6],23,76029189),g=u(g,w,y,C,m[k+9],4,-640364487),C=u(C,g,w,y,m[k+12],11,-421815835),y=u(y,C,g,w,m[k+15],16,530742520),w=u(w,y,C,g,m[k+2],23,-995338651),g=h(g,w,y,C,m[k],6,-198630844),C=h(C,g,w,y,m[k+7],10,1126891415),y=h(y,C,g,w,m[k+14],15,-1416354905),w=h(w,y,C,g,m[k+5],21,-57434055),g=h(g,w,y,C,m[k+12],6,1700485571),C=h(C,g,w,y,m[k+3],10,-1894986606),y=h(y,C,g,w,m[k+10],15,-1051523),w=h(w,y,C,g,m[k+1],21,-2054922799),g=h(g,w,y,C,m[k+8],6,1873313359),C=h(C,g,w,y,m[k+15],10,-30611744),y=h(y,C,g,w,m[k+6],15,-1560198380),w=h(w,y,C,g,m[k+13],21,1309151649),g=h(g,w,y,C,m[k+4],6,-145523070),C=h(C,g,w,y,m[k+11],10,-1120210379),y=h(y,C,g,w,m[k+2],15,718787259),w=h(w,y,C,g,m[k+9],21,-343485551),g=o(g,F),w=o(w,I),y=o(y,N),C=o(C,j)}return[g,w,y,C]})((function(m){if(m.length===0)return[];const v=8*m.length,g=new Uint32Array(s(v));for(let w=0;w<v;w+=8)g[w>>5]|=(255&m[w/8])<<w%32;return g})(f),8*f.length))};i.default=d},{}],530:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,i.default="00000000-0000-0000-0000-000000000000"},{}],531:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s,o=(s=r("./validate.js"))&&s.__esModule?s:{default:s},a=function(l){if(!(0,o.default)(l))throw TypeError("Invalid UUID");let c;const u=new Uint8Array(16);return u[0]=(c=parseInt(l.slice(0,8),16))>>>24,u[1]=c>>>16&255,u[2]=c>>>8&255,u[3]=255&c,u[4]=(c=parseInt(l.slice(9,13),16))>>>8,u[5]=255&c,u[6]=(c=parseInt(l.slice(14,18),16))>>>8,u[7]=255&c,u[8]=(c=parseInt(l.slice(19,23),16))>>>8,u[9]=255&c,u[10]=(c=parseInt(l.slice(24,36),16))/1099511627776&255,u[11]=c/4294967296&255,u[12]=c>>>24&255,u[13]=c>>>16&255,u[14]=c>>>8&255,u[15]=255&c,u};i.default=a},{"./validate.js":541}],532:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0,i.default=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i},{}],533:[function(r,n,i){let s;Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(){if(!s&&(s=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!s))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return s(o)};const o=new Uint8Array(16)},{}],534:[function(r,n,i){function s(l,c,u,h){switch(l){case 0:return c&u^~c&h;case 1:return c^u^h;case 2:return c&u^c&h^u&h;case 3:return c^u^h}}function o(l,c){return l<<c|l>>>32-c}Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var a=function(l){const c=[1518500249,1859775393,2400959708,3395469782],u=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof l=="string"){const m=unescape(encodeURIComponent(l));l=[];for(let v=0;v<m.length;++v)l.push(m.charCodeAt(v))}else Array.isArray(l)||(l=Array.prototype.slice.call(l));l.push(128);const h=l.length/4+2,d=Math.ceil(h/16),f=new Array(d);for(let m=0;m<d;++m){const v=new Uint32Array(16);for(let g=0;g<16;++g)v[g]=l[64*m+4*g]<<24|l[64*m+4*g+1]<<16|l[64*m+4*g+2]<<8|l[64*m+4*g+3];f[m]=v}f[d-1][14]=8*(l.length-1)/Math.pow(2,32),f[d-1][14]=Math.floor(f[d-1][14]),f[d-1][15]=8*(l.length-1)&4294967295;for(let m=0;m<d;++m){const v=new Uint32Array(80);for(let F=0;F<16;++F)v[F]=f[m][F];for(let F=16;F<80;++F)v[F]=o(v[F-3]^v[F-8]^v[F-14]^v[F-16],1);let g=u[0],w=u[1],y=u[2],C=u[3],k=u[4];for(let F=0;F<80;++F){const I=Math.floor(F/20),N=o(g,5)+s(I,w,y,C)+k+c[I]+v[F]>>>0;k=C,C=y,y=o(w,30)>>>0,w=g,g=N}u[0]=u[0]+g>>>0,u[1]=u[1]+w>>>0,u[2]=u[2]+y>>>0,u[3]=u[3]+C>>>0,u[4]=u[4]+k>>>0}return[u[0]>>24&255,u[0]>>16&255,u[0]>>8&255,255&u[0],u[1]>>24&255,u[1]>>16&255,u[1]>>8&255,255&u[1],u[2]>>24&255,u[2]>>16&255,u[2]>>8&255,255&u[2],u[3]>>24&255,u[3]>>16&255,u[3]>>8&255,255&u[3],u[4]>>24&255,u[4]>>16&255,u[4]>>8&255,255&u[4]]};i.default=a},{}],535:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s,o=(s=r("./validate.js"))&&s.__esModule?s:{default:s};const a=[];for(let c=0;c<256;++c)a.push((c+256).toString(16).substr(1));var l=function(c){let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const h=(a[c[u+0]]+a[c[u+1]]+a[c[u+2]]+a[c[u+3]]+"-"+a[c[u+4]]+a[c[u+5]]+"-"+a[c[u+6]]+a[c[u+7]]+"-"+a[c[u+8]]+a[c[u+9]]+"-"+a[c[u+10]]+a[c[u+11]]+a[c[u+12]]+a[c[u+13]]+a[c[u+14]]+a[c[u+15]]).toLowerCase();if(!(0,o.default)(h))throw TypeError("Stringified UUID is invalid");return h};i.default=l},{"./validate.js":541}],536:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=a(r("./rng.js")),o=a(r("./stringify.js"));function a(f){return f&&f.__esModule?f:{default:f}}let l,c,u=0,h=0;var d=function(f,m,v){let g=m&&v||0;const w=m||new Array(16);let y=(f=f||{}).node||l,C=f.clockseq!==void 0?f.clockseq:c;if(y==null||C==null){const L=f.random||(f.rng||s.default)();y==null&&(y=l=[1|L[0],L[1],L[2],L[3],L[4],L[5]]),C==null&&(C=c=16383&(L[6]<<8|L[7]))}let k=f.msecs!==void 0?f.msecs:Date.now(),F=f.nsecs!==void 0?f.nsecs:h+1;const I=k-u+(F-h)/1e4;if(I<0&&f.clockseq===void 0&&(C=C+1&16383),(I<0||k>u)&&f.nsecs===void 0&&(F=0),F>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");u=k,h=F,c=C,k+=122192928e5;const N=(1e4*(268435455&k)+F)%4294967296;w[g++]=N>>>24&255,w[g++]=N>>>16&255,w[g++]=N>>>8&255,w[g++]=255&N;const j=k/4294967296*1e4&268435455;w[g++]=j>>>8&255,w[g++]=255&j,w[g++]=j>>>24&15|16,w[g++]=j>>>16&255,w[g++]=C>>>8|128,w[g++]=255&C;for(let L=0;L<6;++L)w[g+L]=y[L];return m||(0,o.default)(w)};i.default=d},{"./rng.js":533,"./stringify.js":535}],537:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=a(r("./v35.js")),o=a(r("./md5.js"));function a(c){return c&&c.__esModule?c:{default:c}}var l=(0,s.default)("v3",48,o.default);i.default=l},{"./md5.js":529,"./v35.js":538}],538:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=function(u,h,d){function f(m,v,g,w){if(typeof m=="string"&&(m=(function(C){C=unescape(encodeURIComponent(C));const k=[];for(let F=0;F<C.length;++F)k.push(C.charCodeAt(F));return k})(m)),typeof v=="string"&&(v=(0,o.default)(v)),v.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let y=new Uint8Array(16+m.length);if(y.set(v),y.set(m,v.length),y=d(y),y[6]=15&y[6]|h,y[8]=63&y[8]|128,g){w=w||0;for(let C=0;C<16;++C)g[w+C]=y[C];return g}return(0,s.default)(y)}try{f.name=u}catch{}return f.DNS=l,f.URL=c,f},i.URL=i.DNS=void 0;var s=a(r("./stringify.js")),o=a(r("./parse.js"));function a(u){return u&&u.__esModule?u:{default:u}}const l="6ba7b810-9dad-11d1-80b4-00c04fd430c8";i.DNS=l;const c="6ba7b811-9dad-11d1-80b4-00c04fd430c8";i.URL=c},{"./parse.js":531,"./stringify.js":535}],539:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=a(r("./rng.js")),o=a(r("./stringify.js"));function a(c){return c&&c.__esModule?c:{default:c}}var l=function(c,u,h){const d=(c=c||{}).random||(c.rng||s.default)();if(d[6]=15&d[6]|64,d[8]=63&d[8]|128,u){h=h||0;for(let f=0;f<16;++f)u[h+f]=d[f];return u}return(0,o.default)(d)};i.default=l},{"./rng.js":533,"./stringify.js":535}],540:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s=a(r("./v35.js")),o=a(r("./sha1.js"));function a(c){return c&&c.__esModule?c:{default:c}}var l=(0,s.default)("v5",80,o.default);i.default=l},{"./sha1.js":534,"./v35.js":538}],541:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s,o=(s=r("./regex.js"))&&s.__esModule?s:{default:s},a=function(l){return typeof l=="string"&&o.default.test(l)};i.default=a},{"./regex.js":532}],542:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var s,o=(s=r("./validate.js"))&&s.__esModule?s:{default:s},a=function(l){if(!(0,o.default)(l))throw TypeError("Invalid UUID");return parseInt(l.substr(14,1),16)};i.default=a},{"./validate.js":541}],543:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CHAR=`	
\r ---`,i.S=` 	\r
`,i.NAME_START_CHAR=":A-Z_a-z-----------",i.NAME_CHAR="-"+i.NAME_START_CHAR+".0-9--",i.CHAR_RE=new RegExp("^["+i.CHAR+"]$","u"),i.S_RE=new RegExp("^["+i.S+"]+$","u"),i.NAME_START_CHAR_RE=new RegExp("^["+i.NAME_START_CHAR+"]$","u"),i.NAME_CHAR_RE=new RegExp("^["+i.NAME_CHAR+"]$","u"),i.NAME_RE=new RegExp("^["+i.NAME_START_CHAR+"]["+i.NAME_CHAR+"]*$","u"),i.NMTOKEN_RE=new RegExp("^["+i.NAME_CHAR+"]+$","u");function s(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}i.S_LIST=[32,10,13,9],i.isChar=function(o){return o>=32&&o<=55295||o===10||o===13||o===9||o>=57344&&o<=65533||o>=65536&&o<=1114111},i.isS=function(o){return o===32||o===10||o===13||o===9},i.isNameStartChar=s,i.isNameChar=function(o){return s(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],544:[function(r,n,i){Object.defineProperty(i,"__esModule",{value:!0}),i.CHAR="---",i.RESTRICTED_CHAR="-\b\v\f---",i.S=` 	\r
`,i.NAME_START_CHAR=":A-Z_a-z-----------",i.NAME_CHAR="-"+i.NAME_START_CHAR+".0-9--",i.CHAR_RE=new RegExp("^["+i.CHAR+"]$","u"),i.RESTRICTED_CHAR_RE=new RegExp("^["+i.RESTRICTED_CHAR+"]$","u"),i.S_RE=new RegExp("^["+i.S+"]+$","u"),i.NAME_START_CHAR_RE=new RegExp("^["+i.NAME_START_CHAR+"]$","u"),i.NAME_CHAR_RE=new RegExp("^["+i.NAME_CHAR+"]$","u"),i.NAME_RE=new RegExp("^["+i.NAME_START_CHAR+"]["+i.NAME_CHAR+"]*$","u"),i.NMTOKEN_RE=new RegExp("^["+i.NAME_CHAR+"]+$","u");function s(o){return o>=65&&o<=90||o>=97&&o<=122||o===58||o===95||o===8204||o===8205||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}i.S_LIST=[32,10,13,9],i.isChar=function(o){return o>=1&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},i.isRestrictedChar=function(o){return o>=1&&o<=8||o===11||o===12||o>=14&&o<=31||o>=127&&o<=132||o>=134&&o<=159},i.isCharAndNotRestricted=function(o){return o===9||o===10||o===13||o>31&&o<127||o===133||o>159&&o<=55295||o>=57344&&o<=65533||o>=65536&&o<=1114111},i.isS=function(o){return o===32||o===10||o===13||o===9},i.isNameStartChar=s,i.isNameChar=function(o){return s(o)||o>=48&&o<=57||o===45||o===46||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}],545:[function(r,n,i){function s(o){return o>=65&&o<=90||o===95||o>=97&&o<=122||o>=192&&o<=214||o>=216&&o<=246||o>=248&&o<=767||o>=880&&o<=893||o>=895&&o<=8191||o>=8204&&o<=8205||o>=8304&&o<=8591||o>=11264&&o<=12271||o>=12289&&o<=55295||o>=63744&&o<=64975||o>=65008&&o<=65533||o>=65536&&o<=983039}Object.defineProperty(i,"__esModule",{value:!0}),i.NC_NAME_START_CHAR="A-Z_a-z------------",i.NC_NAME_CHAR="-"+i.NC_NAME_START_CHAR+".0-9--",i.NC_NAME_START_CHAR_RE=new RegExp("^["+i.NC_NAME_START_CHAR+"]$","u"),i.NC_NAME_CHAR_RE=new RegExp("^["+i.NC_NAME_CHAR+"]$","u"),i.NC_NAME_RE=new RegExp("^["+i.NC_NAME_START_CHAR+"]["+i.NC_NAME_CHAR+"]*$","u"),i.isNCNameStartChar=s,i.isNCNameChar=function(o){return s(o)||o===45||o===46||o>=48&&o<=57||o===183||o>=768&&o<=879||o>=8255&&o<=8256}},{}]},{},[15])(15)}))})(Kb)),Kb.exports}var hfe=dfe();const ffe=Qw(hfe);var c0={exports:{}},pfe=c0.exports,dT;function gfe(){return dT||(dT=1,(function(e,t){(function(r,n){n()})(pfe,function(){function r(c,u){return typeof u>"u"?u={autoBom:!1}:typeof u!="object"&&(console.warn("Deprecated: Expected third argument to be a object"),u={autoBom:!u}),u.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(c.type)?new Blob(["\uFEFF",c],{type:c.type}):c}function n(c,u,h){var d=new XMLHttpRequest;d.open("GET",c),d.responseType="blob",d.onload=function(){l(d.response,u,h)},d.onerror=function(){console.error("could not download file")},d.send()}function i(c){var u=new XMLHttpRequest;u.open("HEAD",c,!1);try{u.send()}catch{}return 200<=u.status&&299>=u.status}function s(c){try{c.dispatchEvent(new MouseEvent("click"))}catch{var u=document.createEvent("MouseEvents");u.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),c.dispatchEvent(u)}}var o=typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof ir=="object"&&ir.global===ir?ir:void 0,a=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||(typeof window!="object"||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(c,u,h){var d=o.URL||o.webkitURL,f=document.createElement("a");u=u||c.name||"download",f.download=u,f.rel="noopener",typeof c=="string"?(f.href=c,f.origin===location.origin?s(f):i(f.href)?n(c,u,h):s(f,f.target="_blank")):(f.href=d.createObjectURL(c),setTimeout(function(){d.revokeObjectURL(f.href)},4e4),setTimeout(function(){s(f)},0))}:"msSaveOrOpenBlob"in navigator?function(c,u,h){if(u=u||c.name||"download",typeof c!="string")navigator.msSaveOrOpenBlob(r(c,h),u);else if(i(c))n(c,u,h);else{var d=document.createElement("a");d.href=c,d.target="_blank",setTimeout(function(){s(d)})}}:function(c,u,h,d){if(d=d||open("","_blank"),d&&(d.document.title=d.document.body.innerText="downloading..."),typeof c=="string")return n(c,u,h);var f=c.type==="application/octet-stream",m=/constructor/i.test(o.HTMLElement)||o.safari,v=/CriOS\/[\d]+/.test(navigator.userAgent);if((v||f&&m||a)&&typeof FileReader<"u"){var g=new FileReader;g.onloadend=function(){var C=g.result;C=v?C:C.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=C:location=C,d=null},g.readAsDataURL(c)}else{var w=o.URL||o.webkitURL,y=w.createObjectURL(c);d?d.location=y:location.href=y,d=null,setTimeout(function(){w.revokeObjectURL(y)},4e4)}});o.saveAs=l.saveAs=l,e.exports=l})})(c0)),c0.exports}var mfe=gfe();const vA=()=>({headerFont:{name:"Arial",size:10,bold:!0,color:{argb:"FFFFFFFF"}},headerFill:{type:"pattern",pattern:"solid",fgColor:{argb:"FF000000"}},subHeaderFill:{type:"pattern",pattern:"solid",fgColor:{argb:"FFE5E7EB"}},borderStyle:{top:{style:"thin",color:{argb:"FF9CA3AF"}},left:{style:"thin",color:{argb:"FF9CA3AF"}},bottom:{style:"thin",color:{argb:"FF9CA3AF"}},right:{style:"thin",color:{argb:"FF9CA3AF"}}},centerStyle:{vertical:"middle",horizontal:"center"},rightStyle:{vertical:"middle",horizontal:"right"},leftStyle:{vertical:"middle",horizontal:"left"}}),vfe=(e,t)=>{const{headerFont:r,headerFill:n,subHeaderFill:i,borderStyle:s,centerStyle:o,rightStyle:a,leftStyle:l}=vA(),c=e.addWorksheet("Secuencia Diaria",{views:[{showGridLines:!1}]});c.columns=[{key:"time",width:15,style:{alignment:o}},{key:"duration",width:8,style:{alignment:o}},{key:"sku",width:15,style:{alignment:l}},{key:"description",width:50,style:{alignment:l}},{key:"prodHours",width:10,style:{alignment:a,numFmt:"0.0"}},{key:"stopHours",width:12,style:{alignment:a,numFmt:"0.0"}},{key:"tonnage",width:10,style:{alignment:a,numFmt:"#,##0"}}];const u=t.dailySchedules.length>0?Nr(new Date(t.dailySchedules[0].date),"MMMM yyyy",{locale:Xs}).toUpperCase():"PROGRAMACIN MENSUAL",h=c.getRow(1);h.values=[`PROGRAMACIN MENSUAL: ${u}`,"","","",t.monthlyTotals.productionMinutes/60,t.monthlyTotals.stoppageMinutes/60,t.monthlyTotals.tonnage],h.height=30,h.eachCell((f,m)=>{f.font={...r,size:12},f.fill=n,f.border=s,f.alignment=m<=4?l:a,(m===5||m===6)&&(f.numFmt='0.0 "h"'),m===7&&(f.numFmt='#,##0 "T"')}),c.mergeCells("A1:D1"),h.getCell(1).alignment={vertical:"middle",horizontal:"left",indent:1};const d=c.getRow(2);d.values=["HORARIO","MIN","SKU / TIPO","ACTIVIDAD / DESCRIPCIN","H. PROD","H. PARADA","TON"],d.height=25,d.eachCell(f=>{f.font=r,f.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF4B5563"}},f.alignment=o,f.border=s}),t.dailySchedules.forEach(f=>{const m=c.addRow([Nr(new Date(f.date),"EEEE d MMMM",{locale:Xs}).toUpperCase(),"","","",f.totalProductionMinutes/60,f.totalStoppageMinutes/60,f.totalTonnage]),v=m.number;m.height=20,m.eachCell((g,w)=>{g.font={bold:!0,size:11},g.fill=i,g.border=s,g.alignment=w>=5?a:l,(w===5||w===6)&&(g.numFmt="0.0"),w===7&&(g.numFmt="#,##0")}),c.mergeCells(`A${v}:D${v}`),m.getCell(1).alignment={horizontal:"left",vertical:"middle",indent:1},f.events.forEach(g=>{const w=new Date(g.startTime),y=new Date(g.endTime),C=g.type==="production",k=g.durationMinutes/60,F=c.addRow([`${Nr(w,"HH:mm")} - ${Nr(y,"HH:mm")}`,Math.round(g.durationMinutes),g.skuCode||g.label,g.description||g.label,C?k:null,C?null:k,C&&g.tonnage?g.tonnage:null]);let I="FFFFFFFF";const N=g.type,j=g.label?g.label.toUpperCase():"",L=g.description?g.description.toUpperCase():"",W=j.includes("HORA PUNTA")||L.includes("HORA PUNTA")||N==="maintenance_hp";W?I="FFFFE4E6":N==="changeover"||N==="adjustment"?I="FFFFF7ED":(N==="maintenance_hp"||N==="forced_stop"||N==="stop_change"||N==="quality_change"||N==="ring_change"||N==="channel_change")&&(I="FFFFFBEB"),g.color&&g.color.startsWith("#")&&g.color.length===7&&(I="FF"+g.color.substring(1).toUpperCase());const M={type:"pattern",pattern:"solid",fgColor:{argb:I}};F.eachCell({includeEmpty:!0},(B,R)=>{B.fill=M,B.border=s,R===1&&(B.alignment=o),R===2&&(B.alignment=o),R===3&&(B.alignment=l,g.skuCode&&(B.font={bold:!0})),R===4&&(B.alignment=l,W&&(B.font={color:{argb:"FFB91C1C"},bold:!0})),R>=5&&(B.alignment=a),(R===5||R===6)&&(B.numFmt="0.00"),R===7&&(B.numFmt="#,##0.0")})})})},bfe=(e,t)=>{const{headerFont:r,headerFill:n,borderStyle:i,centerStyle:s,rightStyle:o,leftStyle:a}=vA(),{dailySchedules:l,articles:c}=t,u="N",h=e.addWorksheet("Plan Mensual",{views:[{showGridLines:!0}]}),d={vertical:"middle",horizontal:"center",wrapText:!0},f={vertical:"middle",horizontal:"left",wrapText:!0};h.columns=[{header:"N",key:"num",width:6,style:{alignment:s}},{header:"ORDEN DE PROCESO",key:"ordenProceso",width:18,style:{alignment:s}},{header:"CDIGO SAP",key:"codigoSap",width:15,style:{alignment:s}},{header:"PRODUCTO",key:"producto",width:40,style:{alignment:f}},{header:"Ritmo",key:"ritmo",width:10,style:{alignment:s}},{header:"Rend. 1era",key:"rend1era",width:10,style:{alignment:s}},{header:"CDIGO PACC",key:"codigoPacc",width:15,style:{alignment:s}},{header:"CALIDAD PACC",key:"calidadPacc",width:15,style:{alignment:s}},{header:"Prod. (Ton)",key:"prod",width:12,style:{alignment:o,numFmt:"#,##0.0"}},{header:"Peso KG/PACC",key:"pesoKgPacc",width:12,style:{alignment:o,numFmt:"#,##0.0"}},{header:"Alm Final",key:"almFinal",width:10,style:{alignment:s}},{header:"FECHA INICIO",key:"fechaInicio",width:18,style:{alignment:d}},{header:"FECHA FIN",key:"fechaFin",width:18,style:{alignment:d}},{header:"Observaciones",key:"observaciones",width:30,style:{alignment:f}}];const m=new Map;l.forEach(N=>{N.events.forEach(j=>{if(j.type==="production"&&j.originalItemId){const L=j.originalItemId,W=new Date(j.startTime),K=new Date(j.endTime),z=j.tonnage||0;if(m.has(L)){const M=m.get(L);M.tonnage+=z,W<M.startTime&&(M.startTime=W),K>M.endTime&&(M.endTime=K)}else m.set(L,{skuCode:j.skuCode||"",tonnage:z,startTime:W,endTime:K})}})});const v=Array.from(m.values()).sort((N,j)=>N.startTime.getTime()-j.startTime.getTime());let g=0;v.forEach(N=>{g+=N.tonnage});const w=l.length>0?Nr(new Date(l[0].date),"MMMM yyyy",{locale:Xs}).toUpperCase():"PLAN MENSUAL",y=h.getRow(1);y.getCell(1).value=`PLAN MENSUAL: ${w}`,y.height=28,h.mergeCells(`A1:${u}1`),y.getCell(1).font={...r,size:13},y.getCell(1).fill=n,y.getCell(1).alignment={vertical:"middle",horizontal:"center"};const C=h.getRow(2);C.getCell(1).value=g,C.height=22,h.mergeCells(`A2:${u}2`),C.getCell(1).font={name:"Arial",size:12,bold:!0,color:{argb:"FF1E40AF"}},C.getCell(1).fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFDBEAFE"}},C.getCell(1).alignment={vertical:"middle",horizontal:"center"},C.getCell(1).numFmt='#,##0.0 "Ton"',C.getCell(1).border=i;const k=["N","ORDEN DE PROCESO","CDIGO SAP","PRODUCTO","FECHA INICIO","FECHA FIN","Prod. (Ton)","Ritmo","Rend. 1era","CDIGO PACC","CALIDAD PACC","Peso KG/PACC","Alm Final","Observaciones"],F=[5,18,14,38,17,17,11,7,8,13,16,10,8,25],I=h.getRow(3);I.height=28,k.forEach((N,j)=>{const L=I.getCell(j+1);L.value=N,L.font=r,L.fill=n,L.alignment={vertical:"middle",horizontal:"center",wrapText:!0},L.border=i}),F.forEach((N,j)=>{const L=h.getColumn(j+1);L.width=N}),v.forEach((N,j)=>{const L=c.find(z=>z.codigoProgramacion===N.skuCode),W=[j+1,"",L?.skuLaminacion||N.skuCode||"",L?.descripcion||"",Nr(N.startTime,"EEE dd/MM HH:mm",{locale:Xs}),Nr(N.endTime,"EEE dd/MM HH:mm",{locale:Xs}),N.tonnage,L?.ritmoTH||"",L?.rendimientoMetalico||"",L?.skuPalanquilla||"",L?.calidadPalanquilla||"",L?.pesoPalanquilla||"",L?.almacenDestino||"",L?.comentarios||""],K=h.addRow(W);K.height=20,K.eachCell({includeEmpty:!0},(z,M)=>{z.border=i,M===1||M===2||M===3?z.alignment=s:M===4?z.alignment=f:M===5||M===6?z.alignment=a:M===7?(z.alignment=o,z.numFmt="#,##0.0"):M===8||M===9||M===10?z.alignment=s:M===11?z.alignment=a:M===12?(z.alignment=o,z.numFmt="#,##0"):M===13?z.alignment=s:M===14&&(z.alignment=f)})})},wfe=async e=>{const t=new ffe.Workbook;t.creator="Scheduler App",t.lastModifiedBy="Scheduler App",t.created=new Date,t.modified=new Date,vfe(t,e),bfe(t,e);const r=await t.xlsx.writeBuffer(),n=new Blob([r],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),s=`Programacion_${e.dailySchedules.length>0?Nr(new Date(e.dailySchedules[0].date),"MMMM_yyyy",{locale:Xs}):Nr(new Date,"yyyy-MM-dd")}_${Nr(new Date,"HHmm")}.xlsx`;mfe.saveAs(n,s)},yfe=()=>{const e=Lr(k=>k.activeProcessId),t=Lr(k=>k.processes[e]);if(!t)return J.jsx("div",{className:"flex items-center justify-center min-h-[400px] text-zinc-500 bg-zinc-50/50 rounded-xl border-2 border-dashed border-zinc-200",children:J.jsxs("div",{className:"flex flex-col items-center gap-3",children:[J.jsx("div",{className:"w-8 h-8 border-2 border-indigo-500 border-t-transparent rounded-full animate-spin"}),J.jsx("p",{className:"text-sm font-medium",children:"Cargando secuencia diaria..."})]})});const{schedule:r,visualTargetDate:n}=t,{isHoliday:i,setVisualTargetDate:s}=Lr(),o=Ks(k=>k.getArticles(e)),[a,l]=st.useState(!1),[c,u]=st.useState(!1),[h,d]=st.useState(new Set(["all"]));st.useEffect(()=>{if(n){const k=Nr(n,"yyyy-MM-dd");setTimeout(()=>{const F=document.getElementById(`day - ${k} `);if(F){F.scrollIntoView({behavior:"smooth",block:"start"});const I=F.style.backgroundColor;F.style.backgroundColor="#fde047",setTimeout(()=>{F.style.backgroundColor=I},1500)}},100),s(null)}},[n,s]);const f=ae.useMemo(()=>{const k=new Map,F=N=>{const j=Nr(N,"yyyy-MM-dd");return k.has(j)||k.set(j,{date:Rc(N),events:[],totalTonnage:0,totalProductionMinutes:0,totalStoppageMinutes:0,balanceMinutes:1440}),k.get(j)},I=(N,j)=>{const L=new Date(N),W=L.getDay();if(W>=1&&W<=5&&!i(L)){const K=new Date(L);K.setHours(18,30,0,0);const z=new Date(L);return z.setHours(20,30,0,0),N<z&&j>K}return!1};return r.forEach(N=>{N.segments&&N.segments.forEach(j=>{const L=new Date(j.start),W=new Date(j.end);if(Nh(L,W))return;let K=L;for(;K<W;){const z=F(K),M=rue(K),B=Du(W,M)?W:M,R=qC(B,K)/6e4;R>0&&(!a||I(K,B))&&(z.events.push({id:`${N.id}_${z.events.length} `,originalItemId:N.id,type:j.type,label:j.label,description:j.description,startTime:K,endTime:B,durationMinutes:R,skuCode:N.skuCode,tonnage:j.type==="production"&&N.quantity&&N.productionTimeMinutes>0?N.quantity*(R/N.productionTimeMinutes):0,color:j.color}),j.type==="production"?(z.totalProductionMinutes+=R,N.productionTimeMinutes>0&&N.quantity&&(z.totalTonnage+=N.quantity*(R/N.productionTimeMinutes))):z.totalStoppageMinutes+=R,z.balanceMinutes-=R),K=vd(Rc(K),1)}})}),k.forEach(N=>{N.events.sort((L,W)=>L.startTime.getTime()-W.startTime.getTime());const j=[];if(N.events.length>0){let L=N.events[0];for(let W=1;W<N.events.length;W++){const K=N.events[W],z=L.type===K.type,M=L.label===K.label,B=L.skuCode===K.skuCode,R=Math.abs(sA(K.startTime,L.endTime))<1;z&&M&&B&&R?(L.endTime=K.endTime,L.durationMinutes+=K.durationMinutes,L.tonnage!==void 0&&K.tonnage!==void 0&&(L.tonnage+=K.tonnage),L.type==="maintenance_hp"&&(L.description=`Mantenimiento(${Math.round(L.durationMinutes)} min)`)):(j.push(L),L=K)}j.push(L)}N.events=j}),Array.from(k.values()).sort((N,j)=>N.date.getTime()-j.date.getTime())},[r,o,a]),m=async()=>{try{const k=f.map(F=>({...F,events:F.events.map(I=>{if(I.type==="production"&&I.skuCode){const N=o.find(j=>j.codigoProgramacion===I.skuCode);return{...I,description:N?N.descripcion:I.description}}return I})}));await wfe({dailySchedules:k,monthlyTotals:v,articles:o})}catch(k){console.error("Export Error:",k),alert("Hubo un error al exportar a Excel. Revisa la consola para ms detalles.")}},v=f.reduce((k,F)=>({tonnage:k.tonnage+F.totalTonnage,productionMinutes:k.productionMinutes+F.totalProductionMinutes,stoppageMinutes:k.stoppageMinutes+F.totalStoppageMinutes}),{tonnage:0,productionMinutes:0,stoppageMinutes:0}),g=ae.useMemo(()=>{const k={};return f.forEach(F=>{F.events.forEach(I=>{const N=I.type||"unknown";k[N]=(k[N]||0)+1})}),k},[f]),w=ae.useMemo(()=>{const k=Object.keys(g).sort();return k.includes("production")?["production",...k.filter(F=>F!=="production")]:k},[g]),y=k=>{const F=new Set(h);k==="all"?(F.has("all"),F.clear(),F.add("all")):(F.delete("all"),F.has(k)?(F.delete(k),F.size===0&&F.add("all")):F.add(k)),d(F)},C={production:"Produccin",changeover:"Cambio de Medida",maintenance_hp:"Mantenimiento HP",maintenance:"Mantenimiento",lunch:"Refrigerio",forced_stop:"Parada Forzada",stop_change:"Parada Cambio",quality_change:"Cambio Calidad",ring_change:"Cambio Anillo",channel_change:"Cambio Canal",adjustment:"Ajuste",unknown:"Desconocido"};return J.jsxs("div",{className:"bg-white h-full overflow-y-auto relative p-4 font-sans text-gray-900",children:[J.jsxs("header",{className:"mb-4 border-b-2 border-black pb-2 flex justify-between items-end bg-white block",children:[J.jsx("div",{className:"flex gap-8 items-end",children:J.jsxs("div",{children:[J.jsx("h1",{className:"text-2xl font-black uppercase leading-none",children:"Secuencia Diaria"}),J.jsxs("p",{className:"text-sm font-black text-blue-900 mt-1",children:["Total: ",v.tonnage.toLocaleString("en-US",{maximumFractionDigits:0})," Ton | Prod: ",(v.productionMinutes/60).toFixed(1),"h | Paradas: ",(v.stoppageMinutes/60).toFixed(1),"h"]})]})}),J.jsxs("div",{className:"flex gap-4 items-center",children:[J.jsxs("div",{className:"relative",onClick:k=>k.stopPropagation(),children:[J.jsxs("button",{onClick:()=>u(!c),className:`flex items - center gap - 2 px - 4 py - 2 rounded text - xs font - bold transition shadow ${h.has("all")?"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50":"bg-blue-100 text-blue-700 border border-blue-300 ring-2 ring-blue-200"} `,children:[J.jsx(ece,{size:16,className:h.has("all")?"":"fill-current"}),"FILTRAR EVENTOS",J.jsx(Nle,{size:14})]}),c&&J.jsxs("div",{className:"absolute right-0 top-full mt-2 w-64 bg-white rounded-lg shadow-xl border border-gray-200 z-50 overflow-hidden",children:[J.jsxs("div",{className:"p-2 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[J.jsx("span",{className:"text-xs font-bold text-gray-500",children:"TIPOS DE EVENTO"}),J.jsx("button",{onClick:()=>{d(new Set(["all"])),u(!1)},className:"text-[10px] text-blue-600 font-bold hover:underline",children:"VER TODO"})]}),J.jsxs("div",{className:"max-h-64 overflow-y-auto p-1",children:[J.jsxs("button",{onClick:()=>y("all"),className:`w - full text - left px - 3 py - 2 text - xs flex items - center gap - 2 rounded hover: bg - gray - 50 ${h.has("all")?"font-bold text-blue-700 bg-blue-50":"text-gray-700"} `,children:[J.jsx("div",{className:`w - 4 h - 4 rounded border flex items - center justify - center ${h.has("all")?"bg-blue-600 border-blue-600":"border-gray-300"} `,children:h.has("all")&&J.jsx(JE,{size:10,className:"text-white"})}),"Todos los tipos"]}),w.map(k=>J.jsxs("button",{onClick:()=>y(k),className:`w - full text - left px - 3 py - 2 text - xs flex items - center gap - 2 rounded hover: bg - gray - 50 ${h.has(k)?"font-bold text-blue-700 bg-blue-50":"text-gray-700"} `,children:[J.jsx("div",{className:`w - 4 h - 4 rounded border flex items - center justify - center ${h.has(k)?"bg-blue-600 border-blue-600":"border-gray-300"} `,children:h.has(k)&&J.jsx(JE,{size:10,className:"text-white"})}),J.jsx("span",{className:"flex-1 truncate",children:C[k]||k}),J.jsx("span",{className:"text-gray-400 font-mono text-[10px]",children:g[k]})]},k))]})]}),c&&J.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>u(!1)})]}),J.jsxs("button",{onClick:m,className:"flex items-center gap-2 bg-green-600 text-white px-4 py-2 rounded text-xs font-bold hover:bg-green-700 transition shadow",children:[J.jsx(Jle,{size:16})," EXCEL"]}),J.jsxs("button",{onClick:()=>l(!a),className:`flex items - center gap - 2 px - 4 py - 2 rounded text - xs font - bold transition shadow ${a?"bg-purple-100 text-purple-700 border border-purple-300 ring-2 ring-purple-200":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"} `,title:"Mostrar solo items que intersectan Lunes-Viernes 18:30-20:30",children:[J.jsx(Uce,{size:16,className:a?"fill-current":""}),"HORA PUNTA"]})]})]}),J.jsx("div",{children:J.jsxs("table",{className:"w-full text-[10px] leading-tight border-collapse",children:[J.jsx("thead",{className:"text-white",children:J.jsxs("tr",{children:[J.jsx("th",{className:"sticky top-0 z-20 bg-black p-1 text-left font-bold uppercase w-20 border border-gray-600 shadow-sm",children:"Horario"}),J.jsx("th",{className:"sticky top-0 z-20 bg-black p-1 text-center font-bold uppercase w-12 border border-gray-600 shadow-sm",children:"Min"}),J.jsx("th",{className:"sticky top-0 z-20 bg-black p-1 text-left font-bold uppercase w-24 border border-gray-600 shadow-sm",children:"SKU / Tipo"}),J.jsx("th",{className:"sticky top-0 z-20 bg-black p-1 text-left font-bold uppercase border border-gray-600 shadow-sm",children:"Actividad / Descripcin"}),J.jsxs("th",{className:"sticky top-0 z-20 bg-black p-1 text-right font-bold uppercase w-16 border border-gray-600 shadow-sm",children:["Ton",J.jsxs("div",{className:"text-[9px] text-yellow-300 font-mono leading-none mt-1",children:[" ",v.tonnage.toLocaleString("en-US",{maximumFractionDigits:0})]})]})]})}),J.jsxs("tbody",{children:[f.map(k=>J.jsxs(st.Fragment,{children:[J.jsx("tr",{id:`day - ${Nr(k.date,"yyyy-MM-dd")} `,className:"bg-gray-200 border-t-2 border-black transition-colors duration-500",children:J.jsx("td",{colSpan:5,className:"p-1 border border-gray-400",children:J.jsxs("div",{className:"flex justify-between items-baseline px-1",children:[J.jsx("span",{className:"font-black text-sm uppercase print:text-xs",children:Nr(k.date,"EEEE d MMMM",{locale:Xs})}),J.jsxs("span",{className:"font-mono text-[9px] font-bold",children:["P: ",(k.totalProductionMinutes/60).toFixed(1),"h | S: ",(k.totalStoppageMinutes/60).toFixed(1),"h | ",k.totalTonnage.toFixed(0)," T"]})]})})}),k.events.map(F=>{if(!(h.has("all")||h.has(F.type)))return null;const N=F.label?F.label.toUpperCase():"",j=F.description?F.description.toUpperCase():"",L=N.includes("HORA PUNTA")||j.includes("HORA PUNTA")||F.type==="maintenance_hp",W=F.type==="changeover"||F.type==="adjustment",K=F.type==="maintenance_hp"||F.type==="forced_stop"||F.type==="stop_change"||F.type==="quality_change"||F.type==="ring_change"||F.type==="channel_change";let z="border-b border-gray-200 print:border-gray-300";L?z+=" bg-red-50 text-red-900 font-bold print:bg-gray-50":W?z+=" bg-orange-50 print:bg-white":K&&(z+=" bg-yellow-50 print:bg-white");const M=F.color?{backgroundColor:`${F.color} 15`}:{};return J.jsxs("tr",{className:z,style:M,children:[J.jsxs("td",{className:"p-0.5 border-r border-gray-200 font-mono whitespace-nowrap text-center",children:[Nr(F.startTime,"HH:mm")," - ",Nr(F.endTime,"HH:mm")]}),J.jsx("td",{className:"p-0.5 border-r border-gray-200 text-center font-mono",children:F.durationMinutes.toFixed(0)}),J.jsx("td",{className:"p-0.5 border-r border-gray-200 print:border-gray-300",children:J.jsx("div",{className:"flex items-center gap-1",children:F.skuCode?J.jsx("span",{className:"font-black font-mono text-[10px] bg-gray-100 px-1 rounded",children:F.skuCode}):J.jsx("span",{className:"px-1 rounded text-[8px] font-bold uppercase tracking-wider",style:{backgroundColor:F.color,color:"#333"},children:F.label.substring(0,10)})})}),J.jsx("td",{className:"p-0.5 border-r border-gray-200 print:border-gray-300",children:J.jsx("span",{className:`font - semibold ${L?"text-red-700":"text-gray-900"} `,children:F.type==="production"&&F.skuCode&&o.find(B=>B.codigoProgramacion===F.skuCode)?.descripcion||F.description})}),J.jsx("td",{className:"p-0.5 text-right font-mono font-bold",children:F.type==="production"&&F.tonnage&&F.tonnage>0?F.tonnage.toFixed(1):""})]},F.id)})]},k.date.toISOString())),f.length===0&&J.jsx("tr",{children:J.jsx("td",{colSpan:5,className:"p-8 text-center text-gray-400 italic",children:"No hay programacin generada para este rango."})})]})]})})]})},Cfe=()=>{const{holidays:e}=Lr(u=>u.processes[u.activeProcessId]),{addHoliday:t,removeHoliday:r}=Lr(),[n,i]=ae.useState(""),[s,o]=ae.useState(""),a=()=>{if(o(""),!n.trim()){o("Por favor ingresa una fecha");return}try{const u=new Date(n);if(isNaN(u.getTime())){o("Fecha invlida");return}const h=Nr(u,"yyyy-MM-dd");if(e.includes(h)){o("Este feriado ya existe");return}t(h),i("")}catch{o("Error al procesar la fecha")}},l=u=>{r(u)},c=u=>{try{const h=Ude(u,"yyyy-MM-dd",new Date);return Nr(h,"EEEE d 'de' MMMM yyyy",{locale:Xs})}catch{return u}};return J.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[J.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[J.jsx(UC,{className:"text-blue-600",size:24}),J.jsx("h2",{className:"text-xl font-bold",children:"Configuracin de Feriados"})]}),J.jsx("p",{className:"text-sm text-gray-600 mb-4",children:'Los feriados configurados aqu sern excluidos del filtro "Hora Punta" y no se programarn paradas automticas en estos das.'}),J.jsxs("div",{className:"mb-6",children:[J.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Agregar Feriado"}),J.jsxs("div",{className:"flex gap-2",children:[J.jsx("input",{type:"date",value:n,onChange:u=>{i(u.target.value),o("")},className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),J.jsxs("button",{onClick:a,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition",children:[J.jsx(kc,{size:16}),"Agregar"]})]}),s&&J.jsx("p",{className:"text-sm text-red-600 mt-2",children:s})]}),J.jsxs("div",{children:[J.jsxs("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:["Feriados Configurados (",e.length,")"]}),e.length===0?J.jsx("p",{className:"text-sm text-gray-500 italic",children:"No hay feriados configurados"}):J.jsx("div",{className:"space-y-2",children:e.map(u=>J.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-md border border-gray-200",children:[J.jsxs("div",{children:[J.jsx("p",{className:"font-medium text-gray-900 capitalize",children:c(u)}),J.jsx("p",{className:"text-xs text-gray-500 font-mono",children:u})]}),J.jsx("button",{onClick:()=>l(u),className:"p-2 text-red-600 hover:bg-red-50 rounded-md transition",title:"Eliminar feriado",children:J.jsx(sl,{size:16})})]},u))})]})]})},xfe=()=>{const{manualStops:e}=Lr(l=>l.processes[l.activeProcessId]),{addManualStop:t,deleteManualStop:r}=Lr(),[n,i]=ae.useState({date:"",time:"08:00",duration:60,label:""}),s=()=>{if(!n.date||!n.time||n.duration<=0||!n.label.trim()){alert("Por favor complete todos los campos correctamente.");return}const l=new Date(`${n.date}T${n.time}`),c={id:Jw(),start:l,durationMinutes:n.duration,label:n.label.trim()};t(c),i({...n,label:"",duration:60})},o=l=>{confirm("Est seguro de eliminar esta parada manual?")&&r(l)},a=[...e].sort((l,c)=>new Date(l.start).getTime()-new Date(c.start).getTime());return J.jsxs("div",{className:"space-y-6",children:[J.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200",children:[J.jsxs("h3",{className:"text-sm font-semibold text-gray-700 mb-3 flex items-center gap-2",children:[J.jsx(kc,{size:16}),"Agregar Parada Manual"]}),J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[J.jsxs("div",{children:[J.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Fecha y Hora"}),J.jsxs("div",{className:"flex gap-2",children:[J.jsxs("div",{className:"relative flex-1",children:[J.jsx(UC,{size:14,className:"absolute left-2 top-2.5 text-gray-400"}),J.jsx("input",{type:"date",className:"w-full pl-8 p-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none",value:n.date,onChange:l=>i({...n,date:l.target.value})})]}),J.jsxs("div",{className:"relative w-32",children:[J.jsx(sf,{size:14,className:"absolute left-2 top-2.5 text-gray-400"}),J.jsx("input",{type:"time",className:"w-full pl-8 p-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none",value:n.time,onChange:l=>i({...n,time:l.target.value})})]})]})]}),J.jsxs("div",{children:[J.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Duracin (min)"}),J.jsxs("div",{className:"relative",children:[J.jsx(Ace,{size:14,className:"absolute left-2 top-2.5 text-gray-400"}),J.jsx("input",{type:"number",min:"1",className:"w-full pl-8 p-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none",value:n.duration,onChange:l=>i({...n,duration:parseInt(l.target.value)||0})})]})]}),J.jsxs("div",{className:"md:col-span-2",children:[J.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Nombre / Motivo"}),J.jsxs("div",{className:"flex gap-2",children:[J.jsxs("div",{className:"relative flex-1",children:[J.jsx(kce,{size:14,className:"absolute left-2 top-2.5 text-gray-400"}),J.jsx("input",{type:"text",placeholder:"Ej. Mantenimiento Preventivo, Limpieza, etc.",className:"w-full pl-8 p-2 text-sm border border-gray-300 rounded focus:ring-2 focus:ring-blue-500 outline-none",value:n.label,onChange:l=>i({...n,label:l.target.value})})]}),J.jsx("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded text-sm font-medium hover:bg-blue-700 transition-colors",children:"Agregar"})]})]})]})]}),J.jsxs("div",{className:"space-y-2",children:[J.jsxs("h3",{className:"text-sm font-semibold text-gray-700",children:["Paradas Configuradas (",e.length,")"]}),a.length===0?J.jsx("p",{className:"text-sm text-gray-500 italic",children:"No hay paradas manuales configuradas."}):J.jsx("div",{className:"block w-full overflow-x-auto",children:J.jsxs("table",{className:"w-full text-left text-sm border-collapse",children:[J.jsx("thead",{children:J.jsxs("tr",{className:"bg-gray-100 text-gray-600 border-b border-gray-200",children:[J.jsx("th",{className:"p-2 font-medium",children:"Fecha"}),J.jsx("th",{className:"p-2 font-medium",children:"Hora"}),J.jsx("th",{className:"p-2 font-medium",children:"Duracin"}),J.jsx("th",{className:"p-2 font-medium",children:"Motivo"}),J.jsx("th",{className:"p-2 font-medium w-10"})]})}),J.jsx("tbody",{children:a.map(l=>J.jsxs("tr",{className:"border-b border-gray-100 last:border-0 hover:bg-gray-50",children:[J.jsx("td",{className:"p-2 text-gray-800",children:Nr(new Date(l.start),"dd/MM/yyyy")}),J.jsx("td",{className:"p-2 text-gray-800 font-medium",children:Nr(new Date(l.start),"HH:mm")}),J.jsxs("td",{className:"p-2 text-gray-600",children:[l.durationMinutes," min"]}),J.jsx("td",{className:"p-2 text-gray-800",children:l.label}),J.jsx("td",{className:"p-2 text-right",children:J.jsx("button",{onClick:()=>o(l.id),className:"text-gray-400 hover:text-red-500 transition-colors",children:J.jsx(sl,{size:16})})})]},l.id))})]})})]})]})},hT=["Dom","Lun","Mar","Mi","Jue","Vie","Sb"],fT=e=>{if(!e.active||e.hours<=0)return"";const t=e.startHour*60+e.startMinute+e.hours*60,r=Math.floor(t%1440/60),n=t%60,i=t>=1440,s=`${String(r).padStart(2,"0")}:${String(n).padStart(2,"0")}`;return i?`${s} (+1d)`:s},pT=(e,t)=>`${String(e).padStart(2,"0")}:${String(t).padStart(2,"0")}`,gT={is24h:!0,days:Object.fromEntries(Array.from({length:7},(e,t)=>[t,{active:!0,hours:24,startHour:0,startMinute:0}]))},Sfe=()=>{const e=Lr(d=>d.processes[d.activeProcessId]),t=Lr(d=>d.setWorkSchedule),r=e?.workSchedule,n=r&&r.days?r:gT,i=st.useRef(!1);st.useEffect(()=>{(!r||!r.days)&&!i.current&&(i.current=!0,t(gT))},[r,t]);const s=d=>{if(d){const f={};for(let m=0;m<7;m++)f[m]={active:!0,hours:24,startHour:0,startMinute:0};t({is24h:!0,days:f})}else{const f={};for(let m=0;m<7;m++){const v=m>=0&&m<=5;f[m]={active:v,hours:v?16:0,startHour:v?22:0,startMinute:0}}t({is24h:!1,days:f})}},o=(d,f)=>{const m={...n.days};m[d]={...m[d],...f},t({...n,days:m})},a=d=>{n.days[d].active?o(d,{active:!1,hours:0}):o(d,{active:!0,hours:16,startHour:22,startMinute:0})},l=(d,f)=>{const m=Math.max(1,Math.min(24,f));o(d,{hours:m})},c=(d,f)=>{const[m,v]=f.split(":").map(Number);o(d,{startHour:m,startMinute:v||0})},u=Object.entries(n.days).filter(([,d])=>d.active),h=u.length>0&&u.every(([,d])=>d.hours===u[0][1].hours&&d.startHour===u[0][1].startHour&&d.startMinute===u[0][1].startMinute);return J.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[J.jsxs("div",{className:"flex items-center gap-2 mb-6 border-b pb-4",children:[J.jsx(sf,{className:"text-gray-500"}),J.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Esquema de Trabajo"})]}),J.jsxs("div",{className:"flex items-center justify-between mb-4",children:[J.jsxs("div",{children:[J.jsx("p",{className:"font-medium text-gray-800",children:"Operacin Continua (24h)"}),J.jsx("p",{className:"text-sm text-gray-500",children:n.is24h?"El laminador opera las 24 horas, todos los das":"Esquema de trabajo personalizado"})]}),J.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[J.jsx("input",{type:"checkbox",checked:n.is24h,onChange:d=>s(d.target.checked),className:"sr-only peer"}),J.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),!n.is24h&&J.jsxs("div",{className:"mt-4 space-y-3 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[h&&u.length>0&&J.jsx("div",{className:"bg-blue-50 rounded p-2 border border-blue-200 mb-2",children:J.jsx("p",{className:"text-xs text-blue-700",children:" Todos los das activos comparten la misma configuracin. Puedes personalizar cada da individualmente abajo."})}),J.jsx("div",{className:"overflow-x-auto",children:J.jsxs("table",{className:"w-full text-sm",children:[J.jsx("thead",{children:J.jsxs("tr",{className:"border-b border-gray-300",children:[J.jsx("th",{className:"text-left py-2 px-1 text-gray-600 font-medium",children:"Da"}),J.jsx("th",{className:"text-center py-2 px-1 text-gray-600 font-medium",children:"Activo"}),J.jsx("th",{className:"text-center py-2 px-1 text-gray-600 font-medium",children:"Horas"}),J.jsx("th",{className:"text-center py-2 px-1 text-gray-600 font-medium",children:"Inicio"}),J.jsx("th",{className:"text-center py-2 px-1 text-gray-600 font-medium",children:"Fin"})]})}),J.jsx("tbody",{children:hT.map((d,f)=>{const m=n.days[f];return J.jsxs("tr",{className:`border-b border-gray-100 ${m.active?"":"opacity-50"}`,children:[J.jsx("td",{className:"py-2 px-1 font-medium text-gray-800",children:d}),J.jsx("td",{className:"py-2 px-1 text-center",children:J.jsx("input",{type:"checkbox",checked:m.active,onChange:()=>a(f),className:"w-4 h-4 text-blue-600 rounded border-gray-300 cursor-pointer"})}),J.jsx("td",{className:"py-2 px-1 text-center",children:m.active?J.jsx("input",{type:"number",min:1,max:24,value:m.hours,onChange:v=>l(f,parseInt(v.target.value)||16),className:"w-14 px-1 py-0.5 border border-gray-300 rounded text-center text-sm"}):J.jsx("span",{className:"text-gray-400",children:""})}),J.jsx("td",{className:"py-2 px-1 text-center",children:m.active?J.jsx("input",{type:"time",value:pT(m.startHour,m.startMinute),onChange:v=>c(f,v.target.value),className:"px-1 py-0.5 border border-gray-300 rounded text-sm"}):J.jsx("span",{className:"text-gray-400",children:""})}),J.jsx("td",{className:"py-2 px-1 text-center",children:J.jsx("span",{className:"font-mono text-xs text-gray-600",children:fT(m)})})]},f)})})]})}),J.jsxs("div",{className:"bg-blue-50 rounded p-3 border border-blue-200 mt-2",children:[J.jsx("p",{className:"text-sm font-medium text-blue-800 mb-1",children:" Resumen:"}),J.jsx("div",{className:"text-xs text-blue-700 space-y-0.5",children:hT.map((d,f)=>{const m=n.days[f];return m.active?J.jsxs("div",{children:[J.jsx("span",{className:"font-semibold",children:d}),": ",m.hours,"h "," ",J.jsx("span",{className:"font-mono",children:pT(m.startHour,m.startMinute)})," a"," ",J.jsx("span",{className:"font-mono",children:fT(m)})]},f):J.jsxs("div",{className:"text-gray-400",children:[d,": No opera"]},f)})})]})]})]})};class _fe extends st.Component{constructor(t){super(t),this.state={hasError:!1,error:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}render(){return this.state.hasError?J.jsxs("div",{className:"bg-red-50 border border-red-300 rounded-xl p-6",children:[J.jsxs("h3",{className:"text-red-700 font-bold mb-2",children:[" Error en ",this.props.fallbackLabel]}),J.jsxs("pre",{className:"text-xs text-red-600 bg-red-100 p-3 rounded overflow-x-auto whitespace-pre-wrap",children:[this.state.error?.message,`

`,this.state.error?.stack]})]}):this.props.children}}const Efe=()=>{const e=Lr(F=>F.activeProcessId),t=Lr(F=>F.processes[e]);if(!t)return J.jsx("div",{className:"flex items-center justify-center p-12 text-zinc-500 bg-zinc-50/50 rounded-xl border-2 border-dashed border-zinc-200",children:J.jsxs("div",{className:"flex flex-col items-center gap-3",children:[J.jsx("div",{className:"w-8 h-8 border-2 border-indigo-500 border-t-transparent rounded-full animate-spin"}),J.jsx("p",{className:"text-sm font-medium",children:"Cargando configuracin..."})]})});const{stoppageConfigs:r,programStartDate:n,columnLabels:i,schedule:s,manualStops:o,workSchedule:a}=t,{setStoppageConfigs:l,setProgramStartDate:c,importColumnLabels:u,setSchedule:h,setManualStops:d,setWorkSchedule:f}=Lr(),m=Ks(F=>F.getArticles(e)),{setArticles:v}=Ks(),g=aa(F=>F.getRules(e)),{setRules:w}=aa(),y={laminador1:"Laminador 1",laminador2:"Laminador 2",laminador3:"Laminador 3"},C=()=>{const F={version:"1.0",timestamp:new Date().toISOString(),processId:e,processName:y[e]||e,config:{stoppageConfigs:r,programStartDate:n,columnLabels:i,manualStops:o,workSchedule:a},schedule:s,database:{articles:m,changeovers:g}},I=new Blob([JSON.stringify(F,null,2)],{type:"application/json"}),N=URL.createObjectURL(I),j=document.createElement("a");j.href=N;const L=`backup_${y[e]||e}_${new Date().toISOString().slice(0,10)}.json`;j.download=L.replace(/\s+/g,"_"),document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(N)},k=F=>{const I=F.target.files?.[0];if(!I)return;const N=new FileReader;N.onload=j=>{try{const L=JSON.parse(j.target?.result);if(!L.version||!L.config||!L.schedule||!L.database){alert(" Archivo de respaldo invlido. Asegrate de usar un archivo exportado desde esta aplicacin.");return}if(L.config.stoppageConfigs&&l(L.config.stoppageConfigs),L.config.programStartDate&&c(new Date(L.config.programStartDate)),L.config.columnLabels&&u(L.config.columnLabels),L.config.manualStops){const W=L.config.manualStops.map(K=>({...K,start:new Date(K.start)}));d(W)}L.config.workSchedule&&f(L.config.workSchedule),L.schedule&&h(L.schedule),L.database.articles&&v(e,L.database.articles),L.database.changeovers&&w(e,L.database.changeovers),alert(" Datos importados correctamente. La aplicacin se recargar."),setTimeout(()=>window.location.reload(),500)}catch(L){console.error("Error importing backup:",L),alert(" Error al importar el archivo. Verifica que sea un archivo JSON vlido.")}},N.readAsText(I),F.target.value=""};return J.jsx("div",{className:"h-full overflow-y-auto",children:J.jsxs("div",{className:"p-6 max-w-2xl mx-auto space-y-8",children:[J.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[J.jsxs("div",{className:"flex items-center gap-2 mb-6 border-b pb-4",children:[J.jsx(eA,{className:"text-gray-500"}),J.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Copia de Seguridad"})]}),J.jsxs("div",{className:"flex flex-col gap-4",children:[J.jsxs("div",{className:"flex justify-between items-center",children:[J.jsxs("div",{children:[J.jsx("p",{className:"font-medium text-gray-800",children:"Descargar Copia Completa"}),J.jsx("p",{className:"text-sm text-gray-500",children:"Guarda un archivo JSON con toda la programacin, configuracin y bases de datos."})]}),J.jsxs("button",{onClick:C,className:"bg-gray-800 text-white px-4 py-2 rounded shadow hover:bg-gray-900 transition flex items-center gap-2",children:[J.jsx(Fm,{size:18})," Exportar"]})]}),J.jsxs("div",{className:"flex justify-between items-center pt-4 border-t border-gray-200",children:[J.jsxs("div",{children:[J.jsx("p",{className:"font-medium text-gray-800",children:"Importar Copia Completa"}),J.jsx("p",{className:"text-sm text-gray-500",children:"Carga un archivo de respaldo para restaurar todos tus datos."})]}),J.jsxs("label",{className:"bg-green-600 text-white px-4 py-2 rounded shadow hover:bg-green-700 transition flex items-center gap-2 cursor-pointer",children:[J.jsx(WC,{size:18})," Importar",J.jsx("input",{type:"file",accept:".json",onChange:k,className:"hidden"})]})]})]})]}),J.jsx(_fe,{fallbackLabel:"Esquema de Trabajo",children:J.jsx(Sfe,{})}),J.jsx(Cfe,{}),J.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6",children:[J.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-6",children:"Paradas Programadas Manuales"}),J.jsx(xfe,{})]})]})})},Tfe=({collapsed:e,setCollapsed:t})=>{const{activeTab:r,setActiveTab:n}=Lr(),i=[{id:"sequencer",label:"Secuenciador",icon:Sce},{id:"scheduler",label:"Plan Mensual",icon:ice},{id:"visual",label:"Secuencia Diaria",icon:UC},{id:"database",label:"Base de Datos",icon:eA},{id:"settings",label:"Configuracin",icon:Cce}];return J.jsxs("div",{className:`
                bg-white border-r border-gray-200 h-screen flex flex-col transition-all duration-300 z-20 relative
                ${e?"w-16":"w-64"}
            `,children:[J.jsxs("div",{className:"h-16 flex items-center px-4 border-b border-gray-100",children:[J.jsx("div",{className:"bg-[#004DB4] p-2 rounded-lg text-white shrink-0",children:J.jsx(Yle,{size:20})}),!e&&J.jsxs("div",{className:"ml-3 overflow-hidden whitespace-nowrap",children:[J.jsx("h1",{className:"font-bold text-gray-800 text-sm",children:"Laminacin"}),J.jsx("p",{className:"text-xs text-gray-500",children:"Aceros Arequipa"})]})]}),J.jsx("button",{onClick:()=>t(!e),className:"absolute -right-3 top-20 bg-white border border-gray-200 rounded-full p-1 shadow-sm hover:bg-gray-50 text-gray-500 z-30",children:e?J.jsx(jle,{size:14}):J.jsx(Ble,{size:14})}),J.jsx("nav",{className:"flex-1 py-6 px-2 space-y-1",children:i.map(s=>{const o=r===s.id;return J.jsxs("button",{"data-testid":`nav-item-${s.id}`,onClick:()=>n(s.id),title:e?s.label:"",className:`
                                w-full flex items-center px-3 py-3 rounded-lg text-sm font-medium transition-colors
                                ${o?"bg-[#e6f0ff] text-[#004DB4]":"text-gray-500 hover:bg-gray-50 hover:text-gray-900"}
                                ${e?"justify-center":"justify-start"}
                            `,children:[J.jsx(s.icon,{size:20,className:o?"text-[#004DB4]":"text-gray-400"}),!e&&J.jsx("span",{className:"ml-3",children:s.label})]},s.id)})}),J.jsx("div",{className:"p-4 border-t border-gray-100",children:J.jsxs("div",{className:"flex items-center",children:[J.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center text-xs font-bold text-gray-600",children:"AA"}),!e&&J.jsxs("div",{className:"ml-3",children:[J.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Usuario PCP"}),J.jsx("p",{className:"text-xs text-gray-400",children:"Planificador"})]})]})})]})},kfe=[{id:"laminador1",label:"Laminador 1"},{id:"laminador2",label:"Laminador 2"},{id:"laminador3",label:"Laminador 3"}],Rfe=()=>{const e=Lr(r=>r.activeProcessId),t=Lr(r=>r.setActiveProcess);return J.jsxs("div",{className:"flex items-center space-x-2 bg-white p-2 rounded-lg shadow-sm border border-gray-200",children:[J.jsx("span",{className:"text-sm font-medium text-gray-600 mr-2",children:"Proceso:"}),J.jsx("div",{className:"flex space-x-1",children:kfe.map(r=>J.jsx("button",{onClick:()=>t(r.id),className:`
                            px-4 py-2 text-sm font-medium rounded-md transition-colors
                            ${e===r.id?"bg-blue-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}
                        `,children:r.label},r.id))})]})},Afe=({children:e})=>{const[t,r]=ae.useState(!1),n=Lr(s=>s.activeTab),i=()=>{switch(n){case"scheduler":return"Programacin de Produccin";case"sequencer":return"Optimizacin de Secuencia";case"visual":return"Secuencia Diaria";case"database":return"Base de Datos";case"settings":return"Configuracin";default:return""}};return J.jsxs("div",{className:"flex h-screen bg-[#f8f9fa] overflow-hidden",children:[J.jsx(Tfe,{collapsed:t,setCollapsed:r}),J.jsxs("main",{className:"flex-1 overflow-auto transition-all duration-300 relative flex flex-col",children:[J.jsxs("header",{className:"h-16 bg-white border-b border-gray-200 px-6 flex items-center justify-between shrink-0 sticky top-0 z-10",children:[J.jsx("h1",{className:"text-xl font-bold text-slate-800",children:i()}),J.jsx(Rfe,{})]}),J.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:e})]})]})},Ffe=()=>{const{schedule:e}=Lr(r=>r.processes[r.activeProcessId]),t=ae.useMemo(()=>{const r=e.reduce((u,h)=>u+(h.quantity||0),0),n=e.reduce((u,h)=>u+(h.productionTimeMinutes||0),0),i=e.reduce((u,h)=>u+(h.changeoverMinutes||0),0),s=e.reduce((u,h)=>{const d=h.stoppages?Object.values(h.stoppages).reduce((f,m)=>f+m,0):0;return u+d},0),o=n+i+s,a=o>0?n/o*100:0,l=n>0||i>0,c=e.filter(u=>(u.changeoverMinutes||0)>60).length;return{totalTons:r,efficiency:a,criticalAlerts:c,hasSimulatedData:l}},[e]);return J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[J.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm flex items-start justify-between",children:[J.jsxs("div",{children:[J.jsx("h3",{className:"text-gray-500 text-xs font-semibold uppercase tracking-wider",children:"Tonelaje Total"}),J.jsxs("div",{className:"mt-1 flex items-baseline gap-2",children:[J.jsx("span",{className:"text-2xl font-bold text-gray-900",children:t.totalTons.toLocaleString()}),J.jsx("span",{className:"text-sm text-gray-400",children:"Ton"})]})]}),J.jsx("div",{className:"p-2 bg-blue-50 rounded-lg text-[#004DB4]",children:J.jsx(Vce,{size:20})})]}),J.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm flex items-start justify-between",children:[J.jsxs("div",{children:[J.jsx("h3",{className:"text-gray-500 text-xs font-semibold uppercase tracking-wider",children:"Eficiencia Est."}),J.jsxs("div",{className:"mt-1 flex items-baseline gap-2",children:[J.jsx("span",{className:"text-2xl font-bold text-gray-900",children:t.hasSimulatedData?`${t.efficiency.toFixed(1)}%`:""}),J.jsx("span",{className:`text-xs font-medium px-2 py-0.5 rounded-full ${t.hasSimulatedData?t.efficiency>85?"bg-green-100 text-green-700":"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-500"}`,children:t.hasSimulatedData?t.efficiency>85?"ptimo":"Revisar":"Sin Simular"})]})]}),J.jsx("div",{className:"p-2 bg-indigo-50 rounded-lg text-indigo-600",children:J.jsx(Ice,{size:20})})]}),J.jsxs("div",{className:"bg-white p-4 rounded-xl border border-gray-200 shadow-sm flex items-start justify-between",children:[J.jsxs("div",{children:[J.jsx("h3",{className:"text-gray-500 text-xs font-semibold uppercase tracking-wider",children:"Alertas Crticas"}),J.jsxs("div",{className:"mt-1 flex items-baseline gap-2",children:[J.jsx("span",{className:"text-2xl font-bold text-gray-900",children:t.criticalAlerts}),J.jsx("span",{className:"text-sm text-gray-400",children:"Cambios Largos"})]})]}),J.jsx("div",{className:`p-2 rounded-lg ${t.criticalAlerts>0?"bg-red-50 text-red-600":"bg-green-50 text-green-600"}`,children:J.jsx(Nce,{size:20})})]})]})},mT=Em((e,t)=>({sapData:{},loading:!1,fetchSapData:async()=>{e({loading:!0});const{data:r}=await Yt.from("sap_plan_inventario_hibrido").select("sku_id, descripcion, stock_actual, adu_diario_l30d, adu_hibrido_final"),{data:n,error:i}=await Yt.from("sap_reporte_maestro").select("sku_id, descripcion, stock_hoy, stock_fin_mes, po_mes_actual, projected_venta_consumo");i&&console.error("Error fetching SAP reporte maestro:",i);const s={};r?.forEach(o=>{const a=Number(o.adu_hibrido_final||o.adu_diario_l30d||0),l=Number(o.stock_actual||0);s[o.sku_id]={sku_id:o.sku_id,descripcion:o.descripcion||"",stock_hoy:l,stock_fin_mes:l,po_mes_actual:0,projected_venta_consumo:a*30,venta_diaria:a}}),n?.forEach(o=>{const a=Number(o.projected_venta_consumo||0),l=a/30;s[o.sku_id]={...s[o.sku_id]||{},sku_id:o.sku_id,descripcion:o.descripcion||s[o.sku_id]?.descripcion||"",stock_hoy:Number(o.stock_hoy||0),stock_fin_mes:Number(o.stock_fin_mes||0),po_mes_actual:Number(o.po_mes_actual||0),projected_venta_consumo:a,venta_diaria:l||s[o.sku_id]?.venta_diaria||0}}),e({sapData:s,loading:!1})},getSapItem:r=>t().sapData[r]})),Mfe=({stats:e,onClose:t})=>{const r=ae.useMemo(()=>{const n=[];e.avgChangeoverTime<30?n.push(` **Eficiencia Alta:** El tiempo promedio de cambio se redujo a ${e.avgChangeoverTime.toFixed(1)} min, lo cual es excelente.`):e.avgChangeoverTime>60?n.push(` **Atencin:** Los cambios promedian ${e.avgChangeoverTime.toFixed(1)} min. Se recomienda revisar agrupacin de calibres.`):n.push(` **Estabilidad:** La secuencia mantiene un flujo estndar con cambios de ~${e.avgChangeoverTime.toFixed(1)} min.`),e.totalTonnage>500&&n.push(` **Alto Volumen:** Se han programado ${e.totalTonnage.toFixed(0)} TN. La secuencia minimiza cortes para sostener este ritmo.`);const i=["Se priorizaron los pedidos con mayor dimetro al inicio para aprovechar la inercia trmica.","Los cambios de ancho se agruparon para reducir el desperdicio de ajuste en un 15%.","Se detect compatibilidad metalrgica entre los lotes principales, permitiendo secuencias ms largas."];return e.changeovers<5?n.push(` **Estrategia Aplicada:** ${i[2]}`):n.push(` **Estrategia Aplicada:** ${i[1]}`),n},[e]);return J.jsxs("div",{className:"bg-gradient-to-r from-indigo-50 to-blue-50 border border-indigo-100 rounded-xl p-4 shadow-lg mb-4 relative animate-in fade-in slide-in-from-top-4 duration-500",children:[J.jsx("button",{onClick:t,className:"absolute top-2 right-2 text-gray-400 hover:text-gray-600 transition-colors",children:J.jsx(rA,{size:18})}),J.jsxs("div",{className:"flex items-start gap-4",children:[J.jsx("div",{className:"bg-white p-2 rounded-full shadow-sm text-indigo-600 mt-1",children:J.jsx(ace,{size:24})}),J.jsxs("div",{className:"flex-1",children:[J.jsxs("h3",{className:"text-sm font-bold text-indigo-900 uppercase tracking-wide mb-2 flex items-center gap-2",children:["Antigravity AI Insight",J.jsx("span",{className:"text-[10px] bg-indigo-100 text-indigo-700 px-2 py-0.5 rounded-full border border-indigo-200",children:"BETA"})]}),J.jsx("div",{className:"space-y-2",children:r.map((n,i)=>J.jsx("p",{className:"text-slate-700 text-sm leading-relaxed",dangerouslySetInnerHTML:{__html:n.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>")}},i))})]})]})]})},Dfe=({scenarios:e,activeId:t,onSelect:r})=>{const[n,i]=st.useState(null),s=e.filter(c=>c.result).map(c=>{const u=c.result,h=(u.costoVentaPerdida||0)/10,d=(u.costoTiempoCambio||0)/10,f=h+d;return{label:c.label,id:c.id,cvp:h,ctc:d,total:f,toneladasPerdidas:u.ventaPerdidaTotal||0,horasCambio:u.tiempoTotalCambio||0}});if(s.length===0)return null;const o=Math.max(...s.map(c=>c.total),1),a=(c,u=0)=>c.toLocaleString(void 0,{maximumFractionDigits:u,minimumFractionDigits:u}),l=c=>`$${a(c,0)}`;return J.jsxs("div",{className:"bg-white p-6 md:p-10 rounded-[2rem] border border-slate-200 shadow-2xl mb-8 animate-in fade-in slide-in-from-top-4 duration-700",children:[J.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-12 text-left",children:[J.jsxs("div",{className:"flex items-center gap-4",children:[J.jsx("div",{className:"p-3 bg-[#004DB4] rounded-2xl text-white shadow-xl shadow-blue-100 ring-4 ring-blue-50",children:J.jsx(Q8,{size:24})}),J.jsxs("div",{children:[J.jsx("h3",{className:"text-xl font-black text-slate-800 uppercase tracking-tight",children:"Balance Econmico"}),J.jsx("p",{className:"text-[10px] text-slate-400 font-bold uppercase tracking-[0.2em] mt-1 opacity-70",children:"Prdida por Venta vs Costo de Cambio"})]})]}),J.jsxs("div",{className:"flex flex-wrap gap-6 bg-slate-50/80 backdrop-blur-sm p-4 rounded-2xl border border-slate-100/50",children:[J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500 shadow-sm shadow-blue-200 animate-pulse"}),J.jsx("span",{className:"text-[11px] font-black text-slate-500 uppercase",children:"Venta Perdida"})]}),J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("div",{className:"w-3 h-3 rounded-full bg-orange-400 shadow-sm shadow-orange-200"}),J.jsx("span",{className:"text-[11px] font-black text-slate-500 uppercase",children:"Tiempo Cambio"})]})]})]}),J.jsxs("div",{className:"relative h-72 w-full flex items-end justify-around px-2 md:px-12 pt-10",children:[J.jsx("div",{className:"absolute inset-x-8 inset-y-0 flex flex-col justify-between py-2 pointer-events-none",children:[0,25,50,75,100].map(c=>J.jsx("div",{className:"w-full border-t border-slate-100 border-dashed relative"},c))}),s.map(c=>{const u=c.total/o*100,h=c.total>0?c.cvp/c.total*100:0,d=c.total>0?c.ctc/c.total*100:0,f=t===c.id,m=n===c.id;return J.jsxs("div",{className:"flex-1 flex flex-col items-center group relative h-full justify-end max-w-[200px] gap-6",onMouseEnter:()=>i(c.id),onMouseLeave:()=>i(null),children:[m&&J.jsxs("div",{className:"absolute bottom-full mb-6 z-50 bg-slate-900 text-white rounded-2xl shadow-2xl p-4 w-56 pointer-events-none animate-in fade-in zoom-in-95 duration-150",children:[J.jsx("div",{className:"absolute -bottom-2 left-1/2 -translate-x-1/2 w-4 h-2 overflow-hidden",children:J.jsx("div",{className:"w-3 h-3 bg-slate-900 rotate-45 translate-y-[-6px] translate-x-[2px]"})}),J.jsx("p",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400 mb-3 text-center",children:c.label}),J.jsxs("div",{className:"flex items-start gap-3 mb-3 bg-blue-900/30 rounded-xl p-2.5",children:[J.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-blue-400 mt-0.5 shrink-0 shadow-sm shadow-blue-400/50"}),J.jsxs("div",{className:"flex-1",children:[J.jsx("p",{className:"text-[9px] font-black uppercase tracking-wider text-blue-300 mb-1",children:"Venta Perdida"}),J.jsxs("p",{className:"text-sm font-black text-white leading-none",children:[a(c.toneladasPerdidas,2)," ",J.jsx("span",{className:"text-[10px] font-bold text-blue-300",children:"Tn"})]}),J.jsx("p",{className:"text-[11px] font-bold text-blue-300 mt-0.5",children:l(c.cvp)})]})]}),J.jsxs("div",{className:"flex items-start gap-3 bg-orange-900/30 rounded-xl p-2.5",children:[J.jsx("div",{className:"w-2.5 h-2.5 rounded-full bg-orange-400 mt-0.5 shrink-0 shadow-sm shadow-orange-400/50"}),J.jsxs("div",{className:"flex-1",children:[J.jsx("p",{className:"text-[9px] font-black uppercase tracking-wider text-orange-300 mb-1",children:"Tiempo de Cambio"}),J.jsxs("p",{className:"text-sm font-black text-white leading-none",children:[a(c.horasCambio,1)," ",J.jsx("span",{className:"text-[10px] font-bold text-orange-300",children:"h"})]}),J.jsx("p",{className:"text-[11px] font-bold text-orange-300 mt-0.5",children:l(c.ctc)})]})]}),J.jsxs("div",{className:"mt-3 pt-3 border-t border-slate-700 flex justify-between items-center",children:[J.jsx("span",{className:"text-[9px] font-black uppercase tracking-wider text-slate-400",children:"Total"}),J.jsx("span",{className:"text-sm font-black text-white",children:l(c.total)})]})]}),J.jsxs("div",{className:`w-20 md:w-28 relative flex flex-col justify-end transition-all duration-700 ease-[cubic-bezier(0.34,1.56,0.64,1)] group-hover:scale-110 group-hover:-translate-y-2 cursor-pointer ${f?"scale-105 ring-4 ring-blue-500/20 rounded-b-xl":"opacity-80"}`,onClick:()=>r?.(c.id),style:{height:`${Math.max(u,4)}%`},children:[J.jsx("div",{className:"absolute -top-10 left-0 right-0 text-center",children:J.jsxs("span",{className:"text-[11px] font-black text-slate-800 bg-white px-3 py-1.5 rounded-full border border-slate-100 shadow-lg whitespace-nowrap",children:["$",c.total.toLocaleString(void 0,{maximumFractionDigits:0})]})}),J.jsx("div",{className:"w-full bg-gradient-to-t from-orange-500 to-orange-400 rounded-t-xl relative z-10 transition-all duration-500 shadow-lg group-hover:shadow-orange-200",style:{height:`${d}%`},children:d>20&&J.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:J.jsxs("span",{className:"text-[9px] font-black text-white/90 uppercase [writing-mode:vertical-lr] rotate-180",children:[d.toFixed(0),"% TC"]})})}),J.jsx("div",{className:`w-full bg-gradient-to-t from-blue-700 to-blue-500 relative z-10 transition-all duration-500 shadow-lg group-hover:shadow-blue-200 ${d<1?"rounded-t-xl":""}`,style:{height:`${h}%`},children:h>20&&J.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:J.jsxs("span",{className:"text-[9px] font-black text-white/90 uppercase [writing-mode:vertical-lr] rotate-180 text-nowrap",children:[h.toFixed(0),"% VP"]})})}),J.jsx("div",{className:"absolute -bottom-4 left-1/2 -translate-x-1/2 w-4/5 h-2 bg-slate-900/10 rounded-full blur-[4px] scale-x-90 opacity-40"})]}),J.jsxs("div",{className:"flex flex-col items-center gap-2",children:[J.jsx("span",{className:`text-[11px] font-black uppercase tracking-tighter text-center transition-colors duration-300 ${f?"text-blue-700":"text-slate-400 group-hover:text-slate-600"}`,children:c.label}),f&&J.jsx("div",{className:"w-8 h-1 bg-blue-600 rounded-full shadow-lg shadow-blue-200 animate-in zoom-in slide-in-from-bottom-2"})]})]},c.id)})]})]})},Pfe=()=>{const e=Lr(S=>S.activeProcessId),t=Lr(S=>S.processes[e]),r=Lr(S=>S.addScheduleItems),n=Lr(S=>S.setSchedule),i=Lr(S=>S.recalculateSchedule),s=Ks(S=>S.articlesByProcess[e]||[]),o=aa(S=>S.rulesByProcess[e]||[]),a=Lr(S=>S.saveSequencerConfig),[l,c]=ae.useState([]),[u,h]=ae.useState({balanced:{id:"balanced",label:"Equilibrado",result:null,status:"idle",progress:0},min_lost_sales:{id:"min_lost_sales",label:"Mn. Venta Perdida",result:null,status:"idle",progress:0},min_changeovers:{id:"min_changeovers",label:"Mn. Tiempos de Cambio",result:null,status:"idle",progress:0}}),[d,f]=ae.useState("balanced"),m=ae.useMemo(()=>Object.values(u).some(S=>S.status==="calculating"),[u]),v=ae.useMemo(()=>{const S=Object.values(u);return Math.round(S.reduce((_,T)=>_+T.progress,0)/S.length)},[u]),g=u[d]?.result,w=ae.useRef({balanced:null,min_lost_sales:null,min_changeovers:null}),[y,C]=ae.useState({poblacion:100,generaciones:250,pesoVenta:.5,costoVP:100,costoTC:5e3,tasaMutacion:.15,tasaElitismo:.1});ae.useEffect(()=>()=>{Object.values(w.current).forEach(S=>S?.terminate())},[]);const k=ae.useMemo(()=>{const S=l.map(_=>String(_.idTablaCambioMedida||"").trim()).filter(_=>_&&_!=="S/N"&&_!=="0"&&_!=="-1");return Array.from(new Set(S)).sort()},[l]),F=mT(S=>S.fetchSapData),I=mT(S=>S.sapData);ae.useEffect(()=>{F()},[]);const N=ae.useRef(!1),j=ae.useRef(null),L=t?.sequencerConfig;ae.useEffect(()=>{L&&(j.current===e&&N.current||(N.current=!0,j.current=e,c(L.draftItems||[]),L.params&&C(L.params),L.scenarios&&h(L.scenarios),L.activeScenarioId&&f(L.activeScenarioId)))},[L,e]);const W=ae.useRef(!1);ae.useEffect(()=>{Object.keys(I).length!==0&&(W.current||(W.current=!0,c(S=>S.length===0?S:S.map(_=>{const T=I[_.skuCode];if(!T)return _;const E=T.stock_fin_mes,D=T.venta_diaria,O=D>0?E/D:999;return{..._,stockInicial:E,ventaDiaria:D,diasStock:O,poMes:T.po_mes_actual}}))))},[I]),ae.useEffect(()=>{const S=setTimeout(()=>{!N.current||e!==j.current||a({draftItems:l,params:y,lastResult:g,scenarios:u,activeScenarioId:d})},1500);return()=>clearTimeout(S)},[l,y,u,d,g,a,e]);const K=S=>{const _=S.clipboardData.getData("text");if(!_)return;const E=_.split(/\r?\n/).filter(D=>D.trim()!=="").map(D=>{const O=D.split("	");if(O.length<2)return null;const P=String(O[0]||"").trim(),q=(O.length>=3?O[2]:O[1])||"0",X=Number(q.replace(/[^\d.-]/g,""));if(!P||isNaN(X))return null;const Q=s.find(te=>String(te.codigoProgramacion||"").trim()===P||String(te.skuLaminacion||"").trim()===P),G=I[P]||Q&&(I[Q.codigoProgramacion||""]||I[Q.skuLaminacion||""]),ee=Q?.ritmoTH||0,V=ee>0?X/ee/24:0,H=G?.venta_diaria||0,Z=G?.stock_fin_mes||0,ie=H>0?Z/H:999;return{id:crypto.randomUUID(),skuCode:P,description:Q?.descripcion||G?.descripcion||"SKU No Encontrado en Maestro",quantity:X,idTablaCambioMedida:Q?.idTablaCambioMedida||"S/N",ritmo:ee,stockInicial:Z,ventaDiaria:H,diasStock:ie,diasFabricacion:V,poMes:G?.po_mes_actual||0}}).filter(Boolean);E.length>0&&c([...l,...E])},z=()=>{if(l.length===0){alert("No hay tems para optimizar. Importa SKUs primero.");return}const S={};k.forEach((Q,G)=>{S[Q]=G});const _=k.length,T=Array(_).fill(0).map(()=>Array(_).fill(0));o.forEach(Q=>{const G=String(Q.fromId||"").trim(),ee=String(Q.toId||"").trim(),V=S[G],H=S[ee];V!==void 0&&H!==void 0&&(T[V][H]=Number(Q.durationHours)||0)});const E=l.map(Q=>Q.quantity),D=l.map(Q=>Q.ventaDiaria),O=l.map(Q=>Q.diasStock),P=l.map(Q=>Q.diasFabricacion),q=l.map(Q=>{const G=String(Q.idTablaCambioMedida||"").trim(),ee=S[G];return ee!==void 0?ee:-1}),X=(Q,G)=>{h(V=>({...V,[Q]:{...V[Q],status:"calculating",progress:0}})),w.current[Q]&&w.current[Q]?.terminate();const ee=new Worker(new URL("/scheduler-app/assets/sequencerWorker-Ns8l9TN-.js",import.meta.url),{type:"module"});w.current[Q]=ee,ee.onmessage=V=>{const{type:H,progress:Z,result:ie}=V.data;H==="progress"?h(te=>({...te,[Q]:{...te[Q],progress:Z}})):H==="complete"&&(h(te=>({...te,[Q]:{...te[Q],status:"completed",progress:100,result:ie}})),ee.terminate(),w.current[Q]=null)},ee.postMessage({type:"run",params:{matrizCambioMedida:T,ventaDiaria:D,diasStock:O,diasFabricacion:P,tamanoLote:E,produccionTn:E,skus:l.map(V=>V.skuCode),descripciones:l.map(V=>V.description),ids:l.map(V=>V.id),idCambios:q,originalIdCambios:l.map(V=>V.idTablaCambioMedida),horasDia:24,pesoVenta:G,costoToneladaPerdida:y.costoVP,costoHoraCambio:y.costoTC,tamanoPoblacion:y.poblacion,numGeneraciones:y.generaciones,tasaMutacion:y.tasaMutacion,tasaElitismo:y.tasaElitismo}})};X("balanced",y.pesoVenta),X("min_lost_sales",1),X("min_changeovers",0)},M=S=>{if(!g)return;const _=g.secuencia.map((T,E)=>{const D=g.params_ids[T.sku],O=l.find(P=>P.id===D);return{id:crypto.randomUUID(),skuCode:O?.skuCode||"",quantity:O?.quantity||0,sequenceOrder:E+(S==="append"?t.schedule.length:0),stoppages:{}}});S==="replace"?n(_):r(_),i(),alert(`Secuencia ${S==="replace"?"reemplazada":"aadida"} correctamente al Plan Mensual!`),h(T=>{const E={...T};return Object.keys(E).forEach(D=>{E[D]={...E[D],result:null,status:"idle",progress:0}}),E}),c([])},B=()=>{if(s.length===0){alert("El Maestro de Artculos est vaco. Importa los artculos del laminador primero.");return}let S=0;const _=l.map(T=>{const E=s.find(D=>String(D.codigoProgramacion||"").trim()===T.skuCode||String(D.skuLaminacion||"").trim()===T.skuCode);return E?(S++,{...T,description:E.descripcion||T.description,idTablaCambioMedida:E.idTablaCambioMedida||"S/N",ritmo:E.ritmoTH||T.ritmo,diasFabricacion:(E.ritmoTH||0)>0?T.quantity/(E.ritmoTH||1)/24:T.diasFabricacion}):T});c(_),alert(` Actualizados ${S} de ${l.length} tems con el maestro de L${e.replace("laminador","")}.`)},R=()=>{if(!g?.secuencia)return;const S=g.secuencia.map((D,O)=>{const P=D.sku,q=g.params_ids[P],X=l.find(G=>G.id===q),Q=g.tiemposCambio&&g.tiemposCambio[O]>0?g.tiemposCambio[O]:0;return{Orden:O+1,SKU:g.params_skus[P],Descripcin:g.params_desc[P],"Cant. (TN)":g.params_cant[P],"T. Cambio (H)":Q,"Stock Inicial":X?.stockInicial||0,"Venta Diaria":X?.ventaDiaria||0,"Das Stock":X?.diasStock||0,"Das Fab.":X?.diasFabricacion||0,"ID Cambio":X?.idTablaCambioMedida||"S/N"}}),_=_s.json_to_sheet(S),T=_s.book_new();_s.book_append_sheet(T,_,"Secuencia Optimizada");const E=[{wch:8},{wch:12},{wch:40},{wch:12},{wch:15},{wch:15},{wch:12},{wch:12},{wch:12},{wch:10}];_["!cols"]=E,BC(T,`Secuencia_Optimizada_${e}.xlsx`)};return J.jsxs("div",{className:"flex flex-col gap-6 p-2 h-full overflow-y-auto outline-none",onPaste:K,tabIndex:0,children:[J.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-200",children:[J.jsxs("div",{className:"flex justify-between items-start mb-6",children:[J.jsxs("div",{children:[J.jsx("h2",{className:"text-xl font-bold text-gray-800 tracking-tight flex items-center gap-2",children:"Optimizacin de Secuencia"}),J.jsx("p",{className:"text-sm text-gray-500",children:"Importa SKUs, optimiza el orden y envalos al Plan Mensual"})]}),J.jsxs("div",{className:"flex gap-3",children:[J.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-blue-50 border border-blue-200 text-blue-700 rounded-lg shadow-sm text-xs font-black animate-pulse uppercase tracking-widest",children:[J.jsx(Gb,{size:14})," Pega con Ctrl+V"]}),J.jsxs("button",{onClick:B,disabled:l.length===0,className:`flex items-center gap-2 px-4 py-2 rounded-lg font-bold transition-all shadow-sm border text-sm ${l.length===0?"text-gray-300 border-gray-100":"text-emerald-600 border-emerald-200 hover:bg-emerald-50"}`,title:"Re-mapear SKUs con el Maestro de Artculos del laminador activo",children:[J.jsx(pce,{size:15}),"Sincronizar"]}),J.jsx("button",{onClick:()=>{c([]),h(S=>{const _={...S};return Object.keys(_).forEach(T=>{_[T]={..._[T],result:null,status:"idle",progress:0}}),_})},className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors border border-red-100 shadow-sm",title:"Limpiar todo",children:J.jsx(sl,{size:20})}),J.jsx("div",{className:"h-10 w-px bg-gray-200 mx-1"}),J.jsxs("button",{onClick:z,disabled:m||l.length===0,className:`flex items-center gap-2 px-6 py-2.5 rounded-lg font-bold transition-all shadow-md ${m||l.length===0?"bg-gray-100 text-gray-400":"bg-[#004DB4] text-white hover:bg-[#003d91]"}`,children:[m?J.jsx(tA,{className:"animate-spin",size:18}):J.jsx(dce,{size:18}),m?"Calculando...":"Optimizar"]})]})]}),J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:[J.jsxs("div",{className:"space-y-4",children:[J.jsxs("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-2",children:[J.jsx(wce,{size:14})," Configuracin Algoritmo"]}),J.jsx("div",{className:"grid grid-cols-1 gap-3",children:J.jsxs("div",{children:[J.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase",children:"Poblacin (Max 30s)"}),J.jsx("input",{type:"number",value:y.poblacion,onChange:S=>C({...y,poblacion:parseInt(S.target.value)}),className:"mt-1 block w-full px-3 py-1.5 bg-gray-50 border border-gray-200 rounded text-sm outline-none"})]})})]}),J.jsxs("div",{className:"space-y-4",children:[J.jsxs("span",{className:"text-xs font-bold text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-2",children:[J.jsx(Q8,{size:14})," Priorizacin"]}),J.jsxs("div",{className:"flex items-center justify-between mb-2",children:[J.jsx("span",{className:"text-[10px] font-bold text-blue-600 uppercase",children:"T. Cambio"}),J.jsxs("span",{className:"text-xs font-black text-gray-700",children:[(1-y.pesoVenta).toFixed(1)," / ",y.pesoVenta.toFixed(1)]}),J.jsx("span",{className:"text-[10px] font-bold text-red-600 uppercase",children:"V. Perdida"})]}),J.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",value:y.pesoVenta,onChange:S=>C({...y,pesoVenta:parseFloat(S.target.value)}),className:"w-full h-1.5 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-blue-600"})]}),J.jsxs("div",{className:"border-l border-gray-100 pl-6 flex flex-col justify-center gap-2",children:[J.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[J.jsx("div",{className:"w-32 text-gray-400 font-bold uppercase text-[10px]",children:"Items Borrador:"}),J.jsx("div",{className:"font-black text-blue-600",children:l.length})]}),J.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[J.jsx("div",{className:"w-32 text-gray-400 font-bold uppercase text-[10px]",children:"Total TN Borrador:"}),J.jsxs("div",{className:"font-black text-orange-600",children:[l.reduce((S,_)=>S+_.quantity,0).toLocaleString()," TN"]})]}),J.jsxs("div",{className:"flex items-center gap-3 text-sm",children:[J.jsx("div",{className:"w-32 text-gray-400 font-bold uppercase text-[10px]",children:"Medidas Matriz:"}),J.jsx("div",{className:"font-black text-green-600",children:k.length})]})]})]})]}),m?J.jsx("div",{className:"flex-1 bg-white p-12 rounded-xl shadow-sm border border-gray-200 flex flex-col items-center justify-center min-h-[400px]",children:J.jsxs("div",{className:"relative w-40 h-40 flex items-center justify-center mb-8",children:[J.jsxs("svg",{className:"w-full h-full transform -rotate-90",children:[J.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"currentColor",strokeWidth:"10",fill:"transparent",className:"text-gray-100"}),J.jsx("circle",{cx:"80",cy:"80",r:"70",stroke:"currentColor",strokeWidth:"10",fill:"transparent",className:"text-blue-600 transition-all duration-300",strokeDasharray:Math.PI*140,strokeDashoffset:Math.PI*140*(1-v/100),strokeLinecap:"round"})]}),J.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[J.jsxs("span",{className:"text-4xl font-black text-gray-800",children:[v,"%"]}),J.jsx("span",{className:"text-[10px] font-bold text-blue-600 uppercase tracking-widest mt-1",children:"SOTA ILS/Memtico"}),J.jsx("span",{className:"text-[9px] font-bold text-gray-400 uppercase tracking-widest leading-none mt-0.5",children:"Max ~30s"})]})]})}):g?J.jsxs("div",{className:"space-y-6 pb-12 animate-in slide-in-from-bottom-4",children:[J.jsx("div",{className:"bg-white/40 backdrop-blur-md p-1.5 rounded-2xl border border-white/50 shadow-sm flex gap-2",children:Object.values(u).map(S=>J.jsxs("button",{onClick:()=>f(S.id),className:`flex-1 p-4 rounded-xl transition-all relative overflow-hidden group border ${d===S.id?"bg-white border-blue-200 shadow-md ring-1 ring-blue-500/10":"hover:bg-white/50 border-transparent text-gray-400"}`,children:[J.jsxs("div",{className:"flex flex-col gap-1 relative z-10 text-left",children:[J.jsx("span",{className:`text-[10px] font-black uppercase tracking-tighter ${d===S.id?"text-blue-600":"text-gray-400"}`,children:S.label}),S.result&&J.jsxs("div",{className:"flex flex-col gap-2",children:[J.jsxs("div",{className:"flex items-center justify-between",children:[J.jsxs("span",{className:"text-lg font-black text-gray-800",children:["$",Math.abs(S.result.costoTotal/10).toLocaleString()]}),J.jsxs("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded ${d===S.id?"bg-blue-50 text-blue-600":"bg-gray-100 text-gray-400"}`,children:[(S.result.tiempoProduccionTotal*24/(S.result.tiempoProduccionTotal*24+S.result.tiempoTotalCambio)*100).toFixed(1),"% Efi"]})]}),J.jsxs("div",{className:"flex items-center gap-2 text-[9px] font-bold text-gray-400 uppercase tracking-tighter",children:[J.jsx(sf,{size:10,className:"text-orange-400"}),"T. Cambio: ",J.jsxs("span",{className:"text-orange-600",children:[S.result.tiempoTotalCambio.toFixed(1),"h"]})]})]})]}),d===S.id&&J.jsx("div",{className:"absolute top-0 right-0 p-2 text-blue-500",children:J.jsx(QE,{size:16})})]},S.id))}),J.jsx(Dfe,{scenarios:Object.values(u),activeId:d,onSelect:f}),J.jsx(Mfe,{stats:{totalTime:g.tiempoProduccionTotal*24+g.tiempoTotalCambio,totalTonnage:g.params_cant.reduce((S,_)=>S+_,0),changeovers:g.secuencia.length,avgChangeoverTime:g.tiempoTotalCambio/g.secuencia.length*60},onClose:()=>{}}),J.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[J.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm relative overflow-hidden group",children:[J.jsx("div",{className:"absolute top-0 right-0 p-3 text-violet-50 group-hover:text-violet-100 transition-colors",children:J.jsx(cce,{size:40})}),J.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest block",children:"Total TN"}),J.jsxs("div",{className:"text-xl font-black text-violet-700",children:[g.params_cant?g.params_cant.reduce((S,_)=>S+_,0).toLocaleString():"-"," TN"]}),J.jsxs("div",{className:"text-[9px] text-gray-400 mt-1",children:["Borrador: ",J.jsxs("span",{className:"font-bold text-orange-600",children:[l.reduce((S,_)=>S+_.quantity,0).toLocaleString()," TN"]})]})]}),J.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm relative overflow-hidden group",children:[J.jsx("div",{className:"absolute top-0 right-0 p-3 text-blue-50 group-hover:text-blue-100 transition-colors",children:J.jsx(sf,{size:40})}),J.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest block",children:"T. Cambio Muerto"}),J.jsxs("div",{className:"text-2xl font-black text-blue-600",children:[g.tiempoTotalCambio.toFixed(1)," h"]})]}),J.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm relative overflow-hidden group",children:[J.jsx("div",{className:"absolute top-0 right-0 p-3 text-green-50 group-hover:text-green-100 transition-colors",children:J.jsx(rce,{size:40})}),J.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest block",children:"Eficiencia"}),J.jsxs("div",{className:"text-2xl font-black text-green-600",children:[(g.tiempoProduccionTotal*24/(g.tiempoProduccionTotal*24+g.tiempoTotalCambio)*100).toFixed(1),"%"]})]}),J.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm relative overflow-hidden group",children:[J.jsx("div",{className:"absolute top-0 right-0 p-3 text-orange-50 group-hover:text-orange-100 transition-colors",children:J.jsx(Dce,{size:40})}),J.jsx("span",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-widest block",children:"Impacto Econmico"}),J.jsxs("div",{className:"text-2xl font-black text-orange-600",children:["$",Math.abs(g.costoTotal/10).toLocaleString()]})]}),J.jsxs("div",{className:"bg-gradient-to-br from-[#004DB4] to-[#003d91] p-5 rounded-xl shadow-lg flex flex-col justify-center items-center text-white gap-3 group relative overflow-hidden",children:[J.jsxs("div",{className:"flex gap-2 w-full relative z-10",children:[J.jsxs("button",{onClick:()=>M("append"),className:"flex-1 bg-white/10 hover:bg-white/20 p-2 rounded text-[10px] font-bold uppercase transition-all flex flex-col items-center gap-1",children:[J.jsx(kc,{size:14})," Aadir"]}),J.jsxs("button",{onClick:()=>M("replace"),className:"flex-1 bg-white/20 hover:bg-white/30 p-2 rounded text-[10px] font-bold uppercase transition-all flex flex-col items-center gap-1",children:[J.jsx(Tle,{size:14})," Reemplazar"]})]}),J.jsx("span",{className:"text-[8px] font-black uppercase tracking-widest opacity-70",children:"Sincronizar con Plan"}),J.jsx(sf,{className:"absolute -bottom-4 -right-4 text-white/10 w-20 h-20 rotate-12"})]})]}),J.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[J.jsxs("div",{className:"px-5 py-3 bg-slate-50 border-b border-gray-200 flex justify-between items-center",children:[J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx("span",{className:"text-xs font-bold text-slate-500 uppercase tracking-widest",children:"Secuencia Optimizada"}),J.jsx(QE,{size:16,className:"text-green-500"})]}),J.jsxs("button",{onClick:R,className:"flex items-center gap-2 px-3 py-1.5 bg-white border border-slate-200 rounded-lg text-[10px] font-black uppercase text-slate-600 hover:bg-slate-50 hover:text-blue-600 transition-all shadow-sm",children:[J.jsx(Fm,{size:14}),"Exportar Excel"]})]}),J.jsx("div",{className:"overflow-x-auto overflow-y-auto max-h-[600px] scroll-smooth custom-scrollbar",children:J.jsxs("table",{className:"w-full text-left text-sm relative border-separate border-spacing-0",children:[J.jsx("thead",{className:"sticky top-0 z-10 bg-slate-50 shadow-sm",children:J.jsxs("tr",{children:[J.jsx("th",{className:"px-6 py-3 border-b border-slate-200",children:"Orden"}),J.jsx("th",{className:"px-6 py-3 border-b border-slate-200",children:"SKU"}),J.jsx("th",{className:"px-6 py-3 border-b border-slate-200",children:"Descripcin"}),J.jsx("th",{className:"px-6 py-3 border-b border-slate-200 text-right",children:"Cant. (Tn)"}),J.jsx("th",{className:"px-6 py-3 border-b border-slate-200 text-right text-orange-600",children:"T. Cambio (h)"}),J.jsx("th",{className:"px-6 py-3 border-b border-slate-200 text-right",children:"Stock"}),J.jsx("th",{className:"px-6 py-3 border-b border-slate-200 text-right",children:"Venta D."}),J.jsx("th",{className:"px-6 py-3 border-b border-slate-200 text-right",children:"Cobertura"}),J.jsx("th",{className:"px-6 py-3 border-b border-slate-200 text-right",children:"Das Fab."}),J.jsx("th",{className:"px-6 py-3 border-b border-slate-200",children:"ID Cambio"})]})}),J.jsx("tbody",{children:g.secuencia.map((S,_)=>{const T=S.sku,E=g.params_ids[T],D=l.find(O=>O.id===E);return J.jsxs("tr",{className:"border-b border-slate-100 hover:bg-blue-50/30 transition-colors group",children:[J.jsx("td",{className:"px-6 py-3 font-bold text-slate-400",children:_+1}),J.jsx("td",{className:"px-6 py-3 font-bold text-slate-800 tracking-tight",children:g.params_skus[T]}),J.jsx("td",{className:"px-6 py-3 text-slate-500 uppercase text-[10px] font-medium",children:g.params_desc[T]}),J.jsx("td",{className:"px-6 py-3 text-right font-mono font-bold text-blue-700",children:g.params_cant[T].toLocaleString()}),J.jsx("td",{className:"px-6 py-3 text-right font-mono font-bold text-orange-600 bg-orange-50/50",children:g.tiemposCambio&&g.tiemposCambio[_]>0?g.tiemposCambio[_].toFixed(1):"-"}),J.jsx("td",{className:"px-6 py-3 text-right font-mono text-[10px] text-slate-500",children:(D?.stockInicial||0).toFixed(1)}),J.jsx("td",{className:"px-6 py-3 text-right font-mono text-[10px] text-slate-500",children:(D?.ventaDiaria||0).toFixed(3)}),J.jsx("td",{className:`px-6 py-3 text-right font-mono text-[10px] font-bold ${(D?.diasStock||0)<7?"text-red-500":"text-green-600"}`,children:(D?.diasStock||0)>365?">365":(D?.diasStock||0).toFixed(1)}),J.jsxs("td",{className:"px-6 py-3 text-right font-mono text-[10px] text-slate-500",children:[(D?.diasFabricacion||0).toFixed(2)," d"]}),J.jsx("td",{className:"px-6 py-3",children:J.jsx("span",{className:"px-2 py-0.5 bg-slate-100 rounded text-[10px] font-bold text-slate-400 group-hover:bg-blue-100 group-hover:text-blue-500 transition-colors",children:D?.idTablaCambioMedida||"S/N"})})]},_)})})]})})]})]}):l.length>0?J.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden flex flex-col animate-in fade-in",children:[J.jsxs("div",{className:"px-6 py-4 bg-slate-50 border-b border-gray-200 flex justify-between items-center",children:[J.jsxs("div",{className:"flex items-center gap-2",children:[J.jsx(Gb,{size:18,className:"text-blue-600"}),J.jsx("h3",{className:"font-bold text-slate-700",children:"Items en Borrador"})]}),J.jsx("span",{className:"text-[10px] font-bold bg-blue-100 text-blue-700 px-3 py-1 rounded-full uppercase",children:"Listo para Optimizar"})]}),J.jsx("div",{className:"overflow-y-auto flex-1",children:J.jsxs("table",{className:"w-full text-left text-sm",children:[J.jsx("thead",{className:"bg-slate-50/50 text-slate-400 text-[10px] font-bold uppercase sticky top-0",children:J.jsxs("tr",{children:[J.jsx("th",{className:"px-6 py-3",children:"#"}),J.jsx("th",{className:"px-6 py-3",children:"SKU"}),J.jsx("th",{className:"px-6 py-3",children:"Descripcin"}),J.jsx("th",{className:"px-6 py-3 text-right",children:"Cant. (Tn)"}),J.jsx("th",{className:"px-6 py-3 text-right",children:"Stock (Fin Mes)"}),J.jsx("th",{className:"px-6 py-3 text-right",children:"Venta Diaria"}),J.jsx("th",{className:"px-6 py-3 text-right",children:"Das Stock"}),J.jsx("th",{className:"px-6 py-3 text-right",children:"Das Fab."}),J.jsx("th",{className:"px-6 py-3",children:"ID Cambio"})]})}),J.jsx("tbody",{children:l.map((S,_)=>J.jsxs("tr",{className:"border-b border-slate-50 hover:bg-gray-50 transition-colors",children:[J.jsx("td",{className:"px-6 py-2.5 text-slate-400 text-xs",children:_+1}),J.jsx("td",{className:"px-6 py-2.5 font-bold text-slate-700 tracking-tight",children:S.skuCode}),J.jsx("td",{className:"px-6 py-2.5 text-slate-400 text-[10px] uppercase truncate max-w-[200px]",title:S.description,children:S.description}),J.jsx("td",{className:"px-6 py-2.5 text-right font-mono text-slate-600 font-bold",children:S.quantity.toLocaleString()}),J.jsx("td",{className:"px-6 py-2.5 text-right font-mono text-xs",children:S.stockInicial.toFixed(1)}),J.jsx("td",{className:"px-6 py-2.5 text-right font-mono text-xs",children:S.ventaDiaria.toFixed(3)}),J.jsx("td",{className:`px-6 py-2.5 text-right font-mono text-xs font-bold ${S.diasStock<7?"text-red-500":"text-green-600"}`,children:S.diasStock>365?">365":S.diasStock.toFixed(1)}),J.jsxs("td",{className:"px-6 py-2.5 text-right font-mono text-xs",children:[S.diasFabricacion.toFixed(2)," d"]}),J.jsx("td",{className:"px-6 py-2.5",children:J.jsx("span",{className:"px-2 py-0.5 bg-gray-100 rounded text-[10px] font-bold text-gray-400",children:S.idTablaCambioMedida})})]},S.id))})]})})]}):J.jsxs("div",{className:"flex-1 bg-white p-16 rounded-xl shadow-sm border border-gray-100 border-dashed flex flex-col items-center justify-center text-center animate-in fade-in duration-700",children:[J.jsx("div",{className:"bg-slate-50 p-8 rounded-full mb-6 border border-slate-100 animate-bounce",children:J.jsx(Gb,{size:64,className:"text-blue-500"})}),J.jsx("h3",{className:"text-xl font-bold text-slate-800 mb-2",children:"Listo para Pegar"}),J.jsxs("p",{className:"text-slate-500 max-w-sm text-sm",children:["Copia tus datos de Excel (3 columnas) y presiona ",J.jsx("b",{children:"Ctrl + V"})," en esta pantalla para cargar la demanda."]})]})]})};function Ife(){const{activeTab:e,activeProcessId:t,fetchProcessData:r}=Lr(),{fetchArticles:n}=Ks(),{fetchRules:i}=aa();return ae.useEffect(()=>{(async()=>await Promise.all([r(t),n(t),i(t)]))()},[t,r,n,i]),J.jsxs(Afe,{children:[e==="scheduler"&&J.jsxs(J.Fragment,{children:[J.jsx(Ffe,{}),J.jsx(ufe,{})]}),e==="sequencer"&&J.jsx(Pfe,{},t),e==="visual"&&J.jsx(yfe,{}),e==="database"&&J.jsx(khe,{}),e==="settings"&&J.jsx(Efe,{})]})}SD.registerModules([F$]);RM.createRoot(document.getElementById("root")).render(J.jsx(ae.StrictMode,{children:J.jsx(Ife,{})}));
